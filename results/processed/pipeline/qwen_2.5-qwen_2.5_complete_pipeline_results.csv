id,question,true_query,generated_query,success,execution_time,total_time,row_count,error,results,result_columns,execution_plan,validation_applied,final_query
fe862ff2d922e1153830a746,Which drug manufacturer is most frequently prescribed for patients under 18?,,"SELECT T3.C1 FROM ( SELECT T2.C1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C2 FROM ( SELECT admissions.subject_id, prescriptions.drug, drugs.manufacturer FROM prescriptions JOIN drugs ON prescriptions.drug = drugs.drug_name WHERE prescriptions.starttime IS NOT NULL AND drugs.manufacturer IS NOT NULL ) AS T1 JOIN admissions ON T1.subject_id = admissions.subject_id WHERE admissions.dischtime IS NOT NULL AND datetime(admissions.dischtime) < datetime(current_time,'-18 year') GROUP BY T1.C1 ) AS T2 WHERE T2.C2 <= 1 GROUP BY T3.C1",False,0.0,0.0019018650054931,0,no such table: drugs,,,,True,"SELECT T3.manufacturer FROM ( SELECT T2.manufacturer, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C2 FROM ( SELECT admissions.subject_id, prescriptions.drug FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.starttime IS NOT NULL AND admissions.age < 18 ) AS T1 JOIN drugs ON T1.drug = drugs.drug_name WHERE drugs.manufacturer IS NOT NULL GROUP BY T1.manufacturer ) AS T2 WHERE T2.C2 = 1;"
619c0d97069b2720eecadf4c,What types of anesthesia are most common in the fusion or refusion of 2-3 vertebrae procedure?,,"SELECT T1.anesthesia FROM ( SELECT procedures_icd.icd_code, icd_procedures.title, patients.subject_id, procedures_icd.charttime, icd_procedures.long_title, admissions.hadm_id FROM procedures_icd JOIN icd_procedures ON procedures_icd.icd_code = icd_procedures.icd_code JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE icd_procedures.title = 'fusion or refusion of 2-3 vertebrae' ) AS T1 JOIN ( SELECT procedures_icd.icd_code, icd_procedures.title, patients.subject_id, procedures_icd.charttime, icd_procedures.long_title, admissions.hadm_id FROM procedures_icd JOIN icd_procedures ON procedures_icd.icd_code = icd_procedures.icd_code JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE icd_procedures.title = 'anesthesia' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.charttime) >= datetime(T2.charttime) GROUP BY T2.title ORDER BY COUNT(*) DESC LIMIT 1",False,0.0,0.0023272037506103,0,incomplete input,,,,True,"SELECT icd_anesthetics.long_title FROM icd_anesthetics WHERE icd_anesthetics.icd_code IN ( SELECT T3.anesthesia_icd_code FROM ( SELECT T2.icd_code, T2.hadm_id FROM ( SELECT procedures_icd.icd_code, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_procedures.icd_code FROM icd_procedures WHERE icd_procedures.long_title = 'fusion or refusion of 2-3 vertebrae' ) ) AS T1 JOIN ( SELECT anesthetics_icd.icd_code, anesthetics_icd.hadm_id FROM anesthetics_icd WHERE anesthetics_icd.icd_code = ( SELECT icd_anesthetics.icd_code FROM icd_anesthetics WHERE icd_anesthetics.long_title = 'anesthesia' ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE datetime(T1.charttime) >= datetime(T2.charttime) ) AS T3 GROUP BY T3.anesthesia_icd_code ORDER BY COUNT(*) DESC LIMIT 1 );"
4c6f37b09e9230a451cda980,What are the majors of the patients admitted to the icu whose first care unit is micu in the previous month?,,"SELECT DISTINCT patients.majors FROM patients WHERE patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.careunit = 'micu' AND datetime(admissions.intime,'start of month','-1 month') = datetime(current_time,'start of month','-1 month') )",False,0.0,0.0026359558105468,0,incomplete input,,,,True,"SELECT T3.specialty FROM ( SELECT T2.specialty, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, transfers.careunit, transfers.intime FROM transfers JOIN admissions ON transfers.hadm_id = admissions.hadm_id WHERE transfers.intype = 'admit to icu' AND datetime(transfers.intime,'start of month','-1 month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT admissions.subject_id, patients.specialty, transfers.intime FROM transfers JOIN admissions ON transfers.hadm_id = admissions.hadm_id JOIN patients ON admissions.subject_id = patients.subject_id WHERE transfers.intype = 'admit to hospital' AND datetime(transfers.intime,'start of month','-1 month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.careunit = 'micu' AND T2.careunit = 'micu' GROUP BY T2.specialty ) AS T3 WHERE T3.C1 <= 3;"
d06e1b6a44abb8c2d06f5c31,Generate a pie chart illustrating the distribution of the top 10 most common procedures.,,"SELECT pie_chart( SELECT T1.C1, T1.C2 FROM ( SELECT COUNT(*) AS C1, procedures_icd.icd_code FROM procedures_icd GROUP BY procedures_icd.icd_code ORDER BY C1 DESC LIMIT 10 ) AS T1 )",True,0.0,0.0014972686767578,0,,"[{'long_title': 'venous catheterization, not elsewhere classified', 'CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER ()': 0.15599012238079674}, {'long_title': 'other nonoperative respiratory measurements', 'CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER ()': 0.14122816574063987}, {'long_title': 'coronary arteriography using two catheters', 'CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER ()': 0.10894432944765226}, {'long_title': 'electrocardiogram', 'CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER ()': 0.09078694120637687}, {'long_title': 'enteral infusion of concentrated nutritional substances', 'CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER ()': 0.09029669172386244}, {'long_title': 'insertion of infusion device into superior vena cava, percutaneous approach', 'CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER ()': 0.08739150960525838}, {'long_title': 'continuous invasive mechanical ventilation for less than 96 consecutive hours', 'CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER ()': 0.08597523332243891}, {'long_title': 'central venous catheter placement with guidance', 'CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER ()': 0.08403239278062244}, {'long_title': 'procedure on single vessel', 'CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER ()': 0.07851254675527472}, {'long_title': 'routine chest x-ray, so described', 'CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER ()': 0.07684206703707738}]",,,True,"SELECT d_icd_procedures.long_title ,  CAST(procedures_icd.count AS REAL) / SUM(procedures_icd.count) OVER () FROM ( SELECT icd_code ,  COUNT(*) AS count FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY icd_code ORDER BY count DESC LIMIT 10 ) AS procedures_icd JOIN d_icd_procedures ON procedures_icd.icd_code = d_icd_procedures.icd_code;"
b5704c126bc27a7b3e42628a,Please tell me the telephone number of patient 273's companion.,,"SELECT T1.compmrn FROM ( SELECT admissions.compmrn, patients.telephone FROM admissions WHERE admissions.subject_id = 273 ) AS T1 WHERE T1.compmrn IS NOT NULL",False,0.0,0.0031228065490722,0,no such column: admissions.contactphone,,,,True,"SELECT T1.contactphone FROM ( SELECT admissions.subject_id, admissions.contactphone FROM admissions WHERE admissions.subject_id = 273 ) AS T1 WHERE T1.contactphone IS NOT NULL;"
b7b46d74fb37a9539786e740,Does patient 17667 have any tests left to do before discharge?,,SELECT COUNT(*)>0 FROM tests WHERE tests.patient_id = 17667 AND tests.status = 'pending',False,0.0,0.0036423206329345,0,no such table: items,,,,True,SELECT COUNT(*)>0 FROM outputevents WHERE outputevents.stay_id IN ( SELECT stays.stay_id FROM admissions INNER JOIN icustays ON admissions.hadm_id = icustays.hadm_id WHERE admissions.subject_id = 17667 ) AND outputevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'tests' AND items.itemtype = 'output' ) AND NOT outputevents.endtime IS NULL;
056fb750773e90aa030e9950,What is the most common operating system among asian patients?,,SELECT T1.C1 FROM ( SELECT COUNT( DISTINCT subject_id ) AS C1 FROM patients WHERE patients.ethnicity = 'asian' GROUP BY patients.operating_system ) AS T1 ORDER BY T1.C1 DESC LIMIT 1,False,0.0,0.0024182796478271,0,no such column: admissions.operating_system,,,,True,"SELECT T1.operating_system FROM ( SELECT admissions.operating_system, COUNT( DISTINCT admissions.subject_id ) AS C1 FROM admissions WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.ethnicity = 'asian' ) GROUP BY admissions.operating_system ) AS T1 ORDER BY T1.C1 DESC LIMIT 1;"
84c0a3f1d8f6eba51c9d5bee,What is the average speed in knots for patients who were admitted to the icu for the past three months?,,"SELECT AVG(T1.valuenum) FROM ( SELECT admissions.subject_id, admissions.hadm_id, icustays.stay_id FROM icustays JOIN admissions ON icustays.hadm_id = admissions.hadm_id WHERE datetime(icustays.intime) >= datetime(current_time,'-3 month') ) AS T1 JOIN ( SELECT admissions.subject_id, admissions.hadm_id, labevents.valuenum FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'speed in knots' ) AND datetime(labevents.charttime) >= datetime(current_time,'-3 month') ) AS T2 ON T1.subject_id = T2.subject_id",False,0.0,0.0013525485992431,0,no such table: labitems,,,,True,"SELECT AVG(T1.valuenum) FROM ( SELECT labevents.valuenum FROM labevents WHERE labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'admit to icu' ) AND datetime(labevents.charttime) >= datetime(current_time,'-3 month') ) AS T1 WHERE T1.valuenum IS NOT NULL;"
35fbd2bb7e73dec7b0390bfd,What are the documents necessary for hospital discharge?,,"SELECT DISTINCT T1.title FROM ( SELECT admissions.subject_id, documents.title FROM documents JOIN admissions ON documents.hadm_id = admissions.hadm_id WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id, documents.title ) AS T1",False,0.0,0.002328872680664,0,no such table: documents,,,,True,SELECT DISTINCT documents.title FROM documents WHERE documents.document_type = 'discharge summary';
b10d95d377e7fd96548c50cd,What are the distances of patients with medicaid?,,SELECT DISTINCT admissions.distance FROM admissions WHERE admissions.insurance = 'medicaid',False,0.0,0.0032098293304443,0,no such column: admissions.distance_from_home,,,,True,SELECT DISTINCT admissions.distance_from_home FROM admissions WHERE admissions.insurance = 'medicaid';
930950b0e61480275d875940,Do we have some singer names of the patients who died 3 days ago?,,"SELECT T1.singer_name FROM ( SELECT admissions.subject_id, singers.singer_name FROM singers JOIN admissions ON singers.subject_id = admissions.subject_id WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-3 day') ) AS T1",False,0.0,0.0021584033966064,0,no such column: patients.name,,,,True,"SELECT patients.name FROM patients WHERE patients.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.dischtime IS NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-3 day') );"
6f03fb45abf03355fdf2ebe5,What is the average age of the first child for patients with hypertension?,,"SELECT AVG(T1.age) FROM ( SELECT admissions.subject_id, patients.dob FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'hypertension' ) ) ) AS T1 JOIN ( SELECT admissions.subject_id, birthtime FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'family history of hypertension' ) ) ) AS T2 ON T1.subject_id = T2.subject_id",False,0.0,0.0023999214172363,0,no such table: icd_codes,,,,True,SELECT AVG(T1.age) FROM ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'hypertension' ) ) ) AS T1 WHERE T1.age IS NOT NULL;
6019c6cfa331a76747e3e179,Just count the number of patients asked for a copy of their prescription during hospital stay.,,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions_hadm_ids.hadm_id FROM prescriptions_hadm_ids WHERE prescriptions_hadm_ids.request_copy = 1 ),False,0.0,0.0020225048065185,0,no such column: itemname,,,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT outputevents.hadm_id FROM outputevents WHERE outputevents.itemid IN ( SELECT itemid FROM d_items WHERE itemname = 'copy of their prescription' ) AND strftime('%Y-%m-%d',outputevents.charttime) BETWEEN strftime('%Y-%m-%d',admissions.admittime) AND strftime('%Y-%m-%d',admissions.dischtime) );"
5ae9eba9c11262b3bc8961b7,Tell me the change in the systolic blood pressure of patient 10020187 last measured on the last ICU visit compared to the value second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.label = 'arterial blood pressure systolic' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.label = 'arterial blood pressure systolic' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),False,0.0,0.0013129711151123,0,incomplete input,,,,True,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 );
429abe1449551a068765e97e,What are the documents required for hospital discharge?,,"SELECT DISTINCT T1.title FROM ( SELECT admissions.subject_id, documents.title FROM documents JOIN admissions ON documents.hadm_id = admissions.hadm_id WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id, documents.title ) AS T1",False,0.0,0.0023186206817626,0,no such table: documents,,,,True,SELECT DISTINCT documents.file_name FROM documents WHERE documents.document_type = 'discharge summary';
e8057790cfb3bf1907c60c42,How many patients who were admitted to the hospital twice own trucks?,,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, vehicles.vehicle_type FROM admissions WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id HAVING COUNT( admissions.row_id ) = 2 ) AS T1 JOIN vehicles ON T1.subject_id = vehicles.subject_id WHERE vehicles.vehicle_type = 'truck'",False,0.0,0.0025026798248291,0,"unrecognized token: ""'-""",,,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.subject_id IN ( SELECT T3.subject_id FROM ( SELECT T2.subject_id, COUNT( T2.hadm_id ) AS c1 FROM ( SELECT admissions.subject_id, admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id, admissions.hadm_id HAVING strftime('%Y',admissions.admittime) = strftime('%Y',current_time) AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 GROUP BY T2.subject_id HAVING T2.c1 = 2 ) AS T3 WHERE T3.subject_id IN ( SELECT vehicles.subject_id FROM vehicles WHERE vehicles.vehicle_type = 'truck' ) );"
b23b961d0f2fe2cf1eec5a22,Was the heart rate of patient 10019777 within the normal range in their first hospital visit?,SELECT 1 - COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum NOT BETWEEN heart_rate_lower AND heart_rate_upper,"SELECT COUNT(*)>0 FROM ( SELECT * FROM ( SELECT heart_rate, DENSE_RANK() OVER ( ORDER BY charttime ) AS c1 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) WHERE heart_rate BETWEEN 60 AND 100",False,0.0,0.0012612342834472,0,no such table: vitalss,,,,True,SELECT COUNT(*)>0 FROM ( SELECT heart_rate FROM vitalss WHERE vitalss.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) WHERE heart_rate BETWEEN 60 AND 100;
f2be9084ce59ddbf5372d16a,What was the name of the organism that was discovered in the last urine test of patient 10019172 during the previous month?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT T1.org_name FROM ( SELECT microbiologyevents.org_name, DENSE_RANK() OVER ( PARTITION BY microbiologyevents.hadm_id ORDER BY microbiologyevents.charttime DESC ) AS C1 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ) AS T1 WHERE T1.C1 = 1 AND datetime(T1.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",True,0.0,0.0012557506561279,0,,,,,True,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1;"
49096da9fc4db23df0c9ca94,Is the value of the respiratory rate of patient 10038999 last measured on the last ICU visit greater than that second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"SELECT ( SELECT respiratoryrate FROM ( SELECT respiratoryrate, datetime, ROW_NUMBER() OVER ( ORDER BY datetime DESC ) AS rn FROM inputevents WHERE inputevents.stayid IN ( SELECT icustays.stayid FROM icustays WHERE icustays.patientid = 10038999 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT itemids.itemid FROM itemids WHERE itemids.label = 'respiratory rate' ) ) WHERE rn = 1 ) > ( SELECT respiratoryrate FROM ( SELECT respiratoryrate, datetime, ROW_NUMBER() OVER ( ORDER BY datetime DESC ) AS rn FROM inputevents WHERE inputevents.stayid IN ( SELECT icustays.stayid FROM icustays WHERE icustays.patientid = 10038999 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT itemids.itemid FROM itemids WHERE itemids.label = 'respiratory rate' ) ) WHERE rn = 2 )",False,0.0,0.0016093254089355,0,incomplete input,,,,True,"SELECT ( SELECT respiratory_rate FROM ( SELECT respiratory_rate, charttime, ROW_NUMBER() OVER ( ORDER BY charttime DESC ) AS c1 FROM respiration WHERE respiration.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ) WHERE c1 = 1 ) > ( SELECT respiratory_rate FROM ( SELECT respiratory_rate, charttime, ROW_NUMBER() OVER ( ORDER BY charttime DESC ) AS c1 FROM respiration WHERE respiration.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ) WHERE c1 = 2 );"
51f107a86832910517f841d1,When will patient 24894 have their next mri?,,SELECT procedureschedule.starttime FROM procedureschedule WHERE procedureschedule.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 24894 ) AND procedureschedule.procedure_id IN ( SELECT procedures.procedure_id FROM procedures WHERE procedures.procedure_name = 'mri' ) ORDER BY procedureschedule.starttime DESC LIMIT 1,False,0.0,0.0031118392944335,0,no such table: procedures,,,,True,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 24894 ) AND procedures.procedure_name = 'mri' ORDER BY procedures.starttime DESC LIMIT 1;
43dd6a535818b9817b393135,What currencies are used by the patients older than 40 this year?,,"SELECT DISTINCT admissions.payerplanid FROM admissions WHERE admissions.age > 40 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",False,0.0,0.0021557807922363,0,no such column: admissions.payer_plan_id,,,,True,"SELECT DISTINCT admissions.payer_plan_id FROM admissions WHERE admissions.age > 40 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year');"
550a6a2fb0ecbf40e74fdb86,What was the last value of the o2 saturation pulseoxymetry of patient 10010471?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT o2 saturation pulseoxymetry FROM patientchartevents WHERE patientchartevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND patientchartevents.itemid IN ( SELECT devicerecorditems.itemid FROM devicerecorditems WHERE devicerecorditems.label = 'o2 saturation pulseoxymetry' ) ORDER BY patientchartevents.charttime DESC LIMIT 1,False,0.0,0.0019972324371337,0,no such table: oximeter,,,,True,SELECT pulseoxymetry FROM oximeter WHERE hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ORDER BY charttime DESC LIMIT 1;
1d6044d33845efb3cb927bac,How many patients admitted this year reported no allergies?,,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT hadm_id FROM patientevents WHERE patientevents.itemid IN ( SELECT itemid FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '403.9' ) ) AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",False,0.0,0.0026040077209472,0,incomplete input,,,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.admittime BETWEEN datetime(current_time,'start of year','-0 year') AND datetime(current_time,'start of year','-0 year','+1 year') AND admissions.hadm_id IN ( SELECT allergy.patients_subject_id FROM ( SELECT patients.subject_id, COUNT( DISTINCT allergies.allergy_type ) AS c1 FROM patients LEFT JOIN allergies ON patients.subject_id = allergies.patients_subject_id WHERE datetime(allergies.startdate,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY patients.subject_id ) AS allergy WHERE allergy.c1 = 0 );"
da0649deb95e705d44b3a6bd,How to make bake potato in oven,,SELECT DISTINCT procedures.procedure_name FROM procedures WHERE procedures.icd_code IN ( SELECT diagnoses.icd_code FROM diagnoses WHERE diagnoses.description = 'bake potato in oven' ),False,0.0,0.0028865337371826,0,no such table: recipes,,,,True,SELECT DISTINCT recipes.steps FROM recipes WHERE recipes.title = 'bake potato in oven';
e8a376ca7f202983221786bd,"Can you tell me the daily maximum weight of patient 10018081, taken since 11/2100?","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-11' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT MAX(weight) FROM weights WHERE weights.patient_id = 10018081 AND strftime('%Y-%m',weights.charttime) >= '2100-11' GROUP BY strftime('%Y-%m-%d',weights.charttime)",False,0.0,0.0031464099884033,0,no such table: careunits,,,,True,"SELECT MAX(weight) FROM inputevents WHERE inputevents.stay_id IN ( SELECT careunits.stay_id FROM careunits WHERE careunits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-11' GROUP BY strftime('%Y-%m-%d',inputevents.starttime);"
7a1c80e590227785f1b6c6a6,"Compared to second to last measured on the last ICU visit, is the o2 saturation pulseoxymetry value of patient 10020944 last measured on the last ICU visit less?",SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT o2 saturation pulseoxymetry FROM patientchartevents WHERE patientchartevents.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.patient_id = 10020944 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND patientchartevents.itemid IN ( SELECT itemids.itemid FROM itemids WHERE itemids.label = 'o2 saturation pulseoxymetry' ) ORDER BY patientchartevents.charttime DESC LIMIT 1 OFFSET 1 ) > ( SELECT o2 saturation pulseoxymetry FROM patientchartevents WHERE patientchartevents.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.patient_id = 10020944 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND patientchartevents.itemid IN ( SELECT itemids.itemid FROM itemids WHERE itemids.label = 'o2 saturation pulseoxymetry' ) ORDER BY patientchartevents.charttime DESC LIMIT 1 ),False,0.0,0.0018589496612548,0,incomplete input,,,,True,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' ) ORDER BY chartevents.charttime DESC LIMIT 1 );
7bc94deacf6c02cba88f38e5,What is the average total cost of a hospital visit that involves a procedure known as other bronchoscopy in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other bronchoscopy' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM( admissions.payamount ) AS C1 FROM admissions WHERE admissions.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.procedure_name = 'other bronchoscopy' ) AND strftime('%Y',admissions.dischtime) = '2100' GROUP BY admissions.subject_id ) AS T1",True,0.0,0.0024695396423339,0,,[{'AVG(T1.C1)': None}],,,True,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.event_type = 'procedure' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other bronchoscopy' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.event_id ) AS T1;"
868f55abba5b9b51520d27e4,Which patient and procedure had the longest duration of anesthesia last month?,,"SELECT patients.subject_id, procedures.procedure_name FROM ( SELECT operations.subject_id, operations.hadm_id, operations.starttime, operations.endtime FROM operations WHERE datetime(operations.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS ops JOIN ( SELECT procedures.procedure_name, procedures.hadm_id FROM procedures WHERE datetime(procedures.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS procs ON ops.hadm_id = procs.hadm_id JOIN patients ON ops.subject_id = patients.subject_id WHERE strftime('%J',ops.endtime) - strftime('%J',ops.starttime) >= 0 ORDER BY strftime('%J',ops.endtime) - strftime('%J',ops.starttime) DESC LIMIT 1",False,0.0,0.0029854774475097,0,no such table: anesthestics,,,,True,"SELECT patients.subject_id, procedures_icd.long_title FROM procedures_icd INNER JOIN ( SELECT procedures_icd.icd_code, MAX(strftime('%J',procedures_icd.charttime) - strftime('%J',anesthestics.starttime)) AS max_duration FROM procedures_icd INNER JOIN anesthestics ON procedures_icd.hadm_id = anesthestics.hadm_id WHERE datetime(anesthestics.starttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY procedures_icd.icd_code ) AS t1 ON procedures_icd.icd_code = t1.icd_code INNER JOIN patients ON procedures_icd.hadm_id = patients.hadm_id WHERE t1.max_duration = MAX(t1.max_duration);"
7d987252b086db272f8e0751,"What are the three most commonly tested specimens for patients that received drainage of peritoneal cavity, percutaneous approach previously in the same month in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.icd_code = '09.64' AND strftime('%Y',procedures.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime FROM specimens WHERE strftime('%Y',specimens.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",False,0.0,0.0011723041534423,0,incomplete input,,,,True,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.icd_code = 'drainage of peritoneal cavity, percutaneous approach' AND strftime('%Y',procedures.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime FROM specimens WHERE strftime('%Y',specimens.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3;"
d60412f228f0e3b6df5b6d8c,Has any medication been given to patient 10021312 since 03/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03'",True,0.0,0.0025482177734375,0,,[{'COUNT(*)>0': 0}],,,True,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03';"
8575a4d0318c42ed703a89a1,"Has patient 10015931 been received 5% dextrose, glucose gel, or ondansetron in 12/2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug IN ( '5% dextrose', 'glucose gel', 'ondansetron' ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.itemid IN ( SELECT inputevents.itemid FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND inputevents.itemid IN ( SELECT drugs.drug_id FROM drugs WHERE drugs.drug_name IN ( '5% dextrose', 'glucose gel', 'ondansetron' ) ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' )",False,0.0,0.0027577877044677,0,no such column: admissions.stay_id,,,,True,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label IN ( '5% dextrose', 'glucose gel', 'ondansetron' ) ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12';"
2bd36cdf648a73c1405bc0bd,What was the procedure patient 10007795 received two times since 01/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-01' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT T1.procedure_name FROM ( SELECT procedures_icd.icd_code AS icd_code, icd_procedures.procedure_name AS procedure_name FROM procedures_icd JOIN icd_procedures ON procedures_icd.icd_code = icd_procedures.icd_code WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-01' GROUP BY procedures_icd.icd_code HAVING COUNT(*) = 2 ) AS T1",False,0.0,0.0030999183654785,0,no such column: procedures_icd.long_title,,,,True,"SELECT T1.long_title FROM ( SELECT procedures_icd.long_title, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-01' GROUP BY procedures_icd.long_title ) AS T1 WHERE T1.C1 = 2;"
ab2aad38b2169268cce19216,Has any midazolam been prescribed to patient 10019172?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.drug = 'midazolam',SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND prescriptions.patient_id = 10019172,True,0.0,0.0026254653930664,0,,[{'COUNT(*)>0': 1}],,,True,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 );
45ecebf7e481e6c14fdc01cd,What was the last input given to patient 10018081 on 12/30/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT inputevents.itemid FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-30' ORDER BY inputevents.starttime DESC LIMIT 1 )","SELECT inputroute.name FROM inputroute WHERE inputroute.charttime IN ( SELECT inputs.inputroutecharttime FROM inputs WHERE inputs.stayid IN ( SELECT admissions.stayid FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(inputs.inputroutecharttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputs.inputroutecharttime) = '12-30' ORDER BY inputs.inputroutecharttime DESC LIMIT 1 )",False,0.0,0.0030217170715332,0,no such table: inputs,,,,True,"SELECT inputs.route FROM inputs WHERE inputs.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(inputs.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputs.starttime) = '12-30' ORDER BY inputs.starttime DESC LIMIT 1;"
732ddbd8735aa1ef150a5da1,Has patient 10004733 been provided with any lidocaine 1% during this hospital encounter?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'lidocaine 1%',SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.itemid IN ( SELECT inputevents.itemid FROM inputevents WHERE inputevents.strength = '1%' AND inputevents.name = 'lidocaine' ) AND inputevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ),False,0.0,0.0026772022247314,0,no such column: admissions.stay_id,,,,True,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lidocaine 1%' ) AND inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL );
fc0f5148afa412b85497beb3,How much do patients pay to get a diagnosis of septicemia due to escherichia coli [e. coli]?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'septicemia due to escherichia coli [e. coli]' ) ),SELECT DISTINCT admissions.payments FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd.icd_code FROM icd WHERE icd.icd_name = 'septicemia due to escherichia coli [e. coli]' ) ),False,0.0,0.0034258365631103,0,no such table: diagnoses,,,,True,SELECT DISTINCT admissions.payments FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd.icd_code FROM icd WHERE icd.icd_name = 'septicemia due to escherichia coli [e. coli]' ) )
97a7eba99e8adfa9dfe8aaca,Has patient 10005817 been subjected to a free calcium test since 10/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'free calcium' ) ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10'",True,0.0,0.0025129318237304,0,,[{'COUNT(*)>0': 1}],,,True,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10';"
e80f4420e687a67930a3fe82,How is tamoxifen citrate delivered to the body?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate',SELECT DISTINCT drugs.drug FROM drugs WHERE drugs.drug = 'tamoxifen citrate',False,0.0,0.0020856857299804,0,no such table: routes,,,,True,SELECT DISTINCT routes.route FROM routes WHERE routes.route_description = ( SELECT drug_routes.route_description FROM drug_routes WHERE drug_routes.drug = 'tamoxifen citrate' );
7ffb1352553a2bdb8bcc4817,What medication was prescribed to patient 10019172 in the same hospital visit after the diagnosis of tobacco use disorder in 11/this year?,"SELECT T2.drug FROM ( SELECT diagnoses_icd.charttime, diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',diagnoses_icd.charttime) = '11' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY T2.starttime ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime, admissions.hadm_id FROM diagnoses WHERE diagnoses.icd_code = 'tobacco use disorder' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',diagnoses.charttime) = '11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id ) AS T3 WHERE T3.C1 = 1",False,0.0,0.0015134811401367,0,incomplete input,,,,True,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY T2.starttime ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',diagnoses_icd.charttime) = '11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id ) AS T3 WHERE T3.C1 = 1;"
7e5e17dca306a105f47f9bb7,How much does patient 10002495's troponin t differ from the last value measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"SELECT ( SELECT troponinT FROM ( SELECT troponinT, ROW_NUMBER() OVER ( ORDER BY charttime DESC ) AS rn FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'troponin t' ) ) WHERE rn = 1 ) - ( SELECT troponinT FROM ( SELECT troponinT, ROW_NUMBER() OVER ( ORDER BY charttime DESC ) AS rn FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'troponin t' ) ) WHERE rn = 2 )",False,0.0,0.0013821125030517,0,incomplete input,,,,True,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 );
747ed9e0734b371799a079ed,"What was the name of a drug that patient 10005817 was prescribed within 2 days after being diagnosed with chronic airway obstruction, not elsewhere classified throughout this month?","SELECT T2.drug FROM ( SELECT diagnoses_icd.charttime, diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic airway obstruction, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT T2.drug FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = '496' AND admissions.subject_id = 10005817 AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10005817 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",False,0.0,0.0015017986297607,0,incomplete input,,,,True,"SELECT T2.drug FROM ( SELECT diagnoses_icd.charttime, diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = '496' AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day');"
064647795088c18c2eea104a,What is the maximum total price for a hospital that includes a medication named vial in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vial' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM( admissions.payamount ) AS C1 FROM admissions WHERE admissions.hadm_id IN ( SELECT medications.hadm_id FROM medications WHERE medications.drug = 'vial' ) AND strftime('%Y',admissions.admittime) = '2100' GROUP BY admissions.hadm_id ) AS T1",False,0.0,0.0022516250610351,0,no such column: admissions.totalhospitalcost,,,,True,"SELECT MAX(T1.C1) FROM ( SELECT SUM(admissions.totalhospitalcost) AS C1 FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vial' ) AND strftime('%Y',admissions.admittime) = '2100' GROUP BY admissions.hadm_id ) AS T1;"
7c6f2aa274207d68024f4cd4,Could you tell me the top four most frequent treatments that were administered to patients during the same hospital encounter after they had fluoroscopy of right heart using other contrast since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of right heart using other contrast' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.activity FROM ( SELECT T2.activity, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, encounters.hadm_id FROM encounters JOIN admissions ON encounters.hadm_id = admissions.hadm_id WHERE encounters.icd_code = '01.25' AND strftime('%Y',encounters.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, encounters.hadm_id, procedures.activity FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.hadm_id = T2.hadm_id GROUP BY T2.activity ) AS T3 WHERE T3.C1 <= 4",False,0.0,0.0015473365783691,0,incomplete input,,,,True,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C3 FROM ( SELECT T2.icd_code, T1.subject_id, T1.hadm_id FROM ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of right heart using other contrast' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 );"
9ea8c0016a33c461c3a77f56,How much does the systolic blood pressure of patient 10037975 change second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT systolicbloodpressure FROM ( SELECT systolicbloodpressure, ROW_NUMBER() OVER ( ORDER BY charttime ) AS rownum FROM bloodpressure WHERE bloodpressure.icustays_id IN ( SELECT icustays.icustays_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ) WHERE rownum = 2 ) - ( SELECT systolicbloodpressure FROM ( SELECT systolicbloodpressure, ROW_NUMBER() OVER ( ORDER BY charttime ) AS rownum FROM bloodpressure WHERE bloodpressure.icustays_id IN ( SELECT icustays.icustays_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ) WHERE rownum = 1 )",False,0.0,0.0015833377838134,0,incomplete input,,,,True,"SELECT ( SELECT bloodpressures.valuenum FROM ( SELECT icustays.stay_id, bloodpressures.valuenum, ROW_NUMBER() OVER ( ORDER BY bloodpressures.charttime ) AS rownum FROM bloodpressures WHERE bloodpressures.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND bloodpressures.type = 'systolic' ) WHERE rownum = 2 ) - ( SELECT bloodpressures.valuenum FROM ( SELECT icustays.stay_id, bloodpressures.valuenum, ROW_NUMBER() OVER ( ORDER BY bloodpressures.charttime ) AS rownum FROM bloodpressures WHERE bloodpressures.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND bloodpressures.type = 'systolic' ) WHERE rownum = 1 );"
0c85596eb9a5ce81b6fb531c,Has patient 10005909 had any procedure throughout this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",True,0.0,0.0025429725646972,0,,[{'COUNT(*)>0': 0}],,,True,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year');"
325e6c5f09459a46cc53281b,Retrieve the top five most frequently tested specimens that patients took in the same hospital visit after being diagnosed with chronic lymphocytic leukemia of b-cell type not having achieved remission.,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic lymphocytic leukemia of b-cell type not having achieved remission' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.specimen_name FROM ( SELECT T2.specimen_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = '20469' ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.specimen_name, specimens.charttime, admissions.hadm_id FROM specimens JOIN admissions ON specimens.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.specimen_name ) AS T3 WHERE T3.C1 <= 5",False,0.0,0.0017449855804443,0,incomplete input,,,,True,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = '20469' ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime, admissions.hadm_id FROM specimens JOIN admissions ON specimens.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5;"
0df69b82de6a35ad5bdec3d3,What drug was first prescribed to patient 10010471 via neb route since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT drugs.drug FROM ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10010471 AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1 ) AS first_neb_prescription",True,0.0,0.0023329257965087,0,,[{'drug': 'ipratropium-albuterol neb'}],,,True,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1;"
9f0ee496296456e6f48a49a6,What was patient 10002495's minimum protein value on the last hospital encounter?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ),SELECT MIN(labtests.protein) FROM labtests WHERE labtests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),True,0.0,0.0023558139801025,0,,[{'MIN(labevents.valuenum)': 30.0}],,,True,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' );
9e06157df2f8d7330094763f,Tell me the total amount of solution that patient 10019917 had on 01/28/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-28'","SELECT SUM(inputamount) FROM inputevents WHERE inputevents.stayid IN ( SELECT admissions.stayid FROM admissions WHERE admissions.subject_id = 10019917 ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-28'",False,0.0,0.0022592544555664,0,no such column: admissions.stay_id,,,,True,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-28';"
53761ebb18ac5c642c4f2006,When was the time that patient 10010471's respiratory rate was greater than 25.0 for the first time on this month/19?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 25.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '19' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT admissions.subject_id, patients.gender, admissions.age, labevents.charttime FROM labevents WHERE labevents.respiratoryrate > 25.0 AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',labevents.charttime) = '19' ORDER BY labevents.charttime ASC LIMIT 1",True,0.0,0.0047922134399414,0,,,,,True,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND labevents.valuenum > 25.0 AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',labevents.charttime) = '19' ORDER BY labevents.charttime ASC LIMIT 1;"
e634517291db8bd82ef6a1b7,"What was the name of the drug, which patient 10012853 was prescribed in the same day after being diagnosed with peripheral vascular disease, unspecified on their last hospital visit?","SELECT T2.drug FROM ( SELECT diagnoses_icd.charttime, diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'peripheral vascular disease, unspecified' ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT T2.drug FROM ( SELECT events.charttime, events.hadm_id FROM ( SELECT admissions.subject_id, admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AS s0 JOIN ( SELECT diagnoses_icd.icd_code, diagnoses_icd.charttime, diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = '443.9' AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) ) AS s1 ON s0.hadm_id = s1.hadm_id WHERE datetime(s0.charttime) >= datetime(s1.charttime) ORDER BY s1.charttime DESC LIMIT 1 ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE datetime(T1.charttime) < datetime(T2.starttime) AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T",False,0.0,0.0015439987182617,0,incomplete input,,,,True,"SELECT T2.drug FROM ( SELECT diagnoses_icd.charttime, diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = '443.9' AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day');"
e843bc5ff21d749a06ab5bc3,Find the number of people diagnosed with do not resuscitate status in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'do not resuscitate status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'do not resuscitate status' ) AND strftime('%Y',diagnoses.charttime) = '2100' ) )",False,0.0,0.0024442672729492,0,no such table: icd_diagnoses,,,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT icd_diagnoses.icd_code FROM icd_diagnoses WHERE icd_diagnoses.long_title = 'do not resuscitate status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' );"
42d490e9dcc8cd200649d0ff,Could you tell me patient 10014729's monthly minimum weight in 2100?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT MIN(weight) FROM ( SELECT weight, strftime('%Y-%m',weight_datetime) AS datetime FROM patientweights WHERE patientweights.subject_id = 10014729 AND strftime('%Y',weight_datetime) = '2100' ) AS subquery GROUP BY datetime",False,0.0,0.0030577182769775,0,no such table: weights,,,,True,"SELECT MIN(weight) FROM ( SELECT weights.valuenum AS weight, strftime('%Y-%m',weights.charttime) AS datetime FROM weights WHERE weights.stay_id IN ( SELECT stays.stay_id FROM stays WHERE stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND strftime('%Y',weights.charttime) = '2100' ) AS subquery GROUP BY datetime;"
23aeb815d2db0889eb0f2b24,"Since 2100, has patient 10015931 received a encounter for examination for normal comparison and control in clinical research program diagnosis?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for examination for normal comparison and control in clinical research program' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'","SELECT COUNT(*)>0 FROM clinicalresearch.encounters WHERE clinicalresearch.encounters.program_name = 'examination for normal comparison and control' AND clinicalresearch.encounters.subject_id = 10015931 AND strftime('%Y',clinicalresearch.encounters.starttime) >= '2100'",True,0.0,0.0023231506347656,0,,[{'COUNT(*)>0': 1}],,,True,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for examination for normal comparison and control in clinical research program' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100';"
c6b99f4f9a4e559291bc20d4,What was the name of the medicine that was prescribed to patient 10027602 in the same hospital encounter after receiving the endovascular (total) embolization or occlusion of head and neck vessels procedure since 3 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endovascular (total) embolization or occlusion of head and neck vessels' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-3 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-3 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '09.54' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-3 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-3 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",False,0.0,0.0017600059509277,0,incomplete input,,,,True,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = 'endovascular (total) embolization or occlusion of head and neck vessels' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-3 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-3 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime;"
ea6a1b775d7a1387dac35ee2,What was the last value of arterial blood pressure systolic of patient 10003046 in the first ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT arterialbloodpressure systolic FROM patientchartevents WHERE patientchartevents.stayid IN ( SELECT admissions.stayid FROM admissions WHERE admissions.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.subject_id = 10003046 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.intime ASC LIMIT 1 ) AND patientchartevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.label = 'arterial blood pressure systolic' ) ORDER BY patientchartevents.charttime DESC LIMIT 1,False,0.0,0.0023860931396484,0,no such table: vascular,,,,True,SELECT vascular.c1 FROM vascular WHERE vascular.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND vascular.label = 'arterial blood pressure systolic' ORDER BY vascular.charttime DESC LIMIT 1;
8988070d5b593cec53494672,What was the name of the medication that was prescribed to patient 10005817 within the same hospital visit after receiving a single internal mammary-coronary artery bypass procedure since 12/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '10063' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",False,0.0,0.0017948150634765,0,incomplete input,,,,True,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '10063' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime;"
f92a0c61488b57aa3f7e3ab1,Can I know the 3-month survival rate of patients diagnosed with unspecified atrial fibrillation who were then prescribed rifaximin?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T3.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified atrial fibrillation' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'rifaximin' GROUP BY admissions.subject_id HAVING MAX(prescriptions.starttime) = prescriptions.starttime ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime ) AS T3 JOIN patients ON T3.subject_id = patients.subject_id )","SELECT COUNT( DISTINCT T1.subject_id ) * 100 / COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = '427.9' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'rifaximin' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+3 month')",False,0.0,0.0024240016937255,0,no such column: T3.subject_id,,,,True,"SELECT COUNT( DISTINCT T1.subject_id ) * 100 / COUNT( DISTINCT T3.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = '427.9' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'rifaximin' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+3 month') JOIN ( SELECT admissions.subject_id FROM admissions WHERE datetime(admissions.dischtime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+3 month') ) AS T3 ON T1.subject_id = T3.subject_id;"
db3c11ffd16f4f7b363b7a95,List the four most common diagnoses that were given to patients during the same month after receiving hemodialysis during this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.label FROM ( SELECT T2.label, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.procedure_name = 'hemodialysis' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.label FROM diagnoses WHERE datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.label ) AS T3 WHERE T3.C1 <= 4",False,0.0,0.0016229152679443,0,incomplete input,,,,True,"SELECT T3.long_title FROM ( SELECT T2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4;"
daa34761c136dbde698516a2,What were the top four frequent input events in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT inputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM inputevents WHERE strftime('%Y',inputevents.starttime) = '2100' GROUP BY inputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.itemid, T1.label FROM ( SELECT inputevents.event_type, COUNT(*) AS C1 FROM inputevents WHERE strftime('%Y',inputevents.starttime) = '2100' GROUP BY inputevents.event_type ) AS T1 JOIN ( SELECT inputevents.event_type, COUNT(*) AS C2 FROM inputevents WHERE strftime('%Y',inputevents.starttime) = '2100' GROUP BY inputevents.event_type ) AS T2 ON T1.event_type = T2.event_type WHERE T1.C1 >= T2.C2 AND rowid <= 4",True,0.0,0.0023941993713378,0,,"[{'label': 'dextrose 5%'}, {'label': 'nacl 0.9%'}, {'label': 'solution'}, {'label': 'po intake'}]",,,True,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT inputevents.itemid, COUNT(*) AS C1 FROM inputevents WHERE strftime('%Y',inputevents.starttime) = '2100' GROUP BY inputevents.itemid ) AS T1 ORDER BY T1.C1 DESC LIMIT 4 );"
4f58f3a3dafa1f8cd4ff29a8,How many patients were treated with other excision or destruction of lesion or tissue of pancreas or pancreatic duct two or more times since 1 year ago?,"SELECT COUNT(T1.subject_id) FROM ( SELECT admissions.subject_id, COUNT(*) AS C1 FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other excision or destruction of lesion or tissue of pancreas or pancreatic duct' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY admissions.subject_id ) AS T1 WHERE T1.C1 >= 2","SELECT COUNT( DISTINCT admissions.subject_id ) FROM ( SELECT admissions.subject_id, COUNT( procedures.icd_code ) AS C2 FROM procedures WHERE procedures.icd_code = '07.29' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') GROUP BY admissions.subject_id HAVING C2 >= 2 ) AS T1 JOIN admissions ON T1.subject_id = admissions.subject_id",False,0.0,0.002082347869873,0,no such table: procedures,,,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT T1.hadm_id FROM ( SELECT procedures.hadm_id, COUNT( procedures.charttime ) AS C2 FROM procedures WHERE procedures.icd_code = '07.29' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures.hadm_id ) AS T1 WHERE T1.C2 >= 2 );"
d495fd8395126c8eb2bfc70f,When did patient 10022880 first receive his or her chloride lab test in 04/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'chloride' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1",True,0.0,0.00303316116333,0,,,,,True,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1;"
ed1c971e6bd14f5788256c98,"For patients who took diagnostic ultrasound of digestive system , what are the top three most frequent specimens tested afterward within the same hospital visit?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnostic_ultrasound_of_digestive_system.charttime, admissions.hadm_id FROM diagnostic_ultrasound_of_digestive_system JOIN admissions ON diagnostic_ultrasound_of_digestive_system.subject_id = admissions.subject_id ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime, admissions.hadm_id FROM specimens JOIN admissions ON specimens.subject_id = admissions.subject_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",False,0.0,0.0012946128845214,0,incomplete input,,,,True,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime, admissions.hadm_id FROM specimens ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3;"
948ee11a0dde7be83d223366,"What was the name of the medication that patient 10002495 was prescribed within the same hospital visit after having received a dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach procedure since 06/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '03b00' AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",False,0.0,0.0012764930725097,0,incomplete input,,,,True,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '03b00' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime;"
18712984cf426bc265ef3c86,"Compared to first measured on the first ICU visit, is the o2 saturation pulseoxymetry value of patient 10010471 last measured on the first ICU visit greater?",SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT o2 saturation pulseoxymetry FROM patientchartevents WHERE patientchartevents.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.patient_id = 10010471 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND patientchartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.event_type = 'o2 saturation pulseoxymetry' ) ORDER BY patientchartevents.charttime DESC LIMIT 1 ) > ( SELECT o2 saturation pulseoxymetry FROM patientchartevents WHERE patientchartevents.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.patient_id = 10010471 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND patientchartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.event_type = 'o2 saturation pulseoxymetry' ) ORDER BY patientchartevents.charttime ASC LIMIT 1 ),False,0.0,0.0016970634460449,0,incomplete input,,,,True,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 );
05a8454a6a71435a557db2cc,Has patient 10004733 got a central venous catheter placement with guidance treatment during this hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ),SELECT COUNT(*)>0 FROM procedures WHERE procedures.icd_code = '09.2' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ),True,0.0,0.0031073093414306,0,,[{'COUNT(*)>0': 0}],,,True,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = '09.2' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL );
a6ad56047cfb5ab47409c6a5,"Could you tell me the top five most frequent treatments that were administered to patients during the same hospital encounter after they had ileostomy, not otherwise specified in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.activity FROM ( SELECT T2.activity, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.icd_description = 'ileostomy, not otherwise specified' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.activity ) AS T3 WHERE T3.C1 <= 5",False,0.0,0.0015897750854492,0,"unrecognized token: ""'ileostomy, not otherwise""",,,,True,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'ileostomy, not otherwise specified' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 );"
e5441310205bb859e8ca31ba,Can you provide the first value of the hemoglobin for patient 10023117 in the first hospital encounter?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT labtests.valuenum FROM labtests WHERE labtests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labtests.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'hemoglobin' ) ORDER BY labtests.charttime ASC LIMIT 1,True,0.0,0.0025615692138671,0,,[{'valuenum': 13.7}],,,True,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1;
776a4927e962a0f0d91d35e7,How is citrate dextrose 3% (acd-a) crrt administered?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'citrate dextrose 3% (acd-a) crrt',SELECT DISTINCT treatments.route FROM treatments WHERE treatments.drug = 'citrate dextrose 3% (acd-a) crrt',False,0.0,0.0026147365570068,0,no such table: routes,,,,True,SELECT DISTINCT routes.route FROM routes WHERE routes.route_description = 'citrate dextrose 3% (acd-a) crrt';
27ce9933ce0b1542c2dd468c,How much did patient 10036156 weigh according to the first measurement?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,"SELECT weight FROM weights WHERE subject_id = 10036156 AND datetime(weighttime) >= datetime(current_time,'-1 year') ORDER BY weighttime ASC LIMIT 1",False,0.0,0.0026206970214843,0,no such table: itemstypes,,,,True,SELECT weight FROM inputevents WHERE subject_id = 10036156 AND itemid IN (SELECT itemid FROM itemstypes WHERE itemstypes.label = 'daily weight') ORDER BY charttime ASC LIMIT 1;
c8175712036320a9b391cf5f,"Among patients who received hemodialysis since 1 year ago, what are the top five most frequent medications that followed within the same month?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.procedure_name = 'hemodialysis' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",False,0.0,0.0013933181762695,0,incomplete input,,,,True,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.procedure_name = 'hemodialysis' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5;"
cb2576703363b2124ae28f7c,When was the first time patient 10010471 was having less than 27.0 respiratory rate on 12/20/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 27.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-20' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT admissions.subject_id, patients.gender, admissions.age, labevents.charttime FROM labevents WHERE labevents.respiratory_rate < 27.0 AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',labevents.charttime) = '12-20' ORDER BY labevents.charttime ASC LIMIT 1",True,0.0,0.0026543140411376,0,,,,,True,"SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10010471 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',admissions.admittime) = '12-20' ORDER BY admissions.admittime ASC LIMIT 1;"
43c158cb01b2f2079157b719,How many patients were diagnosed with aortic valve disorders in the same month following the previous diagnosis of postprocedural fever since 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural fever' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'aortic valve disorders' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses.icd_code FROM diagnoses WHERE diagnoses.icd_code = 'postprocedural fever' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses WHERE diagnoses.icd_code = 'aortic valve disorders' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month','-1 month')",False,0.0,0.0016775131225585,0,incomplete input,,,,True,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural fever' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'aortic valve disorders' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month','-1 month');"
ecd65c3d262d3e34018c162c,What lab tests did patient 10001725 get for the last time since 9 months ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND datetime(labevents.charttime) >= datetime(current_time,'-9 month') ORDER BY labevents.charttime DESC LIMIT 1 )","SELECT labtests.name FROM labtests WHERE labtests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND datetime(labtests.charttime) >= datetime(current_time,'-9 month') ORDER BY labtests.charttime DESC LIMIT 1",True,0.0,0.0030591487884521,0,,[{'label': 'epithelial cells'}],,,True,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND datetime(labevents.charttime) >= datetime(current_time,'-9 month') ORDER BY labevents.charttime DESC LIMIT 1 );"
9b6fff1f017a3163467fb155,Please tell me the total number of patients who had a dextrose 50% input this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT icustays.hadm_id FROM icustays WHERE icustays.stay_id IN ( SELECT inputevents.stay_id FROM inputevents WHERE inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT inputevents.hadm_id FROM inputevents WHERE inputevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'dextrose 50%' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",True,0.0,0.0027053356170654,0,,[{'COUNT( DISTINCT admissions.subject_id )': 0}],,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT inputevents.hadm_id FROM inputevents WHERE inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') );"
2034fc68a5d4b41c3ad01684,When was the first time patient 10007795 got a prescription for gemfibrozil and lactated ringers at the same time since 06/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.charttime = admissions.admittime WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.charttime = admissions.admittime WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",False,0.0,0.0012979507446289,0,incomplete input,,,,True,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1;"
95de1cbfea9cbbf15a57c2e4,Tell me the first value of eag in patient 10008454 in 12/this year.,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eag' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime ASC LIMIT 1","SELECT eag FROM labtests WHERE labtests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(labtests.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labtests.charttime) = '12' ORDER BY labtests.charttime ASC LIMIT 1",True,0.0,0.0027520656585693,0,,,,,True,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eag' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime ASC LIMIT 1;"
fdc9e1c2af088aa194e9faa5,Has patient 10005817 been administered any medication in 04/last year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '04'",False,0.0,0.0028181076049804,0,no such column: admissions.stay_id,,,,True,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '04';"
4ae971e027ab0b11a6f1c018,Calculate the total number of patients who had a metamyelocytes lab test this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'metamyelocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",True,0.0,0.0025022029876708,0,,[{'COUNT( DISTINCT admissions.subject_id )': 0}],,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') );"
2666b04409be1528ae23a0f2,Give me the top four most commonly prescribed medications within 2 months to the patients aged 60 or above after diagnosed with esophageal reflux since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = '530.81' AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",False,0.0,0.0016100406646728,0,incomplete input,,,,True,"SELECT d_drugs.drug_name FROM d_drugs WHERE d_drugs.drug_id IN ( SELECT T3.drug_id FROM ( SELECT T2.drug_id, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug_id ) AS T3 WHERE T3.C1 <= 4 );"
4b624ad8a3b82ed7e3e29dc3,What are the three diagnoses associated with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY T1.C2 ASC ) AS C1 FROM ( SELECT STRFTIME('%Y-%m',T1.charttime) AS C0, AVG(CASE WHEN strftime('%J',T1.charttime) < strftime('%J',T2.charttime) THEN 0 ELSE 1 END) AS C2 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.icd_version, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.icd_version, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id HAVING MAX(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.icd_code",False,0.0,0.0016407966613769,0,incomplete input,,,,True,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 );"
e62cc504176c8533a1e60738,Has patient 10018328 had any surgery?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ),SELECT COUNT(*)>0 FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ),True,0.0,0.0023736953735351,0,,[{'COUNT(*)>0': 1}],,,True,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 );
33531c8f62b92bd9245b9217,Which are the four diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT T1.C1 FROM ( SELECT DIAGNOSES_ICD.diagnosis, COUNT( DISTINCT patients.subject_id ) AS C1 FROM DIAGNOSES_ICD WHERE DIAGNOSES_ICD.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL ) AND datetime(admissions.dischtime) BETWEEN datetime(current_time,'-6 month') AND current_time GROUP BY DIAGNOSES_ICD.diagnosis ) AS T1 WHERE T1.C1 IN ( SELECT T2.C1 FROM ( SELECT DIAGNOSES_ICD.diagnosis, COUNT( DISTINCT patients.subject_id ) AS C1 FROM DIAGNOSES_ICD WHERE DIAGNOSES_ICD.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL ) AND datetime(admissions.dischtime) BETWEEN datetime(current_time,'-6 month') AND current_time GROUP BY DIAGNOSES_ICD.diagnosis ) AS T2 ORDER BY T2.C1 DESC LIMIT 4 )",False,0.0,0.0012288093566894,0,incomplete input,,,,True,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 );"
bd8736e59f3b5eb724910a84,"Has a extirpation of matter from left femoral vein, percutaneous approach procedure been performed on patient 10005909 since 1 year ago?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*)>0 FROM procedures WHERE procedures.icd_code = '03.21' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures.charttime) >= datetime(current_time,'-1 year')",True,0.0,0.0020573139190673,0,,[{'COUNT(*)>0': 0}],,,True,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = '03.21' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year');"
3a42a1f5b0ab7a9b081c5484,Can you tell me the cost of the drug named lactulose?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lactulose' ),SELECT DISTINCT drugs.drug_cost FROM drugs WHERE drugs.drug_name = 'lactulose',False,0.0,0.001971960067749,0,no such table: drugs,,,,True,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'drugs' AND cost.event_id IN ( SELECT drugs.drug_id FROM drugs WHERE drugs.drug_name = 'lactulose' );
48e40b5c41147007595a5175,"Since 2100, what are the top three most frequent drugs prescribed to patients within 2 months after the prescription of donepezil?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'donepezil' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.starttime) AND datetime(T1.starttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions WHERE prescriptions.drug = 'donepezil' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.starttime) AND datetime(T1.starttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",False,0.0,0.0010364055633544,0,"near ""A"": syntax error",,,,True,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions WHERE prescriptions.drug = 'donepezil' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.starttime) AND datetime(T1.starttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3;"
1eb7d8845e0439e31945047c,"What were the five most frequent drugs that were prescribed within 2 months to patients in their 50s after diagnosed with acute pulmonary edema, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute pulmonary edema' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = 'acute pulmonary edema' AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",False,0.0,0.0010812282562255,0,"unrecognized token: ""'-1 """,,,,True,"SELECT d_drugs.drug_name FROM d_drugs WHERE d_drugs.drug_id IN ( SELECT T3.drug_id FROM ( SELECT T2.drug_id, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute pulmonary edema' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug_id ) AS T3 WHERE T3.C1 <= 5 );"
23f5cb31ebe9cc2a949960b0,What does it cost to undergo arteriography of femoral and other lower extremity arteries?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) ),SELECT DISTINCT admissions.cost FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.icd_code = ( SELECT icd_procedures.icd_code FROM icd_procedures WHERE icd_procedures.icd_name = 'arteriography of femoral and other lower extremity arteries' ) ),False,0.0,0.0016365051269531,0,no such table: icd_procedures,,,,True,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_procedures.icd_code FROM icd_procedures WHERE icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) );
2cdba5b8a95c49f552fbdf57,What was patient 10004235's last hospital discharge time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004235 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1","SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004235 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",True,0.0167102813720703,0.0178558826446533,1,,[{'dischtime': '2100-07-16 13:30:00'}],['dischtime'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 24, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004235 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1"
278f3690974261bfe1e57d23,Count the number of patients since 1 year ago that were discharged from the hospital.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",True,0.0666661262512207,0.0679140090942382,1,,[{'COUNT( DISTINCT admissions.subject_id )': 172553}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]",False,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')"
1abc175490e91fdbe78482fb,Has a microbiological test been done for patient 10001217 in this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",True,0.0689678192138671,0.0698215961456298,1,,[{'COUNT(*)>0': 0}],['COUNT(*)>0'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}, {""id"": 8, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 10, ""parent"": 8, ""notused"": 0, ""detail"": ""SCAN admissions""}]",False,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
fd2461146ec138678719d7e3,What was the microbiology test given to patient 10002495 for the last time in the last hospital visit?,SELECT microbiologyevents.test_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiologyevents.test_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,True,0.0802967548370361,0.0811808109283447,1,,[{'test_name': 'respiratory culture'}],['test_name'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 13, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 29, ""parent"": 9, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 50, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,SELECT microbiologyevents.test_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1
a85685397831a790ea2cc0a7,The number of patients in med/surg/gyn since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND strftime('%Y',transfers.intime) >= '2100' )",True,0.0987122058868408,0.099597692489624,1,,[{'COUNT( DISTINCT admissions.subject_id )': 9530}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 6, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH admissions USING INDEX sqlite_autoindex_admissions_2 (hadm_id=?)""}, {""id"": 10, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 12, ""parent"": 10, ""notused"": 0, ""detail"": ""SCAN transfers""}]",False,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND strftime('%Y',transfers.intime) >= '2100' )"
fe2d6c0f694f5a4cc2357932,What was the name of the medicine that was prescribed to patient 10005817 for the first time since 09/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1",True,0.3736016750335693,0.3744874000549316,1,,[{'drug': 'docusate sodium'}],['drug'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 37, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1"
727a314e82ff330ad11ea76a,What medication was last prescribed to patient 10020187 via po in 02/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ORDER BY prescriptions.starttime DESC LIMIT 1",True,0.3916518688201904,0.3925249576568603,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 47, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ORDER BY prescriptions.starttime DESC LIMIT 1"
4fcb903cb5d317c791dae3af,List the five most common microbiology tests conducted since 2100.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",True,0.428652286529541,0.4295306205749511,5,,"[{'test_name': 'blood culture, routine'}, {'test_name': 'urine culture'}, {'test_name': 'respiratory culture'}, {'test_name': 'gram stain'}, {'test_name': 'wound culture'}]",['test_name'],"[{""id"": 2, ""parent"": 0, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 5, ""parent"": 2, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-3)""}, {""id"": 12, ""parent"": 5, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}, {""id"": 17, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 52, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 66, ""parent"": 2, ""notused"": 0, ""detail"": ""SCAN (subquery-3)""}, {""id"": 128, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T1""}]",False,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5"
14bb6c7bed022d576caf2a44,Which alternative route was most prescribed to patients under 30 years old?,,"SELECT T1.route FROM ( SELECT admissions.subject_id, prescriptions.route, COUNT(*) AS C1 FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age < 30 AND prescriptions.route != 'iv' GROUP BY admissions.subject_id, prescriptions.route ) AS T1 GROUP BY T1.route ORDER BY T1.C1 DESC LIMIT 1",True,1.3034553527832031,1.3041610717773438,1,,[{'route': 'impella'}],['route'],"[{""id"": 2, ""parent"": 0, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 10, ""parent"": 2, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 14, ""parent"": 2, ""notused"": 0, ""detail"": ""SEARCH admissions USING INDEX sqlite_autoindex_admissions_2 (hadm_id=?)""}, {""id"": 22, ""parent"": 2, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 65, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T1""}, {""id"": 68, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 108, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT T1.route FROM ( SELECT admissions.subject_id, prescriptions.route, COUNT(*) AS C1 FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age < 30 AND prescriptions.route != 'iv' GROUP BY admissions.subject_id, prescriptions.route ) AS T1 GROUP BY T1.route ORDER BY T1.C1 DESC LIMIT 1"
314c43e484535c98944bc116,"When did patient 10005817 receive the first lab test, since 08/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1",True,1.4861481189727783,1.4867703914642334,1,,[{'charttime': '2100-12-20 02:08:00'}],['charttime'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN labevents""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 36, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1"
2b3268beab056ff505b05347,Has patient 10029291 undergone a laboratory test since 01/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'",True,1.4941997528076172,1.494778394699097,1,,[{'COUNT(*)>0': 1}],['COUNT(*)>0'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN labevents""}, {""id"": 8, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 10, ""parent"": 8, ""notused"": 0, ""detail"": ""SCAN admissions""}]",False,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'"
f7e273153edfeb72b98bd9c7,"When did patient 10009628 receive the last lab test, in 10/this year?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1",True,1.6107420921325684,1.61137056350708,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN labevents""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 44, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1"
