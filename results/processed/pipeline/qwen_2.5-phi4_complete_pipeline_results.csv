id,question,true_query,generated_query,success,execution_time,total_time,row_count,error,results,result_columns,execution_plan,validation_applied,final_query
b10d95d377e7fd96548c50cd,What are the distances of patients with medicaid?,,SELECT DISTINCT admissions.distance FROM admissions WHERE admissions.insurance = 'medicaid',False,0.0,0.002337217330932617,0,no such column: admissions.covid_distance,,,,True,SELECT DISTINCT admissions.covid_distance FROM admissions WHERE admissions.insurance = 'medicaid';
7a1c80e590227785f1b6c6a6,"Compared to second to last measured on the last ICU visit, is the o2 saturation pulseoxymetry value of patient 10020944 last measured on the last ICU visit less?",SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT o2 saturation pulseoxymetry FROM patientchartevents WHERE patientchartevents.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.patient_id = 10020944 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND patientchartevents.itemid IN ( SELECT itemids.itemid FROM itemids WHERE itemids.label = 'o2 saturation pulseoxymetry' ) ORDER BY patientchartevents.charttime DESC LIMIT 1 OFFSET 1 ) > ( SELECT o2 saturation pulseoxymetry FROM patientchartevents WHERE patientchartevents.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.patient_id = 10020944 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND patientchartevents.itemid IN ( SELECT itemids.itemid FROM itemids WHERE itemids.label = 'o2 saturation pulseoxymetry' ) ORDER BY patientchartevents.charttime DESC LIMIT 1 ),False,0.0,0.001241922378540039,0,incomplete input,,,,True,SELECT ( SELECT oxygensaturationpulseoxymetry.valuenum FROM oxygensaturationpulseoxymetry WHERE oxygensaturationpulseoxymetry.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY oxygensaturationpulseoxymetry.charttime DESC LIMIT 1 ) < ( SELECT oxygensaturationpulseoxymetry.valuenum FROM oxygensaturationpulseoxymetry WHERE oxygensaturationpulseoxymetry.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY oxygensaturationpulseoxymetry.charttime DESC LIMIT 1 OFFSET 1 );
550a6a2fb0ecbf40e74fdb86,What was the last value of the o2 saturation pulseoxymetry of patient 10010471?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT o2 saturation pulseoxymetry FROM patientchartevents WHERE patientchartevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND patientchartevents.itemid IN ( SELECT devicerecorditems.itemid FROM devicerecorditems WHERE devicerecorditems.label = 'o2 saturation pulseoxymetry' ) ORDER BY patientchartevents.charttime DESC LIMIT 1,False,0.0,0.0019202232360839844,0,no such column: patients.o2_saturation_pulseoxymetry,,,,True,SELECT patients.o2_saturation_pulseoxymetry FROM patients WHERE patients.subject_id = 10010471 AND patients.o2_saturation_pulseoxymetry IS NOT NULL ORDER BY patients.charttime DESC LIMIT 1;
7bc94deacf6c02cba88f38e5,What is the average total cost of a hospital visit that involves a procedure known as other bronchoscopy in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other bronchoscopy' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM( admissions.payamount ) AS C1 FROM admissions WHERE admissions.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.procedure_name = 'other bronchoscopy' ) AND strftime('%Y',admissions.dischtime) = '2100' GROUP BY admissions.subject_id ) AS T1",True,0.0,0.002530336380004883,0,,[{'AVG(T1.C1)': 7.289999999999999}],,,True,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other bronchoscopy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) GROUP BY cost.event_type, cost.event_id ) AS T1;"
747ed9e0734b371799a079ed,"What was the name of a drug that patient 10005817 was prescribed within 2 days after being diagnosed with chronic airway obstruction, not elsewhere classified throughout this month?","SELECT T2.drug FROM ( SELECT diagnoses_icd.charttime, diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic airway obstruction, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT T2.drug FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = '496' AND admissions.subject_id = 10005817 AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10005817 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",False,0.0,0.002538442611694336,0,incomplete input,,,,True,"SELECT T2.drug FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic airway obstruction, not elsewhere classified' ) AND admissions.subject_id = 10005817 AND datetime(diagnoses_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10005817 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day');"
18712984cf426bc265ef3c86,"Compared to first measured on the first ICU visit, is the o2 saturation pulseoxymetry value of patient 10010471 last measured on the first ICU visit greater?",SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT o2 saturation pulseoxymetry FROM patientchartevents WHERE patientchartevents.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.patient_id = 10010471 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND patientchartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.event_type = 'o2 saturation pulseoxymetry' ) ORDER BY patientchartevents.charttime DESC LIMIT 1 ) > ( SELECT o2 saturation pulseoxymetry FROM patientchartevents WHERE patientchartevents.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.patient_id = 10010471 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND patientchartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.event_type = 'o2 saturation pulseoxymetry' ) ORDER BY patientchartevents.charttime ASC LIMIT 1 ),False,0.0,0.0026559829711914062,0,incomplete input,,,,True,SELECT ( SELECT oxygensaturationpulseoxymetry.valuenum FROM oxygensaturationpulseoxymetry WHERE oxygensaturationpulseoxymetry.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY oxygensaturationpulseoxymetry.charttime DESC LIMIT 1 ) > ( SELECT oxygensaturationpulseoxymetry.valuenum FROM oxygensaturationpulseoxymetry WHERE oxygensaturationpulseoxymetry.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY oxygensaturationpulseoxymetry.charttime ASC LIMIT 1 );
5ae9eba9c11262b3bc8961b7,Tell me the change in the systolic blood pressure of patient 10020187 last measured on the last ICU visit compared to the value second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.label = 'arterial blood pressure systolic' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.label = 'arterial blood pressure systolic' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),False,0.0,0.003523111343383789,0,incomplete input,,,,True,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.label = 'arterial blood pressure systolic' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.label = 'arterial blood pressure systolic' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 );
48e40b5c41147007595a5175,"Since 2100, what are the top three most frequent drugs prescribed to patients within 2 months after the prescription of donepezil?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'donepezil' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.starttime) AND datetime(T1.starttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions WHERE prescriptions.drug = 'donepezil' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.starttime) AND datetime(T1.starttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",False,0.0,0.0036191940307617188,0,incomplete input,,,,True,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'donepezil' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.starttime) AND datetime(T1.starttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3;"
d60412f228f0e3b6df5b6d8c,Has any medication been given to patient 10021312 since 03/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03'",False,0.0,0.00499272346496582,0,no such column: admissions.stay_id,,,,True,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03';"
c6b99f4f9a4e559291bc20d4,What was the name of the medicine that was prescribed to patient 10027602 in the same hospital encounter after receiving the endovascular (total) embolization or occlusion of head and neck vessels procedure since 3 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endovascular (total) embolization or occlusion of head and neck vessels' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-3 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-3 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '09.54' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-3 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-3 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",False,0.0,0.0035011768341064453,0,incomplete input,,,,True,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'endovascular (total) embolization or occlusion of head and neck vessels' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-3 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-3 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime;"
4b624ad8a3b82ed7e3e29dc3,What are the three diagnoses associated with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY T1.C2 ASC ) AS C1 FROM ( SELECT STRFTIME('%Y-%m',T1.charttime) AS C0, AVG(CASE WHEN strftime('%J',T1.charttime) < strftime('%J',T2.charttime) THEN 0 ELSE 1 END) AS C2 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.icd_version, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.icd_version, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id HAVING MAX(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.icd_code",False,0.0,0.003624439239501953,0,incomplete input,,,,True,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C4 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C4 <= 3 );"
429abe1449551a068765e97e,What are the documents required for hospital discharge?,,"SELECT DISTINCT T1.title FROM ( SELECT admissions.subject_id, documents.title FROM documents JOIN admissions ON documents.hadm_id = admissions.hadm_id WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id, documents.title ) AS T1",False,0.0,0.0043833255767822266,0,no such table: discharge,,,,True,SELECT DISTINCT discharge.summary FROM discharge WHERE discharge.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL );
db3c11ffd16f4f7b363b7a95,List the four most common diagnoses that were given to patients during the same month after receiving hemodialysis during this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.label FROM ( SELECT T2.label, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.procedure_name = 'hemodialysis' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.label FROM diagnoses WHERE datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.label ) AS T3 WHERE T3.C1 <= 4",False,0.0,0.0029048919677734375,0,"unrecognized token: ""'start of y""",,,,True,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C1 DESC ) AS C2 FROM ( SELECT T2.icd_code, COUNT(*) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C2 <= 4 );"
930950b0e61480275d875940,Do we have some singer names of the patients who died 3 days ago?,,"SELECT T1.singer_name FROM ( SELECT admissions.subject_id, singers.singer_name FROM singers JOIN admissions ON singers.subject_id = admissions.subject_id WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-3 day') ) AS T1",False,0.0,0.005053281784057617,0,no such column: patients.singers,,,,True,"SELECT T1.singer_name FROM ( SELECT admissions.subject_id, patients.singers FROM patients JOIN admissions ON patients.subject_id = admissions.subject_id WHERE admissions.dod IS NOT NULL AND datetime(admissions.dod) = datetime(current_time,'-3 day') ) AS T1;"
6019c6cfa331a76747e3e179,Just count the number of patients asked for a copy of their prescription during hospital stay.,,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions_hadm_ids.hadm_id FROM prescriptions_hadm_ids WHERE prescriptions_hadm_ids.request_copy = 1 ),False,0.0,0.003715038299560547,0,no such column: prescriptions.request_inhospital_copy,,,,True,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.request_inhospital_copy = 1 );
f2be9084ce59ddbf5372d16a,What was the name of the organism that was discovered in the last urine test of patient 10019172 during the previous month?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT T1.org_name FROM ( SELECT microbiologyevents.org_name, DENSE_RANK() OVER ( PARTITION BY microbiologyevents.hadm_id ORDER BY microbiologyevents.charttime DESC ) AS C1 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ) AS T1 WHERE T1.C1 = 1 AND datetime(T1.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",True,0.0,0.0026748180389404297,0,,,,,True,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1;"
49096da9fc4db23df0c9ca94,Is the value of the respiratory rate of patient 10038999 last measured on the last ICU visit greater than that second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"SELECT ( SELECT respiratoryrate FROM ( SELECT respiratoryrate, datetime, ROW_NUMBER() OVER ( ORDER BY datetime DESC ) AS rn FROM inputevents WHERE inputevents.stayid IN ( SELECT icustays.stayid FROM icustays WHERE icustays.patientid = 10038999 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT itemids.itemid FROM itemids WHERE itemids.label = 'respiratory rate' ) ) WHERE rn = 1 ) > ( SELECT respiratoryrate FROM ( SELECT respiratoryrate, datetime, ROW_NUMBER() OVER ( ORDER BY datetime DESC ) AS rn FROM inputevents WHERE inputevents.stayid IN ( SELECT icustays.stayid FROM icustays WHERE icustays.patientid = 10038999 AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT itemids.itemid FROM itemids WHERE itemids.label = 'respiratory rate' ) ) WHERE rn = 2 )",False,0.0,0.002980470657348633,0,"unrecognized token: ""'""",,,,True,"SELECT ( SELECT respiratoryrate FROM ( SELECT patients.respiratoryrate, icustays.outtime, ROW_NUMBER() OVER ( ORDER BY icustays.outtime DESC ) AS rn FROM patients JOIN icustays ON patients.hadm_id = icustays.hadm_id WHERE icustays.outtime IS NOT NULL AND patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND patients.itemid IN ( SELECT d_icd_items.itemid FROM d_icd_items WHERE d_icd_items.label = 'respiratory rate' AND d_icd_items.linksto = 'patients' ) ) AS T1 WHERE T1.rn = 1 ) > ( SELECT respiratoryrate FROM ( SELECT patients.respiratoryrate, icustays.outtime, ROW_NUMBER() OVER ( ORDER BY icustays.outtime DESC ) AS rn FROM patients JOIN icustays ON patients.hadm_id = icustays.hadm_id WHERE icustays.outtime IS NOT NULL AND patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND patients.itemid IN ( SELECT d_icd_items.itemid FROM d_icd_items WHERE d_icd_items.label = 'respiratory rate' AND d_icd_items.linksto = 'patients' ) ) AS T2 WHERE T2.rn = 2 );"
cb2576703363b2124ae28f7c,When was the first time patient 10010471 was having less than 27.0 respiratory rate on 12/20/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 27.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-20' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT admissions.subject_id, patients.gender, admissions.age, labevents.charttime FROM labevents WHERE labevents.respiratory_rate < 27.0 AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',labevents.charttime) = '12-20' ORDER BY labevents.charttime ASC LIMIT 1",False,0.0,0.003839731216430664,0,no such column: patients.charttime,,,,True,"SELECT patients.charttime FROM patients WHERE patients.respiratory_rate < 27.0 AND patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(patients.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',patients.charttime) = '12-20' ORDER BY patients.charttime ASC LIMIT 1;"
43c158cb01b2f2079157b719,How many patients were diagnosed with aortic valve disorders in the same month following the previous diagnosis of postprocedural fever since 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural fever' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'aortic valve disorders' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses.icd_code FROM diagnoses WHERE diagnoses.icd_code = 'postprocedural fever' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses WHERE diagnoses.icd_code = 'aortic valve disorders' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month','-1 month')",False,0.0,0.002386808395385742,0,incomplete input,,,,True,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural fever' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'aortic valve disorders' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month','-1 month');"
7d987252b086db272f8e0751,"What are the three most commonly tested specimens for patients that received drainage of peritoneal cavity, percutaneous approach previously in the same month in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.icd_code = '09.64' AND strftime('%Y',procedures.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime FROM specimens WHERE strftime('%Y',specimens.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",False,0.0,0.0024907588958740234,0,incomplete input,,,,True,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'drainage of peritoneal cavity, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime FROM specimens WHERE strftime('%Y',specimens.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3;"
325e6c5f09459a46cc53281b,Retrieve the top five most frequently tested specimens that patients took in the same hospital visit after being diagnosed with chronic lymphocytic leukemia of b-cell type not having achieved remission.,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic lymphocytic leukemia of b-cell type not having achieved remission' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.specimen_name FROM ( SELECT T2.specimen_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = '20469' ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.specimen_name, specimens.charttime, admissions.hadm_id FROM specimens JOIN admissions ON specimens.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.specimen_name ) AS T3 WHERE T3.C1 <= 5",False,0.0,0.002682924270629883,0,incomplete input,,,,True,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic lymphocytic leukemia of b-cell type not having achieved remission' ) ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime, admissions.hadm_id FROM specimens JOIN admissions ON specimens.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5;"
43dd6a535818b9817b393135,What currencies are used by the patients older than 40 this year?,,"SELECT DISTINCT admissions.payerplanid FROM admissions WHERE admissions.age > 40 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",False,0.0,0.005642414093017578,0,no such column: admissions.payer_cost,,,,True,"SELECT DISTINCT admissions.payer_cost FROM admissions WHERE admissions.age > 40 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year');"
9e06157df2f8d7330094763f,Tell me the total amount of solution that patient 10019917 had on 01/28/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-28'","SELECT SUM(inputamount) FROM inputevents WHERE inputevents.stayid IN ( SELECT admissions.stayid FROM admissions WHERE admissions.subject_id = 10019917 ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-28'",False,0.0,0.004297971725463867,0,no such column: admissions.stay_id,,,,True,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-28' AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' );"
84c0a3f1d8f6eba51c9d5bee,What is the average speed in knots for patients who were admitted to the icu for the past three months?,,"SELECT AVG(T1.valuenum) FROM ( SELECT admissions.subject_id, admissions.hadm_id, icustays.stay_id FROM icustays JOIN admissions ON icustays.hadm_id = admissions.hadm_id WHERE datetime(icustays.intime) >= datetime(current_time,'-3 month') ) AS T1 JOIN ( SELECT admissions.subject_id, admissions.hadm_id, labevents.valuenum FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'speed in knots' ) AND datetime(labevents.charttime) >= datetime(current_time,'-3 month') ) AS T2 ON T1.subject_id = T2.subject_id",False,0.0,0.0017163753509521484,0,incomplete input,,,,True,"SELECT AVG(T2.valuenum) FROM ( SELECT admissions.subject_id, icustays.stay_id FROM icustays JOIN admissions ON icustays.hadm_id = admissions.hadm_id WHERE datetime(icustays.intime) >= datetime(current_time,'-3 month') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.valuenum FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE microbiologyevents.spec_type_desc = 'speed in knots' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-3 month') ) AS T2 ON T1.subject_id = T2.subject_id;"
e80f4420e687a67930a3fe82,How is tamoxifen citrate delivered to the body?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate',SELECT DISTINCT drugs.drug FROM drugs WHERE drugs.drug = 'tamoxifen citrate',True,0.0,0.003957509994506836,0,,[{'route': 'po'}],,,True,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate';
0df69b82de6a35ad5bdec3d3,What drug was first prescribed to patient 10010471 via neb route since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT drugs.drug FROM ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10010471 AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1 ) AS first_neb_prescription",True,0.0,0.004339694976806641,0,,[{'drug': 'ipratropium-albuterol neb'}],,,True,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1;"
6f03fb45abf03355fdf2ebe5,What is the average age of the first child for patients with hypertension?,,"SELECT AVG(T1.age) FROM ( SELECT admissions.subject_id, patients.dob FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'hypertension' ) ) ) AS T1 JOIN ( SELECT admissions.subject_id, birthtime FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'family history of hypertension' ) ) ) AS T2 ON T1.subject_id = T2.subject_id",False,0.0,0.0037965774536132812,0,incomplete input,,,,True,"SELECT AVG(T1.age) FROM ( SELECT admissions.subject_id, patients.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertension' ) ) ) AS T1 JOIN ( SELECT admissions.subject_id, patients.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'child' ) ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.age < T2.age;"
9f0ee496296456e6f48a49a6,What was patient 10002495's minimum protein value on the last hospital encounter?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ),SELECT MIN(labtests.protein) FROM labtests WHERE labtests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),True,0.0,0.003523588180541992,0,,[{'MIN(labevents.valuenum)': 30.0}],,,True,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' );
35fbd2bb7e73dec7b0390bfd,What are the documents necessary for hospital discharge?,,"SELECT DISTINCT T1.title FROM ( SELECT admissions.subject_id, documents.title FROM documents JOIN admissions ON documents.hadm_id = admissions.hadm_id WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id, documents.title ) AS T1",False,0.0,0.004021406173706055,0,no such table: discharge,,,,True,SELECT DISTINCT discharge.summary FROM discharge WHERE discharge.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL );
2666b04409be1528ae23a0f2,Give me the top four most commonly prescribed medications within 2 months to the patients aged 60 or above after diagnosed with esophageal reflux since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = '530.81' AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",False,0.0,0.001491546630859375,0,incomplete input,,,,True,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4;"
daa34761c136dbde698516a2,What were the top four frequent input events in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT inputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM inputevents WHERE strftime('%Y',inputevents.starttime) = '2100' GROUP BY inputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.itemid, T1.label FROM ( SELECT inputevents.event_type, COUNT(*) AS C1 FROM inputevents WHERE strftime('%Y',inputevents.starttime) = '2100' GROUP BY inputevents.event_type ) AS T1 JOIN ( SELECT inputevents.event_type, COUNT(*) AS C2 FROM inputevents WHERE strftime('%Y',inputevents.starttime) = '2100' GROUP BY inputevents.event_type ) AS T2 ON T1.event_type = T2.event_type WHERE T1.C1 >= T2.C2 AND rowid <= 4",False,0.0,0.005219936370849609,0,incomplete input,,,,True,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 DESC ) AS C4 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',inputevents.starttime) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',procedures_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, procedures_icd.icd_code HAVING MIN(procedures_icd.charttime) = procedures_icd.charttime ) AS T1 JOIN inputevents ON T1.subject_id = inputevents.stay_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C4 <= 4 );"
2034fc68a5d4b41c3ad01684,When was the first time patient 10007795 got a prescription for gemfibrozil and lactated ringers at the same time since 06/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.charttime = admissions.admittime WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.charttime = admissions.admittime WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",False,0.0,0.0012760162353515625,0,incomplete input,,,,True,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'gemfibrozil' AND admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1;"
9b6fff1f017a3163467fb155,Please tell me the total number of patients who had a dextrose 50% input this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT icustays.hadm_id FROM icustays WHERE icustays.stay_id IN ( SELECT inputevents.stay_id FROM inputevents WHERE inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT inputevents.hadm_id FROM inputevents WHERE inputevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'dextrose 50%' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",True,0.0,0.0027379989624023438,0,,[{'COUNT( DISTINCT admissions.subject_id )': 0}],,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT inputevents.stay_id FROM inputevents WHERE inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') );"
45ecebf7e481e6c14fdc01cd,What was the last input given to patient 10018081 on 12/30/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT inputevents.itemid FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-30' ORDER BY inputevents.starttime DESC LIMIT 1 )","SELECT inputroute.name FROM inputroute WHERE inputroute.charttime IN ( SELECT inputs.inputroutecharttime FROM inputs WHERE inputs.stayid IN ( SELECT admissions.stayid FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(inputs.inputroutecharttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputs.inputroutecharttime) = '12-30' ORDER BY inputs.inputroutecharttime DESC LIMIT 1 )",False,0.0,0.0019769668579101562,0,no such table: inputs,,,,True,"SELECT inputs.itemid FROM inputs WHERE inputs.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(inputs.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputs.starttime) = '12-30' ORDER BY inputs.starttime DESC LIMIT 1;"
53761ebb18ac5c642c4f2006,When was the time that patient 10010471's respiratory rate was greater than 25.0 for the first time on this month/19?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 25.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '19' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT admissions.subject_id, patients.gender, admissions.age, labevents.charttime FROM labevents WHERE labevents.respiratoryrate > 25.0 AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',labevents.charttime) = '19' ORDER BY labevents.charttime ASC LIMIT 1",False,0.0,0.0039403438568115234,0,no such column: patients.charttime,,,,True,"SELECT patients.charttime FROM patients WHERE patients.respiratoryrate > 25.0 AND patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(patients.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',patients.charttime) = '19' ORDER BY patients.charttime ASC LIMIT 1;"
fdc9e1c2af088aa194e9faa5,Has patient 10005817 been administered any medication in 04/last year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '04'",False,0.0,0.002198457717895508,0,no such column: admissions.stay_id,,,,True,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '04';"
9ea8c0016a33c461c3a77f56,How much does the systolic blood pressure of patient 10037975 change second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT systolicbloodpressure FROM ( SELECT systolicbloodpressure, ROW_NUMBER() OVER ( ORDER BY charttime ) AS rownum FROM bloodpressure WHERE bloodpressure.icustays_id IN ( SELECT icustays.icustays_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ) WHERE rownum = 2 ) - ( SELECT systolicbloodpressure FROM ( SELECT systolicbloodpressure, ROW_NUMBER() OVER ( ORDER BY charttime ) AS rownum FROM bloodpressure WHERE bloodpressure.icustays_id IN ( SELECT icustays.icustays_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ) WHERE rownum = 1 )",False,0.0,0.0014965534210205078,0,incomplete input,,,,True,SELECT ( SELECT bloodpressure.valuenum FROM bloodpressure WHERE bloodpressure.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND bloodpressure.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'bloodpressure' ) ORDER BY bloodpressure.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT bloodpressure.valuenum FROM bloodpressure WHERE bloodpressure.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND bloodpressure.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'bloodpressure' ) ORDER BY bloodpressure.charttime ASC LIMIT 1 );
ed1c971e6bd14f5788256c98,"For patients who took diagnostic ultrasound of digestive system , what are the top three most frequent specimens tested afterward within the same hospital visit?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnostic_ultrasound_of_digestive_system.charttime, admissions.hadm_id FROM diagnostic_ultrasound_of_digestive_system JOIN admissions ON diagnostic_ultrasound_of_digestive_system.subject_id = admissions.subject_id ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime, admissions.hadm_id FROM specimens JOIN admissions ON specimens.subject_id = admissions.subject_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",False,0.0,0.0012030601501464844,0,"near ""JOI"": syntax error",,,,True,"SELECT d_items.itemname FROM d_items WHERE d_items.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.procedurename = 'diagnostic ultrasound of digestive system' ) ) AS T1 JOIN ( SELECT admissions.subject_id, d_items.itemid, d_items.itemname, specimens.charttime, admissions.hadm_id FROM specimens JOIN admissions ON specimens.hadm_id = admissions.hadm_id JOIN d_items ON specimens.itemid = d_items.itemid ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 );"
ea6a1b775d7a1387dac35ee2,What was the last value of arterial blood pressure systolic of patient 10003046 in the first ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT arterialbloodpressure systolic FROM patientchartevents WHERE patientchartevents.stayid IN ( SELECT admissions.stayid FROM admissions WHERE admissions.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.subject_id = 10003046 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.intime ASC LIMIT 1 ) AND patientchartevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.label = 'arterial blood pressure systolic' ) ORDER BY patientchartevents.charttime DESC LIMIT 1,False,0.0,0.0022313594818115234,0,no such table: arterialbloodpressure,,,,True,SELECT arterialbloodpressure.systolic FROM arterialbloodpressure WHERE arterialbloodpressure.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.subject_id = 10003046 ) AND admissions.outtime IS NOT NULL ORDER BY admissions.intime ASC LIMIT 1 ) ORDER BY arterialbloodpressure.charttime DESC LIMIT 1;
4c6f37b09e9230a451cda980,What are the majors of the patients admitted to the icu whose first care unit is micu in the previous month?,,"SELECT DISTINCT patients.majors FROM patients WHERE patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.careunit = 'micu' AND datetime(admissions.intime,'start of month','-1 month') = datetime(current_time,'start of month','-1 month') )",False,0.0,0.00205230712890625,0,no such column: admissions.majors,,,,True,"SELECT DISTINCT admissions.majors FROM admissions WHERE admissions.careunit = 'micu' AND datetime(admissions.intime,'start of month') = datetime(current_time,'start of month','-1 month');"
b5704c126bc27a7b3e42628a,Please tell me the telephone number of patient 273's companion.,,"SELECT T1.compmrn FROM ( SELECT admissions.compmrn, patients.telephone FROM admissions WHERE admissions.subject_id = 273 ) AS T1 WHERE T1.compmrn IS NOT NULL",False,0.0,0.0021948814392089844,0,no such column: patients.phone,,,,True,SELECT patients.phone FROM patients WHERE patients.subject_id IN ( SELECT admissions.copayimprovetoid FROM admissions WHERE admissions.subject_id = 273 );
95de1cbfea9cbbf15a57c2e4,Tell me the first value of eag in patient 10008454 in 12/this year.,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eag' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime ASC LIMIT 1","SELECT eag FROM labtests WHERE labtests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(labtests.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labtests.charttime) = '12' ORDER BY labtests.charttime ASC LIMIT 1",True,0.0,0.002221822738647461,0,,,,,True,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eag' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime ASC LIMIT 1;"
e634517291db8bd82ef6a1b7,"What was the name of the drug, which patient 10012853 was prescribed in the same day after being diagnosed with peripheral vascular disease, unspecified on their last hospital visit?","SELECT T2.drug FROM ( SELECT diagnoses_icd.charttime, diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'peripheral vascular disease, unspecified' ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT T2.drug FROM ( SELECT events.charttime, events.hadm_id FROM ( SELECT admissions.subject_id, admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AS s0 JOIN ( SELECT diagnoses_icd.icd_code, diagnoses_icd.charttime, diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = '443.9' AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) ) AS s1 ON s0.hadm_id = s1.hadm_id WHERE datetime(s0.charttime) >= datetime(s1.charttime) ORDER BY s1.charttime DESC LIMIT 1 ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE datetime(T1.charttime) < datetime(T2.starttime) AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T",False,0.0,0.0013086795806884766,0,incomplete input,,,,True,"SELECT T2.drug FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'peripheral vascular disease, unspecified' ) AND admissions.subject_id = 10012853 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10012853 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day');"
1eb7d8845e0439e31945047c,"What were the five most frequent drugs that were prescribed within 2 months to patients in their 50s after diagnosed with acute pulmonary edema, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute pulmonary edema' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = 'acute pulmonary edema' AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",False,0.0,0.001394033432006836,0,incomplete input,,,,True,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute pulmonary edema' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5;"
619c0d97069b2720eecadf4c,What types of anesthesia are most common in the fusion or refusion of 2-3 vertebrae procedure?,,"SELECT T1.anesthesia FROM ( SELECT procedures_icd.icd_code, icd_procedures.title, patients.subject_id, procedures_icd.charttime, icd_procedures.long_title, admissions.hadm_id FROM procedures_icd JOIN icd_procedures ON procedures_icd.icd_code = icd_procedures.icd_code JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE icd_procedures.title = 'fusion or refusion of 2-3 vertebrae' ) AS T1 JOIN ( SELECT procedures_icd.icd_code, icd_procedures.title, patients.subject_id, procedures_icd.charttime, icd_procedures.long_title, admissions.hadm_id FROM procedures_icd JOIN icd_procedures ON procedures_icd.icd_code = icd_procedures.icd_code JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE icd_procedures.title = 'anesthesia' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.charttime) >= datetime(T2.charttime) GROUP BY T2.title ORDER BY COUNT(*) DESC LIMIT 1",False,0.0,0.001199483871459961,0,incomplete input,,,,True,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY T2.C1 DESC ) AS C2 FROM ( SELECT procedures_icd.icd_code, COUNT(*) AS C1 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fusion or refusion of 2-3 vertebrae' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') GROUP BY procedures_icd.icd_code ) AS T2 ) AS T3 WHERE T3.C2 <= 4 );"
e8a376ca7f202983221786bd,"Can you tell me the daily maximum weight of patient 10018081, taken since 11/2100?","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-11' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT MAX(weight) FROM weights WHERE weights.patient_id = 10018081 AND strftime('%Y-%m',weights.charttime) >= '2100-11' GROUP BY strftime('%Y-%m-%d',weights.charttime)",False,0.0,0.0019724369049072266,0,no such column: measurevaluenum,,,,True,"SELECT MAX(measurevaluenum) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' GROUP BY strftime('%Y-%m-%d',microbiologyevents.charttime);"
0c85596eb9a5ce81b6fb531c,Has patient 10005909 had any procedure throughout this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",True,0.0,0.0023555755615234375,0,,[{'COUNT(*)>0': 0}],,,True,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year');"
e5441310205bb859e8ca31ba,Can you provide the first value of the hemoglobin for patient 10023117 in the first hospital encounter?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT labtests.valuenum FROM labtests WHERE labtests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labtests.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'hemoglobin' ) ORDER BY labtests.charttime ASC LIMIT 1,True,0.0,0.0023336410522460938,0,,[{'valuenum': 13.7}],,,True,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1;
064647795088c18c2eea104a,What is the maximum total price for a hospital that includes a medication named vial in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vial' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM( admissions.payamount ) AS C1 FROM admissions WHERE admissions.hadm_id IN ( SELECT medications.hadm_id FROM medications WHERE medications.drug = 'vial' ) AND strftime('%Y',admissions.admittime) = '2100' GROUP BY admissions.hadm_id ) AS T1",True,0.0,0.00209808349609375,0,,[{'MAX(T1.C1)': 360.06}],,,True,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vial' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1;"
7c6f2aa274207d68024f4cd4,Could you tell me the top four most frequent treatments that were administered to patients during the same hospital encounter after they had fluoroscopy of right heart using other contrast since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of right heart using other contrast' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.activity FROM ( SELECT T2.activity, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, encounters.hadm_id FROM encounters JOIN admissions ON encounters.hadm_id = admissions.hadm_id WHERE encounters.icd_code = '01.25' AND strftime('%Y',encounters.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, encounters.hadm_id, procedures.activity FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.hadm_id = T2.hadm_id GROUP BY T2.activity ) AS T3 WHERE T3.C1 <= 4",False,0.0,0.0011639595031738281,0,incomplete input,,,,True,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY T2.C1 DESC ) AS C2 FROM ( SELECT T1.icd_code, COUNT(*) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of right heart using other contrast' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T1.icd_code ) AS T2 ) AS T3 WHERE T3.C2 <= 4 );"
b23b961d0f2fe2cf1eec5a22,Was the heart rate of patient 10019777 within the normal range in their first hospital visit?,SELECT 1 - COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum NOT BETWEEN heart_rate_lower AND heart_rate_upper,"SELECT COUNT(*)>0 FROM ( SELECT * FROM ( SELECT heart_rate, DENSE_RANK() OVER ( ORDER BY charttime ) AS c1 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) WHERE heart_rate BETWEEN 60 AND 100",False,0.0,0.0011136531829833984,0,incomplete input,,,,True,"SELECT COUNT(*)>0 FROM ( SELECT * FROM ( SELECT vital_signs.valuenum, DENSE_RANK() OVER ( ORDER BY vital_signs.charttime ASC ) AS c1 FROM vital_signs WHERE vital_signs.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND vital_signs.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'vital_signs' ) ) WHERE vital_signs.valuenum BETWEEN 60 AND 100 AND vital_signs.c1 = 1 );"
732ddbd8735aa1ef150a5da1,Has patient 10004733 been provided with any lidocaine 1% during this hospital encounter?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'lidocaine 1%',SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.itemid IN ( SELECT inputevents.itemid FROM inputevents WHERE inputevents.strength = '1%' AND inputevents.name = 'lidocaine' ) AND inputevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ),False,0.0,0.002028226852416992,0,no such column: admissions.stay_id,,,,True,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lidocaine 1%' );
ecd65c3d262d3e34018c162c,What lab tests did patient 10001725 get for the last time since 9 months ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND datetime(labevents.charttime) >= datetime(current_time,'-9 month') ORDER BY labevents.charttime DESC LIMIT 1 )","SELECT labtests.name FROM labtests WHERE labtests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND datetime(labtests.charttime) >= datetime(current_time,'-9 month') ORDER BY labtests.charttime DESC LIMIT 1",True,0.0,0.0019068717956542969,0,,[{'label': 'epithelial cells'}],,,True,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND datetime(labevents.charttime) >= datetime(current_time,'-9 month') ORDER BY labevents.charttime DESC LIMIT 1 );"
056fb750773e90aa030e9950,What is the most common operating system among asian patients?,,SELECT T1.C1 FROM ( SELECT COUNT( DISTINCT subject_id ) AS C1 FROM patients WHERE patients.ethnicity = 'asian' GROUP BY patients.operating_system ) AS T1 ORDER BY T1.C1 DESC LIMIT 1,False,0.0,0.0016522407531738281,0,no such column: admissions.ethnicity,,,,True,SELECT T1.C1 FROM ( SELECT COUNT( DISTINCT admissions.subject_id ) AS C1 FROM admissions WHERE admissions.ethnicity = 'asian' GROUP BY admissions.operating_system ) AS T1 ORDER BY T1.C1 DESC LIMIT 1;
2bd36cdf648a73c1405bc0bd,What was the procedure patient 10007795 received two times since 01/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-01' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT T1.procedure_name FROM ( SELECT procedures_icd.icd_code AS icd_code, icd_procedures.procedure_name AS procedure_name FROM procedures_icd JOIN icd_procedures ON procedures_icd.icd_code = icd_procedures.icd_code WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-01' GROUP BY procedures_icd.icd_code HAVING COUNT(*) = 2 ) AS T1",False,0.0,0.0017368793487548828,0,no such column: procedures_icd.procedure_name,,,,True,"SELECT T1.procedure_name FROM ( SELECT procedures_icd.procedure_name, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-01' GROUP BY procedures_icd.procedure_name ) AS T1 WHERE T1.C1 = 2;"
05a8454a6a71435a557db2cc,Has patient 10004733 got a central venous catheter placement with guidance treatment during this hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ),SELECT COUNT(*)>0 FROM procedures WHERE procedures.icd_code = '09.2' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ),True,0.0,0.0016064643859863281,0,,[{'COUNT(*)>0': 1}],,,True,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL );
1d6044d33845efb3cb927bac,How many patients admitted this year reported no allergies?,,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT hadm_id FROM patientevents WHERE patientevents.itemid IN ( SELECT itemid FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '403.9' ) ) AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",False,0.0,0.002009868621826172,0,no such table: allergies,,,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT hadm_id FROM allergies WHERE allergies.c1 = 'no' ) AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year');"
b7b46d74fb37a9539786e740,Does patient 17667 have any tests left to do before discharge?,,SELECT COUNT(*)>0 FROM tests WHERE tests.patient_id = 17667 AND tests.status = 'pending',True,0.0,0.0017249584197998047,0,,[{'COUNT(*)>0': 0}],,,True,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 17667 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tests' );
33531c8f62b92bd9245b9217,Which are the four diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )","SELECT T1.C1 FROM ( SELECT DIAGNOSES_ICD.diagnosis, COUNT( DISTINCT patients.subject_id ) AS C1 FROM DIAGNOSES_ICD WHERE DIAGNOSES_ICD.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL ) AND datetime(admissions.dischtime) BETWEEN datetime(current_time,'-6 month') AND current_time GROUP BY DIAGNOSES_ICD.diagnosis ) AS T1 WHERE T1.C1 IN ( SELECT T2.C1 FROM ( SELECT DIAGNOSES_ICD.diagnosis, COUNT( DISTINCT patients.subject_id ) AS C1 FROM DIAGNOSES_ICD WHERE DIAGNOSES_ICD.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL ) AND datetime(admissions.dischtime) BETWEEN datetime(current_time,'-6 month') AND current_time GROUP BY DIAGNOSES_ICD.diagnosis ) AS T2 ORDER BY T2.C1 DESC LIMIT 4 )",False,0.0,0.0010671615600585938,0,incomplete input,,,,True,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 );"
23aeb815d2db0889eb0f2b24,"Since 2100, has patient 10015931 received a encounter for examination for normal comparison and control in clinical research program diagnosis?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for examination for normal comparison and control in clinical research program' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'","SELECT COUNT(*)>0 FROM clinicalresearch.encounters WHERE clinicalresearch.encounters.program_name = 'examination for normal comparison and control' AND clinicalresearch.encounters.subject_id = 10015931 AND strftime('%Y',clinicalresearch.encounters.starttime) >= '2100'",True,0.0,0.001497507095336914,0,,[{'COUNT(*)>0': 0}],,,True,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for examination for normal comparison and control in clinical research' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100';"
948ee11a0dde7be83d223366,"What was the name of the medication that patient 10002495 was prescribed within the same hospital visit after having received a dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach procedure since 06/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '03b00' AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",False,0.0,0.0009274482727050781,0,incomplete input,,,,True,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.procedure_name = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime;"
8575a4d0318c42ed703a89a1,"Has patient 10015931 been received 5% dextrose, glucose gel, or ondansetron in 12/2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug IN ( '5% dextrose', 'glucose gel', 'ondansetron' ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.itemid IN ( SELECT inputevents.itemid FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND inputevents.itemid IN ( SELECT drugs.drug_id FROM drugs WHERE drugs.drug_name IN ( '5% dextrose', 'glucose gel', 'ondansetron' ) ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' )",False,0.0,0.0020029544830322266,0,no such column: admissions.stay_id,,,,True,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label IN ( '5% dextrose', 'glucose gel', 'ondansetron' ) ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12';"
42d490e9dcc8cd200649d0ff,Could you tell me patient 10014729's monthly minimum weight in 2100?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT MIN(weight) FROM ( SELECT weight, strftime('%Y-%m',weight_datetime) AS datetime FROM patientweights WHERE patientweights.subject_id = 10014729 AND strftime('%Y',weight_datetime) = '2100' ) AS subquery GROUP BY datetime",False,0.0,0.0016300678253173828,0,no such table: measurement,,,,True,"SELECT MIN(measurement.valuenum) FROM measurement WHERE measurement.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND measurement.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' ) AND strftime('%Y',measurement.charttime) = '2100' GROUP BY strftime('%Y-%m',measurement.charttime);"
fe862ff2d922e1153830a746,Which drug manufacturer is most frequently prescribed for patients under 18?,,"SELECT T3.C1 FROM ( SELECT T2.C1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C2 FROM ( SELECT admissions.subject_id, prescriptions.drug, drugs.manufacturer FROM prescriptions JOIN drugs ON prescriptions.drug = drugs.drug_name WHERE prescriptions.starttime IS NOT NULL AND drugs.manufacturer IS NOT NULL ) AS T1 JOIN admissions ON T1.subject_id = admissions.subject_id WHERE admissions.dischtime IS NOT NULL AND datetime(admissions.dischtime) < datetime(current_time,'-18 year') GROUP BY T1.C1 ) AS T2 WHERE T2.C2 <= 1 GROUP BY T3.C1",False,0.0,0.001829385757446289,0,"near ""FROM"": syntax error",,,,True,"SELECT T3.manufacturer FROM ( SELECT T2.manufacturer, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C3 FROM ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, drugs.manufacturer FROM prescriptions JOIN drugs ON prescriptions.drug = drugs.drug FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age < 18 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age < 18 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime = T2.starttime GROUP BY T1.manufacturer ) AS T3 WHERE T3.C3 <= 1;"
4f58f3a3dafa1f8cd4ff29a8,How many patients were treated with other excision or destruction of lesion or tissue of pancreas or pancreatic duct two or more times since 1 year ago?,"SELECT COUNT(T1.subject_id) FROM ( SELECT admissions.subject_id, COUNT(*) AS C1 FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other excision or destruction of lesion or tissue of pancreas or pancreatic duct' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY admissions.subject_id ) AS T1 WHERE T1.C1 >= 2","SELECT COUNT( DISTINCT admissions.subject_id ) FROM ( SELECT admissions.subject_id, COUNT( procedures.icd_code ) AS C2 FROM procedures WHERE procedures.icd_code = '07.29' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') GROUP BY admissions.subject_id HAVING C2 >= 2 ) AS T1 JOIN admissions ON T1.subject_id = admissions.subject_id",True,0.0,0.0019278526306152344,0,,[{'COUNT( DISTINCT admissions.subject_id )': 174611}],,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM ( SELECT procedures_icd.hadm_id, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other excision or destruction of lesion or tissue of pancreas or pancreatic duct' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.hadm_id ) AS T1 JOIN admissions ON T1.hadm_id = admissions.hadm_id WHERE T1.C1 >= 2;"
e843bc5ff21d749a06ab5bc3,Find the number of people diagnosed with do not resuscitate status in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'do not resuscitate status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'do not resuscitate status' ) AND strftime('%Y',diagnoses.charttime) = '2100' ) )",True,0.0,0.0020389556884765625,0,,[{'COUNT( DISTINCT admissions.subject_id )': 3913}],,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'do not resuscitate status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' );"
3a42a1f5b0ab7a9b081c5484,Can you tell me the cost of the drug named lactulose?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lactulose' ),SELECT DISTINCT drugs.drug_cost FROM drugs WHERE drugs.drug_name = 'lactulose',True,0.0,0.0017695426940917969,0,,[{'cost': 9.55}],,,True,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lactulose' );
7ffb1352553a2bdb8bcc4817,What medication was prescribed to patient 10019172 in the same hospital visit after the diagnosis of tobacco use disorder in 11/this year?,"SELECT T2.drug FROM ( SELECT diagnoses_icd.charttime, diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',diagnoses_icd.charttime) = '11' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY T2.starttime ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime, admissions.hadm_id FROM diagnoses WHERE diagnoses.icd_code = 'tobacco use disorder' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',diagnoses.charttime) = '11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id ) AS T3 WHERE T3.C1 = 1",False,0.0,0.0013365745544433594,0,incomplete input,,,,True,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY T2.starttime ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) AND admissions.subject_id = 10019172 AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',diagnoses_icd.charttime) = '11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id = 10019172 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id ) AS T3 WHERE T3.C1 = 1;"
ab2aad38b2169268cce19216,Has any midazolam been prescribed to patient 10019172?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.drug = 'midazolam',SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND prescriptions.patient_id = 10019172,True,0.0,0.0019235610961914062,0,,[{'COUNT(*)>0': 1}],,,True,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 );
f92a0c61488b57aa3f7e3ab1,Can I know the 3-month survival rate of patients diagnosed with unspecified atrial fibrillation who were then prescribed rifaximin?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T3.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified atrial fibrillation' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'rifaximin' GROUP BY admissions.subject_id HAVING MAX(prescriptions.starttime) = prescriptions.starttime ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime ) AS T3 JOIN patients ON T3.subject_id = patients.subject_id )","SELECT COUNT( DISTINCT T1.subject_id ) * 100 / COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = '427.9' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'rifaximin' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+3 month')",False,0.0,0.0020372867584228516,0,incomplete input,,,,True,"SELECT COUNT( DISTINCT T1.subject_id ) * 100 / COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified atrial fibrillation' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'rifaximin' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+3 month');"
da0649deb95e705d44b3a6bd,How to make bake potato in oven,,SELECT DISTINCT procedures.procedure_name FROM procedures WHERE procedures.icd_code IN ( SELECT diagnoses.icd_code FROM diagnoses WHERE diagnoses.description = 'bake potato in oven' ),False,0.0,0.0022416114807128906,0,no such column: procedures_icd.long_title,,,,True,SELECT DISTINCT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'bake potato in oven';
8988070d5b593cec53494672,What was the name of the medication that was prescribed to patient 10005817 within the same hospital visit after receiving a single internal mammary-coronary artery bypass procedure since 12/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = '10063' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",False,0.0,0.0012559890747070312,0,incomplete input,,,,True,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'single internal mammary-coronary artery bypass' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime;"
7e5e17dca306a105f47f9bb7,How much does patient 10002495's troponin t differ from the last value measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"SELECT ( SELECT troponinT FROM ( SELECT troponinT, ROW_NUMBER() OVER ( ORDER BY charttime DESC ) AS rn FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'troponin t' ) ) WHERE rn = 1 ) - ( SELECT troponinT FROM ( SELECT troponinT, ROW_NUMBER() OVER ( ORDER BY charttime DESC ) AS rn FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'troponin t' ) ) WHERE rn = 2 )",False,0.0,0.001306295394897461,0,incomplete input,,,,True,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 );
776a4927e962a0f0d91d35e7,How is citrate dextrose 3% (acd-a) crrt administered?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'citrate dextrose 3% (acd-a) crrt',SELECT DISTINCT treatments.route FROM treatments WHERE treatments.drug = 'citrate dextrose 3% (acd-a) crrt',False,0.0,0.002146482467651367,0,no such column: patients.age,,,,True,SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = ( SELECT patients.subject_id FROM patients WHERE patients.age = 30 AND patients.gender = 'M' ) ) AND procedures_icd.charttime BETWEEN '2100-01-01' AND '2100-12-31' );
d495fd8395126c8eb2bfc70f,When did patient 10022880 first receive his or her chloride lab test in 04/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'chloride' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1",True,0.0,0.0019431114196777344,0,,,,,True,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1;"
a6ad56047cfb5ab47409c6a5,"Could you tell me the top five most frequent treatments that were administered to patients during the same hospital encounter after they had ileostomy, not otherwise specified in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.activity FROM ( SELECT T2.activity, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.icd_description = 'ileostomy, not otherwise specified' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.activity ) AS T3 WHERE T3.C1 <= 5",False,0.0,0.0012235641479492188,0,"unrecognized token: ""'ileostomy, not oth""",,,,True,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C3 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C3 <= 5 );"
4ae971e027ab0b11a6f1c018,Calculate the total number of patients who had a metamyelocytes lab test this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.label = 'metamyelocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",True,0.0,0.0019145011901855469,0,,[{'COUNT( DISTINCT admissions.subject_id )': 0}],,,True,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') );"
97a7eba99e8adfa9dfe8aaca,Has patient 10005817 been subjected to a free calcium test since 10/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'free calcium' ) ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10'",True,0.0,0.0019063949584960938,0,,[{'COUNT(*)>0': 1}],,,True,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10';"
c8175712036320a9b391cf5f,"Among patients who received hemodialysis since 1 year ago, what are the top five most frequent medications that followed within the same month?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.procedure_name = 'hemodialysis' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",False,0.0,0.001046895980834961,0,incomplete input,,,,True,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5;"
d06e1b6a44abb8c2d06f5c31,Generate a pie chart illustrating the distribution of the top 10 most common procedures.,,"SELECT pie_chart( SELECT T1.C1, T1.C2 FROM ( SELECT COUNT(*) AS C1, procedures_icd.icd_code FROM procedures_icd GROUP BY procedures_icd.icd_code ORDER BY C1 DESC LIMIT 10 ) AS T1 )",False,0.0,0.0008242130279541016,0,"near ""SELECT"": syntax error",,,,True,"SELECT pie_chart( SELECT T1.C1, T1.C2 FROM ( SELECT COUNT(*) AS C1, procedures_icd.icd_code FROM procedures_icd GROUP BY procedures_icd.icd_code ORDER BY C1 DESC LIMIT 10 ) AS T1 );"
fc0f5148afa412b85497beb3,How much do patients pay to get a diagnosis of septicemia due to escherichia coli [e. coli]?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'septicemia due to escherichia coli [e. coli]' ) ),SELECT DISTINCT admissions.payments FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd.icd_code FROM icd WHERE icd.icd_name = 'septicemia due to escherichia coli [e. coli]' ) ),False,0.0,0.0019156932830810547,0,no such table: diagnoses,,,,True,SELECT DISTINCT admissions.payments FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd.icd_code FROM icd WHERE icd.icd_name = 'septicemia due to escherichia coli [e. coli]' ) )
868f55abba5b9b51520d27e4,Which patient and procedure had the longest duration of anesthesia last month?,,"SELECT patients.subject_id, procedures.procedure_name FROM ( SELECT operations.subject_id, operations.hadm_id, operations.starttime, operations.endtime FROM operations WHERE datetime(operations.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS ops JOIN ( SELECT procedures.procedure_name, procedures.hadm_id FROM procedures WHERE datetime(procedures.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS procs ON ops.hadm_id = procs.hadm_id JOIN patients ON ops.subject_id = patients.subject_id WHERE strftime('%J',ops.endtime) - strftime('%J',ops.starttime) >= 0 ORDER BY strftime('%J',ops.endtime) - strftime('%J',ops.starttime) DESC LIMIT 1",False,0.0,0.0018780231475830078,0,"unrecognized token: ""'""",,,,True,"SELECT patients.subject_id, procedures_icd.icd_code FROM ( SELECT procedures_icd.hadm_id, procedures_icd.charttime, procedures_icd.c1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT patients.subject_id, admissions.hadm_id FROM admissions JOIN patients ON admissions.subject_id = patients.subject_id WHERE datetime(admissions.admittime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.hadm_id = T2.hadm_id ORDER BY T1.c1 DESC LIMIT 1;"
bd8736e59f3b5eb724910a84,"Has a extirpation of matter from left femoral vein, percutaneous approach procedure been performed on patient 10005909 since 1 year ago?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*)>0 FROM procedures WHERE procedures.icd_code = '03.21' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures.charttime) >= datetime(current_time,'-1 year')",True,0.0,0.0016322135925292969,0,,[{'COUNT(*)>0': 1}],,,True,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year');"
e62cc504176c8533a1e60738,Has patient 10018328 had any surgery?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ),SELECT COUNT(*)>0 FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ),True,0.0,0.0012805461883544922,0,,[{'COUNT(*)>0': 1}],,,True,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 );
51f107a86832910517f841d1,When will patient 24894 have their next mri?,,SELECT procedureschedule.starttime FROM procedureschedule WHERE procedureschedule.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 24894 ) AND procedureschedule.procedure_id IN ( SELECT procedures.procedure_id FROM procedures WHERE procedures.procedure_name = 'mri' ) ORDER BY procedureschedule.starttime DESC LIMIT 1,False,0.0,0.0014257431030273438,0,no such column: procedures_icd.long_title,,,,True,SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 24894 ) AND procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'mri' ) ORDER BY procedures_icd.charttime ASC LIMIT 1;
27ce9933ce0b1542c2dd468c,How much did patient 10036156 weigh according to the first measurement?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,"SELECT weight FROM weights WHERE subject_id = 10036156 AND datetime(weighttime) >= datetime(current_time,'-1 year') ORDER BY weighttime ASC LIMIT 1",False,0.0,0.0013005733489990234,0,no such table: d_icd_items,,,,True,SELECT admissions.valuenum FROM admissions WHERE admissions.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.subject_id = 10036156 ) AND admissions.itemid IN ( SELECT d_icd_items.itemid FROM d_icd_items WHERE d_icd_items.label = 'admit wt' ) ORDER BY admissions.charttime ASC LIMIT 1;
e8057790cfb3bf1907c60c42,How many patients who were admitted to the hospital twice own trucks?,,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, vehicles.vehicle_type FROM admissions WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id HAVING COUNT( admissions.row_id ) = 2 ) AS T1 JOIN vehicles ON T1.subject_id = vehicles.subject_id WHERE vehicles.vehicle_type = 'truck'",False,0.0,0.0015616416931152344,0,no such column: d_icd_procedures.hadm_id,,,,True,SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id FROM admissions WHERE admissions.dischtime IS NOT NULL GROUP BY admissions.subject_id HAVING COUNT( admissions.hadm_id ) = 2 ) AS T1 JOIN d_icd_procedures ON T1.subject_id = d_icd_procedures.hadm_id WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'own truck' );
23f5cb31ebe9cc2a949960b0,What does it cost to undergo arteriography of femoral and other lower extremity arteries?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) ),SELECT DISTINCT admissions.cost FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.icd_code = ( SELECT icd_procedures.icd_code FROM icd_procedures WHERE icd_procedures.icd_name = 'arteriography of femoral and other lower extremity arteries' ) ),False,0.0,0.0013613700866699219,0,no such table: icd_procedures,,,,True,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_procedures.icd_code FROM icd_procedures WHERE icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) );
2cdba5b8a95c49f552fbdf57,What was patient 10004235's last hospital discharge time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004235 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1","SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004235 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",True,0.01757359504699707,0.01865100860595703,1,,[{'dischtime': '2100-07-16 13:30:00'}],['dischtime'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 24, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004235 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1"
278f3690974261bfe1e57d23,Count the number of patients since 1 year ago that were discharged from the hospital.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",True,0.07523441314697266,0.07697677612304688,1,,[{'COUNT( DISTINCT admissions.subject_id )': 172553}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]",False,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')"
1abc175490e91fdbe78482fb,Has a microbiological test been done for patient 10001217 in this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",True,0.07625031471252441,0.07974457740783691,1,,[{'COUNT(*)>0': 0}],['COUNT(*)>0'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}, {""id"": 8, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 10, ""parent"": 8, ""notused"": 0, ""detail"": ""SCAN admissions""}]",False,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
fd2461146ec138678719d7e3,What was the microbiology test given to patient 10002495 for the last time in the last hospital visit?,SELECT microbiologyevents.test_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiologyevents.test_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,True,0.07580327987670898,0.07936429977416992,1,,[{'test_name': 'respiratory culture'}],['test_name'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 13, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 29, ""parent"": 9, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 50, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,SELECT microbiologyevents.test_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1
a85685397831a790ea2cc0a7,The number of patients in med/surg/gyn since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND strftime('%Y',transfers.intime) >= '2100' )",True,0.09744501113891602,0.09995627403259277,1,,[{'COUNT( DISTINCT admissions.subject_id )': 9530}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 6, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH admissions USING INDEX sqlite_autoindex_admissions_2 (hadm_id=?)""}, {""id"": 10, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 12, ""parent"": 10, ""notused"": 0, ""detail"": ""SCAN transfers""}]",False,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND strftime('%Y',transfers.intime) >= '2100' )"
727a314e82ff330ad11ea76a,What medication was last prescribed to patient 10020187 via po in 02/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ORDER BY prescriptions.starttime DESC LIMIT 1",True,0.39582252502441406,0.3984496593475342,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 47, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ORDER BY prescriptions.starttime DESC LIMIT 1"
fe2d6c0f694f5a4cc2357932,What was the name of the medicine that was prescribed to patient 10005817 for the first time since 09/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1",True,0.39165496826171875,0.39305853843688965,1,,[{'drug': 'docusate sodium'}],['drug'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 37, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1"
4fcb903cb5d317c791dae3af,List the five most common microbiology tests conducted since 2100.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",True,0.4371058940887451,0.4402344226837158,5,,"[{'test_name': 'blood culture, routine'}, {'test_name': 'urine culture'}, {'test_name': 'respiratory culture'}, {'test_name': 'gram stain'}, {'test_name': 'wound culture'}]",['test_name'],"[{""id"": 2, ""parent"": 0, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 5, ""parent"": 2, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-3)""}, {""id"": 12, ""parent"": 5, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}, {""id"": 17, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 52, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 66, ""parent"": 2, ""notused"": 0, ""detail"": ""SCAN (subquery-3)""}, {""id"": 128, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T1""}]",False,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5"
14bb6c7bed022d576caf2a44,Which alternative route was most prescribed to patients under 30 years old?,,"SELECT T1.route FROM ( SELECT admissions.subject_id, prescriptions.route, COUNT(*) AS C1 FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age < 30 AND prescriptions.route != 'iv' GROUP BY admissions.subject_id, prescriptions.route ) AS T1 GROUP BY T1.route ORDER BY T1.C1 DESC LIMIT 1",True,1.2882494926452637,1.2892646789550781,1,,[{'route': 'impella'}],['route'],"[{""id"": 2, ""parent"": 0, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 10, ""parent"": 2, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 14, ""parent"": 2, ""notused"": 0, ""detail"": ""SEARCH admissions USING INDEX sqlite_autoindex_admissions_2 (hadm_id=?)""}, {""id"": 22, ""parent"": 2, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 65, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T1""}, {""id"": 68, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 108, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT T1.route FROM ( SELECT admissions.subject_id, prescriptions.route, COUNT(*) AS C1 FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age < 30 AND prescriptions.route != 'iv' GROUP BY admissions.subject_id, prescriptions.route ) AS T1 GROUP BY T1.route ORDER BY T1.C1 DESC LIMIT 1"
314c43e484535c98944bc116,"When did patient 10005817 receive the first lab test, since 08/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1",True,1.4809868335723877,1.4818837642669678,1,,[{'charttime': '2100-12-20 02:08:00'}],['charttime'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN labevents""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 36, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1"
2b3268beab056ff505b05347,Has patient 10029291 undergone a laboratory test since 01/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'",True,1.5233230590820312,1.5245022773742676,1,,[{'COUNT(*)>0': 1}],['COUNT(*)>0'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN labevents""}, {""id"": 8, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 10, ""parent"": 8, ""notused"": 0, ""detail"": ""SCAN admissions""}]",False,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'"
f7e273153edfeb72b98bd9c7,"When did patient 10009628 receive the last lab test, in 10/this year?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1",True,1.599214792251587,1.6004137992858887,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN labevents""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 44, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]",False,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1"
