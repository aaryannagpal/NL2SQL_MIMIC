id,question,true_query,generated_query,true_result,success,execution_time,total_time,row_count,error,results,result_columns,execution_plan
a5348117eb65b1c2d5c291ae,Call the it department to report a system issue in patient records.,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.hemoglobin_val < 10.0 AND microbiologyevents.platelets_val < 100.0 AND microbiologyevents.wbc_val < 5.0 AND microbiologyevents.rbc_val < 3.0 AND microbiologyevents.hematocrit_val < 30.0 AND microbiologyevents.ionized_calcium_val < 1.0 AND microbiologyevents.calcium_val < 8.0 AND microbiologyevents.ph_val < 7.0 AND microbiologyevents.pco2_val < 35.0 AND microbiologyevents.po2_val < 80.0 AND microbiologyevents.sodium_val < 135.0 AND microbiologyevents.chloride_val < 95.0 AND microbiologyevents.bicarbonate_val < 20.0 AND microbiologyevents.bun_val < 20.0 AND microbiologyevents.creatinine_val < 1.0 AND microbiologyevents.glucose_val < 70.0 AND microbiologyevents.lactate_val < 2.0 AND microbiologyevents.k_val < 3.5 AND microbiologyevents.magnesium_val <,,False,0.0,0.0033397674560546875,0,no such column: microbiologyevents.hemoglobin_val,,,
3f70d67ccafc181a6d95a5da,When was back to godhead written?,,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.drug = 'back to godhead' AND prescriptions.d_icd_procedures_ltable = 10084032 AND prescriptions.d_icd_diagnoses_rtable = 10084032 AND strftime('%Y',prescriptions.starttime) >= 2100 - 1 * 1  ORDER BY prescriptions.starttime ASC LIMIT 1",,False,0.0,0.0041425228118896484,0,no such column: prescriptions.d_icd_procedures_ltable,,,
b6a56db2ac82031670874f35,What is the top 10 side effect of magnesium sulfate (ob)?,,SELECT d_icd_procedures_long_title FROM d_icd_procedures_long WHERE d_icd_procedures_icd_code = ( SELECT d_icd_drugs_icd_code FROM d_icd_drugs WHERE d_icd_drugs.drug_name = 'magnesium sulfate (ob)' ),,False,0.0,0.002973318099975586,0,no such table: d_icd_procedures_long,,,
a518bc2ddd1eb83ea00755ac,What are the drugs given as sedatives to patient 22245?,,SELECT d.drug FROM microbiome_drug d WHERE d.drug = 'sedatives' AND d.hcpcscid IN ( SELECT p.hcpcscid FROM microbiome_patient p WHERE p.age = ( SELECT p.age FROM microbiome_patient p WHERE p.id = 22245 ) ),,False,0.0,0.003056049346923828,0,no such table: microbiome_drug,,,
af5df4194e2b15e8dc1e2251,What are the latest guidelines for managing icu patients with sepsis?,,SELECT DISTINCT guidelines FROM d_icd_procedures WHERE icd_procedures.long_title = 'management of icu patients with sepsis' ORDER BY d_icd_procedures.charttime DESC LIMIT 1,,False,0.0,0.003389120101928711,0,no such column: guidelines,,,
ebf25ceeb5c2a16b2f7ae85d,List the hospital names and their locations.,,SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '0',,True,0.0009608268737792969,0.0036575794219970703,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}]"
a3dd6fd412e2c57c8e042d2c,What month of the year is prescribed for the most antihistamines?,,"SELECT T1.C1 FROM ( SELECT DATETIME(D_icd_procedures.charttime,'start of year') AS C1, D_icd_procedures.charttime, D_icd_procedures.spec_type_desc FROM D_icd_procedures WHERE D_icd_procedures.spec_type_desc = 'antihistamines' ) AS T1 GROUP BY T1.C1 HAVING T1.charttime IN ( SELECT MAX(T2.charttime) FROM ( SELECT DATETIME(D_icd_procedures.charttime,'start of year') AS C1, D_icd_procedures.charttime, D_icd_procedures.spec_type_desc FROM D_icd_procedures WHERE D_icd_procedures.spec_type_desc = 'antihistamines' ) AS T2 GROUP BY T2.C1 )",,False,0.0,0.0021445751190185547,0,"unrecognized token: ""'anti""",,,
b718fdedc6f3898f1a2e85ab,What is the most common insurance type among patients with an address in dallas?,,"SELECT T1.insurance FROM ( SELECT patients.insurance, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM patients WHERE patients.address LIKE '%dallas%' GROUP BY patients.insurance ) AS T1 WHERE T1.C1 = 1",,False,0.0,0.003892660140991211,0,no such column: patients.insurance,,,
d440a9848fc7ceb07f335a2d,List the passwords for the patients in the icu last month.,,"SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hcpcshcpcs_desc = 'other' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",,False,0.0,0.003386259078979492,0,no such column: microbiologyevents.hcpcshcpcs_desc,,,
cc6a1305faf59ceadd9f9270,When does patient 1819 cease to be in a quarantine for influenza?,,SELECT d1.starttime FROM microbiologyevents d1 WHERE d1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 1819 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND d1.spec_type_desc = 'influenza' AND d1.org_name_desc = 'quarantine' ORDER BY d1.starttime DESC LIMIT 1,,False,0.0,0.0030660629272460938,0,no such column: d1.starttime,,,
574b827c1b18b74ef8d4e5aa,What is the average minimum humidity of the patients admitted to the icu yesterday?,,"SELECT AVG(d1.valuenum) FROM labevents d1 WHERE d1.spec_type = 'minimum humidity' AND d1.charttime >= datetime(current_time,'start of day','-1 day') AND d1.charttime < datetime(current_time,'start of day') GROUP BY d1.itemid",,False,0.0,0.0035486221313476562,0,no such column: d1.spec_type,,,
72666d852daac3bed406ef5a,What is the average time for delays in appointments at the oncology department?,,"SELECT AVG(o.onc_outpatients.charttime - o.onc_inpatients.charttime) FROM onc_inpatients AS o WHERE o.onc_inpatients.hadm_id IN ( SELECT p1.hadm_id FROM ( SELECT o.onc_inpatients.hadm_id, o.onc_inpatients.charttime, DENSE_RANK() OVER ( ORDER BY o.onc_inpatients.charttime ASC ) AS c1 FROM onc_inpatients AS o WHERE o.onc_inpatients.spec_type = 'onc' AND o.onc_inpatients.loinc = 2100 ) AS p1 JOIN ( SELECT o.onc_outpatients.hadm_id, o.onc_outpatients.charttime, DENSE_RANK() OVER ( ORDER BY o.onc_outpatients.charttime ASC ) AS c1 FROM onc_outpatients AS o WHERE o.onc_outpatients.spec_type = 'onc' AND o.onc_outpatients.loinc = 2100 ) AS p2 ON p1.hadm_id = p2.hadm_id WHERE p1.c1 = p2.c1 AND p1.spec_type = 'onc' AND p1.loinc = 2100 AND p2.spec_type = 'onc' AND p2.loinc = 2100 AND datetime(p1.chart",,False,0.0,0.0020532608032226562,0,incomplete input,,,
872a8cc39a2fa2be94add274,I.e. what is the address of patient 49036?,,SELECT patients.address FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto IS NOT NULL AND definition.longtitle = 'daily weight' ) ) AND patients.age = ( SELECT patients.age FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto IS NOT NULL AND definition.longtitle = 'daily weight' ) ) ORDER BY patients.age DESC LIMIT 1 ) ORDER BY patients.age ASC LIMIT 1,,False,0.0,0.002196788787841797,0,incomplete input,,,
8b093fb10a7007c37b5ff6f9,What is primary and non-contributory under the liability,,SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'primary and non-contributory under the liability',,False,0.0,0.003641843795776367,0,no such column: d_icd_procedures.short_title,,,
3a2dac716607f985a10414d6,Who are the patients that most recently received input medication from hwid1010?,,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'input' ) AND procedures_icd.drug = 'hwid1010' ORDER BY procedures_icd.charttime DESC LIMIT 1,,False,0.0,0.0031180381774902344,0,no such column: procedures_icd.long_title,,,
732d3247063b956a96090f13,What is patient 92063's guardian's phone number?,,SELECT d.phone_number FROM d_icd_procedures d WHERE d.icd_procedures_key IN ( SELECT p_icd_procedures_icd_procedures_key FROM p_icd_procedures WHERE p_icd_procedures_subject_key IN ( SELECT d_icd_diagnoses_subject_key FROM d_icd_diagnoses WHERE d_icd_diagnoses_icd_diagnoses_key IN ( SELECT p_icd_diagnoses_icd_diagnoses_key FROM p_icd_diagnoses WHERE p_icd_diagnoses_subject_key IN ( SELECT g_subject_id FROM guardian g WHERE g.has_patient_id = ( SELECT p_has_patient_id FROM procedure p WHERE p.subject_id = 92063 ) ) ) ) ),,False,0.0,0.002019643783569336,0,incomplete input,,,
1b30621cd64122892267eb6c,What was the average difference between charge time and billing time this year?,,"SELECT AVG(T1.chargetime - T2.billingtime) FROM ( SELECT admissions.charttime, admissions.admittime, admissions.age, admissions.gender, admissions.dischtime, admissions.admissiontype FROM admissions WHERE admissions.age IS NOT NULL AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT labevents.charttime, labevents.valuenum, labevents.age, labevents.gender, labevents.itemid FROM labevents WHERE labevents.age IS NOT NULL AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.charttime = T2.charttime WHERE T1.dischtime IS NOT NULL AND datetime(T1.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",,False,0.0,0.0021448135375976562,0,incomplete input,,,
9d8003bd44d76d570bd5a8a7,How about what's the address of patient 22983?,,SELECT d.street_name FROM microbiologyevents AS m WHERE m.spec_type_desc = 'blood culture' AND m.hemoglobin = 12.0 AND m.ionized_calcium = 1.0 AND m.platelet_count = 1.0 AND m.potassium = 1.0 AND m.sodium = 1.0 AND m.wbc = 1.0 AND m.hgb = 1.0 AND m.arterial_base_excess = 1.0 AND m.arterial_ph = 1.0 AND m.arterial_pco2 = 1.0 AND m.arterial_po2 = 1.0 AND m.bicarbonate = 1.0 AND m.calcium = 1.0 AND m.cl = 1.0 AND m.creatinine = 1.0 AND m.lactate = 1.0 AND m.magnesium = 1.0 AND m.o2_sat = 1.0 AND m.pco2 = 1.0 AND m.po2 = 1.0 AND m.temp_c = 1.0 AND m.urine_osmolality = 1.0 AND m.venous_base_excess =,,False,0.0,0.0018284320831298828,0,incomplete input,,,
7bd71f98ee2dc6f246fa0efc,Which month of the year antihistamines are most prescribed?,,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.spec_type_desc = 'antihistamines' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 1 )",,False,0.0,0.003498077392578125,0,no such column: procedures_icd.spec_type_desc,,,
774d08103f43dd4c0d900e8c,List the passwords for the patients admitted to the icu whose first wardid and last wardid is 7.,,"SELECT COUNT(*) FROM patients WHERE patients.age >= 18 AND patients.age <= 64 AND patients.gender = 'male' AND patients.insurance = 'medicare' AND patients.admissiontype = 'emergency' AND patients.admissionlocation = 'emergency room' AND patients.dischargeto = 'expired' AND datetime(ppatients.intime) >= datetime(current_time,'-1 year')",,False,0.0,0.003456592559814453,0,no such column: patients.age,,,
089e103d861cebd552f0b089,Where could the video be found?,,SELECT DISTINCT procedures.site FROM procedures WHERE procedures.drug = 'video' AND procedures.spec_type = 'find',,False,0.0,0.003809690475463867,0,no such table: procedures,,,
a751f404e68e0842c821fdd2,List the arrival times of diabetic patients this month.,,"SELECT visits.charttime FROM visits WHERE visits.age >= 30 AND visits.age < 40 AND visits.admissiontype = 'emergency' AND datetime(visits.admittime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY visits.charttime ASC LIMIT 1",,False,0.0,0.0033664703369140625,0,no such table: visits,,,
7f333347b430444fa0a766bb,What does the efc number mean,,SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'efc',,True,0.0011241436004638672,0.0031070709228515625,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}]"
5a9ee00ab35bc444ffce03b1,How many patients with single marital status arrived between 06:00:00 and 09:00:00?,,"SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.marital_status = 'single' AND patients.age >= 18 AND strftime('%H:%M:%S',patients.admittime) BETWEEN '06:00:00' AND '09:00:00'",,False,0.0,0.0032715797424316406,0,no such column: patients.marital_status,,,
b33d2a1132fb824b0556644d,What are the new drug distribution routes for this year?,,"SELECT DISTINCT d.route FROM drug d WHERE datetime(d.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND d.starttime IS NOT NULL ORDER BY d.route ASC LIMIT 1",,False,0.0,0.003454446792602539,0,no such table: drug,,,
d5619a250a533f622fa08740,Which physician performed the most number of procedures this year.,,"SELECT d.dr_name FROM ( SELECT d.dr_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedureevents d WHERE datetime(procedureevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY d.dr_name ) AS d WHERE d.C1 = 1",,False,0.0,0.0032732486724853516,0,no such table: procedureevents,,,
ac53ccba98a3999f8317cd7b,When does patient 15794 end his/her flu quarantine.,,SELECT d1.charttime FROM microbiologyevents d1 WHERE d1.hadm_id IN ( SELECT d2.hadm_id FROM patients d2 WHERE d2.age >= 50 AND d2.gender = 'male' AND d2.id = 15794 ) AND d1.spec_type_desc = 'flu' AND d1.org_name_desc = 'quarantine' ORDER BY d1.charttime DESC LIMIT 1,,False,0.0,0.0034911632537841797,0,no such column: d2.hadm_id,,,
a82eabb8c0c62cfcea76d24a,How many patients with permanent residency status were admitted today?,,"SELECT COUNT( DISTINCT adm.subject_id ) FROM microbiologyevents AS mic JOIN patients AS pat ON mic.hcpcscid = pat.hcpcscid JOIN d_icd_procedures AS proc ON mic.spec_type_desc = proc.long_title JOIN admissions AS adm ON pat.subject_id = adm.subject_id WHERE proc.icd_code = '00.00' AND pat.citizen = 'permanent residency' AND datetime(adm.admittime,'start of day') = datetime(current_time,'start of day','-0 day')",,False,0.0,0.0034117698669433594,0,no such column: pat.citizen,,,
628fca20b68618c255b7609b,What is the average time of delay of appointments in the cardiology department?,,SELECT AVG( admissions.charttime - appointments.starttime ) FROM admissions WHERE admissions.hadm_id IN ( SELECT appointments.hadm_id FROM appointments WHERE appointments.spec_type = 'cardiology' ),,False,0.0,0.002644777297973633,0,no such table: appointments,,,
87b3e4f536785307eb3c0307,‚äì what drugs are being administered for patient 24268 as sedatives?,,SELECT d.drug FROM microbiome_drug d WHERE d.drug = 'sedatives' AND d.hcpcscid IN ( SELECT p.hcpcscid FROM microbiome_patient p WHERE p.age = ( SELECT p.age FROM microbiome_patient p WHERE p.id = 24268 ) ),,False,0.0,0.003299236297607422,0,no such table: microbiome_drug,,,
ef11de45a4ae2161f701ecec,What is the most common drug color prescribed to patients with diabetes?,,SELECT d.color FROM drug d WHERE d.drug IN ( SELECT p.drug FROM microbiology microbiology JOIN patients patients ON microbiology.chart_id = patients.chart_id WHERE patients.age BETWEEN 30 AND 40 AND patients.gender = 'male' AND patients.diagnosis = 'diabetes' GROUP BY p.drug ORDER BY COUNT(*) DESC LIMIT 1 ),,False,0.0,0.0026292800903320312,0,no such table: drug,,,
98dbae2cefdb17ea7b9dc802,List all requesters who have ordered more than 1000 lab tests this year.,,"SELECT COUNT(*)>1000 FROM labevents WHERE strftime('%Y',labevents.charttime) = strftime('%Y',current_time) GROUP BY labevents.spec_type",,False,0.0,0.0033330917358398438,0,no such column: labevents.spec_type,,,
804573df458a455d75cf628a,Where is hamburg de located,,SELECT DISTINCT patients.location  FROM patients WHERE patients.age = 50 AND patients.gender = 'male' AND patients.insurance = 'medicare' AND patients.d_icd_procedures_icd_code = 'J3300',,False,0.0,0.0024514198303222656,0,no such column: patients.location,,,
37e79ddcdf4503d8d27520c4,What are the invoice numbers of the female patients who are not deceased?,,SELECT DISTINCT patients.invscd FROM patients WHERE patients.gender = 'female' AND patients.dod IS NULL,,False,0.0,0.002489328384399414,0,no such column: patients.invscd,,,
adea3244a3c419ff3bd8efce,What hotel did he purchase?,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'hotel' AND microbiologyevents.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' AND admissions.admissiontype = 'emergency' ),,False,0.0,0.002688884735107422,0,no such column: admissions.gender,,,
64e462acb79b6175bf2bbc6b,What is the most common year among patients who are not dead and are affiliated with def jam records?,,"SELECT T1.c1 FROM ( SELECT D_icd_procedures_icd_icd_procedures_year(ICD_procedures.charttime) AS C1 , COUNT(*) AS C2   FROM D_icd_procedures_icd_icd_procedures_year WHERE D_icd_procedures_icd_icd_procedures_year.ICD_procedures.charttime IN ( SELECT patients.charttime FROM patients WHERE patients.dod IS NULL ) GROUP BY D_icd_procedures_icd_icd_procedures_year(ICD_procedures.charttime) ) AS T1 WHERE T1.c2 = ( SELECT MAX(T2.c2) FROM ( SELECT D_icd_procedures_icd_icd_procedures_year(ICD_procedures.charttime) AS C1 , COUNT(*) AS C2   FROM D_icd_procedures_icd_icd_procedures_year WHERE D_icd_procedures_icd_icd_procedures_year.ICD_procedures.charttime IN ( SELECT patients.charttime FROM patients WHERE patients.dod IS NULL ) GROUP BY D_icd_procedures_icd_icd_procedures_year(ICD_procedures.charttime) ) AS T2 )",,False,0.0,0.0020780563354492188,0,incomplete input,,,
8fb8024e79d5f38a28e0a1ee,Which performing physicians were involved in procedures for patients admitted via emergency room admission?,,SELECT COUNT(*) FROM procedures WHERE procedures.careunit = 'emergency room' AND procedures.admissiontype = 'emergency room admission' GROUP BY procedures.drname,,False,0.0,0.0020449161529541016,0,no such table: procedures,,,
3ebb7dfb50f5ffe20df2a74a,What is the average value of minimum humidity among the patients who were admitted to the icu more than once?,,SELECT AVG(T1.C1) FROM ( SELECT AVG(D1.valuenum) AS C1 FROM labevents D1 WHERE D1.humidity < 1000 GROUP BY D1.chartkey ) AS T1 WHERE T1.C1 IS NOT NULL AND ( SELECT COUNT( DISTINCT admissions.chartkey ) FROM admissions WHERE admissions.humidity < 1000 AND admissions.humidity >= 999 ) > 1,,False,0.0,0.002658367156982422,0,no such column: D1.humidity,,,
74b838834d5f5d278388e052,And when does patient 12927 go into the percu abdominal drainage procedure?,,SELECT procedures.starttime FROM procedures WHERE procedures.label = 'percu abdominal drainage' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 12927 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 12927 ) ),,False,0.0,0.0026597976684570312,0,no such table: procedures,,,
2e3df8e7ff3e3bf2d3cf7cfe,When did michael laudrup start playing with fc barcelona?,,SELECT hospital_admissions.charttime FROM hospital_admissions WHERE hospital_admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.full_name = 'michael laudrup' ) AND hospital_admissions.gender = ( SELECT DISTINCT patients.gender FROM patients WHERE patients.full_name = 'michael laudrup' ) ORDER BY hospital_admissions.charttime ASC LIMIT 1,,False,0.0,0.00244140625,0,no such table: hospital_admissions,,,
abcfd88c087ff9b6e46059c9,Show the average number of procedures performed per physician.,,SELECT AVG(T1.C1) FROM ( SELECT COUNT(*) AS C1 FROM procedures WHERE procedures.physician = procedures.physician GROUP BY procedures.physician ) AS T1,,False,0.0,0.00250244140625,0,no such table: procedures,,,
f65b450597677193bcbee6c7,What were they riding on?,,"SELECT DISTINCT procedures.description FROM procedures WHERE procedures.chartkey = 10004729 AND procedures.label = 'ride' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",,False,0.0,0.0027899742126464844,0,no such table: procedures,,,
28e916123e56f4d1556203b3,Who was the last doctor patient 32153 saw in the obstetrics and gynecology department?,,SELECT visits.drug FROM visits WHERE visits.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.chart = '32153' AND transfers.linksto = 'physicians' AND transfers.careunit = 'obstetrics and gynecology' ORDER BY transfers.charttime DESC LIMIT 1 ) ) ORDER BY visits.starttime DESC LIMIT 1,,False,0.0,0.003125905990600586,0,no such table: visits,,,
6837c9f45272479a2b16a015,What are the record companies with patients older than 45?,,SELECT DISTINCT patients.record_id FROM patients WHERE patients.age > 45,,False,0.0,0.002854585647583008,0,no such column: patients.record_id,,,
1ae3fb2889c1b1e5dd75eb80,What did he ask michael to do?,,SELECT DISTINCT procedures.drug FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' AND admissions.charttime >= current_time - interval '1' year ) AND procedures.spec_type = 'michael',,False,0.0,0.0017769336700439453,0,"near ""'1'"": syntax error",,,
b7deeb354c331dcc04a4b6c5,Tell me the address of patient 86791 and why?,,SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = 2100 ) AND chartevents.valuenum IS NOT NULL ) GROUP BY procedures_icd.icd_code HAVING COUNT( DISTINCT procedures_icd.chartevents_id ) >= 2 ),,False,0.0,0.002672433853149414,0,no such table: definition,,,
05215f22ac565a3030674879,Please inform me of the phone number of patient 22782's guardian.,,SELECT d.phone_number FROM d_icd_procedures AS a WHERE a.key = ( SELECT b.key FROM microbiologyevents AS b WHERE b.hadm_id IN ( SELECT c.hadm_id FROM d_icd_diagnoses AS c WHERE c.key = ( SELECT d.key FROM patients AS d WHERE d.age = 22782 ) ) ),,False,0.0,0.003209829330444336,0,no such column: d.phone_number,,,
855fec3a4dfb439928afa3ea,What are the top five requesters of hematology tests this year?,,"SELECT T1.caregiver_name FROM ( SELECT D.caregiver_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT A.caregiver_name, A.charttime FROM labevents A WHERE A.itemid IN ( SELECT B.itemid FROM d_icditems B WHERE B.long_title = 'hematology' ) ) AS D GROUP BY D.careginer_name ) AS T1 WHERE T1.C1 <= 5 AND datetime(DATETIME(T1.charttime,'start of year')) >= datetime(current_time,'start of year','-0 year')",,False,0.0,0.002712249755859375,0,no such table: d_icditems,,,
084fad161486e9cb715a0230,What are the record companies that muslim patients are affiliated with?,,"SELECT DISTINCT patients.record_id FROM patients WHERE patients.age BETWEEN 30 AND 40 AND patients.gender = 'male' AND patients.insurance = 'medicare' AND patients.admission_type_desc = 'emergency room' AND patients.dischtime < patients.intime AND datetime(patients.intime,'start of year') = datetime(current_time,'start of year','-0 year')",,False,0.0,0.003315448760986328,0,no such column: patients.record_id,,,
e5afb16514771a25b2e457e0,List the medications prescribed to patients with a male first child.,,"SELECT T2.drug FROM ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'male' AND patients.has_child = true AND patients.child_gender = 'male' AND patients.child_birth_order = 1 ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.subject_id FROM prescriptions ) AS T2 ON T1.subject_id = T2.subject_id",,False,0.0,0.0033702850341796875,0,no such column: patients.has_child,,,
aeb5de2344d963029c6e21b2,What is hydrochlorothiazide? what is its effect?,,SELECT DISTINCT d.definition FROM drug d WHERE d.drug = 'hydrochlorothiazide' AND d.link_type = 'has_effect',,False,0.0,0.003467082977294922,0,no such table: drug,,,
0acbb8c1d8eddbb25083c49a,What are the dates of leaving the university for the patients who went into the hospital more than once this year?,,"SELECT DISTINCT patients.d_icd_procedures_icd FROM patients WHERE patients.age >= 18 AND patients.age <= 89 AND patients.gender = 'U' AND patients.d_icd_procedures_icd IS NOT NULL AND datetime(current_time,'start of year') <= datetime(stays.admittime,'start of year') AND datetime(current_time,'start of year') >= datetime(stays.admittime,'start of year') - interval 1 year EXCEPT SELECT DISTINCT patients.d_icd_procedures_icd FROM patients WHERE patients.age >= 18 AND patients.age <= 89 AND patients.gender = 'U' AND patients.d_icd_procedures_icd IS NOT NULL AND datetime(current_time,'start of year') <= datetime(stays.admittime,'start of year') AND datetime(current_time,'start of year') >= datetime(stays.admittime,'start of year') - interval 1 year HAVING COUNT(stays.charttime) > 1",,False,0.0,0.002875804901123047,0,"near ""1"": syntax error",,,
445d2ee4fe0aa4c4b936452e,Which type of care unit has the patient with the highest page count?,,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY SUM(t1.page_count) DESC ) AS c1 FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT MIN(admissions.age) FROM admissions ) ) ) AS t1 JOIN ( SELECT * FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT MIN(admissions.age) FROM admissions ) ) ) AS t2 ON t1.hadm_id = t2.hadm_id WHERE t1.spec_type_desc = 'blood culture' GROUP BY t2.icd_code ) AS t3 WHERE t3.c1 = 1 )",,False,0.0,0.0018506050109863281,0,incomplete input,,,
63038cdb342e49648810baf9,List all the invoice numbers of the patients deceased last month.,,SELECT DISTINCT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other' AND d_icd_procedures.charttime = current_time - interval 1 month,,False,0.0,0.0029675960540771484,0,"near ""1"": syntax error",,,
4d49829249a5b147348db1dd,Count the number of procedures that resulted in a 'successful' outcome this year.,,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.chartevents_icd.charttime >= datetime(current_time,'start of year') AND procedures_icd.d_icd_procedures_icd_long_title = 'successful' AND strftime('%Y',procedures_icd.chartevents_icd.charttime) = strftime('%Y',current_time)",,False,0.0,0.0027379989624023438,0,no such column: procedures_icd.chartevents_icd.charttime,,,
480c96ab33f733cbd12262fc,What are the 10 most common side effects of clarithromycin??,,"SELECT T2.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood culture' ) AS T1 GROUP BY T1.drug ) AS T2 WHERE T2.C1 <= 10",,False,0.0,0.0024530887603759766,0,no such column: T1.drug,,,
9e6e0d6ac2a6f5bf754653c7,What medication is prescribed for the patients diagnosed with atrial fibrillation?,,SELECT DISTINCT d.drug FROM microbiome_drug d WHERE d.spec_type = 'prescription' AND d.spec_item_id IN ( SELECT p.spec_item_id FROM microbiome_icd_diagnosis p WHERE p.spec_type = 'icd' AND p.spec_item_name = 'atrial fibrillation' ),,False,0.0,0.0030438899993896484,0,no such table: microbiome_drug,,,
6fd26774e0c807375b7c1739,Why did nicholas sparks divorce his wife,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.hemoglobin = 12.0,,False,0.0,0.0025849342346191406,0,no such column: microbiologyevents.hemoglobin,,,
f651029a2b6efc526940f746,What other polls has he been part of?,,"SELECT DISTINCT procedures.drug FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' ) AND procedures.drug = 'diltiazem' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures.starttime ASC LIMIT 1",,False,0.0,0.0032100677490234375,0,no such table: procedures,,,
5969ab3416ff62f387b82377,What is a band saw used for,,SELECT DISTINCT procedures.description FROM procedures WHERE procedures.itemid IN ( SELECT d_ic_items_icd_items.key_icd_item FROM d_ic_items_icd_items WHERE d_ic_items_icd_items.key_item = ( SELECT procedures_icd.key_item FROM procedures_icd WHERE procedures_icd.key_icd_item IN ( SELECT d_icd_icd_items.key_icd_item FROM d_icd_icd_items WHERE d_icd_icd_items.item_name = 'band saw' ) ) ),,False,0.0,0.0028929710388183594,0,no such table: procedures,,,
e4739af1bea47bc15c31b32f,List all the intimes of the icu with page counts lower than 20.,,SELECT COUNT(*) FROM intevents WHERE intevents.icustay_id IN ( SELECT intevents.icustay_id FROM intevents WHERE intevents.spec_type_desc = 'icu' ) GROUP BY intevents.icustay_id HAVING COUNT(*) < 20,,False,0.0,0.003145933151245117,0,no such table: intevents,,,
9bcad6eaf94f60b03a7e3d5c,What is team bella all about ?,,SELECT DISTINCT procedures.description FROM procedures WHERE procedures.attending = 'team bella',,False,0.0,0.002897024154663086,0,no such table: procedures,,,
c92492feda1eb0a1ebcc05f2,List all icu stays during which input medication was administered by hwid1007 at least once.,,"SELECT DISTINCT t1.icustay_id FROM   ( SELECT   a.icustay_id, a.charttime   FROM   microbiologyevents a   WHERE   a.hcwid = 'hwid1007'   AND   a.spec_type_desc = 'input medication' ) AS t1 JOIN   ( SELECT   a.icustay_id, a.charttime   FROM   microbiologyevents a   WHERE   a.hcwid = 'hwid1007'   AND   a.spec_type_desc = 'input medication' ) AS t2 ON t1.icustay_id = t2.icustay_id WHERE datetime(t1.charttime) >= datetime(t2.charttime) ORDER BY t1.icustay_id ASC, t1.charttime ASC",,False,0.0,0.0032508373260498047,0,no such column: a.icustay_id,,,
569f949477cd2fda2d4ea751,What is the difference in the average number of hospital visits per year for patients based on whether their first child is male or female?,,"SELECT AVG(T1.C1) FROM ( SELECT COUNT(*) AS C1 FROM ( SELECT P1.subject_id FROM microbiome_studies P1 WHERE P1.gender = 'male' AND P1.birth_order = 1 GROUP BY P1.subject_id ) AS C0 JOIN ( SELECT P2.subject_id, strftime('%Y',P2.outtime) AS C2 FROM microbiome_studies P2 WHERE P2.gender = 'male' AND P2.birth_order = 1 GROUP BY P2.subject_id ) AS T0 ON C0.subject_id = T0.subject_id WHERE T0.C2 IS NOT NULL GROUP BY strftime('%Y',T0.C2) ) AS T1 JOIN ( SELECT AVG(C1) AS C1 FROM ( SELECT COUNT(*) AS C1 FROM ( SELECT P3.subject_id FROM microbiome_studies P3 WHERE P3.gender = 'female' AND P3.birth_order = 1 GROUP BY P3.subject_id ) AS C1 JOIN ( SELECT P4.subject_id, strftime('%Y',P4.outtime) AS C2 FROM microbiome_studies P4 WHERE P4.gender = 'female' AND P4.birth_order = 1 GROUP BY P4.subject_id ) AS T1 ON C1.subject",,False,0.0,0.0013959407806396484,0,incomplete input,,,
76b834589d3ed7bfa7941cb6,What were some notable times of their early years?,,SELECT DISTINCT T1.charttime FROM labevents AS T1 WHERE T1.itemid IN ( SELECT DISTINCT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.label = 'early years' ),,False,0.0,0.0029256343841552734,0,no such column: procedures_icd.itemid,,,
4d46191e82d4f85bb2fa256b,How many patients admitted to the icu this year have passwords longer than 8 characters?,,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.spec_type_desc = 'icu' AND admissions.year = 2100 AND LENGTH(patients.password) > 8,,False,0.0,0.002853870391845703,0,no such column: admissions.spec_type_desc,,,
8541dd3e79a2524eef7946e9,Call a medical laboratory to expedite test results.,,SELECT medications.drug FROM medications WHERE medications.drug = 'expedite test results',,False,0.0,0.0024261474609375,0,no such table: medications,,,
e934023e9a0c16821526e87b,What religion has the highest number of standing tackles made by its believers?,,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT T1.icd_code FROM ( SELECT icd_procedures.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM icd_procedures WHERE icd_procedures.age = 0 GROUP BY icd_procedures.icd_code ) AS T1 WHERE T1.C1 <= 3 ) ORDER BY d_icd_procedures.long_title ASC LIMIT 1",,False,0.0,0.0035550594329833984,0,no such table: icd_procedures,,,
4a3ee987d5eed4cb8fc7cbfd,How many different healthcare workers administered input medication to patient 10001?,,SELECT COUNT( DISTINCT d_icd_procedures.key ) FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'input' AND d_icd_procedures.icd_code = ( SELECT procedures.icd_code FROM procedures WHERE procedures.subject_id = 10001 ),,False,0.0,0.002948760986328125,0,no such table: procedures,,,
dde7888943c5ce032cffd4e6,How long does it take to get a refund back on your debit card from express returns,,SELECT DISTINCT T1.d_icd_procedures_icd_id FROM procedures T1 WHERE T1.spec_type_desc = 'express returns',,False,0.0,0.0027964115142822266,0,no such table: procedures,,,
f50b75b54af03eb23b73abc1,What key is alto sax in,,SELECT DISTINCT d_icd_procedures.key FROM d_icd_procedures WHERE d_icd_procedures.value = 'alto sax',,False,0.0,0.0022134780883789062,0,no such column: d_icd_procedures.key,,,
b205cf40fe142d699a05c9ab,Tell me the address of patient 2536 and why?,,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.patientid = 2536 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) ORDER BY procedures_icd.chartevents_id ASC LIMIT 1 ),,False,0.0,0.0015597343444824219,0,incomplete input,,,
d0d2cc96940ac2b577ba70ca,Where did she never go?,,"SELECT DISTINCT t1.spec_type_desc FROM microbiologyevents t1 WHERE t1.spec_type_desc IS NOT NULL AND t1.spec_type_desc NOT IN ( SELECT DISTINCT t2.spec_type_desc FROM microbiologyevents t2 WHERE t2.spec_type_desc IS NOT NULL AND t2.charttime >= datetime(current_time,'-1 year') AND t2.hadm_id IN ( SELECT t3.hadm_id FROM patients t3 WHERE t3.age >= 50 AND t3.gender = 'female' ) )",,False,0.0,0.002443075180053711,0,no such column: t3.hadm_id,,,
698048f875f64bb38d8c5ef7,What was his first attempt?,,SELECT procedures.charttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' ) ORDER BY procedures.charttime ASC LIMIT 1,,False,0.0,0.0024263858795166016,0,no such table: procedures,,,
30d461a261559030034e3257,What are the record companies of the deceased patients?,,SELECT COUNT(*) FROM patients WHERE patients.dod is NOT NULL GROUP BY patients.record_id,,False,0.0,0.0026764869689941406,0,no such column: patients.record_id,,,
7c4dc59f08a2b6a96b7a1256,Are you able to find a procedure appointment for patient 63849 for today?,,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = '00.66' AND datetime(patients.admittime) >= datetime(current_time,'-1 year') )",,False,0.0,0.002645254135131836,0,no such column: patients.hadm_id,,,
86839ccf835440d41b40bfa2,Which doctor did patient 71558 see when heshe last visited the rheumatology department?,,SELECT visits.drug FROM visits WHERE visits.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.charttime = ( SELECT MIN(transfers.charttime) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = (,,False,0.0,0.001485586166381836,0,incomplete input,,,
17928f8215ac5734b7521160,Count the number of primary physicians who have admitted their patients to the hospital more than three times in the past year.,,"SELECT COUNT( DISTINCT dr1.caregiver_id ) FROM ( SELECT dr.stay_id, dr.caregiver_id FROM microbiome_procedures dr WHERE dr.caregiver_type = 'primary physician' AND dr.event_type = 'admit to hospital' AND datetime(dr.event_time,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY dr.stay_id, dr.caregiver_id HAVING COUNT(dr.stay_id) > 3 ) AS dr1",,False,0.0,0.0025289058685302734,0,no such table: microbiome_procedures,,,
20bc21d443c654119da97d29,What are the names of the advisors of the patients classified as emergency at admission this year?,,SELECT COUNT(*) FROM microbiologyevents WHERE organism = 'enterococcus faecalis' AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.hemoglobinuria = 'negative' AND microbiologyevents.alkalinephosphatase = '> 100' AND microbiologyevents.platelet_count = '< 100' AND microbiologyevents.arterial_blood_pressure_diastolic = '> 80' AND microbiologyevents.arterial_blood_pressure_systolic = '> 120' AND microbiologyevents.arterial_blood_pressure_mean = '> 80' AND microbiologyevents.heart_rate = '< 100' AND microbiologyevents.respiratory_rate = '> 20' AND microbiologyevents.o2_saturation = '> 97' AND microbiologyevents.wbc_count = '< 10' AND microbiologyevents.hematocrit = '> 30' AND microbiologyevents.bilirubin_total = '> 1.2' AND microbiologyevents.bilirubin_direct = '> 0.3' AND microbiologyevents.bicarbonate = '< 20' AND microbiologyevents.blood_type = 'o negative' AND microbiologyevents.pco2 = '> 35,,False,0.0,0.002614736557006836,0,no such column: organism,,,
da76927d0eff934f23b6003e,Can you tell me what the drug can be prescribed for patients with esoph varice oth dis nos?,,SELECT DISTINCT d.drug FROM microbiome_drugs d WHERE d.spec_type = 'prescribe' AND d.spec_value = 'esoph varice oth dis nos',,False,0.0,0.0028388500213623047,0,no such table: microbiome_drugs,,,
0ddd6dc18709a713a76158e8,Where can i find the phone number of patient 73913's guardian?,,SELECT d.phone_number FROM d_icd_procedures d WHERE d.icd_procedures_key IN ( SELECT p_icd_procedures_icd_procedures_key FROM p_icd_procedures WHERE p_icd_procedures_subject_key IN ( SELECT d_labitems_subject_key FROM d_labitems WHERE d_labitems_valuenum = 73913 ) ),,False,0.0,0.0030765533447265625,0,no such table: p_icd_procedures,,,
a5cc39d6ea1c9729e9cb051e,Identify 10 crucial factors influencing lab tests.,,SELECT T1.spec_type_desc FROM labevents T1 WHERE T1.spec_type_desc IN ( SELECT T2.spec_type_desc FROM labevents T2 WHERE T2.itemid IN ( SELECT T3.itemid FROM labevents T3 WHERE T3.valuenum = 10.0 ) GROUP BY T2.spec_type_desc ORDER BY COUNT(*) DESC LIMIT 10 ),,False,0.0,0.002789020538330078,0,no such column: T1.spec_type_desc,,,
7e2dcdd483a3830f19e16b07,Navigate to the pediatric wing from the main parking area.,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.hemoglobin_val < 10.0,,False,0.0,0.0024101734161376953,0,no such column: microbiologyevents.hemoglobin_val,,,
f7908eda301fbcbf66fd2c26,Which are the top 10 side effects reported for drug thiamine hcl?,,"SELECT T1.count FROM ( SELECT drugs.drug_name, count(drugs.drug_name) AS count FROM microbiologyevents JOIN patients ON microbiologyevents.subject_id = patients.subject_id JOIN d_icd_procedures ON microbiologyevents.spec_type_desc = d_icd_procedures.long_title WHERE d_icd_procedures.icd_code = '13.22' AND patients.age BETWEEN 50 AND 60 AND strftime('%Y',patients.admittime) = '2100' GROUP BY drugs.drug_name ) AS T1 JOIN ( SELECT drugs.drug_name, count(drugs.drug_name) AS count FROM microbiologyevents JOIN patients ON microbiologyevents.subject_id = patients.subject_id JOIN d_icd_procedures ON microbiologyevents.spec_type_desc = d_icd_procedures.long_title WHERE d_icd_procedures.icd_code = '13.22' AND patients.age BETWEEN 50 AND 60 AND strftime('%Y',patients.admittime) = '2100' GROUP BY drugs.drug_name ORDER BY count DESC LIMIT 1 ) AS T2 WHERE T1.count < T2.count ORDER BY T1.count DESC LIMIT 10",,False,0.0,0.0016832351684570312,0,incomplete input,,,
73529036e49e5922c0bc40a0,Was patient 5364 signed a blood transfusion consent form?,,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age>0 AND patients.gender = 'male' AND patients.charttime IS NOT NULL AND patients.d_icd_procedures_icd_to_text = 'blood transfusion consent' AND patients.age = 5364 ),,False,0.0,0.0027129650115966797,0,no such column: patients.hadm_id,,,
3b19e4a9f4401f94414ae3a6,When does patient 370 end his/her flu quarantine.,,SELECT d1.starttime FROM microbiologyevents d1 WHERE d1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 370 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND d1.spec_type_desc = 'flu' AND d1.valuenum = 1 ORDER BY d1.starttime DESC LIMIT 1,,False,0.0,0.0025908946990966797,0,no such column: d1.starttime,,,
767d0e3e0e6a4254a995ac8e,What is the age of the patient who has succeeded in the most standing tackles?,,"SELECT T1.C1 FROM ( SELECT T2.age, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.label = 'standing' ) AS T2 JOIN ( SELECT admissions.subject_id, labevents.valuenum, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE labevents.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.label = 'standing' ) ) AS T3 ON T2.subject_id = T3.subject_id AND T2.charttime < T3.charttime JOIN ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.label = 'succeeded' ) AS T4 ON T3.subject_id = T4.subject_id AND T3.charttime < T4.charttime JOIN ( SELECT admissions.subject_id, labevents.valuenum, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE labevents.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.label = 'standing' ) ) AS T5",,False,0.0,0.0015616416931152344,0,incomplete input,,,
659187a74e57637b35daa280,Look up the latest technology used in curing atrial fibrillation.,,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.spec_type_desc = 'atrial fibrillation' ORDER BY procedures_icd.charttime DESC LIMIT 1 ),,False,0.0,0.0026807785034179688,0,no such column: procedures_icd.spec_type_desc,,,
5884aff3bbac9bfd0ff165a9,What is haloperidol? what is its effect?,,SELECT DISTINCT d.definition FROM drug d WHERE d.drug = 'haloperidol' AND d.link_type = 'has_effect',,False,0.0,0.0027565956115722656,0,no such table: drug,,,
4b6353ec5a31b5c1bf637734,Which ethnicity has the highest average page count?,,"SELECT T1.c1 FROM ( SELECT d_icd_procedures_icd_id, AVG(l_icstudies_page_count) AS C1 FROM l_icstudies WHERE l_icstudies.age >= 18 GROUP BY d_icd_procedures_icd_id ) AS T1 JOIN ( SELECT d_icd_procedures_icd_id, MAX( AVG(l_icstudies_page_count) ) AS C1 FROM l_icstudies WHERE l_icstudies.age >= 18 GROUP BY d_icd_procedures_icd_id ) AS T2 ON T1.C1 = T2.C1",,False,0.0,0.003033876419067383,0,no such table: l_icstudies,,,
2911905f7b71dc9ee7583199,List the requesters who have ordered more than 100 hemoglobin tests.,,SELECT COUNT(*)>100 FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'hemoglobin' ) GROUP BY labevents.careunit,,False,0.0,0.0025255680084228516,0,no such table: procedures,,,
95ed91ecefd97f4f68d59794,What is the marital status that has the most patients over 30 years of age affiliated with warner brothers records?,,"SELECT d_icd_procedures_icd_to_char.long_title FROM d_icd_procedures_icd_to_char WHERE d_icd_procedures_icd_to_char.icd_code = ( SELECT T1.icd_code FROM ( SELECT d_icd_procedures_icd_to_char.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM d_icd_procedures_icd_to_char WHERE d_icd_procedures_icd_to_char.long_title = 'warner brothers' AND d_icd_procedures_icd_to_char.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.age >= 30 AND procedures_icd.gender = 'male' ) GROUP BY d_icd_procedures_icd_to_char.icd_code ) AS T1 WHERE T1.C1 = 1 )",,False,0.0,0.0018830299377441406,0,incomplete input,,,
03c8bb9cb2716f43621cb14b,Whose phone number is the phone number of patient 40707's guardian?,,SELECT patients2.phone FROM patients WHERE patients.careunit = ( SELECT patients2.careunit FROM patients WHERE patients.chartkey = 40707 ) AND patients.guardian = 1,,False,0.0,0.002628803253173828,0,no such column: patients2.phone,,,
4e38bd109d02c58e7d3b58fe,Call a medical supply company to order more icu equipment.,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'icu equipment' AND microbiologyevents.hemoglobin IS NOT NULL,,False,0.0,0.0029020309448242188,0,no such column: microbiologyevents.hemoglobin,,,
9b3b15e5a997276568cf4fde,Percent of population considered pre diabetes,,SELECT COUNT(*) * 1.0 / ( SELECT COUNT(*) FROM microbiome_studies WHERE datetime >= '2100-01-01 00:00:00' ) FROM microbiome_studies WHERE diagnosis = 'pre diabetes' AND datetime >= '2100-01-01 00:00:00',,False,0.0,0.002444744110107422,0,no such table: microbiome_studies,,,
7e1a9a31db03ad3e9603cf9c,When is the issue coming out?,,SELECT DISTINCT procedures.charttime FROM procedures WHERE procedures.label = 'issue' AND procedures.spec_type_desc = 'coming out' AND procedures.spec_type_desc IS NOT NULL,,False,0.0,0.002032041549682617,0,no such table: procedures,,,
a5ec1f13b1b903153ec55164,Whats the efficacy of metoprolol?,,"SELECT DISTINCT d.icd_name FROM diagnosis d WHERE d.icd_code = ( SELECT t1.icd_code FROM ( SELECT o1.charttime, o1.itemid, d1.icd_code FROM labevents o1 JOIN diagnosis d1 ON o1.hadm_id = d1.hadm_id WHERE o1.itemid IN ( SELECT p1.itemid FROM procedureevents p1 WHERE p1.label = 'metoprolol' ) ORDER BY o1.charttime ASC ) AS t1 JOIN ( SELECT o2.charttime, o2.itemid, d2.icd_code FROM labevents o2 JOIN diagnosis d2 ON o2.hadm_id = d2.hadm_id WHERE o2.itemid IN ( SELECT p2.itemid FROM procedureevents p2 WHERE p2.label = 'metoprolol' ) ORDER BY o2.charttime ASC ) AS t2 ON t1.icd_code = t2.icd_code WHERE datetime(t1.charttime) = datetime(t2.charttime) )",,False,0.0,0.0016689300537109375,0,incomplete input,,,
c141ebc01bb9dd637c004efe,Which religion has the patient who graduated from college most recently?,,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.key = ( SELECT t3.key FROM ( SELECT t2.key, DENSE_RANK() OVER ( ORDER BY t2.charttime DESC ) AS C1 FROM ( SELECT admissions.subject_id, admissions.admittime FROM admissions WHERE admissions.dischtime IS NOT NULL ) AS t1 JOIN ( SELECT patients.subject_id, patients.dod, patients.age, patients.gender, patients.religion, patients.marital_status, patients.ethnicity, admissions.admittime FROM patients JOIN admissions ON patients.subject_id = admissions.subject_id WHERE admissions.dischtime IS NOT NULL ) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.admittime < t2.admittime GROUP BY t2.key ) AS t3 WHERE t3.C1 = 1 )",,False,0.0,0.0013453960418701172,0,incomplete input,,,
be77b0162456496c3c5866e3,List the medication administrations by hwid1020 to patients.,,SELECT medications.drug FROM medications WHERE medications.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 1020 ),,False,0.0,0.0026509761810302734,0,no such table: medications,,,
5c639b834d848ab32371b285,Create a budget plan for the upcoming fiscal year.,,SELECT T1.C1 FROM ( SELECT SUM( labevents.valuenum ) AS C1 FROM labevents WHERE labevents.spec_type_desc = 'blood culture' GROUP BY labevents.stay_id ) AS T1 WHERE T1.C1 IS NOT NULL ORDER BY T1.C1 ASC LIMIT 1,,False,0.0,0.002699136734008789,0,no such column: labevents.spec_type_desc,,,
cc01a7a7a65eb126616c7e07,Did he find a person?,,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name = current patient's org_name,,False,0.0,0.002702951431274414,0,"near ""patient"": syntax error",,,
7da5115d6880b93afe291cab,What's the end date of patient 7112's influenza quarantine?,,SELECT d.charttime FROM microbiologyevents d WHERE d.hadm_id IN ( SELECT t.hadm_id FROM patients t WHERE t.age >= 50 AND t.gender = 'male' AND t.d_icd_procedures_icd_code = '13.95' ) ORDER BY d.charttime ASC LIMIT 1,,False,0.0,0.002245187759399414,0,no such column: t.hadm_id,,,
89e4e46ddc56c90d38aec205,Find the shortest path to the pharmacy from the surgery wing.,,SELECT DISTINCT t1.start_time FROM transfers t1 WHERE t1.start_location = 'surgery' AND t1.end_location = 'pharmacy' ORDER BY t1.start_time ASC LIMIT 1,,False,0.0,0.0019927024841308594,0,no such column: t1.start_time,,,
f8c251c96bb987c5ed2076c2,"Are there identical passwords for more than two distinct patients who are older than 60? if so, list them.",,"SELECT DISTINCT T1.password FROM ( SELECT admissions.patient_id, d_icd_procedures.long_title, procedures.icd_code, procedures.charttime FROM procedures JOIN admissions ON procedures.patient_id = admissions.patient_id WHERE admissions.age > 60 ) AS T1 JOIN ( SELECT admissions.patient_id, d_icd_procedures.long_title, procedures.icd_code, procedures.charttime FROM procedures JOIN admissions ON procedures.patient_id = admissions.patient_id WHERE admissions.age > 60 ) AS T2 ON T1.password = T2.password WHERE T1.patient_id != T2.patient_id GROUP BY T1.password HAVING COUNT( DISTINCT T1.patient_id ) >= 2",,False,0.0,0.0027649402618408203,0,no such table: procedures,,,
e55a7710442cf455cfc4ec5f,Dangling participle definition and examples,,Can you please specify if you are asking for the definition of a medical term or a SQL query?,,False,0.0,0.0012257099151611328,0,"near ""Can"": syntax error",,,
43851d9f14a559ea4100f7a1,Tell me all the tests taken in the other department by patient 7698.,,"SELECT d.test_name FROM microbiologyevents d WHERE d.hadm_id IN ( SELECT a.hadm_id FROM patients a WHERE a.age >= 0 AND a.gender = 'male' AND a.d_icd_procedures_icd_code = '13.99' AND a.charttime >= datetime(current_time,'-1 year') ) ORDER BY d.charttime ASC LIMIT 1",,False,0.0,0.0024132728576660156,0,no such column: a.hadm_id,,,
824c344d379a08ba9b032a17,What is the average salary of the patients who believe in christianity?,,"SELECT AVG(ppatients.labresults.valuenum) FROM ppatients WHERE ppatients.d_icd_procedures_key IN ( SELECT procedures.d_icd_procedures_key FROM procedures WHERE procedures.key = ( SELECT MIN(T1.key) FROM ( SELECT procedures.key, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures WHERE procedures.d_icd_procedures_key IN ( SELECT patients.d_icd_procedures_key FROM patients WHERE patients.age BETWEEN 50 AND 60 ) GROUP BY procedures.key ) AS T1 WHERE T1.C1 = 1 ) )",,False,0.0,0.0023279190063476562,0,no such table: ppatients,,,
416572d9becf92768f378d48,"I mean, what kinds of side effects does ns have?",,SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.label = 'ns' ),,False,0.0,0.002531290054321289,0,no such column: procedures_icd.label,,,
dca4c06d509b190b42c230ca,What is the phone number of patient 74523's guardian?,,SELECT d.phone_number FROM d_icd_procedures d WHERE d.icd_procedures_key IN ( SELECT p_icd_procedures_icd_procedures_key FROM p_icd_procedures WHERE p_icd_procedures_subject_key IN ( SELECT d_labitems_subject_key FROM d_labitems WHERE d_labitems_valuenum = 74523 ) ),,False,0.0,0.0025153160095214844,0,no such table: p_icd_procedures,,,
9284800fd8ed3ff60873bd1c,When was the time that a patient with the highest cost billed this year?,,"SELECT MIN(T1.C1) FROM ( SELECT SUM(I1.chargem) AS C1 FROM labevents I1 WHERE I1.hadm_id IN ( SELECT T2.hadm_id FROM ( SELECT O1.hadm_id, DENSE_RANK() OVER ( ORDER BY SUM(O1.chargem) DESC ) AS C2 FROM labevents O1 WHERE strftime('%Y',O1.charttime) = '2100' GROUP BY O1.hadm_id ) AS T2 WHERE T2.C2 = 1 ) GROUP BY I1.hadm_id ) AS T1",,False,0.0,0.0025272369384765625,0,no such column: I1.chargem,,,
16f036a5f4e066bfd2d904c1,Retrieve images of different care units.,,SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.charttime >= current_time - interval '2' year ) ORDER BY RAND() LIMIT 1,,False,0.0,0.00150299072265625,0,"near ""'2'"": syntax error",,,
d51e3c859e3835b1c8fa2846,What is the average age of the patients with minimum humidity over 30 percent?,,SELECT AVG(age) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'humidity' AND procedures.val < 30 ),,False,0.0,0.0024383068084716797,0,no such table: procedures,,,
9c2869cef2f1d574d7a0b07e,"Show the patient ids, arrival times, and insurance types of patients admitted for cancer this year.",,"SELECT patients.patient_id, admissions.admittime, insurances.insurance FROM patients JOIN admissions ON patients.patient_id = admissions.patient_id JOIN insurances ON patients.patient_id = insurances.patient_id WHERE admissions.diagnoses_icd = 'cancer' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC",,False,0.0,0.0025146007537841797,0,no such table: insurances,,,
ac454c98485a6e9c43e54799,Tell me of the tests patient 57050 has taken in the other department.,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 57050 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND microbiologyevents.spec_type_desc = 'other',,False,0.0,0.0023746490478515625,0,no such column: admissions.pid,,,
1318592db6b84edfe46b7da7,Did patient 51858 fill out the consent form for ct scan?,,SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 51858 AND organism_name = 'enterococcus faecalis',,False,0.0,0.0020706653594970703,0,no such column: patient_id,,,
361609da111503a7dbd0b217,What is the average billing amount for patients with heart disease this month?,,"SELECT AVG(T1.C1) FROM ( SELECT SUM(procedures_icd.cost) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 'heart disease' ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') GROUP BY procedures_icd.hadm_id ) AS T1",,False,0.0,0.002282381057739258,0,no such column: procedures_icd.cost,,,
3dc0f83add6ccd420290c66a,Give me a list of microbiology events where the specimen quality was poor.,,SELECT COUNT(*) FROM microbiologyevents WHERE specimenquality = 'poor',,False,0.0,0.002146005630493164,0,no such column: specimenquality,,,
d2916654a250739fbae2b772,Who patient 31510 saw when they last went to ophthalmology?,,SELECT visits.drug FROM visits WHERE visits.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'ophthalmology' AND transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'arterial blood gases' ) ) ) AND transfers.chargeto = 'med/surg' AND transfers.admissiontime IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1 ) ORDER BY visits.starttime DESC LIMIT 1,,False,0.0,0.0015065670013427734,0,"near ""LIM"": syntax error",,,
ca6452d0fcc4925d5cc3bef0,When does patient 65582 come into the exc/dest intvrt disc nos process?,,SELECT procedures.charttime FROM procedures WHERE procedures.label = 'exc/dest intvrt disc nos' AND procedures.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' AND patients.d_icd_procedures = 'exc/dest intvrt disc nos' AND patients.charttime IS NOT NULL ORDER BY patients.charttime ASC LIMIT 1 ),,False,0.0,0.002146005630493164,0,no such table: procedures,,,
ca3ac69651c08b642eb672db,What are the sedative drugs being administered to patient 4401?,,SELECT medications.drug FROM medications WHERE medications.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 44 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' AND admissions.dischtime IS NOT NULL ) AND medications.drug = 'sedative' AND medications.starttime IS NOT NULL ORDER BY medications.starttime ASC LIMIT 1,,False,0.0,0.0022411346435546875,0,no such table: medications,,,
7cbe8a357afbeaf1db568acc,Do you mean that patient 29741 filled out the consent form for a ct scan?,,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,False,0.0,0.002278566360473633,0,no such column: admissions.gender,,,
cec8a6ee63266a7f01f80da2,What are the most frequently prescribed drug colors for patients over 60?,,SELECT d.drug FROM   (   SELECT   prescriptions.drug FROM   prescriptions   WHERE   prescriptions.age >= 60   GROUP BY   prescriptions.drug   ORDER BY   COUNT(*) DESC   LIMIT   1 ) AS top1   JOIN   drug d ON top1.drug = d.drug_name,,False,0.0,0.002363920211791992,0,no such table: drug,,,
516980a5554f33c21ca183b5,Where is the hospital located with admission id 145787?,,SELECT DISTINCT patients.city FROM patients WHERE patients.row_id IN ( SELECT admissions.patient_id FROM admissions WHERE admissions.admittime IS NOT NULL AND admissions.dischtime IS NOT NULL AND admissions.admissionid = 145787 ),,False,0.0,0.0022928714752197266,0,no such column: patients.city,,,
954af13d6dc7c6c533e2e63f,What are the total costs incurred on a specific billing date?,,SELECT SUM( microbiologyevents.cost ) FROM microbiologyevents WHERE microbiologyevents.stdiag = 'specific billing',,False,0.0,0.0022597312927246094,0,no such column: microbiologyevents.cost,,,
839008d6dd9a3f492473ed16,What is the average date of death among patients who were deceased and were affiliated with sony records?,,"SELECT AVG(T1.outtime) FROM ( SELECT patients.outtime, patients.chartkey FROM patients WHERE patients.dod IS NOT NULL ) AS T1 WHERE T1.chartkey IN ( SELECT admissions.chartkey FROM admissions WHERE admissions.spec_type_desc = 'sony records' )",,False,0.0,0.0021965503692626953,0,no such column: patients.outtime,,,
31fe116b7574718511ae013c,List all the advisors of the patients who were younger than 21.,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.hemoglobin < 9.6,,False,0.0,0.00225067138671875,0,no such column: microbiologyevents.hemoglobin,,,
31679dede264cc93766ffc0a,Which primary physician has the patient with the highest hospital admission cost?,,"SELECT d.dr_name FROM ( SELECT o.event_time, o.stay_id FROM microbiologyevents o WHERE o.spec_type_desc = 'blood culture' ) AS T1 JOIN ( SELECT o.event_time, o.stay_id FROM microbiologyevents o WHERE o.spec_type_desc = 'blood culture' ) AS T2 ON T1.stay_id = T2.stay_id WHERE datetime(T1.event_time) < datetime(T2.event_time) ORDER BY T1.event_time ASC LIMIT 1",,False,0.0,0.0020792484283447266,0,no such column: o.event_time,,,
4e3f38b5acb14b84c19b0fa5,What did they say to him,,"SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.charttime >= datetime(current_time,'-1 year') AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 AND admissions.gender = 'male' ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1 )",,False,0.0,0.0019311904907226562,0,no such column: admissions.gender,,,
8d71f96fc3062598c863167a,Which primary physician has the highest patient mortality rate?,,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY T2.C1 ASC ) AS C2 FROM ( SELECT d_icd_procedures.icd_code, AVG(C1) AS C1 FROM ( SELECT admissions.patient_id, procedures.icd_code, ( CASE WHEN admissions.dischtime IS NOT NULL AND admissions.age < 100 THEN 0 ELSE 1 END ) as C1 FROM procedures JOIN admissions ON procedures.patient_id = admissions.patient_id WHERE admissions.age < 100 GROUP BY admissions.patient_id, procedures.icd_code ) AS T1 JOIN d_icd_procedures ON T1.icd_code = d_icd_procedures.icd_code GROUP BY d_icd_procedures.icd_code ) AS T2 ) AS T3 WHERE T3.C2 = 1 )",,False,0.0,0.0013439655303955078,0,incomplete input,,,
5abc9d918535d3307f61919d,Inform me of the tests that patient 95892 took in a different department.,,"SELECT DISTINCT T1.test_name FROM microbiologyevents AS T1 WHERE T1.hadm_id IN ( SELECT T2.hadm_id FROM patients AS T2 WHERE T2.age >= 50 AND T2.gender = 'male' AND T2.d_icd_procedures_icd_code = '13.95' AND strftime('%Y',current_time) - strftime('%Y',T2.admittime) >= 1 )",,False,0.0,0.001995086669921875,0,no such column: T2.hadm_id,,,
697c4b98eea851000804f9fe,What is the predominant insurance type among patients who married after age 40?,,"SELECT T1.insurance_type FROM ( SELECT patients.age, patients.insurance_type, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM patients WHERE patients.age > 40 AND patients.marital_status = 'married' GROUP BY patients.age, patients.insurance_type ) AS T1 WHERE T1.C1 = 1",,False,0.0,0.0021905899047851562,0,no such column: patients.age,,,
dca9a1a1b06f57335405eccb,Can you please tell me the address of patient 6580?,,SELECT patients.address FROM patients WHERE patients.chartkey = 6580,,False,0.0,0.002088785171508789,0,no such column: patients.address,,,
9728497b208efb3fa27e2aea,How are certain word phrased?,,SELECT DISTINCT procedures.description FROM procedures WHERE procedures.drug = 'certain' AND procedures.spec_type = 'word' AND procedures.route = 'phrased',,False,0.0,0.002229928970336914,0,no such table: procedures,,,
5b7e7cea6c14a66683614904,Which icu had the highest average acuity score last month?,,"SELECT t3.icustay_id FROM ( SELECT t2.icustay_id, AVG(t1.acuity_score) AS avg_score FROM ( SELECT * FROM chartevents WHERE chartevents.valuenum IS NOT NULL ) AS t1 JOIN ( SELECT * FROM d_icustays WHERE d_icustays.age >= 18 ) AS t2 ON t1.itemid = t2.icustay_id AND t1.charttime >= t2.intime WHERE t1.linksto = 'acuity_score' AND datetime(t1.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY t2.icustay_id ) AS t3 JOIN ( SELECT MAX(t4.avg_score) AS max_score FROM ( SELECT t2.icustay_id, AVG(t1.acuity_score) AS avg_score FROM ( SELECT * FROM chartevents WHERE chartevents.valuenum IS NOT NULL ) AS t1 JOIN ( SELECT * FROM d_icustays WHERE d_icustays.age >= 18 ) AS t2 ON t1.itemid = t2.icustay_id AND t1.charttime >= t2.intime WHERE t1.linksto = 'acuity_score' AND datetime(t1.charttime,'start of month') =",,False,0.0,0.0014464855194091797,0,"near ""FRO"": syntax error",,,
28c81639ebcda9f332d3fc94,What is the maximum number of standing tackles made by the patients older than 45 and married?,,SELECT MAX( d_icd_procedures_icd_count ) FROM ( SELECT COUNT(*) AS d_icd_procedures_icd_count FROM icd_procedures WHERE icd_procedures.key = ( SELECT patients.key FROM patients WHERE patients.age > 45 AND patients.marital_status = 'married' ) GROUP BY icd_procedures.icd_code ) WHERE d_icd_procedures_icd_count IS NOT NULL AND d_icd_procedures_icd_count <> 0,,False,0.0,0.002165079116821289,0,no such table: icd_procedures,,,
1a1a4662e9121b2ec51b7bf2,What is the number of patient 29971's guardian's phone?,,SELECT COUNT(*) FROM phone WHERE phone.caregiver_name IN ( SELECT admissions.caregiver_name FROM admissions WHERE admissions.patient_id = 29971 ),,False,0.0,0.002496957778930664,0,no such table: phone,,,
bfb0403b51d7349e984fe8df,What is the distribution of procedure outcomes by patient ethnicity?,,"SELECT COUNT(*) FROM procedure_outcomes WHERE procedure_outcomes.chart_instance_idx IN ( SELECT patients.chart_instance_idx FROM patients WHERE patients.ethnicity IS NOT NULL ) GROUP BY procedure_outcomes.outcome, patients.ethnicity",,False,0.0,0.0022153854370117188,0,no such table: procedure_outcomes,,,
20991d9d916622645fd27567,What are the dates of graduating from college among the widowed patients who got admitted to the hospital last month?,,"SELECT patients.d_icd_procedures_icd_from_desc FROM patients WHERE patients.gender = 'widowed' AND patients.age BETWEEN 30 AND 40 AND datetime(current_time,'start of month','-1 month') <= patients.admittime AND datetime(current_time,'start of month','-0 month') >= patients.admittime END SQL: SELECT DISTINCT patients.d_icd_procedures_icd_from_desc FROM patients WHERE patients.gender = 'widowed' AND patients.age BETWEEN 30 AND 40 AND datetime(current_time,'start of month','-1 month') <= patients.admittime AND datetime(current_time,'start of month','-0 month') >= patients.admittime",,False,0.0,0.0021104812622070312,0,"near ""END"": syntax error",,,
94a005f173b3e30833a6eab8,Which antihistamine is prescribed the most?,,SELECT d.drug FROM   ( SELECT   prescriptions.drug FROM   prescriptions GROUP BY   prescriptions.drug HAVING   SUM(prescriptions.days_supply) >= ALL ( SELECT   SUM(prescriptions1.days_supply) FROM   prescriptions AS prescriptions1 WHERE   prescriptions1.spec_type = 'histamine' GROUP BY   prescriptions1.drug ) ) AS d WHERE   d.drug LIKE '%antihistamine%',,False,0.0,0.0014379024505615234,0,"near ""ALL"": syntax error",,,
f79fa4afc09f637db912a795,What is the average number of standing tackles made by the patients whose last care unit was sicu?,,"SELECT AVG(T1.C1) FROM ( SELECT COUNT(*) AS C1 FROM procedureevents T WHERE T.label = 'standing' AND T.hadm_id IN ( SELECT T2.hadm_id FROM ( SELECT T3.hadm_id, T3.charttime FROM ( SELECT T4.hadm_id, MAX(T4.charttime) AS C1 FROM ( SELECT T5.hadm_id, T5.charttime FROM ( SELECT T6.hadm_id FROM ( SELECT T7.hadm_id, MAX(T7.intime) AS C1 FROM ( SELECT * FROM admissions WHERE admissions.careunit = 'sicu' ) AS T7 ) AS T6 WHERE T6.C1 >= datetime(current_time,'-1 year') ) AS T5 JOIN procedureevents ON T5.hadm_id = procedureevents.hadm_id WHERE procedureevents.label = 'standing' ) GROUP BY T5.hadm_id ) AS T4 WHERE T4.C1 >= datetime(current_time,'-1 year') ) AS T3 WHERE T3.hadm_id IN ( SELECT T6.hadm_id FROM ( SELECT T7.hadm_id, MAX(T7.intime) AS C1 FROM ( SELECT * FROM admissions WHERE admissions.careunit = 'sicu' ) AS T7",,False,0.0,0.0012707710266113281,0,incomplete input,,,
e7029de5a892c70bd5f004f0,What are the top three most common procedures performed on patients with an address in san francisco?,,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT admissions.subject_id FROM admissions WHERE admissions.admissions.admittance_location = 'san francisco' ) AS t1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code FROM admissions JOIN procedures_icd ON admissions.subject_id = procedures_icd.subject_id WHERE procedures_icd.charttime IS NOT NULL AND procedures_icd.charttime >= admissions.admittance_time AND admissions.admissions.admittance_location = 'san francisco' ) AS t2 ON t1.subject_id = t2.subject_id GROUP BY t2.icd_code ) AS t3 WHERE t3.c1 <= 3 )",,False,0.0,0.0013308525085449219,0,incomplete input,,,
eccbd9f6d3d0961bf3e2a8be,Develop a meal planning system for patients with dietary restrictions.,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiologyevents.hemoglobinopathies = 'no' AND microbiology,,False,0.0,0.002147197723388672,0,no such column: microbiologyevents.hemoglobinopathies,,,
fd92836f6e1a812c7e1d314f,What is the average number of patients assigned to each healthcare worker who administers input medication?,,SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT admissions.subject_id ) AS C1 FROM admissions WHERE admissions.hc_id IN ( SELECT procedures.hc_id FROM procedures WHERE procedures.label = 'input medication' ) GROUP BY procedures.hc_id ) AS T1,,False,0.0,0.002070188522338867,0,no such table: procedures,,,
8958f3216720fc04419d0f11,What month of the year does antihistamines the most prescribe?,,"SELECT T1.month FROM ( SELECT DATE_TRUNC('month',prescriptions.starttime) AS month, COUNT(*) AS C1 FROM prescriptions WHERE prescriptions.drug = 'antihistamines' GROUP BY DATE_TRUNC('month',prescriptions.starttime) ) AS T1 WHERE T1.C1 = ( SELECT MAX(T2.C1) FROM ( SELECT DATE_TRUNC('month',prescriptions.starttime) AS month, COUNT(*) AS C1 FROM prescriptions WHERE prescriptions.drug = 'antihistamines' GROUP BY DATE_TRUNC('month',prescriptions.starttime) ) AS T2 )",,False,0.0,0.0017094612121582031,0,no such function: DATE_TRUNC,,,
917badf660136cdbde3c0e4d,What is the average salary for the patients who were admitted to the micu as their last care unit?,,SELECT AVG(p1.cost) FROM microbiologyevents AS p1 WHERE p1.spec_type_desc = 'last care unit' AND p1.hadm_id IN ( SELECT p2.hadm_id FROM microbiologyevents AS p2 WHERE p2.spec_type_desc = 'micu' ORDER BY p2.charttime DESC ),,False,0.0,0.001753091812133789,0,no such column: p1.cost,,,
0ac5a4c0eec1c408823ecaca,List the most frequent diagnoses for elderly patients with a female next of kin.,,"SELECT d.icd_name FROM   ( SELECT   d_icd_icditems_icd_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiom ic   JOIN   d_icd_icditems d   ON   ic.spec_type_icd = d.icd_icditems_icd   WHERE   ic.age >= 65   AND   ic.next_of_kin_gender = 'female'   GROUP   BY   d_icd_icditems_icd_name ) AS d   JOIN   d_icd_icditems d2   ON   d.icd_icditems_icd_name = d2.icd_icditems_icd_name   JOIN   d_icd d3   ON   d2.icd_icditems_icd = d3.icd   WHERE   d.C1 <= 3   AND   d3.long_title = 'diagnoses'",,False,0.0,0.0012824535369873047,0,"unrecognized token: ""'d""",,,
4bf932258480b1c7ad5f00ae,What is the most popular record company among married patients?,,SELECT d_icd_procedures_long.title FROM d_icd_procedures_long WHERE d_icd_procedures_long.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.charttime >= patients.d_icd_diagnoses_icd_time AND patients.gender = 'male' AND patients.d_icd_diagnoses_icd_time IS NOT NULL ) AND patients.age BETWEEN 20 AND 30 AND patients.marital_status = 'married' GROUP BY d_icd_procedures_long.title ORDER BY COUNT(*) DESC LIMIT 1,,False,0.0,0.0019304752349853516,0,no such table: d_icd_procedures_long,,,
c9a38b2012537ccc81186e55,Whats the efficacy of nicardipine hcl iv?,,SELECT DISTINCT d.icd_icdrg_definitions_icdrg_title FROM icd_icdrg_definitions d WHERE d.icd_icdrg_definitions_key = ( SELECT DISTINCT l.icd_icdrg_definitions_key FROM labevents l WHERE l.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.label = 'nicardipine hcl iv' ) ),,False,0.0,0.0020542144775390625,0,no such table: icd_icdrg_definitions,,,
0064f154fd57bb4cbaa0b873,When does patient 77676 enter into the injection oxazolidinone procedure?,,SELECT procedures.charttime FROM procedures WHERE procedures.label = 'injection oxazolidinone' AND procedures.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 0 AND patients.gender = 'male' AND patients.charttime IS NOT NULL AND patients.id = 77676 ) ORDER BY procedures.charttime ASC LIMIT 1,,False,0.0,0.002118825912475586,0,no such table: procedures,,,
506dabdb3420e5ea3eed4cef,What is the average difference in admission duration between patients whose procedure outcomes were all 'successful' and those whose outcomes were not?,,"SELECT AVG(T1.C1) FROM ( SELECT AVG(U0.length_of_stay) AS C1 FROM ( SELECT P1.subject_id, DATEDIFF(P1.dischtime, P1.admittime) AS U0.length_of_stay FROM microbiologyevents AS P0 JOIN patients AS P1 ON P0.hadm_id = P1.hadm_id WHERE P0.spec_type_desc = 'procedure' GROUP BY P1.subject_id ) AS U0 GROUP BY U0.subject_id ) AS T1 WHERE T1.C1 IS NOT NULL JOIN ( SELECT P1.subject_id, DATEDIFF(P1.dischtime, P1.admittime) AS U0.length_of_stay FROM microbiologyevents AS P0 JOIN patients AS P1 ON P0.hadm_id = P1.hadm_id WHERE P0.spec_type_desc = 'procedure' GROUP BY P1.subject_id ) AS U1 ON T1.subject_id = U1.subject_id WHERE T1.C1 < U1.U0.length_of_stay     SELECT AVG(T2.C1) FROM ( SELECT AVG(U1.length_of_stay) AS C1 FROM ( SELECT P0.subject_id, DATEDIFF(P0.dischtime, P0.admittime)",,False,0.0,0.0014603137969970703,0,"near ""."": syntax error",,,
16ed22149970531de6f9f3cb,Did patient 369 do a consent to a ct scan?,,SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 369 AND organism_name = 'enterococcus faecalis',,False,0.0,0.0018839836120605469,0,no such column: patient_id,,,
218dc5042482781a3da67df4,What is the telephone number of patient 59941's guardian?,,"SELECT d.telephone FROM d_icd_procedures d WHERE d.icd_procedures_key IN ( SELECT p_icd_procedures_icd_procedures_key FROM p_icd_procedures WHERE p_icd_procedures_subject_key IN ( SELECT d_icd_diagnoses_subject_key FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code = 'I10' AND d_icd_diagnoses.chart_time >= datetime(current_time,'-1 year') ) ) ORDER BY RAND() LIMIT 1",,False,0.0,0.0020227432250976562,0,no such table: p_icd_procedures,,,
626d9e416ae29a7eb7049e42,What is the average age of patients admitted this year with non-resident status?,,"SELECT AVG(age) FROM patients WHERE patients.careunit_id IN ( SELECT admissions.careunit_id FROM admissions WHERE admissions.age >= 0 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ) AND patients.citizenship = 'non-resident'",,False,0.0,0.001939535140991211,0,no such column: age,,,
a70b6040eeb73367fcf00abb,What eye drops are available that can be prescribed for patients with dry eyes?,,SELECT DISTINCT d.drug FROM drug d WHERE d.drug = 'artificial tears',,False,0.0,0.0019075870513916016,0,no such table: drug,,,
1f5292b27876676ec03ee3a9,What is the location of the hospital that admitted the most patients with diabetes?,,"SELECT T1.c1 FROM ( SELECT d_icd_procedures_icd_id, COUNT(*) AS C1 FROM microbiom_icd_procedures WHERE d_icd_procedures_icd_id IN ( SELECT d_icd_diagnoses_icd_id FROM microbiom_icd_diagnoses WHERE microbiom_icd_diagnoses.chartkey IN ( SELECT T2.chartkey FROM ( SELECT microbiom_labevents.chartkey, DENSE_RANK() OVER ( ORDER BY MIN(microbiom_labevents.valuenum) ASC ) AS C1 FROM microbiom_labevents WHERE microbiom_labevents.itemid IN ( SELECT DISTINCT microbiom_d_icitems.itemid FROM microbiom_d_icitems WHERE microbiom_d_icitems.long_title = 'blood culture' ) GROUP BY microbiom_labevents.chartkey ) AS T2 WHERE T2.c1 = 1 ) ) GROUP BY d_icd_procedures_icd_id ) AS T1 JOIN ( SELECT d_icd_procedures_icd_id, COUNT(*) AS C1 FROM microbiom_icd_procedures WHERE d_icd_procedures_icd_id IN ( SELECT d_icd_diagnoses_icd_id FROM microbiom_icd_diagnoses WHERE microbiom_icd_diagnoses.chartkey IN ( SELECT T2",,False,0.0,0.001409292221069336,0,incomplete input,,,
b8e7e0eaf1d059c2fc7ab7fe,Which doctor were patient 65309s seen when they last visited the cardiology department?,,SELECT visits.drug FROM visits WHERE visits.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.charttime = ( SELECT MIN(transfers.charttime) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = (,,False,0.0,0.0013785362243652344,0,incomplete input,,,
436e18d4a82406b93d91929f,What medication should be prescribed to patients with glaucoma nos?,,SELECT DISTINCT d.drug FROM microbiome d WHERE d.spec_type = 'prescribed' AND d.spec_name = 'glaucoma nos',,False,0.0,0.002028226852416992,0,no such table: microbiome,,,
385e641ba9f6d4f87be32048,What is the average age at the time of death for temporary resident patients?,,SELECT AVG(age) FROM patients WHERE patients.age IS NOT NULL AND patients.dischtime IS NOT NULL AND patients.admission_location = 'temporary',,False,0.0,0.002245187759399414,0,no such column: age,,,
40fd1207a10c4190e566b432,I need to know the phone number of patient 14749's guardian.,,SELECT d.phone_number FROM d_icd_procedures AS a WHERE a.key = ( SELECT b.key FROM microbiologyevents AS b WHERE b.hadm_id IN ( SELECT c.hadm_id FROM d_icd_diagnoses AS c WHERE c.key = ( SELECT d.key FROM patients AS d WHERE d.age = 14749 ) ) ),,False,0.0,0.0018992424011230469,0,no such column: d.phone_number,,,
ff31bc2d2babbce54ba584e9,How many male patients have a female next of kin?,,SELECT COUNT( DISTINCT d_icustays.charttime ) FROM d_icustays WHERE d_icustays.gender = 'male' AND d_icustays.nextofkin = ( SELECT d_icustays.nextofkin FROM d_icustays WHERE d_icustays.gender = 'female' ),,False,0.0,0.0017993450164794922,0,no such table: d_icustays,,,
99811c06ada374d0f8b22e70,Read out the short title of icd9 code 01166.,,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code = '01166',,True,0.0008339881896972656,0.0023200511932373047,0,,,,"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_diagnoses USING INDEX sqlite_autoindex_d_icd_diagnoses_2 (icd_code=?)""}]"
919d12332cf6d5e5cb0c8253,How many patients from the icu in 2100 have page counts higher than 10?,,"SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 2100 ) AND patients.gender = 'male' AND patients.dod IS NOT NULL AND patients.dod >= patients.admittime AND strftime('%Y',patients.dod) = '2100' EXCEPT SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 2100 ) AND patients.gender = 'male' AND patients.dod IS NOT NULL AND patients.dod >= patients.admittime AND strftime('%Y',patients.dod) = '2100' AND patients.subject_id IN ( SELECT procedures.allobject_id FROM procedures WHERE procedures.allobject_id IN ( SELECT d_icd_procedures_icd_icd_items_icd_icd_items_icd_icd_items_key FROM d_icd_procedures_icd_icd_items_icd_icd_items_icd_icd_items WHERE d_icd_procedures_icd_icd_items_icd_icd_items_icd_icd_items.c_icd_procedures_key = procedures.key ) ) AND procedures.key IN ( SELECT d_icd_procedures_icd_icd_items_icd_ic",,False,0.0,0.002000570297241211,0,no such column: patients.hadm_id,,,
4604eb882c0a085315bff78d,What is the average number of standing tackles made by patients younger than 40?,,SELECT AVG(T1.C1) FROM ( SELECT COUNT(*) AS C1 FROM procedureevents T WHERE T.label = 'standing' AND T.age < 40 GROUP BY t.subject_id ) AS T1,,False,0.0,0.001744985580444336,0,no such table: procedureevents,,,
f968df813578fd0c367317f1,What are the drug distribution routes used in the hospital?,,SELECT DISTINCT procedures.drug_distribution_route FROM procedures WHERE procedures.drug_distribution_route IS NOT NULL,,False,0.0,0.00186920166015625,0,no such table: procedures,,,
c9705fb85231f3066df593cb,When does patient 80858 stop being quarantined from the influenza flu?,,SELECT d1.charttime FROM microbiologyevents d1 WHERE d1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.pid = 80858 ) ) AND d1.spec_type_desc = 'influenza flu' AND d1.org_name_desc = 'quarantined' ORDER BY d1.charttime DESC LIMIT 1,,False,0.0,0.0019314289093017578,0,no such column: admissions.pid,,,
706443292e92adc73d32d8f4,What is the gender of the first child of subject 3097?,,SELECT patients.gender FROM patients WHERE patients.age BETWEEN 0 AND 17 AND patients.chartkey IN ( SELECT admissions.chartkey FROM admissions WHERE admissions.age BETWEEN 0 AND 17 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND patients.d_icd_procedures_icd_id IN ( SELECT procedures_icd.d_icd_procedures_icd_id FROM procedures_icd WHERE procedures_icd.icd_code = 'Z3A.0' ) AND patients.age = 3097,,False,0.0,0.001789093017578125,0,no such column: patients.age,,,
f73b2ce37c28f47894ee6bfe,What relationship are jessie and janet?,,"SELECT DISTINCT T1.relationship FROM microbiologyevents T1 WHERE T1.spec_type_desc = 'stool' AND T1.hcpcscpt_desc = 'stool, microbiology' AND T1.org_name = 'jessie' AND T1.age BETWEEN 50 AND 60 AND strftime('%Y-%m-%d',current_time,'start of year') - strftime('%Y-%m-%d',T1.charttime,'start of year') < 1 AND T1.spec_type_desc = 'stool' AND T1.hcpcscpt_desc = 'stool, microbiology' AND T1.org_name = 'janet' AND T1.age BETWEEN 50 AND 60 AND strftime('%Y-%m-%d',current_time,'start of year') - strftime('%Y-%m-%d',T1.charttime,'start of year') < 1",,False,0.0,0.001767873764038086,0,no such column: T1.relationship,,,
a1b471160a18a756c9b258f3,Which antihistamine is the most,,"SELECT d_icd_procedures_long_title FROM d_icd_procedures_long WHERE d_icd_procedures_icd_code = ( SELECT d_icd_procedures_icd_code FROM d_icd_procedures WHERE d_icd_procedures_long_title = 'excision of left lower lobe bronchus, via natural or artificial opening endoscopic' )",,False,0.0,0.001455068588256836,0,no such table: d_icd_procedures_long,,,
c5109baf674ec23d0c5833c7,What side effects does propofol have on the body?,,SELECT DISTINCT d.rows FROM microbiologyevents d WHERE d.spec_type_desc = 'blood culture' AND d.hadm_id IN ( SELECT t1.hadm_id FROM patients t1 WHERE t1.age >= 50 ),,False,0.0,0.0015482902526855469,0,no such column: d.rows,,,
b28dc49a162520774f9b7815,What does the average mcdonald's worker make per hour,,SELECT AVG(cost) FROM microbiologyevents WHERE organism = 'mcdonald's' AND patient_id IN ( SELECT subject_id FROM d_icd_procedures WHERE icd_code = '00.61' ),,False,0.0,0.0016455650329589844,0,"near ""s"": syntax error",,,
a51767448d369240d4de63da,What boats need to have a throw safety ring,,SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'throw safety ring',,False,0.0,0.0017287731170654297,0,no such column: d_icd_procedures.short_title,,,
ccc413b763ed24bfb39994d2,Do you have an idea when patient 19428 goes into the closed bronchial biopsy procedure?,,SELECT procedures.starttime FROM procedures WHERE procedures.label = 'closed bronchial biopsy' AND procedures.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 18 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = '13.24' ) ORDER BY procedures.starttime ASC LIMIT 1,,False,0.0,0.0017440319061279297,0,no such table: procedures,,,
771c5c87039440790cb87cb1,What is the length of stay in the icu for the patient having the most standing tackles?,,"SELECT MAX(ICUSTAYS.totaltime) FROM ICUSTAYS WHERE ICUSTAYS.chartevents_row_id IN ( SELECT T1.chartevents_row_id FROM ( SELECT chartevents.chartevents_row_id, DENSE_RANK() OVER ( ORDER BY chartevents.valuenum DESC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT procedure_icd.itemid FROM procedure_icd WHERE procedure_icd.label = 'standing tackles' ) ) AS T1 WHERE T1.C1 = 1 )",,False,0.0,0.0019385814666748047,0,no such table: procedure_icd,,,
82a17c445add2e20e68f48ea,What is the average age of temporary residents admitted for emergencies last month?,,"SELECT AVG(age) FROM patients WHERE patients.chartkey IN ( SELECT admissions.chartkey FROM admissions WHERE admissions.admission_location = 'emergency room' AND admissions.admittime >= datetime(current_time,'start of month','-1 month') AND admissions.admittime < datetime(current_time,'start of month','-0 month') ) AND patients.careunit = 'temporary'",,False,0.0,0.001744985580444336,0,no such column: age,,,
7751f8c3f1ab0e21c43a613f,What are the invoice numbers for patients with no religion?,,SELECT DISTINCT d_icd_procedures.key_icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other' AND d_icd_procedures.short_title = 'other' AND d_icd_procedures.key_icd_code IN ( SELECT d_icd_diagnoses.key_icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other' AND d_icd_diagnoses.short_title = 'other' ),,False,0.0,0.0015320777893066406,0,no such column: d_icd_procedures.key_icd_code,,,
2d480d93128c6d01d254b654,When does patient 8016's influenza quarantine end?,,SELECT d.charttime FROM microbiologyevents d WHERE d.hadm_id IN ( SELECT t.hadm_id FROM patients t WHERE t.age >= 50 AND t.gender = 'male' AND t.d_icd_procedures_icd_code = '13.95' ) ORDER BY d.charttime ASC LIMIT 1,,False,0.0,0.0017740726470947266,0,no such column: t.hadm_id,,,
ceb1b370c018763bf9d540ac,What is the procedure with the earliest consent date?,,SELECT procedures.drug FROM procedures WHERE procedures.consented = true ORDER BY procedures.starttime ASC LIMIT 1,,False,0.0,0.0014121532440185547,0,no such table: procedures,,,
a58a76b1090ea49d378d08c7,Show the average age of patients with a female first child.,,SELECT AVG(age) FROM patients WHERE patients.gender = 'female' AND patients.has_child = 'yes' AND patients.child_gender = 'female' AND patients.child_birth_order = 1,,False,0.0,0.0016055107116699219,0,no such column: age,,,
65b54a9a91e26ef539c19320,What is the most common marital status among patients who graduated from their universities before 2100?,,"SELECT T1.C1 FROM ( SELECT T2.C1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C2 FROM ( SELECT admissions.patient_id, d_icd_procedures.long_title FROM admissions WHERE admissions.age BETWEEN 0 AND 89 GROUP BY admissions.patient_id ) AS T1 JOIN ( SELECT patients.marital_status, patients.age FROM patients WHERE patients.age BETWEEN 0 AND 89 GROUP BY patients.marital_status, patients.age ) AS T2 ON T1.patient_id = T2.patient_id WHERE T2.age < 2100 GROUP BY T2.C1 ) AS T1 WHERE T1.C2 = 1",,False,0.0,0.0016472339630126953,0,no such column: admissions.patient_id,,,
01d8cc2d8140fe97026f64a1,How many patients gave consent for procedures on holidays?,,"SELECT COUNT( DISTINCT d_icustays.chartitem_id ) FROM d_icustays WHERE d_icustays.chartitem_id IN ( SELECT d_procedures.chartitem_id FROM d_procedures WHERE d_procedures.label = 'consent for procedures' AND datetime(d_procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AND datetime(d_icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%w',d_icustays.intime) IN ( '0' , '6' )",,False,0.0,0.0013263225555419922,0,no such table: d_icustays,,,
1b5b4f108d7e42aaa4f7d982,What is the average time taken for appointments to be delayed in the obstetrics and gynecology department?,,"SELECT AVG( admissions.charttime - appointments.starttime ) FROM admissions WHERE admissions.hadm_id IN ( SELECT appointments.hadm_id FROM appointments WHERE appointments.spec_type = 'obstetrics and gynecology' ) AND admissions.admission_location = 'disch' AND admissions.dischtime IS NOT NULL GROUP BY admissions.age, admissions.gender, admissions.insurance, admissions.admission_location, admissions.admission_source, admissions.aux_diagnoses, admissions.diagnoses, admissions.careunit, admissions.attendingcovid, admissions.attending, admissions.admission_type, admissions.gender, admissions.age, admissions.insurance, admissions.dischtime, admissions.admittime, admissions.hadm_id, appointments.starttime, appointments.spec_type WHERE admissions.charttime < appointments.starttime",,False,0.0,0.0010519027709960938,0,incomplete input,,,
cd1a10bb48a5d78543c8274e,Calculate the total hospital cost this year for patients with an address in san diego.,,"SELECT SUM(h.cost) FROM hospital_cost_table h WHERE h.age = 0 AND h.city = 'san diego' AND datetime(h.admittime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY h.age",,False,0.0,0.0013186931610107422,0,no such table: hospital_cost_table,,,
3384a95117cfd66b0be93cc7,What are the names of the advisors of the patients admitted to the icu yesterday?,,"SELECT COUNT(*)> 0 FROM patients WHERE patients.age = 50 AND patients.gender = 'male' AND patients.admissiontype = 'trauma center' AND patients.dischargeto = 'expired' AND patients.admissionmonth = 1 AND datetime(ppatients.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",,False,0.0,0.0015492439270019531,0,no such column: patients.age,,,
62dc93be504c5467fcfd7023,What are the record companies of the male patients?,,SELECT COUNT(*) FROM patients WHERE patients.gender = 'male' AND patients.dischtime IS NOT NULL GROUP BY patients.careunit,,False,0.0,0.0013277530670166016,0,no such column: patients.dischtime,,,
e85b614de2cd2b16e98d1819,Organize a schedule for routine health check-ups of hospital staff.,,SELECT COUNT(*) FROM microbiologyevents WHERE organism = 'staphylococcus aureus' AND hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.age >= 50 ),,False,0.0,0.0014314651489257812,0,no such column: organism,,,
20212b42562c96ba09627d57,What can be prescribed for the hyposmolality patient?,,"SELECT DISTINCT d.drug FROM microbiome.d_icd_procedures d WHERE d_icd_procedures.key_icd_diagnoses = ( SELECT t1.key_icd_diagnoses FROM ( SELECT t.key_icd_diagnoses, RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM microbiome.key_icd_diagnoses_icd_procedures WHERE icd_procedures = 'other and unspecified procedures on digestive system' ) AS t JOIN microbiome.key_icd_diagnoses ON t.key_icd_diagnoses = key_icd_diagnoses.key_icd_diagnoses JOIN microbiome.icd_diagnoses ON key_icd_diagnoses.icd_diagnoses = icd_diagnoses.icd_diagnoses WHERE icd_diagnoses.long_title = 'hyposmolality' GROUP BY t.key_icd_diagnoses ) AS t1 WHERE t1.C1 <= 2 )",,False,0.0,0.0010187625885009766,0,incomplete input,,,
6cfb2f10e771a78363a1bc5c,At what age did patient 8245 get married?,,SELECT admissions.age FROM admissions WHERE admissions.chartkey = 8245 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,,False,0.0,0.0013973712921142578,0,no such column: admissions.chartkey,,,
32c14dcc9df90f448106023b,What are the most common distribution routes for drugs prescribed to patients aged 65 or older?,,SELECT d.route FROM drugs d WHERE d.age >= 65 GROUP BY d.route ORDER BY COUNT(*) DESC LIMIT 1,,False,0.0,0.0015115737915039062,0,no such table: drugs,,,
2db0f8c7e1cefb70047669cd,What is vertical profile,,"SELECT DISTINCT procedures.description FROM procedures WHERE procedures.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.valuenum = 0.0 AND chartevents.charttime >= datetime(current_time,'-1 year') )",,False,0.0,0.0014722347259521484,0,no such table: procedures,,,
e2998a185c87c0ba4d5fc2f7,What is the specimen quality of the most recent microbiology test done for patient 1272?,,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 1272 ) AND admissions.gender = ( SELECT admissions.gender FROM admissions WHERE admissions.pid = 1272 ) ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,,False,0.0,0.0015099048614501953,0,no such column: admissions.pid,,,
bb09a05cffc9f15b770ef908,Who did patient 6580 see when she or he last went to the oncology department.,,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = ( SELECT procedure_icd_cost.table_idx FROM procedure_icd_cost WHERE procedure_icd_cost.cost = ( SELECT MIN(procedure_icd_cost.cost) FROM procedure_icd_cost WHERE procedure_icd_cost.table_idx IN ( SELECT procedures_icd.table_idx FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = ( SELECT patients.row_id FROM patients WHERE patients.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.chart = 6580 ) ) ) AND chartevents.value = 'oncology' ) ) ) ) ) ) ) ORDER BY procedures_icd.chartevents_id DESC LIMIT 1,,False,0.0,0.0009524822235107422,0,incomplete input,,,
0ec2b830c3ca46507175024e,Can you please tell me the address of patient 23969?,,SELECT patients.address FROM patients WHERE patients.chartkey = 23969,,False,0.0,0.001506805419921875,0,no such column: patients.address,,,
8d2be59a2ae80a2665cee9f6,What is the longest icu stay duration for a patient with an acuity score of 10?,,SELECT MAX( d_icd_procedures_icustays.charttime - d_icd_diagnoses_icustays.charttime ) FROM d_icd_procedures_icustays JOIN d_icd_diagnoses_icustays ON d_icd_procedures_icustays.icustay_id = d_icd_diagnoses_icustays.icustay_id WHERE d_icd_diagnoses_icustays.long_title = 'acuity score of 10',,False,0.0,0.001399993896484375,0,no such table: d_icd_procedures_icustays,,,
7f2296fb74a26260f81ce5ed,Which doctor were patient 30228s seen when he or she last visited the urology department?,,SELECT visits.drug FROM visits WHERE visits.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.charttime = ( SELECT MIN(transfers.charttime) FROM transfers WHERE transfers.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'arterial blood gas' ) ) ) ) ),,False,0.0,0.0014629364013671875,0,no such table: visits,,,
57b1795f3ebba52457f40a4e,What is the residency status of the patient with the longest hospital stay?,,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY t2.c1 ASC ) AS c2 FROM ( SELECT u1.charttime, u1.hadm_id, u1.valuenum FROM labevents AS u1 WHERE u1.itemid IN ( SELECT t4.itemid FROM d_labitems AS t4 WHERE t4.label = 'o2 saturation pulseoxymetry' ) AND u1.valuenum IS NOT NULL ) AS t1 JOIN ( SELECT u2.charttime, u2.hadm_id, u2.icd_code, DENSE_RANK() OVER ( PARTITION BY u2.hadm_id ORDER BY u2.charttime ASC ) AS c1 FROM procedures_icd AS u2 WHERE u2.icd_code IN ( SELECT t5.icd_code FROM d_icd_procedures AS t5 WHERE t5.long_title = 'other and unspecified procedures on other arteries' ) AND u2.hadm_id IN ( SELECT t6.hadm_id FROM ( SELECT u3.charttime, u3.hadm_id, u3.valuenum FROM labevents",,False,0.0,0.0008089542388916016,0,incomplete input,,,
89b98595ecb5dd648dfff07a,What is the sum of the standing tackles made by the patients in the icu for the past year?,,"SELECT SUM(icustays.chartevents.valuenum) FROM icustays JOIN chartevents ON icustays.icustay_id = chartevents.icustay_id WHERE chartevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'standing tackles' ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year') GROUP BY icustays.chartevents.itemid",,False,0.0,0.0013461112976074219,0,no such table: chartitems,,,
4b6a1eea90bca13f7f4efb60,Find the number of patients with a male next of kin who were treated in micu.,,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.gender = 'male' AND admissions.dischtime IS NOT NULL AND admissions.careunit = 'micu' EXCEPT SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.gender = 'male' AND admissions.dischtime IS NOT NULL AND admissions.careunit = 'micu' AND admissions.nextofkin = 'spouse',,False,0.0,0.0013957023620605469,0,no such column: admissions.gender,,,
d35ffc3f43ed6b012ff81b78,Count the number of unique hospital locations.,,SELECT COUNT(DISTINCT d_icd_procedures.long_title) FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'excision of left lower lobe bronchus',,False,0.0,0.0011746883392333984,0,no such column: d_icd_procedures.short_title,,,
3254e2e1ee8fe4e2b1b311bc,How many admissions had a last contact time on a weekend and were discharged to home?,,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%w',admissions.dischtime) IN ( '0' , '6' ) AND admissions.dischto = 'home'",,False,0.0,0.0013799667358398438,0,no such column: admissions.dischto,,,
08b59f00be430697b18e99ef,Did patient 72107 actually fill out the consent form for a ct scan?,,SELECT COUNT(*)>0 FROM microbiologyevents WHERE patientid = 72107 AND organism = 'staphylococcus aureus',,False,0.0,0.0013988018035888672,0,no such column: patientid,,,
ae0f7e8f47b2f9f678c2f460,List all the salaries of the patients who got admitted to the tsicu for their first care unit.,,SELECT DISTINCT patients.chartkey FROM patients WHERE patients.age >= 18 AND patients.age < 80 AND patients.gender = 'male' AND patients.insurance = 'medicare' AND patients.marital_status = 'married' AND patients.religion = 'catholic' AND patients.ethnicity = 'not of hispanic origin' AND patients.city = 'boston' AND patients.state = 'ma' AND patients.died = 'no' AND patients.admission_type = 'emergency' AND patients.admission_location = 'emergency room' AND patients.admission_source = 'emergency room' AND patients.dischargeto IS NOT NULL AND patients.insurance = 'medicare' AND patients.marital_status = 'married' AND patients.religion = 'catholic' AND patients.ethnicity = 'not of hispanic origin' AND patients.city = 'boston' AND patients.state = 'ma' AND patients.died = 'no' AND patients.admission_type = 'emergency' AND patients.admission_location = 'emergency room' AND patients.admission_source = 'emergency room' AND patients.dischargeto IS NOT NULL AND patients.insurance = 'medicare' AND patients.marital_status = 'married' AND patients.religion = 'c,,False,0.0,0.0009958744049072266,0,"unrecognized token: ""'emergency""",,,
f0d231106f67ae20775315a0,What are the latest advancements in lab test technologies?,,"SELECT DISTINCT procedures.description FROM procedures WHERE procedures.label = 'lab test' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures.charttime DESC LIMIT 1",,False,0.0,0.0013780593872070312,0,no such table: procedures,,,
bb25eafdbf46cbaff7655e69,What are the languages spoken by patients who married before age 30?,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.hemoglobin < 9.9 AND microbiologyevents.platelets < 200.0 AND microbiologyevents.wbc < 4.9 AND microbiologyevents.rbc < 4.5 AND microbiologyevents.hematocrit < 36.0 AND microbiologyevents.differential_neutrophils < 50.0 AND microbiologyevents.differential_lymphocytes < 20.0 AND microbiologyevents.differential_monocytes < 10.0 AND microbiologyevents.differential_eosinophils < 3.0 AND microbiologyevents.differential_basophils < 1.0 AND microbiologyevents.ionized_calcium < 1.1 AND microbiologyevents.calcium < 8.6 AND microbiologyevents.phosphorus < 2.5 AND microbiologyevents.magnesium < 1.6 AND microbiologyevents.bicarbonate < 18.0 AND microbiologyevents.chloride < 95.0 AND microbiologyevents.sodium < 135.0 AND microbiologyevents.potassium < 3.5 AND microbiologyevents.lactate <,,False,0.0,0.0013794898986816406,0,no such column: microbiologyevents.hemoglobin,,,
0b70a63dd87a9cc3e9394bfc,What was los angeles about?,,SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'los angeles',,False,0.0,0.0014328956604003906,0,no such column: d_icd_procedures.short_title,,,
084afd2633ec15f7f471f409,What were the other styles?,,SELECT DISTINCT procedures.drug FROM procedures WHERE procedures.drug = 'other styles' AND procedures.charttime >= current_time - 1 year,,False,0.0,0.001462697982788086,0,"near ""year"": syntax error",,,
8c0883ba3fa949b8db01dae8,What are some eye drops that are acceptable for those with dry eye?,,SELECT DISTINCT d.drug FROM drug d WHERE d.drug IN ( SELECT p.drug FROM procedure p WHERE p.key = ( SELECT l.key FROM lab l WHERE l.spec_type_desc = 'dry eye' ) ),,False,0.0,0.0014376640319824219,0,no such table: drug,,,
590a46e35fc2ce6e48793a18,What are the most common side effects of loperamide hcl?,,"SELECT T2.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM microbiologyevents WHERE sto2 < 100 ) AS T1 JOIN ( SELECT * FROM microbiologyevents WHERE sto2 < 100 ) AS T2 ON T1.age = T2.age WHERE T1.drug = 'loperamide hcl' AND T2.drug != 'loperamide hcl' GROUP BY T1.drug, T2.drug ) AS T WHERE T.C1 <= 3",,False,0.0,0.0016384124755859375,0,no such column: sto2,,,
007c241a8e7fee7a038f792e,What are the most common procedure outcomes for patients based on their admission locations?,,"SELECT d.description FROM   ( SELECT   admissions.admittime, admissions.patientid, admissions.admission_location   FROM   admissions   WHERE   admissions.dischtime IS NULL ) AS t1 JOIN   ( SELECT   procedures.charttime, procedures.patientid, procedures.outcome   FROM   procedures   WHERE   procedures.label = 'other' ) AS t2 ON t1.patientid = t2.patientid WHERE t1.admittime < t2.charttime ORDER BY CASE WHEN t1.admission_location = 'emergency room' THEN 1 WHEN t1.admission_location = 'med/surg intensive care' THEN 2 WHEN t1.admission_location = 'gen medicine' THEN 3 WHEN t1.admission_location = 'gen surgery' THEN 4 WHEN t1.admission_location = 'neurosurgery' THEN 5 WHEN t1.admission_location = 'neurology' THEN 6 WHEN t1.admission_location = 'orthopedics' THEN 7 WHEN t1.admission_location = 'pediatrics' THEN 8 WHEN t1.admission_location = 'psychiatry' THEN 9 WHEN t1.admission_location = 'cardiac cath lab' THEN 10 WHEN t1.admission_location = 'cardiology' THEN",,False,0.0,0.0010280609130859375,0,"unrecognized token: ""'med/surg int""",,,
db6c51e3b981690d48f9b061,Determine the most influential features for discharge location.,,"SELECT T1.chartevents_valuenum FROM ( SELECT admissions.patient_id, admissions.dischloc_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM admissions GROUP BY admissions.patient_id, admissions.dischloc_desc ) AS T1 WHERE T1.C1 <= 3",,False,0.0,0.001379251480102539,0,no such column: admissions.patient_id,,,
f73f1dbf27ae1ba41d5baaae,What is the average number of standing tackles made by patients born after 2050?,,SELECT AVG(T1.C1) FROM ( SELECT COUNT(*) AS C1 FROM procedureevents T WHERE T.label = 'standing' AND T.age >= 2050 GROUP BY T.subject_id ) AS T1,,False,0.0,0.001489877700805664,0,no such table: procedureevents,,,
59aeffdc0bac4c82ab171b74,How many primary physicians have been at the hospital since this year?,,"SELECT COUNT( DISTINCT d_icd_procedures.key ) FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'primary' AND datetime(d_icd_procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,False,0.0,0.001425027847290039,0,no such column: d_icd_procedures.key,,,
8d1ff6c593a74a67330e7c04,"Throughout this year, what are the top five most common drugs prescribed during the same hospital encounter to female patients aged 50s after being diagnosed with epilepsy, unspecified, not intractable, without status epilepticus?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, not intractable, without status epilepticus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT d.drug FROM ( SELECT t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT o.itemid, o.starttime FROM chartevents o WHERE o.valuenum = 50s AND o.spec_type = 'female' ) AS t1 JOIN ( SELECT o.itemid, o.starttime FROM chartevents o WHERE o.valuenum = 50s AND o.spec_type = 'female' ) AS t2 ON t1.itemid = t2.itemid WHERE datetime(t1.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND datetime(t2.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND t1.starttime < t2.starttime AND datetime(t2.starttime) BETWEEN datetime(t1.starttime) AND datetime(t1.starttime,'+1 year') GROUP BY t1.drug ) AS t3 JOIN drug d ON t3.drug = d.drug_name WHERE t3.C1 <= 5 AND d.drug_name = 'epilepsy, unspecified, not intractable, without status epilepticus'",,False,0.0,0.0011055469512939453,0,"unrecognized token: ""50s""",,,
ff3cb10da055df7f8ad45db1,What is the address of patient 15945.,,SELECT d.street_name FROM microbiologyevents AS a WHERE a.spec_type_desc = 'blood culture' AND a.hadm_id IN ( SELECT b.hadm_id FROM patients AS b WHERE b.age = 60 AND b.gender = 'male' AND b.d_icd_procedures_icd_code = 'J3300' ) ORDER BY a.charttime ASC LIMIT 1,,False,0.0,0.001516580581665039,0,no such column: d.street_name,,,
09a532dd5b6e9afd19c87264,What is the adresse of patient 97395?,,SELECT patients.address FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto IS NOT NULL AND definition.longtitle = 'patient age' ) AND chartevents.valuenum = 97395 ),,False,0.0,0.0014996528625488281,0,no such table: definition,,,
8465e809028d1263318be90f,What is the difference between platelet count last measured on the first hospital visit compared to the first value measured on the first hospital visit for patient 10009628?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT MIN( admissions.row_id ) FROM admissions WHERE admissions.gender = 'male' ) ) AND admissions.gender = 'male' ORDER BY admissions.admittime ASC LIMIT 1 ) AND labresults.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'platelet count' ) ORDER BY labresults.charttime DESC LIMIT 1 ) - ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT MIN( admissions.row_id ) FROM admissions WHERE admissions.gender = 'male' ) ) AND admissions.gender = 'male' ORDER BY admissions.admittime ASC LIMIT 1 ) AND labresults.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'platelet count' ) ORDER BY labresults.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0009481906890869141,0,incomplete input,,,
c5d97a3fa6b67acc42a60f3f,How many days have passed since patient 10039831's last stay in careunit discharge lounge in this hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers_icu.intime) ) FROM transfers_icu WHERE transfers_icu.chartkey IN ( SELECT admissions.chartkey FROM admissions WHERE admissions.age >= 0 AND admissions.hospital_dischtime IS NOT NULL AND admissions.admission_location = 'discharge lounge' ORDER BY admissions.admissiontime DESC LIMIT 1 ) AND transfers_icu.careunit = 'discharge lounge' AND transfers_icu.outtime IS NOT NULL AND transfers_icu.chartkey IN ( SELECT procedures.chartkey FROM procedures WHERE procedures.label = 'patient 10039831' AND procedures.duration IS NOT NULL ORDER BY procedures.starttime DESC LIMIT 1 )",[],False,0.0,0.0009539127349853516,0,incomplete input,,,
289be48fc696c588e5a69f9c,Pull up the IDs of patients who were diagnosed with cataract extraction status.,SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cataract extraction status' ) ),SELECT patients.subject_id FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'cataract extraction status' ),[],False,0.0,0.001415252685546875,0,no such table: procedures,,,
8a7a53bc8a46ea0c02865fa2,"What was the drug that patient 10004720 prescribed with during the same day after receiving introduction of nutritional substance into upper gi, via natural or artificial opening since 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT T2.drug FROM   ( SELECT  INTIME AS time1   FROM procedureevents   WHERE procedureevents.subject_id = 10004720 AND procedureevents.label = 'introduction of nutritional substance into upper gi, via natural or artificial opening' AND strftime('%Y-%m',procedureevents.intime) >= '2100-03' ) AS T1   JOIN   ( SELECT  STDTIME AS time2, drug   FROM d_icd_procedures   WHERE d_icd_procedures.icd_code = ( SELECT   procedureevents.icd_code   FROM procedureevents   WHERE procedureevents.subject_id = 10004720 AND procedureevents.label = 'introduction of nutritional substance into upper gi, via natural or artificial opening' AND strftime('%Y-%m',procedureevents.intime) >= '2100-03' ORDER BY procedureevents.intime ASC LIMIT 1 )   JOIN   ( SELECT  STDTIME   FROM prescription   WHERE prescription.drug = T1.drug AND prescription.subject_id = 10004720 AND strftime('%Y-%m',prescription.stdtime) >= '2100-03' )   ON d_icd_procedures.icd_code = procedureevents.icd_code   WHERE datetime(T1.time1,'",,False,0.0,0.0008552074432373047,0,incomplete input,,,
6c76f49427e903af86c8314e,Count the number of days since patient 10021487's first diagnosis of acute respiratory failure following trauma and surgery on this hospital visit.,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute respiratory failure following trauma and surgery' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT COUNT(DISTINCT strftime('%J', admissions.dischtime) - strftime('%J', transfers.intime)) FROM admissions WHERE admissions.age >= 18 AND admissions.hosp_id = 1 AND admissions.gender = 'M' AND admissions.chartevents.key = ( SELECT admissions.key FROM admissions WHERE admissions.age >= 18 AND admissions.hosp_id = 1 AND admissions.gender = 'M' AND admissions.pid = 10021487 AND admissions.admittime >= transfers.intime ORDER BY admissions.admittime ASC LIMIT 1 ) AND admissions.dischtime IS NOT NULL AND admissions.age >= 18 AND admissions.hosp_id = 1 AND admissions.gender = 'M' AFTER transfers.intime WHERE transfers.key = ( SELECT admissions.key FROM admissions WHERE admissions.age >= 18 AND admissions.hosp_id = 1 AND admissions.gender = 'M' AND admissions.pid = 10021487 AND admissions.admittime >= transfers.intime ORDER BY admissions.admittime ASC LIMIT 1 ) AND transfers.event_type = 'trauma' AND admissions.age >= 18 AND admissions.hosp_id = 1 AND admissions.gender = 'M' AFTER transfers.intime WHERE transfers.key = ( SELECT admissions.key FROM admissions WHERE admissions.age >= 18 AND admissions.hosp_id =",,False,0.0,0.0014405250549316406,0,no such column: transfers.intime,,,
6c16600578aa6d76931a6d00,"What are the five commonly taken specimens for patients who received extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic previously during the same month since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT patients.subject_id, procedures.charttime FROM procedures WHERE procedures.label = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' AND strftime('%Y',procedures.charttime) >= '2100' ) AS T2 JOIN ( SELECT patients.subject_id, labevents.charttime, labevents.spec_type_desc FROM labevents JOIN patients ON labevents.hadm_id = patients.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T1 ON T2.subject_id = T1.subject_id WHERE T1.charttime > T2.charttime AND datetime(T1.charttime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'start of month','+1 month') GROUP BY T1.spec_type_desc ORDER BY COUNT(*) DESC LIMIT 5",,False,0.0,0.0013952255249023438,0,no such table: procedures,,,
220a7871615e4c1a12e5cf08,Retrieve the marital status of patient 10006580 on the last hospital stay.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,"SELECT d.valuenum FROM microbiologyevents d WHERE d.hadm_id IN ( SELECT b.hadm_id FROM patients a JOIN admissions b ON a.row_id = b.patient_id WHERE a.age >= 50 AND a.gender = 'male' AND a.d_icd_procedures_icd_code = '13.95' AND strftime('%Y',b.admittime) >= '2100' ) ORDER BY d.charttime DESC LIMIT 1",[{'marital_status': 'MARRIED'}],False,0.0,0.0013432502746582031,0,no such column: d.valuenum,,,
17bb906271e8d84bf499f645,How much does patient 10038999 change in mesothelial cells last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT labresults_valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'mesothelial cells' ) ORDER BY labresults.charttime DESC LIMIT 1 ) - ( SELECT labresults_valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'mesothelial cells' ) ORDER BY labresults.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",False,0.0,0.0009145736694335938,0,"near ""LIMI"": syntax error",,,
cf75e230ba259301517169ac,What was the total output for patient 10001217 since 12/02/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-02'",SELECT SUM(inputdailytotaloutput.inputtotal) FROM inputdailytotaloutput WHERE inputdailytotaloutput.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL AND admissions.age = 100 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' AND admissions.admission_location = 'emergency room' AND admissions.charttime >= '2100-12-02' ) AND inputdailytotaloutput.charttime >= '2100-12-02' AND inputdailytotaloutput.hadm_id = 10001217,[{'SUM(outputevents.value)': 5320.0}],False,0.0,0.0009207725524902344,0,incomplete input,,,
126247b40bdfae51da6c523f,How frequently was the simple excision of other lymphatic structure procedure done throughout this year?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM procedureevents WHERE procedureevents.label = 'simple excision of other lymphatic structure' AND datetime(procedureevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m',procedureevents.charttime) ORDER BY strftime('%Y-%m',procedureevents.charttime) ASC",,False,0.0,0.0012946128845214844,0,no such table: procedureevents,,,
f8f6d23e64a92d83dd3fd151,Has there been any organism detected during the last rapid respiratory viral screen & culture microbiology test for patient 10007818 since 02/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*)>0 FROM microbiologyevents WHERE organism_name IS NOT NULL AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 2100-02-01 AND admissions.gender = 'male' AND admissions.age < 2100-03-01 ) AND microbiologyevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 2100-02-01 AND admissions.gender = 'male' AND admissions.age < 2100-03-01 ) AND procedures.label = 'patient 10007818' ),[{'COUNT(*)>0': 0}],False,0.0,0.0009360313415527344,0,incomplete input,,,
b472da76f7e2b4d53f38f131,"Can you tell me the last care unit patient 10003046 was in during their last hospital visit, according to the transfer record?",SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1,"SELECT T1.careunit FROM ( SELECT T2.careunit, DENSE_RANK() OVER ( ORDER BY T2.intime DESC ) AS C1 FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.pid = 10003046 ) ) ) AS T1 JOIN ( SELECT * FROM d_icustays WHERE d_icustays.pid = 10003046 ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.spec_type_desc = 'blood culture' AND datetime(T1.charttime,'start of day') = datetime(T2.intime,'start of day') ) AS T1 WHERE T1.C1 = 1",[{'careunit': 'Med/Surg'}],False,0.0,0.0009315013885498047,0,"unrecognized token: ""'st""",,,
52c6c669438001d194f1c9a8,What is the length of the first hospital stay in days for patient 10016742?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT DISTINCT T1.C1 FROM ( SELECT PROCEDURE_TITLE, D_icd_procedures_icd_codes.ICD_CODE FROM D_icd_procedures_icd_codes WHERE D_icd_procedures_icd_codes.ICD_TITLE = 'insertion or replacement of aortic valve with mechanical valve' ) AS T2 JOIN ( SELECT PROCEDURE_TITLE, D_icd_procedures_icd_codes.ICD_CODE FROM D_icd_procedures_icd_codes WHERE D_icd_procedures_icd_codes.ICD_TITLE = 'insertion or replacement of aortic valve with mechanical valve' ) AS T3 ON T2.ICD_CODE = T3.ICD_CODE JOIN ( SELECT patient_id, admissions.charttime, admissions.dischtime FROM admissions WHERE admissions.patient_id = 10016742 AND admissions.admission_location = 'hospital' ORDER BY admissions.admittime ASC LIMIT 1 ) AS T4 ON T2.ICD_CODE IN ( SELECT procedures_icd.ICD_CODE FROM procedures_icd WHERE procedures_icd.charttime >= T4.charttime AND procedures_icd.charttime <= T4.dischtime ) JOIN ( SELECT patient_id, admissions.charttime, admissions.dischtime FROM admissions WHERE admissions.patient_id = 10016742 AND admissions.admission_location = 'hospital","[{""strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime)"": 4.963194443844259}]",False,0.0,0.0009250640869140625,0,incomplete input,,,
82623a9f149ae4a941d737fc,Which condition was diagnosed for patient 10006580 on the last on the last hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT u1.icd_code FROM ( SELECT o1.icd_code, d_icu_outpatients.chart_idx FROM d_icu_outpatients WHERE d_icu_outpatients.age = ( SELECT m FROM ( SELECT t1.age, DENSE_RANK() OVER ( ORDER BY t1.age DESC ) AS c1 FROM ( SELECT age, DENSE_RANK() OVER ( ORDER BY admissiontime DESC ) AS c2 FROM d_icu_outpatients WHERE d_icu_outpatients.chart_idx IN ( SELECT t4.chart_idx FROM ( SELECT t3.chart_idx, DENSE_RANK() OVER ( ORDER BY t3.admissiontime DESC ) AS c4 FROM ( SELECT o2.chart_idx, o2.admissiontime FROM d_icu_outpatients AS o2 WHERE o2.chart_idx IN ( SELECT t1.chart_idx FROM ( SELECT d_icu_outpatients.chart_idx, DENSE_RANK() OVER ( ORDER BY d_icu_outpatients.age DESC ) AS c1 FROM d_icu_outpatients WHERE d_icu_outpatients.chart_idx IN ( SELECT t2.chart_idx FROM ( SELECT d_icu_outpatients.chart_idx, DENSE_RANK",,False,0.0,0.0009889602661132812,0,incomplete input,,,
7437f40a03312a89a951bf71,"For patients who had hemodialysis, what were the most frequent four microbiology tests carried out during the same hospital visit?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents AS T1 JOIN patients ON T1.subject_id = patients.subject_id WHERE T1.spec_type_desc = 'hemodialysis' GROUP BY T2.test_name ) AS T1 WHERE T1.C1 <= 4",,False,0.0,0.0013303756713867188,0,no such column: T2.test_name,,,
5db93544ca13afa9605c5f92,How many current patients are 30s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age BETWEEN 30 AND 39 AND patients.dischtime IS NULL,,False,0.0,0.0013232231140136719,0,no such column: patients.age,,,
ec1ed057dd7ec2a55f903e6e,Calculate the number of times that patient 10004235 had lr input on 12/24/last year.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'","SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'lr input' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = labevents.hadm_id ) AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year') ) AND labevents.valuenum IS NOT NULL AND strftime('%Y-%m-%d',labevents.charttime) = datetime(current_time,'start of year','-1 year','month=12','day=24') AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.patient_id = 10004235 )",[{'COUNT(*)': 0}],False,0.0,0.0008740425109863281,0,incomplete input,,,
7873d7d50e05f38127c1a555,Has patient 10005866 had any type of diagnosis in this year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT(*)>0 FROM microbiologyevents WHERE patients.chartitems.valuenum IS NOT NULL AND patients.chartitems.valuename = 'age' AND patients.chartitems.linksto = 'microbiologyevents' AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = patients.chartitems.valuenum AND admissions.gender = patients.chartitems.valuename AND admissions.year = 2100 ),,False,0.0,0.0012514591217041016,0,no such column: patients.chartitems.valuenum,,,
e57140ff3a3e15a2db33f62d,How much of a difference is there in patient 10006580's white blood cells second measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT MIN( admissions.row_id ) FROM admissions WHERE admissions.age IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC ) ) ) AND labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'white blood cells' ) AND labevents.hadm_id = 10006580 ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT MIN( admissions.row_id ) FROM admissions WHERE admissions.age IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC ) ) ) AND labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'white blood cells' ) AND labevents.hadm_id = 10006580 ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.000812530517578125,0,incomplete input,,,
0dec474abd85aab4b9b4bf61,What diagnosis did patient 10003400 receive the last time since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 2100 AND admissions.gender = 'male' AND admissions.pid = 10003400 ) ORDER BY labevents.charttime DESC LIMIT 1 ),,False,0.0,0.0012049674987792969,0,no such column: admissions.gender,,,
19a51debb0c5754456d20d1f,How many medications were prescribed to patient 10022017 since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y',prescriptions.starttime) >= '2100'",SELECT COUNT(*) FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.long_title = 'daily weight' ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime >= '2100-01-01' ) AND prescriptions.spec_type_desc = 'medications' AND prescriptions.drug = prescriptions.drug AND prescriptions.drug IS NOT NULL AND prescriptions.drug != '' AND prescriptions.spec_type_desc = 'medications' AND prescriptions.chartevents_icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.long_title = 'daily weight' ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime >= '2100-01-01' ) AND prescriptions.drug = prescriptions.drug AND prescriptions.drug IS NOT NULL AND prescriptions.drug != '' AND prescriptions.spec_type_desc = 'medications' AND prescriptions.chartevents_icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.long_title = 'daily weight',[{'COUNT(*)': 104}],False,0.0,0.0014388561248779297,0,no such table: definition,,,
18feccbb84730d8b9391bf79,"What were the top three most frequent microbiology tests that patients were given after being diagnosed with acquired absence of organ, genital organs during the same hospital encounter since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of organ, genital organs' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T1.test_name FROM ( SELECT procedures.drug_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures WHERE procedures.drug_name IN ( SELECT procedures.drug_name FROM procedures WHERE procedures.label = 'acquired absence of organ, genital organs' AND strftime('%Y',procedures.charttime) >= '2100' ) GROUP BY procedures.drug_name ) AS T1 WHERE T1.C1 <= 3",,False,0.0,0.0013303756713867188,0,no such table: procedures,,,
590d8305084857287efef413,How much did patient 10038999 weigh at their first measurement on the first hospital encounter?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,"SELECT d.valuenum FROM labevents d WHERE d.hadm_id IN ( SELECT a.hadm_id FROM microbiologyevents a WHERE a.spec_type_desc = 'blood culture' AND a.org_name = 'staphylococcus aureus' AND a.time < datetime(current_time,'-1 year') ) ORDER BY d.charttime ASC LIMIT 1",[],False,0.0,0.0012481212615966797,0,no such column: a.time,,,
3857136499aee33dbb04cab5,When did patient 10038081 get the first blood (ebv) microbiology test since 16 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood (ebv)' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'blood (ebv)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = labevents.hadm_id ) ) AND datetime(labevents.charttime) >= datetime(current_time,'-16 month') ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0007925033569335938,0,"unrecognized token: ""'-16 mon""",,,
c2d3722d0ba8692f756e7846,What was the first diagnosis that patient 10021666 received this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT d.icd_name FROM diagnosis d WHERE d.icustay_id IN ( SELECT p.icustay_id FROM patients p WHERE p.age >= 18 AND p.gender = 'male' AND p.subject_id = 10021666 ) AND datetime(d.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY d.charttime ASC LIMIT 1",,False,0.0,0.0012319087982177734,0,no such table: diagnosis,,,
85c3e2700b75549e5f889cf1,What is the name of the medication that patient 10036156 received two or more times in their last hospital visit?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T2.drug FROM ( SELECT procedures.charttime, procedures.itemid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= current_time - interval '1 year' ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T1 JOIN ( SELECT procedures.charttime, procedures.itemid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= current_time - interval '1 year' ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T2 ON T1.charttime < T2.charttime WHERE T1.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.ad","[{'drug': '0.9% Sodium Chloride'}, {'drug': 'Bag'}, {'drug': 'Magnesium Sulfate'}, {'drug': 'Neutra-Phos'}, {'drug': 'Pantoprazole'}, {'drug': 'Potassium Chloride'}, {'drug': 'Sodium Chloride 0.9%'}, {'drug': 'TraZODone'}]",False,0.0,0.0006685256958007812,0,"near ""'1 year'"": syntax error",,,
f3051b86c007dd34ade04ba9,When was the last time that patient 10003400 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003400 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1","SELECT hospital_discharges.charttime FROM hospital_discharges WHERE hospital_discharges.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10003400 ) AND strftime('%Y',hospital_discharges.admittime) >= '2100' ORDER BY hospital_discharges.charttime DESC LIMIT 1",[{'dischtime': '2137-09-02 17:05:00'}],False,0.0,0.0009996891021728516,0,no such table: hospital_discharges,,,
04a4403dd1172df24786f145,Please show me the top three most usual procedures for patients aged 20s since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d.proc_name FROM   ( SELECT   d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   procedureevents d   WHERE   d.age BETWEEN 20 AND 29   AND strftime('%Y',d.charttime) >= '2100'   GROUP BY   d.proc_name ) AS T1 WHERE   T1.C1 <= 3",,False,0.0,0.0010523796081542969,0,no such table: procedureevents,,,
c16ba004a34ca12d357c16d6,How many patients in 2100 received central venous catheter placement with guidance after the reopening of recent thoracotomy site procedure within the same month?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reopening of recent thoracotomy site' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_studies a JOIN procedures b ON a.subject_id = b.subject_id WHERE b.procedure_name = 'central venous catheter placement with guidance' AND strftime('%Y',b.charttime) = '2100' AND EXISTS ( SELECT * FROM procedures c WHERE c.subject_id = a.subject_id AND c.procedure_name = 'reopening of recent thoracotomy site' AND strftime('%Y',c.charttime) = '2100' AND datetime(b.charttime) >= datetime(c.charttime) AND datetime(b.charttime) < datetime(c.charttime,'start of month +1 month') )",,False,0.0,0.0006403923034667969,0,incomplete input,,,
58a17f0e9f1fb5701047c022,Did patient 10002428 come to the er during the first hospital encounter?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*)>0 FROM er_visits WHERE er_visits.chart_id IN ( SELECT admissions.chart_id FROM admissions WHERE admissions.hospital_dischtime IS NOT NULL AND admissions.age BETWEEN 50 AND 60 AND admissions.admission_type = 'emergency' ) AND er_visits.event_type = 'disch' AND er_visits.chart_id = 10002428,[{'COUNT(*)>0': 0}],False,0.0,0.0010535717010498047,0,no such table: er_visits,,,
83b456769e420696daed1609,What's the diastolic blood pressure change of patient 10022281 last measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT labitems.valuenum FROM labitems WHERE labitems.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10022281 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime ASC LIMIT 1 ) AND labitems.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.valuenum IS NOT NULL ORDER BY chartevents.charttime ASC LIMIT 1 ) ORDER BY labitems.charttime DESC LIMIT 1 ) - ( SELECT labitems.valuenum FROM labitems WHERE labitems.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10022281 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime ASC LIMIT 1 ) AND labitems.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.valuenum IS NOT NULL ORDER BY chartevents.charttime ASC LIMIT 1 ) ORDER BY labitems.charttime ASC LIMIT 1 ) FROM labitems WHERE labitems.hadm_id IN ( SELECT admissions.hadm_id,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0005869865417480469,0,incomplete input,,,
d6d0cf531ac1d23c6fa0a6b6,What is the number of times patient 10019172 visited the hospital?,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019172,"SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = 'J3300' AND patients.charttime >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.hadm_id )': 2}],False,0.0,0.0009968280792236328,0,no such column: patients.hadm_id,,,
421648dc5e387538f77aee5c,How many patients were prescribed albuterol 0.083% neb soln within the same hospital visit after they were diagnosed with personal history of malignant neoplasm of prostate in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of prostate' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'albuterol 0.083% neb soln' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study a JOIN ( SELECT b.subject_id, b.charttime FROM microbiome_study b WHERE b.drug = 'albuterol 0.083% neb soln' AND strftime('%Y',b.charttime) = '2100' ) AS tmp1 ON a.subject_id = tmp1.subject_id JOIN ( SELECT c.subject_id, c.charttime FROM microbiome_study c WHERE c.drug = 'personal history of malignant neoplasm of prostate' AND strftime('%Y',c.charttime) = '2100' ) AS tmp2 ON a.subject_id = tmp2.subject_id WHERE a.charttime IS NOT NULL AND tmp1.charttime IS NOT NULL AND tmp2.charttime IS NOT NULL AND datetime(tmp1.charttime) > datetime(tmp2.charttime) AND a.hadm_id = tmp1.hadm_id AND a.hadm_id = tmp2.hadm_id",,False,0.0,0.0010514259338378906,0,"near ""A"": syntax error",,,
f18bca6a8a225c176e87417b,What's new in patient 10039831's medication list today compared to the list yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT medications.drug FROM medications WHERE medications.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IN ( SELECT events.charttime FROM events WHERE events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IN ( SELECT events.charttime FROM events WHERE events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.id = 10039831 ) ) AND events.event_type = 'admission' ) ORDER BY events.charttime DESC LIMIT 1 ) ) ) AND admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.id = 10039831 ) ) AND admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.id = 10039831 ) ) AND medications.starttime IN ( SELECT T1.starttime FROM ( SELECT medications.starttime, DENSE_RANK() OVER ( ORDER BY medications.starttime DESC ) AS C1 FROM medications WHERE medications.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.id = 10039831 ) ) ) AS T1 WHERE T1.C1 <= 1",[],False,0.0,0.0006585121154785156,0,incomplete input,,,
3173d5e9349394956703946f,When was the last instance when patient 10021487's respiratory rate was greater than 17.0 on 12/17/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 17.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-17' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT d.charttime FROM labevents d WHERE d.hadm_id IN ( SELECT c.hadm_id FROM patients c WHERE c.age >= 50 AND c.gender = 'male' ) AND d.valuenum > 17.0 AND d.itemid IN ( SELECT b.itemid FROM d_icd_items b WHERE b.long_title = 'respiratory rate' ) AND strftime('%Y-%m-%d',d.charttime) = '2100-12-17' ORDER BY d.charttime DESC LIMIT 1",[],False,0.0,0.0010402202606201172,0,no such table: d_icd_items,,,
3dd7cbf61468460681ff3c30,What were the top five most common treatments given to patients in their 60 or above since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.treatment FROM ( SELECT procedures.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures WHERE procedures.age >= 60 AND strftime('%Y',procedures.charttime) >= '2100' GROUP BY procedures.drug ) AS T1 WHERE T1.C1 <= 5",,False,0.0,0.001001596450805664,0,no such table: procedures,,,
d0eb687248bca6964f140046,How many people died after being diagnosed with posttraumatic stress disorder within 2 months throughout this year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'posttraumatic stress disorder' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-0 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE ( datetime(T3.dod) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') ) OR ( datetime(T2.charttime) BETWEEN datetime(T3.dod) AND datetime(T3.dod,'+2 month') )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND admissions.age >= 18 AND admissions.age < 89 AND admissions.admission_type_desc = 'emergency room' EXCEPT SELECT DISTINCT admissions1.subject_id FROM admissions AS admissions1 WHERE admissions1.dischtime IS NOT NULL AND datetime(admissions1.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND admissions1.age >= 18 AND admissions1.age < 89 AND admissions1.admission_type_desc = 'emergency room' AND admissions1.charttime IS NOT NULL AND admissions1.charttime BETWEEN admissions.charttime AND datetime(admissions.charttime,'+2 month') AND admissions1.spec_type_desc = 'posttraumatic stress disorder'",,False,0.0,0.0006635189056396484,0,incomplete input,,,
68f60925ee10fafbe0a043b1,Is systolic blood pressure of patient 10027602 last measured on the last ICU visit greater than the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT labitems.valuenum FROM labitems WHERE labitems.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND labitems.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_icditems.itemid FROM d_icditems WHERE d_icditems.long_title = 'arterial blood pressure systolic' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) ) > ( SELECT labitems.valuenum FROM labitems WHERE labitems.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND labitems.itemid IN ( SELECT chartevents.itemid,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0005888938903808594,0,incomplete input,,,
7cdb91fabb7e08749637f74e,How many individuals are there who are current patients?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT( DISTINCT d_icustays.charttime ) FROM d_icustays WHERE d_icustays.outtime IS NULL,[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0010099411010742188,0,no such table: d_icustays,,,
9f97931d5d6f4871dc6efe31,Provide the ID list of patients who were diagnosed with methicillin susceptible pneumonia due to staphylococcus aureus since 2100.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible pneumonia due to staphylococcus aureus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",SELECT DISTINCT patients.subject_id FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'diagnosis' AND procedures.charttime >= '2100-01-01' AND procedures.val = 'methicillin susceptible pneumonia due to staphylococcus aureus' ),,False,0.0,0.0012698173522949219,0,no such table: procedures,,,
b0bde5b825a0b0039eb609d0,"Since 178 days ago, when was the mean blood pressure of patient 10005817, for the last time, observed at less than 76.0?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 76.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-178 day') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MIN( d_icustays.outtime ) FROM microbiologyevents AS a JOIN d_icustays ON a.subject_id = d_icustays.subject_id WHERE a.spec_type_desc = 'blood culture' AND a.org_name_desc = 'staphylococcus aureus' AND d_icustays.outtime IS NOT NULL AND datetime(d_icustays.outtime) >= datetime(current_time,'-178 day')",[],False,0.0,0.001210927963256836,0,no such table: d_icustays,,,
ae1a61baad9fcbb6ccb57c0b,"Give me the top four most frequent diagnoses that patients were diagnosed with in the same month after being diagnosed with body mass index 35.0-35.9, adult this year.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT subject_id, admissions.charttime FROM admissions WHERE admissions.dischtime IS NOT NULL AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND admissions.age >= 18 GROUP BY subject_id ) AS t1 JOIN ( SELECT subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY subject_id, diagnoses.icd_code ) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.charttime < t2.charttime AND datetime(t1.charttime,'start of year') = datetime(current_time,'start of",,False,0.0,0.0005230903625488281,0,incomplete input,,,
5c2b95425f850cf9aee654aa,Please list the yearly average volume of stool that was output by patient 10020740 since 03/26/2100.,"SELECT AVG(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'stool' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-26' GROUP BY strftime('%Y',outputevents.charttime)",SELECT AVG(d_icd_procedures_icd_icd_items_val.valuenum) FROM d_icd_procedures_icd_icd_items_val WHERE d_icd_procedures_icd_icd_items_val.charttime >= '2100-03-26' AND d_icd_procedures_icd_icd_items_val.charttime < '2101-03-26' AND d_icd_procedures_icd_icd_items_val.itemid IN ( SELECT d_icd_procedures_icd_items.itemid FROM d_icd_procedures_icd_items WHERE d_icd_procedures_icd_items.long_title = 'output of stool' ) AND d_icd_procedures_icd_icd_items_val.charttime IN ( SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT d_icd_procedures_icd_icd_items_val.row_id FROM d_icd_procedures_icd_icd_items_val WHERE d_icd_procedures_icd_icd_items_val.itemid IN ( SELECT d_icd_procedures_icd_items.itemid FROM d_icd_procedures_icd_items WHERE d_icd_procedures_ic,[],False,0.0,0.0005164146423339844,0,incomplete input,,,
55d4903b176bcfa711e73e0f,"Has patient 10006580 had any implantation or replacement of carotid sinus stimulation device, total system procedure in 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10006580 ) AND procedures_icd.icd_code = '00.66' AND strftime('%Y',procedures_icd.charttime) = '2100'",,False,0.0,0.0009005069732666016,0,no such table: visits,,,
82d84ee3f00fa576d3b70969,Is the anion gap level of patient 10003400 measured at 2100-06-15 05:34:00 less than the level measured at 2100-06-14 06:15:00?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-06-15 05:34:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-06-14 06:15:00' ),SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10003400 ) AND labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'anion gap' ) AND labevents.charttime = '2100-06-15 05:34:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10003400 ) AND labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'anion gap' ) AND labevents.charttime = '2100-06-14 06:15:00' ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-06-15 05:34:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-06-14 06:15:00' )"": None}]",False,0.0,0.0005197525024414062,0,incomplete input,,,
ef3f743b0397c2df00366c56,Show me the length of stay in days of patient 10004422's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT DISTINCT T1.C1 FROM ( SELECT T2.charttime, T2.valuenum FROM labevents AS T2 WHERE T2.hadm_id IN ( SELECT T1.hadm_id FROM ( SELECT T3.hadm_id, MIN(T3.admittime) AS C1 FROM ( SELECT T4.hadm_id, admissions.charttime, admissions.valuenum FROM admissions AS T4 WHERE T4.age = 50 AND T4.gender = 'male' AND T4.spec_type = 'onc' AND T4.spec_desc = 'onc' AND T4.d_icd_procedures_icd_id = 10021025 AND T4.label = 'onc' AND T4.valuenum = 0.0 ) AS T3 WHERE T3.charttime IS NOT NULL GROUP BY T3.hadm_id ) AS T1 WHERE T1.C1 IS NOT NULL ) AS T2 WHERE T2.hadm_id IN ( SELECT T1.hadm_id FROM ( SELECT T3.hadm_id, MIN(T3.admittime) AS C1 FROM ( SELECT T4.hadm_id, admissions.charttime, admissions.valuenum FROM admissions AS T4 WHERE T4.age = 50 AND T4.gender = 'male'","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 6.356898148078471}]",False,0.0,0.0005269050598144531,0,incomplete input,,,
4ea7d91dc5b0b0f4da0cb1c6,"Among patients who were diagnosed with anemia, unspecified since 2100, what are the top three most commonly prescribed medications that followed during the same hospital visit for patients in their 60 or above?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T2.drug FROM ( SELECT admissions.subject_id, admissions.charttime, admissions.dischtime FROM admissions WHERE admissions.age >= 60 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL AND strftime('%Y',admissions.admissiontime) >= '2100' GROUP BY admissions.subject_id, admissions.charttime ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM admissions JOIN prescriptions ON admissions.subject_id = prescriptions.subject_id WHERE admissions.age >= 60 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL AND strftime('%Y',admissions.admissiontime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.dischtime >= T2.starttime AND T1.charttime >= strftime('%Y-%m-%d %H:%M:%S',datetime(current_time,'-1 year')) AND T1.dischtime >= strftime('%Y-%m-%d %H:%M:%S',datetime(current_time,'-1 year')) AND EXISTS ( SELECT FROM diagnoses WHERE diagnoses.hadm_id = T1.hadm_id AND diagnoses.charttime >= T",,False,0.0,0.0005362033843994141,0,incomplete input,,,
01816d54bc83e51d38259aaf,What was patient 10009628's insurance plan on their last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,"SELECT d.insurance_plan FROM microbiome_insurance_plan d WHERE d.chartkey IN ( SELECT t.chartkey FROM ( SELECT o.chartkey, o.row_id FROM microbiome_labevents o WHERE o.itemid IN ( SELECT p.itemid FROM microbiome_d_icd_items p WHERE p.long_title = 'insurance plan' ) AND o.valuenum IS NOT NULL ORDER BY o.charttime DESC ) AS t WHERE t.row_id IN ( SELECT MAX(s.row_id) FROM ( SELECT o.chartkey, o.row_id FROM microbiome_labevents o WHERE o.itemid IN ( SELECT p.itemid FROM microbiome_d_icd_items p WHERE p.long_title = 'insurance plan' ) AND o.valuenum IS NOT NULL ORDER BY o.charttime DESC ) AS s WHERE s.chartkey = t.chartkey ) ) WHERE d.chartkey IN ( SELECT t.chartkey FROM ( SELECT o.chartkey, o.row_id FROM microbiome_labevents o WHERE o.itemid IN ( SELECT p.itemid FROM microbiome_d_icd_items p WHERE p.long_title = 'insurance plan' ) AND o.valuenum IS NOT NULL ORDER BY o.charttime DESC ) AS t WHERE t.row_id IN ( SELECT MAX(s.row_id) FROM ( SELECT o.chartkey,",[{'insurance': 'Medicaid'}],False,0.0,0.0005297660827636719,0,"near ""WHER"": syntax error",,,
e85f97540e562568f8795422,How many patients were treated with endoscopic control of gastric or duodenal bleeding in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic control of gastric or duodenal bleeding' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'endoscopic control of gastric or duodenal bleeding' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,False,0.0,0.0009229183197021484,0,no such table: procedures,,,
e96cf491a6710c896774de33,How many people died after being diagnosed with long term (current) use of opiate analgesic during the same month during the last year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of opiate analgesic' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-1 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE datetime(T2.charttime,'start of month') = datetime(T3.dod,'start of month')","SELECT COUNT( DISTINCT d_icd_procedures.chart_idx ) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_icditems.icd_code FROM d_icd_icditems WHERE d_icd_icditems.long_title = 'long term (current) use of opiate analgesic' ) AND d_icd_procedures.chart_idx IN ( SELECT d_icustays.chart_idx FROM d_icustays WHERE datetime(d_icustays.outtime,'start of year') = datetime(current_time,'start of year','-1 year') ) AND d_icd_procedures.chart_idx IN ( SELECT d_labitems.chart_idx FROM d_labitems WHERE d_labitems.itemid IN ( SELECT procedures_icd.items_from_id FROM procedures_icd WHERE procedures_icd.procedures_icd_to = ( SELECT procedures_icd.to_id FROM procedures_icd WHERE procedures_icd.from_id = ( SELECT d_icd_icditems.to_id FROM d_icd_icditems WHERE d_icd_icditems.long_title = 'long term (current) use of opiate analgesic' ) ) ) ) AND datetime(d_icd_procedures.charttime) >= datetime(current_time,'start of year','-1 year') AND datetime(d",,False,0.0,0.0006074905395507812,0,incomplete input,,,
fde016b31923066cd34bb168,What was patient 10022281's first output time of foley on 06/23/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-06-23' ORDER BY outputevents.charttime ASC LIMIT 1","SELECT d1.charttime FROM labevents d1 WHERE d1.itemid IN ( SELECT d2.itemid FROM labitems d2 WHERE d2.label = 'foley' ) AND d1.hadm_id IN ( SELECT d3.hadm_id FROM patients d3 WHERE d3.age >= 0 AND d3.age < 100 AND d3.gender = 'male' AND d3.dod IS NULL AND d3.spec_type IS NULL AND d3.cancer_type IS NULL AND d3.cancer_type_desc IS NULL AND d3.cancer_type_icd IS NULL AND d3.icustay_id IS NOT NULL ) AND d1.valuenum IS NOT NULL AND strftime('%Y-%m-%d',d1.charttime) = '2100-06-23' ORDER BY d1.charttime ASC LIMIT 1",[],False,0.0,0.001028299331665039,0,no such table: labitems,,,
d39e6cca12842e2e3d53b7cd,What was the first measurement of patient 10013049's height since 25 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-25 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT d.valuenum FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = 'Z13.6' ) AND d.charttime >= datetime(current_time,'-25 month') ORDER BY d.charttime ASC LIMIT 1",[],False,0.0,0.000982522964477539,0,no such column: p.itemid,,,
b51508dd79305473d5dbaf7c,List the top three most frequent lab tests that patients were given in the same hospital visit after being diagnosed with dysphonia in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphonia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_labitems.itemname FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, dysphonia.charttime, admissions.dischtime, admissions.admittime, admissions.age, admissions.admission_location, admissions.admission_type, admissions.admission_source, admissions.discharge_location FROM dysphonia JOIN admissions ON dysphonia.subject_id = admissions.subject_id WHERE strftime('%Y',dysphonia.charttime) = '2100' AND admissions.dischtime IS NOT NULL AND datetime(dysphonia.charttime) BETWEEN admissions.admittime AND admissions.dischtime ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.dischtime, admissions.admittime, admissions.age, admissions.admission_location, admissions.admission_type, admissions.admission_source, admissions.discharge_location FROM labevents JOIN admissions ON labevents.subject_id = admissions.subject_id WHERE strftime('%Y',labevents.charttime) = '2100' AND admissions.dischtime IS NOT NULL AND datetime(labevents.charttime) BETWEEN admissions.admittime AND admissions",,False,0.0,0.0005650520324707031,0,incomplete input,,,
20db068481b9b06cc4340c25,What was patient 10018081's first procedure time since 1 year ago?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY procedures_icd.charttime ASC LIMIT 1",SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 1 AND admissions.gender = 'male' AND admissions.charttime >= current_time - interval '1 year' ) AND procedures.label = 'first' AND procedures.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 1 AND admissions.gender = 'male' AND admissions.charttime >= current_time - interval '1 year' AND admissions.subject_id = 10018081 ) ORDER BY procedures.starttime ASC LIMIT 1,,False,0.0,0.0006473064422607422,0,"near ""'1 year'"": syntax error",,,
568a32b005438f0d65d4f758,When did patient 10020786 receive the last magnesium test in their last hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedure_icd.itemid FROM procedure_icd WHERE procedure_icd.long_title = 'hospital encounter' ) AND labevents.valueuri = 'magnesium' AND labevents.hadm_id IN ( SELECT transfers.out_hadm_id FROM transfers WHERE transfers.in_hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT admissions.age FROM admissions WHERE admissions.pid = 10020786 AND admissions.admission_location = 'hospital' ORDER BY admissions.admittime DESC LIMIT 1 ) ) ORDER BY transfers.charttime DESC LIMIT 1 ),[],False,0.0,0.0005025863647460938,0,"unrecognized token: ""'hosp""",,,
304589d2a4159d23de6243b4,When was the last mrsa screen microbiology test given to patient 10015272 in the last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = microbiologyevents.chartevents_row_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = microbiologyevents.chartevents_row_id ) AND admissions.admission_location = 'emergency room' ) AND microbiologyevents.chartevents_row_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = microbiologyevents.chartevents_row_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = microbiologyevents.chartevents_row_id ) AND admissions.admission_location = 'emergency room' ) ORDER BY chartevents.charttime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],False,0.0,0.00098419189453125,0,"near ""A"": syntax error",,,
ee759ac11ca738371bf48a9c,"Among patients in their 30s since 2100, what are the top three prescribed drugs?","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT d.drug FROM   (   SELECT   u1.age, d.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiomic.staging_prescriptions AS u0   JOIN   microbiomic.d_icd_procedures AS u1   ON   u0.age = u1.age   WHERE   u0.age BETWEEN 30 AND 39   AND   strftime('%Y',u0.starttime) >= '2100'   GROUP  BY   u0.age, d.drug ) AS d   WHERE   d.C1 <= 3",,False,0.0,0.0009818077087402344,0,no such table: microbiomic.staging_prescriptions,,,
6b48b47dea05709d8dddd909,Was the calculated total co2 level of patient 10038933 last measured on the first hospital visit less than the second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.gender = 'male' AND admissions.age >= 50 ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'calculated total co2' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 0 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.gender = 'male' AND admissions.age >= 50 ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'calculated total co2' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",False,0.0,0.0006437301635742188,0,incomplete input,,,
9eda5afbe00ed4d5f058ec11,What was the last time patient 10037975 got the stool microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND microbiologyevents.spec_type_desc = 'stool' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'stool microbiology' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10037975 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10037975 ) ) ORDER BY labevents.charttime DESC LIMIT 1,[],False,0.0,0.0009922981262207031,0,no such table: procedures,,,
bc09da3606efe6b770f6ea1f,Tell me the number of times a open heart valvuloplasty of mitral valve without replacement took place in the previous year.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open heart valvuloplasty of mitral valve without replacement' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.key_icd = ( SELECT procedures_icd.key_icd FROM procedures_icd WHERE procedures_icd.icd_desc = 'open heart valvuloplasty of mitral valve without replacement' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,False,0.0,0.00096893310546875,0,no such column: procedures_icd.key_icd,,,
883c4d0f0f9708f99cf278d8,"What was the last value of a lab test of calcium, urine in 12/this year for patient 10021487?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, urine' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime DESC LIMIT 1","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.gender = 'male' AND patients.d_icd_procedures = '13.99' AND patients.d_icd_diagnoses = 'i10' AND patients.d_icd_outcomes = 'z99.2' ) AND admissions.gender = 'male' AND admissions.age = ( SELECT patients.age FROM patients WHERE patients.gender = 'male' AND patients.d_icd_procedures = '13.99' AND patients.d_icd_diagnoses = 'i10' AND patients.d_icd_outcomes = 'z99.2' ) ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'calcium, urine' ) AND labevents.hadm_id = 10021487 AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.0006101131439208984,0,incomplete input,,,
8bad69864afaca5758a6aa37,Calculate the patients who received a serology/blood microbiology test since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'serology/blood' AND strftime('%Y',microbiologyevents.charttime) >= '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT labevents.subject_id FROM labevents WHERE labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'serology/blood microbiology' ) AND strftime('%Y',labevents.charttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009577274322509766,0,no such table: definition,,,
d7d78a96a2f14b1d1a909d88,"Compared to yesterday, what is new in the prescription of patient 10039831 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.currentrid FROM transfers WHERE transfers.prevrid IN ( SELECT admissions.row_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime >= datetime(current_time,'-1 day') AND admissions.gender = 'male' AND admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.currentrid FROM transfers WHERE transfers.prevrid IN ( SELECT procedures.row_id FROM procedures WHERE procedures.label = 'arterial blood gases' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime >= datetime(current_time,'-1 day') AND admissions.gender = 'male' AND admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.currentrid FROM transfers WHERE transfers.prevrid IN ( SELECT labevents.row_id FROM labevents WHERE labevents.valuenum = 100.0 AND labevents.itemid IN ( SELECT definition.itemid FROM definition WHERE definition.label = 'o2 saturation pulseoxymetry' ) )",[],False,0.0,0.0005161762237548828,0,incomplete input,,,
3c71f198ffca8a3ba108d583,What was the organism found in patient 10027602's first mini-bal microbiology test?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10027602 AND admissions.gender = 'male' ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mini-bal microbiology' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10027602 AND admissions.gender = 'male' ) ORDER BY procedures.charttime ASC LIMIT 1 ),[],False,0.0,0.0009908676147460938,0,no such table: procedures,,,
111dee20bbe14075c60dc939,What were the four most frequently performed lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_labitems.itemname FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",False,0.0,0.0009219646453857422,0,no such column: d_labitems.itemname,,,
c189cadcf09e3eb65ff5c31a,What are the three commonly ordered medications for patients aged 60 or above?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE age >= 60 GROUP BY drug ) AS T1 WHERE T1.C1 <= 3",,False,0.0,0.0008807182312011719,0,no such column: drug,,,
e0b69eb370890d55d0e2a032,What's the total amount of d5 1/2ns that patient 10038933 received on 09/26/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '09-26'","SELECT SUM(d_icd_procedures.charttime - d_icd_procedures.starttime) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_items.icd_code FROM d_icd_items WHERE d_icd_items.long_title = 'd5 1/2ns' ) AND d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = d_icd_procedures.charttime AND patients.gender = 'male' ) AND admissions.gender = 'male' AND admissions.year = 2100 ) AND datetime(d_icd_procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',d_icd_procedures.starttime) = '09-26' GROUP BY d_icd_procedures.hadm_id",[{'SUM(inputevents.totalamount)': None}],False,0.0,0.001447916030883789,0,no such table: d_icd_items,,,
0e9be6448c82613884bebdf5,"So, what was the maximum 25-oh vitamin d value of patient 10029484 since 11/2100?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '25-oh vitamin d' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-11'","SELECT MAX laboratoryevents.valuenum FROM laboratoryevents WHERE laboratoryevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 25 AND admissions.gender = 'male' AND admissions.ethnicity = 'other' ) AND laboratoryevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = '25-oh vitamin d' ) AND laboratoryevents.hadm_id = 10029484 AND strftime('%Y-%m',laboratoryevents.charttime) >= '2100-11'",[{'MAX(labevents.valuenum)': None}],False,0.0,0.0013010501861572266,0,"near ""."": syntax error",,,
a63d852e13ffd03ce88b22d1,Tell me the percentile of urea nitrogen 22.0 among all patients of the same age as patient 10007928 in their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 22.0","SELECT DISTINCT T1.C1 FROM ( SELECT DISTINCT patients.age FROM patients WHERE patients.charttime IS NOT NULL AND patients.age IS NOT NULL AND patients.subject_id = 10007928 ) AS T0 JOIN ( SELECT patients.age, labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents JOIN patients ON labevents.subject_id = patients.subject_id WHERE labevents.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.label = 'urea nitrogen' ) AND patients.age IS NOT NULL AND patients.charttime IS NOT NULL ) AS T1 ON T0.age = T1.age WHERE T1.valuenum = 22.0",,False,0.0,0.0006194114685058594,0,incomplete input,,,
51978c2653bcfbd2cc8c5eae,"How many people received a introduction of nutritional substance into upper gi, via natural or artificial opening procedure within the same month after they had been diagnosed with postprocedural pneumothorax since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural pneumothorax' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.year >= 2100 AND admissions.dischtime IS NOT NULL EXCEPT SELECT T1.count FROM ( SELECT COUNT( DISTINCT admissions1.subject_id ) AS count FROM admissions AS admissions1 WHERE admissions1.year >= 2100 AND admissions1.dischtime IS NOT NULL AND admissions1.chartevents_id IN ( SELECT procedures.chartevents_id FROM procedures WHERE procedures.label = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) GROUP BY admissions1.subject_id ) AS T1 JOIN ( SELECT COUNT( DISTINCT admissions2.subject_id ) AS count FROM admissions AS admissions2 WHERE admissions2.year >= 2100 AND admissions2.dischtime IS NOT NULL AND admissions2.chartevents_id IN ( SELECT procedures2.chartevents_id FROM procedures AS procedures2 WHERE procedures2.label = 'postprocedural pneumothorax' ) GROUP BY admissions2.subject_id ) AS T2 ON T1.count = T2.count WHERE T1.month = T2.month AND T1.year = T2.year",,False,0.0,0.0005784034729003906,0,"unrecognized token: ""'introduction of nutritional substance into upper gi, via natural or arti""",,,
84b9e35f62f23089ad08f03e,How much of a difference is there in patient 10035185's mean blood pressure last measured on the first ICU visit compared to the second to last value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT labitems.valuenum FROM labitems WHERE labitems.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND labitems.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'arterial blood pressure mean' ) ORDER BY labitems.charttime ASC LIMIT 1 OFFSET 0 ) - ( SELECT labitems.valuenum FROM labitems WHERE labitems.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND labitems.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'arterial blood pressure mean' ) ORDER BY labitems.charttime ASC LIMIT 1 OFFSET -2 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",False,0.0,0.0005900859832763672,0,incomplete input,,,
a89804f008cd45087c9507d1,What treatment did patient 10039997 undergo last since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY procedures_icd.charttime DESC LIMIT 1 )","SELECT procedures.drug FROM procedures WHERE procedures.subject_id = 10039997 AND datetime(procedures.starttime) >= datetime(current_time,'-1 year') ORDER BY procedures.starttime DESC LIMIT 1",,False,0.0,0.0011026859283447266,0,no such table: procedures,,,
15a83f8dbbf6d2243721a87b,"How many patients underwent single internal mammary-coronary artery bypass during the same month after the diagnosis with arthropathy, unspecified, lower leg, in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'arthropathy, unspecified, lower leg' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study a JOIN microbiome_study b ON a.subject_id = b.subject_id WHERE a.spec_type = 'stool' AND b.spec_type = 'stool' AND a.test_time < b.test_time AND datetime(a.test_time,'start of month') = datetime(b.test_time,'start of month') AND a.test_name = 'single internal mammary-coronary artery bypass' AND b.test_name = 'diagnosis with arthropathy, unspecified, lower leg' AND strftime('%Y',a.test_time) = '2100'",,False,0.0,0.0011034011840820312,0,no such table: microbiome_study,,,
e57e3f80e3cc0a3b1a3c509c,How many patients in 2100 underwent radical excision of other lymph nodes within the same hospital visit after reopening of recent thoracotomy site?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reopening of recent thoracotomy site' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'radical excision of other lymph nodes' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study a JOIN ( SELECT b.subject_id, b.charttime FROM microbiome_study b WHERE b.spec_type_desc = 'reopening of recent thoracotomy site' AND strftime('%Y',b.charttime) = '2100' ) AS tmp1 ON a.subject_id = tmp1.subject_id JOIN ( SELECT c.subject_id, c.charttime FROM microbiome_study c WHERE c.spec_type_desc = 'radical excision of other lymph nodes' AND strftime('%Y',c.charttime) = '2100' ) AS tmp2 ON a.subject_id = tmp2.subject_id WHERE tmp1.charttime < tmp2.charttime AND a.visit_id = tmp1.visit_id",,False,0.0,0.0011348724365234375,0,no such table: microbiome_study,,,
24612cf5da1e8c7c6a9fca8f,Was the SaO2 of patient 10021487 ever greater than 97.0 on 12/12/2100?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 97.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-12'",SELECT COUNT(*)>0 FROM d_icustays JOIN d_labitems ON d_icustays.icustay_id = d_labitems.icustay_id WHERE d_icustays.age >= 40 AND d_labitems.itemid IN ( SELECT itemid FROM labitems WHERE labitems.label = 'o2 saturation pulseoxymetry' ) AND d_labitems.valuenum > 97.0 AND d_icustays.charttime >= '2100-12-12 00:00:00' AND d_icustays.charttime < '2100-12-13 00:00:00' AND d_icustays.subject_id = 10021487,[{'COUNT(*)>0': 0}],False,0.0,0.0012412071228027344,0,no such table: d_icustays,,,
dbc270289021529e6623ca58,How many patients were treated with closed [percutaneous] [needle] biopsy of kidney since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )",percutaneous,,False,0.0,0.0004646778106689453,0,"near ""percutaneous"": syntax error",,,
1252ececdb40065ab2ab716c,"For patients who had bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach, what were the most frequent four microbiology tests carried out within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T1.test_name FROM ( SELECT procedures.drug FROM procedures WHERE procedures.label = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' ) AS T2 JOIN ( SELECT patients.chartkey FROM patients WHERE patients.age >= 18 ) AS T3 ON T2.chartkey = T3.chartkey JOIN ( SELECT labevents.chartkey, labevents.test_name FROM labevents WHERE labevents.test_name IN ( 'blood culture', 'blood culture, anaerobic', 'blood culture, aerobic', 'blood culture, mycoplasma' ) AND datetime(labevents.charttime) BETWEEN datetime(T2.starttime) AND datetime(T2.starttime,'+2 month') ) AS T1 ON T3.chartkey = T1.chartkey GROUP BY T1.test_name ORDER BY COUNT(*) DESC LIMIT 4",,False,0.0,0.0007290840148925781,0,"unrecognized token: ""'blood cult""",,,
c5d46b43685ecc76f23dd1be,Pull up the IDs of patients who were diagnosed with chronic systolic heart failure in this year.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic systolic heart failure' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT patients.subject_id FROM patients WHERE patients.subject_id IN ( SELECT d_icd_procedures.subject_id FROM d_icd_procedures WHERE d_icd_procedures.icd_code = 'I50.22' AND datetime(d_icd_procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,False,0.0,0.0011172294616699219,0,no such column: d_icd_procedures.subject_id,,,
6726244ef1bd924f703f788d,What was the name of the drug which was prescribed to patient 10018501 within the same hospital visit after having received alcohol detoxification in 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedures.charttime, procedures.itemid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 AND admissions.gender = 'male' AND admissions.age >= 18 ) AND procedures.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'alcohol detoxification' ) AND strftime('%Y-%m',procedures.charttime) = '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 AND admissions.gender = 'male' AND admissions.age >= 18 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND T1.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'alcohol detoxification' )",,False,0.0,0.0007207393646240234,0,incomplete input,,,
1baa3b9b6dd6b0bd2c74ac95,How much is the total hospital cost of patient 10020187 during the stay in 2100?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND strftime('%Y',cost.chargetime) = '2100'","SELECT SUM(hospital_cost) FROM hospital_cost_table WHERE subject_id = 10020187 AND strftime('%Y',hospital_cost_table.charttime) = '2100'",,False,0.0,0.0010876655578613281,0,no such table: hospital_cost_table,,,
2b5707d23faf1d54bc3688c3,"On their first hospital visit, what was the age of patient 10022880?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT DISTINCT patients.age FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND chartevents.valuenum IS NOT NULL ) AND patients.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 10023100 ) AND chartevents.valuenum IS NOT NULL ) AND patients.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 10005863 ) AND chartevents.valuenum IS NOT NULL ) AND patients.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 10006035 ) AND chartevents.valuenum IS NOT NULL ) AND patients.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 10006012 ) AND chartevents.valuenum IS NOT NULL ) AND patients.chartevents_id IN,,False,0.0,0.0005266666412353516,0,incomplete input,,,
6affdda52b5c91cdefb3ac90,Is patient 10027602's free calcium second measured on the last hospital visit less than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'free calcium' ) ORDER BY labresults.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'free calcium' ) ORDER BY labresults.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0006654262542724609,0,"unrecognized token: ""'free """,,,
71fb7280916537b48dea629f,How many times was patient 10020786 admitted to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10020786 AND strftime('%Y',admissions.admittime) >= '2100'",SELECT COUNT(*) FROM microbiologyevents WHERE patientid = 10020786 AND charttime >= '2100-01-01',[{'COUNT( DISTINCT admissions.hadm_id )': 1}],False,0.0,0.0009632110595703125,0,no such column: patientid,,,
59b3e090a55110929fc25079,Provide me with the five most common diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT t1.icd_code FROM ( SELECT icd_diagnoses_icd_procedures.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM icd_diagnoses_icd_procedures GROUP BY icd_diagnoses_icd_procedures.icd_code ) AS t1 WHERE t1.C1 <= 5 )","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Esophageal reflux'}, {'long_title': 'Hyperlipidemia, unspecified'}, {'long_title': 'Essential (primary) hypertension'}]",False,0.0,0.0009167194366455078,0,no such table: icd_diagnoses_icd_procedures,,,
4e79db3380f81126bc756ee5,What is the difference between mchc second measured on the last hospital visit compared to the first value measured on the last hospital visit for patient 10007928?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT mchc FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1 ) - ( SELECT mchc FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0005881786346435547,0,incomplete input,,,
5706937d471c979d44b7c441,Calculate the number of patients who were prescribed senna.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'senna' ),SELECT COUNT( DISTINCT dr.stay_id ) FROM microbiologyevents dr WHERE dr.spec_type_desc = 'senna',[{'COUNT( DISTINCT admissions.subject_id )': 29}],False,0.0,0.0008990764617919922,0,no such column: dr.stay_id,,,
8389d7126b22d44dfa24365b,Has patient 10037928 received a diagnosis in 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM diagnosis WHERE patient_id = 10037928 AND strftime('%Y',diagnosis.charttime) = '2100'",,False,0.0,0.0009300708770751953,0,no such table: diagnosis,,,
5af08ca2546f4bf6b47b14b0,Calculate the number of patients who stayed in the med/surg this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.admission_location = 'med/surg' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],True,0.03125262260437012,0.031853437423706055,1,,[{'COUNT( DISTINCT patients.subject_id )': 0}],['COUNT( DISTINCT patients.subject_id )'],"[{""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH patients USING COVERING INDEX sqlite_autoindex_patients_2 (subject_id=?)""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
0b01e88a1ff2627ccad33628,What is the number of times patient 10014729 visited the hospital in 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10014729 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(*) FROM microbiologyevents WHERE patientid = 10014729 AND stromy = 'hospital' AND strftime('%Y',datetime) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],False,0.0,0.0010519027709960938,0,no such column: patientid,,,
20c3ddd36c65c44890c3f3e5,What was the name of the specimen test that patient 10021666 was given for the first time since 03/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT procedures.drug FROM procedures WHERE procedures.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' ) AND procedures.drug = 'diltiazem' AND strftime('%Y-%m',procedures.starttime) >= '2100-03' ORDER BY procedures.starttime ASC LIMIT 1",[{'spec_type_desc': 'MRSA SCREEN'}],False,0.0,0.0009398460388183594,0,no such table: procedures,,,
7edc30d3b6fa3b7308ebcd4a,How many medications were ordered for patient 10021118 since 10/2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'",SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10021118 AND charttime >= '2100-10-01',[{'COUNT(*)': 107}],False,0.0,0.0010225772857666016,0,no such column: patient_id,,,
a999623358b249c2ff668390,How many current patients are there aged 60 or above?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT( DISTINCT d_icustays.charttime ) FROM d_icustays WHERE d_icustays.age >= 60 AND d_icustays.dischtime IS NULL,,False,0.0,0.0013053417205810547,0,no such table: d_icustays,,,
8a081d0fa8a2b464096d8a00,What is the total or cell saver intake amount that patient 10009628 received on 10/02/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '10-02'","SELECT SUM(procedures_icd.intake) FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' AND admissions.year = this year - 100 FROM admissions WHERE admissions.subject_id = 10009628 ) AND procedures_icd.label = 'or cell saver' AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',procedures_icd.charttime) = '10-02'",[{'SUM(inputevents.totalamount)': None}],False,0.0,0.00045943260192871094,0,"near ""year"": syntax error",,,
694ef79b1e8ab1b548efa5b3,Has patient 10018423 received any lab testing in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y',labevents.charttime) = '2100'",SELECT COUNT(*)>0 FROM labevents WHERE labevents.chartkey IN ( SELECT patients.chartkey FROM patients WHERE patients.age >= 2100 AND patients.subject_id = 10018423 ),[{'COUNT(*)>0': 0}],False,0.0,0.0008947849273681641,0,no such column: patients.chartkey,,,
d69a4b8b51374de9e093dde2,How many hours have passed since patient 10004733 stayed in the careunit medicine on this hospital visit for the first time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1","SELECT 1 * ( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND transfers.patient_id = 10004733 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )",[],False,0.0,0.0009593963623046875,0,no such column: transfers.patient_id,,,
ce4170ef70617d0f660eb8c8,Can you show me the top four most frequent lab tests given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lab tests' ORDER BY COUNT(chartevents.charttime) DESC LIMIT 4,"[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",False,0.0,0.0029544830322265625,0,no such column: chartevents.charttime,,,
5b35d8420b2779eaf3c7e3ea,List the top four most frequent diagnoses that patients received within 2 months after previously being diagnosed with other candidiasis of other specified sites since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other candidiasis of other specified sites' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT subject_id, had_icd_diagnoses.charttime FROM had_icd_diagnoses WHERE had_icd_diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other candidiasis of other specified sites' ) AND datetime(had_icd_diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS t1 JOIN ( SELECT subject_id, had_icd_diagnoses.icd_code, had_icd_diagnoses.charttime FROM had_icd_diagnoses WHERE had_icd_diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other candidiasis of other specified sites' ) AND datetime(had_icd_diagnoses.charttime) >= datetime(current_time,'-1 year')",,False,0.0,0.0005657672882080078,0,incomplete input,,,
a5356c6c205e9f088964bb9a,Has patient 10006580 received any medication?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ),"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT patients.chartevents_icustay_id FROM patients WHERE patients.age = 100 AND patients.gender = 'male' AND patients.admittime >= '2100-01-01' AND patients.d_icd_procedures_icd_code IS NOT NULL AND patients.chartevents_icustay_id IS NOT NULL AND patients.chartevents_icustay_id IN ( SELECT min(tmp1.icustay_id) FROM ( SELECT admissions.icustay_id, admissions.age, admissions.gender FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.admittime >= '2100-01-01' AND admissions.admittime IS NOT NULL AND admissions.admittime < datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC ) AS tmp1 WHERE tmp1.age IS NOT NULL ) ) AND prescriptions.drug = 'medication' AND prescriptions.chartevents_icustay_id IN ( SELECT patients.chartevents_icustay_id FROM patients WHERE patients.age = 100 AND patients.gender = 'male' AND patients.admittime >= '2100-01-01' AND patients.d_icd_procedures_icd_code IS NOT NULL AND patients.chartevents_ic",[{'COUNT(*)>0': 1}],False,0.0,0.0006425380706787109,0,incomplete input,,,
06b14b6b3b8637569dd435d9,Show me the top five diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY T2.C2 ASC ) AS C3 FROM ( SELECT T1.icd_code, AVG(C1) AS C2 FROM ( SELECT patients.d_icd_diagnoses_icd_code, ( CASE WHEN patients.dischtime IS NOT NULL AND patients.outtime IS NOT NULL THEN datetime(patients.outtime) - datetime(patients.dischtime) ELSE 0 END ) / 86400.0 FROM patients WHERE patients.age BETWEEN 50 AND 60 AND strftime('%Y',patients.admittime) = '2100' GROUP BY patients.d_icd_diagnoses_icd_code ) AS T1 JOIN ( SELECT patients.d_icd_diagnoses_icd_code, AVG(C1) AS C1 FROM ( SELECT patients.d_icd_diagnoses_icd_code, ( CASE WHEN patients.dischtime IS NOT NULL AND patients.outtime IS NOT NULL THEN datetime(patients.outtime) - datetime(patients.dischtime) ELSE 0 END ) / 86400.0 FROM patients WHERE",,False,0.0,0.0010380744934082031,0,incomplete input,,,
2574356f8e9c787e824fdb9b,Skullcandy bluetooth headphones,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'skullcandy bluetooth headphones',,True,0.07474279403686523,0.07642459869384766,1,,[{'COUNT(*)': 0}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}]"
6d23077db7dbc8321431bf64,How many days have passed since the patient 10004733 was admitted to the hospital?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.chartkey IN ( SELECT procedures.chartkey FROM procedures WHERE procedures.itemid IN ( SELECT definitions.linksto FROM definitions WHERE definitions.label = 'dischtime' ) ) AND transfers.destination = 'hospital' AND transfers.attending = ( SELECT admissions.attending FROM admissions WHERE admissions.chartkey IN ( SELECT procedures.chartkey FROM procedures WHERE procedures.itemid IN ( SELECT definitions.linksto FROM definitions WHERE definitions.label = 'dischtime' ) ) ) AND admissions.age = ( SELECT procedures.age FROM procedures WHERE procedures.itemid IN ( SELECT definitions.linksto FROM definitions WHERE definitions.label = 'dischtime' ) ) AND admissions.gender = ( SELECT procedures.gender FROM procedures WHERE procedures.itemid IN ( SELECT definitions.linksto FROM definitions WHERE definitions.label = 'dischtime' ) ) AND admissions.admittime IS NOT NULL AND admissions.dischtime IS NOT NULL AND admissions.age = 10004733 ORDER BY admissions.admittime ASC LIMIT 1",[],False,0.0,0.0011641979217529297,0,incomplete input,,,
68e2938f96286a982888a1f6,"Which was the last care unit patient 10007928 was in during their last hospital visit, as per the transfer record?",SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1,"SELECT T1.careunit FROM ( SELECT T2.careunit, DENSE_RANK() OVER ( ORDER BY T2.intime DESC ) AS C1 FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT admissions.age FROM admissions WHERE admissions.pid = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 JOIN ( SELECT * FROM careevents WHERE careevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT admissions.age FROM admissions WHERE admissions.pid = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.spec_type_desc = 'blood culture' AND T1.valuenum IS NOT NULL AND T1.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.label = 'blood culture' ) AND T1.hadm_id = 10007928 AND T2.careunit IS NOT NULL ORDER BY T2.intime DESC ) AS T1 WHERE T1.C1 =",[{'careunit': 'Med/Surg'}],False,0.0,0.0005362033843994141,0,incomplete input,,,
7f71c9d84ae065b57a659660,How many current patients are there aged 40s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age BETWEEN 40 AND 49 AND patients.dischtime IS NULL,,False,0.0,0.0008916854858398438,0,no such column: patients.age,,,
0d71c66d0ead111e4df731dd,How much is the maximum total hospital bill that includes personal history of malignant neoplasm of large intestine since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MAX(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.key = ( SELECT patients.key FROM patients WHERE patients.age >= 2100 ) AND procedures.label = 'personal history of malignant neoplasm of large intestine' GROUP BY procedures.key ) AS T1,,False,0.0,0.0008242130279541016,0,no such table: procedures,,,
7f07c59357750ac2b84e5221,"What are the five frequently taken specimens for patients that received extirpation of matter from lung lingula, via natural or artificial opening endoscopic previously within 2 months?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from lung lingula, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT patients.subject_id, procedures.dr_time FROM procedures WHERE procedures.label = 'extirpation of matter from lung lingula, via natural or artificial opening endoscopic' AND procedures.age BETWEEN 30 AND 40 AND procedures.gender = 'male' ) AS T2 JOIN ( SELECT patients.subject_id, labevents.itemid, labevents.valuenum, labevents.charttime FROM labevents JOIN patients ON labevents.hadm_id = patients.hadm_id WHERE labevents.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.label = 'extirpation of matter from lung lingula, via natural or artificial opening endoscopic' AND procedures.age BETWEEN 30 AND 40 AND procedures.gender = 'male' ) ) AS T1 ON T2.subject_id = T1.subject_id WHERE T1.charttime BETWEEN T2.dr_time AND datetime(T2.dr_time,'+2 month') ORDER BY DESC LIMIT 5",,False,0.0,0.0006031990051269531,0,incomplete input,,,
105c5b90ad1c402ff786e8bc,What's the cost of the drug known as ferrous sulfate (liquid)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)' ),SELECT DISTINCT cost FROM prescription_cost WHERE drug = 'ferrous sulfate (liquid)',,False,0.0,0.0009906291961669922,0,no such table: prescription_cost,,,
60f1ca714f709dd6094e453e,What was the insurance that patient 10015931 had during the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,"SELECT T1.insurance FROM ( SELECT admissions.patient_id, admissions.charttime, admissions.dischtime FROM admissions WHERE admissions.patient_id = 10015931 AND admissions.admission_location = 'hospital' ) AS T2 JOIN ( SELECT patients.insurance, patients.age, patients.gender, patients.d_icd_procedures_icd_code, patients.d_icd_diagnoses_icd_code, patients.charttime FROM patients WHERE patients.patient_id = 10015931 ) AS T1 ON T2.patient_id = T1.patient_id WHERE datetime(T2.charttime) >= datetime(T1.charttime) AND ( T2.dischtime IS NOT NULL ) ORDER BY T2.charttime ASC LIMIT 1",[{'insurance': 'Medicare'}],False,0.0,0.0005619525909423828,0,incomplete input,,,
1252e7fd85be60431814be4f,"What is the cost for a procedure of introduction of other therapeutic substance into peripheral artery, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) )","SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach'",,False,0.0,0.0011091232299804688,0,no such table: procedures,,,
89a0d1e183a1c2a585f69c0d,When did patient 10016742 last receive a diagnosis of non-st elevation (nstemi) myocardial infarction on the first hospital stay?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'non-st elevation (nstemi) myocardial infarction' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1,SELECT chartevents.charttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.row_id = 10016742 ) AND admissions.gender = ( SELECT DISTINCT patients.gender FROM patients WHERE patients.row_id = 10016742 ) AND admissions.admission_location = 'emergency room' ) AND chartevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.label = 'non-st elevation (nstemi) myocardial infarction' AND definitions.linksto = 'diagnoses_icd' ) ORDER BY chartevents.charttime DESC LIMIT 1,,False,0.0,0.0009357929229736328,0,"unrecognized token: ""'non-st elevation (""",,,
0f76c11ee2ae038677e63102,"How many patients received a osmolality, measured test last year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, measured' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'osmolality, measured' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0012216567993164062,0,no such table: definition,,,
e7d00371c9b3a702661b3704,Did patient 10040025 have any kind of diagnosis last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,False,0.0,0.0010302066802978516,0,no such column: patients.hadm_id,,,
681c6fc772c7eda308578ae6,What are the three most frequent drugs prescribed to female patients with an age of 20s within the same month after they were diagnosed with unspecified acquired hypothyroidism?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified acquired hypothyroidism' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age BETWEEN 20 AND 29 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT d.drug FROM   (   SELECT   t1.subject_id   FROM   labevents t1   WHERE   t1.valuenum = 20   AND   t1.spec_type_desc = 'blood'   AND   datetime(t1.charttime,'start of year') = datetime(current_time,'start of year','-0 year')   GROUP BY   t1.subject_id   HAVING   cnt( DISTINCT strftime('%J',t1.charttime) ) >= 2 ) AS t2   JOIN   (   SELECT   t1.subject_id   FROM   labevents t1   WHERE   t1.valuenum = 20   AND   t1.spec_type_desc = 'blood'   AND   datetime(t1.charttime,'start of year') = datetime(current_time,'start of year','-0 year')   GROUP BY   t1.subject_id   HAVING   cnt( DISTINCT strftime('%J',t1.charttime) ) >= 2 ) AS t3   ON t2.subject_id = t3.subject_id   WHERE   datetime(t2.charttime,'start of year') = datetime(current_time,'start of year','-0 year')   AND   datetime(t3.charttime,'start of year') = datetime(current_time,'start of year",,False,0.0,0.0005152225494384766,0,incomplete input,,,
6cbfdc3d86436bf51ac20d19,Do you love being a research coordinator nurse?,,SELECT COUNT(*)> 0 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'research coordinator nurse',,True,0.07520294189453125,0.0765526294708252,1,,[{'COUNT(*)> 0': 0}],['COUNT(*)> 0'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}]"
9fc0ac6b29d8a361fd6e2512,How much does patient 10007058 change in SaO2 second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10007058 AND admissions.gender = 'male' ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'o2 saturation pulseoxymetry' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10007058 AND admissions.gender = 'male' ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'o2 saturation pulseoxymetry' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0006089210510253906,0,incomplete input,,,
09304caba4fd05450a56c2af,How much does a procedure called percutaneous abdominal drainage cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) ),SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'percutaneous abdominal drainage',,False,0.0,0.0010802745819091797,0,no such table: procedures,,,
aeb4b3e5ce8038a370e1e7c1,Count the number of patients who underwent a microbiological mini-bal test since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'mini-bal' AND strftime('%Y',microbiologyevents.charttime) >= '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'microbiological mini-bal' AND strftime('%Y',procedures.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0011432170867919922,0,no such table: procedures,,,
3813f972b07ceee5031bb452,Did patient 10021666 receive a diagnosis during their last hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*)>0 FROM diagnosis WHERE diagnosis.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hospital' AND transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT events.hadm_id FROM events WHERE events.event_type = 'admission' AND events.age IS NOT NULL AND events.charttime IS NOT NULL ORDER BY events.charttime ASC ) ORDER BY transfers.charttime DESC LIMIT 1 ) ) ORDER BY diagnosis.charttime DESC LIMIT 1,[{'COUNT(*)>0': 1}],False,0.0,0.0013947486877441406,0,no such table: diagnosis,,,
770cb760820f25921dc8ac4a,"How much does a thyroxine (t4), free lab test cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroxine (t4), free' ) )","SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'thyroxine (t4), free lab test'",,False,0.0,0.0014293193817138672,0,no such table: procedures,,,
f356b6267c56b07e1f3e3045,What was the last time that patient 10035185 had the minimum value of the systolic blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'systolic blood pressure' ) AND labevents.valuenum = ( SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'systolic blood pressure' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.pid = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,[],False,0.0,0.0005311965942382812,0,incomplete input,,,
5a67eba88dd963170a026d15,What was the dose of glipizide xl patient 10029484 was prescribed?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.drug = 'glipizide xl',SELECT d.value FROM prescriptions d WHERE d.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10029484 ) AND d.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'glipizide xl' ),[{'SUM(prescriptions.dose_val_rx)': None}],False,0.0,0.0009050369262695312,0,no such table: procedures,,,
69efee73f187a30d6812ae88,Find any images used for educating patients about their condition or treatment.,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'educate patients about their condition or treatment',,True,0.07837867736816406,0.07960319519042969,1,,[{'COUNT(*)': 0}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}]"
d04f4cfbfef7a7f69d8969eb,"What are the three most commonly prescribed drugs for patients who were diagnosed with personal history of tobacco use previously in the same month, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT d.drug FROM   ( SELECT   t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM     ( SELECT    u1.subject_id, l1.charttime   FROM      microbiologyevents AS u1   WHERE     u1.spec_type_desc = 'personal history of tobacco use'   AND       datetime(u1.charttime) >= datetime(current_time,'-1 year') ) AS t1   JOIN      ( SELECT    u2.subject_id, l2.drug, l2.charttime   FROM      d_icd_procedures AS u2   WHERE     u2.long_title = 'prescribe drugs'   AND       datetime(u2.charttime) >= datetime(current_time,'-1 year') ) AS l1   ON t1.subject_id = l1.subject_id   WHERE t1.charttime < l1.charttime   AND datetime(t1.charttime,'start of month') = datetime(l1.charttime,'start of month')   GROUP BY t1.drug ) AS d   WHERE d.C1 <= 3",,False,0.0,0.0005521774291992188,0,incomplete input,,,
14c735141eaad27a37dfacce,Has any lab tests occurred for patient 10026406 since 01/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'",SELECT COUNT(*)>0 FROM labevents WHERE labevents.charttime >= '2100-01-01' AND labevents.itemid IN ( SELECT labtests.itemid FROM labtests WHERE labtests.label = 'lab tests' ) AND labevents.charttime IS NOT NULL AND labevents.valuenum IS NOT NULL AND labevents.charttime >= transfers.intime AND labevents.hadm_id = transfers.hadm_id AND transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.charttime >= '2100-01-01' AND labevents.itemid IN ( SELECT labtests.itemid FROM labtests WHERE labtests.label = 'lab tests' ) AND labevents.charttime IS NOT NULL AND labevents.valuenum IS NOT NULL ) ORDER BY transfers.intime ASC LIMIT 1 ) AND labevents.hadm_id = 10026406,[{'COUNT(*)>0': 1}],False,0.0,0.0005013942718505859,0,incomplete input,,,
b4dc074ecd304bf634371924,What are the five most frequently prescribed medications for patients in their 40s since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT d.drug FROM   ( SELECT   t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM     ( SELECT    u1.subject_id, l1.drug   FROM      labevents AS l1   WHERE     l1.valuenum IS NOT NULL   AND       l1.spec_type_desc = 'ph'   AND       l1.itemid IN      ( SELECT    d1.itemid   FROM      d_icd_items AS d1   WHERE     d1.long_title = 'ph'   )   GROUP BY u1.subject_id, l1.drug   HAVING     datetime(l1.charttime,'start of year') >= datetime(current_time,'start of year','-0 year')   ) AS t1   WHERE     t1.drug IS NOT NULL   GROUP BY t1.drug   HAVING     datetime(t1.charttime,'start of year') >= datetime(current_time,'start of year','-0 year')   ) AS d   WHERE   d.c1 <= 5",,False,0.0,0.0005974769592285156,0,incomplete input,,,
612ad1a0d94b49abf371be2f,"How often was the bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach procedure carried out since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",SELECT COUNT(*) FROM procedure_icd WHERE procedure_icd.key = '2100' since 1 year ago,,False,0.0,0.00136566162109375,0,"near ""since"": syntax error",,,
facfb8f560238eb16739c85e,Did patient 10015860 receive a lymphocytes test on their first hospital visit?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.charttime IN ( SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'lymphocytes' ),[{'COUNT(*)>0': 0}],False,0.0,0.0007863044738769531,0,no such table: procedures,,,
4b91a35cb013448ab5730193,Was the average time of delay of appointments in the rheumatology department is,,SELECT AVG(T1.time) FROM ( SELECT P1.charttime - P2.charttime AS time FROM microbiologyevents P1 JOIN microbiologyevents P2 ON P1.hadm_id = P2.hadm_id WHERE P1.spec_type_desc = 'rheumatology' AND P2.spec_type_desc = 'appointment' ) AS T1,,True,0.0841372013092041,0.08565449714660645,1,,[{'AVG(T1.time)': None}],['AVG(T1.time)'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN P1""}, {""id"": 10, ""parent"": 0, ""notused"": 0, ""detail"": ""BLOOM FILTER ON P2 (spec_type_desc=? AND hadm_id=?)""}, {""id"": 23, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH P2 USING AUTOMATIC PARTIAL COVERING INDEX (spec_type_desc=? AND hadm_id=?)""}]"
bdd039b89d9bf57a1d3c4e49,"What are the three most common microbiology tests for people who were diagnosed with malignant neoplasm of lower third of esophagus earlier in the same hospital encounter, since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower third of esophagus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T1.spec_type_desc FROM ( SELECT T3.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents AS T0 JOIN d_icd_procedures ON T0.hcpcscid = D_icd_procedures.key_value WHERE D_icd_procedures.long_title = 'diagnosis of malignant neoplasm of lower third of esophagus' AND T0.charttime BETWEEN D_icd_procedures.starttime AND D_icd_procedures.endtime AND strftime('%Y',T0.charttime) >= '2100' GROUP BY T3.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",,False,0.0,0.0010612010955810547,0,no such column: T3.spec_type_desc,,,
b2e898b5d1ad3e826001b202,"In 03/this year, what organism was found in patient 10029291's last stool test?","SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '03' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT procedures.organism FROM procedures WHERE procedures.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 18 AND patients.gender = 'male' AND patients.last_name = 'smith' ORDER BY patients.admittime DESC LIMIT 1 ) AND procedures.label = 'stool microbiology' AND procedures.org_name = 'enterococcus faecalis' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures.charttime) = '03' ORDER BY procedures.charttime DESC LIMIT 1",[],False,0.0,0.0013213157653808594,0,no such table: procedures,,,
e1bef8005f669f8fa7a1e3bf,What are the most commonly prescribed drugs given to patient 10021312 twice?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 = 2","SELECT d.drug FROM   ( SELECT   prescriptions.drug,   COUNT(*) AS C1     FROM     prescriptions     WHERE     prescriptions.hadm_id IN ( SELECT     admissions.hadm_id     FROM     admissions     WHERE     admissions.age = ( SELECT     admissions.age     FROM     admissions     WHERE     admissions.pid = 10021312     ORDER BY     admissions.admittime ASC     LIMIT     1 ) )     GROUP BY   prescriptions.drug ) AS d     WHERE   d.C1 = ( SELECT   MAX(C1) FROM   ( SELECT   prescriptions.drug,   COUNT(*) AS C1     FROM     prescriptions     WHERE     prescriptions.hadm_id IN ( SELECT     admissions.hadm_id     FROM     admissions     WHERE     admissions.age = ( SELECT     admissions.age     FROM     admissions     WHERE     admissions.pid = 10021312     ORDER BY     admissions.admittime ASC     LIMIT     1 ) )     GROUP BY   prescriptions.drug ) AS d WHERE d.C1 = ( SELECT T1.C1 FROM ( SELECT COUNT(*) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.pid = 10021312 ORDER BY admissions.admittime ASC LIMIT 1 ) GROUP BY prescriptions.drug )","[{'drug': 'Acetylcysteine 20%'}, {'drug': 'Bisacodyl'}, {'drug': 'BusPIRone'}, {'drug': 'Dextrose 5%'}, {'drug': 'Docusate Sodium'}, {'drug': 'Escitalopram Oxalate'}, {'drug': 'Famotidine'}, {'drug': 'Gabapentin'}, {'drug': 'Heparin'}, {'drug': 'Ipratropium-Albuterol Neb'}, {'drug': 'MetRONIDAZOLE (FLagyl)'}, {'drug': 'Metoprolol Tartrate'}, {'drug': 'Morphine SR (MS Contin)'}, {'drug': 'Morphine Sulfate'}, {'drug': 'Nicotine Patch'}, {'drug': 'Senna'}]",False,0.0,0.0006415843963623047,0,incomplete input,,,
99499e3fc35e16828a79d7f6,"How many patients received omeprazole within 2 months after the confirmation of ""personal history of tobacco use"" in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'omeprazole' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.subject_id FROM chartevents WHERE chartevents.valuenum = 2100 AND chartevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'personal history of tobacco use' ) ) AND patients.chartevents_id IN ( SELECT chartevents.subject_id FROM chartevents WHERE chartevents.valuenum = 2100 AND chartevents.itemid IN ( SELECT prescriptions.itemid FROM prescriptions WHERE prescriptions.drug = 'omeprazole' ) AND datetime(prescriptions.starttime) BETWEEN datetime(chartevents.charttime) AND datetime(chartevents.charttime,'+2 month') )",,False,0.0,0.0005943775177001953,0,incomplete input,,,
2e3384d7ef9a76c0237df519,Tell me patient 10026354's first measured heart rate.,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT d.valuenum FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = 'heart rate' ) AND d.charttime >= ( SELECT m.intime FROM microbiologyevents m WHERE m.spec_type_desc = 'blood culture' AND m.hospital_id = 10026354 ORDER BY m.intime ASC LIMIT 1 ) ORDER BY d.charttime ASC LIMIT 1,[],False,0.0,0.001544952392578125,0,no such column: p.itemid,,,
2f8aa4c9687c9ee0880c3746,"Since 1 year ago, what are the top four most commonly taken specimens for patients within 2 months after the diagnosis of encounter for immunization?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for immunization' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for immunization' ) AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE datetime(procedures.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,False,0.0,0.0009741783142089844,0,incomplete input,,,
f195f5a0d57e12581afdc61c,When did patient 10004457 first get discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004457 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT hospital_discharges.charttime FROM hospital_discharges WHERE hospital_discharges.age = 10004457 ORDER BY hospital_discharges.charttime ASC LIMIT 1,[{'dischtime': '2140-09-18 12:40:00'}],False,0.0,0.0011219978332519531,0,no such table: hospital_discharges,,,
b710f2ea6d630a9c88a40fc2,What was the name of the prescription drug that patient 10017492 was prescribed last in 04/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.currentrid FROM transfers WHERE transfers.prevrid IN ( SELECT admissions.row_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime = current_time - interval '1' year AND admissions.gender = 'male' AND admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.currentrid FROM transfers WHERE transfers.prevrid IN ( SELECT admissions.row_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.los >= 1 ) ) ) ) ) ) ) ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1",[],False,0.0,0.0005795955657958984,0,"near ""'1'"": syntax error",,,
fd9b2daa83ce099cdf252c35,Has there been any procedure that patient 10022880 had in this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND chartevents.valuenum = 10022880 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,False,0.0,0.000982046127319336,0,no such table: definition,,,
84d4721f5e61842aa596dca2,"What is the relationship between temperature, pressure and volume of gas",,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name = 'staphylococcus aureus',,True,0.09187817573547363,0.09333515167236328,1,,[{'COUNT(*)': 0}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}]"
15266b6704cdb1f8cd452e63,How do care unit choices in icus affect patient outcomes?,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name = 'enterococcus faecium',,True,0.09465813636779785,0.09646797180175781,1,,[{'COUNT(*)': 1548}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}]"
515f28b68da1d15cb0208181,Please list the five most common procedures carried out since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.proc_desc FROM   ( SELECT   procedures_icd.chart_instance_id,   DENSE_RANK() OVER ( ORDER BY   COUNT(*) DESC ) AS c1   FROM   procedures_icd   WHERE   datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')   GROUP BY   procedures_icd.chart_instance_id ) AS t1 JOIN procedures_icd ON t1.chart_instance_id = procedures_icd.chart_instance_id JOIN d_icd_procedures d ON procedures_icd.key = d.key   WHERE   t1.c1 <= 5   GROUP BY   d.proc_desc   ORDER BY   COUNT(*) DESC LIMIT 5",,False,0.0,0.0016050338745117188,0,no such column: procedures_icd.chart_instance_id,,,
9a53c5a84a90577e106b30ec,"In the first hospital visit, what was patient 10016150's last procedure time?",SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime DESC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.age IS NOT NULL AND admissions.itemid IN ( SELECT DISTINCT prescriptions.itemid FROM prescriptions WHERE prescriptions.drug = 'patient 10016150' ) ) ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures.starttime DESC LIMIT 1,,False,0.0,0.0010848045349121094,0,no such table: procedures,,,
536ad0999a00344e2a06c8a9,How much was patient 10013049 charged to pay for the cost of their hospital stay during the first hospital visit?,SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT SUM( hospitalcosts.cost ) FROM hospitalcosts WHERE hospitalcosts.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.subject_id = 10013049 ) AND admissions.admission_location = 'home' ORDER BY admissions.admittime ASC LIMIT 1 ),,False,0.0,0.0010595321655273438,0,no such table: hospitalcosts,,,
b71bf47188930e8abb1e562f,When was patient 10036156's last procedure conducted in this year?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10036156 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10036156 ) ) AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures.starttime DESC LIMIT 1",,False,0.0,0.0010998249053955078,0,no such table: procedures,,,
92448b3c2bb324d7cc5a35f9,"Show me the top five most commonly prescribed drugs within 2 months for patients in their 60 or above after a thrombocytopenia, unspecified diagnosis since 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'thrombocytopenia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT d.drug FROM   ( SELECT   t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM     ( SELECT    u1.subject_id, l1.drug   FROM      labevents AS l1   WHERE     l1.valuenum = 0   AND       l1.spec_type_desc = 'thrombocytopenia, unspecified'   AND       datetime(l1.charttime,'start of year') >= datetime(current_time,'start of year','-0 year')   GROUP BY   u1.subject_id, l1.drug ) AS t1   JOIN      ( SELECT    u2.subject_id, l2.drug   FROM      labevents AS l2   WHERE     l2.valuenum = 0   AND       l2.spec_type_desc = 'thrombocytopenia, unspecified'   AND       datetime(l2.charttime,'start of year') >= datetime(current_time,'start of year','-0 year')   GROUP BY   u2.subject_id, l2.drug ) AS t2   ON t1.subject_id = t2.subject_id   WHERE     datetime(t1.charttime) < datetime(t2.charttime)   AND       datetime(t2.charttime",,False,0.0,0.0006844997406005859,0,incomplete input,,,
5625e6388567182df2aab97b,What is the average period of delay between appointments in the nephrology department?,,SELECT AVG(T1.charttime - T2.charttime) FROM microbiologyevents AS T1 JOIN microbiologyevents AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.spec_type_desc = 'nephrology' AND T2.spec_type_desc = 'nephrology' AND datetime(T1.charttime) >= datetime(T2.charttime) GROUP BY T1.hadm_id,,True,0.09063220024108887,0.0920262336730957,0,,,,"[{""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T1""}, {""id"": 13, ""parent"": 0, ""notused"": 0, ""detail"": ""BLOOM FILTER ON T2 (spec_type_desc=? AND hadm_id=?)""}, {""id"": 26, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH T2 USING AUTOMATIC PARTIAL COVERING INDEX (spec_type_desc=? AND hadm_id=?)""}, {""id"": 38, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}]"
c511f734e9fd03e177de1e9c,Was any sputum microbiology test done to patient 10026255 on their last hospital visit?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum',SELECT COUNT(*)>0 FROM microbiologyevents WHERE sputum is NOT NULL AND patients.d_icd_procedures_icd_id = microbiologyevents.charttime AND patients.age = 10026255 AND patients.gender = 'M' AND patients.admittime IN ( SELECT admissions.charttime FROM admissions WHERE admissions.age = 10026255 AND admissions.gender = 'M' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],False,0.0,0.0013060569763183594,0,no such column: sputum,,,
4779807de491caeb560e846d,Can you tell me the top five most common microbiology tests that occurred in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents AS T1 JOIN d_icd_procedures AS T2 ON T1.spec_type_desc = T2.long_title WHERE strftime('%Y',T1.charttime) = '2100' GROUP BY T1.spec_type_desc ) AS T WHERE T.C1 <= 5",[],False,0.0,0.0009543895721435547,0,no such column: T2.spec_type_desc,,,
809a2e5b92679e748ad8312c,"What was the maximum monthly number of patients diagnosed with surgical operation with implant of artificial internal device as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure in 2100?","SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'surgical operation with implant of artificial internal device as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM ( SELECT subject_id, age, strftime('%Y-%m',presc_time) AS C1 FROM prescription WHERE drug = 'surgical operation with implant of artificial internal device' ) AS T2 WHERE T2.C1 LIKE '2100-%' GROUP BY T2.C1 ) AS T1",,False,0.0,0.0009005069732666016,0,no such table: prescription,,,
727aea1d64b5ba869e4b3dc8,What was the total dose of bisacodyl that patient 10025463 has been prescribed in their first hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'bisacodyl',SELECT SUM(d prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.gender = 'male' AND admissions.age >= 50 ORDER BY admissions.admittime ASC LIMIT 1 ) AND admissions.gender = 'male' AND admissions.age >= 50 ) AND prescriptions.drug = 'bisacodyl' AND prescriptions.spec_type = 'oral' AND prescriptions.starttime IS NOT NULL AND prescriptions.endtime IS NOT NULL AND prescriptions.hadm_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'SUM(prescriptions.dose_val_rx)': None}],False,0.0,0.0005970001220703125,0,"near ""prescriptions"": syntax error",,,
5da6b605b949e3c4c068537e,When did patient 10039831 first receive a mrsa screen microbiological test in 12/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mrsa screen' ) AND labevents.valuenum IS NOT NULL AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 1000 - strftime('%Y',current_time) AND admissions.gender = 'unknown' AND admissions.pid = 10039831 ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0009248256683349609,0,no such table: procedures,,,
97f99846bf73b8acd7a1318e,How many medicines were prescribed since 4 months ago to patient 10014354?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-4 month')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT admissions.icustay_id FROM admissions WHERE admissions.age >= 18 AND admissions.gender = 'male' AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ) AND prescriptions.drug = 'medicines' AND datetime(prescriptions.starttime) >= datetime(current_time,'-4 month') AND prescriptions.chartevents_icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.age >= 18 AND chartevents.gender = 'male' AND chartevents.itemid IN ( SELECT definitions.row_id FROM definitions WHERE definitions.label = 'patient age' ) AND chartevents.valuenum >= 18 ) AND prescriptions.chartevents_icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.age >= 18 AND chartevents.gender = 'male' AND chartevents.itemid IN ( SELECT definitions.row_id FROM definitions WHERE definitions.label = 'patient age' ) AND chartevents.valuenum >= 18 ) AND prescriptions.chartevents_icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.age >= 18 AND chartevents.gender = 'male' AND chartevents.itemid",[{'COUNT(*)': 1180}],False,0.0,0.0005025863647460938,0,incomplete input,,,
82ee3d9b301ac0cf74fc8be8,Could you tell me the marital status of patient 10006580 during their first hospital visit?,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,"SELECT d.valuenum FROM microbiologyevents d WHERE d.spec_type_desc = 'blood culture' AND d.hadm_id IN ( SELECT b.hadm_id FROM patients a JOIN admissions b ON a.row_id = b.patient_id WHERE a.age >= 50 AND a.gender = 'male' AND a.d_icd_procedures_icd_code = '13.95' AND strftime('%Y',b.admittime) >= '2100' ) ORDER BY d.charttime ASC LIMIT 1",[{'marital_status': 'MARRIED'}],False,0.0,0.0008628368377685547,0,no such column: d.valuenum,,,
24f78921cd386503847e3682,What is hardware registration,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'hardware registration',,True,0.0913393497467041,0.09274101257324219,1,,[{'COUNT(*)': 0}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}]"
c2ca78801b0bb755ec80903e,"Which care unit did patient 10004235 last enter since 2100, as recorded in the transfer record?","SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND transfers.careunit IS NOT NULL AND strftime('%Y',transfers.intime) >= '2100' ORDER BY transfers.intime DESC LIMIT 1","SELECT T1.careunit FROM ( SELECT T2.careunit, DENSE_RANK() OVER ( ORDER BY T2.intime DESC ) AS C1 FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT T3.hadm_id FROM ( SELECT T4.hadm_id FROM ( SELECT * FROM patients WHERE patients.subject_id = 10004235 ) AS T4 JOIN d_icd_procedures ON T4.age >= d_icd_procedures.age_rng_start ) AS T3 WHERE T3.key = '2100' ) ) AS T2 ) AS T1 WHERE T1.C1 = 1",[{'careunit': 'Transplant'}],False,0.0,0.0009086132049560547,0,no such column: T4.hadm_id,,,
fc9a1a57bacdb774ac5e8f68,What was the admission type for patient 10023117 during their first hospital visit?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10023117 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1","SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10023117 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1",[],True,0.027538537979125977,0.02806401252746582,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 26, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
c31c4e310562d4a9cc9837f1,Could you tell me how many patients were given phytonadione last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phytonadione' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT d_icustays.charttime ) FROM d_icustays WHERE d_icustays.charttime >= datetime(current_time,'start of year','-1 year') AND d_icustays.charttime < datetime(current_time,'start of year') EXCEPT SELECT DISTINCT d_icustays.charttime FROM d_icustays WHERE d_icustays.charttime >= datetime(current_time,'start of year','-1 year') AND d_icustays.charttime < datetime(current_time,'start of year') AND d_icustays.stay_id IN ( SELECT d_labitems.stay_id FROM d_labitems WHERE d_labitems.itemid IN ( SELECT procedure_icd.itemid FROM procedure_icd WHERE procedure_icd.long_title = 'phytonadione' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0006837844848632812,0,incomplete input,,,
7d5fe035bb44c9237b17dfe5,"Was patient 10031757 prescribed on their first hospital visit heparin flush (10 units/ml), enoxaparin sodium, or vancomycin?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'heparin flush (10 units/ml)', 'enoxaparin sodium', 'vancomycin' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.dischtime IS NOT NULL AND admissions.age IS NOT NULL AND admissions.gender = 'male' ORDER BY admissions.admittime ASC LIMIT 1 ) AND admissions.gender = 'male' AND admissions.age IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'heparin flush (10 units/ml)', 'enoxaparin sodium', 'vancomycin' )",[{'COUNT(*)>0': 0}],False,0.0,0.0012896060943603516,0,"unrecognized token: ""'heparin """,,,
350a9469b2c148343a897fc7,Tell me the top four most common diagnoses for patients with age 30s since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d.icd_name FROM   ( SELECT   d_icd_icditems_icd_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiom_icditems d   WHERE   d.age BETWEEN 30 AND 39   AND   strftime('%Y',d.charttime) >= '2100'   GROUP BY   d_icd_icditems_icd_name ) AS T1   WHERE   T1.C1 <= 4   JOIN   microbiom_icd d ON d_icd_icditems_icd_name = d.icd_name",,False,0.0,0.0011043548583984375,0,"near ""JOIN"": syntax error",,,
4b635ac1325eaf0dd75988d5,"In 04/last year, has patient 10001725 been prescribed with pantoprazole, albuterol 0.083% neb soln, or propranolol?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND prescriptions.drug IN ( 'pantoprazole', 'albuterol 0.083% neb soln', 'propranolol' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 40 AND patients.gender = 'male' ) AND prescriptions.drug IN ( 'pantoprazole', 'albuterol 0.083% neb soln', 'propranolol' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)>0': 0}],False,0.0,0.0010533332824707031,0,no such column: patients.hadm_id,,,
81eff335d1116d8fed074540,Give me the top three most common diagnoses for patients of age 60 or above since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d.icd_name FROM   ( SELECT   d_icd_icditems_icd_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiom ic   JOIN   d_icd_icditems   ON   ic.spec_type_icd = d_icd_icditems_icd_id   WHERE   ic.spec_type_desc = 'age 60 or above'   AND   datetime(ic.charttime) >= datetime(current_time,'-1 year')   GROUP BY   d_icd_icditems_icd_name ) AS t1   JOIN   d_icd   AS d   ON   t1.d_icd_icditems_icd_name = d.icd_name   WHERE   t1.c1 <= 3",,False,0.0,0.0020952224731445312,0,no such table: microbiom,,,
c996bd83ae8f43a3717a6f64,"How many times did patient 10002495 have irrigation of genitourinary tract using irrigating substance, via natural or artificial opening since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'irrigation of genitourinary tract using irrigating substance, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10002495 AND charttime >= '2100-01-01' AND description = 'irrigation of genitourinary tract using irrigating substance, via natural or artificial opening'",,False,0.0,0.001207113265991211,0,no such column: patient_id,,,
71b23a88bad2ea2f52f12b02,"Among patients who were prescribed with phenytoin infatab, what are the top five most frequently prescribed drugs at the same time in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phenytoin infatab' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT d.drug FROM   (   SELECT   t1.subject_id, t1.drug, DENSE_RANK() OVER (   PARTITION BY t1.subject_id   ORDER BY   COUNT(*) DESC   ) AS C1   FROM   (       SELECT   prescription.subject_id, prescription.drug,       TO_CHAR(prescription.starttime,'yyyy') AS T1       FROM   prescription       WHERE   prescription.drug = 'phenytoin infatab'     ) AS t1       JOIN     (       SELECT   prescription.subject_id, prescription.drug,       TO_CHAR(prescription.starttime,'yyyy') AS T1       FROM   prescription       WHERE   prescription.drug IN (       SELECT   T2.drug       FROM   (         SELECT   prescription.subject_id, prescription.drug,       TO_CHAR(prescription.starttime,'yyyy') AS T1, DENSE_RANK() OVER (         PARTITION BY prescription.subject_id, TO_CHAR(prescription.starttime,'yyyy')         ORDER BY   prescription.starttime       ) AS C1       FROM   prescription       WHERE   prescription.drug = 'phenytoin infatab'       ) AS T1       JOIN (         SELECT   prescription.subject_id, prescription.drug,       TO_CHAR(pres",[],False,0.0,0.0011839866638183594,0,incomplete input,,,
b05a0cc27584db59d2dc4a8b,What was the length of stay in days for patient 10020944's last hospitalization?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","SELECT DISTINCT w1.value FROM microbiologyevents AS w1 WHERE w1.hadm_id IN ( SELECT t1.hadm_id FROM ( SELECT o.hadm_id, o.charttime FROM labevents AS o WHERE o.itemid IN ( SELECT p.itemid FROM d_icd_items AS p WHERE p.long_title = 'calcium, total' ) AND o.valuenum IS NOT NULL ORDER BY o.charttime ASC ) AS t1 WHERE t1.charttime >= ( SELECT m.charttime FROM labevents AS m WHERE m.itemid IN ( SELECT n.itemid FROM d_icd_items AS n WHERE n.long_title = 'calcium, total' ) AND m.valuenum IS NOT NULL AND m.hadm_id = t1.hadm_id ORDER BY m.charttime ASC LIMIT 1 ) ) AND w1.spec_type_desc = 'stool' AND w1.hadm_id IN ( SELECT x.hadm_id FROM ( SELECT y.hadm_id, y.charttime FROM microbiologyevents AS y WHERE y.spec_type_desc = 'stool' AND y.hadm_id IN ( SELECT z.hadm_id FROM ( SELECT o.hadm_id, o.charttime FROM labevents AS o WHERE o.itemid IN ( SELECT p.itemid FROM d_ic","[{""strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime)"": 14.060416666790843}]",False,0.0,0.0015106201171875,0,"near ""AN"": syntax error",,,
7066a7025a2c0442a511c5e1,What was patient 10015272's first SaO2 since 203 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-203 day') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT d1.valuenum FROM d_icd_procedures AS d1 WHERE d1.chartkey IN ( SELECT d2.chartkey FROM d_icd_diagnoses AS d2 WHERE d2.icd_code = 'I10' AND d2.chartkey IN ( SELECT d3.chartkey FROM patients AS d3 WHERE d3.age BETWEEN 50 AND 60 AND d3.gender = 'male' ) ) AND d1.itemid IN ( SELECT d4.itemid FROM labevents AS d4 WHERE d4.valuenum = ( SELECT MIN(d5.valuenum) FROM labevents AS d5 WHERE d5.itemid IN ( SELECT d6.itemid FROM labevents AS d6 WHERE d6.chartkey IN ( SELECT d7.chartkey FROM d_icd_diagnoses AS d7 WHERE d7.icd_code = 'I10' AND d7.chartkey IN ( SELECT d8.chartkey FROM patients AS d8 WHERE d8.age BETWEEN 50 AND 60 AND d8.gender = 'male' ) ) ) AND datetime(d5.charttime) >= datetime(current_time,'-203 day') ) GROUP BY d1.chartkey HAVING RANK() OVER ( ORDER BY MIN(d1.charttime) ASC ) =",[],False,0.0,0.0008234977722167969,0,incomplete input,,,
55712c5df13d0dbf402229f5,What were the first outputs of patient 10019917 since 01/19/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT d.output_time FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = 'output, other' ) AND d.subject_id = 10019917 AND strftime('%Y-%m-%d',d.output_time) >= '2100-01-19' ORDER BY d.output_time ASC LIMIT 1",[{'label': 'Void'}],False,0.0,0.0017311573028564453,0,no such column: d.output_time,,,
3d5c7c8185dc079c5e416e14,What was the first time patient 10040025 had the minimum platelet count value in 03/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' AND patients.d_icd_procedures = '2100' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],False,0.0,0.0011205673217773438,0,no such table: procedures,,,
e24c2b3af926f81b8b39d097,Identify the most common organism associated with poor specimen quality in microbiology tests.,,"SELECT T1.org_name FROM ( SELECT microbiologyevents.spec_type_desc, microbiologyevents.org_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'poor specimen quality' GROUP BY microbiologyevents.spec_type_desc, microbiologyevents.org_name ) AS T1 WHERE T1.C1 = 1",,True,0.08868932723999023,0.08956670761108398,0,,,,"[{""id"": 2, ""parent"": 0, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 5, ""parent"": 2, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-3)""}, {""id"": 12, ""parent"": 5, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}, {""id"": 16, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 54, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 69, ""parent"": 2, ""notused"": 0, ""detail"": ""SCAN (subquery-3)""}, {""id"": 133, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T1""}]"
e432536973c91611dfb80a3b,Call a rehabilitation center to arrange post-discharge care.,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'rehabilitation center to arrange post-discharge care',,True,0.09427952766418457,0.09549140930175781,1,,[{'COUNT(*)': 0}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}]"
04ca1a97c725954eac35669a,"When was the last time patient 10018501 was diagnosed with gout, unspecified?","SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gout, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",SELECT hospitalevents.charttime FROM hospitalevents WHERE hospitalevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = hospitalevents.row_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = hospitalevents.row_id ) ) AND hospitalevents.event_type = 'disch' ORDER BY hospitalevents.charttime DESC LIMIT 1,,False,0.0,0.0017940998077392578,0,no such table: hospitalevents,,,
88a650d28643d60da24b7b3f,What was the last recorded height for patient 10006580 during the first hospital encounter?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT d.valuenum FROM labevents d WHERE d.hadm_id IN ( SELECT w.hadm_id FROM microbiologyevents w WHERE w.spec_type_desc = 'height' AND w.itemid IN ( SELECT MIN(y.itemid) FROM d_icd_items y WHERE y.long_title = 'height' AND y.linksto = 'labevents' ) ) AND d.hadm_id IN ( SELECT x.hadm_id FROM patients x WHERE x.age >= 0 AND x.gender = 'male' AND x.d_icd_procedures_key = ( SELECT MIN(z.d_icd_procedures_key) FROM d_icd_procedures z WHERE z.long_title = 'hospital admission' ) ) AND d.charttime IN ( SELECT MAX(c.charttime) FROM labevents c WHERE c.valuenum IS NOT NULL AND c.hadm_id IN ( SELECT w.hadm_id FROM microbiologyevents w WHERE w.spec_type_desc = 'height' AND w.itemid IN ( SELECT MIN(y.itemid) FROM d_icd_items y WHERE y.long_title = 'height' AND y.linksto = 'labevents' ) ) AND d.hadm_id IN ( SELECT x.hadm_id FROM patients x WHERE x.age >= 0 AND x.gender = 'male' AND x.d,[],False,0.0,0.0007128715515136719,0,incomplete input,,,
4fee25cd21a51a255f3f5bcf,What is the name of the prescription drug that patient 10037861 has been given two or more times since 8 months ago?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-8 month') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2",l/min,"[{'drug': '0.9% Sodium Chloride'}, {'drug': '5% Dextrose'}, {'drug': 'Acetaminophen'}, {'drug': 'Albuterol Inhaler'}, {'drug': 'Atorvastatin'}, {'drug': 'Bag'}, {'drug': 'Bisacodyl'}, {'drug': 'Calcium Gluconate'}, {'drug': 'D5W'}, {'drug': 'Dextrose 5%'}, {'drug': 'Dextrose 50%'}, {'drug': 'Digoxin'}, {'drug': 'Diltiazem'}, {'drug': 'Docusate Sodium'}, {'drug': 'Fentanyl Citrate'}, {'drug': 'Furosemide'}, {'drug': 'Glucagon'}, {'drug': 'Glucose Gel'}, {'drug': 'Heparin'}, {'drug': 'Heparin Sodium'}, {'drug': 'HydrALAzine'}, {'drug': 'Influenza Vaccine Quadrivalent'}, {'drug': 'Insulin'}, {'drug': 'Insulin Human Regular'}, {'drug': 'Iso-Osmotic Dextrose'}, {'drug': 'Isosorbide Dinitrate'}, {'drug': 'LORazepam'}, {'drug': 'LevETIRAcetam'}, {'drug': 'Magnesium Sulfate'}, {'drug': 'Metoprolol Tartrate'}, {'drug': 'Midazolam'}, {'drug': 'Milrinone'}, {'drug': 'Morphine Sulfate'}, {'drug': 'NORepinephrine'}, {'drug': 'Nitroglycerin Ointment  2%'}, {'drug': 'Ondansetron'}, {'drug': 'PHENYLEPHrine'}, {'drug': 'Pantoprazole'}, {'drug': 'Phenytoin'}, {'drug': 'Phenytoin Sodium'}, {'drug': 'Phosphorus'}, {'drug': 'Piperacillin-Tazobactam'}, {'drug': 'Potassium Chloride'}, {'drug': 'Potassium Chloride Replacement (Critical Care and Oncology) '}, {'drug': 'Propofol'}, {'drug': 'Sodium Chloride 0.9%'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Spironolactone'}, {'drug': 'Sulfameth/Trimethoprim DS'}, {'drug': 'Vancomycin'}, {'drug': 'Warfarin'}]",False,0.0,0.0007338523864746094,0,"near ""l"": syntax error",,,
eefb26cc5bd74a549f823166,What is the monthly minimum volume of void that patient 10014354 had since 10/06/2100?,"SELECT MIN(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-06' GROUP BY strftime('%Y-%m',outputevents.charttime)","SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' AND admissions.ethnicity = 'not of hispanic origin' ) AND chartevents.itemid IN ( SELECT definition.itemid FROM definition WHERE definition.label = 'void' ) AND chartevents.hadm_id = 10014354 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-10-06' GROUP BY strftime('%Y-%m',chartevents.charttime)",[],False,0.0,0.0011301040649414062,0,no such table: definition,,,
5984482bf8b3c03a9225ea58,What was the diagnosis of patient 10005866 for the first time on their last hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT d.icd_name FROM diagnosis d WHERE d.icd_name IS NOT NULL AND d.hadm_id IN ( SELECT o.hadm_id FROM outpatient o WHERE o.age = ( SELECT o.age FROM outpatient o WHERE o.pid = 10005866 AND o.hadm_id IN ( SELECT m.hadm_id FROM microbiology m WHERE m.spec_type_desc = 'blood culture' ) ORDER BY o.charttime ASC LIMIT 1 ) ) ORDER BY d.charttime ASC LIMIT 1,,False,0.0,0.0011973381042480469,0,no such table: diagnosis,,,
9aff84dfbc8d4cb85bb5267f,"How much does patient 10038999 change in calcium, total second measured on the last hospital visit compared to the first value measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittite DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0007779598236083984,0,"unrecognized token: ""'cal""",,,
2c613ae6f06d69d93196637f,When was the first time patient 10027602 had attention deficit disorder with hyperactivity diagnosed on their first hospital encounter?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1,SELECT DISTINCT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.pid = 10027602 AND admissions.dischtime IS NOT NULL ) ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'attention deficit disorder with hyperactivity' ) ORDER BY labevents.charttime ASC LIMIT 1,,False,0.0,0.0011017322540283203,0,no such table: procedures,,,
5287cbacaf23b703a8551d1c,"For patients who received a encephalopathy, unspecified diagnosis in 2100, which five medications were usually prescribed afterward in the same month?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encephalopathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T2.drug FROM ( SELECT subject_id, stay_id, charttime FROM microbiologyevents WHERE specimen_type = 'blood culture' AND organism_name = 'enterococcus faecalis' AND stay_id IN ( SELECT DISTINCT T1.stay_id FROM ( SELECT subject_id, admission_time, stay_id FROM d_icd_procedures WHERE icd_code = '2100' ) AS T1 ) AND datetime(charttime,'start of year') = datetime(admission_time,'start of year') - 2100 GROUP BY subject_id, stay_id HAVING count(DISTINCT organism_name) >= 1 ) AS T1 JOIN ( SELECT subject_id, stay_id, drug, prescription_starttime FROM prescriptionevents WHERE stay_id IN ( SELECT DISTINCT T1.stay_id FROM ( SELECT subject_id, admission_time, stay_id FROM d_icd_procedures WHERE icd_code = '2100' ) AS T1 ) AND datetime(prescription_starttime,'start of year') = datetime(admission_time,'start of year') - 2100 GROUP BY subject_id, stay_id, drug HAVING count(DISTINCT drug) >= 1 ) AS T2 ON T1.subject_id = T2.subject_id AND T1.stay_id =",,False,0.0,0.0006768703460693359,0,incomplete input,,,
30cdb06c3381ee1320dc4738,"What is the maximum hospital cost for the hospital visits that included scoliosis [and kyphoscoliosis], idiopathic?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'scoliosis [and kyphoscoliosis], idiopathic' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM( hospitalcost.cost ) AS C1 FROM hospitalcost WHERE hospitalcost.hospital_dischtime IS NOT NULL GROUP BY hospitalcost.hospital_icustay_id ) AS T1 JOIN ( SELECT hospital_icustay_of_patient.patient_id, hospital_icustay_of_patient.hospital_icustay_id FROM hospital_icustay_of_patient WHERE hospital_icustay_of_patient.hospital_dischtime IS NOT NULL ) AS T2 ON T1.hospital_icustay_id = T2.hospital_icustay_id JOIN ( SELECT chartevents_of_icustay.patient_id, chartevents_of_icustay.icustay_id FROM chartevents_of_icustay WHERE chartevents_of_icustay.charttime IS NOT NULL ) AS T3 ON T2.patient_id = T3.patient_id JOIN ( SELECT microbiologyevents_of_icustay.patient_id, microbiologyevents_of_icustay.icustay_id FROM microbiologyevents_of_icustay WHERE microbiologyevents_of_icustay.charttime IS NOT NULL AND microbiologyevents_of_icustay.spec_type_desc = 'and kyphoscoliosis, idiopathic' ) AS T4 ON T3.patient_id = T4.patient_id AND T3.ic",,False,0.0,0.0007646083831787109,0,incomplete input,,,
888427e0689a6de5a4d37211,Give me the top four most common diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT t1.icd_code FROM ( SELECT icd_diagnoses_icd_procedures.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM icd_diagnoses_icd_procedures GROUP BY icd_diagnoses_icd_procedures.icd_code ) AS t1 WHERE t1.C1 <= 4 )","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Hyperlipidemia, unspecified'}, {'long_title': 'Essential (primary) hypertension'}]",False,0.0,0.00130462646484375,0,no such table: icd_diagnoses_icd_procedures,,,
e6edc67f5259e8f507389a29,"How many patients received a total nucleated cells, pleural test in this year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, pleural' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'total nucleated cells, pleural' ) ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0013298988342285156,0,no such table: procedures,,,
919f039cb4f4fe92f49e7c86,How many current patients belong to the 30s age category?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age BETWEEN 30 AND 39 AND patients.dischtime IS NULL,,False,0.0,0.0014629364013671875,0,no such column: patients.age,,,
15b4990f761db52edf38273c,How many days have passed since the last time that patient 10021487 had received a hemoglobin lab test during the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT labevents.charttime FROM labevents WHERE labevents.hemoglobin IS NOT NULL AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'hemoglobin' ) AND labevents.hospital_visit_id = ( SELECT admissions.hospital_visit_id FROM admissions WHERE admissions.patient_id = 10021487 AND admissions.dischtime IS NULL ) ) ORDER BY labevents.charttime DESC LIMIT 1 ) ) FROM dual",[],False,0.0,0.0013012886047363281,0,"near ""LIMIT"": syntax error",,,
7af6a3a42f264bdbbfb7c37a,Is the value of diastolic blood pressure of patient 10018081 measured at 2100-12-31 23:00:00 greater than it is measured at 2100-12-31 22:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-31 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-31 22:00:00' ),SELECT ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND labresults.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.valuenum = ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND labresults.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.valuenum = ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND labresults.itemid = ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'arterial blood pressure diastolic' AND chartitems.chart_type = 'lab' ) AND labresults.charttime = '2100-12-31 22:00:00' ) ) ) ) AND labresults.itemid = ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'arterial blood pressure diastolic' AND chartitems.chart_type = 'lab' ) AND labresults.charttime = ',"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-31 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-31 22:00:00' )"": None}]",False,0.0,0.0007026195526123047,0,incomplete input,,,
dfc058cc8e8d30a29c0177b9,"After being diagnosed with thrombocytopenia, unspecified , how many patients received a diagnosis of chronic airway obstruction, not elsewhere classified during the same hospital visit?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'thrombocytopenia, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic airway obstruction, not elsewhere classified' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T3.subject_id, T3.charttime, T3.valuenum FROM labevents AS T3 WHERE T3.itemid IN ( SELECT DISTINCT procedure_icd_items.itemid FROM procedure_icd_items WHERE procedure_icd_items.long_title = 'diagnosis of chronic airway obstruction, not elsewhere classified' ) AND T3.valuenum IS NOT NULL ) AS T1 JOIN ( SELECT T4.subject_id, T4.charttime FROM labevents AS T4 WHERE T4.itemid IN ( SELECT DISTINCT procedure_icd_items.itemid FROM procedure_icd_items WHERE procedure_icd_items.long_title = 'diagnosis of thrombocytopenia, unspecified' ) AND T4.valuenum IS NOT NULL ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of day') = datetime(T2.charttime,'start of day')",,False,0.0,0.0006527900695800781,0,incomplete input,,,
3dcbbb6159d03af90b56b98f,"What are the top five most frequent medications prescribed within 2 months to the patients in their 50s after they were diagnosed with cerebral artery occlusion, unspecified with cerebral infarction this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral artery occlusion, unspecified with cerebral infarction' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time FROM diagnoses JOIN admissions ON diagnoses.hospital_id = admissions.hospital_id WHERE diagnoses.label = 'cerebral artery occlusion, unspecified with cerebral infarction' AND datetime(diagnoses.chart_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hospital_id = admissions.hospital_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.chart_time) AND datetime(T1.chart_time,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,False,0.0,0.000640869140625,0,incomplete input,,,
826d1ec55b9cb1dcd3714ce0,What's the minimum total hospital charged for a visit with a white blood cells lab test since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM( hospital_charges ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT labtests.itemid FROM labtests WHERE labtests.label = 'white blood cells' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.hadm_id ) AS T1",,False,0.0,0.0010178089141845703,0,no such table: labtests,,,
9b70f7f7a60a0c7994cc0ea0,List the top five most common diagnoses for patients in their 20s throughout this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.icd_name FROM   ( SELECT   d_icd_icditems_icd_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiom_icd_icditems   WHERE   d_icd_icditems_age = 20   AND datetime(d_icd_icditems_charttime,'start of year') = datetime(current_time,'start of year','-0 year')   GROUP BY   d_icd_icditems_icd_name ) AS T1   JOIN diagnoses d ON T1.d_icd_icditems_icd_name = d.icd_code   WHERE   T1.C1 <= 5",,False,0.0,0.0010950565338134766,0,no such table: microbiom_icd_icditems,,,
6938557cc42ba52caf388bef,Calculate the aggregate sum for patient 10005909's input since 02/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-12'",SELECT SUM(input) FROM labevents WHERE patient_id = 10005909 AND charttime >= '2100-02-12',[{'SUM(inputevents.totalamount)': 16695.0}],False,0.0,0.0010547637939453125,0,no such column: input,,,
61a3d12ba8e762f3b53709cd,What were the top five microbiology tests most frequently performed since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT procedures_icd.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.spec_type_desc = 'microbiology' AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]",False,0.0,0.00121307373046875,0,no such column: procedures_icd.spec_type_desc,,,
70d14dce56962dcc9931c667,What are the methods for ingesting phenytoin sodium?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'phenytoin sodium',SELECT DISTINCT procedures.drug FROM procedures WHERE procedures.spec_type = 'phenytoin sodium' AND procedures.route = 'ingest',[],False,0.0,0.0011625289916992188,0,no such table: procedures,,,
ee8306d4a542175197a6d200,What was the maximum value for patient 10009049's specific gravity?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ),SELECT MAX(laboratoryevents.valuenum) FROM laboratoryevents WHERE laboratoryevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10009049 ) AND laboratoryevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'specific gravity' ),[{'MAX(labevents.valuenum)': None}],False,0.0,0.0010039806365966797,0,no such table: laboratoryevents,,,
844c677f9eb40b4cc09e828a,How many times did patient 10001217 check into the ICU?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ),SELECT COUNT(*) FROM microbiologyevents WHERE patientid = 10001217,[{'COUNT( DISTINCT icustays.stay_id )': 2}],False,0.0,0.0009660720825195312,0,no such column: patientid,,,
f8c059d6d1b2b47b1fe1c76d,Retrieve the top five most frequently prescribed drugs since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT d.drug FROM   ( SELECT   d.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiome_prescriptions d   WHERE   strftime('%Y',d.starttime) >= '2100'   GROUP BY   d.drug ) AS T1 WHERE T1.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]",False,0.0,0.0009198188781738281,0,no such table: microbiome_prescriptions,,,
672d81cda5b780896726e4f2,When was patient 10015860's respiratory rate less than 21.0 for the first time since 06/06/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-06' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'respiratory rate' ) AND labevents.valuenum < 21.0 AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 1000 - 2100 AND admissions.gender = 'male' AND admissions.ethnicity = 'not of hispanic origin' ) AND labevents.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 1000 - 2100 AND admissions.gender = 'male' AND admissions.ethnicity = 'not of hispanic origin' AND admissions.pid = 10015860 ) AND strftime('%Y-%m-%d',labevents.charttime) >= '2100-06-06' ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0005304813385009766,0,incomplete input,,,
817d23cea9de1a0e459a25c3,"How much is a bilirubin, indirect lab test?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, indirect' ) )","SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'bilirubin, indirect lab test'",,False,0.0,0.0009095668792724609,0,no such table: procedures,,,
4ea946f4212eca0acf044771,Which of these types of painting was more likely to have been produced by a northern renaissance,,SELECT DISTINCT T1.spec_type_desc FROM microbiologyevents T1 WHERE T1.spec_type_desc IN ( 'northern renaissance' ),,True,0.09389781951904297,0.09488105773925781,0,,,,"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T1""}]"
6d4f5b0a77a91969a10a7ca2,How many microbiology events with excellent specimen quality have occurred since last month?,,"SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'excellent' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",,True,0.1006615161895752,0.10151505470275879,1,,[{'COUNT(*)': 0}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}]"
2b7276378eab1b3d2a5dbc38,How much total input has patient 10014354 received in the last ICU stay?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ),SELECT SUM(input) FROM microbiologyevents WHERE patientid = 10014354 AND charttime >= current_time - interval '1 year' AND itemid IN ( SELECT itemid FROM d_icditems WHERE d_icddefinitions.long_title = 'input' ) AND stay_id IN ( SELECT stay_id FROM patients_icustays WHERE patients_icustays.patientid = 10014354 ORDER BY patients_icustays.intime DESC LIMIT 1 ),[{'SUM(inputevents.totalamount)': 8750.0}],False,0.0,0.0009295940399169922,0,"near ""'1 year'"": syntax error",,,
af50a318710cad0b74d80aa6,"What is the average total hospital cost when it involves diastolic heart failure, unspecified in 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diastolic heart failure, unspecified' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM( hospitalcosts.cost ) AS C1 FROM hospitalcosts WHERE hospitalcosts.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 2100 ) GROUP BY hospitalcosts.hadm_id ) AS T1 JOIN ( SELECT admissions.hadm_id, d_icd_procedures.icd_code FROM admissions JOIN d_icd_procedures ON admissions.charttime >= d_icd_procedures.charttime - 2 * 365 WHERE d_icd_procedures.icd_code = '4280' ) AS T2 ON T1.hadm_id = T2.hadm_id",,False,0.0,0.000911712646484375,0,no such table: hospitalcosts,,,
d00ed2cfc1975f9b13bcf1f9,What diagnoses were the latest recorded for patient 10015860?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT d.icd_name FROM diagnosis d WHERE d.icd_code IN ( SELECT p_icd FROM microbiologyevents WHERE p_id = 10015860 ORDER BY charttime DESC LIMIT 1 ),,False,0.0,0.0008566379547119141,0,no such table: diagnosis,,,
0c4dd3081cb0d0d1bacad045,What was the total hospital cost for patient 10025612's stay on their last hospital visit?,SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT SUM(cost) FROM hospital_cost_table WHERE subject_id = 10025612 AND hospital_dischtime IS NOT NULL ORDER BY hospital_admittime DESC LIMIT 1,,False,0.0,0.0008459091186523438,0,no such table: hospital_cost_table,,,
20e38a034dc27e9626dfa8d9,"Which care unit did patient 10014078 first enter since 2100, based on the transfer record?","SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND transfers.careunit IS NOT NULL AND strftime('%Y',transfers.intime) >= '2100' ORDER BY transfers.intime ASC LIMIT 1","SELECT T1.careunit FROM ( SELECT T2.careunit, DENSE_RANK() OVER ( ORDER BY T2.intime ASC ) AS C1 FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT T3.hadm_id FROM ( SELECT T4.hadm_id FROM ( SELECT * FROM patients WHERE patients.subject_id = 10014078 ) AS T4 JOIN d_icd_procedures AS T5 ON T4.age >= 2100 WHERE T5.key = 'transfer' ) AS T3 ON T4.hadm_id = T3.hadm_id ) ) AS T2 ) AS T1 WHERE T1.C1 = 1",[{'careunit': 'Emergency Department'}],False,0.0,0.0006303787231445312,0,a JOIN clause is required before ON,,,
391ecf976f96659f09f26269,What's the price for lamotrigine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lamotrigine' ),SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'lamotrigine',,False,0.0,0.00098419189453125,0,no such table: procedures,,,
48b62fcb80cf1fee53b8bfb1,What was the total volume of input that patient 10018081 received on this ICU visit?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ),SELECT SUM(input) FROM microbiologyevents WHERE input IS NOT NULL AND patientid = 10018081 AND stay_id IN ( SELECT DISTINCT stay_id FROM patients WHERE subject_id = 10018081 ) ORDER BY intime ASC LIMIT 1,[{'SUM(inputevents.totalamount)': None}],False,0.0,0.0009300708770751953,0,no such column: input,,,
2dfc862bcecf1f1b2c037bc9,When did patient 10007818 receive a glucose laboratory test for the first time in 07/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07' ORDER BY labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = labevents.hadm_id ) ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07' ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0006062984466552734,0,incomplete input,,,
d2d7d8b52a277ffa44cfb072,Please tell me patient 10019777's sex.,SELECT patients.gender FROM patients WHERE patients.subject_id = 10019777,SELECT patients.gender FROM patients WHERE patients.charttime IN ( SELECT admissions.charttime FROM admissions WHERE admissions.subject_id = 10019777 ),[{'gender': 'M'}],False,0.0,0.0009813308715820312,0,no such column: admissions.charttime,,,
7c2a2d33722d9a5b379010ff,What new drugs have been prescribed to patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT d.drug FROM prescriptions d WHERE d.hadm_id IN ( SELECT t1.hadm_id FROM ( SELECT admissions.subject_id, admissions.charttime, admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND datetime(admissions.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ) AS t1 JOIN ( SELECT admissions.subject_id, admissions.charttime, admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND datetime(admissions.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ) AS t2 ON t1.subject_id = t2.subject_id WHERE d.hadm_id = t1.hadm_id AND datetime(d.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT d.drug FROM prescriptions d WHERE d.hadm_id IN ( SELECT t1.hadm_id FROM ( SELECT admissions.subject_id, admissions.charttime, admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND datetime(admissions.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ) AS t1 JOIN ( SELECT admissions.subject_id, admissions.charttime, admissions",[],False,0.0,0.000728607177734375,0,incomplete input,,,
f1ca5e6021ac2bbdb6b7e7bf,Is respiratory rate of patient 10000032 last measured on the first ICU visit greater than the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT respiratory_rate FROM microbiom_icu WHERE patient_id = 10000032 AND age_icu_first_encounter < 1 ORDER BY charttime DESC LIMIT 1 ) > ( SELECT respiratory_rate FROM microbiom_icu WHERE patient_id = 10000032 AND age_icu_first_encounter < 1 ORDER BY charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0010750293731689453,0,no such table: microbiom_icu,,,
d8c4bcdab05c48a114af4957,Calculate the total number of outputs from patient 10027602 since 06/22/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-22'",SELECT COUNT(*) FROM labevents WHERE patient_id = 10027602 AND charttime >= '2100-06-22',[{'SUM(outputevents.value)': 42636.0}],False,0.0,0.0009448528289794922,0,no such column: patient_id,,,
828f43dc5831cb08e5ce4ac8,When was patient 10015931 first prescribed a medication via the po/ng route since 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT medications.starttime FROM medications WHERE medications.hcpcshcpcs = 'po/ng' AND medications.chartevents_icustay_id IN ( SELECT patients.chartevents_icustay_id FROM patients WHERE patients.age >= 18 AND patients.gender = 'male' AND patients.chartevents_icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.age >= 18 AND icustays.age < 85 AND icustays.gender = 'male' AND icustays.admissionlocation = 'emergency room' ) ) AND medications.chartevents_icustay_id IN ( SELECT chartevents_icustay_id FROM chartevents WHERE chartevents.valuenum = 10015931 AND chartevents.itemid IN ( SELECT itemid FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of left main coronary artery with autologous vein' ) ) AND strftime('%Y-%m',medications.starttime) >= '2100-07' ORDER BY medications.starttime ASC LIMIT 1",[],False,0.0,0.0005357265472412109,0,incomplete input,,,
1b49fcb3998703d3dd37e81e,"What is the average total cost of the hospital, which includes the procedure named other incision of pleura?",SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of pleura' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.C1) FROM ( SELECT SUM( hospitalcosts.cost ) AS C1 FROM hospitalcosts WHERE hospitalcosts.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.label = 'other incision of pleura' ) GROUP BY hospitalcosts.hadm_id ) AS T1,,False,0.0,0.0009932518005371094,0,no such table: hospitalcosts,,,
3f3b727d5effabd567b64400,Give me the top four most commonly prescribed medications in the same month to the patients aged 50s after they were diagnosed with non-st elevation (nstemi) myocardial infarction throughout this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'non-st elevation (nstemi) myocardial infarction' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hospital_id = admissions.hospital_id WHERE diagnoses.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'non-st elevation (nstemi) myocardial infarction' ) AND admissions.age BETWEEN 50 AND 59 ) AS t2 GROUP BY t2.icd_code ) AS t3 WHERE t3.c1 <= 4 )",,False,0.0,0.0007207393646240234,0,incomplete input,,,
8f037d1cedf499b333e3a25d,When was the first microbiological test of patient 10015931 performed during this month?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'microbiological' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10015931 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10015931 ) ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0007452964782714844,0,incomplete input,,,
6d1e9f74415d70381cffcd18,Has patient 10021938 had a procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = 2100 ) AND chartevents.valuenum IS NOT NULL ) AND procedures_icd.patient_id = 10021938,,False,0.0,0.0009682178497314453,0,no such table: definition,,,
a69440dfa419dc0ff7d88b64,Tell me the total dose of metoprolol succinate xl that patient 10020944 was prescribed in 03/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'metoprolol succinate xl' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03'","SELECT SUM(d prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = prescriptions.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = prescriptions.hadm_id ) ) AND prescriptions.drug = 'metoprolol succinate xl' AND prescriptions.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = '10020944' ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = '10020944' ) ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03'",[{'SUM(prescriptions.dose_val_rx)': None}],False,0.0,0.0006380081176757812,0,"near ""prescriptions"": syntax error",,,
ffcf49b4d60d6ba61111c10d,"On last month/17, what was the average of heart rate for patient 10006053?","SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '17'","SELECT AVG(d_icd_procedures.charttime - adm.dischtime)   FROM d_icd_procedures   JOIN patients   ON d_icd_procedures.hadm_id = patients.hadm_id   JOIN admissions adm   ON patients.subject_id = adm.subject_id   WHERE d_icd_procedures.itemid IN ( SELECT procedures_icd.itemid   FROM procedures_icd   WHERE procedures_icd.long_title = 'insertion of intravenous infusion device into vein' )   AND patients.gender = 'male'   AND patients.age >= 50   AND strftime('%Y-%m',d_icd_procedures.charttime) = '2100-01' GROUP BY d_icd_procedures.hadm_id",[{'AVG(chartevents.valuenum)': None}],False,0.0,0.0006072521209716797,0,"unrecognized token: ""'210""",,,
09963a1437aa17e27738f18a,What are the four most commonly received procedures for patients in their 30s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d.proc_name FROM   ( SELECT   d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   procedure_table d   WHERE   d.age BETWEEN 30 AND 39   AND datetime(d.charttime) >= datetime(current_time,'-1 year')   GROUP BY d.proc_name ) WHERE C1 <= 4",,False,0.0,0.0010418891906738281,0,no such table: procedure_table,,,
df9daf11c602ac48c88b8f7b,"Count the number of patients who had arterial catheterization in the same month after having been diagnosed with osteoarthrosis, localized, not specified whether primary or secondary, pelvic region and thigh in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'osteoarthrosis, localized, not specified whether primary or secondary, pelvic region and thigh' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'arterial catheterization' AND strftime('%Y',procedures.starttime) = '2100' ) AND patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'diagnosed with osteoarthrosis, localized, not specified whether primary or secondary, pelvic region and thigh' AND strftime('%Y',procedures.starttime) = '2100' ) AND datetime(procedures.starttime,'start of month') = datetime(diagnoses.starttime,'start of month')",,False,0.0,0.001081228256225586,0,no such table: procedures,,,
9eefd9e726c081549a74f486,How many current patients are 60 or above?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT( DISTINCT d_icustays.charttime ) FROM d_icustays WHERE d_icustays.age >= 60 AND d_icustays.dischtime IS NULL,,False,0.0,0.0009655952453613281,0,no such table: d_icustays,,,
8a56f098370ca6af99a28b53,What was the last prescribed dose of simvastatin that patient 10015860 got in the first hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'simvastatin' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT d.value FROM prescriptions d WHERE d.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.age IS NOT NULL AND admissions.itemid IN ( SELECT DISTINCT prescriptions.itemid FROM prescriptions WHERE prescriptions.drug = 'simvastatin' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND d.drug = 'simvastatin' AND d.itemid IN ( SELECT DISTINCT prescriptions.itemid FROM prescriptions WHERE prescriptions.drug = 'simvastatin' ) ORDER BY d.starttime DESC LIMIT 1,[],False,0.0,0.0006437301635742188,0,incomplete input,,,
6e7e6e42109e147a8c37d95d,"What was the last rbc, ascites lab test result for patient 10005866 in their last hospital visit?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, ascites' ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.pid = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'rbc, ascites' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.pid = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.0006372928619384766,0,"unrecognized token: ""'rbc, a""",,,
4ec97f169fd8ebe7a00e3ec0,Provide the ID list of patients who were diagnosed with unspecified sleep apnea in 2100.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sleep apnea' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT DISTINCT patients.subject_id FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'unspecified sleep apnea' AND strftime('%Y',procedures.charttime) = '2100' )",,False,0.0,0.0009224414825439453,0,no such table: procedures,,,
0d6e154c99ea7aa10dc0ac5c,What is the amount of albumin 25% that patient 10025612 received?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ),SELECT SUM(d_icd_procedures.key_value) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'administration of albumin 25%' ) AND procedures_icd.charttime IS NOT NULL AND procedures_icd.charttime >= ( SELECT admissions.charttime FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NULL ) ORDER BY procedures_icd.charttime ASC LIMIT 1 OFFSET 0,[{'SUM(inputevents.totalamount)': None}],False,0.0,0.0009851455688476562,0,no such column: d_icd_procedures.key_value,,,
a652507fb99040108907976b,What was the total of patients discharged from hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT( DISTINCT patients.chartkey ) FROM patients WHERE patients.dischtime is NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 180733}],False,0.0,0.00098419189453125,0,no such column: patients.chartkey,,,
7bb4dd3032dd60767f552577,Has patient 10006580 had any medication since 13 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month')","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT patients.chartevents_icustay_id FROM patients WHERE patients.age = 13 AND patients.gender = 'male' AND patients.subject_id = 10006580 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month')",[{'COUNT(*)>0': 1}],False,0.0,0.000993967056274414,0,no such column: patients.chartevents_icustay_id,,,
bc393399923f7dabaa005804,Tell me the marital status of patient 10004720 during the first hospital encounter.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT d.valuenum FROM microbiologyevents d WHERE d.hadm_id IN ( SELECT b.hadm_id FROM labevents b WHERE b.itemid IN ( SELECT DISTINCT a.itemid FROM d_icd_procedures a WHERE a.long_title = 'other excision of brain' ) ),[{'marital_status': 'SINGLE'}],False,0.0,0.0009338855743408203,0,no such column: d.valuenum,,,
6381c60f67186bd31083fcdf,How was patient 10000032 admitted in terms of admission type for the last time in the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10000032 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1","SELECT admissions.admission_type FROM admissions WHERE admissions.chartevents.charttime IN ( SELECT T1.charttime FROM ( SELECT chartevents.charttime, DENSE_RANK() OVER ( ORDER BY chartevents.charttime DESC ) AS C1 FROM chartevents WHERE chartevents.chartevents.key = 10000032 ) AS T1 WHERE T1.C1 = 1 )",[],False,0.0,0.0010077953338623047,0,no such column: chartevents.chartevents.key,,,
571b776d0c624ec21b51af31,Has patient 10024043 had any organisms detected in his first mrsa screen microbiology test since 1 year ago?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT COUNT(*)>0 FROM microbiologyevents WHERE organisms_detected = 'mrsa' AND patients.d_icd_procedures_icd_codes = procedures_icd_codes.icd_codes AND procedures_icd_codes.long_title = 'mrsa screen' AND patients.chartitems.valuenum = 10024043 AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY patients.chartitems.valuenum",[{'COUNT(*)>0': 0}],False,0.0,0.0010256767272949219,0,no such column: organisms_detected,,,
8188f6370eb20b529ef916f2,"Among the patients who were prescribed alprazolam, what are the five most frequently prescribed drugs at the same time in this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alprazolam' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT d.drug FROM   (   SELECT   t1.subject_id, t1.drug FROM   (   SELECT   subject_id,       drug,       d_icd_procedures_icd_icd_products_drugs_time       FROM   (       SELECT   subject_id,       drug,       strftime('%Y',starttime)       FROM   prescriptions       WHERE   drug = 'alprazolam' ) AS t1       JOIN   (       SELECT   subject_id,       drug,       d_icd_procedures_icd_icd_products_drugs_time       FROM   (       SELECT   subject_id,       drug,       strftime('%Y',starttime)       FROM   prescriptions       WHERE   drug = 'alprazolam' ) AS t1       JOIN   d_icd_procedures_icd_icd_products_drugs_time ON t1.subject_id = d_icd_procedures_icd_icd_products_drugs_time.subject_id ) AS t2 ON t1.subject_id = t2.subject_id WHERE   t1.d_icd_procedures_icd_icd_products_drugs_time = t2.d_icd_procedures_icd_icd_products_drugs_time ) AS t1 GROUP BY   t1.subject_id HAVING   MIN(t1.start",[],False,0.0,0.0006589889526367188,0,incomplete input,,,
ba93c08f689f2e3af0763012,What is the number of times that patient 10004733 visited the hospital in 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004733 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(*) FROM microbiologyevents WHERE patientid = 10004733 AND stromy = 'hospital' AND strftime('%Y',charttime) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],False,0.0,0.0009801387786865234,0,no such column: patientid,,,
04f2923c808564e420f2e7be,"In 10/this year, when was the last time patient 10037861 was prescribed 5% dextrose and pantoprazole at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10037861 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10037861 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MIN(T1.starttime) FROM prescription AS T1 WHERE T1.drug = '5% dextrose' AND T1.hadm_id = 10037861 AND datetime(T1.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',T1.starttime) = '10' EXCEPT SELECT MIN(T2.starttime) FROM prescription AS T2 WHERE T2.drug = 'pantoprazole' AND T2.hadm_id = 10037861 AND datetime(T2.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',T2.starttime) = '10'",[],False,0.0,0.0011019706726074219,0,no such table: prescription,,,
3ec03a348a536f8a80e9d54e,Please list the yearly average volume of chest tube #1 that was output by patient 10019172 since 09/2100.,"SELECT AVG(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'chest tube #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-09' GROUP BY strftime('%Y',outputevents.charttime)","SELECT AVG(d_icd_procedures.charttime - l_icd_procedures.charttime) AS avg_value FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '13.99' AND d_icd_procedures.charttime >= datetime(current_time,'start of year') - interval 0 year AND d_icd_procedures.hadm_id IN ( SELECT l_icd_procedures.hadm_id FROM l_icd_procedures WHERE l_icd_procedures.icd_code = '13.99' AND l_icd_procedures.charttime >= datetime(current_time,'start of year') - interval 0 year ) GROUP BY strftime('%Y',d_icd_procedures.charttime)",[],False,0.0,0.0011031627655029297,0,"near ""0"": syntax error",,,
e3a4b21b27f381659b9997bb,What were the three diagnoses with the lowest 3-month survival rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY AVG(CASE WHEN t1.outtime - t1.intime <= 3 * 365 / 12 THEN 0 ELSE 1 END) ASC ) as C1 FROM ( SELECT ke.outtime, ke.intime, pe.icd_code FROM ( SELECT * FROM microbiologyevents WHERE stu.subject_id IN ( SELECT o.stu.subject_id FROM outcomes AS o WHERE o.stu.hadm_id IS NOT NULL ) ) AS ke JOIN ( SELECT * FROM microbiologyevents WHERE stu.subject_id IN ( SELECT o.stu.subject_id FROM outcomes AS o WHERE o.stu.hadm_id IS NOT NULL ) ) AS pe ON ke.stu.subject_id = pe.stu.subject_id WHERE ke.outtime IS NOT NULL AND pe.outtime IS NOT NULL AND ke.intime < pe.intime AND datetime(pe.intime) BETWEEN datetime(ke.outtime) AND datetime(ke.outtime) + interval 3 * 365 / 12 day GROUP BY ke.outtime, ke.intime, pe.icd_code",,False,0.0,0.0005743503570556641,0,incomplete input,,,
08bd537529e959a773c05e95,Count the number of occasions in 2100 when patient 10019777 received injection or infusion of thrombolytic agent.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection or infusion of thrombolytic agent' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM thrombolytic_agent WHERE patient_id = 10019777 AND strftime('%Y',thrombolytic_agent.starttime) = '2100'",,False,0.0,0.0009632110595703125,0,no such table: thrombolytic_agent,,,
f9a4d8f655bc4658ff929dab,"Can you list the top three most frequent procedures that patients received in the same hospital encounter after having reposition left maxilla with external fixation device, percutaneous approach?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime, admissions.row_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) ) AS T1 JOIN ( SELECT procedures.subject_id, procedures.icd_code, procedures.charttime, admissions.row_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.row_id = admissions.row_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,False,0.0,0.0006558895111083984,0,"unrecognized token: ""'reposition left maxilla with extern""",,,
833f3dcc0c1a68ee5c293d02,Did patient 10022041 have any diagnosis in their last hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.gender = ( SELECT admissions.gender FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.pid = 10022041 ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],False,0.0,0.0007371902465820312,0,incomplete input,,,
8bca7f05d41683561e862158,Tell me the total number of patients in the psychiatry in this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'psychiatry' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age >= 18 AND patients.age < 85 AND patients.dod IS NULL AND strftime('%Y',patients.admittime) = '2100' EXCEPT SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age >= 18 AND patients.age < 85 AND patients.dod IS NULL AND strftime('%Y',patients.admittime) = '2100' AND patients.hospid IN ( SELECT admissions.hospid FROM admissions WHERE admissions.age >= 18 AND admissions.age < 85 AND admissions.dod IS NULL AND strftime('%Y',admissions.admittime) = '2100' AND admissions.spec_type_desc = 'psychiatry' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0006463527679443359,0,"near ""I"": syntax error",,,
f7f4b0b9f1896ea6f3965250,Can you tell me the number of patients that were in the psychiatry careunit since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'psychiatry' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.careunit_desc = 'psychiatry' AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0010309219360351562,0,no such column: admissions.careunit_desc,,,
0a6ec0b4e779434a9be2f99d,What is the name of the procedure that patient 10021938 underwent two or more times in 11/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-11' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",SELECT COUNT(*)>1 FROM microbiologyevents WHERE patientid = 10021938 AND charttime >= '2100-11-01' AND charttime < '2100-12-01' GROUP BY organism,,False,0.0,0.0009586811065673828,0,no such column: patientid,,,
792de6c119e764058112ee54,What was patient 10027445's last output since 06/05/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT d.output FROM labevents d WHERE d.patient_id = 10027445 AND d.charttime >= '2100-06-05' ORDER BY d.charttime DESC LIMIT 1,[{'label': 'Foley'}],False,0.0,0.001003265380859375,0,no such column: d.output,,,
9a126c3d410cde7047840e30,What was the average heart rate on last month/25 for patient 10007058?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '25'","SELECT AVG(d_icd_procedures.charttime - adm.dischtime) AS AVG_value FROM d_icd_procedures JOIN patients ON d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 ) JOIN admissions ON d_icd_procedures.hadm_id = admissions.hadm_id WHERE d_icd_procedures.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.icd_code = 'J3300' ) AND admissions.age = 50 AND datetime(admissions.admittime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY d_icd_procedures.hadm_id",[{'AVG(chartevents.valuenum)': None}],False,0.0,0.0007112026214599609,0,"unrecognized token: ""'s""",,,
3b811de97455513816713b43,Show me the yearly minimum magnesium sulfate (bolus) input of patient 10036156.,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)",SELECT MIN(d_icd_procedures_icd_items.input) FROM d_icd_procedures_icd_items WHERE d_icd_procedures_icd_items.long_title = 'magnesium sulfate (bolus)' AND d_icd_procedures_icd_items.mimic_mapping = 'input' EXPLAIN SELECT MIN(input) FROM input_events WHERE input_events.itemid IN ( SELECT d_icd_procedures_icd_items.itemid FROM d_icd_procedures_icd_items WHERE d_icd_procedures_icd_items.long_title = 'magnesium sulfate (bolus)' AND d_icd_procedures_icd_items.mimic_mapping = 'input' ) AND input_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.careplan_row_id FROM transfers WHERE transfers.row_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.careplan_row_id FROM transfers WHERE transfers.row_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 10036156 AND chartevents.itemid IN ( SELECT d_icd_procedures_icd,[],False,0.0,0.001102447509765625,0,"near ""EXPLAIN"": syntax error",,,
1254335c726bad61fe05f86b,"What was the name of the drug patient 10021118 was prescribed for within 2 days after having undergone a bypass coronary artery, two arteries from coronary artery, open approach procedure since 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT d.drug FROM prescriptions d WHERE d.hadm_id IN ( SELECT p.hadm_id FROM procedures p WHERE p.label = 'bypass coronary artery, two arteries from coronary artery, open approach' AND p.charttime >= datetime(current_time,'-3 year') AND p.hadm_id IN ( SELECT m.hadm_id FROM microbiology m WHERE m.spec_type_desc = 'blood culture' AND datetime(m.charttime) BETWEEN datetime(p.charttime) AND datetime(p.charttime,'+2 day') ) AND p.person_id = ( SELECT w.person_id FROM d_icd_procedures w WHERE w.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' AND w.icd_code = p.icd_code ) ) AND d.hadm_id IN ( SELECT e.hadm_id FROM labevents e WHERE e.spec_type_desc = 'blood culture' AND datetime(e.charttime) BETWEEN datetime(p.charttime) AND datetime(p.charttime,'+2 day') ) AND d.person_id = ( SELECT w.person_id FROM d_icd_procedures w WHERE w.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' AND w.icd_code = p.icd_code ) AND d.person_id = 100",,False,0.0,0.0005292892456054688,0,incomplete input,,,
e6ab1bc462921776329e8d65,Was patient 10027602 in the hospital in the last year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10027602 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age>=50 AND patients.gender='male' AND patients.charttime >= datetime(current_time,'-1 year') )",[{'COUNT(*)>0': 0}],False,0.0,0.0009610652923583984,0,no such column: patients.hadm_id,,,
ff935574170a15f329581c0e,What are the top three commonly treatments for patients who are 40s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.drug FROM ( SELECT drugs.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures JOIN patients ON procedures.subject_id = patients.subject_id JOIN microbiologyevents ON procedures.subject_id = microbiologyevents.subject_id JOIN d_icd_procedures ON procedures.procedure_icd_code = d_icd_procedures.icd_code WHERE d_icd_procedures.long_title = 'administration of other drugs' AND patients.age BETWEEN 40 AND 49 AND strftime('%Y',procedures.charttime) = '2100' GROUP BY drugs.drug ) AS T1 WHERE T1.C1 <= 3",,False,0.0,0.00047087669372558594,0,incomplete input,,,
fb2fc2ad15a779e94e21d070,How much time in days has passed since the last time patient 10021487 was prescribed vancomycin on this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'vancomycin' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT DISTINCT T1.d_icd_procedures_icd_title FROM ( SELECT procedures_icd_time, procedures_icd_rowsAffected FROM procedures_icd WHERE procedures_icd_subject_id = 10021487 AND procedures_icd_icd_code = '11' AND procedures_icd_hadm_id IN ( SELECT admissions_hadm_id FROM admissions WHERE admissions_subject_id = 10021487 AND admissions_dischtime IS NULL ) ) AS T1 JOIN ( SELECT procedures_icd_time, procedures_icd_rowsAffected FROM procedures_icd WHERE procedures_icd_subject_id = 10021487 AND procedures_icd_icd_code = '11' AND procedures_icd_hadm_id IN ( SELECT admissions_hadm_id FROM admissions WHERE admissions_subject_id = 10021487 AND admissions_dischtime IS NULL ) ORDER BY procedures_icd_time ASC ) AS T2 ON T1.procedures_icd_rowsAffected = T2.procedures_icd_rowsAffected WHERE T1.procedures_icd_time < T2.procedures_icd_time ORDER BY T1.procedures_icd_time DESC LIMIT 1",[],False,0.0,0.0006196498870849609,0,incomplete input,,,
025c400c41ad7c9b0b92dc06,Count the number of times that patient 10007818 took glucerna 1.5 (full) on the first ICU visit.,SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'glucerna 1.5 (full)' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10007818 AND organism_name = 'glucerna 1.5 (full)' AND stay_id IN ( SELECT MIN(stay_id) FROM patients WHERE patients.subject_id = 10007818 ),[{'COUNT(*)': 0}],False,0.0,0.0008697509765625,0,no such column: patient_id,,,
2a440dee395beb895cb930f1,What is the three most frequently given microbiology tests since 1 year ago for patients who were previously diagnosed with cervical spondylosis without myelopathy within the same hospital visit?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cervical spondylosis without myelopathy' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, admissions.chartevents_event_id FROM admissions WHERE admissions.admissions.dischtime IS NOT NULL AND datetime(admissions.admissions.admittime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents_labevents_event_id FROM admissions WHERE admissions.admissions.dischtime IS NOT NULL AND datetime(admissions.admissions.admittime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chartevents_event_id < T2.labevents_labevents_event_id AND datetime(T1.chartevents.charttime) >= datetime(current_time,'-1 year') AND datetime(T2.labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY T2.test_name ) AS T1 WHERE T1.C1 <= 3",,False,0.0,0.0005216598510742188,0,incomplete input,,,
f6f7ea6d73b8b83013dc2f03,"For patients who underwent percutaneous abdominal drainage this year, what were the top five most frequent procedures that followed in the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T",,False,0.0,0.0005819797515869141,0,incomplete input,,,
cdc870bf47f6134dbbc3cf55,Has the or cell saver intake been given to patient 10011398 since 07/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-07'",SELECT COUNT(*)>0 FROM microbiologyevents WHERE organism = 'or cell saver' AND patient_id = 10011398 AND charttime >= '2100-07-01',[{'COUNT(*)>0': 0}],False,0.0,0.0009610652923583984,0,no such column: organism,,,
bc59581d2cf65c641d9a1d76,How many patients in the hospital are there currently?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.dischtime IS NULL;,[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009291172027587891,0,no such column: patients.dischtime,,,
68b586764cc7071b73a27296,Can you tell me the output that patient 10035185 had for the last occurrence since 01/16/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-16' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT d.output FROM labevents d WHERE d.patient_id = 10035185 AND d.charttime >= '2100-01-16' ORDER BY d.charttime DESC LIMIT 1,[{'label': 'Foley'}],False,0.0,0.0007939338684082031,0,no such column: d.output,,,
b7f96cf1be01ab41394d3489,How many patients died during the same month after having been diagnosed since 1 year ago with acute on chronic diastolic (congestive) heart failure?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic (congestive) heart failure' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime) >= datetime(current_time,'-1 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod) >= datetime(current_time,'-1 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE datetime(T2.charttime,'start of month') = datetime(T3.dod,'start of month')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 1 * 365.25 AND admissions.admission_location = 'home' AND admissions.spec_type_desc = 'acute on chronic diastolic (congestive) heart failure' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') EXCEPT SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 1 * 365.25 AND admissions.admission_location = 'home' AND admissions.spec_type_desc = 'acute on chronic diastolic (congestive) heart failure' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') AND admissions.dischtime IS NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year') AND admissions.dischtime IS NOT NULL AND strftime('%Y-%m',admissions.dischtime) = strftime('%Y-%m',admissions.admittime) GROUP BY strftime('%Y-%m',admissions.dischtime) ORDER BY strftime('%Y-%m',admissions.dischtime) ASC LIMIT 1",,False,0.0,0.0009019374847412109,0,no such column: admissions.admiss,,,
c89653463314d3045e9c1e32,What are the top three most frequent procedures that patients underwent within the same hospital visit after receiving a diagnosis of closed fracture of two ribs.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of two ribs' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time, admissions.admittime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of two ribs' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.chart_time, admissions.admittime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE admissions.dischtime IS NULL ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of day') = datetime(T2.chart_time,'start of day') AND datetime(T1.admittime,'start of day') = datetime(T2.admittime,'start of day') GROUP BY T2.icd_code ) AS T3 WHERE T3.C",,False,0.0,0.0005617141723632812,0,incomplete input,,,
15a9e84696cb054763055092,"Since the first visit of patient 10004733 to the careunit neurology in their current hospital visit, how many hours have elapsed?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers_intime) ) FROM transfers WHERE transfers.careunit = 'neurology' AND transfers.hospital_visit_id IN ( SELECT admissions.current_hospital_visit FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY transfers.intime ASC LIMIT 1",[],False,0.0,0.0009107589721679688,0,no such column: transfers_intime,,,
552b047a4b16894db1150381,When did patient 10039708 receive his last microbiology test during the last hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'microbiology' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT procedures.age FROM procedures WHERE procedures.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.valuenum IS NOT NULL AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT procedures.age FROM procedures WHERE procedures.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.valuenum IS NOT NULL AND labevents.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT procedures.age FROM procedures WHERE procedures.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.valuenum IS NOT NULL AND labevents.hadm_id = 10039708 ) AND procedures.charttime < labevents.charttime ) AND procedures.spec_type_desc = 'microbiology' ) AND admissions.age = ( SELECT procedures.age FROM procedures WHERE procedures.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.valuenum IS NOT NULL AND labevents.hadm_id = 10039708 ) AND procedures,[],False,0.0,0.0007104873657226562,0,incomplete input,,,
48859a4418a3875bf6082407,"What was patient 10005866's first value of bilirubin, total since 03/2100?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime ASC LIMIT 1","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.ethnicity = 'not of hispanic origin' AND admissions.died_time IS NOT NULL ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'bilirubin, total' ) AND labevents.hadm_id = 10005866 AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0007328987121582031,0,incomplete input,,,
ee06998b93ca5610c35e7925,"Has clonidine patch 0.3 mg/24 hr, amlodipine, or 5% dextrose been prescribed for patient 10004733 in this hospital encounter?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'clonidine patch 0.3 mg/24 hr', 'amlodipine', '5% dextrose' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'clonidine patch 0.3 mg/24 hr', 'amlodipine', '5% dextrose' )",[{'COUNT(*)>0': 0}],False,0.0,0.0017998218536376953,0,no such column: admissions.gender,,,
b94d6edc3aae12b1d958fcb5,How many patients since 2100 underwent radical excision of other lymph nodes within the same hospital visit after other repair and plastic operations on bronchus?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair and plastic operations on bronchus' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'radical excision of other lymph nodes' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study a JOIN microbiome_study b ON a.hospital_visit_id = b.hospital_visit_id WHERE a.spec_type = 'bronchus' AND b.spec_type = 'other lymph nodes' AND a.test_time < b.test_time AND a.drug = 'other repair and plastic operations' AND b.drug = 'radical excision' AND strftime('%Y',a.test_time) >= '2100'",,False,0.0,0.0013210773468017578,0,no such table: microbiome_study,,,
75b34f0cc40ad60222a3d432,How was patient 10019777 admitted in terms of admission type for the first time in the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10019777 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1","SELECT admissions.admission_type FROM admissions WHERE admissions.chartevents.charttime IN ( SELECT T1.charttime FROM ( SELECT chartevents.charttime, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.chartevents.key = 10019777 ) AS T1 WHERE T1.C1 = 1 )",[{'admission_type': 'EW EMER.'}],False,0.0,0.0018634796142578125,0,no such column: chartevents.chartevents.key,,,
c747e1b668edc722be015e38,When was the first time patient 10020740 was prescribed a medication via the ih route in 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'ih' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT medications.starttime FROM medications WHERE medications.hcpcshcpcs_desc = 'ih' AND medications.charttime >= '2100-07-01' AND medications.charttime < '2100-08-01' AND medications.subject_id = 10020740 ORDER BY medications.starttime ASC LIMIT 1,[],False,0.0,0.0016870498657226562,0,no such table: medications,,,
5be97a0dfd0141a05af0b00e,Count the number of patients who were diagnosed with irritable bowel syndrome but didn't come back to the hospital within 2 months since 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'irritable bowel syndrome' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'irritable bowel syndrome' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) >= '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT t1.row_id ) FROM ( SELECT d_icd_procedures.key_patient_encounter FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'irritable bowel syndrome' AND d_icd_procedures.charttime >= '2100-01-01' ) AS t1 JOIN ( SELECT d_icd_procedures.key_patient_encounter FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'irritable bowel syndrome' AND d_icd_procedures.charttime >= '2100-01-01' ) AS t2 ON t1.key_patient_encounter = t2.key_patient_encounter WHERE datetime(t1.charttime) < datetime(t2.charttime) AND datetime(t2.charttime) BETWEEN datetime(t1.charttime) AND datetime(t1.charttime,'+2 month')",,False,0.0,0.0012004375457763672,0,incomplete input,,,
e7f9ba08efb72fdfd7f40122,"How many instances of drainage of left pleural cavity, percutaneous approach, diagnostic have there been in the last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.key_icd = ( SELECT icd_icd.key_icd FROM icd_icd WHERE icd_icd.icd_code = '0JH0J0Z' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,False,0.0,0.0016827583312988281,0,no such table: icd_icd,,,
9ed380731316b97f5b4cc772,"After being diagnosed with personal history of noncompliance with medical treatment, presenting hazards to health in 2100, how many patients received a diagnosis of blood in stool within 2 months?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of noncompliance with medical treatment, presenting hazards to health' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'blood in stool' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_stool_test AS a WHERE a.test_time >= '2100-01-01' AND a.test_time < '2101-01-01' AND a.phenotype = 'personal history of noncompliance with medical treatment, presenting hazards to health' EXCEPT SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_stool_test AS a WHERE a.test_time >= '2100-01-01' AND a.test_time < '2101-01-01' AND a.phenotype = 'personal history of noncompliance with medical treatment, presenting hazards to health' AND a.spec_type_desc = 'blood in stool' AND datetime(a.test_time) BETWEEN datetime(a.test_time) - interval '2' month AND datetime(a.test_time) - interval '0' month",,False,0.0,0.0015454292297363281,0,no such table: microbiome_stool_test,,,
1dffdf5fe800e0b9a0dcf1b3,Has patient 10005866 been in the hospital?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866,SELECT COUNT(*)>0 FROM hospital_stays WHERE hospital_stays.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.long_title = 'daily hospital admissions' ) AND chartevents.valuenum = 1 AND chartevents.charttime IS NOT NULL ) AND hospital_stays.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10005866 ) AND hospital_stays.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10005866 ),[{'COUNT(*)>0': 1}],False,0.0,0.0012505054473876953,0,incomplete input,,,
eb33e90dbcfbca0c0e049512,"How many patients underwent reopening of recent thoracotomy site within the same month after the diagnosis with other acute postoperative pain, since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other acute postoperative pain' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reopening of recent thoracotomy site' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 18 AND admissions.admission_type_desc = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100' EXCEPT SELECT T1.subject_id FROM ( SELECT admissions.subject_id, procedures.charttime FROM admissions JOIN procedures ON admissions.subject_id = procedures.subject_id WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 18 AND admissions.admission_type_desc = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100' AND procedures.label = 'reopening of recent thoracotomy site' ) AS T1 JOIN ( SELECT admissions.subject_id, d_icd_procedures.long_title, procedures.charttime FROM admissions JOIN procedures ON admissions.subject_id = procedures.subject_id WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 18 AND admissions.admission_type_desc = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100' AND procedures.label = 'other acute postoperative pain' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month')",,False,0.0,0.0009515285491943359,0,"unrecognized token: ""'""",,,
851cd4dfcd01e3388de0e514,"Among those who were prescribed with pseudoephedrine, what are the three most commonly prescribed drugs at the same time in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pseudoephedrine' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT d.drug FROM   (   SELECT   t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   (       SELECT   u1.subject_id, lo1.starttime   FROM   labevents lo1       WHERE   lo1.itemid IN (       SELECT   DISTINCT t2.itemid       FROM   (         SELECT   u2.subject_id, lo2.starttime       FROM   labevents lo2       WHERE   lo2.itemid IN (         SELECT   DISTINCT t3.itemid         FROM   d_icd_procedures t3         WHERE   t3.long_title = 'pseudoephedrine'         )       ) AS u2       JOIN labevents lo2 ON u2.subject_id = lo2.subject_id       WHERE   u2.starttime BETWEEN lo2.starttime - 1 * 24 AND lo2.starttime + 0 * 24       ) AS t1       JOIN   (       SELECT   u3.subject_id, rx1.starttime       FROM   d_icd_procedures u3       JOIN   prescription rx1 ON u3.subject_id = rx1.subject_id       WHERE   u3.long_title = 'pseudoephedrine'       ) AS t2 ON t1.subject",[],False,0.0,0.0007221698760986328,0,incomplete input,,,
b5aa101f3fdc45028cfa04f1,What percentile rank does a lactate test value of 2.3 have among patients of the same age as patient 10004422 during the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.3","SELECT DISTINCT T1.C1 FROM ( SELECT patients.age, labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents JOIN patients ON labevents.subject_id = patients.subject_id WHERE labevents.itemid IN ( SELECT procedure_icd_items.itemid FROM procedure_icd_items WHERE procedure_icd_items.icd_code = 'lactate' ) AND patients.gender = 'male' AND patients.age = ( SELECT patients.age FROM patients WHERE patients.gender = 'male' AND patients.subject_id = 10004422 ) AND labevents.charttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.gender = 'male' AND admissions.subject_id = 10004422 ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T1 WHERE T1.valuenum = 2.3",,False,0.0,0.0006399154663085938,0,incomplete input,,,
e1f82dce913d0a344d686dcb,What was the total mediastinal output in the last ICU visit that patient 10005817 had?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'mediastinal' AND d_items.linksto = 'outputevents' ),SELECT SUM(medications.dose_val_rx) FROM medications WHERE medications.hcpc_proc_desc = 'mediastinal output' AND medications.hcpc_proc_desc IS NOT NULL AND medications.hcpc_proc_desc <> '' AND medications.charttime >= ( SELECT admissions.outtime FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.admission_location = 'intensive care unit' ORDER BY admissions.outtime DESC LIMIT 1 ),[{'SUM(outputevents.value)': None}],False,0.0,0.0012729167938232422,0,no such table: medications,,,
e4e38f5cdc7fa7972dbcbfcd,When did patient 10019172 leave the hospital the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT hospital_discharges.charttime FROM hospital_discharges WHERE hospital_discharges.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10019172 ) AND hospital_discharges.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10019172 ) ORDER BY hospital_discharges.charttime DESC LIMIT 1,[],False,0.0,0.0012998580932617188,0,no such table: hospital_discharges,,,
60fbb0d233ccfd0e7297749b,What were the five most frequent diagnoses that occurred in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT icd_diagnoses_icd_procedures.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM icd_diagnoses_icd_procedures WHERE strftime('%Y',icd_diagnoses_icd_procedures.charttime) = '2100' GROUP BY icd_diagnoses_icd_procedures.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,False,0.0,0.0011475086212158203,0,no such table: icd_diagnoses_icd_procedures,,,
d704f27fd79c99e4a27f1581,Count the number of medicines that patient 10026354 was prescribed in 11/this year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug IN (   SELECT prescriptions.drug FROM prescriptions   WHERE prescriptions.hadm_id IN (   SELECT chartevents.hadm_id   FROM chartevents   WHERE chartevents.itemid IN (   SELECT chartitems.itemid   FROM chartitems   WHERE chartitems.label = 'patient 10026354' ) ) ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11'",[{'COUNT(*)': 0}],False,0.0,0.0013248920440673828,0,no such table: chartitems,,,
5437dceb1f465a249b318f40,How many hours have there been since patient 10039831's admission to the hospital?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.chartevents_icustays_patientid IN ( SELECT icustays.patientid FROM icustays WHERE icustays.outtime IS NULL ) AND transfers.chartevents_icustays_patientid = 10039831",[],False,0.0,0.0010666847229003906,0,no such column: icustays.patientid,,,
d08bcacce107729b3e15f70b,"Among patients who received partial hepatectomy since 1 year ago, what are the top three most common diagnoses that followed afterwards within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.label = 'partial hepatectomy' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') GROUP BY admissions.subject_id HAVING MIN(procedures.charttime) = procedures.charttime ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses WHERE datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') GROUP BY admissions.subject_id, diagnoses.icd_code HAVING MIN(diagnoses.charttime) = diagnoses.charttime ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,False,0.0,0.0006651878356933594,0,incomplete input,,,
cbfc8721f283a1c8bc8a32fb,What was the insurance that patient 10013049 had on the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime >= current_time - 1 * 365 * 24 * 60 * 60 ) GROUP BY procedures_icd.icd_code HAVING MAX(chartevents.charttime) >= current_time - 1 * 365 * 24 * 60 * 60 ),[{'insurance': 'Other'}],False,0.0,0.0006506443023681641,0,incomplete input,,,
a12d2706258e7cd94b157f13,How many times did patient 10021487 stay in ICU?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ),SELECT COUNT(*) FROM microbiologyevents WHERE patientid = 10021487,[{'COUNT( DISTINCT icustays.stay_id )': 2}],False,0.0,0.001058816909790039,0,no such column: patientid,,,
dd025c270eae097731034a6c,How many hours has it been since patient 10018081 first received a mcv lab test during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT distinct procedures.itemid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10018081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AND labevents.valuenum IS NOT NULL AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10018081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AND labevents.itemid = ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mcv' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10018081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0006268024444580078,0,incomplete input,,,
c639ce3944c3e8b1431b7f0d,When is the first mrsa screen microbiological test on patient 10011398 during their last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mrsa screen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.pid = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,[],False,0.0,0.0005900859832763672,0,incomplete input,,,
a318cf44208857796ab33806,What is the 3-month survival rate for patients diagnosed with other psoriasis?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other psoriasis' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT patients.subject_id, procedures.charttime FROM procedures WHERE procedures.label = 'other psoriasis' AND procedures.spec_type IS NOT NULL ) AS T0 JOIN ( SELECT patients.subject_id, d_icd_procedures.long_title, d_icd_procedures.charttime FROM patients JOIN d_icd_procedures ON patients.age = d_icd_procedures.age WHERE d_icd_procedures.long_title = 'other psoriasis' AND d_icd_procedures.spec_type IS NOT NULL ) AS T1 ON T0.subject_id = T1.subject_id WHERE T0.charttime < T1.charttime AND datetime(T1.charttime) BETWEEN datetime(T0.charttime) AND datetime(T0.charttime,'+3 month') ORDER BY T1.charttime ASC LIMIT 1",,False,0.0,0.0010883808135986328,0,no such table: procedures,,,
790549b711d398fb4ea8bbcb,"What were the five most commonly given microbiology tests for patients who had received excision of right internal mammary artery, percutaneous endoscopic approach before in the same month?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT procedures.drug_name, procedures.charttime FROM procedures WHERE procedures.drug_name = 'excision of right internal mammary artery, percutaneous endoscopic approach' AND procedures.age >= 0 ) AS T2 JOIN ( SELECT microbiology_tests.spec_type_desc, microbiology_tests.charttime FROM microbiology_tests WHERE microbiology_tests.spec_type_desc IS NOT NULL AND microbiology_tests.age >= 0 ) AS T1 ON T2.charttime < T1.charttime WHERE datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T1.spec_type_desc ORDER BY COUNT(*) DESC LIMIT 5",,False,0.0,0.0008921623229980469,0,"unrecognized token: ""'start of """,,,
6c5c8aeb2476c9646d1a2c84,How many hours have gone by since the last time patient 10004733 was diagnosed with hyperosmolality and/or hypernatremia in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperosmolality and/or hypernatremia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers_icustays.subject_id = 10004733 AND transfers_icustays.chartevents_charttime is not null AND transfers_icustays.chartevents_valuenum = 10004733 AND transfers_icustays.chartevents_label = 'hyperosmolality and/or hypernatremia' ) ) FROM transfers_icustays WHERE transfers_icustays.subject_id = 10004733 AND transfers_icustays.chartevents_charttime is not null AND transfers_icustays.chartevents_valuenum = 10004733 AND transfers_icustays.chartevents_label = 'hyperosmolality and/or hypernatremia' ORDER BY transfers_icustays.chartevents_charttime DESC LIMIT 1",,False,0.0,0.0012822151184082031,0,no such table: transfers_icustays,,,
19d0768436838216fd47a301,Could you provide the last care unit for patient 10009049 in their last hospital encounter according to the transfer record?,SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1,"SELECT T1.careunit FROM ( SELECT T2.careunit, DENSE_RANK() OVER ( ORDER BY T2.intime DESC ) AS C1 FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.row_id = 10009049 ) AND admissions.gender = ( SELECT DISTINCT patients.gender FROM patients WHERE patients.row_id = 10009049 ) ) ) AS T1 JOIN ( SELECT * FROM d_icustays WHERE d_icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.row_id = 10009049 ) AND admissions.gender = ( SELECT DISTINCT patients.gender FROM patients WHERE patients.row_id = 10009049 ) ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.spec_type_desc = 'blood culture' AND T1.valuenum IS NOT NULL AND T1.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.label = 'blood culture' ) AND datetime(T1.charttime,'start of day') = datetime(T2.intime,'start of day') ) AS T",[{'careunit': 'Medicine'}],False,0.0,0.0006949901580810547,0,incomplete input,,,
5d5a07118525dfe5b79a0611,Has patient 10026255 had any tests for red blood cells since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'",SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT procedureitems.itemid FROM procedureitems WHERE procedureitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 2100-04 AND patients.gender = 'male' AND patients.subject_id = 10026255 ),[{'COUNT(*)>0': 0}],False,0.0,0.0011603832244873047,0,no such table: procedureitems,,,
d91a86b3f19888f5557a404a,Since 08/2100 has patient 10004733 received a hyaline casts test?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08'",SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT procedureitems.itemid FROM procedureitems WHERE procedureitems.spec_type_desc = 'hyaline casts' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 2100 AND admissions.gender = 'male' AND admissions.pid = 10004733 ),[{'COUNT(*)>0': 0}],False,0.0,0.0011830329895019531,0,no such table: procedureitems,,,
2920bbd6fd0bc33b5dccb46b,What label is associated with epidural bolus (ml)?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'epidural bolus (ml)',SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'epidural bolus (ml)',[],False,0.0,0.0010073184967041016,0,no such column: d_icd_procedures.short_title,,,
c1d91632054e8b6e0c6ddbe3,What were the three most commonly diagnosed conditions in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT icd_diagnoses_icd_procedures.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM icd_diagnoses_icd_procedures WHERE strftime('%Y',icd_diagnoses_icd_procedures.charttime) = '2100' GROUP BY icd_diagnoses_icd_procedures.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,False,0.0,0.0011687278747558594,0,no such table: icd_diagnoses_icd_procedures,,,
512cce50ee8297feb5df8464,"Among patients who received percutaneous abdominal drainage throughout this year, what were the top five most common treatments that were administered within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT subject_id, procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,False,0.0,0.0007927417755126953,0,incomplete input,,,
ec48e6b64115e4e42d084f61,What is the number of patients who died after diagnosis of alcoholic cirrhosis of liver within the same month?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcoholic cirrhosis of liver' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL ) as T3 ON T2.subject_id = T3.subject_id WHERE datetime(T2.charttime,'start of month') = datetime(T3.dod,'start of month')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 40 AND admissions.age < 41 AND admissions.admission_type_desc = 'emergency room' AND admissions.admission_location_desc = 'emergency room' EXCEPT SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 40 AND admissions.age < 41 AND admissions.admission_type_desc = 'emergency room' AND admissions.admission_location_desc = 'emergency room' AND admissions.charttime IN ( SELECT procedures.charttime FROM procedures WHERE procedures.label = 'alcoholic cirrhosis of liver' ) AND admissions.charttime IN ( SELECT procedures.charttime FROM procedures WHERE procedures.label = 'died' ) AND datetime(procedures.charttime,'start of month') = datetime(admissions.charttime,'start of month')",,False,0.0,0.0011897087097167969,0,no such column: admissions.admission_type_desc,,,
f695adacb2c2c0d897a34ec4,What was the drug that was prescribed to patient 10020944 during the same hospital encounter after receiving arterial catheterization in 03/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",SELECT d.drug FROM prescriptions d WHERE d.hadm_id IN ( SELECT a.hadm_id FROM procedures a WHERE a.label = 'arterial catheterization' AND a.charttime IN ( SELECT t1.charttime FROM procedures t1 WHERE t1.label = 'arterial catheterization' AND t1.hadm_id = ( SELECT t2.hadm_id FROM procedures t2 WHERE t2.label = 'arterial catheterization' AND t2.charttime IN ( SELECT m.charttime FROM microbiology m WHERE m.hadm_id = ( SELECT p.hadm_id FROM patients p WHERE p.age = 100 AND p.gender = 'male' AND p.d_icd_procedures = 'arterial catheterization' AND p.charttime IN ( SELECT t3.charttime FROM procedures t3 WHERE t3.label = 'arterial catheterization' AND t3.hadm_id = ( SELECT t4.hadm_id FROM procedures t4 WHERE t4.label = 'arterial catheterization' AND t4.charttime IN ( SELECT l.charttime FROM labevents l WHERE l.hadm_id = ( SELECT o.hadm_id FROM patients o WHERE o.age = 100 AND o.gender = 'male' AND o.d_icd_procedures =,,False,0.0,0.0007631778717041016,0,incomplete input,,,
d04a8f390aa217deadcd1bd1,When was the first time when patient 10027602 received their input on this month/02?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '02' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT hospitalevents.charttime FROM hospitalevents WHERE hospitalevents.stdiag = 'input' AND hospitalevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = hospitalevents.row_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = hospitalevents.row_id ) ) AND datetime(hospitalevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',hospitalevents.charttime) = '02' ORDER BY hospitalevents.charttime ASC LIMIT 1",[],False,0.0,0.0011637210845947266,0,no such table: hospitalevents,,,
647bc08d18cac6dbda791c42,"When was, for the last time in 10/2100, patient 10018845 prescribed a medication via the sc route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT medications.starttime FROM medications WHERE medications.hcpcshcpcs_desc = 'sc route' AND medications.chartevents_icustay_id IN ( SELECT patients.chartevents_icustay_id FROM patients WHERE patients.age >= 18 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = '13.95' ) AND medications.chartevents_itemid IN ( SELECT procedures.chartevents_itemid FROM procedures WHERE procedures.d_icd_procedures_icd_code = '13.95' ) AND strftime('%Y-%m',medications.starttime) = '2100-10' ORDER BY medications.starttime DESC LIMIT 1",[],False,0.0,0.0011174678802490234,0,"near ""O"": syntax error",,,
842de74a9f0719c2f68b9f9f,"Get me the top five most frequent specimens that patients were tested within 2 months after receiving bypass coronary artery, one artery from aorta with autologous venous tissue, open approach since 2100.","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT d_icd_procedures.long_title, COUNT(*) FROM patients JOIN chartevents ON patients.subject_id = chartevents.subject_id JOIN d_icd_procedures ON chartevents.itemid = d_icd_procedures.icd_code WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AND chartevents.charttime >= patients.admittime AND strftime('%Y',chartevents.charttime) >= '2100' GROUP BY d_icd_procedures.long_title ORDER BY COUNT(*) DESC LIMIT 5",,False,0.0,0.0014164447784423828,0,no such column: procedures_icd.long_title,,,
bede0977c8868b145f17fa5e,What was the name of the last specimen test patient 10021938 got since 07/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT procedures.drug FROM procedures WHERE procedures.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.charttime >= datetime(current_time,'-1 year') AND transfers.event_type = 'admission' AND transfers.itemid IN ( SELECT distinct prescriptions.itemid FROM prescriptions WHERE prescriptions.drug = 'patient 10021938' ) ) ORDER BY transfers.charttime ASC LIMIT 1 ) ORDER BY procedures.charttime DESC LIMIT 1",[{'spec_type_desc': 'MRSA SCREEN'}],False,0.0,0.0013489723205566406,0,no such table: procedures,,,
c8edd5309596df31109a68a1,What is the average value of mesothelial cells of patient 10021487 since 04/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'",SELECT AVG(results.valuenum) FROM labresults AS results WHERE results.studycnt = ( SELECT patients.studycnt FROM patients WHERE patients.age >= 18 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = '13.95' ) AND results.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'mesothelial cells' ) AND results.charttime >= '2100-04-01' AND results.studycnt = 10021487,[{'AVG(labevents.valuenum)': None}],False,0.0,0.0012598037719726562,0,no such table: labresults,,,
5614cf0da6a6dc8d7f53e2e4,"In the last ICU stay, what was the average value of heart rate of patient 10019385?",SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ),"SELECT AVG(d_icu_chartevents.chartevents.valuenum) FROM d_icu_chartevents WHERE d_icu_chartevents.hadm_id IN ( SELECT d_icustays.hadm_id FROM d_icustays WHERE d_icustays.age = ( SELECT DISTINCT(TIME_TO_SEC(TIMEDIFF(current_time,'2100-01-01 00:00:00'))/3600/24) FROM dual ) AND d_icustays.gender = 'male' AND d_icustays.admission_location = 'emergency room' AND d_icustays.outtime IS NOT NULL ORDER BY d_icustays.intime DESC LIMIT 1 ) AND d_icu_chartevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'heart rate' )",[{'AVG(chartevents.valuenum)': None}],False,0.0,0.0008215904235839844,0,incomplete input,,,
288822ce7a0817f505ff7846,"Can you tell me the price of a potassium, whole blood lab test?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) )","SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'potassium, whole blood'",,False,0.0,0.0010080337524414062,0,no such table: procedures,,,
f7ef7a140ef208ed6c164772,What was patient 10004235 diagnosed with for the first time since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 2100 AND admissions.gender = 'male' AND admissions.pid = 10004235 ) ORDER BY labevents.charttime ASC LIMIT 1 ),,False,0.0,0.0010442733764648438,0,no such column: admissions.gender,,,
ca849848206d37bc69b35d9d,When did patient 10018501 get the last input since 145 days ago?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND datetime(inputevents.starttime) >= datetime(current_time,'-145 day') ORDER BY inputevents.starttime DESC LIMIT 1","SELECT hospitalevents.charttime FROM hospitalevents WHERE hospitalevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND hospitalevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'input' ) AND datetime(hospitalevents.charttime) >= datetime(current_time,'-145 day') ORDER BY hospitalevents.charttime DESC LIMIT 1",[{'starttime': '2141-08-01 19:44:00'}],False,0.0,0.0011937618255615234,0,no such table: hospitalevents,,,
0eba370644940aed20760324,What was the name of the drug that patient 10006580 was first prescribed via a sc route in their first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT d.drug FROM prescription AS p JOIN drug d ON p.drug = d.drug_name WHERE p.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.age IS NOT NULL AND admissions.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.label = 'other cardiac catheterization' ) ) ORDER BY admissions.admittime ASC LIMIT 1 ) AND p.route = 'sc' AND p.hadm_id = 10006580 ORDER BY p.starttime ASC LIMIT 1,[],False,0.0,0.0006759166717529297,0,incomplete input,,,
310609c75ba9429428209b11,What was the length of stay in days for patient 10002495 during the first ICU stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT DISTINCT w1.value_from_float FROM microbiologyevents AS w1 WHERE w1.hadm_id IN ( SELECT t1.hadm_id FROM ( SELECT o.hadm_id, d.icustay_id FROM ( SELECT p.hadm_id, p.age FROM patients AS p WHERE p.age >= 50 AND p.gender = 'male' AND p.dod IS NOT NULL AND strftime('%Y',p.dod) >= '2100' ) AS o JOIN ( SELECT d.hadm_id, d.icustay_id FROM ( SELECT h.hadm_id, h.icustay_id, d.diagnoses_icd FROM diagnoses d JOIN ( SELECT m.hadm_id, m.icustay_id FROM patients m WHERE m.age >= 50 AND m.gender = 'male' AND m.dod IS NOT NULL AND strftime('%Y',m.dod) >= '2100' ORDER BY m.icustay_id ASC ) AS h ON d.hadm_id = h.hadm_id ) AS d WHERE d.diagnoses_icd = 'I10' ) AS d ON o.hadm_id = d.hadm_id ) AS t1 WHERE t1.icustay_id IN ( SELECT m.icustay_id FROM patients AS m WHERE m.age >= 50","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 5.087511574849486}]",False,0.0,0.0007798671722412109,0,"unrecognized token: ""'male""",,,
40e911a74ca6a562cbd63623,What's the count of extraction of other tooth procedures that happened since 1 year ago?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extraction of other tooth' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.key_icd = ( SELECT icd_icd.key_icd FROM icd_icd WHERE icd_icd.icd_code = 'Z98.3' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,False,0.0,0.0010209083557128906,0,no such table: icd_icd,,,
7f8ee9cd84328b3ac980008b,What is the maximum total hospital cost that has ever included fexofenadine within the same hospital visit?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fexofenadine' ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.drug = 'fexofenadine' GROUP BY procedures.hospital_visit_id ) AS T1,,False,0.0,0.0010721683502197266,0,no such table: procedures,,,
ae564ba44db568a88f5527ac,What is the total cost for patient 10020944's hospital stay throughout this year?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT SUM( hospitalcosts.cost ) FROM hospitalcosts WHERE hospitalcosts.chartkey IN ( SELECT admissions.chartkey FROM admissions WHERE admissions.age >= 0 AND admissions.age < 100 AND admissions.died = 0 AND admissions.month = 1 AND admissions.year = 2100 AND admissions.event_type = 'hospital admission' AND admissions.gender = 'male' AND admissions.age_group = '0-17' AND admissions.insurance = 'medicare' AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ) AND hospitalcosts.event_type = 'hospital admission' AND hospitalcosts.chartkey IN ( SELECT admissions.chartkey FROM admissions WHERE admissions.age >= 0 AND admissions.age < 100 AND admissions.died = 0 AND admissions.month = 1 AND admissions.year = 2100 AND admissions.event_type = 'hospital admission' AND admissions.gender = 'male' AND admissions.age_group = '0-17' AND admissions.insurance = 'medicare' AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ) AND hospitalcosts.stay_id = admissions.stay_id AND hospitalcosts.chartkey IN ( SELECT admissions.chartkey FROM admissions WHERE admissions.age >= 0 AND,,False,0.0,0.0010828971862792969,0,no such table: hospitalcosts,,,
efed4e108b270dda785398e4,Can you name the top five diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY T2.C2 ASC ) AS C3 FROM ( SELECT T1.icd_code, AVG(C1) AS C2 FROM ( SELECT patients.d_icd_diagnoses_icd_code, ( CASE WHEN patients.dischtime IS NOT NULL AND patients.outtime IS NOT NULL THEN datetime(patients.outtime) - datetime(patients.dischtime) ELSE 0 END ) / 86400.0 FROM patients WHERE patients.age BETWEEN 50 AND 60 AND strftime('%Y',patients.admittime) = '2100' GROUP BY patients.d_icd_diagnoses_icd_code ) AS T1 JOIN ( SELECT patients.d_icd_diagnoses_icd_code, AVG(C1) AS C1 FROM ( SELECT patients.d_icd_diagnoses_icd_code, ( CASE WHEN patients.dischtime IS NOT NULL AND patients.outtime IS NOT NULL THEN datetime(patients.outtime) - datetime(patients.dischtime) ELSE 0 END ) / 86400.0 FROM patients WHERE",,False,0.0,0.0007560253143310547,0,incomplete input,,,
202ecadc0d16d2f85f8ad189,Show me the monthly maximum dextrose 5% input of patient 10009035 in their first hospital encounter.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)","SELECT MAX(T1.sum_val) FROM ( SELECT SUM(inputdailytotal.inputamount) AS sum_val FROM inputdailytotal WHERE inputdailytotal.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.gender = 'male' AND admissions.charttime IS NOT NULL AND admissions.died = 0 AND admissions.age >= 50 AND admissions.admission_type = 'emergency' ) ) AND inputdailytotal.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'dextrose 5%' ) GROUP BY inputdailytotal.hadm_id, strftime('%Y-%m',inputdailytotal.charttime) ) AS T1",[],False,0.0,0.0007700920104980469,0,incomplete input,,,
317471edec57125589ff563e,Calculate the duration in days of patient 10002495's stay in the last ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT ( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.charttime = ( SELECT events.charttime FROM events WHERE events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.pid = 10002495 ) AND events.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.valuenum = 0.0 ) ORDER BY events.charttime DESC LIMIT 1 ) ) AND transfers.linksto = 'admissions' ) AND admissions.pid = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 5.087511574849486}]",False,0.0,0.0006539821624755859,0,"near ""O"": syntax error",,,
2cd96b3599e3450802308c45,How many days has it been since patient 10018081's hospital admission?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.chartkey IN ( SELECT procedures.chartkey FROM procedures WHERE procedures.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.valuenum = 10018081 ) ) ORDER BY transfers.intime ASC LIMIT 1",[],False,0.0,0.0011301040649414062,0,no such table: procedures,,,
ed844ec6192fdc9f7e85ebb3,"Among patients who received a other diagnostic procedures on lung or bronchus procedure , what were the three most frequent microbiology tests conducted during the same hospital encounter?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T2.test_name FROM ( SELECT T1.subject_id, T1.charttime, T1.valuenum FROM labevents AS T1 WHERE T1.itemid IN ( SELECT DISTINCT procedurelaboraturytokens.itemid FROM procedurelaboraturytokens WHERE procedurelaboraturytokens.label = 'other diagnostic procedures on lung or bronchus' ) ) AS T1 JOIN ( SELECT T1.subject_id, T1.charttime, T1.test_name FROM labevents AS T1 WHERE T1.itemid IN ( SELECT DISTINCT procedurelaboraturytokens.itemid FROM procedurelaboraturytokens WHERE procedurelaboraturytokens.label = 'microbiology tests' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND strftime('%Y',T1.charttime) = strftime('%Y',T2.charttime) GROUP BY T2.test_name ORDER BY COUNT(*) DESC LIMIT 3",,False,0.0,0.0006847381591796875,0,incomplete input,,,
9cce51057612a8f9dc75a40f,What were the five most common microbiology tests that patients had after undergoing esophagogastroduodenoscopy [egd] with closed biopsy within the same month?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'esophagogastroduodenoscopy [egd] with closed biopsy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",egd,,False,0.0,0.0005590915679931641,0,"near ""egd"": syntax error",,,
1c26aa5ab4b654a27fb0f4a6,When did patient 10021487 first have the maximum value of plasma cells since 26 months ago?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'plasma cells' ) AND datetime(labevents.charttime) >= datetime(current_time,'-26 month') ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'plasma cells' ) AND labevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 26 AND patients.gender = 'male' AND patients.d_icd_procedures = 'other' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],False,0.0,0.0011470317840576172,0,no such table: procedures,,,
7f45ec7922873c06d1b67747,What is the average yearly number of patients who had encounter for palliative care?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for palliative care' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT admission.subject_id ) AS C1 FROM admission WHERE admission.drug = 'encounter for palliative care' GROUP BY strftime('%Y',admission.starttime) ) AS T1",,False,0.0,0.0010325908660888672,0,no such table: admission,,,
ef903edb8d2304b433a243cb,How many hours have there been since patient 10004733's admission to the hospital?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.chartevents_icustays_patientid IN ( SELECT icustays.patientid FROM icustays WHERE icustays.outtime IS NULL ) AND transfers.chartevents_icustays_patientid = 10004733",[],False,0.0,0.0010335445404052734,0,no such column: icustays.patientid,,,
e59eccf79830c0ce43f8ca5c,How much metformin xr (glucophage xr) was prescribed to patient 10016150 first time in 05/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.drug = 'metformin xr (glucophage xr)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(d_icditems.drug) FROM d_icditems WHERE d_icditems.icd_code = ( SELECT d_icstacts.icd FROM d_icstacts WHERE d_icstacts.itemid IN ( SELECT prescriptions.itemid FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.row_id FROM transfers WHERE transfers.charttime >= datetime(current_time,'start of year') AND transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.row_id FROM transfers WHERE transfers.charttime >= datetime(current_time,'start of year') AND transfers.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.pid = 10016150 ) ) ORDER BY transfers.charttime ASC LIMIT 1 ) ) ) ORDER BY transfers.charttime ASC LIMIT 1 ) ) ) ) AND d_icstacts.icd = 'metformin xr (glucophage xr)' AND datetime(d_icstacts.charttime,'start of year') = datetime(current_time,'start of year') AND strftime('%m',d_icstacts.charttime) = '05' ORDER",[],False,0.0,0.0005965232849121094,0,incomplete input,,,
6aea46a3a6bf0c02fb9bd415,What was the last measured value of respiratory rate of patient 10027602 on this month/04?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '04' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT d.valuenum FROM microbiomic_studies d WHERE d.hadm_id IN ( SELECT b.hadm_id FROM microbiomic_labevents b WHERE b.itemid IN ( SELECT DISTINCT c.itemid FROM d_icd_items c WHERE c.long_title = 'respiratory rate' ) AND b.valuenum IS NOT NULL ) AND d.hadm_id = 10027602 AND datetime(d.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',d.charttime) = '04' ORDER BY d.charttime DESC LIMIT 1",[],False,0.0,0.0011551380157470703,0,no such table: microbiomic_studies,,,
0802fd344595ba15c4b3d32b,Count how many patients underwent a microbiological rapid respiratory viral screen & culture test.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' ),SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'microbiological rapid respiratory viral screen & culture' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0010142326354980469,0,no such table: procedures,,,
175e95be4a9b9de2532f300e,Show me the top three most common diagnoses of patients with age in their 20s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",SELECT d.label FROM diagnosis d WHERE d.age BETWEEN 20 AND 29 GROUP BY d.label ORDER BY COUNT(*) DESC LIMIT 3,,False,0.0,0.0009963512420654297,0,no such table: diagnosis,,,
7e7f2de29fe0d6cf726ecfd4,Did patient 10020306 visit the hospital for admission during the last year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020306 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age>50 AND admissions.gender='male' AND admissions.admission_type_desc = 'disch' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT(*)>0': 0}],False,0.0,0.0010433197021484375,0,no such column: admissions.gender,,,
41d96d1ac69af1608ab8e287,Can you list the yearly maximum vital high protein (full) input of patient 10019777?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)","SELECT MAX(d_icd_procedures.long_title) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.charttime IN ( SELECT labevents.charttime FROM labevents WHERE labevents.hemoglobin >= 0.0 AND labevents.itemid IN ( SELECT items.id FROM items WHERE items.label = 'vital high protein (full)' ) AND labevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) ) GROUP BY strftime('%Y',procedures_icd.charttime)",[],False,0.0,0.0007078647613525391,0,incomplete input,,,
91b457d33856fa9e57fd105b,"During the last hospital encounter, what was the age of patient 10008454?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT DISTINCT patients.age FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime >= patients.d_icd_procedures_time ) AND patients.subject_id = 10008454 ORDER BY patients.d_icd_procedures_time DESC LIMIT 1,,False,0.0,0.0010783672332763672,0,no such table: definition,,,
3c3a60ef6ea248ad69d36deb,When was patient 10008287 prescribed for the last time a medication via the pr route since 08/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND prescriptions.route = 'pr' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT medications.starttime FROM medications WHERE medications.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' ) AND medications.route = 'pr' AND strftime('%Y-%m',medications.starttime) >= '2100-08' ORDER BY medications.starttime DESC LIMIT 1",[],False,0.0,0.001065969467163086,0,no such table: medications,,,
916c297dfa63e76557d57bb8,Is patient 10025612's heart rate ever greater than 104.0 on 10/03/2100?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 104.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-03'",SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 10025612 AND valuenum > 104.0 AND datetime >= '2100-10-03',[{'COUNT(*)>0': 0}],False,0.0,0.0010173320770263672,0,no such column: patient_id,,,
7c6bef368aa5ba846c186719,How much of a difference is there in patient 10038999's c-reactive protein last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c-reactive protein' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c-reactive protein' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'c-reactive protein' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'c-reactive protein' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c-reactive protein' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c-reactive protein' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.00104522705078125,0,no such table: procedures,,,
54c7213807ea893bd586bc8a,"Among patients who received reposition left maxilla with external fixation device, percutaneous approach during this year, what were the top four most common treatments that were administered within the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime, admissions.admittime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.charttime, admissions.admittime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.admittime = T2.admittime GROUP BY T2",,False,0.0,0.0006320476531982422,0,"unrecognized token: ""'reposition left maxilla with ext""",,,
fa829a69da2e049d895218f5,What is the number of times that patient 10020786 had pre-admission on 12/04/last year?,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',outputevents.charttime) = '12-04'","SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10020786 AND organism_name = 'pre-admission' AND datetime >= datetime(current_time,'start of year','-1 year') AND datetime(datetime(current_time,'start of year','-1 year'),'+11 month','-18 day') <= datetime(current_time) ORDER BY datetime(current_time,'start of year','-1 year') ASC, microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)': 0}],False,0.0,0.0010614395141601562,0,no such column: patient_id,,,
ba6c7676d03f793bbd5aaf81,Which was the first procedure that patient 10035185 received during their last hospital encounter?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1 ),SELECT procedures.drug FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.age IS NOT NULL AND admissions.gender = 'male' AND admissions.spec_type IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.gender = 'male' AND admissions.spec_type IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures.charttime ASC LIMIT 1,,False,0.0,0.0010309219360351562,0,no such table: procedures,,,
18df1101ddb265b920569563,What are the names of the procedures performed on patient 10020740 two or more times since 14 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-14 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT procedures.drug FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT T1.chartevents_row_id FROM ( SELECT chartevents.chartevents_row_id, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT T2.chartevents_row_id FROM ( SELECT chartevents.chartevents_row_id, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT T3.chartevents_row_id FROM ( SELECT chartevents.chartevents_row_id, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT T4.chartevents_row_id FROM ( SELECT chartevents.chartevents_row_id, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT chartevents.chartevents_row_id FROM chartevents",,False,0.0,0.0005636215209960938,0,incomplete input,,,
7b11c8a07c7b85627d2a9c47,"Count how many times during their first hospital encounter patient 10018423 experienced the bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach procedure.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )","SELECT COUNT(*) FROM procedureevents WHERE procedureevents.chartitem_id IN ( SELECT admissions.chartid FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND procedureevents.label = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach'",[{'COUNT(*)': 0}],False,0.0,0.0009777545928955078,0,no such table: procedureevents,,,
7b7f155abcaed396f4e612b6,Tell me the name of the medication patient 10004720 was first prescribed via iv route since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT medications.drug FROM medications WHERE medications.hcpcscid = ( SELECT prescriptions.hcpcscid FROM prescriptions WHERE prescriptions.subject_id = 10004720 AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1 )",[],False,0.0,0.0009205341339111328,0,no such table: medications,,,
42ab3ab91a8cfe3fa02ec9f2,Retrieve the top five most frequent procedures that patients underwent in the same month after being diagnosed with intermediate coronary syndrome.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intermediate coronary syndrome' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT subject_id, admissions.charttime FROM admissions WHERE admissions.dischtime IS NOT NULL ORDER BY admissions.charttime ASC ) AS t1 JOIN ( SELECT subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intermediate coronary syndrome' ) ORDER BY diagnoses.charttime ASC ) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.charttime < t2.charttime GROUP BY t2.icd_code ) AS t3 WHERE t3.c1 <= 5 ) ORDER BY d_icd_procedures.long_title ASC LIMIT 5",,False,0.0,0.0019218921661376953,0,incomplete input,,,
964217a388912122a2c89866,"Tell me patient 10020944's average calcium, total value in 03/2100?","SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'","SELECT AVG(d_icd_procedures_icd_items.charttime - patients.charttime) FROM d_icd_procedures_icd_items, patients WHERE patients.age BETWEEN 50 AND 60 AND patients.gender = 'male' AND patients.charttime >= datetime(current_time,'start of year') - interval 1 year AND d_icd_procedures_icd_items.icd_code = ( SELECT d_icd_procedures_icd_items.icd_code FROM d_icd_procedures_icd_items WHERE d_icd_procedures_icd_items.long_title = 'insertion of intravenous infusion device into vein, percutaneous approach' ) AND patients.row_id = d_icd_procedures_icd_items.row_id ORDER BY AVG(d_icd_procedures_icd_items.charttime - patients.charttime) ASC LIMIT 1",[{'AVG(labevents.valuenum)': None}],False,0.0,0.0008869171142578125,0,"near ""1"": syntax error",,,
ea018f554b80d642628c416c,Tell me the total ICU visits of patient 10004733 since 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',icustays.intime) >= '2100'","SELECT COUNT(*) FROM icustays WHERE patient_id = 10004733 AND strftime('%Y',intime) >= '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 1}],False,0.0,0.0008916854858398438,0,no such column: patient_id,,,
5c365a198595d213cd5d103a,Has patient 10004733 received any tests for triglycerides in 10/last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycerides' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.charttime IN ( SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.label = 'triglycerides' ) AND labevents.valuenum IS NOT NULL ) AND procedures.spec_type_desc = 'triglycerides' ) AND labevents.charttime IN ( SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.label = 'triglycerides' ) AND labevents.valuenum IS NOT NULL AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10004733 AND admissions.admittime IN ( strftime('%Y-%m-%d',current_time,'-1 year') ) ) ) ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.pid = 10004733 AND admissions.admittime IN ( strftime('%Y-%m-%d',current_time,'-1 year') ) ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month",[{'COUNT(*)>0': 0}],False,0.0,0.0006144046783447266,0,incomplete input,,,
d3f0d98539d2e9134a435816,"On the current hospital visit, how many hours have passed since the first time patient 10021487 was prescribed midazolam?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'midazolam' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', FROM hospitalevents WHERE subject_id = 10021487 AND hospitalevents.label = 'admission' AND hospitalevents.chart_time >= datetime(current_time,'-1 year')) ) FROM hospitalevents WHERE subject_id = 10021487 AND hospitalevents.label = 'prescribe midazolam' AND datetime(hospitalevents.chart_time) >= datetime(FROM hospitalevents WHERE subject_id = 10021487 AND hospitalevents.label = 'admission' AND hospitalevents.chart_time >= datetime(current_time,'-1 year')) ORDER BY hospitalevents.chart_time ASC LIMIT 1",[],False,0.0,0.00060272216796875,0,"near ""FROM"": syntax error",,,
e65c919605b77138aef522fe,What is the name of the procedure done to patient 10019777 two times since 21 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-21 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT procedures.drug FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definitions.linksto FROM definitions WHERE definitions.label = 'patient 10019777' ) ) AND datetime(procedures.starttime) >= datetime(current_time,'-21 month') GROUP BY procedures.drug HAVING count(*) = 2",,False,0.0,0.0010902881622314453,0,no such table: procedures,,,
6e19826cc8478fa8a97d1dee,When was the first time in 07/this year that patient 10007818 had the minimum of tobramycin?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tobramycin' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT MIN(st1.starttime) FROM microbiologyevents AS st1 WHERE st1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' AND admissions.charttime >= datetime(current_time,'start of year') AND datetime(current_time,'start of year','+0 year') = datetime(current_time) ) AND st1.itemid IN ( SELECT definition.row_id FROM d_icd_items AS definition WHERE definition.icd_code = 'j9040' ) AND st1.valuenum = ( SELECT MIN(st2.valuenum) FROM microbiologyevents AS st2 WHERE st2.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' AND admissions.charttime >= datetime(current_time,'start of year') AND datetime(current_time,'start of year','+0 year') = datetime(current_time) ) AND st2.itemid IN ( SELECT definition.row_id FROM d_icd_items AS definition WHERE definition.icd_code = 'j9040' ) ) AND strftime('%Y-%m',st1.charttime) = '2107' GROUP BY st1.hadm_id HAVING st1.hadm_id = ( SELECT admissions.hadm_id",[],False,0.0,0.0005838871002197266,0,incomplete input,,,
4f8edd5ffa577be90e9a0715,What is the average amount of the total hospital cost which involves dependence on supplemental oxygen since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on supplemental oxygen' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM(procedures_icd.cost) AS C1 FROM procedures_icd WHERE procedures_icd.charttime >= '2100-01-01' GROUP BY procedures_icd.charttime, procedures_icd.itemid ) AS T1 WHERE T1.C1 IS NOT NULL",,False,0.0,0.0010290145874023438,0,no such column: procedures_icd.cost,,,
9ab8b4d1a143e09289a29059,What is the maximum metamyelocytes of patient 10038992?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ),SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.stay_id IN ( SELECT microbiologyevents.stay_id FROM microbiologyevents WHERE microbiologyevents.hcpcspc = 'metamyelocytes' ) ) AND labevents.stay_id IN ( SELECT chartevents.stay_id FROM chartevents WHERE chartevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.valuenum IS NOT NULL AND chartevents.hcpcspc = 'metamyelocytes' ) ) AND labevents.charttime < ( SELECT chartevents.charttime FROM chartevents WHERE chartevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.valuenum IS NOT NULL AND chartevents.hcpcspc = 'metamyelocytes' ) ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET ( SELECT COUNT(*) FROM chartevents WHERE chartevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.valuenum IS NOT NULL AND chartevents.hcpcspc = 'metamyelocytes' ) ) - 1 WHERE labevents.stay_id IN ( SELECT chartevents.stay_id FROM chart,[{'MAX(labevents.valuenum)': None}],False,0.0,0.00099945068359375,0,no such column: microbiologyevents.stay_id,,,
5ff41378c47dc43f9ea36aa9,What's the total amount of packed red blood cells that patient 10008454 received on their first ICU stay?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ),SELECT SUM(d_icd_procedures.charttime - l_icd_procedures.charttime) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '11.92' AND d_icd_procedures.charttime >= ( SELECT l_icd_procedures.charttime FROM l_icd_procedures WHERE l_icd_procedures.icd_code = '11.92' AND l_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY l_icd_procedures.charttime ASC LIMIT 1 ) AND d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY d_icd_procedures.charttime ASC LIMIT 1,[{'SUM(inputevents.totalamount)': None}],False,0.0,0.0005612373352050781,0,incomplete input,,,
05a1330cdcd6729af414b7c7,What is the 6-month survival probability for patients living with a other and unspecified angina pectoris diagnosis?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/2 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified angina pectoris' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT patients.subject_id, procedures.d_icd_procedures_icd_icd_link_table_key FROM procedures WHERE procedures.d_icd_procedures_icd_icd_link_table_key IN ( SELECT D_ICD_PROCEDURES_ICD_ICD_LINK_TABLE_KEY FROM d_icd_procedures_icd_icd_link WHERE D_ICD_DIAGNOSES_ICD_ICD_LINK_TABLE_KEY IN ( SELECT D_ICD_DIAGNOSES_ICD_ICD_LINK_TABLE_KEY FROM d_icd_diagnoses_icd_icd_link WHERE d_icd_diagnoses_icd_icd_link.ICD_CODE = ( SELECT d_icd_icd_to_mesh_map.ICD_CODE FROM d_icd_icd_to_mesh_map WHERE d_icd_icd_to_mesh_map.MESH_CODE = ( SELECT d_icd_to_mesh_map.MESH_CODE FROM d_icd_to_mesh_map WHERE d_icd_to_mesh_map.ICD_CODE = ( SELECT d_icd_procedures_icd_icd_link.ICD_CODE FROM d_icd_procedures_icd_icd_link WHERE d_icd_procedures_icd_icd_link.d_icd_diagnoses_icd_icd_link_table_key IS NOT NULL AND d_icd_procedures_icd_icd_link.D",,False,0.0,0.0005586147308349609,0,incomplete input,,,
09e77a973741f315e0526f82,Give me the four most common output events since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT * FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS t1 JOIN d_icd_procedures AS t2 ON t1.spec_type = t2.long_title WHERE t1.spec_type IN ( SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t4.icd_code FROM ( SELECT t3.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT * FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS t1 JOIN d_icd_procedures AS t3 ON t1.spec_type = t3.long_title GROUP BY t3.icd_code ) AS t4 WHERE t4.c1 <= 4 ) ) GROUP BY t2.icd_code ) AS t3 WHERE t3.c1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]",False,0.0,0.0007724761962890625,0,incomplete input,,,
519da8c653b3284432571957,Has there been any results of microbiology tests for the blood culture of patient 10007818 since 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y',microbiologyevents.charttime) >= '2100'",SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 2100 AND patients.gender = 'male' AND patients.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'blood culture',[{'COUNT(*)>0': 0}],False,0.0,0.0011713504791259766,0,no such column: patients.hadm_id,,,
aaa0dd1684e01424ce21edfd,When was the last occasion that patient 10018423 underwent a fluoroscopy of multiple coronary arteries using low osmolar contrast procedure since 1 year ago?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using low osmolar contrast' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT hospital_admissions.admittime FROM hospital_admissions WHERE hospital_admissions.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.valuenum = ( SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.itemid IN ( SELECT procedure_icd_items.itemid FROM procedure_icd_items WHERE procedure_icd_items.icd_code = '00.66' ) AND chartevents.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.valuenum = ( SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.itemid IN ( SELECT procedure_icd_items.itemid FROM procedure_icd_items WHERE procedure_icd_items.icd_code = '00.66' ) ) ) ) ) AND hospital_admissions.age = ( SELECT datetime(age(timestamp('2100-01-01'),hospital_admissions.admittime),'year') FROM hospital_admissions WHERE hospital_admissions.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.valuenum = ( SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.itemid IN ( SELECT procedure_icd_items.itemid FROM procedure_icd_items WHERE procedure_icd_items.icd_code = '00.",,False,0.0,0.0005252361297607422,0,incomplete input,,,
c1a2df83f43de889081a87be,Find the number of patients who had a right heart cardiac catheterization procedure in the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'right heart cardiac catheterization' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,False,0.0,0.0009441375732421875,0,no such table: procedures,,,
849c73c34b291683b2d24907,Tell me the drug that was prescribed to patient 10021487 for the first time through the iv route since 09/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'iv' AND prescriptions.starttime >= '2100-09-01' ORDER BY prescriptions.starttime ASC LIMIT 1,[],False,0.0,0.0009322166442871094,0,no such column: admissions.gender,,,
bed5da859030d9c461ef882a,What was the amount of foley output patient 10038933 has on 09/26/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-09-26'","SELECT SUM(chartevents.valuenum) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.ethnicity = 'not of hispanic origin' AND admissions.admission_type = 'emergency' ) AND chartevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.label = 'insertion of foley catheter' ) AND chartevents.hadm_id = 10038933 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-09-26'",[{'SUM(outputevents.value)': None}],False,0.0,0.0005686283111572266,0,incomplete input,,,
732aa8afc5a1fa558876a572,What is patient 10004235's difference in weight from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT admissions.charttime  FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hospital' ) AND admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hospital' ) ) ORDER BY admissions.charttime ASC LIMIT 1 ) - ( SELECT admissions.charttime  FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hospital' ) AND admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hospital' ) ) ORDER BY admissions.charttime DESC LIMIT 1 ) FROM patients WHERE patients.age = 10004235,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0006487369537353516,0,incomplete input,,,
acf40b3eb276cefbbd1f51be,What is the percentile of 8.0 in urea nitrogen given the same age as patient 10022017 on their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.0",SELECT DISTINCT T1.C1 FROM ( SELECT DISTINCT patients.age FROM patients WHERE patients.charttime IS NOT NULL AND patients.charttime >= patients.d_icd_procedures_start_time AND patients.charttime <= patients.d_icl_d_icd_procedures_end_time AND patients.age IS NOT NULL AND patients.hadm_id IN ( SELECT DISTINCT d_icl_d_icd_procedures_end.hadm_id FROM d_icl_d_icd_procedures_end WHERE d_icl_d_icd_procedures_end.charttime IS NOT NULL AND d_icl_d_icd_procedures_end.charttime >= d_icl_d_icd_procedures_end.d_icd_procedures_start_time AND d_icl_d_icd_procedures_end.charttime <= d_icl_d_icd_procedures_end.d_icd_d_icd_procedures_end_time AND d_icl_d_icd_procedures_end.spec_type_desc = 'blood' AND d_icl_d_icd_procedures_end.itemid = ( SELECT DISTINCT d_icd_procedures.itemid FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'urea nitrogen' ) AND d_icl_d_icd_procedures_end.valuenum = 8.0 ) ORDER BY patients.age ) AS T1 JOIN ( SELECT DISTINCT patients,,False,0.0,0.0005841255187988281,0,incomplete input,,,
524208cb99d72ea26c67c3f9,How many times did patient 10019385 check into the ICU during this year?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM microbiologyevents WHERE patientid = 10019385 AND charttime >= datetime(current_time,'start of year') AND organismname = 'enterococcus faecium'",[{'COUNT( DISTINCT icustays.stay_id )': 0}],False,0.0,0.0009915828704833984,0,no such column: patientid,,,
e796f650518046002c58ee85,Count the number of patients who were diagnosed with hypospadias but didn't come back to the hospital within 2 months in 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypospadias' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypospadias' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) = '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_studies a JOIN diagnoses b ON a.subject_id = b.subject_id WHERE b.charttime >= '2100-01-01' AND b.long_title = 'hypospadias' EXCEPT SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_studies a JOIN diagnoses b ON a.subject_id = b.subject_id WHERE b.charttime >= '2100-01-01' AND b.long_title = 'hypospadias' AND a.event_type = 'discharge' AND datetime(a.event_time) BETWEEN datetime(b.charttime) AND datetime(b.charttime,'+2 month')",,False,0.0,0.0009918212890625,0,no such table: microbiome_studies,,,
89602c70b4db3bc65be1d577,"List the top three most frequent lab tests that patients were given within the same month after being diagnosed with constipation, unspecified in 2100.","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_labitems.itemname FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.label = 'constipation, unspecified' AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime,'start of month') = datetime(T1.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,False,0.0,0.0005900859832763672,0,incomplete input,,,
622ee2e5af88f64d20afb970,"For patients who underwent respiratory ventilation, 24-96 consecutive hours since 2100, what were the five most common diagnoses during the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.label = 'respiratory ventilation' AND strftime('%Y',procedures.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+24 hours') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,False,0.0,0.0005972385406494141,0,incomplete input,,,
56919090958387812584e77a,"Was lisinopril, warfarin, or heparin prescribed for patient 10012853 in their first hospital encounter?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'lisinopril', 'warfarin', 'heparin' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.gender = 'male' AND admissions.age >= 50 AND admissions.d_icd_procedures_icd_id = '10013025' ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND prescriptions.drug IN ( 'lisinopril', 'warfarin', 'heparin' )",[{'COUNT(*)>0': 0}],False,0.0,0.001058340072631836,0,no such column: admissions.charttime,,,
dcc8c7bc0e4f6fed66288c9e,Which patients were diagnosed with accidental fall from bed since 2100?,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental fall from bed' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",SELECT patients.subject_id FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.charttime >= '2100-01-01' AND procedures.value = 'accidental fall from bed' ),,False,0.0,0.0009307861328125,0,no such table: procedures,,,
7bef1a39879d33661976e78e,When did patient 10025463 receive a pt laboratory test for the first time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.careplan_row_id FROM transfers WHERE transfers.row_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 10025463 AND chartevents.charttype = 'daily events' ) ) ) AND admissions.admission_type = 'emergency' ) ORDER BY labevents.charttime ASC LIMIT 1,[],False,0.0,0.0005476474761962891,0,"unrecognized token: ""'daily event""",,,
1757b6190d9346fb05196adf,What was the name of the specimen test that patient 10007818 received since 06/2100 last?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT procedures.drug FROM procedures WHERE procedures.subject_id = 10007818 AND procedures.spec_type_desc = 'specimen test' AND strftime('%Y-%m',procedures.starttime) >= '2100-06' ORDER BY procedures.starttime DESC LIMIT 1",[{'spec_type_desc': 'BLOOD CULTURE'}],False,0.0,0.0009167194366455078,0,no such table: procedures,,,
fe7098870fdbbc057c054fdc,What are the three frequently ordered medications for patients in their 20s?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT drugs.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures JOIN patients ON procedures.subject_id = patients.subject_id JOIN microbiologyevents ON procedures.subject_id = microbiologyevents.subject_id JOIN d_icd_procedures ON procedures.label = d_icd_procedures.long_title JOIN d_icd_diagnoses ON d_icd_procedures.icd_code = d_icd_diagnoses.icd_code_1 JOIN labevents ON d_icd_diagnoses.icd_code = labevents.itemid JOIN drugs ON labevents.itemid = drugs.itemid WHERE d_icd_diagnoses.age = 20 GROUP BY drugs.drug ) AS T1 WHERE T1.C1 <= 3",,False,0.0,0.000553131103515625,0,incomplete input,,,
204b55b1a8a2dbeafa89b76c,Retrieve the yearly maximum l pleural #1 output of patient 10009035.,"SELECT MAX(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'l pleural #1' AND d_items.linksto = 'outputevents' ) GROUP BY strftime('%Y',outputevents.charttime)",SELECT MAX(d_icd_procedures.charttime - l_icd_labitems.charttime) AS result FROM l_icd_labitems JOIN d_icd_procedures ON l_icd_labitems.subject_id = d_icd_procedures.subject_id WHERE l_icd_labitems.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.valuenum IS NOT NULL AND chartevents.charttime IN ( SELECT d_icd_procedures.charttime FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '12.97' ) ) AND d_icd_procedures.icd_code = '12.97' AND d_icd_procedures.subject_id = 10009035 EXPLAIN UNION ALL SELECT MAX(d_icd_procedures.charttime - l_icd_labitems.charttime) AS result FROM l_icd_labitems JOIN d_icd_procedures ON l_icd_labitems.hadm_id = d_icd_procedures.hadm_id WHERE l_icd_labitems.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.valuenum IS NOT NULL AND chartevents.charttime IN ( SELECT d_icd_procedures.charttime FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '12.,[],False,0.0,0.0009577274322509766,0,no such table: l_icd_labitems,,,
56393496dcb520b67b7d21d8,How many patients had a bronchial washings test administered since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'bronchial washings' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'bronchial washings' AND datetime(procedures.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009644031524658203,0,no such table: procedures,,,
a75bc1cf0cdc6921d07386f9,What is the average total cost for a hospital that includes a drug called heparin flush (100 units/ml)?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin flush (100 units/ml)' ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 ) AND procedures.label = 'heparin flush (100 units/ml)' GROUP BY procedures.hadm_id ) AS T1,,False,0.0,0.0009551048278808594,0,no such table: procedures,,,
5c069998e95156db5e7d2e7e,What is the minimum daily number of patients that are suffering from atherosclerotic heart disease of native coronary artery with unstable angina pectoris?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM microbiome_study T1 JOIN ( SELECT subject_id, age, strftime('%Y-%m-%d',admittime) FROM microbiome_study WHERE diagnosis = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) AS T2 ON T1.subject_id = T2.subject_id WHERE strftime('%Y-%m-%d',T1.starttime) = strftime('%Y-%m-%d',T2.admittime) GROUP BY strftime('%Y-%m-%d',T1.starttime) )",,False,0.0,0.0009815692901611328,0,no such table: microbiome_study,,,
f08654b0c2c58546d18b7efb,"Since 16 months ago, what specimen test did patient 10002428 receive for the last time?","SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT procedures.spec_type_desc FROM procedures WHERE procedures.chartkey = 10002428 AND datetime(procedures.charttime) >= datetime(current_time,'-16 month') ORDER BY procedures.charttime DESC LIMIT 1",[{'spec_type_desc': 'SPUTUM'}],False,0.0,0.0011799335479736328,0,no such table: procedures,,,
2fcffbbef2cf3c4109b6345d,Has patient 10007795 had a procedure during this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = 2100 ) AND chartevents.valuenum = 10007795 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,False,0.0,0.0010764598846435547,0,no such table: definition,,,
fa7797af0bc8368e7b76a129,How much do patient 10004733's respiratory rate shifts measured at 2100-12-30 17:00:00 compared to the value measured at 2100-12-30 16:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-30 17:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-30 16:00:00' ),"SELECT ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 ) AND labresults.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'respiratory rate' AND chartitems.valuenum IS NOT NULL ) AND datetime(labresults.charttime) = datetime(current_time,'-1 day','00:17:00') ) - ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 ) AND labresults.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'respiratory rate' AND chartitems.valuenum IS NOT NULL ) AND datetime(labresults.charttime) = datetime(current_time,'-1 day','00:16:00') )","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-30 17:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-30 16:00:00' )"": None}]",False,0.0,0.0008025169372558594,0,incomplete input,,,
ea764357f7772ceb7cc1de9d,Has patient 10019385 visited the emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.admission_location = 'emergency room',"SELECT COUNT(*)>0 FROM emergencyevents WHERE emergencyevents.chartkey IN ( SELECT patients.chartkey FROM patients WHERE patients.age >= 18 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code IS NOT NULL AND patients.d_icd_diagnoses_icd_code IS NOT NULL AND patients.admission_type_desc = 'emergency room' AND patients.age = ( SELECT T1.age FROM ( SELECT patients.age, DENSE_RANK() OVER ( ORDER BY patients.age ) AS C1 FROM patients WHERE patients.age >= 18 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code IS NOT NULL AND patients.d_icd_diagnoses_icd_code IS NOT NULL AND patients.admission_type_desc = 'emergency room' ) AS T1 WHERE T1.C1 = 1 ) ) AND emergencyevents.chartkey = 10019385",[{'COUNT(*)>0': 0}],False,0.0,0.0006184577941894531,0,"unrecognized token: ""'male""",,,
3a512ac7a9cacbb072843d2a,How many people received a insertion or replacement of external ventricular drain [evd] procedure within 2 months after they had been diagnosed with methicillin resistant pneumonia due to staphylococcus aureus since 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin resistant pneumonia due to staphylococcus aureus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiologyevents a JOIN d_icd_procedures b ON a.subject_id = b.subject_id WHERE a.spec_type_desc = 'blood culture' AND a.org_name_desc = 'staphylococcus aureus' AND a.resistant = 'methicillin resistant' AND b.procedure_icd_code = '00.66' AND strftime('%Y',a.charttime) >= '2100' AFTER a.charttime BY 2 MONTH",,False,0.0,0.0012793540954589844,0,"near ""AFTER"": syntax error",,,
f03742a9f076216fb37d4c2b,When was patient 10021938's SaO2 the first time measured greater than 95.0 on last month/02?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 95.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '02' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'SaO2' ) AND labevents.valuenum > 95.0 AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021938 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',labevents.charttime) = '02' ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0009412765502929688,0,no such table: procedures,,,
f430a02bd152c617a86cd2c3,How much is patient 10038933 needed to pay for the cost of their hospital visit in 2100?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',cost.chargetime) = '2100'",SELECT SUM( hospitalcosts.cost ) FROM hospitalcosts WHERE hospitalcosts.chartkey IN ( SELECT patients.chartkey FROM patients WHERE patients.age >= 2100 AND patients.age < 2110 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = ' ' AND patients.d_icd_diagnoses_icd_code = ' ' AND patients.admission_location = ' ' AND patients.dischtime IS NOT NULL AND patients.insurance = ' ' AND patients.careunit = ' ' AND patients.spec_type = ' ' AND patients.d_labitems_icd_code = ' ' AND patients.admission_type = ' ' AND patients.admission_source = ' ' AND patients.gender = ' ' AND patients.age >= 2100 AND patients.age < 2110 AND patients.d_icd_procedures_icd_code = ' ' AND patients.d_icd_diagnoses_icd_code = ' ' AND patients.admission_location = ' ' AND patients.insurance = ' ' AND patients.careunit = ' ' AND patients.spec_type = ' ' AND patients.d_labitems_icd_code = ' ' AND patients.admission_type = ' ' AND patients.admission_source = ' ' ) AND hospitalcosts.event_type = 'hospital' AND hospital,,False,0.0,0.00084686279296875,0,incomplete input,,,
4c5b6d9ba3e9c1e0f82473db,What is the label for ai ncp - problem resolved?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'ai ncp - problem resolved',SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'ai ncp - problem resolved',[],False,0.0,0.0010797977447509766,0,no such column: d_icd_procedures.short_title,,,
e6939ccdd15e65dbd229d411,What is the cost of drug called potassium chl 20 meq / 1000 ml d5lr?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' ),SELECT DISTINCT cost FROM prescription_cost WHERE prescription_cost.drug = 'potassium chl 20 meq / 1000 ml d5lr',,False,0.0,0.0016167163848876953,0,no such table: prescription_cost,,,
91509e2b22c1e7959786b337,When did patient 10009035 first have the maximum level of free calcium during their last hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= current_time - interval '1 year' ) AND labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'free calcium' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],False,0.0,0.0006871223449707031,0,"near ""'1 year'"": syntax error",,,
5d31a8336f838e5062d60d2d,"Has patient 10038999 received the procedure of drainage of left pleural cavity, percutaneous approach, diagnostic in 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10038999 ) AND procedures_icd.label = 'drainage of left pleural cavity, percutaneous approach, diagnostic' AND strftime('%Y',procedures_icd.charttime) = '2100'",,False,0.0,0.0009567737579345703,0,no such table: visits,,,
e9b5ce5bc64083829c90ddd9,What are the four most frequent drugs that were prescribed to female patients in their 50s during the same hospital encounter after they were diagnosed with unspecified essential hypertension in this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT d.drug FROM   (   SELECT   t1.subject_id, t1.starttime   FROM   (   SELECT   microbiologyevents.subject_id, microbiologyevents.charttime   FROM   microbiologyevents   WHERE   microbiologyevents.spec_type_desc = 'blood culture'   AND   microbiologyevents.org_name_desc = 'staphylococcus aureus'   AND   datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')   ) AS t1   JOIN   (   SELECT   microbiologyevents.subject_id, microbiologyevents.charttime   FROM   microbiologyevents   WHERE   microbiologyevents.spec_type_desc = 'blood culture'   AND   microbiologyevents.org_name_desc = 'enterococcus faecalis'   AND   datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')   ) AS t2   ON   t1.subject_id = t2.subject_id   WHERE   datetime(t1.charttime) < datetime(t2.charttime)   ) AS t3   JOIN   (   SELECT   prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id   FROM   prescriptions   WHERE   prescriptions",,False,0.0,0.0007658004760742188,0,incomplete input,,,
1c45da439e97eae264e4d7ce,What does warfarin cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'warfarin' ),SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'warfarin',,False,0.0,0.0008835792541503906,0,no such table: procedures,,,
6985b7163e6c8b9db7102745,Count the number of times that patient 10020740 had tpn w/ lipids since 03/07/2100.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tpn w/ lipids' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-07'","SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10020740 AND microbiologyevents.spec_type_desc = 'tpn w/ lipids' AND strftime('%Y-%m-%d',microbiologyevents.charttime) >= '2100-03-07'",[{'COUNT(*)': 0}],False,0.0,0.0010461807250976562,0,no such column: patient_id,,,
6921a2f2bc13f22b2242fbf5,What's the number of patients who were diagnosed with bite of other animal except arthropod since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bite of other animal except arthropod' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.drug = 'bite of other animal except arthropod' AND strftime('%Y',procedures.starttime) >= '2100' )",,False,0.0,0.0016331672668457031,0,no such table: procedures,,,
675a37ee70bf7108f1389c55,What age was patient 10006580 in their last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT DISTINCT patients.age FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 21004 ) AND chartevents.valuenum IS NOT NULL ) AND patients.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 10020740 ) AND chartevents.valuenum IS NOT NULL ) AND patients.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 10006580 ) ) ORDER BY patients.chartevents_time DESC LIMIT 1,,False,0.0,0.0006577968597412109,0,incomplete input,,,
5c5d37eab2cf65bcaafade09,"Count the number of times that patient 10010471 received the performance of urinary filtration, multiple procedure in the previous year.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of urinary filtration, multiple' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10010471 AND microbiologyevents.spec_type_desc = 'urinary filtration, multiple procedure' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,False,0.0,0.0009183883666992188,0,no such column: patient_id,,,
fdf5fc622de2b8d98e233ad6,What was the drug prescribed to patient 10020740 in 05/2100 for the first time?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT d.drug FROM prescriptions d WHERE d.hadm_id IN ( SELECT t1.hadm_id FROM patients t1 WHERE t1.age >= 50 AND t1.gender = 'male' AND t1.charttime >= '2100-05-01' ) ORDER BY d.starttime ASC LIMIT 1,[],False,0.0,0.0010623931884765625,0,no such column: t1.hadm_id,,,
7ed170e256f209788ad3c985,Has there been any organism found in patient 10008454's last mrsa screen microbiological examination since 03/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*)>0 FROM microbiologyevents WHERE organism = 'mrsa' AND patient_id = 10008454 AND specimen_type = 'other' AND charttime >= '2100-03-01' ORDER BY charttime DESC LIMIT 1,[{'COUNT(*)>0': 0}],False,0.0,0.0009846687316894531,0,no such column: organism,,,
2b4c020024b7a33b31862709,Calculate the total amount of input for patient 10008287 since 05/10/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-10'",SELECT SUM(input) FROM labevents WHERE patient_id = 10008287 AND charttime >= '2100-05-10',[{'SUM(inputevents.totalamount)': 10940.0}],False,0.0,0.0008904933929443359,0,no such column: input,,,
fea7c4750795e9fe070f67ba,What was the average monthly number of patients who were diagnosed with accidental fall from bed this year?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental fall from bed' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM microbiome_study_samples T2 WHERE T2.spec_type_desc = 'accidental fall from bed' AND datetime(T2.intime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m',T2.intime) ) AS T1",,False,0.0,0.0009071826934814453,0,no such table: microbiome_study_samples,,,
66830a78dcd7a98c6df848db,Get me the patient IDs who were diagnosed with acute systolic heart failure since 2100.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute systolic heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT DISTINCT patients.subject_id FROM patients WHERE patients.subject_id IN ( SELECT procedures.on_diagnosis FROM procedures WHERE procedures.label = 'acute systolic heart failure' AND strftime('%Y',procedures.starttime) >= '2100' )",,False,0.0,0.0009005069732666016,0,no such table: procedures,,,
3f4da3a38522ffde6a91dfbf,What is the minimum total cost of the hospital visits when they involve other diagnostic procedures on lung or bronchus since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.label = 'other diagnostic procedures on lung or bronchus' AND strftime('%Y',procedures.charttime) >= '2100' GROUP BY procedures.admittime ) AS T1",,False,0.0,0.0008950233459472656,0,no such table: procedures,,,
08d0d78c62b440d145b0c56d,"What were the four most commonly given diagnoses for patients that had previously received a respiratory ventilation, 24-96 consecutive hours within 2 months, since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.label = 'respiratory ventilation, 24-96 consecutive hours' AND strftime('%Y',procedures.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,False,0.0,0.0005438327789306641,0,incomplete input,,,
6b1fe6a4f18cb1365ffa3764,What are patient 10004720's changes in weight last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'daily weight' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'daily weight' ) ORDER BY labevents.charttime DESC LIMIT 2 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",False,0.0,0.0021178722381591797,0,incomplete input,,,
1353dc68fd8a615fdfb1a80d,What is the cost for diagnosis of other convulsions?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other convulsions' ) ),SELECT DISTINCT w.cost FROM microbiologyevents AS w WHERE w.spec_type_desc = 'other convulsions',,False,0.0,0.0010530948638916016,0,no such column: w.cost,,,
282f008dd8dfb8f4a1dd6999,Tell me the name of the organism that was detected in the last urine test of patient 10027602 on their first hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,"SELECT organisms.org_name FROM organisms WHERE organisms.test_type = 'urine' AND organisms.time = ( SELECT T1.time FROM ( SELECT procedures.charttime, labevents.valuenum FROM labevents JOIN procedures ON labevents.chartid = procedures.chartid WHERE labevents.chartid IN ( SELECT admissions.chartid FROM admissions WHERE admissions.age >= 50 AND admissions.admission_location = 'emergency room' ) AND procedures.label = 'urine' AND procedures.spec_type = 'last' AND labevents.valuenum IS NOT NULL AND labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.linksto = ( SELECT organisms.org_test_id FROM organisms WHERE organisms.org_name = 'enterococcus faecalis' ) ) ) AS T1 WHERE T1.chartid IN ( SELECT admissions.chartid FROM admissions WHERE admissions.age >= 50 AND admissions.admission_location = 'emergency room' ) ORDER BY T1.time DESC LIMIT 1 )",[],False,0.0,0.0005350112915039062,0,incomplete input,,,
0bef44d46b407af716e48911,How much of a difference is there in patient 10018328's respiratory rate measured at 2100-05-15 14:00:00 compared to the value measured at 2100-05-15 13:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-05-15 14:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-05-15 13:00:00' ),SELECT ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10018328 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10018328 ) ) AND labresults.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'respiratory rate' ) AND labresults.charttime = '2100-05-15 14:00:00' ) - ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10018328 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10018328 ) ) AND labresults.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'respiratory rate' ) AND labresults.charttime = '2100-05-15 13:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-05-15 14:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-05-15 13:00:00' )"": None}]",False,0.0,0.0005345344543457031,0,incomplete input,,,
9894aa0117f387ccc3c0a4ce,What was the latest arrival time for patients yesterday?,,"SELECT MIN( microbiologyevents.charttime ) FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day')",,True,0.205491304397583,0.20714163780212402,1,,[{'MIN( microbiologyevents.charttime )': None}],['MIN( microbiologyevents.charttime )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH microbiologyevents""}]"
e3d036a9b6ba87b79199b9e2,What was the name of the procedure that was performed two or more times since 10 months ago on patient 10020740?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-10 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT COUNT(*)>1 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.subject_id = 10020740 AND datetime(procedures.charttime) >= datetime(current_time,'-10 month') ) GROUP BY microbiologyevents.spec_type",,False,0.0,0.0010247230529785156,0,no such table: procedures,,,
3f777e85538090faa2446aeb,"Since 1 year ago, what are the top five most commonly taken specimens for patients in the same hospital encounter after the diagnosis of intestinal infection due to other organism, not elsewhere classified?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to other organism, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT subject_id, stay_id FROM microbiologyevents WHERE specimen_type = 'stool' AND datetime >= datetime(current_time,'-1 year') GROUP BY subject_id, stay_id ) AS t1 JOIN ( SELECT subject_id, stay_id, icd_code FROM diagnosis WHERE icd_code = '008.89' AND datetime >= datetime(current_time,'-1 year') GROUP BY subject_id, stay_id, icd_code ) AS t2 ON t1.subject_id = t2.subject_id AND t1.stay_id = t2.stay_id GROUP BY t2.icd_code ) AS t3 WHERE t3.c1 <= 5 )",,False,0.0,0.0006649494171142578,0,"near ""G"": syntax error",,,
eeabf0257400d59cb3803434,Count the number of patients that were admitted to the hospital in this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],True,0.09734821319580078,0.09793210029602051,1,,[{'COUNT( DISTINCT admissions.subject_id )': 0}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
f4668740245afefef8cada48,"Tell me the diagnosis cost of acquired absence of organ, genital organs in a patient?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of organ, genital organs' ) )","SELECT DISTINCT T1.COST FROM   ( SELECT  patients.subject_id FROM    patients WHERE   patients.age >= 50 ) AS T0  JOIN  ( SELECT  microbiologyevents.subject_id, microbiologyevents.charttime FROM    microbiologyevents WHERE   microbiologyevents.spec_type_desc = 'blood culture' ) AS T1 ON T0.subject_id = T1.subject_id  JOIN  ( SELECT  d_icd_procedures_icd_icd_items_key, procedures_icd.cost FROM    procedures_icd JOIN    d_icd_procedures_icd_icd_items ON procedures_icd.key = d_icd_procedures_icd_icd_items.key WHERE   d_icd_procedures_icd_icd_items.icd_code = 'E89.0' ) AS T2 ON T1.subject_id = T2.d_icd_procedures_icd_icd_items_key  WHERE   datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,False,0.0,0.0006911754608154297,0,incomplete input,,,
8bfea1a0b78f2e98d30ee271,When was patient 10004422 for the first time leaving the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004422 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT hospital_discharges.charttime FROM hospital_discharges WHERE hospital_discharges.age = 10004422 AND hospital_discharges.dischtime IS NOT NULL ORDER BY hospital_discharges.dischtime ASC LIMIT 1,[{'dischtime': '2111-01-25 15:00:00'}],False,0.0,0.0009067058563232422,0,no such table: hospital_discharges,,,
b41f33bd6784e344776668f2,What was the first dose of 0.9% sodium chloride (mini bag plus) given to patient 10015931?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug = '0.9% sodium chloride (mini bag plus)' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT d1.starttime FROM d_icd_procedures d1 WHERE d1.icd_procedure_code = ( SELECT d_icd_procedures.icd_procedure_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'administration of 0.9% sodium chloride (mini bag plus)' ) AND d1.charttime IN ( SELECT MIN(d2.starttime) FROM d_icd_procedures d2 WHERE d2.icd_procedure_code = ( SELECT d_icd_procedures.icd_procedure_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'administration of 0.9% sodium chloride (mini bag plus)' ) AND d2.stay_id IN ( SELECT d_icustays.stay_id FROM d_icustays WHERE d_icustays.subject_id = 10015931 ) ),[],False,0.0,0.0005371570587158203,0,incomplete input,,,
2e773c48c344e7f33a29892f,What was last procedure time of patient 10018423 since 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10018423 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10018423 ) ) AND strftime('%Y',procedures.starttime) >= '2100' ORDER BY procedures.starttime DESC LIMIT 1",,False,0.0,0.0009765625,0,no such table: procedures,,,
69c8cd3610b365b38e9dc8fb,Has patient 10004235 received the endoscopic insertion of stent (tube) into bile duct procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic insertion of stent (tube) into bile duct' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ),SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10004235 ) AND procedures_icd.label = 'endoscopic insertion of stent (tube) into bile duct',[{'COUNT(*)>0': 0}],False,0.0,0.0008864402770996094,0,no such table: visits,,,
706439ddb58cfc688a427d97,"This year, what were the top four specimens that were tested frequently?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",[],True,0.15725159645080566,0.15782928466796875,0,,,,"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 29, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 64, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 78, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 140, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
8223cedf8e150ea026676246,Tell me the name of the specimen test patient 10011398 last got since 12/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT procedures.drug FROM procedures WHERE procedures.subject_id = 10011398 AND procedures.itemid IN ( SELECT labevents.itemid FROM labevents WHERE labevents.valuenum IS NOT NULL AND labevents.charttime >= '2100-12-01' ORDER BY labevents.charttime DESC LIMIT 1 ),[{'spec_type_desc': 'MRSA SCREEN'}],False,0.0,0.0009975433349609375,0,no such table: procedures,,,
37b440fc3a82a50003dce7ed,"What was patient 10019385's last creatine kinase, mb isoenzyme lab test time in their last hospital encounter?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedureitems.itemid FROM procedureitems WHERE procedureitems.spec_type_desc = 'creatinine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.000988006591796875,0,no such table: procedureitems,,,
f3d8bb52562c47ecba357230,"What were the top four most frequent microbiology tests that patients were given after being diagnosed with cerebral aneurysm, nonruptured during the same month in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral aneurysm, nonruptured' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T1.test_name FROM ( SELECT procedures.drug_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures WHERE procedures.drug_name = 'cerebral aneurysm, nonruptured' AND strftime('%Y-%m',procedures.charttime) = '2100-01' GROUP BY procedures.drug_name ) AS T1 JOIN ( SELECT microbiologyevents.test_name, procedures.charttime FROM microbiologyevents JOIN procedures ON microbiologyevents.charttime >= procedures.charttime WHERE procedures.drug_name = 'cerebral aneurysm, nonruptured' AND strftime('%Y-%m',procedures.charttime) = '2100-01' ) AS T2 ON T1.drug_name = T2.drug_name WHERE T1.C1 <= 4 GROUP BY T2.test_name ORDER BY COUNT(*) DESC LIMIT 4",,False,0.0,0.0005612373352050781,0,incomplete input,,,
d7835456c04a228c24df961d,What is the number of patients who died after diagnosis of septic shock within 2 months during the last year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'septic shock' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-1 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE ( datetime(T3.dod) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') ) OR ( datetime(T2.charttime) BETWEEN datetime(T3.dod) AND datetime(T3.dod,'+2 month') )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 0 AND admissions.admission_type_desc = 'emergency room' AND admissions.admission_location_desc = 'med/surg intensive care unit' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year') EXCEPT SELECT COUNT( DISTINCT d_icd_procedures.subject_id ) FROM d_icd_procedures WHERE d_icd_procedures.key_icd_code = ( SELECT procedures.key_icd_code FROM procedures WHERE procedures.icd_code = '995.92' ) AND datetime(d_icd_procedures.charttime,'start of year') = datetime(current_time,'start of year','-1 year') INTERSECT SELECT COUNT( DISTINCT labevents.subject_id ) FROM labevents WHERE labevents.valuenum = 0.0 AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.icd_code = '995.92' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') INTERSECT SELECT COUNT( DISTINCT microbiologyevents.subject_id ) FROM microbiologyevents WHERE microbiologyevents.valuenum = 0.0",,False,0.0,0.0005228519439697266,0,incomplete input,,,
5459fc4c053a74300114b32b,Give me the top four most commonly prescribed drugs since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT d.drug FROM   ( SELECT   d.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiome_prescriptions d   WHERE   strftime('%Y',d.starttime) >= '2100'   GROUP BY   d.drug ) AS T1 WHERE T1.C1 <= 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]",False,0.0,0.0009334087371826172,0,no such table: microbiome_prescriptions,,,
32bb1be23959c4c55393389e,What was the insurance name of patient 10035185 during their last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = 21006 ) AND chartevents.valuenum IS NOT NULL AND chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.patientid = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ORDER BY chartevents.charttime DESC LIMIT 1 ) ),[{'insurance': 'Other'}],False,0.0,0.0005173683166503906,0,incomplete input,,,
cd8edc01787dda933e12fd99,When patient 10021312 had the first void output since 09/16/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-09-16' ORDER BY outputevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'void output' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = labevents.hadm_id ) ) AND labevents.valuenum IS NOT NULL AND labevents.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.pid = 10021312 ) AND strftime('%Y-%m-%d',labevents.charttime) >= '2100-09-16' ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0005452632904052734,0,incomplete input,,,
7aea773bb0cb8d7705a8afa2,Calculate the length of stay in days for patient 10031757's first hospital stay.,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT 1 * ( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","[{""strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime)"": 11.782638888806105}]",True,0.02854466438293457,0.029046058654785156,1,,"[{""1 * ( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) )"": 11.782638888806105}]","[""1 * ( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) )""]","[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 25, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
8dabcc278b6954eec05639ff,What is the total amount of dextrose 5% input that patient 10039831 got since 02/05/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-05'","SELECT SUM(inputtotal) FROM d_icd_procedures WHERE icd_code = ( SELECT d_icd_procedures.icd_code FROM patients WHERE patients.charttime IS NOT NULL AND patients.age IS NOT NULL AND patients.gender IS NOT NULL AND patients.d_icd_procedures_icd_code = d_icd_procedures.icd_code AND patients.charttime IS NOT NULL AND patients.age IS NOT NULL AND patients.gender IS NOT NULL AND patients.d_icd_procedures_icd_code = d_icd_procedures.icd_code AND patients.charttime IS NOT NULL AND patients.age IS NOT NULL AND patients.gender IS NOT NULL AND patients.id = 10039831 ) AND d_icd_procedures.long_title = 'dextrose 5% input' AND strftime('%Y-%m-%d',d_icd_procedures.charttime) >= '2100-02-05'",[{'SUM(inputevents.totalamount)': None}],False,0.0,0.000530242919921875,0,incomplete input,,,
7e06fac998444826d31f711c,"In 2100, what is the top three most frequent diagnoses that patients had within 2 months after receiving anastomosis of hepatic duct to gastrointestinal tract?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT subject_id, admissions.charttime FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.label = 'anastomosis of hepatic duct to gastrointestinal tract' AND strftime('%Y',procedures.charttime) = '2100' ) ) AS t1 JOIN ( SELECT subject_id, admissions.hadm_id, diagnoses.icd_code, diagnoses.charttime FROM admissions JOIN diagnoses ON admissions.hadm_id = diagnoses.hadm_id WHERE strftime('%Y',diagnoses.charttime) = '2100' ) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.charttime < t2.charttime AND datetime(t2.charttime) BETWEEN datetime(t1.charttime) AND datetime(t1.charttime,'+2 month') GROUP BY t2.icd_code ) AS t3 WHERE t3.c1 <= 3 )",,False,0.0,0.0005199909210205078,0,incomplete input,,,
bc98931efa8f80d2a3e2aa4d,What were the specimen tests that patient 10002930 first had in 08/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT procedures.spec_type_desc FROM procedures WHERE procedures.chartkey = 10002930 AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND procedures.spec_type_desc IS NOT NULL AND strftime('%m',procedures.charttime) = '08' ORDER BY procedures.charttime ASC LIMIT 1",[],False,0.0,0.0009524822235107422,0,no such table: procedures,,,
9fef61b6024912cd87201c6a,What are the top three most common diagnoses that patients had within 2 months after receiving injection of anesthetic into spinal canal for analgesia this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection of anesthetic into spinal canal for analgesia' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.label = 'injection of anesthetic into spinal canal for analgesia' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS t1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.charttime < t2.charttime AND datetime(t2.charttime) BETWEEN datetime(t1.charttime) AND datetime(t1.charttime,'+2 month') GROUP BY t2.icd_code ) AS t3 WHERE t3.c1 <= 3 )",,False,0.0,0.0005538463592529297,0,"unrecognized token: ""'-0 y""",,,
f147512eb438041a5186bf3e,What was the total output of patient 10014354 since 09/07/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-09-07'",SELECT SUM(inputdailytotaloutput.inputdailytotaloutput) FROM inputdailytotaloutput WHERE inputdailytotaloutput.charttime >= '2100-09-07' AND inputdailytotaloutput.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.label = 'patient 10014354' ),[{'SUM(outputevents.value)': 26195.0}],False,0.0,0.0009145736694335938,0,no such table: inputdailytotaloutput,,,
ca02915764bab9c149d0c83e,"What are the four most commonly taken specimens that patients were tested in the same hospital encounter after receiving a respiratory ventilation, 24-96 consecutive hours procedure since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT d1.spec_type_desc FROM   ( SELECT   t1.itemid, d_icd_procedures.long_title, d_icd_outcomes.long_title, strftime('%Y',t1.charttime) AS year   FROM   procedures_icd d_icd_procedures JOIN   ( SELECT   u1.subject_id, u1.stay_id, t1.itemid, t1.charttime   FROM   ( SELECT   subject_id, stay_id, itemid, charttime   FROM   labevents   WHERE   labevents.itemid IN ( SELECT   DISTINCT procedures_icd.itemid   FROM   procedures_icd   WHERE   procedures_icd.long_title = 'respiratory ventilation, 24-96 consecutive hours' )   ) u1 JOIN   labevents t1 ON u1.stay_id = t1.stay_id   WHERE   u1.itemid != t1.itemid AND datetime(u1.charttime) < datetime(t1.charttime) ) t2 ON d_icd_procedures.itemid = t2.itemid   WHERE   d_icd_outcomes.long_title = 'respiratory ventilation, 24-96 consecutive hours'   AND strftime('%Y',t2.charttime) >= '2100'   GROUP BY   t",,False,0.0,0.0005147457122802734,0,"unrecognized token: ""'respiratory ventilation, 24-96 """,,,
1fcac336ef5d4a18372aeae5,What was the last prescribed dose of docusate sodium (liquid) that patient 10021487 got during the current hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'docusate sodium (liquid)' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT d1.value FROM prescriptions d1 WHERE d1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.gender = 'male' AND admissions.age IS NOT NULL AND admissions.spec_type IS NOT NULL AND admissions.spec_type = 'bronch' AND admissions.d_icd_procedures_icd_to_char = '13.21' ) AND admissions.gender = 'male' AND admissions.age IS NOT NULL AND admissions.spec_type IS NOT NULL AND admissions.spec_type = 'bronch' AND admissions.d_icd_procedures_icd_to_char = '13.21' ORDER BY admissions.admittime DESC LIMIT 1 ) AND d1.drug = 'docusate sodium (liquid)' AND d1.d_icd_procedures_icd_to_char = '13.21' ORDER BY d1.starttime DESC LIMIT 1,[],False,0.0,0.0005474090576171875,0,incomplete input,,,
7fef015e3c73d010f8ac487e,What is the count of patients who were in the coronary care unit (ccu) careunit in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'coronary care unit (ccu)' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.careunit = 'coronary care unit (ccu)' AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009505748748779297,0,no such column: admissions.patient_id,,,
96b1d3fe1090aafcf5bcc954,When did patient 10008454 first have foley output since 12/04/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-04' ORDER BY outputevents.charttime ASC LIMIT 1","SELECT d1.charttime FROM labevents d1 WHERE d1.itemid IN ( SELECT DISTINCT labevents.itemid FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT microbiologyevents.chartitem_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'foley output' AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT microbiologyevents.chartitem_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'foley output' AND microbiologyevents.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.patient_id = 10008454 ) ) ORDER BY microbiologyevents.charttime ASC LIMIT 1 ) ) ) ORDER BY microbiologyevents.charttime ASC LIMIT 1 ) ) ) AND d1.valuenum >= 0.0 AND strftime('%Y-%m-%d',d1.charttime) >= '2100-12-04' ORDER BY d1.charttime ASC LIMIT 1",[],False,0.0,0.0005347728729248047,0,incomplete input,,,
e82244401b22ffb372a139b9,"What is the minimum total hospital cost when it includes measurement of cardiac sampling and pressure, left heart, percutaneous approach?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) ) GROUP BY cost.hadm_id ) AS T1",SELECT MIN(T1.C1) FROM ( SELECT SUM( patients_icd_procedures.cost ) AS C1 FROM patients_icd_procedures WHERE patients_icd_procedures.chartkey IN ( SELECT patients.chartkey FROM patients WHERE patients.age >= 50 ) AND patients_icd_procedures.icd_code = '00.66' GROUP BY patients_icd_procedures.chartkey ) AS T1,,False,0.0,0.0009551048278808594,0,no such table: patients_icd_procedures,,,
31bc055f744e30a632a2f021,Count the number of patients who had a lactate dehydrogenase (ld) test done since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND strftime('%Y',labevents.charttime) >= '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT labevents.subject_id FROM labevents WHERE labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'lactate dehydrogenase (ld)' ) AND strftime('%Y',labevents.charttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009255409240722656,0,no such table: definition,,,
7559da6b7b189084f45242ea,Was patient 10020944 to the e.r. in their first hospital visit?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*)>0 FROM er_visits WHERE er_visits.chart_id IN ( SELECT admissions.chart_id FROM admissions WHERE admissions.age BETWEEN 50 AND 60 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND er_visits.chart_id = 10020944,[{'COUNT(*)>0': 0}],False,0.0,0.0009090900421142578,0,no such table: er_visits,,,
dd1f1e6825a6f105f91f7d0e,"What proportion of patients with a diagnosis of spinal stenosis, lumbar region, with neurogenic claudication survive over a 6-month period?","SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/2 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, with neurogenic claudication' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT patients.subject_id, patients.d_icd_procedures_icd_links_key FROM patients WHERE patients.age BETWEEN 50 AND 60 ) AS T1 JOIN ( SELECT patients.subject_id, patients.d_icd_procedures_icd_links_key FROM patients WHERE patients.age BETWEEN 30 AND 40 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.d_icd_procedures_icd_links_key IN ( SELECT procedures_icd.d_icd_procedures_icd_links_key FROM procedures_icd WHERE procedures_icd.icd_code = '13.22' ) AND T2.d_icd_procedures_icd_links_key IN ( SELECT procedures_icd.d_icd_procedures_icd_links_key FROM procedures_icd WHERE procedures_icd.icd_code = '13.22' )",,False,0.0,0.0009477138519287109,0,no such column: patients.d_icd_procedures_icd_links_key,,,
f9ae9091bbfcec86ccce09d6,"In 2100, what was the top three most frequent laboratory tests ordered for patients after the diagnosis of family history of malignant neoplasm of prostate during the same month?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of prostate' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_labitems.item FROM   ( SELECT   d_icd_procedures.chart_instance_id, d_icd_procedures.chart_time   FROM     careevents d_icd_procedures   WHERE     d_icd_procedures.icd_code = 'I210'   AND     strftime('%Y',d_icd_procedures.chart_time) = '2100' ) AS tmp1 JOIN ( SELECT   d_icd_procedures.chart_instance_id, d_icd_procedures.chart_time   FROM     careevents d_icd_procedures   WHERE     d_icd_procedures.icd_code = 'I210'   AND     strftime('%Y',d_icd_procedures.chart_time) = '2100' ) AS tmp2 ON tmp1.chart_instance_id = tmp2.chart_instance_id   WHERE tmp1.chart_time < tmp2.chart_time   AND datetime(tmp2.chart_time,'-1 month') = datetime(tmp1.chart_time)   GROUP BY tmp1.chart_instance_id   HAVING COUNT(*) >= 1   ORDER BY COUNT(*) DESC   LIMIT 1",,False,0.0,0.0009999275207519531,0,no such table: careevents,,,
9d55be8800c23366c5a86393,How many patients during the previous year were given a bicarbonate test?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.dischtime is NOT NULL AND datetime(patients.dischtime,'start of year') = datetime(current_time,'start of year','-1 year') EXCEPT SELECT COUNT( DISTINCT labevents.subject_id ) FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'bicarbonate' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009913444519042969,0,no such column: procedures_icd.itemid,,,
c814a79881c8be3a4809fdb9,Get patient 10018423's monthly minimum weight information in 2100.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 0 AND admissions.gender = 'male' AND admissions.pid = 10018423 ) AND chartevents.itemid IN ( SELECT definition.itemid FROM definition WHERE definition.label = 'daily weight' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-01' GROUP BY strftime('%Y-%m',chartevents.charttime) UNION ALL SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 0 AND admissions.gender = 'male' AND admissions.pid = 10018423 ) AND chartevents.itemid IN ( SELECT definition.itemid FROM definition WHERE definition.label = 'daily weight' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-02' GROUP BY strftime('%Y-%m',chartevents.charttime) UNION ALL SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 0 AND admissions.gender = 'male' AND admissions.pid = 10018423 )",[],False,0.0,0.0009377002716064453,0,no such table: definition,,,
101023c9d00c778450601539,Calculate the length of stay in days for patient 10007928's last hospital stay.,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","SELECT ( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","[{""strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime)"": 5.770138889085501}]",True,0.02834916114807129,0.028816699981689453,1,,"[{""( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) )"": 5.770138889085501}]","[""( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) )""]","[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 24, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
e134d64a96cc7940427b44cf,Did patient 10003046 get a pco2 test in their last hospital visit?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT procedureitems.itemid FROM procedureitems WHERE procedureitems.label = 'pco2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.gender = ( SELECT admissions.gender FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.pid = 10003046 ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],False,0.0,0.0005879402160644531,0,incomplete input,,,
02641abbf2e5bcb72ad7aedc,Please list the top five most frequent specimens tested.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]",True,0.25552892684936523,0.2564680576324463,5,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}, {'long_title': 'electrocardiogram'}, {'long_title': 'enteral infusion of concentrated nutritional substances'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 21, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 56, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 70, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 132, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
99659e62f4677c9b6f10903d,"What is the minimum monthly number of patients that are suffering from allergic rhinitis, cause unspecified since 1 year ago?","SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'allergic rhinitis, cause unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT I1.subject_id ) AS C1 FROM microbiome_icd I1 WHERE I1.icd_code = ( SELECT M1.icd_code FROM microbiome_d_icd_diagnoses M1 WHERE M1.long_title = 'allergic rhinitis, cause unspecified' ) AND datetime(I1.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',I1.charttime) ) AS T1",,False,0.0,0.0009739398956298828,0,no such table: microbiome_icd,,,
f64502ea7695fae28227dfce,Did patient 10005817 receive solution on 12/24/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 10005817 AND organism_name = 'solution' AND datetime >= datetime(current_time,'start of year','-1 year') AND datetime(datetime(current_time,'start of year','-1 year'),'12-24')",[{'COUNT(*)>0': 0}],False,0.0,0.0007927417755126953,0,no such column: patient_id,,,
8101d176c45f4e285b9e9540,How many patients were prescribed the medicine ferric gluconate within 2 months after a diagnosis of ankylosing spondylitis since 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'ankylosing spondylitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ferric gluconate' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT prescriptions.subject_id FROM prescriptions WHERE prescriptions.drug = 'ferric gluconate' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AND patients.subject_id IN ( SELECT diagnoses.subject_id FROM diagnoses WHERE diagnoses.label = 'ankylosing spondylitis' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AND datetime(diagnoses.charttime) BETWEEN datetime(prescriptions.starttime) AND datetime(prescriptions.starttime,'+2 month')",,False,0.0,0.0009250640869140625,0,no such table: diagnoses,,,
3c23367e7687645342a44a61,Show me the top three most commonly prescribed drugs during the same month for patients in their 30s after a unspecified essential hypertension diagnosis.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 39 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT d.drug FROM   ( SELECT   t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM     ( SELECT   u1.subject_id, u1.starttime   FROM     microbiomicevents u1   WHERE     u1.spec_type_desc = 'unspecified essential hypertension'   AND     datetime(u1.starttime,'start of year') = datetime(current_time,'start of year','-0 year')   AND     strftime('%Y-%m',u1.starttime) >= strftime('%Y-%m',current_time) - 1   AND     u1.age BETWEEN 30 AND 39 ) AS t1   JOIN     ( SELECT   u2.subject_id, u2.drug, u2.starttime   FROM     microbiomicevents u2   WHERE     u2.spec_type_desc = 'prescribed drugs'   AND     datetime(u2.starttime,'start of year') = datetime(current_time,'start of year','-0 year')   AND     strftime('%Y-%m',u2.starttime) >= strftime('%Y-%m',current_time) - 1   AND     u2.age BETWEEN 30 AND 39 ) AS t2   ON t1.subject_id = t2",,False,0.0,0.0004563331604003906,0,incomplete input,,,
740f87417b7715602b678286,"Did patient 10029484 have any tests for creatine kinase, mb isoenzyme during the previous month?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT procedureitems.itemid FROM procedureitems WHERE procedureitems.spec_type_desc = 'creatinine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10029484 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10029484 ) ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",[{'COUNT(*)>0': 0}],False,0.0,0.0004267692565917969,0,incomplete input,,,
2c251f13cfc63c34883bcbcd,Has there been any microbiological urine tests for patient 10005348 in 08/last year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',microbiologyevents.charttime) = '08'",SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' AND admissions.year = 2100 - 1 AND admissions.month = 8 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.test_desc = 'microbiological' AND microbiologyevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' AND admissions.year = 2100 - 1 AND admissions.month = 8 ) AND procedures.label = 'patient 10005348' ),[{'COUNT(*)>0': 0}],False,0.0,0.0005857944488525391,0,incomplete input,,,
5c22be4f508798bea10dfa73,"What is the 3-month survival rate for patients diagnosed with pleural effusion, not elsewhere classified.","SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pleural effusion, not elsewhere classified' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT patients.subject_id, patients.d_icd_procedures_icd_links_key FROM patients WHERE patients.age BETWEEN 50 AND 59 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_links_key IN ( SELECT procedures.d_icd_procedures_icd_links_key FROM procedures WHERE procedures.icd_code = 'J90' ) ) AS T1 JOIN ( SELECT patients.subject_id, patients.d_icd_procedures_icd_links_key FROM patients WHERE patients.age BETWEEN 50 AND 59 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_links_key IN ( SELECT procedures.d_icd_procedures_icd_links_key FROM procedures WHERE procedures.icd_code = 'J90' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.charttime) < datetime(T2.charttime) AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+3 month')",,False,0.0,0.0004353523254394531,0,incomplete input,,,
f5b332414c271567297ba2c9,When did patient 10022041 first have an input event?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) ORDER BY inputevents.starttime ASC LIMIT 1,SELECT d1.starttime FROM labevents d1 WHERE d1.itemid IN ( SELECT d2.itemid FROM labitems d2 WHERE d2.label = 'input' ) AND d1.subject_id = 10022041 ORDER BY d1.starttime ASC LIMIT 1,[{'starttime': '2187-05-18 18:38:00'}],False,0.0,0.0007390975952148438,0,no such table: labitems,,,
1bdf02ef77df577cf44deaee,"Since 2100, how many patients were discharged from the hospital?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],True,0.19687485694885254,0.1973273754119873,1,,[{'COUNT( DISTINCT admissions.subject_id )': 172553}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
393ccf93d06553bf2947a17a,What are the four most frequent drugs that were prescribed to male patients in their 30s during the same month after they were diagnosed with hyposmolality and/or hyponatremia during this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyposmolality and/or hyponatremia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 30 AND 39 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT d.drug FROM   ( SELECT   t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM     ( SELECT    u1.subject_id, l1.charttime   FROM      microbiologyevents AS u1   WHERE     u1.spec_type_desc = 'sputum'   AND       datetime(u1.spec_type_desc) >= datetime(current_time,'start of year')   ) AS t1   JOIN      ( SELECT    u2.subject_id, l2.charttime   FROM      microbiologyevents AS u2   WHERE     u2.spec_type_desc = 'sputum'   AND       datetime(u2.spec_type_desc) >= datetime(current_time,'start of year')   ) AS t2   ON t1.subject_id = t2.subject_id   WHERE t1.charttime < t2.charttime   AND datetime(t1.charttime) >= datetime(current_time,'start of year')   AND datetime(t2.charttime) >= datetime(current_time,'start of year')   AND datetime(t1.charttime) >= datetime(current_time,'-1 year')   AND datetime(t2.charttime) >= datetime(current_time,'-1 year')   AND strftime('%Y-%m',t1.charttime)",,False,0.0,0.0005457401275634766,0,incomplete input,,,
01eb9179a54a0f80fb0189a6,"For patients diagnosed with pain in left shoulder previously, what are the top five most common procedures applied within 2 months in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in left shoulder' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d.proc_name FROM   ( SELECT   t1.subject_id, t1.charttime FROM   ( SELECT   admissions.subject_id, admissions.admittime FROM   admissions WHERE   admissions.age BETWEEN 50 AND 60 AND admissions.gender = 'M' AND admissions.d_icd_diagnoses_icd = '338.1' AND strftime('%Y',admissions.admittime) = '2100' ) AS t1 JOIN ( SELECT   patients.subject_id FROM   patients WHERE   patients.age BETWEEN 50 AND 60 AND patients.gender = 'M' ) AS t2 ON t1.subject_id = t2.subject_id JOIN ( SELECT   labevents.subject_id, labevents.charttime FROM   labevents WHERE   labevents.valuenum = 0.0 AND labevents.itemid IN ( ( SELECT   items.itemid FROM   items WHERE   items.label = 'o2 saturation pulseoxymetry' ) ) AND strftime('%Y',labevents.charttime) = '2100' ) AS t3 ON t1.subject_id = t3.subject_id WHERE   datetime(t1.charttime) < datetime(t3.charttime) ) AS t4 JOIN ( SELECT   admissions.subject_id, admissions.admittime FROM   admissions WHERE   admissions.age",,False,0.0,0.0012559890747070312,0,incomplete input,,,
949dc9ac2dfec702b23219cc,Tell me the top four most frequent diagnoses of patients of age 40s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d.icd_name FROM   ( SELECT   d_icd_icditems_icd_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiologyevents   WHERE   microbiologyevents.spec_type_desc = 'blood culture'   AND   microbiologyevents.org_name IS NOT NULL   GROUP BY   d_icd_icditems_icd_name ) AS T1   WHERE   T1.C1 <= 4",,False,0.0,0.0009884834289550781,0,no such column: d_icd_icditems_icd_name,,,
5e15ef576080a675d598f4f4,How many current patients are of 60 or above age?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT( DISTINCT d_icustays.charttime ) FROM d_icustays WHERE d_icustays.age >= 60 AND d_icustays.dischtime IS NULL,,False,0.0,0.0009584426879882812,0,no such table: d_icustays,,,
eccaf3ea4033b34c3afac111,Tell me the percentile of creatinine of 2.7 in patients of the same age as patient 10016150 on the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.7","SELECT DISTINCT T1.C1 FROM ( SELECT patients.age, labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents JOIN patients ON labevents.subject_id = patients.subject_id WHERE labevents.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.type_desc = 'hospital admission' AND procedures.label = 'first hospital visit' ) AND patients.age IS NOT NULL AND patients.gender = 'male' AND patients.dod IS NULL AND patients.age = ( SELECT patients.age FROM patients WHERE patients.gender = 'male' AND patients.dod IS NULL AND patients.subject_id = 10016150 ) ) AS T1 WHERE T1.valuenum = 2.7",,False,0.0,0.0005321502685546875,0,incomplete input,,,
92f0b914005e5b93474fac4e,Can you name the first outputs of patient 10013049 in their last ICU visit?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 ),SELECT d.valuenum FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = '12.921' ) AND d.charttime >= ( SELECT t.intime FROM microbiologyevents t WHERE t.spec_type_desc = 'blood culture' AND t.hospital_id = 10013049 ORDER BY t.intime DESC LIMIT 1 ) AND d.hospital_id = 10013049 ORDER BY d.charttime ASC LIMIT 1,[{'label': 'OR Urine'}],False,0.0,0.0009365081787109375,0,no such column: p.itemid,,,
e0693814cc896b83b3416d2d,Is the value of respiratory rate in patient 10016742 from second measurement on the first ICU visit greater than its first measurement on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT d1.valuenum FROM microbiologyevents d1 WHERE d1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10016742 ) AND d1.charttime >= admissions.admittime AND d1.spec_type_desc = 'respiratory rate' AND d1.linksto = 'first' ORDER BY d1.charttime ASC LIMIT 1 ) < ( SELECT d2.valuenum FROM microbiologyevents d2 WHERE d2.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10016742 ) AND d2.charttime >= admissions.admittime AND d2.spec_type_desc = 'respiratory rate' AND d2.linksto = 'second' ORDER BY d2.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0006515979766845703,0,incomplete input,,,
37d260bf174746e3b0f83bb0,"What are the five most commonly prescribed drugs for patients diagnosed with postprocedural fever previously within the same hospital visit, in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural fever' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, admissions.chartevents_charttime, admissions.admittime FROM admissions WHERE admissions.dischtime IS NULL ) AS T1 JOIN ( SELECT patients.subject_id, labevents_valuenum, labevents_charttime FROM ( SELECT admissions.subject_id, admissions.chartevents_charttime, admissions.admittime FROM admissions WHERE admissions.dischtime IS NULL ) AS T5 JOIN patients ON T5.subject_id = patients.subject_id JOIN ( SELECT labevents_subject_id, labevents_valuenum, labevents_charttime FROM labevents WHERE labevents.spec_type_desc = 'blood culture' ) AS T6 ON T5.subject_id = T6.subject_id WHERE T5.chartevents_charttime < T6.labevents_charttime AND datetime(T5.admittime,'start of year') = datetime(T6.labevents_charttime,'start of year') - 1 GROUP BY T5.subject_id, T6.labevents_valuenum HAVING T6.labevents_valuenum = MIN(T6.labevents_valuenum) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chartevents",,False,0.0,0.0005590915679931641,0,incomplete input,,,
4a73f78af6f830619516e24b,When did patient 10005909 experience the last instance where their heart rate was less than 115.0 in their last ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 115.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT admissions.age FROM admissions WHERE admissions.pid = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admissionlocation = 'intensive care unit' ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT DISTINCT d_icd_items.itemid FROM d_icd_items WHERE d_icd_items.long_title = 'heart rate' AND d_icd_items.linksto = 'labitems' ) AND labevents.valuenum < 115.0 ORDER BY labevents.charttime DESC LIMIT 1,[],False,0.0,0.0005137920379638672,0,incomplete input,,,
5cf885d109f3f215844f994e,How many hours have passed since patient 10004733's last stay in careunit medical/surgical intensive care unit (micu/sicu) in this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers_icu.to_timestamp) ) FROM transfers_icu WHERE transfers_icu.chart_id = 10004733 AND transfers_icu.careunit_desc = 'medical/surgical intensive care unit (micu/sicu)' AND transfers_icu.hospital_encounter_id = ( SELECT admissions.hospital_encounter_id FROM admissions WHERE admissions.chart_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY transfers_icu.to_timestamp DESC LIMIT 1",[],False,0.0,0.0009377002716064453,0,no such table: transfers_icu,,,
3d269b39239d5b96ed89fd1a,What is the most common location among hospitals?,,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 1 )",,True,0.3012213706970215,0.30301761627197266,1,,"[{'long_title': 'venous catheterization, not elsewhere classified'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 6, ""parent"": 0, ""notused"": 0, ""detail"": ""SCALAR SUBQUERY 2""}, {""id"": 9, ""parent"": 6, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 21, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 56, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 70, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 133, ""parent"": 6, ""notused"": 0, ""detail"": ""SCAN T1""}]"
62a5029a9781c0cb6bcc7ce6,What new prescriptions were given to patient 10004733 today compared to those given yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.currentrid FROM transfers WHERE transfers.prevrid IN ( SELECT admissions.row_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime = current_time - interval '1' day AND admissions.patientid = '10004733' ) ) ) ) AND admissions.patientid = '10004733' ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.currentrid FROM transfers WHERE transfers.prevrid IN ( SELECT admissions.row_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime = current_time - interval '1' day AND admissions.patientid = '10004733' ) ) ) ) ) AND admissions.patientid = '10004733' AND datetime(prescriptions.starttime,'start of day') = datetime(current_time - interval '1' day,'",[],False,0.0,0.0005526542663574219,0,"near ""'1'"": syntax error",,,
f1dd398aaf1b00d4a562b899,How much is the difference of weights of patient 10037975 second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'arterial blood gas' ) ORDER BY labevents.charttime ASC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'arterial blood gas' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 )","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0005450248718261719,0,"unrecognized token: ""'art""",,,
a4aeae6cbe8fff13d7e4d651,What was the total output amount for patient 10014729 on 03/05/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-05'","SELECT SUM(output) FROM microbiologyevents WHERE subject_id = 10014729 AND strftime('%Y-%m-%d',microbiologyevents.charttime) = datetime(current_time,'start of year','+0 year','-0 month','-4 day')",[{'SUM(outputevents.value)': None}],False,0.0,0.0010266304016113281,0,no such column: output,,,
8c531cd9b0af5ba949b9fa91,How many hours have it been since patient 10021487's first free calcium lab test during their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT distinct procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10021487 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.pid = 10021487 AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.00058746337890625,0,incomplete input,,,
1cb7346d2299d0467b9fcb27,"In 03/last year, was the respiratory rate of patient 10020187 ever greater than 12.0?","SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 12.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',chartevents.charttime) = '03'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 10020187 AND charttime >= datetime(current_time,'start of year','-1 year','03') AND charttime < datetime(current_time,'start of year','-1 year','04') AND valuenum > 12.0",[{'COUNT(*)>0': 0}],False,0.0,0.0013997554779052734,0,no such column: patient_id,,,
6bb8d0b3a6e2b6227b56f595,Tell me patient 10038081's first oxygen value on the first hospital stay.,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen' ) ORDER BY labevents.charttime ASC LIMIT 1,"SELECT d1.valuenum FROM labevents d1 WHERE d1.hadm_id IN ( SELECT d2.hadm_id FROM microbiologyevents d2 WHERE d2.spec_type_desc = 'oxygen' AND d2.itemid IN ( SELECT MAX(idx) FROM ( SELECT t1.itemid, DENSE_RANK() OVER ( ORDER BY t1.charttime ASC ) AS idx FROM microbiologyevents t1 WHERE t1.hadm_id IN ( SELECT t2.hadm_id FROM admissions t2 WHERE t2.age = ( SELECT T1.age FROM ( SELECT admissions.age, DENSE_RANK() OVER ( ORDER BY admissions.admittime ASC ) AS C1 FROM admissions WHERE admissions.pid = 10038081 ) AS T1 WHERE T1.C1 = 1 ) AND admissions.pid = 10038081 ) ) WHERE d2.spec_type_desc = 'oxygen' ) ) AND d1.valuenum IS NOT NULL ORDER BY d1.charttime ASC LIMIT 1",[],False,0.0,0.0005609989166259766,0,incomplete input,,,
ec89baea1f34f1904eed2a70,"Among patients who were prescribed with potassium chl 40 meq / 1000 ml ns, what are the top four most frequently prescribed drugs at the same time since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'potassium chl 40 meq / 1000 ml ns' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT d.drug FROM   (   SELECT   t1.subject_id, t1.starttime   FROM   (   SELECT   subject_id, st_datetime(intime) AS intime   FROM   d_icustays   WHERE   age(intime) >= 1 * 365   ) AS t0   JOIN   (   SELECT   subject_id, st_datetime(starttime) AS starttime   FROM   d_icustays   WHERE   age(intime) >= 1 * 365   ) AS t1   ON t0.subject_id = t1.subject_id   WHERE   datetime(t1.starttime) >= datetime(t0.intime)   ) AS t2   JOIN   (   SELECT   subject_id, st_datetime(starttime) AS starttime   FROM   d_labitems   WHERE   itemid IN (   SELECT   itemid   FROM   d_icd   WHERE   name = 'potassium chl 40 meq / 1000 ml ns'   )   ) AS t3   ON t2.subject_id = t3.subject_id   WHERE   datetime(t3.starttime) >= datetime(t2.starttime)   AND datetime(t3.starttime) < datetime(t2.starttime) + 1 day   JOIN   (",[],False,0.0,0.0005271434783935547,0,incomplete input,,,
356df71d59db66ac2534a5d3,Can you tell me the total number of patients who were admitted to the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],True,0.14186334609985352,0.1423509120941162,1,,[{'COUNT( DISTINCT admissions.subject_id )': 174611}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
89a854beb29f40da67997b3c,What was patient 10039831's first diastolic blood pressure value since 12/13/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-13' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT d.diastolic FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of intravenous infusion device, percutaneous approach' AND d_icd_procedures.icd_code = '0jg0x0z0'",[],False,0.0,0.0009162425994873047,0,no such column: d.diastolic,,,
7a1d975dc39f51887f287327,Is patient 10020944 recorded as male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020944,SELECT patients.gender FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 8507 ) AND chartevents.value = '10020944' ),[{'gender': 'M'}],False,0.0,0.0009112358093261719,0,no such table: definition,,,
0552fb2fb3c9ef8054e31fe0,How many times since 2100 did patient 10005817 visit the hospital?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10005817 AND strftime('%Y',admissions.admittime) >= '2100'",SELECT COUNT(*) FROM microbiologyevents WHERE patientid = 10005817 AND charttime >= '2100-01-01',[{'COUNT( DISTINCT admissions.hadm_id )': 2}],False,0.0,0.0009055137634277344,0,no such column: patientid,,,
2e3cccfa4f52265b94f8579f,What is the minimum total hospital cost involving a procedure named thoracentesis in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracentesis' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.label = 'thoracentesis' AND strftime('%Y',procedures.charttime) = '2100' GROUP BY procedures.admittime ) AS T1",,False,0.0,0.0009355545043945312,0,no such table: procedures,,,
96ac404e31dae66aaf3c7df0,How much difference is there in respiratory rate levels among patient 10019777 last measured on the last ICU visit compared to the value second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"SELECT ( SELECT respiratory_rate FROM microbiologyevents WHERE patient_id = 10019777 AND charttime IN ( SELECT T1.charttime FROM ( SELECT T2.charttime, DENSE_RANK() OVER ( ORDER BY T2.charttime DESC ) AS C1 FROM ( SELECT patient_id, charttime FROM microbiologyevents WHERE patient_id = 10019777 ) AS T2 ) AS T1 WHERE T1.C1 = 1 ) ) - ( SELECT respiratory_rate FROM microbiologyevents WHERE patient_id = 10019777 AND charttime IN ( SELECT T1.charttime FROM ( SELECT T2.charttime, DENSE_RANK() OVER ( ORDER BY T2.charttime DESC ) AS C1 FROM ( SELECT patient_id, charttime FROM microbiologyevents WHERE patient_id = 10019777 ) AS T2 ) AS T1 WHERE T1.C1 = 2 ) )","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",False,0.0,0.000553131103515625,0,"near ""OR"": syntax error",,,
dc1ccc85cf5b684ab55c2b09,Can you tell me the number of patients who were prescribed methylnaltrexone?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylnaltrexone' ),SELECT COUNT( DISTINCT d_icd_procedures_icd_icd_items.key ) FROM d_icd_procedures_icd_icd_items WHERE d_icd_procedures_icd_icd_items.value = 'methylnaltrexone',[{'COUNT( DISTINCT admissions.subject_id )': 3}],False,0.0,0.0008566379547119141,0,no such table: d_icd_procedures_icd_icd_items,,,
7329fbf5056c86af263e9033,Could you show me the total void output of patient 10024043?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ),"SELECT SUM(inputoutput.totalamount) FROM inputoutput WHERE inputoutput.stdtm >= strftime('%Y-%m-%d 00:00:00',admissions.admittime) AND inputoutput.stdtm < strftime('%Y-%m-%d 23:59:59',admissions.admittime) AND inputoutput.itemid IN ( SELECT procedureevents.itemid FROM procedureevents WHERE procedureevents.hcpcscptid = '12.25' ) AND inputoutput.charttime >= admissions.admittime AND inputoutput.charttime < admissions.dischtime AND admissions.age = 10024043 AND admissions.gender = 'male' GROUP BY inputoutput.stdtm",[{'SUM(outputevents.value)': None}],False,0.0,0.0009007453918457031,0,no such table: inputoutput,,,
e94fc44f50cb46d93aaa3008,Could you show me the top five most common diagnoses since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT D_icd_diagnoses.long_title FROM D_icd_diagnoses WHERE D_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT patients_icd.icd_code, D_icd_diagnoses.long_title FROM patients_icd JOIN D_icd_diagnoses ON patients_icd.icd_code = D_icd_diagnoses.icd_code WHERE strftime('%Y',patients_icd.charttime) >= '2100' GROUP BY patients_icd.icd_code, D_icd_diagnoses.long_title ) AS T1 ORDER BY COUNT(*) DESC LIMIT 5 )",,False,0.0,0.0009334087371826172,0,no such table: patients_icd,,,
99674b531e81a982dc797973,"What are the five most common microbiology tests for patients that had previously received introduction of other thrombolytic into peripheral vein, percutaneous approach within the same hospital visit since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into peripheral vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT T3.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, admissions.chartevents.charttime, admissions.d_icd_procedures_icd_id FROM admissions WHERE admissions.d_icd_procedures_icd_id = ( SELECT procedures_icd_id FROM d_icd_procedures WHERE procedures_icd_long_title = 'introduction of other thrombolytic into peripheral vein, percutaneous approach' ) ) AS T2 JOIN ( SELECT admissions.subject_id, admissions.chartevents.charttime, admissions.d_icd_diagnoses_icd_id FROM admissions WHERE admissions.d_icd_diagnoses_icd_id = ( SELECT diagnoses_icd_id FROM d_icd_diagnoses WHERE diagnoses_icd_long_title = 'microbiology tests' ) ) AS T3 ON T2.subject_id = T3.subject_id WHERE T2.charttime < T3.charttime AND strftime('%Y',T2.charttime) >= '2100' GROUP BY T3.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",,False,0.0,0.00054168701171875,0,incomplete input,,,
94122ab2640e86cea1d8cefe,Retrieve the top four most frequent procedures that patients underwent in the same hospital visit after being diagnosed with noncompliance with renal dialysis.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time, admissions.admittime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.chart_time, admissions.admittime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.admittime,'start of day') = datetime(T2.admittime,'start of day') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,False,0.0,0.0005249977111816406,0,incomplete input,,,
805a7efe25e2ce496220ee26,What was the admission type during the first hospital admission for patient 10019172?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1","SELECT admissions.admission_type FROM admissions WHERE admissions.charteventscharttime IN ( SELECT T1.charteventscharttime FROM ( SELECT chartevents.charttime, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 10019172 ) AND definition.linksto = 10019172 ) AS T1 WHERE T1.C1 = 1 )",[],False,0.0,0.0009195804595947266,0,no such table: definition,,,
c58538af9651b0425098d396,"In 07/2100, when was the first time patient 10020786 was prescribed medication via the iv drip route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND prescriptions.route = 'iv drip' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(drugs.charttime) FROM drugs WHERE drugs.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.ethnicity = 'other' ) AND drugs.route = 'iv drip' AND strftime('%Y-%m',drugs.charttime) = '2100-07' AND drugs.stdt IS NOT NULL AND drugs.drug = 'docusate sodium' AND drugs.dose = '100 mg' AND drugs.doseunit = 'tablet' AND drugs.linksto = '10020786'",[],False,0.0,0.0009198188781738281,0,no such table: drugs,,,
db7f20610bfa0be1f5377ba9,What was the admission type during the first hospital admission for patient 10021118?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10021118 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1","SELECT admissions.admission_type FROM admissions WHERE admissions.charteventscharttime IN ( SELECT T1.charteventscharttime FROM ( SELECT chartevents.charttime, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 10021118 ) AND definition.linksto = 10021118 ) AS T1 WHERE T1.C1 = 1 )",[{'admission_type': 'URGENT'}],False,0.0,0.0009326934814453125,0,no such table: definition,,,
89fa29a6a2fb6b1fff321ece,How is ferrous sulfate (liquid) delivered?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)',SELECT DISTINCT procedures.drug FROM procedures WHERE procedures.spec_type = 'ferrous sulfate (liquid)',[],False,0.0,0.0008609294891357422,0,no such table: procedures,,,
1718f0835a82b0bb7c0517f1,"Since 14 months ago, what was the weight of patient 10016742 in the first measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT d.valuenum FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = '13.12' ) AND d.charttime >= datetime(current_time,'-14 month') ORDER BY d.charttime ASC LIMIT 1",[],False,0.0,0.0010266304016113281,0,no such column: p.itemid,,,
bd54a046a04a62d9d40ba4d4,"This year, what were the four most frequently ordered specimen tests?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",[],True,0.15704917907714844,0.15766382217407227,0,,,,"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 29, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 64, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 78, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 140, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
2294e45331b6e84efb7132a1,Can you list the top three diagnoses that have the highest mortality rate in a 6-month period?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY T2.C2 DESC ) AS C3 FROM ( SELECT T1.icd_code, AVG(C1) AS C2 FROM ( SELECT admissions.patient_id, diagnoses.charttime, DATEDIFF(admissions.dischtime, diagnoses.charttime) AS C1 FROM diagnoses JOIN admissions ON diagnoses.patient_id = admissions.patient_id WHERE diagnoses.label = 'mortality' AND DATEDIFF(admissions.dischtime, diagnoses.charttime) <= 6 * 30 AND admissions.dischtime IS NOT NULL GROUP BY admissions.patient_id, diagnoses.charttime ) AS T1 JOIN ( SELECT admissions.patient_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.patient_id = admissions.patient_id WHERE admissions.dischtime IS NOT NULL ) AS T2 ON T1.patient_id = T2.patient_id AND T1.charttime < T2.charttime WHERE DATEDIFF(T2.charttime, T1.charttime) <= 6 * 30 GROUP BY T2.icd_code ) AS T3 ) WHERE",,False,0.0,0.0005345344543457031,0,incomplete input,,,
c2cedc6cff27f2430e1a1578,"When was the first time patient 10026354 was diagnosed with dislocation of jaw, initial encounter since 2100?","SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dislocation of jaw, initial encounter' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1",SELECT DISTINCT ur.d_icd_procedures_time FROM microbiologyevents ur WHERE ur.chartkey IN ( SELECT od.chartkey FROM labevents od WHERE od.valuenum = ( SELECT MIN( ur.valuenum ) FROM microbiologyevents ur WHERE ur.chartkey IN ( SELECT od.chartkey FROM labevents od WHERE od.valuenum IS NOT NULL ) ) ) AND ur.chartkey IN ( SELECT od.chartkey FROM d_icd_procedures od WHERE od.icd_code = 'M9900' AND od.chartkey IN ( SELECT p.id FROM patients p WHERE p.age BETWEEN 50 AND 60 ) ),,False,0.0,0.0009708404541015625,0,no such column: ur.d_icd_procedures_time,,,
b8a7d87b64afb7722910bc4f,Was or cell saver intake given during their first ICU visit to patient 10009035?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*)>0 FROM intevents WHERE intevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.hcpcscodes = '12.96' ) AND intevents.charttime >= ( SELECT admissions.outtime FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.admission_location = 'intensive care unit' ORDER BY admissions.intime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],False,0.0,0.0010175704956054688,0,no such table: intevents,,,
ac9de4303d9e69514c759992,What was the organism found in the last urine microbiology test for patient 10038081?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT d_icd_procedures.key_value FROM d_icd_procedures WHERE d_icd_procedures.value = 'other' ) ) AND admissions.gender = ( SELECT admissions.gender FROM admissions WHERE admissions.row_id = ( SELECT d_icd_procedures.key_value FROM d_icd_procedures WHERE d_icd_procedures.value = 'other' ) ) ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'other' ) ORDER BY labevents.charttime DESC LIMIT 1,[],False,0.0,0.0009002685546875,0,"near ""AN"": syntax error",,,
7d6a60231fdec5e1629a3890,What is the maximum total hospital cost of a hospital involving esophageal obstruction?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal obstruction' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM(procedures_icd.cost) AS C1 FROM procedures_icd WHERE procedures_icd.icd_code = 'K22.2' GROUP BY procedures_icd.chartkey ) AS T1,,False,0.0,0.0010187625885009766,0,no such column: procedures_icd.cost,,,
e4389d5bea696426df9502a9,What is the maximum total cost for a hospital that includes laboratory testing for phenytoin?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phenytoin' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM(labevents.cost) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'phenytoin' ) GROUP BY labevents.hadm_id ) AS T1,,False,0.0,0.0009014606475830078,0,no such table: procedures,,,
52f44dd4ca70f2538c5fdcb9,How many patients received a diagnostic ultrasound of digestive system after the procedure of arteriography of other intra-abdominal arteries in 2100 within the same hospital visit?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM microbiome_study T1 JOIN ( SELECT T2.subject_id, T2.intime FROM procedures_icd T2 WHERE T2.procedures_icd = 'arteriography of other intra-abdominal arteries' AND strftime('%Y',T2.intime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.test_desc = 'diagnostic ultrasound of digestive system' AND T1.intime IS NOT NULL AND T2.intime IS NOT NULL AND datetime(T1.intime) >= datetime(T2.intime) AND T1.hadm_id = T2.hadm_id",,False,0.0,0.0009267330169677734,0,no such table: microbiome_study,,,
c09d11621a07d7d859c16278,When was the last time that patient 10014354 has the maximum SaO2 value since 08/19/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-19' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1","SELECT d1.charttime FROM d_icustays AS d2 JOIN d_labitems AS d1 ON d2.subject_id = d1.subject_id WHERE d2.icustay_id IN ( SELECT MIN(d3.icustay_id) FROM d_icustays AS d3 WHERE d3.age = ( SELECT T1.age FROM ( SELECT d_icustays.age, MIN(d_icustays.intime) AS first_intime FROM d_icustays WHERE d_icustays.age IS NOT NULL AND d_icustays.hospital_dischtime IS NOT NULL AND d_icustays.subject_id = 10014354 GROUP BY d_icustays.age ) AS T1 ORDER BY T1.first_intime ASC LIMIT 1 ) ) AND d1.itemid IN ( SELECT DISTINCT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 saturation pulseoxymetry' ) AND d1.valuenum = ( SELECT MAX(d1.valuenum) FROM d_labitems AS d1 WHERE d1.itemid IN ( SELECT DISTINCT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 saturation pulseoxymetry' ) AND d1.charttime >= '2100-08-19 00",[],False,0.0,0.0005464553833007812,0,incomplete input,,,
499ce7704b771e8824db29e3,Provide the sum of inputs for patient 10024043.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) ),SELECT SUM(input) FROM microbiologyevents WHERE patientid = 10024043,[{'SUM(inputevents.totalamount)': 6760.0}],False,0.0,0.0008664131164550781,0,no such column: input,,,
c8ca9d1df94e051908c998f8,When was patient 10009628 last prescribed with 0.9% sodium chloride and neostigmine at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10009628 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'neostigmine' AND admissions.subject_id = 10009628 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",SELECT DISTINCT T1.starttime FROM prescriptions AS T1 WHERE T1.drug = '0.9% sodium chloride' AND T1.hadm_id = 10009628 JOIN prescriptions AS T2 WHERE T2.drug = 'neostigmine' AND T2.hadm_id = 10009628 ON T1.starttime = T2.starttime ORDER BY T1.starttime DESC LIMIT 1,[],False,0.0,0.0008742809295654297,0,"near ""JOIN"": syntax error",,,
87cf5dab12223c160741d4a7,"What are the four most commonly prescribed drugs for patients who were diagnosed with urinary incontinence, unspecified previously within the same month?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary incontinence, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.label = 'urinary incontinence, unspecified' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 40 AND admissions.gender = 'male' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.chart_time,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,False,0.0,0.0006189346313476562,0,incomplete input,,,
cada9d0e90575a50cef72fe4,What was patient 10007818's diastolic blood pressure at the last measurement since 06/22/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-22' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT d.diastolic FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.chartkey IN ( SELECT m.chartkey FROM microbiology m WHERE m.spec_type_desc = 'blood culture' AND m.hospital_visit_id IN ( SELECT lo.hospital_visit_id FROM labevents lo WHERE lo.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.chartkey IN ( SELECT m.chartkey FROM microbiology m WHERE m.spec_type_desc = 'blood culture' AND m.hospital_visit_id IN ( SELECT lo.hospital_visit_id FROM labevents lo WHERE lo.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.chartkey IN ( SELECT m.chartkey FROM microbiology m WHERE m.spec_type_desc = 'blood culture' AND m.hospital_visit_id IN ( SELECT lo.hospital_visit_id FROM labevents lo WHERE lo.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.chartkey IN ( SELECT m.chartkey FROM microbiology m WHERE m.spec_type_desc = 'blood culture' AND m.hospital_visit_id = ( SELECT lo.hospital_visit_id FROM labevents lo WHERE lo.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.chartkey,[],False,0.0,0.0005371570587158203,0,incomplete input,,,
f97ed282c4c48f5e86f5b1e6,Is the value of patient 10019385's rdw-sd last measured on the last hospital visit less than the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'rdw-sd' ) ORDER BY labresults.charttime DESC LIMIT 1 ) < ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'rdw-sd' ) ORDER BY labresults.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",False,0.0,0.0008518695831298828,0,incomplete input,,,
4786a778a2cfb99246eefeb8,What is the average total cost of a hospital bill that includes a drug called ranitidine (liquid) since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ranitidine (liquid)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM( hospitalcosts.cost ) AS C1 FROM hospitalcosts WHERE hospitalcosts.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.label = 'ranitidine (liquid)' ) AND strftime('%Y',hospitalcosts.chargetime) >= '2100' GROUP BY hospitalcosts.hadm_id ) AS T1",,False,0.0,0.0009012222290039062,0,no such table: hospitalcosts,,,
43da3486df026843872b9af4,What was the admission type for patient 10019172's first hospital admission?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1","SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1",[],True,0.02884507179260254,0.02941274642944336,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 26, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
28070d8edf72fb2952e28930,Count the number of times patient 10040025 went to the hospital during this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10040025 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10040025 AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],False,0.0,0.0008959770202636719,0,no such column: patient_id,,,
b6e85f562fb3d32bcc7d415f,"Since 02/2100, what was patient 10021487's first microbiology test time?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 2100 AND admissions.gender = 'male' AND admissions.pid = 10021487 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2116-12-03 01:16:00'}],False,0.0,0.0009121894836425781,0,no such column: admissions.gender,,,
06fbb15466649cd31a1f3b18,What was the name of the organism found at the first pleural fluid test of patient 10014729 since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' AND admissions.year >= 2100 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'pleural fluid microbiology' AND procedures.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.valuenum = ( SELECT MIN( labevents.valuenum ) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' AND admissions.year >= 2100 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'pleural fluid microbiology' ) ) ) ) ORDER BY labevents.charttime ASC LIMIT 1,[],False,0.0,0.0005185604095458984,0,incomplete input,,,
bba49bd752af25f7a63d7766,What was the admission type for patient 10002930's last hospital admission?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10002930 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1","SELECT admissions.admission_type_desc FROM admissions WHERE admissions.chartitems_icustays_patientid = ( SELECT icustays.chartitems_icustays_patientid FROM icustays WHERE icustays.age = ( SELECT T1.age FROM ( SELECT icustays.chartitems_icustays_patientid, age(icustays.intime,'year') AS age FROM icustays WHERE icustays.patientid = 10002930 ) AS T1 ORDER BY T1.age DESC ) ) ORDER BY admissions.admittime DESC LIMIT 1",[{'admission_type': 'EU OBSERVATION'}],False,0.0,0.0009455680847167969,0,no such column: admissions.admission_type_desc,,,
93b59f146da8ee5c67716875,List the top four most frequent diagnoses that patients received in the same month after receiving hemodialysis in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.label = 'hemodialysis' AND procedures.spec_type IS NOT NULL AND strftime('%Y',procedures.spec_type) = '2100' GROUP BY admissions.subject_id ) AS T1 JOIN ( SELECT admissions.subject_id, d_icd_diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN d_icd_diagnoses ON diagnoses.icd_code = d_icd_diagnoses.icd_code WHERE strftime('%Y',diagnoses.charttime) = '2100' GROUP BY admissions.subject_id, d_icd_diagnoses.icd_code ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime,'start of month') = datetime(T1.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,False,0.0,0.0005373954772949219,0,incomplete input,,,
e56ea93964e30564ef0d8599,What is the four most frequently given microbiology tests since 2100 for patients who were previously diagnosed with cardiac arrest due to underlying cardiac condition in the same hospital encounter?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac arrest due to underlying cardiac condition' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, admissions.chartevents_event_id FROM admissions WHERE admissions.diagnoses = 'cardiac arrest due to underlying cardiac condition' AND strftime('%Y',admissions.admittime) >= '2100' ) AS T1 JOIN ( SELECT chartevents.chartevents_event_id, labevents.test_name FROM labevents JOIN chartevents ON labevents.stay_id = chartevents.stay_id WHERE labevents.test_name IN ( 'microbiology' ) AND strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.chartevents_event_id = T2.chartevents_event_id WHERE T1.admissions.subject_id IS NOT NULL GROUP BY T2.test_name ) AS T1 WHERE T1.C1 <= 4",,False,0.0,0.0005140304565429688,0,"unrecognized token: ""'m""",,,
e198cf387b6b22216a593d12,Please show the total amount of output patient 10004720 had since 02/08/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-08'","SELECT SUM(output.total_amount) FROM microbiologyevents AS output WHERE output.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004720 AND strftime('%Y-%m-%d',admissions.admittime) >= '2100-02-08' )",[{'SUM(outputevents.value)': 3733.0}],False,0.0,0.0009176731109619141,0,no such column: output.total_amount,,,
dc8216b0660d0fb91f366b9e,Have there been any procedures conducted on patient 10001725 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND chartevents.valuenum IS NOT NULL ) AND procedures_icd.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND microbiologyevents.valuenum IS NOT NULL ) AND procedures_icd.patient_id = 10001725,,False,0.0,0.0005486011505126953,0,incomplete input,,,
0645a48c714ef9774ca71964,Please list the three most common procedures carried out this year.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,True,0.14449238777160645,0.1455516815185547,0,,,,"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 29, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 64, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 78, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 140, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
bc8d116f59e4fd75687ea181,What new medications were introduced for patient 10004733 today compared to the ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT d.drug FROM   (   SELECT   u.stdtimes   FROM   microbiologyevents u   WHERE   u.hadm_id IN   (   SELECT   patients.hadm_id   FROM   patients   WHERE   patients.age >= 50   AND   patients.gender = 'male'   AND   patients.charttime IN   (   SELECT   MIN(T1.charttime)   FROM   patients AS T1   WHERE   T1.age >= 50   AND   T1.gender = 'male'   AND   T1.d_icd_diagnoses_icd = diagnoses_icd_icd   AND   T1.charttime >= datetime(current_time,'-1 year')   GROUP BY   T1.hadm_id   )   )   WHERE   u.spec_type_desc = 'blood culture'   AND   datetime(u.stdtimes) >= datetime(current_time,'-1 year')   ORDER BY   u.stdtimes ASC LIMIT   1 ) AS T1 JOIN   (   SELECT   u.drug   FROM   microbiologyevents u   WHERE   u.hadm_id IN   (   SELECT   patients.hadm_id   FROM   patients   WHERE   patients.age >= 50   AND   patients.gender = 'male'   AND   patients",[],False,0.0,0.0005548000335693359,0,"near ""WHERE"": syntax error",,,
19bcedd102d2f4e60b3948f6,Who are the top five requesters of lab tests?,,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,True,0.3289773464202881,0.330646276473999,5,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}, {'long_title': 'electrocardiogram'}, {'long_title': 'enteral infusion of concentrated nutritional substances'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 21, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 56, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 70, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 132, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
3e8b5080c946a24c2fb71498,Count the number of times that patient 10021487 during their first ICU visit had a or urine output.,SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ),SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10021487 AND charttime >= ( SELECT admittime FROM d_icustays WHERE patient_id = 10021487 AND stay_id IN ( SELECT MIN(stay_id) FROM d_icustays WHERE patient_id = 10021487 ) ) AND specimen_type = 'or urine' AND stay_id IN ( SELECT MIN(stay_id) FROM d_icustays WHERE patient_id = 10021487 ),[{'COUNT(*)': 0}],False,0.0,0.0009899139404296875,0,no such table: d_icustays,,,
e4072cdd311e5d56562630fe,"What are the three most commonly taken specimens that patients were tested during the same month after receiving a extirpation of matter from left femoral vein, percutaneous approach procedure throughout this year?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' )",,False,0.0,0.0010595321655273438,0,no such column: procedures_icd.long_title,,,
36c85f3d6859ff6ac14e46d4,What is the label assigned to ct #3 crepitus?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'ct #3 crepitus',SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'ct #3 crepitus',[],False,0.0,0.0010981559753417969,0,no such column: d_icd_procedures.short_title,,,
666f86f3566bfabb76e587a7,When was patient 10038992 last prescribed a drug via the neb route since 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT medications.starttime FROM medications WHERE medications.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10038992 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10038992 ) ) AND medications.route = 'neb' AND strftime('%Y-%m',medications.starttime) >= '2100-07' ORDER BY medications.starttime DESC LIMIT 1",[],False,0.0,0.0010406970977783203,0,no such table: medications,,,
878917a494e18bf3082ea4c4,Is SaO2 of patient 10031757 second measured on the first ICU visit greater than the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031757 ) AND labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'o2 saturation pulseoxymetry' ) AND labevents.charttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.age = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031757 ) AND labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'o2 saturation pulseoxymetry' ) AND labevents.charttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.age = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0005407333374023438,0,"near ""LIM"": syntax error",,,
ced205244613e91e3ff9ec97,Count the number of times patient 10021487 received replete with fiber (full) on this month/13.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'replete with fiber (full)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '13'","SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10021487 AND organism_name = 'replete with fiber (full)' AND datetime BETWEEN strftime('%Y-%m-01 00:00:00',current_time,'start of month', '-0 month') AND current_time END",[{'COUNT(*)': 0}],False,0.0,0.0009136199951171875,0,"near ""END"": syntax error",,,
0fae80f812674773157d9f2a,Can you specify the gender of patient 10022880?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10022880,SELECT COUNT(*) FROM patients WHERE patients.age = 10022880 AND patients.gender = 'male',[{'gender': 'M'}],False,0.0,0.0010182857513427734,0,no such column: patients.age,,,
40bd0f4265c38c258e1d9e19,Has there been any organism found in patient 10021118's last urine microbiological examination in 12/this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT COUNT(*)>0 FROM microbiologyevents WHERE organism_name IS NOT NULL AND patient_id = 10021118 AND specimen_type_desc = 'urine' AND charttime >= datetime(current_time,'start of year') AND datetime(current_time,'month') = 12 ORDER BY charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],False,0.0,0.0008628368377685547,0,no such column: organism_name,,,
01038856e72fffdbf13016be,Did patient 10025463 receive any lab testing in 11/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',labevents.charttime) = '2100-11'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.chartkey IN ( SELECT patients.chartkey FROM patients WHERE patients.subject_id = 10025463 ) AND strftime('%Y-%m',labevents.charttime) = '2100-11'",[{'COUNT(*)>0': 0}],False,0.0,0.0010447502136230469,0,no such column: patients.chartkey,,,
6236365bb1b1dab256878dbe,Has patient 10020187 been prescribed any medications?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ),"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT patients.chartevents_icustay_id FROM patients WHERE patients.age = 100 AND patients.gender = 'male' AND patients.admittime >= '2100-01-01' AND patients.d_icd_procedures_icd_code IS NOT NULL AND patients.chartevents_icustay_id IS NOT NULL AND patients.chartevents_icustay_id IN ( SELECT min(tmp1.icustay_id) FROM ( SELECT admissions.icustay_id, admissions.age, admissions.gender FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.admittime >= '2100-01-01' AND admissions.admittime IS NOT NULL AND admissions.admittime < datetime(current_time,'-0 year') AND admissions.hospital_dischtime IS NOT NULL ORDER BY admissions.admittime ASC ) AS tmp1 WHERE tmp1.icustay_id IN ( SELECT admissions.icustay_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.admittime >= '2100-01-01' AND admissions.admittime IS NOT NULL AND admissions.admittime < datetime(current_time,'-0 year') AND admissions.hospital_dischtime",[{'COUNT(*)>0': 1}],False,0.0,0.0005199909210205078,0,incomplete input,,,
ceb130d1950aa38990b64736,"What is the maximum total cost for a hospital that conducts a albumin, ascites lab test?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, ascites' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM( labevents.cost ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'albumin, ascites' ) GROUP BY labevents.hadm_id ) AS T1",,False,0.0,0.0008766651153564453,0,no such table: procedures,,,
20d7ef0b9116aab70a4d883c,"Since 07/2100, what was patient 10021938's last microbiology test time?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'microbiology' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = labevents.hadm_id ) ) AND labevents.valuenum IS NOT NULL AND labevents.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.admittime IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.charttime >= '2100-07-01' ORDER BY labevents.charttime DESC LIMIT 1,[{'charttime': '2181-10-25 12:00:00'}],False,0.0,0.0009860992431640625,0,no such table: procedures,,,
e56ed5e7a85bff472777e492,"Among patients in their 60 or above , what are the top three prescribed drugs?","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT d.drug FROM   (   SELECT   t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM     (       SELECT     u1.subject_id, lo1.charttime       FROM       labevents lo1       WHERE       lo1.valuenum IS NOT NULL       AND       lo1.spec_type_desc = 'ph'       AND       datetime(lo1.charttime,'start of year') = datetime(current_time,'start of year','-0 year')       GROUP BY     u1.subject_id, lo1.charttime       HAVING       avg(lo1.valuenum) >= 7.1 ) AS t1       JOIN       (       SELECT     u2.subject_id, lo2.charttime       FROM       labevents lo2       WHERE       lo2.valuenum IS NOT NULL       AND       lo2.spec_type_desc = 'ph'       AND       datetime(lo2.charttime,'start of year') = datetime(current_time,'start of year','-0 year')       GROUP BY     u2.subject_id, lo2.charttime       HAVING       avg(lo2.valuenum) >= 7.1 ) AS t2       ON       t1.subject_id = t2.subject_id       AND       t1.chart",,False,0.0,0.0005943775177001953,0,incomplete input,,,
6603175d4ba0c226f1b1404c,Can you tell me the cost of a lab immunoglobulin g test?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin g' ) ),SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'lab immunoglobulin g',,False,0.0,0.0008645057678222656,0,no such table: procedures,,,
ca656067a8e263ea627dff09,When did patient 10001217 receive a last diagnosis of cerebral edema on the last hospital visit?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral edema' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1,SELECT d.charttime FROM diagnosis d WHERE d.hadm_id IN ( SELECT o.hadm_id FROM outpatient o WHERE o.age = ( SELECT o.age FROM outpatient o WHERE o.pid = 10001217 AND o.dischtime IS NOT NULL ORDER BY o.admittime DESC LIMIT 1 ) ) AND d.label = 'cerebral edema' ORDER BY d.charttime DESC LIMIT 1,,False,0.0,0.0009438991546630859,0,no such table: diagnosis,,,
25b2ba84dbb2d8d8d138ee64,What was patient 10027445's first weight since 21 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-21 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT d.valuenum FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = 'Z00.0' ) AND d.charttime >= datetime(current_time,'-21 month') ORDER BY d.charttime ASC LIMIT 1",[],False,0.0,0.0008754730224609375,0,no such column: p.itemid,,,
809821a4009fe30207a67903,What is the average immunoglobulin a of patient 10029291 in 02/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin a' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '02'","SELECT AVG(d_icd_procedures_icd_items.charttime - patients.d_icd_procedures_icd_items.charttime) FROM d_icd_procedures_icd_items JOIN patients ON d_icd_procedures_icd_items.subject_id = patients.subject_id WHERE patients.age = 10029291 AND datetime(d_icd_procedures_icd_items.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',d_icd_procedures_icd_items.charttime) = '02' GROUP BY d_icd_procedures_icd_items.charttime",[{'AVG(labevents.valuenum)': None}],False,0.0,0.0009355545043945312,0,no such table: d_icd_procedures_icd_items,,,
3e4b52c69a2bdf36e4f03676,Retrieve the marital status of patient 10005866 during their last hospital encounter.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT d.valuenum FROM microbiologyevents d WHERE d.hadm_id IN ( SELECT b.hadm_id FROM labevents b WHERE b.itemid IN ( SELECT DISTINCT a.itemid FROM d_icd_procedures a WHERE a.long_title = 'insertion of intravenous infusion device into right internal jugular vein' ) AND b.valuenum IS NOT NULL ORDER BY b.charttime ASC LIMIT 1 ),[{'marital_status': 'SINGLE'}],False,0.0,0.0009806156158447266,0,no such column: d.valuenum,,,
7294971600b3da69c5f504bd,Can you tell me the name of the procedure that patient 10004720 received first?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ORDER BY procedures_icd.charttime ASC LIMIT 1 ),SELECT procedures.drug FROM procedures WHERE procedures.charteventscharteventskey IN ( SELECT chartevents.charteventskey FROM chartevents WHERE chartevents.age = ( SELECT MIN(chartevents.age) FROM chartevents WHERE chartevents.charteventskey IN ( SELECT admissions.charteventskey FROM admissions WHERE admissions.subjectid = 10004720 ) ) ) ORDER BY procedures.starttime ASC LIMIT 1,,False,0.0,0.0010814666748046875,0,no such table: procedures,,,
741720ef5045654c9099edd9,How much time in days has passed since the last time patient 10018081 was prescribed metronidazole (flagyl) in their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'metronidazole (flagyl)' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT T1.starttime FROM prescription AS T1 WHERE T1.drug = 'metronidazole (flagyl)' AND T1.hospital_visit_id IN ( SELECT T2.hospital_visit_id FROM microbiologyevents AS T2 WHERE T2.hospital_visit_id IN ( SELECT T3.hospital_visit_id FROM d_icustays AS T3 WHERE T3.age >= 0 AND T3.itemid IN ( SELECT T4.itemid FROM d_labitems AS T4 WHERE T4.label = 'platelets' ) AND T3.charttime IS NOT NULL ORDER BY T3.intime ASC LIMIT 1 ) ) ) ORDER BY T1.starttime DESC LIMIT 1 ) ) FROM dual",[],False,0.0,0.00061798095703125,0,incomplete input,,,
baa17b1b6e497c273e84c277,What is the percentile of 29.0 in a urea nitrogen lab test given the same age as patient 10015931 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 29.0","SELECT DISTINCT T1.C1 FROM ( SELECT DISTINCT patients.age FROM patients WHERE patients.charttime IS NOT NULL AND patients.charttime < patients.dischtime AND patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age IS NOT NULL ) AND patients.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10015931 AND patients.charttime IS NOT NULL AND patients.charttime < patients.dischtime AND patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age IS NOT NULL ) ORDER BY patients.charttime DESC LIMIT 1 ) ) AS T1 JOIN ( SELECT patients.age, labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM patients JOIN labevents ON patients.row_id = labevents.patient_id WHERE patients.charttime IS NOT NULL AND patients.charttime < patients.dischtime AND patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age IS NOT NULL ) AND labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'urea nitrogen' ) AND patients.age = T1.age ORDER BY labevents.charttime DESC LIMIT 1 ) AS T2 ON T1.age = T2.age WHERE T2",,False,0.0,0.0005331039428710938,0,incomplete input,,,
daad7a245a02c2817e1dab51,When did patient 10007818 last have a fecal bag event since 04/04/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'fecal bag' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-04' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stdiuretic = 'fecal bag' AND chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.row_id = 10007818 ) AND admissions.gender = ( SELECT DISTINCT patients.gender FROM patients WHERE patients.row_id = 10007818 ) ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-04-04' ORDER BY chartevents.charttime DESC LIMIT 1",[],False,0.0,0.0009152889251708984,0,no such column: chartevents.stdiuretic,,,
555bf9cbad590421927df2cd,"How many patients received a ultrasonography of superior vena cava, guidance procedure in the same hospital encounter after having a introduction of nutritional substance into upper gi, via natural or artificial opening procedure since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ultrasonography of superior vena cava, guidance' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study a JOIN microbiome_study b ON a.hospital_visit_id = b.hospital_visit_id WHERE a.spec_type_desc = 'introduction of nutritional substance into upper gi, via natural or artificial opening' AND b.spec_type_desc = 'ultrasonography of superior vena cava, guidance' AND strftime('%Y',a.start_time) >= '2100' AND a.start_time < b.start_time",,False,0.0,0.0008959770202636719,0,no such table: microbiome_study,,,
fc8557d25a51b1ae5a699bdb,"Since 07/2100, when was the last time that patient 10031757 was prescribed both lactated ringers and metronidazole (flagyl) at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MIN(T1.starttime) FROM prescription AS T1 WHERE T1.hadm_id IN ( SELECT T2.hadm_id FROM prescription AS T2 WHERE T2.drug = 'metronidazole (flagyl)' AND T2.hadm_id = 10031757 ) AND T1.drug = 'lactated ringers' AND T1.hadm_id = 10031757 AND strftime('%Y-%m',T1.starttime) >= '2100-07' AND datetime(T1.starttime) < datetime(T2.starttime) GROUP BY T1.hadm_id HAVING MIN(T1.starttime) = ( SELECT MAX(T3.starttime) FROM prescription AS T3 WHERE T3.drug = 'lactated ringers' AND T3.hadm_id IN ( SELECT T4.hadm_id FROM prescription AS T4 WHERE T4.drug = 'metronidazole (flagyl)' AND T4.hadm_id = 10031757 ) AND T3.hadm_id = 10031757 AND strftime('%Y-%m',T3.starttime) >= '2100-07' AND datetime(T3.starttime) < datetime(T2.starttime) GROUP BY T3.hadm_id )",[],False,0.0,0.0005691051483154297,0,incomplete input,,,
85870a86f06622ea71a7764e,"How many patients are marked ""emergency department observation"" as a transfer care unit in 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT transfers.careplan_sid FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0007808208465576172,0,no such column: transfers.careplan_sid,,,
75687ea1705bf35f720606d4,Tell me the number of times patient 10027602 got a cerebral ventricular #1 since 01/23/2100.,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cerebral ventricular #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-23'",SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10027602 AND organism_name = 'cerebral ventricular #1' AND charttime >= '2100-01-23',[{'COUNT(*)': 0}],False,0.0,0.0008552074432373047,0,no such column: patient_id,,,
bbc6747e134e489a305733da,What was patient 10005348's age on the last hospital stay?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,"SELECT DISTINCT patients.age FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 21004 ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime >= patients.admittime AND patients.d_icd_procedures_icd_code IS NOT NULL ) AND patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 21004 ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime >= patients.admittime AND patients.d_icd_procedures_icd_code IS NOT NULL ) ORDER BY patients.admittime DESC, chartevents.charttime DESC LIMIT 1",,False,0.0,0.0005314350128173828,0,incomplete input,,,
5db87efd687aa472406c44c6,Has patient 10015931 been prescribed medication since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y',prescriptions.starttime) >= '2100'",SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT patients.chartevents_icustay_id FROM patients WHERE patients.age >= 2100 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = '10015931' ),[{'COUNT(*)>0': 1}],False,0.0,0.0009233951568603516,0,no such column: patients.chartevents_icustay_id,,,
347a2cad20161a15e564ef29,What is the average total hospital cost that includes a procedure called central venous catheter placement with guidance since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.label = 'central venous catheter placement with guidance' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures.subject_id ) AS T1",,False,0.0,0.0009746551513671875,0,no such table: procedures,,,
089417994ad72edcca9f8050,Count the number of patients who had insertion of intercostal catheter for drainage within 2 months after having been diagnosed with home accidents since 2100.,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'home accidents' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of intercostal catheter for drainage' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study a JOIN microbiome_study b ON a.subject_id = b.subject_id WHERE a.spec_type_desc = 'home accidents' AND b.spec_type_desc = 'insertion of intercostal catheter for drainage' AND datetime(b.starttime,'start of year') >= datetime(datetime('2100-01-01 00:00:00'),'start of year') AND datetime(a.starttime) < datetime(b.starttime) AND datetime(b.starttime) BETWEEN datetime(a.starttime) AND datetime(a.starttime,'+2 month')",,False,0.0,0.0014052391052246094,0,no such table: microbiome_study,,,
4344afd25464e3304de00b90,What was patient 10013049's length of stay in days in the last ICU stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT DISTINCT T1.C1 FROM ( SELECT PROCEDURETABLEPROCEDUREOFFSET, PROCEDURETABLEICUSTAY_ID FROM PROCEDUREEVENTS WHERE PROCEDUREEVENTS.chartkey IN ( SELECT MIN(OUTPATIENTVISIT.chartkey) FROM OUTPATIENTVISIT WHERE OUTPATIENTVISIT.patientid = 10013049 ) ) AS T1 JOIN ( SELECT PROCEDURETABLEPROCEDUREOFFSET, PROCEDURETABLEICUSTAY_ID FROM PROCEDUREEVENTS WHERE PROCEDUREEVENTS.chartkey IN ( SELECT MIN(OUTPATIENTVISIT.chartkey) FROM OUTPATIENTVISIT WHERE OUTPATIENTVISIT.patientid = 10013049 ) ) AS T2 ON T1.PROCEDURETABLEPROCEDUREOFFSET < T2.PROCEDURETABLEPROCEDUREOFFSET WHERE T1.PROCEDURETABLEICUSTAY_ID = T2.PROCEDURETABLEICUSTAY_ID AND T1.ICUSTAY_ID IN ( SELECT ICU_ADMISSIONS.ICUSTAY_ID FROM ICU_ADMISSIONS WHERE ICU_ADMISSIONS.age = ( SELECT MIN(ICU_ADMISSIONS.age) FROM ICU_ADMISSIONS WHERE ICU_ADMISSIONS.icustay_id IN ( SELECT PROCEDUREEVENTS.icustay_id FROM PROCEDUREEVENTS","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.1769212959334254}]",False,0.0,0.0005092620849609375,0,incomplete input,,,
94d8481d364db4cbd70b366f,How much does patient 10005817 weigh based on the first measurement taken since 10/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-10' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT weight_val FROM microbiom_icustays_icustaypatients WHERE icustaypatients.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.age >= 10 AND icustays.age < 100 AND icustays.gender = 'male' AND icustays.admission_location = 'emergency room' ) AND microbiom_icustays_icustaypatients.patient_id = 10005817 ORDER BY microbiom_icustays_icustaypatients.charttime ASC LIMIT 1,[],False,0.0,0.0008945465087890625,0,no such table: microbiom_icustays_icustaypatients,,,
693650b24cdfd7b8135da88e,What does it cost for a history of falling diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'history of falling' ) ),SELECT DISTINCT d.cost FROM diagnosis d WHERE d.label = 'history of falling',,False,0.0,0.0011954307556152344,0,no such table: diagnosis,,,
21768a606512998a1ee96c2a,Count the number of patients who were diagnosed with chronic hepatitis c without mention of hepatic coma but didn't come back to the hospital within the same month.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic hepatitis c without mention of hepatic coma' ) ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic hepatitis c without mention of hepatic coma' ) ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND datetime(T2.charttime,'start of month') = datetime(admissions.admittime,'start of month') )","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiologyevents a JOIN d_icd_procedures b ON a.hospital_visit_id = b.hospital_visit_id WHERE b.long_title = 'chronic hepatitis c without mention of hepatic coma' AND a.spec_type_desc = 'blood culture' AND datetime(a.charttime,'start of month') = datetime(current_time,'start of month','-0 month') EXCEPT SELECT COUNT( DISTINCT a.subject_id ) FROM microbiologyevents a JOIN d_icd_procedures b ON a.hospital_visit_id = b.hospital_visit_id WHERE b.long_title = 'chronic hepatitis c without mention of hepatic coma' AND a.spec_type_desc = 'blood culture' AND datetime(a.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",,False,0.0,0.0009160041809082031,0,no such column: b.long_titl,,,
712595edb391862c04d6ec79,Calculate the length of stay in days for patient 10022041's first hospital stay.,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT 1 * ( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","[{""strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime)"": 5.008333332836628}]",True,0.028496742248535156,0.02895951271057129,1,,"[{""1 * ( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) )"": 5.008333332836628}]","[""1 * ( strftime('%J', admissions.dischtime) - strftime('%J', admissions.admittime) )""]","[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 25, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
00ddca0abfcd2315f0c91ce6,What are the three commonly taken specimens for patients who received control of epistaxis by anterior nasal packing previously during the same hospital encounter?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'control of epistaxis by anterior nasal packing' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T1.spec_type_desc FROM ( SELECT patients.subject_id, procedures.drug FROM procedures WHERE procedures.label = 'control of epistaxis by anterior nasal packing' AND procedures.starttime IS NOT NULL GROUP BY patients.subject_id ) AS T2 JOIN ( SELECT patients.subject_id, labevents.spec_type_desc FROM labevents WHERE labevents.spec_type_desc IS NOT NULL AND labevents.valuenum IS NOT NULL GROUP BY patients.subject_id ) AS T1 ON T2.patients.subject_id = T1.patients.subject_id WHERE T2.procedures.drug IS NOT NULL AND T1.labevents.spec_type_desc IS NOT NULL AND T2.patients.subject_id IN ( SELECT T3.patients.subject_id FROM ( SELECT patients.subject_id, procedures.drug FROM procedures WHERE procedures.label = 'control of epistaxis by anterior nasal packing' AND procedures.starttime IS NOT NULL GROUP BY patients.subject_id ) AS T4 JOIN ( SELECT patients.subject_id, admissions.subject_id FROM admissions WHERE admissions.dischtime IS NOT NULL GROUP BY patients.subject_id ) AS T3 ON T4.patients.subject_id = T3.patients.subject_id WHERE T4.procedures.drug IS NOT NULL AND T3.admissions.dischtime IS NOT NULL ) AND T1.labevents.val",,False,0.0,0.0009391307830810547,0,no such table: procedures,,,
6457fac9c63ce0f20ad03c9c,"For patients who underwent (aorto)coronary bypass of three coronary arteries in 2100, what were the top four most frequent procedures that followed within the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of three coronary arteries' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime, admissions.admittime, admissions.dischtime, admissions.age, admissions.gender, admissions.admission_location, admissions.discharge_location, admissions.admission_type, admissions.admission_source FROM admissions WHERE admissions.age IS NOT NULL AND admissions.admission_type = 'emergency' AND admissions.admission_source = 'emergency room' AND admissions.dischtime IS NOT NULL AND strftime('%Y',admissions.dischtime) = '2100' AND admissions.age >= 50 GROUP BY admissions.subject_id, admissions.admittime ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.charttime, procedures.icd_code, procedures.itemid FROM admissions JOIN procedures ON admissions.subject_id = procedures.subject_id WHERE admissions.age IS NOT NULL AND admissions.admission_type = 'emergency' AND admissions.admission_source = 'emergency room' AND admissions.dischtime IS NOT NULL AND strftime('%Y',admissions.dischtime) = '2100' AND admissions.age >=",,False,0.0,0.0005257129669189453,0,incomplete input,,,
879dfc7ea11934d27bc66bc7,Can you name the top three diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY T2.C2 ASC ) AS C3 FROM ( SELECT T1.icd_code, AVG(C1) AS C2 FROM ( SELECT patients.d_icd_diagnoses_icd_code, ( CASE WHEN patients.dischtime IS NOT NULL AND patients.outtime IS NOT NULL THEN datetime(patients.outtime) - datetime(patients.dischtime) ELSE 0 END ) / 1.0 AS C1 FROM patients WHERE patients.age BETWEEN 50 AND 60 AND strftime('%Y',patients.admittime) = '2100' GROUP BY patients.d_icd_diagnoses_icd_code, patients.row_id ) AS T1 JOIN ( SELECT d_icd_diagnoses_icd_code, AVG(C1) AS C1 FROM ( SELECT patients.d_icd_diagnoses_icd_code, ( CASE WHEN patients.dischtime IS NOT NULL AND patients.outtime IS NOT NULL THEN datetime(patients.outtime) - datetime(patients.dischtime) ELSE 0 END ) / 1.",,False,0.0,0.0005440711975097656,0,incomplete input,,,
d50f340e88f09cf2749021b3,"What are the three most commonly ordered lab tests for patients diagnosed with hyperkalemia previously during the same hospital encounter, this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperkalemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_labitems.itemname FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, admissions.charttime, admissions.dischtime, admissions.hospital_id FROM admissions WHERE admissions.hospital_id = ( SELECT MIMICIII.d_icd_procedures_icd_code_map.key_value FROM MIMICIII.d_icd_procedures_icd_code_map WHERE MIMICIII.d_icd_procedures_icd_code_map.value = 'hyperkalemia' ) AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY admissions.subject_id, admissions.charttime, admissions.dischtime, admissions.hospital_id ) AS T1 JOIN ( SELECT admissions.subject_id, admissions.charttime, admissions.dischtime, admissions.hospital_id FROM admissions WHERE admissions.hospital_id = ( SELECT MIMICIII.d_icd_procedures_icd_code_map.key_value FROM MIMICIII.d_icd_procedures_icd_code_map WHERE MIMICIII.d_icd_procedures_icd_code_map.value = 'hyperkalemia'",,False,0.0,0.0006518363952636719,0,incomplete input,,,
3a0be19d3169bb19a1452e68,"How many hours were there since patient 10021487 was first diagnosed with injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum in their current hospital visit?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IN ( SELECT prescriptions.charttime FROM prescriptions WHERE prescriptions.drug = 'injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum' ) AND admissions.admission_type = 'current hospital' ) AND admissions.patient_id = 10021487 ) AND datetime(microbiologyevents.charttime) >= datetime( admissions.charttime ) WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IN ( SELECT prescriptions.charttime FROM prescriptions WHERE prescriptions.drug = 'injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum' ) AND admissions.admission_type = 'current hospital' ) AND admissions.patient_id = 10021487 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1",,False,0.0,0.0005476474761962891,0,incomplete input,,,
c0b91d07e6910a05f93e87aa,When did patient 10019172 have his/her last input since 09/07/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-07' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.admittime >= datetime(current_time,'-1 year') ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'input' ) AND labevents.valuenum IS NOT NULL AND strftime('%Y-%m-%d',labevents.charttime) >= '2100-09-07' ORDER BY labevents.charttime DESC LIMIT 1",[{'starttime': '2118-11-19 19:30:00'}],False,0.0,0.001008749008178711,0,no such table: procedures,,,
d72094c1906f3a46217599bb,What are the three most common microbiology tests done since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT T1.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents AS T1 JOIN d_icd_procedures AS T2 ON T1.spec_type_desc = T2.long_title WHERE strftime('%Y',T1.charttime) >= '2100' GROUP BY T1.spec_type_desc ) AS T WHERE T.C1 <= 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]",False,0.0,0.0009398460388183594,0,no such column: T2.spec_type_desc,,,
8de87b88f6cd77d22fb75b7a,How many hours have been since the first time patient 10021487 was diagnosed with traumatic hemothorax without mention of open wound into thorax in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic hemothorax without mention of open wound into thorax' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers_icd diagnoses_icd events_icd   WHERE diagnoses_icd.icd_code = 'S360' AND diagnoses_icd.chartkey = transfers_icd.chartkey AND transfers_icd.careunit = 'hospital' AND transfers_icd.dischtime IS NOT NULL ORDER BY transfers_icd.admittime ASC LIMIT 1 ) ) FROM events_icd   WHERE events_icd.chartkey = ( SELECT transfers_icd.chartkey FROM transfers_icd   WHERE transfers_icd.careunit = 'hospital' AND transfers_icd.dischtime IS NOT NULL ORDER BY transfers_icd.admittime ASC LIMIT 1 )",,False,0.0,0.0005230903625488281,0,"near ""diagnoses_icd"": syntax error",,,
71f42d6affc0c51c8579d29f,Find out the number of patients who were discharged from the hospital.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 180733}],True,0.0849916934967041,0.08545184135437012,1,,[{'COUNT( DISTINCT admissions.subject_id )': 172553}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
84ac2bfd0420a297e0a26258,What is the total po intake amount that patient 10000032 received since 07/09/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-09'","SELECT SUM(d.intakeamount) FROM microbiologyevents d WHERE d.spec_type_desc = 'po intake' AND d.itemid IN ( SELECT f.itemid FROM labevents f WHERE f.charttime IN ( SELECT e.charttime FROM labevents e WHERE e.hadm_id IN ( SELECT c.hadm_id FROM patients c WHERE c.age >= 0 AND c.gender = 'male' AND c.pid = 10000032 ) ) ) AND strftime('%Y-%m-%d',d.charttime) >= '2100-07-09'",[{'SUM(inputevents.totalamount)': None}],False,0.0,0.0010209083557128906,0,no such column: d.intakeamount,,,
10099f05b84afe98cf07a47e,What was the name of drug patient 10020740 was prescribed in the same hospital visit after receiving a other laparoscopic umbilical herniorrhaphy procedure since 01/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other laparoscopic umbilical herniorrhaphy' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-01' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT d.drug FROM prescriptions d WHERE d.hadm_id IN ( SELECT o.hadm_id FROM procedures o WHERE o.label = 'other laparoscopic umbilical herniorrhaphy' AND o.charttime >= '2100-01-01' ) AND d.hadm_id IN ( SELECT t.hadm_id FROM prescriptions t WHERE t.drug = 'ketorolac' AND t.starttime IS NOT NULL AND t.stoptime IS NOT NULL AND t.starttime >= strftime('%Y-%m-%d 00:00:00',o.charttime) AND strftime('%Y-%m',o.charttime) = strftime('%Y-%m',t.starttime) ) ORDER BY d.starttime ASC LIMIT 1",,False,0.0,0.0009708404541015625,0,no such table: procedures,,,
91c770552e4894cdd9ea0079,How many patients were tested this year for staph aureus swab?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'staph aureus swab' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age >= 18 AND patients.age < 85 AND patients.gender = 'male' EXCEPT SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age >= 18 AND patients.age < 85 AND patients.gender = 'female' FROM patients JOIN microbiologyevents ON patients.subject_id = microbiologyevents.subject_id WHERE microbiologyevents.spec_type_desc = 'staph aureus swab' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY patients.gender",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009779930114746094,0,"near ""FROM"": syntax error",,,
c8a2241d70df2c163edad761,What was patient 10039997's last value of the heart rate since 08/13/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-13' ORDER BY chartevents.charttime DESC LIMIT 1",SELECT d.valuenum FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = 'heart rate' ) AND d.charttime >= '2100-08-13' AND d.hadm_id IN ( SELECT m.hadm_id FROM patients m WHERE m.age >= 50 AND m.gender = 'male' AND m.ethnicity = 'not of hispanic or latino origin' ) ORDER BY d.charttime DESC LIMIT 1,[],False,0.0,0.0014982223510742188,0,no such column: p.itemid,,,
de4d2a4ef0f92ed118449a87,What's the total number of patients in hematology/oncology since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.hcpcspc_desc = 'hematology/oncology' AND strftime('%Y',patients.intime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009677410125732422,0,no such column: patients.hcpcspc_desc,,,
baa84499707e958def958609,What were the top four most frequent diagnoses that patients were given within 2 months after being diagnosed with encounter for attention to tracheostomy since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for attention to tracheostomy' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT subject_id, stay_id FROM microbiome_stays WHERE strftime('%Y',starttime) >= '2100' ) JOIN ( SELECT subject_id, visit_id, icd_code FROM microbiome_icd WHERE microbiome_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for attention to tracheostomy' ) AND strftime('%Y',microbiome_icd.charttime) >= '2100' ) ON microbiome_stays.subject_id = microbiome_icd.subject_id WHERE microbiome_stays.stay_id = microbiome_icd.visit_id GROUP BY microbiome_stays.subject_id, microbiome_stays.stay_id ) AS t2 JOIN ( SELECT subject_id, stay_id FROM microbiome_stays WHERE strftime('%Y',starttime) >= '2100' ) JOIN ( SELECT subject_id, visit_id, ic",,False,0.0,0.0008895397186279297,0,"unrecognized token: ""'encounter for attention t""",,,
84564eb53eb9b3302bd9acf8,Can you tell me the top four most common microbiology tests that occurred in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT T1.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents AS T1 JOIN d_icd_procedures AS T2 ON T1.spec_type_desc = T2.long_title WHERE strftime('%Y',T1.charttime) = '2100' GROUP BY T1.spec_type_desc ) AS T WHERE T.C1 <= 4",[],False,0.0,0.0008530616760253906,0,no such column: T2.spec_type_desc,,,
c4b26c0ae57a5f77fcd0c46d,Has patient 10022281 been prescribed a drug since 24 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')",SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT patients_icustays.icustay_id FROM patients_icustays WHERE patients_icustays.age >= 24 AND patients_icustays.age < 25 AND patients_icustays.chartevents_icustay_id IN ( SELECT chartevents_icustay_id FROM chartevents WHERE chartevents.valuenum = 10022281 ) ),[{'COUNT(*)>0': 1}],False,0.0,0.0011258125305175781,0,no such table: patients_icustays,,,
d6ab8927156136206a55d8a8,"During the current hospital visit, has patient 10021487 been prescribed with readi-cat 2 (barium sulfate 2% suspension), plasmalyte, or acetazolamide sodium?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'readi-cat 2 (barium sulfate 2% suspension)', 'plasmalyte', 'acetazolamide sodium' )",SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.current_hadm_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = 'J3300' ),[{'COUNT(*)>0': 0}],False,0.0,0.0009810924530029297,0,no such column: patients.current_hadm_id,,,
3e7993dbfd153fc21c01b640,How much is the minimum total cost for the hospital visits that include sevelamer carbonate since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'sevelamer carbonate' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(I1.cost) AS C1 FROM labevents I1 WHERE I1.spec_type_desc = 'sevelamer carbonate' AND datetime(I1.charttime) >= datetime(current_time,'-1 year') GROUP BY I1.charttime, I1.itemid ) AS T1",,False,0.0,0.0008563995361328125,0,no such column: I1.cost,,,
dc671c0fb18f291e1d417779,What was patient 10004235's last output time of foley on 03/19/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-19' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT d1.charttime FROM labevents d1 WHERE d1.hadm_id IN ( SELECT d2.hadm_id FROM patients d2 WHERE d2.age >= 0 AND d2.gender = 'male' AND d2.id = 10004235 ) AND d1.valuenum = ( SELECT MIN(d3.valuenum) FROM labevents d3 WHERE d3.hadm_id IN ( SELECT d4.hadm_id FROM patients d4 WHERE d4.age >= 0 AND d4.gender = 'male' AND d4.id = 10004235 ) AND d3.itemid IN ( SELECT d5.itemid FROM labitems d5 WHERE d5.label = 'foley' ) AND strftime('%Y-%m-%d',d3.charttime) = '2100-03-19' )",[],False,0.0,0.0012903213500976562,0,no such table: labitems,,,
cb5bf7d37033da680feb9abe,How many visits did patient 10026354 make to the hospital throughout this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026354 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = ( SELECT patients.age FROM patients WHERE patients.row_id = microbiologyevents.hadm_id ) AND visits.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = microbiologyevents.hadm_id ) AND datetime(visits.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ) WHERE microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = microbiologyevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = microbiologyevents.hadm_id ) AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ) AND microbiologyevents.hadm_id = 10026354 AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],False,0.0,0.0018253326416015625,0,"near ""WHERE"": syntax error",,,
5efdb746ec678cf4fc384eaa,How is chlorhexidine gluconate 0.12% oral rinse delivered?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse',SELECT DISTINCT procedures.drug FROM procedures WHERE procedures.spec_type = 'chlorhexidine gluconate 0.12% oral rinse',[],False,0.0,0.0012118816375732422,0,no such table: procedures,,,
0d61464fe9f411c1b299ffef,Count the number of times that patient 10009035 in 12/last year had a or urine output.,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',outputevents.charttime) = '12'","SELECT COUNT(*) FROM ur_out WHERE patient_id = 10009035 AND datetime(datetime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',datetime) = '12'",[{'COUNT(*)': 0}],False,0.0,0.0010662078857421875,0,no such table: ur_out,,,
a0863c97c9dcec30264c3abd,Name the output that patient 10037975 had for the last time?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 ),SELECT d.output FROM microbiologyevents d WHERE d.spec_type_desc = 'output' AND d.hadm_id IN ( SELECT t1.hadm_id FROM patients t1 WHERE t1.age >= 50 AND t1.gender = 'male' AND t1.charttime IS NOT NULL ORDER BY t1.charttime DESC LIMIT 1 ),[{'label': 'Foley'}],False,0.0,0.0009696483612060547,0,no such column: d.output,,,
caf20c3c07abb81f1fb4ce13,What are the methods for ingesting oxymetazoline?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'oxymetazoline',SELECT DISTINCT procedures.drug FROM procedures WHERE procedures.drug = 'oxymetatizoline' AND procedures.route = 'ingest',"[{'route': 'NU'}, {'route': 'IN'}, {'route': 'NAS'}]",False,0.0,0.00116729736328125,0,no such table: procedures,,,
e256c7b08d9dde3880221886,"List the top three most frequent diagnoses that were given to patients within the same month after they were diagnosed with other dependence on machines, supplemental oxygen.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other dependence on machines, supplemental oxygen' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other dependence on machines, supplemental oxygen' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,False,0.0,0.000591278076171875,0,"near ""JOI"": syntax error",,,
b96e8ac58176933b9e0ee2b3,What are the five most commonly tested specimens for patients that were diagnosed with unarmed fight or brawl previously within 2 months?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unarmed fight or brawl' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE labevents.spec_type_desc = 'urine' AND admissions.age BETWEEN 20 AND 30 AND admissions.gender = 'male' AND admissions.admission_location = 'emergency room' GROUP BY admissions.subject_id, labevents.charttime HAVING DATEDIFF(labevents.charttime, admissions.admittime) BETWEEN 0 AND 2 ) AS t1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 20 AND 30 AND admissions.gender = 'male' AND admissions.admission_location = 'emergency room' AND procedures.icd_code = 'W22' GROUP BY admissions.subject_id, procedures.icd_code, procedures.charttime HAVING DATEDIFF(procedures.charttime, admissions.admittime) BETWEEN 0 AND 2 )",,False,0.0,0.001291513442993164,0,incomplete input,,,
a13bd95a1540c1bc4c4568db,Can you tell me the last ferritin lab reading for patient 10020740 in 03/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.ethnicity = 'not of hispanic origin' AND admissions.died_time IS NOT NULL ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'ferritin' ) AND labevents.hadm_id = 10020740 AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.0014789104461669922,0,no such table: procedures,,,
60e8ab147beb8159de92a539,How much is the average total cost of a hospital visit that includes a free calcium lab test in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'free calcium' ) ) AND strftime('%Y',procedures.charttime) = '2100' GROUP BY procedures.hadm_id ) AS T1",,False,0.0,0.0016150474548339844,0,no such table: procedures,,,
67269f11d04e63d8d4a6aaf1,"List the top five most frequent procedures that patients underwent within the same month after being diagnosed with diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled in 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime,'start of month') = datetime(T1.charttime,'start of month') GROUP BY T2.icd_code ) AS T",,False,0.0,0.0005426406860351562,0,"unrecognized token: ""'diabetes mellitus without mention of complication, type ii or""",,,
fbf3603d3d2d818a10d4d5b4,"Among patients who were diagnosed with acute alcoholic intoxication in alcoholism, continuous during this year, what are the top five most commonly prescribed medications that followed in the same hospital encounter for patients in their 50s?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time, admissions.hospital_discharge_time, admissions.hospital_encounter_id FROM diagnoses JOIN admissions ON diagnoses.hospital_encounter_id = admissions.hospital_encounter_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism' ) AND datetime(diagnoses.chart_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS t1 JOIN ( SELECT admissions.subject_id, prescriptions.drug FROM admissions JOIN prescriptions ON admissions.hospital_encounter_id = prescriptions.hospital_encounter_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.chart_time < t2.drug AND datetime",,False,0.0,0.0006878376007080078,0,incomplete input,,,
2675abf72b38410bb4eda4ad,What proportion of patients with a diagnosis of acetonuria survive over a 6-month period?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/2 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acetonuria' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT patients.subject_id, patients.d_icd_procedures_icd_links_key FROM patients WHERE patients.age BETWEEN 30 AND 40 ) AS T1 JOIN ( SELECT patients.subject_id, patients.d_icd_procedures_icd_links_key FROM patients WHERE patients.age BETWEEN 30 AND 40 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.d_icd_procedures_icd_links_key IN ( SELECT procedures_icd.d_icd_procedures_icd_links_key FROM procedures_icd WHERE procedures_icd.long_title = 'diagnosis of acetonuria' ) AND T2.d_icd_procedures_icd_links_key IN ( SELECT procedures_icd.d_icd_procedures_icd_links_key FROM procedures_icd WHERE procedures_icd.long_title = 'survive' ) AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+6 month')",,False,0.0,0.0009961128234863281,0,incomplete input,,,
811d7b1ce1d2dbdbb4648a1b,What procedure was performed on patient 10021938 two times since 11 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-11 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT procedures.drug FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT T1.chartevents_row_id FROM ( SELECT chartevents.chartevents_row_id, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT T2.chartevents_row_id FROM ( SELECT chartevents.chartevents_row_id, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT T3.chartevents_row_id FROM ( SELECT chartevents.chartevents_row_id, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT T4.chartevents_row_id FROM ( SELECT chartevents.chartevents_row_id, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT T5.chartevents_row",,False,0.0,0.0006971359252929688,0,incomplete input,,,
bdf2adbc5d802891bf0837c2,"In 2100, how many patients received pantoprazole in the same hospital encounter after being diagnosed with defibrination syndrome?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'defibrination syndrome' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study c JOIN ( SELECT DISTINCT o.subject_id, o.hadm_id FROM labevents o WHERE o.itemid IN ( SELECT DISTINCT p1.charttime_from FROM ( SELECT m1.charttime, m1.valuenum, m1.itemid, m1.hadm_id FROM labevents m1 WHERE m1.itemid IN ( SELECT DISTINCT p2.itemid FROM procedures_icd p2 WHERE p2.icd_code = 'defibrination syndrome' ) AND strftime('%Y',m1.charttime) = '2100' ) AS p1 JOIN labevents m2 ON p1.valuenum = m2.valuenum AND p1.charttime < m2.charttime AND p1.hadm_id = m2.hadm_id WHERE m2.itemid IN ( SELECT DISTINCT p3.itemid FROM procedures_icd p3 WHERE p3.icd_code = 'defibrination syndrome' ) AND strftime('%Y',m2.charttime) = '2100' ) AS a ON c.subject_id = a.subject_id WHERE c.species = 'bacteroides' AND strftime('%Y',c.start_time) = '2100'",,False,0.0,0.0007684230804443359,0,incomplete input,,,
6d14fafef38d93f2e020c386,"Count how many times in the first hospital encounter patient 10018328 experienced the restriction of left internal carotid artery with intraluminal device, percutaneous approach procedure.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )","SELECT COUNT(*) FROM procedureevents WHERE procedureevents.chartitems_key IN ( SELECT chartitems.key FROM chartitems WHERE chartitems.valuenum = 10018328 AND chartitems.chart_type = 'hospital' ) AND procedureevents.label = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' AND procedureevents.linksto = 'first'",[{'COUNT(*)': 0}],False,0.0,0.001008749008178711,0,no such table: procedureevents,,,
f5d1341aa772a131aa8ee445,How many patients were diagnosed with personal history of malignant neoplasm of large intestine in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'personal history of malignant neoplasm of large intestine' AND strftime('%Y',procedures.charttime) = '2100' )",,False,0.0,0.0011837482452392578,0,no such table: procedures,,,
b26e5939c6b846e6073358d5,How many prescription drugs were ordered for patient 10018328 during their last hospital visit?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),"SELECT COUNT(*) FROM prescription WHERE prescription.hadm_id IN ( SELECT hospital.chart.hadm_id FROM hospital.chart WHERE hospital.chart.age = ( SELECT T1.age FROM ( SELECT hospital.chart.age, hospital.chart.charttime, DENSE_RANK() OVER ( ORDER BY hospital.chart.charttime DESC ) AS C1 FROM hospital.chart WHERE hospital.chart.hadm_id IN ( SELECT hospital.admission.hadm_id FROM hospital.admission WHERE hospital.admission.age = ( SELECT T2.age FROM ( SELECT hospital.admission.age, hospital.admission.admittime, DENSE_RANK() OVER ( ORDER BY hospital.admission.admittime DESC ) AS C1 FROM hospital.admission WHERE hospital.admission.gender = 'male' AND hospital.admission.age IS NOT NULL AND hospital.admission.agesex = 'age' AND hospital.admission.insurance = 'medicare' AND hospital.admission.died_icu = 0 AND hospital.admission.careunit = 'med/surg' AND hospital.admission.admission_location = 'emergency room' AND hospital.admission.dischtime IS NOT NULL ) AS T2 WHERE T2.C1 = 1 ) ) WHERE hospital.chart.hadm_id IN ( SELECT hospital.admission.hadm_id FROM hospital.admission WHERE hospital.admission.age = (",[{'COUNT(*)': 101}],False,0.0,0.0006852149963378906,0,incomplete input,,,
e5b73688391845090eacc355,"How many patients got a amylase, ascites test since 1 year ago?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'amylase, ascites' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0013735294342041016,0,no such table: procedures,,,
b8b5e892b7594cca173fde8a,What label corresponds to volume not removed?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'volume not removed',SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'volume not removed',[],False,0.0,0.0013065338134765625,0,no such column: d_icd_procedures.short_title,,,
36d8a80cdf21d731b910f6bf,What are the four most common microbiology tests for people who were diagnosed with dysthymic disorder earlier within 2 months?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysthymic disorder' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T1.spec_type_desc FROM ( SELECT T3.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents AS T2 JOIN d_icd_procedures ON T2.spec_type_desc = d_icd_procedures.long_title JOIN ( SELECT DISTINCT ON ( patients.chartkey ) patients.chartkey FROM patients JOIN d_icd_diagnoses ON patients.chartkey = d_icd_diagnoses.chartkey WHERE d_icd_diagnoses.long_title = 'dysthymic disorder' ) AS T1 ON T2.chartkey = T1.chartkey JOIN ( SELECT T4.chartkey, T4.charttime FROM ( SELECT patients.chartkey, d_icd_diagnoses.charttime FROM patients JOIN d_icd_diagnoses ON patients.chartkey = d_icd_diagnoses.chartkey WHERE d_icd_diagnoses.long_title = 'dysthymic disorder' ) AS T4 JOIN ( SELECT patients.chartkey, d_icd_diagnoses.charttime FROM patients JOIN d_icd_diagnoses ON patients.chartkey = d_icd_diagnoses.chartkey WHERE d_icd_diagnoses.long_title = 'dysthymic disorder' ) AS T5 ON T",,False,0.0,0.0009298324584960938,0,"near ""ON"": syntax error",,,
8e97f8923eae1120693cf379,Is the value of mchc of patient 10026255 second measured on the last hospital visit less than it was first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0007903575897216797,0,"unrecognized token: ""'mch""",,,
103963052c1ac6130cd2db9a,What is the sum of patient 10003046's or urine output during the last ICU visit.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ),SELECT SUM(d_icuchartevents.totalamount) FROM d_icuchartevents WHERE d_icuchartevents.hadm_id IN ( SELECT d_icustays.hadm_id FROM d_icustays WHERE d_icustays.age = ( SELECT DISTINCT(age) FROM patients WHERE patients.subject_id = 10003046 ) ) AND d_icuchartevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.label = 'or urine output' AND chartevents.hadm_id IN ( SELECT d_icustays.hadm_id FROM d_icustays WHERE d_icustays.age = ( SELECT DISTINCT(age) FROM patients WHERE patients.subject_id = 10003046 ) ) ORDER BY chartevents.charttime ASC LIMIT 1 ) GROUP BY d_icuchartevents.hadm_id ORDER BY d_icuchartevents.charttime DESC LIMIT 1,[{'SUM(outputevents.value)': None}],False,0.0,0.000774383544921875,0,incomplete input,,,
411239af52a2ceaa4e79d867,How many prescription drugs were ordered for patient 10020944 since 24 months ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definitions.linksto FROM definitions WHERE definitions.long_title = 'daily weight' ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime >= datetime(current_time,'-24 month') ) AND prescriptions.spec_type_desc = 'prescription drugs' AND prescriptions.chartevents_icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definitions.linksto FROM definitions WHERE definitions.long_title = 'daily weight' ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime >= datetime(current_time,'-24 month') ) AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10020944 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10020944 ) )",[{'COUNT(*)': 103}],False,0.0,0.0008449554443359375,0,incomplete input,,,
c2eed970bacaf0f9bea1ccbc,What are the four most frequently ordered medications that male patients aged 20s were prescribed within 2 months after they were diagnosed with mitral valve disorders since 1 year ago?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mitral valve disorders' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 20 AND 29 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures.icd_code FROM procedures WHERE procedures.chartkey IN ( SELECT patients.chartkey FROM patients WHERE patients.gender = 'male' AND patients.age BETWEEN 20 AND 29 ) AND procedures.label = 'mitral valve disorders' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') )",,False,0.0,0.0011572837829589844,0,no such table: procedures,,,
cd9067d6c88100bac2cc82c3,What are the three most commonly tested specimens since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT d.spec_type_desc FROM   ( SELECT   labevents.itemid,   d_icd_procedures.long_title,   d_icd_procedures.short_title,   d_icd_diagnoses.long_title,   d_labitems.label,   d_items.label,   d_labs.label,   d_icd_chapters.long_title,   d_icd_tables.long_title,   d_icd_cost.keys,   d_icd_outcomes.long_title,   d_icd_products.long_title,   d_icd_ethnicgroups.long_title,   d_icd_race.long_title,   d_icd_procedures_icdlong_title,   d_icd_diagnoses_icdlong_title,   d_labitems_std.label,   d_items_std.label,   d_labs_std.label,   d_icd_chapters_std.long_title,   d_icd_tables_std.long_title,   d_icd_cost_std.keys,   d_icd_outcomes_std.long_title,   d_icd_products_std.long_title,   d_icd_ethnicgroups_std.long_title,   d_icd_race_std.long_title,   d_icd_procedures_icdlong_title_std,   d_icd_diagnoses_icdlong_title_std FROM   d_ic","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]",False,0.0,0.0007164478302001953,0,incomplete input,,,
b38138698b912a998a6f74f3,Count the number of patients for whom vial was prescribed within 2 months post their diagnosis of secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes in 2100.,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vial' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT prescriptions.subject_id FROM prescriptions WHERE prescriptions.drug = 'vial' AND prescriptions.starttime IS NOT NULL AND strftime('%Y',prescriptions.starttime) = '2100' ) AND patients.subject_id IN ( SELECT diagnoses.subject_id FROM diagnoses WHERE diagnoses.label = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes' AND strftime('%Y',diagnoses.charttime) = '2100' ) HAVING T1.starttime BETWEEN T2.charttime AND datetime(T2.charttime,'+2 month')",,False,0.0,0.0012865066528320312,0,incomplete input,,,
84db978ffae9e37098b5f315,What were the top three most common treatments given to patients in their 40s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.drug FROM ( SELECT drugs.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM patients JOIN microbiologyevents ON patients.chartkey = microbiologyevents.chartkey WHERE patients.age BETWEEN 40 AND 49 AND strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY drugs.drug ) AS T1 WHERE T1.C1 <= 3",,False,0.0,0.0012934207916259766,0,no such column: drugs.drug,,,
3de4eeab52c93e43309156d7,Has any medication been designated for patient 10029484 in 04/last year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT patients_icustays.icustay_id FROM patients_icustays WHERE patients_icustays.patient_id = 10029484 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)>0': 0}],False,0.0,0.0017478466033935547,0,no such table: patients_icustays,,,
ccedb8f78a6736b132f3b079,Tell me the organism that was detected in the last urine test of patient 10031757 during their last hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organisms.org_name FROM organisms WHERE organisms.test_type = 'urine' AND organisms.spec_type = 'last' AND organisms.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hospital' ) ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[],False,0.0,0.0011506080627441406,0,no such table: organisms,,,
135380cceeececcc1d31beb3,Did patient 10021666 come into an ER on their first hospital encounter?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*)>0 FROM er_visits WHERE er_visits.chart_id IN ( SELECT admissions.chart_id FROM admissions WHERE admissions.age BETWEEN 50 AND 60 AND admissions.gender = 'male' AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND er_visits.chart_id = 10021666,[{'COUNT(*)>0': 0}],False,0.0,0.00127410888671875,0,no such table: er_visits,,,
4b72e7b13c37b47053d926d9,Can you provide the monthly maximum output of pre-admission for patient 10022041?,"SELECT MAX(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission' AND d_items.linksto = 'outputevents' ) GROUP BY strftime('%Y-%m',outputevents.charttime)","SELECT MAX( d_icd_procedures_icd_id ) FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'pre-admission' AND d_icd_procedures.icd_id IN ( SELECT procedures_icd_id FROM procedures WHERE procedures.subject_id = 10022041 ) GROUP BY strftime('%Y-%m',procedures.charttime) ORDER BY strftime('%Y-%m',procedures.charttime) ASC",[],False,0.0,0.0016481876373291016,0,no such table: procedures,,,
390c4f9e4e7b5c353eff9da7,What was the last dose of potassium chl 20 meq / 1000 ml d5lr prescribed to patient 10016810?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.currentrc FROM transfers WHERE transfers.prevrc IN ( SELECT admissions.row_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' ) ) ) AND admissions.gender = 'male' AND admissions.age = 50 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[],False,0.0,0.0010895729064941406,0,no such column: transfers.currentrc,,,
bbcb03fc3471db9511c31648,What are the total inputs given to patient 10018845 since 03/27/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-27'",SELECT SUM(input) FROM labevents WHERE labevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT admissions.age FROM admissions WHERE admissions.pid = 10018845 ) AND admissions.pid = 10018845 ) ) AND labevents.charttime >= '2100-03-27 00:00:00',[{'SUM(inputevents.totalamount)': 5390.0}],False,0.0,0.0012319087982177734,0,no such column: input,,,
0c5a19d98fb21ee7f7415577,"What drug was patient 10021118 prescribed with during the same day after receiving bypass coronary artery, one artery from left internal mammary, open approach this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT d.drug FROM prescriptions d WHERE d.hadm_id IN ( SELECT t1.hadm_id FROM procedures t1 WHERE t1.label = 'bypass coronary artery, one artery from left internal mammary, open approach' AND t1.charttime BETWEEN datetime(current_time,'start of month') AND datetime(current_time) ) AND d.hadm_id = 10021118 AND datetime(d.starttime,'start of day') = datetime(procedures.charttime,'start of day') AND procedures.charttime < d.starttime THIS MONTH",,False,0.0,0.001094818115234375,0,"near ""THIS"": syntax error",,,
633d7843ff15021b4c6b6ac9,Tell me the marital status of patient 10012853 in their last hospital encounter.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT d.valuenum FROM microbiologyevents d WHERE d.hadm_id IN ( SELECT b.hadm_id FROM labevents b WHERE b.itemid IN ( SELECT DISTINCT a.itemid FROM d_icd_procedures a WHERE a.long_title = 'other excision of brain' ) AND b.valuenum IS NOT NULL ORDER BY b.charttime ASC LIMIT 1 ),[{'marital_status': 'WIDOWED'}],False,0.0,0.001737833023071289,0,no such column: d.valuenum,,,
a4371b693f24038ad04881c2,"Was patient 10005909 prescribed with 0.9% sodium chloride, bag, or duloxetine during the first hospital visit?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( '0.9% sodium chloride', 'bag', 'duloxetine' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.gender = 'male' AND admissions.age >= 50 AND admissions.admission_type = 'emergency room' ORDER BY admissions.admittime ASC LIMIT 1 ) AND admissions.gender = 'male' AND admissions.age >= 50 AND admissions.admission_type = 'emergency room' ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( '0.9% sodium chloride, bag', 'duloxetine' )",[{'COUNT(*)>0': 0}],False,0.0,0.0007336139678955078,0,"near ""AS"": syntax error",,,
473f0352cd0b38c085ce1628,What is the difference between weights on patient 10038933 second measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'weight' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'weight' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.000957489013671875,0,"unrecognized token: ""'wei""",,,
7536a12b6079eeb3ed78aa85,What is the maximum total cost of the hospital visits that included the drug named fenofibrate since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fenofibrate' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.chartkey IN ( SELECT procedures.chartkey FROM procedures WHERE procedures.label = 'fenofibrate' AND strftime('%Y',procedures.starttime) >= '2100' GROUP BY procedures.chartkey ) GROUP BY procedures.chartkey ) AS T1",,False,0.0,0.001369476318359375,0,no such table: procedures,,,
647fbc4c18dc9b7300f25187,Count the number of days since patient 10021487's first diagnosis of other chronic nonalcoholic liver disease on the current hospital encounter.,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other chronic nonalcoholic liver disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT COUNT(DISTINCT strftime('%J',current_time) - strftime('%J', d_icd_procedures.charttime)) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other chronic nonalcoholic liver disease' ) AND d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10021487 AND admissions.dischtime IS NULL ) AND admissions.admittime < current_time ) ORDER BY d_icd_procedures.charttime ASC LIMIT 1",,False,0.0,0.0007166862487792969,0,incomplete input,,,
ab2159e2914558a41cd56bff,What was the ciprofloxacin hcl dosage that patient 10019172 had been prescribed in 11/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.drug = 'ciprofloxacin hcl' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin hcl' AND prescriptions.hadm_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11'",[{'SUM(prescriptions.dose_val_rx)': None}],False,0.0,0.001659393310546875,0,no such column: admissions.gender,,,
efc169498c87c222d5b7020b,When was the last stool microbial test done in patient 10002495 since 04/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND microbiologyevents.spec_type_desc = 'stool' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'stool microbial' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10002495 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10002495 ) ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.0015299320220947266,0,no such table: procedures,,,
729c62dcfd9ac11a32a56161,Has patient 10015860 been prescribed a drug since 1 year ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT patients.chartevents_icustay_id FROM patients WHERE patients.age>1 AND patients.gender='male' AND patients.chartevents_icustay_id IN ( SELECT admissions.chartevents_icustay_id FROM admissions WHERE admissions.age>1 AND admissions.gender='male' AND admissions.dischtime IS NOT NULL AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ) AND patients.chartevents_icustay_id IN ( SELECT procedures.chartevents_icustay_id FROM procedures WHERE procedures.chartevents_icustay_id IN ( SELECT patients.chartevents_icustay_id FROM patients WHERE patients.age>1 AND patients.gender='male' AND patients.chartevents_icustay_id IN ( SELECT admissions.chartevents_icustay_id FROM admissions WHERE admissions.age>1 AND admissions.gender='male' AND admissions.dischtime IS NOT NULL AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ) ) AND procedures.label = 'arterial blood gases' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') ) AND prescriptions.drug = 'docusate sodium' AND datetime(prescriptions.starttime) >= datetime(current_time,'-",[{'COUNT(*)>0': 1}],False,0.0,0.0008990764617919922,0,incomplete input,,,
9c733436d319028b982e6657,Can you show the top five most frequently prescribed drugs?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT d.drug FROM   ( SELECT   d.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiologyevents m   JOIN   d_icd_procedures d   ON   m.spec_type_desc = d.key   WHERE   d.table_name = 'prescriptions'   GROUP  BY   d.drug ) AS t   WHERE   t.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]",False,0.0,0.0016543865203857422,0,no such column: d.drug,,,
a3585e47c9d9845ccde194bf,"Has patient 10037975 been given a creatinine, urine test since 15 months ago?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND datetime(labevents.charttime) >= datetime(current_time,'-15 month')","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND labevents.valuenum IS NOT NULL AND datetime(labevents.charttime) >= datetime(current_time,'-15 month')",[{'COUNT(*)>0': 0}],False,0.0,0.0012662410736083984,0,no such column: admissions.stay_id,,,
fed90306e7ed0344ed0a3b7d,Was patient 10021487 given any dextrose 5% on this month/07?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '07'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 10021487 AND organism_name = 'dextrose 5%' AND datetime(document_time,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',document_time) = '07'",[{'COUNT(*)>0': 0}],False,0.0,0.0017712116241455078,0,no such column: patient_id,,,
52f6bc8e9873cce45456c38e,Can you specify the gender of patient 10025463?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10025463,SELECT COUNT(*) FROM patients WHERE patients.age = 10025463 AND patients.gender = 'male',[{'gender': 'M'}],False,0.0,0.0012664794921875,0,no such column: patients.age,,,
7b18e66852f4386ce57b39c1,Has there been any mrsa screen microbiology test done for patient 10029484 since 09/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09'",SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 18 AND admissions.gender = 'male' AND admissions.charttime >= '2100-09-01' ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'mrsa screen' ) AND admissions.subject_id = 10029484,[{'COUNT(*)>0': 0}],False,0.0,0.0015223026275634766,0,no such table: definition,,,
a4e1867554fe617ae563f780,Calculate the total volume of drainage bag for patient 10021487 on this month/17.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'drainage bag' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '17'","SELECT SUM(d_icd_procedures.charttime - d_icd_procedures.prevcharttime) FROM d_icd_procedures WHERE d_icd_procedures.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10021487 AND datetime(admissions.admittime) >= datetime(current_time,'start of month','-1 month') ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND d_icd_procedures.spec_type_desc = 'drainage bag' AND datetime(d_icd_procedures.charttime,'start of month') = datetime(current_time,'start of month') AND d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.pid = 10021487 AND datetime(admissions.admittime) >= datetime(current_time,'start of month','-1 month') ) AND d_icd_procedures.charttime >= datetime(current_time,'start of month') AND d_icd_procedures.charttime < datetime(current_time,'start of month 1 day') + 1 day - 1 sec AND strftime('%d',d_icd",[{'SUM(outputevents.value)': None}],False,0.0,0.0013670921325683594,0,"near ""DE"": syntax error",,,
b216e416603adce99fc11398,"Among those who were prescribed with lidocaine 0.5%, what are the five most commonly prescribed drugs at the same time since 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lidocaine 0.5%' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT d.drug FROM   (   SELECT   t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   (       SELECT   u1.subject_id, lo1.starttime   FROM   labevents lo1       WHERE   lo1.itemid IN (       SELECT   DISTINCT t2.itemid       FROM   d_icd_procedures t2       WHERE   t2.long_title = 'lidocaine 0.5%' )     AND strftime('%Y',lo1.starttime) >= '2100'     ) AS t1       JOIN   (       SELECT   u2.subject_id, lo2.starttime   FROM   labevents lo2       WHERE   lo2.itemid IN (       SELECT   DISTINCT t3.itemid       FROM   d_icd_procedures t3       WHERE   t3.long_title = 'lidocaine 0.5%' )     AND strftime('%Y',lo2.starttime) >= '2100'     ) AS u2 ON t1.subject_id = u2.subject_id       WHERE   t1.starttime < u2.starttime       GROUP BY   t1.drug ) AS t4     JOIN   d_icd_procedures d ON t4.drug",[],False,0.0,0.0008158683776855469,0,incomplete input,,,
2340588e1e30b4204874ee2d,What were the three most frequently taken lab tests this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT d_labitems.itemname FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],False,0.0,0.0012145042419433594,0,no such column: d_labitems.itemname,,,
04e0b332c01bf8b36c4973b5,Was the mean blood pressure of patient 10014729 ever less than 79.0 on 03/07/this year?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 79.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '03-07'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.valuenum < 79.0 AND labevents.itemid IN ( SELECT chartevents.itemid FROM d_icd_items WHERE d_icd_items.long_title = 'mean blood pressure' AND d_icd_items.linksto = 'labevents' ) AND labevents.charttime BETWEEN datetime(current_time,'start of year') AND datetime(current_time,'start of year','+1 year','-1 day') AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.pid = 10014729 ) AND datetime(labevents.charttime,'start of day') = datetime(current_time,'start of year','+0 year','03/07')",[{'COUNT(*)>0': 0}],False,0.0,0.0007491111755371094,0,incomplete input,,,
636e9b1dbf501867d3e6e18b,How many patients went through a blood (toxo) microbiology test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood (toxo)' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'blood (toxo) microbiology' AND datetime(procedures.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0010066032409667969,0,no such table: procedures,,,
56cc41f276a6e10711d396f4,When was patient 10004720's first microbiology test done?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT admissions.age FROM admissions WHERE admissions.pid = 10004720 ) AND admissions.pid = 10004720 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'charttime': '2186-11-13 12:00:00'}],False,0.0,0.0009777545928955078,0,no such column: admissions.pid,,,
cfe831c90fd2c89d0116f576,What was the name of the drug that patient 10019385 is first prescribed via td route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT transfers.intime FROM transfers WHERE transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT events.hadm_id FROM events WHERE events.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.valuenum = 10019385 AND chartitems.chart = 'events' ) ) ORDER BY transfers.intime ASC LIMIT 1 ) ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1,[],False,0.0,0.0010378360748291016,0,no such table: events,,,
463e41b4b414a3258b0bbab5,What's the maximum total cost of the hospital visits when they involve diagnostic ultrasound of digestive system since 1 year ago?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.label = 'diagnostic ultrasound of digestive system' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures.charttime, procedures.admittime ) AS T1",,False,0.0,0.0009636878967285156,0,no such table: procedures,,,
cfce5f7c561e0bbfd11e26e0,"How much does drainage of pericardial cavity with drainage device, percutaneous approach cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' ) )","SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'drainage of pericardial cavity with drainage device, percutaneous approach'",,False,0.0,0.0009527206420898438,0,no such table: procedures,,,
90a33678a92aaf96e62fc2a2,Find the number of patients who were admitted to the hospital during the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009074211120605469,0,no such column: admissions.patient_id,,,
536c8f181f6fd31f9a127cfa,What were the number of patients discharged from the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 180733}],True,0.0830543041229248,0.0835123062133789,1,,[{'COUNT( DISTINCT admissions.subject_id )': 172553}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
2c065386f4cdb6f367bcf87b,How many patients got a mch test in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y',labevents.charttime) = '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT labevents.subject_id FROM labevents WHERE labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'mch' ) AND strftime('%Y',labevents.charttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009398460388183594,0,no such table: definition,,,
53eee4b8cfb226d8418ce3fa,What procedure did patient 10007818 receive for the last time in this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures_icd.charttime DESC LIMIT 1 )",SELECT procedures.drug FROM procedures WHERE procedures.charteventschartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents.chartevents,,False,0.0,0.0009653568267822266,0,"near ""."": syntax error",,,
c86ef1c99a73bd58d05ad456,How many days have passed since patient 10021487 stayed in the careunit emergency department during the current hospital visit for the last time?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1","SELECT DISTINCT T1.d_icd_procedures_icd_id FROM ( SELECT procedures_icd_id, patients.age, patients.gender, patients.d_icd_procedures_icd_id, patients.charttime, patients.hadm_id FROM patients WHERE patients.age IS NOT NULL AND patients.gender IS NOT NULL AND patients.d_icd_procedures_icd_id IS NOT NULL AND patients.charttime IS NOT NULL AND patients.hadm_id IS NOT NULL AND patients.age = ( SELECT MIN(patients.age) FROM patients WHERE patients.d_icd_procedures_icd_id IS NOT NULL AND patients.charttime IS NOT NULL AND patients.hadm_id IS NOT NULL AND patients. subject_id = 10021487 ) ) AS T1 JOIN ( SELECT procedures_icd_id, patients.age, patients.gender, patients.d_icd_procedures_icd_id, patients.charttime, patients.hadm_id FROM patients WHERE patients.age IS NOT NULL AND patients.gender IS NOT NULL AND patients.d_icd_procedures_icd_id IS NOT NULL AND patients.charttime IS NOT NULL AND patients.hadm_id IS NOT NULL AND patients.age = ( SELECT MIN(patients.age) FROM patients WHERE patients.d_icd_procedures_icd_id IS NOT NULL AND patients.charttime IS NOT NULL AND patients.hadm_id IS NOT",[],False,0.0,0.0005366802215576172,0,incomplete input,,,
ec94ea0d33b90b977c958e6d,How many patients have been admitted currently?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL,[{'COUNT( DISTINCT admissions.subject_id )': 0}],True,0.0313105583190918,0.0323481559753418,1,,[{'COUNT( DISTINCT admissions.subject_id )': 3433}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
7431290c2ccaa0fdcb10a27d,What are the three most frequently ordered medications that female patients aged 60 or above were prescribed within 2 months after they were diagnosed with unspecified essential hypertension in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'other' ),,False,0.0,0.0009472370147705078,0,no such column: procedures_icd.long_title,,,
867b31660f489ea1d519e617,How many patients since 1 year ago underwent a blood (ebv) test?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood (ebv)' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age >= 1 AND patients.age < 2 AND patients.d_icd_procedures_icd_code = '00.71' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009067058563232422,0,no such column: patients.age,,,
80d095627a05abf538ea0c80,"What are the three most commonly tested specimens for patients that were diagnosed with secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified previously in the same month, since 1 year ago?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT d.spec_type FROM   ( SELECT   t1.itemid, d_icd_procedures.long_title, d_labitems.long_title AS spec_type, d_icd_diagnoses.long_title, strftime('%Y-%m',t1.charttime) AS c1 FROM   labevents t1 JOIN patients ON t1.hadm_id = patients.hadm_id JOIN d_labitems ON t1.itemid = d_labitems.itemid JOIN d_icd_diagnoses ON patients.age = d_icd_diagnoses.valuenum JOIN d_icd_procedures ON t1.itemid = d_icd_procedures.itemid WHERE   d_icd_diagnoses.long_title = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' AND datetime(t1.charttime) >= datetime(current_time,'-1 year') ) AS d JOIN   ( SELECT   t1.itemid, d_icd_procedures.long_title, d_labitems.long_title AS spec_type, d_icd_diagnoses.long_title, strftime('%Y-%m',t1.charttime) AS c1 FROM   labevents t1 JOIN patients ON t1.hadm_id = patients.hadm_id JOIN d_labitems ON t1.itemid = d",,False,0.0,0.0006451606750488281,0,"unrecognized token: ""'secondary diabetes mellitus without mention""",,,
028f7b61531a4e8e6da28cd3,"For patients diagnosed with other and unspecified angina pectoris previously, what are the top four most common procedures applied within the same hospital visit since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_procedures_key IN ( SELECT T3.icd_procedures_key FROM ( SELECT T2.icd_procedures_key, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT subject_id, stay_id FROM diagnosis WHERE diagnosis.icd_codes = '413.9' AND strftime('%Y',diagnosis.charttime) >= '2100' ) AS T1 JOIN ( SELECT subject_id, stay_id, icd_procedures_key FROM procedureevents WHERE strftime('%Y',procedureevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id AND T1.stay_id = T2.stay_id WHERE T1.charttime < T2.charttime GROUP BY T2.icd_procedures_key ) AS T3 WHERE T3.C1 <= 4 )",,False,0.0,0.0007836818695068359,0,incomplete input,,,
46231873609912fe8e1019e7,Count the number of patients who since 2100 were prescribed pregabalin.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'pregabalin' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT( DISTINCT dr.stay_id ) FROM microbiome dr WHERE dr.drug = 'pregabalin' AND strftime('%Y',dr.starttime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 3}],False,0.0,0.0014965534210205078,0,no such table: microbiome,,,
0d3f767c99e8d250fc86ba71,Was patient 10015272's mcv second measured on the last hospital visit greater than the value from the first measurement on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'mcv' ) ORDER BY labresults.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'mcv' ) ORDER BY labresults.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0007557868957519531,0,incomplete input,,,
8cfda20a9826789d8b58747a,How much does patient 10018423 change in systolic blood pressure last measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT labitems.valuenum FROM labitems WHERE labitems.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labitems.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'arterial blood pressure systolic' ) ORDER BY labitems.charttime DESC LIMIT 1 ) - ( SELECT labitems.valuenum FROM labitems WHERE labitems.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labitems.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'arterial blood pressure systolic' ) ORDER BY labitems.charttime ASC LIMIT 1 )","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0007441043853759766,0,"unrecognized token: ""'arteria""",,,
0ee20c63c4be119281d02113,Count the number of patients who were tested throughout this year for vitamin b12.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT labevents.subject_id FROM labevents WHERE labevents.valuenum IS NOT NULL AND labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'vitamin b12' ) ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0013260841369628906,0,no such table: definition,,,
92b8f8b9f70e026d369cdfbd,Has there been any mrsa screen microbiology test result for patient 10003046 throughout this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM microbiologyevents WHERE patients.age IN ( SELECT patients.age FROM patients WHERE patients.charttime IS NOT NULL AND patients.charttime >= datetime(current_time,'start of year','-0 year') AND patients.age = ( SELECT patients.age FROM patients WHERE patients.id = 10003046 ) ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND microbiologyevents.org_name != '' AND microbiologyevents.test_name IS NOT NULL AND microbiologyevents.test_name != '' AND microbiologyevents.test_name = 'mrsa screen' AND microbiologyevents.hemoglobin IS NOT NULL AND microbiologyevents.hemoglobin != '' AND microbiologyevents.wbc IS NOT NULL AND microbiologyevents.wbc != '' AND microbiologyevents.platelets IS NOT NULL AND microbiologyevents.platelets != '' AND microbiologyevents.ph IS NOT NULL AND microbiologyevents.ph != '' AND microbiologyevents.potassium IS NOT NULL AND microbiologyevents.potassium != '' AND microbiologyevents.sodium IS NOT NULL AND microbiologyevents.sodium != '' AND microbiologyevents.urine_output IS NOT NULL AND microbiologyevents.urine_output != '' AND microbiologyevents.glucose IS NOT NULL AND",[{'COUNT(*)>0': 0}],False,0.0,0.0013613700866699219,0,no such column: patients.age,,,
0298d7de83dc23f17441f202,Were there any procedures conducted on patient 10006580 during the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND chartevents.valuenum IS NOT NULL ) AND procedures_icd.age BETWEEN 0 AND 89 AND procedures_icd.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age BETWEEN 0 AND 89 AND patients.gender = 'male' AND patients.charttime IS NOT NULL ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND chartevents.valuenum IS NOT NULL ) AND procedures_icd.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age BETWEEN 0 AND 89 AND patients.gender = 'male' AND patients.charttime IS NOT NULL ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND procedures_icd.person_id",,False,0.0,0.0008559226989746094,0,incomplete input,,,
eea838bba39870d24a4fe781,Tell me what patient 10018501's void output was since 06/05/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05'","SELECT SUM(inputoutput.totalamount) FROM inputoutput WHERE inputoutput.type = 'void' AND inputoutput.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = inputoutput.row_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = inputoutput.row_id ) ) AND inputoutput.charttime >= '2100-06-05' EXPLAIN SELECT SUM(inputoutput.totalamount) FROM inputoutput WHERE inputoutput.type = 'void' AND inputoutput.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = inputoutput.row_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = inputoutput.row_id ) ) AND inputoutput.charttime >= '2100-06-05' AND inputoutput.charttime < strftime('%Y-%m-%d 00:00:00', '2100-06-05', '+1 day')",[{'SUM(outputevents.value)': None}],False,0.0,0.0018246173858642578,0,"near ""EXPLAIN"": syntax error",,,
0e4bb22781a9b0bc9dedffb9,When did patient 10004733 first have the minimum number of specific gravity on the current hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'specific gravity' ) AND labevents.hospital_visit_id IN ( SELECT current_hospital_visit FROM patients WHERE patients.chart_id = 10004733 ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],False,0.0,0.0015811920166015625,0,no such table: procedures,,,
2a853454c790cac539c5c85d,"On 11/16/2100, did patient 10006053 have any cryoprecipitate input?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cryoprecipitate' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-11-16'","SELECT COUNT(*)>0 FROM prescription WHERE patient_id = 10006053 AND prescription.drug = 'cryoprecipitate' AND strftime('%Y-%m-%d',prescription.starttime) = '2100-11-16'",[{'COUNT(*)>0': 0}],False,0.0,0.0008955001831054688,0,no such table: prescription,,,
9b79fc00bb70e04132ba060c,What is the number of times that patient 10018081 had ostomy (output) since 12/03/2100?,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ostomy (output)' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-03'","SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10018081 AND microbiologyevents.spec_type_desc = 'ostomy (output)' AND strftime('%Y-%m-%d',microbiologyevents.charttime) >= '2100-12-03'",[{'COUNT(*)': 0}],False,0.0,0.0008833408355712891,0,no such column: patient_id,,,
7022bd51f5732800e05583f3,"In 2100, how many patients were diagnosed with other specified forms of effusion, except tuberculous during the same hospital encounter after being diagnosed with injury to thoracic aorta?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to thoracic aorta' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified forms of effusion, except tuberculous' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study c JOIN microbiome_study b ON c.hhold = b.hhold WHERE c.spec_type_desc = 'other specified forms of effusion, except tuberculous' AND b.spec_type_desc = 'injury to thoracic aorta' AND strftime('%Y',c.starttime) = '2100'",,False,0.0,0.0008831024169921875,0,no such table: microbiome_study,,,
bdb9a3e39281b6f931c8ce45,"Since 2100, what are the top five most frequently given diagnoses that patients received within 2 months after being diagnosed with gout, unspecified?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gout, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT subject_id, admissions.charttime FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 2100 GROUP BY subject_id ) AS t1 JOIN ( SELECT subject_id, admissions.charttime, d_icd_diagnoses.long_title, d_icd_diagnoses.icd_code FROM admissions JOIN d_icd_diagnoses ON admissions.dischtime IS NOT NULL AND admissions.age >= 2100 WHERE d_icd_diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gout, unspecified' ) GROUP BY subject_id ) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.charttime < t2.charttime AND datetime(t2.charttime) BETWEEN datetime(t1.charttime) AND datetime(t1.charttime,'+2 month') GROUP BY t2.icd_code ) AS t3 WHERE t",,False,0.0,0.0005576610565185547,0,incomplete input,,,
606c8894c16dee6dfac6b9ec,"Following the diagnosis of nicotine dependence, cigarettes, uncomplicated in 2100, how many patients developed malignant neoplasm of unspecified part of unspecified bronchus or lung within 2 months?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nicotine dependence, cigarettes, uncomplicated' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT A.subject_id, A.charttime FROM ( SELECT B.subject_id, B.charttime FROM ( SELECT A.subject_id, A.charttime FROM ( SELECT procedures_icd.subject_id, procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = 'F17.210' ) AS A WHERE A.charttime >= '2100-01-01' ) AS B JOIN diagnoses_icd ON B.subject_id = diagnoses_icd.subject_id WHERE diagnoses_icd.icd_code = 'C34.90' AND datetime(diagnoses_icd.charttime) BETWEEN datetime(B.charttime) AND datetime(B.charttime,'+2 month') ) AS T1 GROUP BY T1.subject_id )",,False,0.0,0.0005533695220947266,0,incomplete input,,,
8227bef3ad3149f4b7e3b6e2,"Count the number of patients who had their extirpation of matter from left main bronchus, via natural or artificial opening endoscopic performed since 1 year ago.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left main bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'extirpation of matter from left main bronchus, via natural or artificial opening endoscopic' AND datetime(procedures.starttime) >= datetime(current_time,'-1 year') )",,False,0.0,0.0009701251983642578,0,no such table: procedures,,,
601558b753933c463ad3089a,"During this ICU encounter, was the respiratory rate of patient 10018081 ever less than 35.0?",SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 35.0,SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 10018081 AND charttime >= ( SELECT admittime FROM d_icustays WHERE patient_id = 10018081 AND stay_id IN ( SELECT MIN(stay_id) FROM d_icustays WHERE patient_id = 10018081 AND outtime IS NULL ) ),[{'COUNT(*)>0': 0}],False,0.0,0.0010497570037841797,0,no such table: d_icustays,,,
bb5e3f49dbcb908901443bf7,Did patient 10029291 take any nacl 0.9% on 02/25/this year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '02-25'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = microbiologyevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = microbiologyevents.hadm_id ) AND admissions.admittime >= datetime(current_time,'start of year','-0 year') AND admissions.dischtime IS NULL ) AND microbiologyevents.spec_type_desc = 'nacl 0.9%' AND datetime(microbiologyevents.charttime,'start of year','-0 year') = datetime(current_time,'start of year','-0 year') AND strftime('%Y-%m-%d',microbiologyevents.charttime) = 'this year-02-25'",[{'COUNT(*)>0': 0}],False,0.0,0.0013897418975830078,0,no such column: patients.age,,,
b58a473dfa7c2592ff652a6c,Implement a text analysis on 'org_name' in 'microbiologyevents' to categorize organism types and their frequencies.,,"SELECT T1.C1 FROM ( SELECT microbiologyevents.org_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.org_name ) AS T1 WHERE T1.C1 <= 3",,True,0.42528700828552246,0.4264638423919678,3,,"[{'C1': 1}, {'C1': 2}, {'C1': 3}]",['C1'],"[{""id"": 2, ""parent"": 0, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 5, ""parent"": 2, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-3)""}, {""id"": 12, ""parent"": 5, ""notused"": 0, ""detail"": ""SCAN microbiologyevents""}, {""id"": 14, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 49, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 63, ""parent"": 2, ""notused"": 0, ""detail"": ""SCAN (subquery-3)""}, {""id"": 125, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T1""}]"
aa8337326151ea27fe36af1b,What was the name of the procedure that was performed two or more times in 03/this year on patient 10029291?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT T1.proc_name FROM ( SELECT proc_name, COUNT(*) AS C1 FROM procedureevents WHERE subject_id = 10029291 AND datetime(procedureevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedureevents.charttime) = '03' GROUP BY proc_name ) AS T1 WHERE T1.C1 >= 2",,False,0.0,0.0008537769317626953,0,no such table: procedureevents,,,
9444a73db82e2c64ae8bcdb3,What was the total output volume that patient 10019172 had on 11/20/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-11-20'",SELECT SUM(output) FROM microbiologyevents WHERE patientid = 10019172 AND charttime >= '2100-11-20 00:00:00' AND specimentype = 'urine' GROUP BY patientid ORDER BY charttime ASC LIMIT 1,[{'SUM(outputevents.value)': None}],False,0.0,0.0009717941284179688,0,no such column: output,,,
264edd3d4d5f3f14d0173879,What was the last height record for patient 10011398 since 12/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-12' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT hospitalevents.charttime FROM hospitalevents WHERE hospitalevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 0 AND admissions.gender = 'male' AND admissions.ethnicity = 'not specified' AND admissions.died_icu = 0 AND admissions.died_hosp = 0 AND admissions.admission_type = 'emergency' ) AND hospitalevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'height' ) AND hospitalevents.valuenum IS NOT NULL AND hospitalevents.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 0 AND admissions.gender = 'male' AND admissions.ethnicity = 'not specified' AND admissions.died_icu = 0 AND admissions.died_hosp = 0 AND admissions.admission_type = 'emergency' AND admissions.subject_id = 10011398 ) AND strftime('%Y-%m',hospitalevents.charttime) >= '2100-12' ORDER BY hospitalevents.charttime DESC LIMIT 1",[],False,0.0,0.000978231430053711,0,no such table: hospitalevents,,,
039311889be460387c195635,Find out how many patients were admitted to the hospital since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],True,0.14172863960266113,0.14224672317504883,1,,[{'COUNT( DISTINCT admissions.subject_id )': 174611}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
9a35c7b42b40e00811be3aac,Has patient 10039997 received nacl 0.9% in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 10039997 AND organism_name = 'nacl 0.9%' AND datetime(documenttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',documenttime) = '12'",[{'COUNT(*)>0': 0}],False,0.0,0.0011904239654541016,0,no such column: patient_id,,,
a71d906583f596e06c9f330d,What are the three most commonly received procedures for patients in their 30s since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d.proc_name FROM   ( SELECT   d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   procedure_table d   WHERE   d.age BETWEEN 30 AND 39 AND strftime('%Y',d.charttime) >= '2100'   GROUP BY   d.proc_name ) WHERE   C1 <= 3",,False,0.0,0.0010416507720947266,0,no such table: procedure_table,,,
10b2e18ba65bee267f263e57,Does the heart rate of patient 10018081 ever go greater than 105.0 according to the database?,SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 105.0,SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 10018081 AND valuenum > 105.0,[{'COUNT(*)>0': 0}],False,0.0,0.0013992786407470703,0,no such column: patient_id,,,
a1db6846c07bdc99c68fda58,Has there been any organism found in the first sputum microbiology test patient 10038999 received?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE organism_name IS NOT NULL AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name = 'other' AND microbiologyevents.charttime >= datetime(current_time,'-1 year') AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )",[{'COUNT(*)>0': 0}],False,0.0,0.001079559326171875,0,no such column: organism_name,,,
e06b5c902a757922a7a2e945,Count the number of patients diagnosed with gastro-esophageal reflux disease without esophagitis who did not come to the hospital within 2 months since 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) >= '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.admission_location = 'home' AND strftime('%Y',admissions.admittime) >= '2100' ) AND patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'gastro-esophageal reflux disease without esophagaltis' AND strftime('%Y',procedures.starttime) >= '2100' ) HAVING datetime(admissions.dischtime) < datetime(procedures.starttime) + interval '2' month",,False,0.0,0.0006017684936523438,0,incomplete input,,,
1613b932a1fa398b6bb15ef8,Has any lab test been performed on patient 10016150 in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y',labevents.charttime) = '2100'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.chartkey IN ( SELECT admissions.chartkey FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y',labevents.charttime) = '2100'",[{'COUNT(*)>0': 0}],False,0.0,0.0013244152069091797,0,no such column: admissions.chartkey,,,
45917bbce3d4be5cd229b409,"When was the last time patient 10021487 had injury to liver without mention of open wound into cavity, hematoma and contusion diagnosed since 1 year ago?","SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to liver without mention of open wound into cavity, hematoma and contusion' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1",SELECT hospital_admissions.admittime FROM hospital_admissions WHERE hospital_admissions.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.valuenum = ( SELECT d_icd_procedures_icd_to_char_map.chartevents_id FROM d_icd_procedures_icd_to_char_map WHERE d_icd_procedures_icd_to_char_map.icd_code = 'S3600' ) AND chartevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'icd diagnosis' ) ) AND hospital_admissions.age >= 1*365.0 AND hospital_admissions.age <= 2*365.0 AND hospital_admissions.patient_id = 10021487 ORDER BY hospital_admissions.admittime DESC LIMIT 1,,False,0.0,0.0005555152893066406,0,incomplete input,,,
d331061cc248eb79de709879,Has patient 10038933 been diagnosed with any type of disease?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ),"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age>0 AND patients.gender='male' AND patients.age>0 AND patients.gender='female' AND patients.charttime IS NOT NULL AND patients.charttime < datetime(current_time,'-0 year') AND patients.age=100 AND patients.gender='male' AND patients.age=100 AND patients.gender='female' AND patients.id=10038933 )",[{'COUNT(*)>0': 1}],False,0.0,0.001058816909790039,0,no such column: patients.hadm_id,,,
6390dcaf504bd34b9a22032f,"Since 1 year ago, what are the top five most common drugs prescribed in the same month to male patients aged 50s after being diagnosed with unspecified sinusitis (chronic)?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sinusitis (chronic)' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT d.drug FROM ( SELECT t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT o.itemid, p.d_icd_diagnoses FROM microbiologyevents o JOIN patients p ON o.hadm_id = p.hadm_id WHERE o.itemid IN ( SELECT d_icd_diagnoses FROM d_icd_diagnoses WHERE d_icd_diagnoses = 'unspecified sinusitis (chronic)' ) AND datetime(o.charttime) >= datetime(current_time,'-1 year') ) AS t1 JOIN ( SELECT o.itemid, p.d_icd_diagnoses FROM microbiologyevents o JOIN patients p ON o.hadm_id = p.hadm_id WHERE o.itemid IN ( SELECT d_icd_diagnoses FROM d_icd_diagnoses WHERE d_icd_diagnoses = 'unspecified sinusitis (chronic)' ) AND datetime(o.charttime) >= datetime(current_time,'-1 year') ) AS t0 ON t1.hadm_id = t0.hadm_id WHERE t1.itemid != t0.itemid AND t1.charttime > t0.charttime AND strftime('%Y-%m',t1.charttime) = strftime('%Y-%m',",,False,0.0,0.0007283687591552734,0,incomplete input,,,
df9f9f77da1cf00ef44d4e96,Has patient 10015931 visited the hospital for admission during this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015931 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.key = ( SELECT procedures_icd.key FROM procedures_icd WHERE procedures_icd.label = 'insertion of drainage device into pericardial sac' ) ) AND admissions.age IS NOT NULL ) AND strftime('%Y',microbiologyevents.charttime) = '2100'",[{'COUNT(*)>0': 0}],False,0.0,0.0010230541229248047,0,no such column: d_icd_procedures.key,,,
e840f7d25b661f8952fb1eb0,When was patient 10018081's last maximum diastolic blood pressure on this month/30?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '30' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'blood' ) AND labevents.valuenum = ( SELECT MAX( labevents.valuenum ) FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'blood' ) AND labevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age = 100 AND patients.gender = 'male' ) ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND labevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age = 100 AND patients.gender = 'male' AND patients.charttime IN ( SELECT procedures.charttime FROM procedures WHERE procedures.spec_type_desc = 'blood' ) ) ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.0005981922149658203,0,"unrecognized token: ""'""",,,
19858b1d6157d97c01ffb3cf,"During their last hospital visit, what time was patient 10001217's last surgery?",SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime DESC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.age IS NOT NULL AND admissions.pid = 10001217 ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND procedures.label = 'surgery' ORDER BY procedures.starttime DESC LIMIT 1,,False,0.0,0.0014102458953857422,0,no such table: procedures,,,
3f4dd01d76af18b7e4220202,When did patient 10011398 first receive a diagnosis of other and unspecified hyperlipidemia on their last hospital visit?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1,"SELECT hospital_admissions.admittime FROM hospital_admissions WHERE hospital_admissions.charteventscharttime IN ( SELECT T1.charttime FROM ( SELECT chartevents.charttime, DENSE_RANK() OVER ( ORDER BY chartevents.charttime DESC ) AS C1 FROM chartevents WHERE chartevents.hospital_id = 10011398 AND chartevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.longtitle = 'diagnosis' ) ) AS T1 WHERE T1.C1 = 1 ) AND hospital_admissions.patient_id = 10011398 AND hospital_admissions.dischtime IS NOT NULL ORDER BY hospital_admissions.admittime DESC LIMIT 1",,False,0.0,0.0010800361633300781,0,no such table: hospital_admissions,,,
8fed981f895ac1aafc1084df,What were the top four microbiology tests most frequently performed throughout this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT T1.spec_type_desc FROM ( SELECT procedures.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures WHERE procedures.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.age = 0 ) AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures.drug ) AS T1 WHERE T1.C1 <= 4",[],False,0.0,0.0013124942779541016,0,no such table: procedures,,,
e966f1d77c03eb69dafa1390,Calculate the total number of patients diagnosed with dependence on renal dialysis who didn't revisit the hospital during the same month in 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) = '2100' AND datetime(T2.charttime,'start of month') = datetime(admissions.admittime,'start of month') )","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT A.subject_id, strftime('%Y-%m',A.charttime) AS T1 FROM ( SELECT subject_id, charttime FROM microbiologyevents WHERE specimen_type_desc = 'blood culture' AND stromal_cell_count = 0.0 AND organism_desc = 'enterococcus faecium' AND glycemia = 0.0 AND ph = 0.0 AND leukocyte_count = 0.0 AND patient_age = 0.0 AND microbiology_test_desc = 'blood culture' AND organism_isolation_time = 0.0 AND organism_desc = 'enterococcus faecium' AND patient_weight = 0.0 AND ph = 0.0 AND microbiology_test_desc = 'blood culture' AND organism_isolation_time = 0.0 AND organism_desc = 'enterococcus faecium' AND patient_weight = 0.0 AND ph = 0.0 AND organism_isolation_time = 0.0 AND organism_desc = 'enterococcus faecium' AND patient_weight = 0.0 AND ph = 0.0 AND organism_isolation_time = 0.0 AND organism_desc = 'enterococcus faec",,False,0.0,0.0005950927734375,0,incomplete input,,,
e28928980fdbc1db31ee6b54,How much is the average total cost of a hospital visit that includes a phosphate lab test?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.label = 'phosphate' AND procedures.chartkey IN ( SELECT procedures.chartkey FROM procedures WHERE procedures.label = 'phosphate' ) GROUP BY procedures.chartkey ) AS T1,,False,0.0,0.0012977123260498047,0,no such table: procedures,,,
c6b253614a8ea885b3619a02,What was the last measurement of patient 10020786's height in 07/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-07' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT d.valuenum FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = 'Z13.6' ) AND d.charttime >= datetime(current_time,'start of year') AND d.charttime < datetime(current_time,'start of year','+1 year','-1 second') ORDER BY d.charttime DESC LIMIT 1",[],False,0.0,0.0015015602111816406,0,no such column: p.itemid,,,
5ee74a87e14a3df9c0561df9,What's the admission count of patients in the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],True,0.09875082969665527,0.09995722770690918,1,,[{'COUNT( DISTINCT admissions.subject_id )': 0}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
1436276ff4d05d626c742fa4,How many hours has it been since patient 10021487 got their last prescription of glucagon on this hospital stay?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'glucagon' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.chartevents.charttime IN ( SELECT prescriptions.charttime FROM prescriptions WHERE prescriptions.stdiag = transfers.stdiag AND prescriptions.drug = 'glucagon' AND transfers.age >= 0 ORDER BY prescriptions.charttime DESC LIMIT 1 ) AND transfers.age >= 0 AND transfers.outtime IS NULL AND transfers.attending IS NOT NULL AND transfers.admissiontype = 'emergency' AND transfers.age >= 0 AND transfers.admissiontype = 'emergency' AND transfers.attending IS NOT NULL AND transfers.admissiontype = 'emergency' AND transfers.age >= 0 AND transfers.admissiontype = 'emergency' AND transfers.attending IS NOT NULL AND transfers.admissiontype = 'emergency' AND transfers.age >= 0 AND transfers.admissiontype = 'emergency' AND transfers.attending IS NOT NULL AND transfers.admissiontype = 'emergency' AND transfers.age >= 0 AND transfers.admissiontype = 'emergency' AND transfers.attending IS NOT NULL AND transfers.admissiontype = 'emergency' AND transfers.age >= 0 AND transfers.admissiontype = 'emergency' AND transfers.attending IS NOT NULL AND transfers.age >= 0 AND transfers",[],False,0.0,0.0012111663818359375,0,no such column: prescriptions.charttime,,,
908ebe3140a3419cb32dc270,How much is a surgery referred to as arteriography of femoral and other lower extremity arteries?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) ),SELECT COUNT(*) FROM microbiologyevents WHERE organism = 'enterococcus faecalis' AND age BETWEEN 30 AND 40 AND gender = 'male',,False,0.0,0.0008647441864013672,0,no such column: organism,,,
7ae946cb6fe7f5a3cac9bfa8,"What was patient 10018423's last time of the bypass coronary artery, one artery from aorta with autologous venous tissue, open approach procedure in 2100?","SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y',procedures_icd.charttime) = '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.charttime FROM procedures WHERE procedures.label = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' AND procedures.charttime >= '2100' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT procedures.age FROM procedures WHERE procedures.row_id = ( SELECT MIN(procedures.row_id) FROM procedures WHERE procedures.label = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age IS NOT NULL ) AND procedures.charttime >= '2100' ) ) ) AND procedures.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT procedures.age FROM procedures WHERE procedures.row_id = ( SELECT MIN(procedures.row_id) FROM procedures WHERE procedures.label = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age IS NOT NULL ) AND procedures.charttime >= '2100' ) ) AND admissions.gender = 'male' ) ORDER BY procedures.charttime DESC LIMIT 1",,False,0.0,0.0005311965942382812,0,"unrecognized token: ""'bypass coronary artery, one artery from aorta with autologous venous t""",,,
87ac7c2e247976ad4e577de0,What is the minimum total cost of the hospital visits that ever had the drug named cyanocobalamin?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.label = 'cyanocobalamin' GROUP BY procedures.hadm_id ) GROUP BY procedures.hadm_id ) AS T1,,False,0.0,0.0009319782257080078,0,no such table: procedures,,,
f1fc9f152b1ba46ecd03c1a6,What are the top five most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]",True,0.4380526542663574,0.43863821029663086,5,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}, {'long_title': 'electrocardiogram'}, {'long_title': 'enteral infusion of concentrated nutritional substances'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 28, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 63, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 77, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 139, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
87fcf9c0339594cc79adb945,"Can you count the instances of the introduction of other thrombolytic into central vein, percutaneous approach procedure in 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedureevents WHERE procedureevents.label = 'introduction of other thrombolytic into central vein, percutaneous approach' AND strftime('%Y',procedureevents.charttime) = '2100'",,False,0.0,0.00090789794921875,0,no such table: procedureevents,,,
11ee027a4849b568c91b8cfe,"Tell me, what were the five most common microbiology tests since 1 year ago?","SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents AS T1 JOIN d_icd_procedures AS T2 ON T1.spec_type_desc = T2.long_title WHERE datetime(T1.charttime) >= datetime(current_time,'-1 year') GROUP BY T2.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]",False,0.0,0.0009696483612060547,0,no such column: T2.spec_type_desc,,,
2592fc0c41e2b7144c374342,"On the current hospital visit, how many days have passed since the first time patient 10021487 was prescribed clobetasol propionate 0.05% cream?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'clobetasol propionate 0.05% cream' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT DISTINCT T1.C1 FROM ( SELECT PROCEDURE_OCCURRENCE_TIME, DATEDIFF(day, CURRENT_TIME,'hospital_discharge_time' IN ICU_ADMISSIONS WHERE ICU_ADMISSIONS.hospital_id = 1 AND ICU_ADMISSIONS.age = 60 AND ICU_ADMISSIONS.gender = 'male' AND ICU_ADMISSIONS.chart_id = ( SELECT patients.chart_id FROM patients WHERE patients.age = 60 AND patients.gender = 'male' AND patients.dod IS NULL ) ) FROM PROCEDURE_OCCURRENCE WHERE PROCEDURE_OCCURRENCE.hospital_id = 1 AND PROCEDURE_OCCURRENCE.age = 60 AND PROCEDURE_OCCURRENCE.gender = 'male' AND PROCEDURE_OCCURRENCE.chart_id = ( SELECT patients.chart_id FROM patients WHERE patients.age = 60 AND patients.gender = 'male' AND patients.dod IS NULL ) ) AS T1 WHERE T1.PROCEDURE_OCCURRENCE_TIME >= ( SELECT MIN(T2.PROCEDURE_OCCURRENCE_TIME) FROM ( SELECT PROCEDURE_OCCURRENCE_TIME, DATEDIFF(day, CURRENT_TIME,'hospital_discharge_time' IN ICU_ADMISSIONS WHERE ICU_ADMISSIONS.hospital_id =",[],False,0.0,0.0005424022674560547,0,"near ""WHERE"": syntax error",,,
9be1173dda0a298a23b91c0b,What is the number of patients who were diagnosed with accidents occurring in residential institution in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidents occurring in residential institution' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'accidents occurring in residential institution' AND strftime('%Y',procedures.charttime) = '2100' )",,False,0.0,0.0009119510650634766,0,no such table: procedures,,,
ee5f304ed38ac06c2b980f3f,Which patients were diagnosed with hyperpotassemia during this year?,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperpotassemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT patients.subject_id FROM patients WHERE patients.dischtime is NOT NULL AND datetime(players.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND players.valuenum = ( SELECT MIN(players.valuenum) FROM players WHERE players.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'hyperpotassemia' ) )",,False,0.0,0.0008952617645263672,0,no such table: players,,,
4724c2961dfc05d2b08ea4be,"Did patient 10020187 receive restriction of intracranial artery with intraluminal device, percutaneous approach in the last hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of intracranial artery with intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )",SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT procedures_icd.charttime - admissions.admittime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT procedures_icd.charttime - admissions.admittime FROM procedures_icd WHERE procedures_icd.icd_code = '12.97' AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT procedures_icd.charttime - admissions.admittime FROM procedures_icd WHERE procedures_icd.icd_code = '12.97' AND procedures_icd.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT procedures_icd.charttime - admissions.admittime FROM procedures_icd WHERE procedures_icd.icd_code = '12.97' AND procedures_icd.person_id = 10020187 ) ) ) ) ) ) ) ),[{'COUNT(*)>0': 0}],False,0.0,0.0005333423614501953,0,incomplete input,,,
e5f56337e5fbe51641a80d77,What percentile of the hemoglobin value of 8.5 is within the same age as patient 10009628 during their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.5","SELECT DISTINCT T1.C1 FROM ( SELECT patients.age, labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents JOIN patients ON labevents.subject_id = patients.subject_id WHERE patients.gender = 'male' AND patients.age IS NOT NULL AND labevents.itemid IN ( SELECT procedurechart.itemid FROM procedurechart WHERE procedurechart.charttime IS NOT NULL ) AND procedurechart.charttime < labevents.charttime AND datetime(procedurechart.charttime,'start of year') = datetime(labevents.charttime,'start of year') AND patients.subject_id = 10009628 AND labevents.itemid IN ( SELECT definition.itemid FROM definition WHERE definition.label = 'hemoglobin' ) ) AS T1 WHERE T1.age = ( SELECT patients.age FROM patients WHERE patients.gender = 'male' AND patients.age IS NOT NULL AND patients.subject_id = 10009628 ORDER BY datetime(procedurechart.charttime,'start of year') DESC LIMIT 1 ) AND T1.valuenum = 8.5",,False,0.0,0.0005421638488769531,0,incomplete input,,,
580f56a66f7626bbcd078c21,Has patient 10023239 had any organisms detected in his last urine microbiology test in 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y',microbiologyevents.charttime) = '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT COUNT(*)>0 FROM microbiologyevents WHERE organisms_detected IS NOT NULL AND patients.d_icd_procedures_icd_codes = procedures_icd_codes.icd_codes AND patients.charttime >= procedures_icd_codes.charttime AND patients.charttime < procedures_icd_codes.charttime + 1 day AND patients.age = ( SELECT age FROM patients WHERE patients.row_id = 10023239 ) AND procedures_icd_codes.icd_codes = 'icd_procedures_icd_codes' AND patients.row_id = 10023239 AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y',microbiologyevents.charttime) = '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],False,0.0,0.0009145736694335938,0,"near ""day"": syntax error",,,
feaa451705254e6b2a61a7fb,"During this month, when was the first time that patient 10005817 was prescribed a medication via the iv drip route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.route = 'iv drip' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(drugs.starttime) FROM drugs WHERE drugs.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10005817 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10005817 ) ) AND drugs.route = 'iv drip' AND datetime(drugs.starttime,'start of month') = datetime(current_time,'start of month','-0 month')",[],False,0.0,0.0009555816650390625,0,no such table: drugs,,,
73e1216fd32c02f0a88adb7b,"How many patients were prescribed the medicine metronidazole (flagyl) within 2 months after a diagnosis of urinary tract infection, site not specified since 1 year ago?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT prescriptions.subject_id FROM prescriptions WHERE prescriptions.drug = 'metronidazole (flagyl)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AND patients.subject_id IN ( SELECT diagnoses.subject_id FROM diagnoses WHERE diagnoses.label = 'urinary tract infection, site not specified' AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) HAVING T1.starttime BETWEEN T2.charttime AND datetime(T2.charttime,'+2 month')",,False,0.0,0.0009293556213378906,0,no such table: diagnoses,,,
f3d6d302751188c87c7c1304,What was the last medication that was prescribed to patient 10004733 in 12/this year through the iv route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.row_id_1 FROM transfers WHERE transfers.row_id_2 IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 10004733 AND chartevents.charttype = 'daily events' ) ) ) ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1",[],False,0.0,0.0005331039428710938,0,incomplete input,,,
254b58ea3d513164000b4a51,When did patient 10035185 receive red blood cells test the first time in the first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.patient_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY labevents.charttime ASC LIMIT 1,[],False,0.0,0.0009303092956542969,0,no such table: procedures,,,
9d71dca8add09e321ec57dd9,When did patient 10026354 last have or urine output since 02/26/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-26' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT d.charttime FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.label = 'or urine output' ) AND d.hadm_id IN ( SELECT m.hadm_id FROM patients m WHERE m.age >= 50 AND m.gender = 'male' ) AND strftime('%Y-%m-%d',d.charttime) >= '2100-02-26' ORDER BY d.charttime DESC LIMIT 1",[],False,0.0,0.0009229183197021484,0,no such column: p.itemid,,,
c35acfb89f468f360b299535,"What was the first care unit patient 10018845 was in since 1 year ago, according to the transfer record?","SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND transfers.careunit IS NOT NULL AND datetime(transfers.intime) >= datetime(current_time,'-1 year') ORDER BY transfers.intime ASC LIMIT 1","SELECT DISTINCT T1.careunit FROM   ( SELECT      T2.careunit, T2.intime FROM      transferevents AS T1 JOIN       transferevents AS T2 ON T1.chartkey = T2.chartkey WHERE     T1.chartkey = 10018845 AND datetime(T1.outtime) >= datetime(current_time,'-1 year') ORDER BY T1.outtime ASC LIMIT 1 ) AS T1",[{'careunit': 'Emergency Department'}],False,0.0,0.000934600830078125,0,no such table: transferevents,,,
d15b77ed559fe4e57aa57aad,"Among patients who were diagnosed with unspecified viral hepatitis c without hepatic coma during this year, what were the top three most common diagnoses that followed within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c without hepatic coma' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE labevents.valuenum = 0.0 AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'arterial blood gases' ) AND admissions.age BETWEEN 50 AND 60 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY admissions.subject_id, labevents.charttime ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE labevents.valuenum = 0.0 AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'arterial blood gases' ) AND admissions.age BETWEEN 50 AND 60 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start",,False,0.0,0.0005791187286376953,0,incomplete input,,,
c486d3f623a7c682d0051190,Has any procedure been carried out on patient 10010471 in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = 2100 ) AND chartevents.valuenum IS NOT NULL ) AND procedures_icd.patient_id = 10010471 AND strftime('%Y',procedures_icd.charttime) = '2100'",,False,0.0,0.0009055137634277344,0,no such table: definition,,,
ea9a85005a244ffc9f78a09c,Find out the daily minimum or urine output volume of patient 10019172 during the previous month.,"SELECT MIN(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY strftime('%Y-%m-%d',outputevents.charttime)","SELECT MIN(d_icd_procedures.charttime - lag(d_icd_procedures.charttime) OVER ( ORDER BY d_icd_procedures.charttime )) AS daily_minimum_or_urine_output_volume_of_patient_10019172_during_the_previous_month FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '12.92' AND d_icd_procedures.charttime >= datetime(current_time,'start of month','-1 month') AND d_icd_procedures.charttime < datetime(current_time,'start of month') AND d_icd_procedures.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.spec_type_desc = 'urine' ) AND d_icd_procedures.subject_id = 10019172 GROUP BY strftime('%Y-%m-%d',d_icd_procedures.charttime)",[],False,0.0,0.0005135536193847656,0,incomplete input,,,
c48a0929fbf88f2a30c26873,"What are the three most frequently given microbiology tests for the patients who had previously received destruction of right main bronchus, via natural or artificial opening endoscopic within 2 months, since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T1.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 0 GROUP BY admissions.subject_id ) AS T1 JOIN ( SELECT procedures.on_subject_id, procedures.charttime FROM procedures WHERE procedures.label = 'destruction of right main bronchus, via natural or artificial opening endoscopic' AND strftime('%Y',procedures.charttime) >= '2100' GROUP BY procedures.on_subject_id ) AS T2 ON T1.subject_id = T2.on_subject_id WHERE T1.dischtime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.admittime) AND datetime(T1.admittime,'+2 month') GROUP BY T2.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",,False,0.0,0.0005369186401367188,0,"near ""GR"": syntax error",,,
4e04be3ade7631c7f953c6b5,Can you provide the list of the four most commonly ordered specimen tests this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",[],True,0.1401665210723877,0.14090871810913086,0,,,,"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 29, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 64, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 78, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 140, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
ae1a0149163b093252133a46,"How many patients underwent diagnosis of postprocedural fever within 2 months after being diagnosed with body mass index 35.0-35.9, adult throughout this year?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural fever' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study AS a JOIN microbiome_study ON a.holdout = microbiome_study.holdout WHERE a.spec_type_desc = 'stool' AND microbiome_study.spec_type_desc = 'stool' AND datetime(a.test_time,'start of year') = datetime(current_time,'start of year','-0 year') AND a.disease = 'body mass index 35.0-35.9, adult' AND microbiome_study.disease = 'postprocedural fever' AND datetime(a.test_time) BETWEEN datetime(microbiome_study.test_time) AND datetime(microbiome_study.test_time,'+2 month')",,False,0.0,0.000514984130859375,0,incomplete input,,,
06b4d2263fcb4017df542024,Tell me the top three diagnoses with the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY T2.C2 ASC ) AS C3 FROM ( SELECT T1.icd_code, AVG(C1) AS C2 FROM ( SELECT patients.d_icd_diagnoses_icd_code, ( CASE WHEN patients.dischtime IS NOT NULL AND patients.dischtime < patients.age + 6 * 365 / 24 THEN 0 ELSE 1 END ) as C1 FROM patients WHERE patients.age >= 0 GROUP BY patients.d_icd_diagnoses_icd_code, patients.charttime ) AS T1 GROUP BY T1.icd_code ) AS T2 ) AS T3 WHERE T3.C3 <= 3 )",,False,0.0,0.0004494190216064453,0,incomplete input,,,
d4949e694ea61ec816d403c4,"On 04/05/this year, what was the average value of respiratory rate for patient 10012552?","SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '04-05'","SELECT AVG(d_icd_procedures.charttime - admissions.admittime) FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10012552 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ) AND d_icd_procedures.charttime >= datetime(current_time,'start of year','-0 year') AND strftime('%Y-%m-%d',d_icd_procedures.charttime) = datetime(current_time,'start of year','-0 year','04-05') GROUP BY d_icd_procedures.hadm_id",[{'AVG(chartevents.valuenum)': None}],False,0.0,0.00043654441833496094,0,incomplete input,,,
e1c0f14b4eaae169e2ee99f7,How many patients were prescribed with bupropion (sustained release) in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupropion (sustained release)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT dr.stay_id ) FROM d_icd_procedures dr WHERE dr.icd_procedures = 'bupropion (sustained release)' AND datetime(dr.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0007269382476806641,0,no such column: dr.stay_id,,,
5ad1c0bd8c724486755abcd6,How many ICU visits did patient 10018845 have during the first hospital encounter?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT( DISTINCT icustays.stay_id )': 1}],True,0.04253077507019043,0.04300999641418457,1,,[{'COUNT(*)': 0}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN icustays""}, {""id"": 8, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 12, ""parent"": 8, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 28, ""parent"": 8, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
3a676bfafee66c27173904e8,"On the first hospital visit, was patient 10005866 admitted to the emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 10005866 AND charttime >= ( SELECT admittime FROM admissions WHERE patient_id = 10005866 AND dischtime IS NOT NULL ORDER BY admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],False,0.0,0.0009768009185791016,0,no such column: patient_id,,,
5534a345d569cc39211962ae,How many patients underwent other electric countershock of heart within 2 months after the diagnosis with personal history of tobacco use?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 18  AND admissions.admission_type_desc = 'emergency room'  EXCEPT     SELECT COUNT( DISTINCT d_icd_procedures.subject_id ) FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart'  AND d_icd_procedures.age >= 18  AND d_icd_procedures.admission_type_desc = 'emergency room'     JOIN admissions ON d_icd_procedures.hadm_id = admissions.hadm_id     WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 18  AND admissions.admission_type_desc = 'emergency room'     AND d_icd_procedures.charttime BETWEEN admissions.admittime AND admissions.dischtime + interval '2' month   EXCEPT     SELECT COUNT( DISTINCT d_icd_diagnoses.subject_id ) FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use'  AND d_icd_diagnoses.age >= 18  AND d_icd_diagnoses.admission_type_desc = 'emergency room'     JOIN admissions ON d_icd_diagnoses.hadm_id =,,False,0.0,0.0009183883666992188,0,"near ""JOIN"": syntax error",,,
e812406c3bfd789c61094039,How many people were discharged from hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],True,0.1481642723083496,0.14865398406982422,1,,[{'COUNT( DISTINCT admissions.subject_id )': 172553}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
ad25b33f618fbda4463dc6d1,Is patient 10021938 recorded as male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10021938,SELECT DISTINCT patients.gender FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 8507 ) AND chartevents.value = '10021938' ),[{'gender': 'M'}],False,0.0,0.000985860824584961,0,no such table: definition,,,
503c1a271385c7a9c485a82a,Can you tell me the top four most common procedures since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,True,0.4471914768218994,0.4477875232696533,4,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}, {'long_title': 'electrocardiogram'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 28, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 63, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 77, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 139, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
d738685ff207376b36d479fc,Is the value of patient 10021118's body temperature from second measurement on the last ICU visit less than its first measurement on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT d1.valuenum FROM chartevents d1 WHERE d1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021118 ) AND d1.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'temperature celsius' ) AND d1.charttime >= admissions.admittime ORDER BY d1.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT d1.valuenum FROM chartevents d1 WHERE d1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021118 ) AND d1.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'temperature celsius' ) AND d1.charttime >= admissions.admittime ORDER BY d1.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0005669593811035156,0,incomplete input,,,
7d3d29193e98b64900b4be0a,What was the length of stay in days for patient 10012552's last hospitalization?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10012552 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","SELECT DISTINCT w1.value FROM microbiologyevents AS w1 WHERE w1.hadm_id IN ( SELECT t1.hadm_id FROM ( SELECT o.hadm_id, o.charttime FROM labevents AS o WHERE o.itemid IN ( SELECT p.itemid FROM d_icd_items AS p WHERE p.long_title = 'calcium, total' ) AND o.valuenum IS NOT NULL ORDER BY o.charttime ASC ) AS t1 WHERE t1.charttime >= ( SELECT m.charttime FROM labevents AS m WHERE m.itemid IN ( SELECT n.itemid FROM d_icd_items AS n WHERE n.long_title = 'calcium, total' ) AND m.valuenum IS NOT NULL AND m.hadm_id = t1.hadm_id ORDER BY m.charttime DESC LIMIT 1 ) - 1 day ) ORDER BY w1.charttime DESC LIMIT 1","[{""strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime)"": 7.869444444775581}]",False,0.0,0.0005247592926025391,0,"near ""AN"": syntax error",,,
346a6c07df798347268b1abd,What was the total dosage of 5% dextrose that patient 10019172 was prescribed in 10/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.drug = '5% dextrose' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10'","SELECT SUM(d_icd_prescriptions.dose_val_rx) FROM d_icd_prescriptions WHERE d_icd_prescriptions.icd_code = ( SELECT d_icd_items.icd_code FROM d_icd_items WHERE d_icd_items.long_title = '5% dextrose' ) AND d_icd_prescriptions.subject_id = 10019172 AND datetime(d_icd_prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',d_icd_prescriptions.starttime) = '10'",[{'SUM(prescriptions.dose_val_rx)': None}],False,0.0,0.001001596450805664,0,no such table: d_icd_prescriptions,,,
8a165a892467a3f42aa7f482,When did patient 10026255 last get a procedure since 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10026255 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10026255 ) ) AND strftime('%Y',procedures.starttime) >= '2100' ORDER BY procedures.starttime DESC LIMIT 1",,False,0.0,0.0009815692901611328,0,no such table: procedures,,,
3f3eaf9f4ef204effd22e28b,What is the length of the first hospital stay in days for patient 10020786?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1",SELECT COUNT(*) FROM hospital_stays WHERE patient_id = 10020786 AND discharge_time is NOT NULL ORDER BY admission_time ASC LIMIT 1,"[{""strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime)"": 4.190972222015262}]",False,0.0,0.0008623600006103516,0,no such table: hospital_stays,,,
7535579b90cfcb61fed1c380,What was the organism's name found in the last peritoneal fluid microbiology test of patient 10021487 since 09/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' AND admissions.dischtime IS NOT NULL ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'peritoneal fluid microbiology' AND procedures.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.valuenum = 0.0 AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'peritoneal fluid microbiology' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' AND admissions.dischtime IS NOT NULL ) ) ) AND datetime(labevents.charttime,'start of year') >= datetime(current_time,'start of year','-0 year') AND strftime('%J',labevents.charttime) >= strftime('%J',datetime(current_time,'start of year')) ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.0005538463592529297,0,incomplete input,,,
502ed6b90b3e2ec409aab683,"Since 2100, how many patients were diagnosed with cyst and pseudocyst of pancreas in the same month after being diagnosed with secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cyst and pseudocyst of pancreas' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study a JOIN microbiome_study b ON a.subject_id = b.subject_id WHERE a.spec_type_desc = 'cyst and pseudocyst of pancreas' AND b.spec_type_desc = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' AND strftime('%Y',a.start_time) >= '2100' AND datetime(a.start_time,'start of month') = datetime(b.start_time,'start of month')",,False,0.0,0.0009136199951171875,0,no such table: microbiome_study,,,
104c93f89e19274578bafb8d,"When in the first hospital encounter did patient 10038999 receive their first drainage of left pleural cavity, percutaneous approach, diagnostic procedure?","SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1",SELECT hospital_stays.admittime FROM hospital_stays WHERE hospital_stays.chartevents_icustays_patientid IS NOT NULL AND hospital_stays.chartevents_icustays_patientid IN ( SELECT icustays.patientid FROM icustays WHERE icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND hospital_stays.chartevents_icustays_patientid = 10038999  UNION  SELECT hospital_stays.admittime FROM hospital_stays WHERE hospital_stays.labevents_icustays_patientid IS NOT NULL AND hospital_stays.labevents_icustays_patientid IN ( SELECT icustays.patientid FROM icustays WHERE icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND hospital_stays.labevents_icustays_patientid = 10038999  UNION  SELECT hospital_stays.admittime FROM hospital_stays WHERE hospital_stays.output_icustays_patientid IS NOT NULL AND hospital_stays.output_icustays_patientid IN ( SELECT icustays.patientid FROM icustays WHERE icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND hospital_stays.output_icustays_patientid = 100,,False,0.0,0.0008881092071533203,0,no such table: hospital_stays,,,
74968f3f69d0e352733f0a96,When was patient 10027602's first maximum pt in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10027602 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ) AND labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'pt' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],False,0.0,0.0009431838989257812,0,no such table: definition,,,
41a1ed79e0d60db97ece0e23,What was the insurance name of patient 10002930 during the first hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime >= current_time - 1 * 365 * 24 * 60 * 60 ) GROUP BY procedures_icd.icd_code HAVING count( DISTINCT procedures_icd.chartevents_id ) >= 1 ),[{'insurance': 'Medicare'}],False,0.0,0.0005474090576171875,0,incomplete input,,,
2f0d855d95535316ee099fde,Could you retrieve patient 10018081's daily minimum weight?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MIN(d_icd_procedures.long_title) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.charttime >= patients.charttime AND patients.age = 10018081 ),[],False,0.0,0.0008761882781982422,0,no such column: patients.charttime,,,
8a0d9ca8816e2d1ca14e3fca,What was the last drug that patient 10019172 was prescribed in 11/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%d',prescriptions.starttime) >= 11 ORDER BY prescriptions.starttime DESC LIMIT 1",[],False,0.0,0.0005230903625488281,0,"unrecognized token: ""'-0 y""",,,
4b10d0fec2f23acab915e3f3,Count how many times in the first hospital visit patient 10004457 had coronary arteriography using two catheters.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10004457 AND organism_name = 'coronary arteriography using two catheters' AND microbiologyevents.charttime >= ( SELECT admissions.dischtime FROM admissions WHERE admissions.patient_id = 10004457 AND admissions.admission_location = 'hospital' ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)': 0}],False,0.0,0.0009176731109619141,0,no such column: patient_id,,,
e5e99a0d4249da9d001cf97b,Has any laboratory test been performed on patient 10009049 since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.chartkey IN ( SELECT patients.chartkey FROM patients WHERE patients.age >= 2100-04 AND patients.age < 2100-03 AND patients.d_icd_procedures_icd_code = '10009049' ) AND labevents.itemid IN ( SELECT procedures_icd.items_id FROM procedures_icd WHERE procedures_icd.d_icd_procedures_icd_code = '10009049' ) AND strftime('%Y-%m-%d',labevents.charttime) >= '2100-04-01'",[{'COUNT(*)>0': 1}],False,0.0,0.0009276866912841797,0,no such column: patients.chartkey,,,
97bd7321746aeee64c00043b,How much does patient 10014729 change in mch last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",False,0.0,0.0005445480346679688,0,"unrecognized token: ""'mch""",,,
53388f93019e894471f1753a,Has patient 10026354 undergone a procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ),SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = 2100 ) AND chartevents.valuenum = 10026354 ),[{'COUNT(*)>0': 1}],False,0.0,0.0008645057678222656,0,no such table: definition,,,
9930fa67b91f89cc964e7df3,Get the sum of the outputs that happened on 12/18/2100 for patient 10021487.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-18'","SELECT SUM(res_icd.output) FROM microbiologyevents AS res_icd WHERE res_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.charttime >= '2100-12-18' AND admissions.charttime < '2100-12-19' AND admissions.died = 0 AND admissions.age_icu > 0 AND admissions.admission_type = 'emergency' ) AND res_icd.spec_type_desc = 'output' AND res_icd.hadm_id = 10021487 AND strftime('%Y-%m-%d',res_icd.charttime) = '2100-12-18'",[{'SUM(outputevents.value)': None}],False,0.0,0.0009679794311523438,0,no such column: res_icd.output,,,
385953d76516f1f4e2f55b54,"What are the five frequently taken specimens for patients that received bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach previously in the same hospital visit in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT procedures.drug_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures WHERE procedures.drug_name = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' AND strftime('%Y',procedures.charttime) = '2100' GROUP BY procedures.drug_name ) AS T1 JOIN ( SELECT procedures.drug_name, procedures.charttime, patients.subject_id FROM procedures JOIN patients ON procedures.hadm_id = patients.hadm_id WHERE procedures.drug_name = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' AND strftime('%Y',procedures.charttime) = '2100' ) AS T2 ON T1.drug_name = T2.drug_name WHERE T1.C1 <= 5 JOIN ( SELECT labevents.spec_type_desc, labevents.charttime, labevents.hadm_id FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T3 ON T2.charttime < T3.charttime AND T2.hadm_id = T3.hadm_id WHERE T2.drug_name = 'bypass coronary artery,",,False,0.0,0.0005462169647216797,0,incomplete input,,,
2b27156e1bc6e928eb6b916e,Get patient 10039831's yearly minimum weight information since 08/2100.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-08' GROUP BY strftime('%Y',chartevents.charttime)","SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 0 AND admissions.age < 100 AND admissions.gender = 'male' AND admissions.ethnicity = 'not specified' AND admissions.insurance = 'medicare' AND admissions.admissiontype = 'emergency room' AND admissions.dischtime IS NOT NULL AND admissions.age = ( SELECT DISTINCT admissions.age FROM admissions WHERE admissions.pid = 10039831 ) ) AND chartevents.itemid IN ( SELECT DISTINCT chartitems.itemid FROM chartitems WHERE chartitems.label = 'daily weight' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-08' GROUP BY strftime('%Y',chartevents.charttime)",[],False,0.0,0.0009293556213378906,0,no such column: admissions.gender,,,
3909981e7b8628b8ba2086c0,When did patient 10002495 have an input for the last time on the first ICU stay?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,SELECT d1.starttime FROM labevents d1 WHERE d1.itemid IN ( SELECT d2.itemid FROM labitems d2 WHERE d2.label = 'input' ) AND d1.hadm_id IN ( SELECT d3.hadm_id FROM microbiologyevents d3 WHERE d3.spec_type_desc = 'input' ) AND d1.charttime IN ( SELECT MAX(d4.charttime) FROM labevents d4 WHERE d4.itemid IN ( SELECT d5.itemid FROM labitems d5 WHERE d5.label = 'input' ) AND d4.hadm_id IN ( SELECT d6.hadm_id FROM microbiologyevents d6 WHERE d6.spec_type_desc = 'input' ) GROUP BY d4.hadm_id HAVING d4.charttime BETWEEN ( SELECT MIN(d7.intime) FROM admissions d7 WHERE d7.hadm_id = d4.hadm_id AND d7.dischtime IS NOT NULL ) AND ( SELECT MAX(d8.outtime) FROM admissions d8 WHERE d8.hadm_id = d4.hadm_id AND d8.admittime IS NOT NULL ) ) AND d1.hadm_id = 10002495 ORDER BY d1.starttime DESC LIMIT 1,[{'starttime': '2141-05-27 17:39:00'}],False,0.0,0.0005908012390136719,0,incomplete input,,,
1afade11184c7bc98c9756f8,"When did the last time patient 10005909 have a fibrinogen, functional lab test in the first hospital visit?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'fibrinogen, functional' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.0008649826049804688,0,no such table: procedures,,,
e75cb39d6c5c866076d93717,"Count the number of patients diagnosed with cocaine abuse, unspecified.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cocaine abuse, unspecified' ) )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT chartevents.subject_id FROM chartevents WHERE chartevents.valuenum = 1 AND chartevents.itemid IN ( SELECT procedureevents.itemid FROM procedureevents WHERE procedureevents.label = 'cocaine abuse, unspecified' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0008718967437744141,0,no such table: procedureevents,,,
67988ec18e5b42a1ac974aae,"Find the number of patients who had a dilation of left external iliac vein with intraluminal device, percutaneous approach procedure during this year.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,False,0.0,0.0009398460388183594,0,no such table: procedures,,,
841488e721d7a4c3f1c219d0,Could you tell me the first procedure that patient 10019777 had in their first hospital encounter?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1 ),SELECT procedures.drug FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id IN ( SELECT MIN( labevents.row_id ) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime >= current_time '-1 year' AND admissions.gender = 'male' AND admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.gender = 'male' ) ) ORDER BY admissions.admittime ASC ) ) ORDER BY labevents.charttime ASC ) ) AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.gender = 'male' ) ) ORDER BY procedures.charttime ASC LIMIT 1,,False,0.0,0.0005290508270263672,0,"near ""'-1 year'"": syntax error",,,
eb20ba71a6257201e3668689,What was the weight of patient 10006580 in the first measurement?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT d.valuenum FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = '12.1900' ) AND d.hadm_id IN ( SELECT m.hadm_id FROM microbiologyevents m WHERE m.spec_type_desc = 'blood' ),[],False,0.0,0.0008549690246582031,0,no such column: p.itemid,,,
6dc27e0c371f7e5dd9d2a981,When was the first time on the first ICU stay that patient 10027602's SaO2 was greater than 95.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 95.0 ORDER BY chartevents.charttime ASC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10027602 AND admissions.gender = 'male' ) AND labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'o2 saturation pulseoxymetry' ) AND labevents.valuenum > 95.0 ORDER BY labevents.charttime ASC LIMIT 1,[],False,0.0,0.0009660720825195312,0,no such table: definition,,,
dddc1e74733a55f7407289ad,"Since 1 year ago, what are the top five most frequently ordered laboratory tests for patients within the same month after diagnosed with dyskinesia of esophagus?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dyskinesia of esophagus' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT d_labitems.itemname FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, dyskinesia of esophagus.charttime, admissions.admittime FROM dyskinesia of esophagus JOIN admissions ON dyskinesia of esophagus.hadm_id = admissions.hadm_id WHERE datetime(dyskinesia of esophagus.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.admittime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') AND datetime(T1.admittime) >= datetime(T2.admittime) GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <=",,False,0.0,0.0005040168762207031,0,"near ""esophagus"": syntax error",,,
b4a9db553c9c11bc9d4ae440,What label is associated with activity o2 sat - aerobic activity response?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'activity o2 sat - aerobic activity response',SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'activity o2 sat - aerobic activity response',[],False,0.0,0.0008759498596191406,0,no such column: d_icd_procedures.short_title,,,
fbd3d4a2eec48bed918ccbea,What is the cost of morphine sulfate (oral solution) 2 mg/ml?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate (oral solution) 2 mg/ml' ),SELECT DISTINCT d.cost FROM microbiome_icd d WHERE d.spec_item = 'morphine sulfate (oral solution) 2 mg/ml',,False,0.0,0.0009026527404785156,0,no such table: microbiome_icd,,,
a196342dccc0b8df5c23dbb4,Calculate the total number of patients diagnosed with other and unspecified anti-infectives causing adverse effects in therapeutic use who didn't revisit the hospital within the same month since 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified anti-infectives causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified anti-infectives causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) >= '2100' AND datetime(T2.charttime,'start of month') = datetime(admissions.admittime,'start of month') )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 18 AND admissions.admission_type_desc = 'emergency room' AND admissions.month = 1 AND admissions.year >= 2100 EXCEPT SELECT COUNT( DISTINCT t1.subject_id ) FROM ( SELECT admissions.subject_id, admissions.admittime, admissions.dischtime FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 18 AND admissions.admission_type_desc = 'emergency room' AND admissions.month = 1 AND admissions.year >= 2100 ) AS t1 JOIN ( SELECT admissions.subject_id, admissions.admittime, admissions.dischtime FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 18 AND admissions.admission_type_desc = 'emergency room' AND admissions.month = 1 AND admissions.year >= 2100 ) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.dischtime IS NOT NULL AND datetime(t2.admittime) BETWEEN datetime(t1.dischtime) AND datetime(datetime(t1.dischtime,'start of month')+interval 1 month)",,False,0.0,0.0005137920379638672,0,incomplete input,,,
b92ebae1949522c66677d297,What is the label assigned to arterial line waveform appear?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'arterial line waveform appear',SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'arterial line waveform appear',[],False,0.0,0.0008456707000732422,0,no such column: d_icd_procedures.short_title,,,
a097854bd791e910e6d7bb57,Calculate how many times patient 10018081 had the input of dextrose 5% since 12/2100.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12'",SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10018081 AND organism_name = 'dextrose 5%' AND charttime >= '2100-12-01',[{'COUNT(*)': 0}],False,0.0,0.0008482933044433594,0,no such column: patient_id,,,
307e60bc520a7699ba41926e,Provide me with the five most common diagnoses in this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.icd_name FROM   ( SELECT   d_icd_icditems_icd_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiologyevents   WHERE   strftime('%Y',microbiologyevents.charttime) = strftime('%Y',current_time)   GROUP BY   d_icd_icditems_icd_name ) AS T1   JOIN d_icd_icditems d ON T1.d_icd_icditems_icd_name = d.long_title   WHERE   T1.C1 <= 5",,False,0.0,0.0010700225830078125,0,no such table: d_icd_icditems,,,
cd72a23c76002c4a524a1b61,How many ICU visits did patient 10022880 have during this year?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM icustays WHERE icustays.chartevents_icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.subject_id = 10022880 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT icustays.stay_id )': 0}],False,0.0,0.0010249614715576172,0,no such column: icustays.icustay_id,,,
59d98dcbea98f9f9a4f33d08,"Since 04/09/2100, when did patient 10013049 have the last input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-09' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT d1.starttime FROM labevents d1 WHERE d1.itemid IN ( SELECT DISTINCT labitems.itemid FROM labitems WHERE labitems.label = 'input' ) AND d1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' ) AND strftime('%Y-%m-%d',d1.starttime) >= '2100-04-09' ORDER BY d1.valuenum DESC, d1.starttime DESC LIMIT 1",[{'starttime': '2114-06-21 10:00:00'}],False,0.0,0.0009324550628662109,0,no such table: labitems,,,
a9ddcfc0c9931bdb889ac570,What is the current number of hospitalized patients?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.dischtime IS NULL,[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009052753448486328,0,no such column: patients.dischtime,,,
c7725f7db94c9ef481ad6bc8,"Get me the top three most frequently tested specimens that patients took within the same hospital visit after being diagnosed with other postprocedural shock, initial encounter in 2100.","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other postprocedural shock, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT d.spec_type_desc FROM microbiologyevents d WHERE d.spec_type_desc IN ( SELECT T1.spec_type_desc FROM ( SELECT d.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents d WHERE d.stdt >= '2100-01-01' AND d.stdt < '2101-01-01' GROUP BY d.spec_type_desc ) AS T1 WHERE T1.C1 <= 3 ) AND EXISTS ( SELECT T2.icustay_id FROM ( SELECT d.icustay_id, d.charttime FROM microbiologyevents d WHERE d.spec_type_desc IN ( SELECT T3.spec_type_desc FROM ( SELECT d.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents d WHERE d.stdt >= '2100-01-01' AND d.stdt < '2101-01-01' GROUP BY d.spec_type_desc ) AS T3 WHERE T3.C1 <= 3 ) AND d.stdt >= '2100-01-01' AND d.stdt < '2101-01-01' ) AS T2 WHERE T1.icustay_id = T2.icustay_id AND T1",,False,0.0,0.0006356239318847656,0,incomplete input,,,
461ff9eeedf5e9452cbf12b2,"Has patient 10007818 had any drainage of peritoneal cavity, percutaneous approach, diagnostic treatment in 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10007818 ) AND procedures_icd.label = 'drainage of peritoneal cavity, percutaneous approach, diagnostic' AND strftime('%Y',procedures_icd.charttime) = '2100'",,False,0.0,0.0008816719055175781,0,no such table: visits,,,
c15288bf26d6222c25fe91c5,Tell me the total ICU visits of patient 10022281 in this year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM icustays WHERE icustays.chartevents_row_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.long_title = 'daily hospital visits' ) ) AND icustays.hospital_dischtime IS NOT NULL AND strftime('%Y',icustays.intime) = strftime('%Y',current_time) AND icustays.patient_id = 10022281",[{'COUNT( DISTINCT icustays.stay_id )': 0}],False,0.0,0.0009417533874511719,0,no such table: definition,,,
fca670cf3abe9563c60d2488,"What was the first time patient 10031757 was prescribed milk of magnesia and polyethylene glycol since 08/2100, at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'milk of magnesia' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'polyethylene glycol' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'polyethylene glycol' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'milk of magnesia' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],False,0.0,0.0005497932434082031,0,"unrecognized token: ""'milk of magnesi""",,,
ee981ea61809ebc1e0cc8d32,Tell me the length of stay in days for patient 10018328's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT DISTINCT w1.value_from_float FROM microbiologyevents AS w1 WHERE w1.hadm_id IN ( SELECT t1.hadm_id FROM ( SELECT o.hadm_id, d_icd_procedures.key FROM procedures d_icd_procedures JOIN patients procedures ON procedures.gender = d_icd_procedures.val WHERE procedures.age = 60 AND procedures.gender = 'male' AND procedures.d_icd_procedures_key = d_icd_procedures.key ) AS t1 JOIN ( SELECT o.hadm_id, d_icd_diagnoses.key FROM diagnoses d_icd_diagnoses JOIN patients diagnoses ON diagnoses.gender = d_icd_diagnoses.val WHERE diagnoses.age = 60 AND diagnoses.gender = 'male' AND diagnoses.d_icd_diagnoses_key = d_icd_diagnoses.key ) AS t2 ON t1.hadm_id = t2.hadm_id WHERE t1.key = t2.key ) AND w1.itemid IN ( 2200, 2201 ) AND w1.valuenum IS NOT NULL ORDER BY w1.charttime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 7.702511574141681}]",False,0.0,0.0005247592926025391,0,incomplete input,,,
26fba96883d9bde92fd8e95f,How many hours have elapsed since the last time patient 10004733 on this hospital stay received a lab test for lactate dehydrogenase (ld)?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', FROM ( SELECT labevents.charttime, patients.chartitems.valuenum FROM labevents JOIN patients ON labevents.hadm_id = patients.chartitems.valuenum WHERE labevents.itemid IN ( SELECT procedureitems.itemid FROM procedures JOIN procedureitems ON procedures.row_id = procedureitems.row_id WHERE procedures.hadm_id = patients.chartitems.valuenum AND procedures.label = 'hospital admission' ) ) ORDER BY labevents.charttime DESC LIMIT 1 ) ) FROM labevents JOIN patients ON labevents.hadm_id = patients.chartitems.valuenum WHERE labevents.itemid IN ( SELECT procedureitems.itemid FROM procedures JOIN procedureitems ON procedures.row_id = procedureitems.row_id WHERE procedures.hadm_id = patients.chartitems.valuenum AND procedures.label = 'hospital admission' ) AND labevents.valuenum = 10004733 AND labevents.itemid IN ( SELECT procedureitems.itemid FROM procedures JOIN procedureitems ON procedures.row_id = procedureitems.row_id WHERE procedures.hadm_id = patients.chartitems.valuenum AND procedures.label = 'hospital admission' ) AND labevents.charttime IS NOT NULL ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.0005211830139160156,0,"near ""FROM"": syntax error",,,
9cdee4aaa2811035370a1c86,Could you show me the daily average weight of patient 10039831 since 07/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-07' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT AVG(d_icd_procedures.charttime - strftime('%J',admissions.admittime)) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.charttime IS NOT NULL AND d_icd_procedures.charttime >= datetime(admissions.admittime) AND admissions.age = 10039831 ) GROUP BY strftime('%Y-%m-%d',d_icd_procedures.charttime)",[],False,0.0,0.0009121894836425781,0,no such column: d_icd_procedures.charttime,,,
c90feea97a983090cf329a91,"This year, what are the top five most frequently prescribed medications for patients who were also prescribed alteplase at the same time?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alteplase' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alteplase' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime < T2.starttime AND datetime(T1.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",[],False,0.0,0.0005164146423339844,0,incomplete input,,,
d91bb87c28806cef8d1448de,When did patient 10023117 for the first time get discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10023117 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT hospital_discharges.charttime FROM hospital_discharges WHERE hospital_discharges.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10023117 ) AND hospital_discharges.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10023117 ) ORDER BY hospital_discharges.charttime ASC LIMIT 1,[{'dischtime': '2170-10-09 16:30:00'}],False,0.0,0.0008528232574462891,0,no such table: hospital_discharges,,,
c1c9a4182c3701af71cb1ea6,"What are the five most frequently prescribed medications for patients diagnosed with urethral stricture, unspecified previously within 2 months, this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urethral stricture, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT d.drug FROM   ( SELECT   t1.subject_id, t1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM     ( SELECT     subject_id, drug FROM       prescription   WHERE       datetime(prescription.starttime,'start of year') = datetime(current_time,'start of year','-0 year')   ) AS t1   WHERE       t1.subject_id IN ( SELECT     subject_id FROM       ( SELECT     subject_id, diagnosis_time FROM       ( SELECT     subject_id, admissions.charttime FROM       admissions   WHERE       admissions.age BETWEEN 0 AND 120   ) AS T1   JOIN       ( SELECT     subject_id, labevents.charttime FROM       labevents   WHERE       labevents.valuenum BETWEEN 0 AND 120   ) AS T2   ON       T1.subject_id = T2.subject_id   WHERE       datetime(T1.charttime) < datetime(T2.charttime)   ) AS T3   JOIN       ( SELECT     subject_id, diagnoses.icd_code, diagnoses.charttime FROM       diagnoses   WHERE       diagnoses.icd_code = '788.40'   ) AS T4   ON       T3.subject_id = T4.subject_id   WHERE       datetime(T3",,False,0.0,0.0005407333374023438,0,incomplete input,,,
5061007ac9969cb42e64a034,When was the first time patient 10018328 had been prescribed enalapril maleate and amlodipine at the same time since 02/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'enalapril maleate' AND admissions.subject_id = 10018328 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'amlodipine' AND admissions.subject_id = 10018328 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT MIN(T1.starttime) FROM prescription AS T1 WHERE T1.drug = 'enalapril maleate' AND T1.hadm_id = 10018328 AND strftime('%Y-%m',T1.starttime) >= '2100-02' EXCEPT SELECT MIN(T2.starttime) FROM prescription AS T2 WHERE T2.drug = 'amlodipine' AND T2.hadm_id = 10018328 AND strftime('%Y-%m',T2.starttime) >= '2100-02' UNION SELECT MIN(T3.starttime) FROM prescription AS T3 WHERE T3.drug = 'enalapril maleate' AND T3.hadm_id = 10018328 AND strftime('%Y-%m',T3.starttime) >= '2100-02' INTERSECT SELECT MIN(T4.starttime) FROM prescription AS T4 WHERE T4.drug = 'amlodipine' AND T4.hadm_id = 10018328 AND strftime('%Y-%m',T4.starttime) >= '2100-02'",[],False,0.0,0.0005321502685546875,0,incomplete input,,,
6f8551a85f07e537ff14bede,How long has it been in hours since the first time ciprofloxacin iv was prescribed to patient 10018081 on the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'ciprofloxacin iv' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers_icd first_time) ) FROM transfers_icd WHERE transfers_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.pid = 10018081 ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.dischtime IS NULL ) AND transfers_icd.drug = 'ciprofloxacin iv' ORDER BY transfers_icd.starttime ASC LIMIT 1",[],False,0.0,0.0005278587341308594,0,"near ""first_time"": syntax error",,,
9e71c9503ead8f262e901ec1,When was patient 10005348 prescribed with docusate sodium and dorzolamide 2%/timolol 0.5% ophth. for the first time at the same time since 08/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'docusate sodium' AND admissions.subject_id = 10005348 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'dorzolamide 2%/timolol 0.5% ophth.' AND admissions.subject_id = 10005348 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT MIN(ordevents.starttime) FROM ordevents WHERE ordevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = ordevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = ordevents.hadm_id ) AND admissions.charttime >= datetime(current_time,'-08 year') AND admissions.charttime < datetime(current_time,'-07 year,08 month,01 day') AND admissions.dischtime IS NOT NULL AND admissions.admission_location = 'emergency room' AND admissions.insurance = 'medicare' ) AND ordevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'docusate sodium' ) AND strftime('%Y-%m-%d %H',ordevents.starttime) >= datetime(current_time,'-08 year') AND strftime('%Y-%m-%d %H',ordevents.starttime) < datetime(current_time,'-07 year,08 month,01 day') AND ordevents.hadm_id = 10005348 EXISTING SELECT MIN(ordevents.starttime) FROM ordevents WHERE ordevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions",[],False,0.0,0.0005261898040771484,0,incomplete input,,,
7ecf2158ebabd494e514c3df,What does a procedure called total esophagectomy cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ) ),SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'total esophagectomy',,False,0.0,0.0019752979278564453,0,no such table: procedures,,,
545a6730c778873c467d8235,Has there been any organism found in the last blood (toxo) microbiology test patient 10038081 received on their last hospital encounter?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood (toxo)' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.org_name IS NOT NULL AND microbiologyevents.spec_type_desc = 'blood (toxo)' AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.pid = 10038081 AND admissions.admittime >= current_time - interval '1 year' ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],False,0.0,0.0019643306732177734,0,"near ""'1 year'"": syntax error",,,
c1ba984738060f77fc1c4445,What number of patients were discharged from the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],True,0.1053006649017334,0.10787773132324219,1,,[{'COUNT( DISTINCT admissions.subject_id )': 0}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
72e0ab522c86eeb3cfdf64d1,When did patient 10016742 first have the minimum heart rate since 282 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-282 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'heart rate' ) AND labevents.valuenum = ( SELECT MIN( labevents.valuenum ) FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'heart rate' ) AND labevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 282 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = '13.95' ) ) AND labevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 282 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = '13.95' ) ORDER BY labevents.charttime ASC LIMIT 1,[],False,0.0,0.0007388591766357422,0,incomplete input,,,
6b2dc0daeb3f829f08bf8da2,"Since the first time patient 10004733 was diagnosed with anemia of other chronic disease in the current hospital visit, how many hours has it been?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia of other chronic disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', SELECT admissions.charttime FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hospital' AND transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'anemia of other chronic disease' ) ) ORDER BY transfers.intime DESC LIMIT 1 ) ) ORDER BY admissions.admittime DESC LIMIT 1 ) ) FROM labevents WHERE labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'anemia of other chronic disease' ) AND labevents.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hospital' AND transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'anemia of other chronic disease' ) ) ORDER BY transfers.intime DESC LIMIT 1 ) ) ORDER BY labevents.charttime ASC LIMIT 1",,False,0.0,0.0005753040313720703,0,"near ""SELECT"": syntax error",,,
0935d36097c74026c3b0a63f,What was the insurance plan of patient 10021666 during the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND chartevents.valuenum IS NOT NULL ) AND procedures_icd.chartevents_id IN ( SELECT chartevents.chartevents_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 2100 ) AND chartevents.valuenum IS NOT NULL ) ORDER BY procedures_icd.chartevents_id ASC LIMIT 1 ),[{'insurance': 'Medicare'}],False,0.0,0.0008823871612548828,0,incomplete input,,,
87caa8d42ef02882ac678a0c,"Following the diagnosis of other abnormal blood chemistry , how many patients developed autistic disorder, current or active state within the same month?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other abnormal blood chemistry' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'autistic disorder, current or active state' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT subject_id, stay_id, int( labevents.charttime ) FROM labevents WHERE labevents.itemid IN ( SELECT DISTINCT chartitems.itemid FROM chartitems WHERE chartitems.label = 'other abnormal blood chemistry' ) ) AS T1 JOIN ( SELECT subject_id, stay_id, int( d_icd_diagnoses.charttime ) FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code = 'F84.0' ) AS T2 ON T1.stay_id = T2.stay_id WHERE datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,False,0.0,0.0005578994750976562,0,"unrecognized token: ""'st""",,,
160050686bf62ecef4c7dce6,Could you tell me the name of the drug that was prescribed two or more times in 07/this year to patient 10020740?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T2.drug FROM ( SELECT procedure_time, patient_id FROM procedures WHERE patient_id = 10020740 AND procedure_name = 'ph this year' AND datetime(procedure_time,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedure_time) = '07' GROUP BY procedure_time, patient_id HAVING COUNT(*) >= 2 ) AS T1 JOIN ( SELECT drug_time, patient_id, drug FROM prescriptions WHERE patient_id = 10020740 AND datetime(drug_time,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',drug_time) = '07' GROUP BY drug_time, patient_id, drug ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.procedure_time < T2.drug_time",[],False,0.0,0.0005469322204589844,0,"unrecognized token: ""'start of""",,,
2e40656c79819632933f3d54,"The number of patients who received drainage of right pleural cavity with drainage device, percutaneous approach.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.on_subject_id FROM procedures WHERE procedures.label = 'drainage of right pleural cavity with drainage device, percutaneous approach' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0009484291076660156,0,no such table: procedures,,,
419163a7cde49786dfda6fcd,When was patient 10019172 first discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1","SELECT hospital_discharges.charttime FROM hospital_discharges WHERE hospital_discharges.age = ( SELECT d_icd_procedures.charttime FROM d_icd_procedures WHERE d_icd_procedures.key = ( SELECT MIN(T1.key) FROM ( SELECT d_icd_procedures.charttime, ROW_NUMBER() OVER ( ORDER BY d_icd_procedures.charttime ) AS 'key' FROM d_icd_procedures WHERE d_icd_procedures.itemid IN ( SELECT admissions.itemid FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.chartkey = ( SELECT d_icd_procedures.chartkey FROM d_icd_procedures WHERE d_icd_procedures.key = ( SELECT MIN(T2.key) FROM ( SELECT d_icd_procedures.charttime, ROW_NUMBER() OVER ( ORDER BY d_icd_procedures.charttime ) AS 'key' FROM d_icd_procedures WHERE d_icd_procedures.itemid IN ( SELECT admissions.itemid FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.chartkey = ( SELECT admissions.chartkey FROM admissions WHERE admissions.subject_id = 10019172 ) ) ) ) AS T2 WHERE T2.chartkey = ( SELECT d_icd_procedures.chartkey FROM d_icd_procedures WHERE d",[],False,0.0,0.0005424022674560547,0,incomplete input,,,
764c80fc36e53d7964e0f522,"Since 01/2100, when was patient 10038933's first microbiology test done?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1",SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'microbiology' ) AND labevents.chartid IN ( SELECT patients.chartid FROM patients WHERE patients.age >= 2100-01-01 AND patients.gender = 'male' AND patients.d_icd_procedures = '2100' ) ORDER BY labevents.charttime ASC LIMIT 1,[{'charttime': '2148-09-10 15:29:00'}],False,0.0,0.0009403228759765625,0,no such table: procedures,,,
e4373b254aad4b11af3fda65,When did patient 10029291 last have a fecal bag event on 03/06/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'fecal bag' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-06' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT d1.starttime FROM microbiologyevents d1 WHERE d1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10029291 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10029291 ) ) AND d1.spec_type_desc = 'fecal bag' AND strftime('%Y-%m-%d',d1.starttime) = '2100-03-06' ORDER BY d1.starttime DESC LIMIT 1",[],False,0.0,0.000988006591796875,0,no such column: d1.starttime,,,
e24591cf66202f06a8ac856c,How much is a diagnosis of secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes going to cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes' ) ),SELECT DISTINCT cost FROM microbiologyevents WHERE microbiologyevents.spec_type = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes',,False,0.0,0.0009105205535888672,0,no such column: cost,,,
aef4b8676c07216d65074512,"How many days have passed since patient 10018081 was given a osmolality, urine laboratory test for the last time in the current hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.chartevents_icustays_icustay_id IN ( SELECT chartevents_icustays_icustay_id FROM chartevents WHERE chartevents.valuenum IS NOT NULL AND chartevents.itemid IN ( SELECT itemid FROM d_icd_items WHERE d_icd_items.long_title = 'osmolality, urine' ) ) AND transfers.hadm_id IN ( SELECT labevents_hadm_id FROM labevents WHERE labevents.valuenum IS NOT NULL AND labevents.itemid IN ( SELECT itemid FROM d_icd_items WHERE d_icd_items.long_title = 'osmolality, urine' ) ) AND transfers.chartevents_icustays_icustay_id IN ( SELECT icustays_icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions_hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IN ( SELECT chartevents.charttime FROM chartevents WHERE chartevents.valuenum IS NOT NULL AND chartevents.itemid IN ( SELECT itemid FROM d_icd_items WHERE d_icd_items.long_title = 'osmolality, urine' ) ) AND admissions",[],False,0.0,0.0005431175231933594,0,incomplete input,,,
52015439c33be0dc487387d4,"What does a bilirubin, total, ascites lab test typically cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, ascites' ) )","SELECT DISTINCT labevents.charttime  FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'bilirubin, total, ascites' )",,False,0.0,0.0008909702301025391,0,no such table: procedures,,,
8e96be7df6dd4cc4c1e2a3b4,How much is the daily minimum weight of patient 10031757 during the last hospital encounter?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MIN(d_icd_procedures.charttime - lag(d_icd_procedures.charttime) OVER ( ORDER BY d_icd_procedures.charttime )) AS result FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= current_date - 1 * 365/3 ) AND d_icd_procedures.itemid IN ( SELECT chartevents.itemid FROM ( SELECT admissions.hadm_id FROM admissions WHERE admissions.pid = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AS admissions JOIN chartevents ON admissions.hadm_id = chartevents.hadm_id WHERE chartevents.itemid IN ( SELECT items.id FROM items WHERE items.table_name = 'chartevents' AND items.name = 'daily weight' ) ),[],False,0.0,0.0005738735198974609,0,incomplete input,,,
71cdc4002dd9037845bd713a,When did patient 10031404 have the first procedure?,SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ORDER BY procedures_icd.charttime ASC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10031404 ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = 10031404 ) ) ORDER BY procedures.starttime ASC LIMIT 1,,False,0.0,0.001140594482421875,0,no such table: procedures,,,
9d986798e601a07346824191,What's the cost of a treatment known as excision of dental lesion of jaw?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) ),SELECT DISTINCT procedures_icd.cost FROM procedures_icd WHERE procedures_icd.label = 'excision of dental lesion of jaw',,False,0.0,0.0009715557098388672,0,no such column: procedures_icd.cost,,,
a17ee07e69ba77566438512c,"Among patients diagnosed with essential and other specified forms of tremor, what were the top four most common lab tests that followed during the same month throughout this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'essential and other specified forms of tremor' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_labitems.itemname FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, labevents.charttime, admissions.admittime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE labevents.valuenum IS NOT NULL AND admissions.age BETWEEN 30 AND 40 AND admissions.gender = 'male' AND admissions.admittime BETWEEN datetime(current_year, 1, 1) AND datetime(current_year, 12, 31, 23, 59, 59) GROUP BY admissions.subject_id, labevents.charttime, admissions.admittime ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.charttime, admissions.admittime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE labevents.valuenum IS NOT NULL AND admissions.age BETWEEN 30 AND 40 AND admissions.gender = 'male' AND admissions.admittime BETWEEN datetime(current_year, 1, 1) AND datetime(current_year, 12, 31, 23, 59, 59) GROUP BY admissions.subject_id",,False,0.0,0.0005593299865722656,0,incomplete input,,,
1ade36110470a7879a7d9e8f,"For patients diagnosed with unspecified disorder of kidney and ureter, what were the top three most common microbiology tests that followed in the same hospital encounter since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified disorder of kidney and ureter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T2.test_name FROM   ( SELECT   T1.subject_id, T1.charttime, T1.valuenum FROM microbiologyevents AS T1 WHERE T1.test_name = 'blood culture' AND T1.hadm_id IN ( SELECT   T2.hadm_id FROM   ( SELECT   T1.subject_id, T1.charttime, T1.valuenum, DENSE_RANK() OVER ( PARTITION BY T1.hadm_id ORDER BY T1.charttime ASC ) AS C1 FROM microbiologyevents AS T1 WHERE T1.test_name = 'blood culture' AND T1.valuenum IS NOT NULL AND strftime('%Y',T1.charttime) >= '2100' ) AS T2 WHERE T2.C1 = 1 ) ) AS T3 JOIN   ( SELECT   T1.subject_id, T1.charttime, T1.valuenum FROM microbiologyevents AS T1 WHERE T1.test_name = 'blood culture' AND T1.hadm_id IN ( SELECT   T2.hadm_id FROM   ( SELECT   T1.subject_id, T1.charttime, T1.valuenum, DENSE_RANK() OVER ( PARTITION BY T1.hadm_id ORDER BY T1.charttime ASC )",,False,0.0,0.0007398128509521484,0,incomplete input,,,
d198804fbc8f627ea7a4dd74,Can you provide the first care unit that patient 10010471 was in according to the transfer record?,SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime ASC LIMIT 1,"SELECT T1.careunit FROM   ( SELECT  TRANSFER_EVENTS.careunit, DENSE_RANK() OVER ( ORDER BY TRANSFER_EVENTS.intime ASC ) AS C1   FROM TRANSFER_EVENTS   WHERE TRANSFER_EVENTS.hadm_id IN ( SELECT  admissions.hadm_id   FROM admissions   WHERE admissions.age = ( SELECT    admissions.age   FROM admissions   WHERE admissions.pid = 10010471   ORDER BY admissions.admittime ASC   LIMIT 1 ) ) ) AS T1   WHERE T1.C1 = 1",[{'careunit': 'Emergency Department'}],False,0.0,0.0009465217590332031,0,no such table: TRANSFER_EVENTS,,,
ce3edde36063a4aeb5180c6d,"On last month/20, what was the maximum value of respiratory rate of patient 10019172?","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '20'","SELECT MAX(d_icd_procedures.charttime - admissions.admittime) FROM d_icd_procedures WHERE d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019172 ) AND datetime(d_icd_procedures.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',d_icd_procedures.charttime) = '20' GROUP BY d_icd_procedures.hadm_id",[{'MAX(chartevents.valuenum)': None}],False,0.0,0.0011057853698730469,0,no such column: d_icd_procedures.charttime,,,
9fd9c725dd075244d0eab9a8,What was the maximum sodium of patient 10020187?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ),SELECT MAX(d_icd_procedures.long_title) FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.charttime IN ( SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.valuenum = ( SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.valuenum = ( SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.valuenum = ( SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.itemid = ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.valuenum = ( SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.valuenum = ( SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.itemid = 8071 AND labevents.charttime IN ( SELECT admissions.charttime FROM admissions WHERE admissions.subject_id =,[{'MAX(labevents.valuenum)': None}],False,0.0,0.0005309581756591797,0,incomplete input,,,
7995633cbc3e134de24ae114,"How many hours has it been since the last time patient 10004733 stayed in the ""neurology"" careunit in this hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hospital_id IN ( SELECT admissions.hospital_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' ) AND transfers.careunit = 'neurology' AND transfers.hospital_id IN ( SELECT admissions.hospital_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' ) AND transfers.charttime IN ( SELECT MIN(transfers.charttime) FROM transfers WHERE transfers.hospital_id IN ( SELECT admissions.hospital_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' ) AND transfers.careunit = 'neurology' AND transfers.hospital_id IN ( SELECT admissions.hospital_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' ) )",[],False,0.0,0.000537872314453125,0,incomplete input,,,
426ce736177896950ecec77f,When was the first time when patient 10038933 received a other diagnostic procedures on lung or bronchus treatment during the first hospital encounter?,SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1,SELECT DISTINCT procedures.charttime FROM procedures WHERE procedures.label = 'other diagnostic procedures on lung or bronchus' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY procedures.charttime ASC LIMIT 1,,False,0.0,0.0014617443084716797,0,no such table: procedures,,,
6e6c78c24792cbb6c1a9ef28,What is the name of the procedure done to patient 10002495 two times since 06/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT procedures.drug FROM procedures WHERE procedures.chartevents_row_id IN ( SELECT T1.chartevents_row_id FROM ( SELECT chartevents.chartevents_row_id, DENSE_RANK() OVER ( ORDER BY chartevents.charttime ASC ) AS C1 FROM chartevents WHERE chartevents.itemid IN ( SELECT procedures_item.itemid FROM procedures_item WHERE procedures_item.label = 'patient' AND procedures_item.value = '10002495' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-06' ) AS T1 WHERE T1.C1 = 2 )",,False,0.0,0.0009596347808837891,0,no such table: procedures,,,
3f4e4d4220d360db25ef5ec8,What is the daily average dose of packed red blood cells given to patient 10008454 in 12/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)","SELECT AVG(d prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 2100 - 1900 AND admissions.gender = 'male' AND admissions.ethnicity = 'not of hispanic origin' AND admissions.d_icd_procedures = '36.01' ) AND prescriptions.drug = 'packed red blood cells' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' GROUP BY strftime('%Y-%m-%d',prescriptions.starttime)",[],False,0.0,0.0005371570587158203,0,"near ""prescriptions"": syntax error",,,
d86a9b2695aa71af6d0d7d55,What treatment did patient 10021118 last receive in their last hospital encounter?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime DESC LIMIT 1 ),SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures.icd_code FROM procedures WHERE procedures.chartevents_charttime IS NOT NULL AND procedures.chartevents_charttime >= ( SELECT admissions.dischtime FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = 10021118 ) AND admissions.admission_location = 'emergency room' ORDER BY admissions.admittime DESC LIMIT 1 ) ) ORDER BY procedures.chartevents_charttime DESC LIMIT 1,,False,0.0,0.001308441162109375,0,no such table: procedures,,,
e27e5f5f51fb07c86c07786c,Tell me the top five most common diagnoses of patients aged 20s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.icd_name FROM   ( SELECT   d_icd_icditems_icd_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiom_icditems d   WHERE   d.age BETWEEN 20 AND 29   AND strftime('%Y',d.charttime) = '2100'   GROUP BY d_icd_icditems_icd_name ) AS T1   WHERE   T1.C1 <= 5   JOIN   microbiom_icd d ON d_icd_icditems_icd_name = d.icd_name",,False,0.0,0.0009450912475585938,0,"near ""JOIN"": syntax error",,,
dbf9297a4c1d683faa792fef,What is the yearly minimum volume of emesis that patient 10001217 had since 07/2100?,"SELECT MIN(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'emesis' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-07' GROUP BY strftime('%Y',outputevents.charttime)",SELECT MIN( d_icd_procedures_icd_items.charttime - lag(d_icd_procedures_icd_items.charttime) OVER ( ORDER BY d_icd_procedures_icd_items.charttime ) ) AS yearly_minimum_volume_of_emesis FROM d_icd_procedures_icd_items WHERE d_icd_procedures_icd_items.icd_code = ( SELECT d_icd_procedures_icd_items.icd_code FROM d_icd_procedures_icd_items WHERE d_icd_procedures_icd_items.long_title = 'emesis' ) AND d_icd_procedures_icd_items.charttime >= '2100-07-01' AND d_icd_procedures_icd_items.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT d_icd_procedures_icd_items.row_id FROM d_icd_procedures_icd_items WHERE d_icd_procedures_icd_items.icd_code = ( SELECT d_icd_procedures_icd_items.icd_code FROM d_icd_procedures_icd_items WHERE d_icd_procedures_icd_items.long_title = 'emesis' ) AND d_icd_procedures_icd_items.charttime >= '2100-07,[],False,0.0,0.0007145404815673828,0,incomplete input,,,
21d5909e4b60ccf617b739c8,Can you list the top four most frequent procedures that patients received in the same month after having right heart cardiac catheterization in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_procedures_key IN ( SELECT T3.icd_procedures_key FROM ( SELECT T2.icd_procedures_key, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.icd_procedures_key = ( SELECT d_icd_procedures.icd_procedures_key FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND strftime('%Y',procedures.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_procedures_key, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime,'start of month') = datetime(T1.charttime,'start of month') GROUP BY T2.icd_procedures_key ) AS T3 WHERE T3",,False,0.0,0.0005598068237304688,0,"unrecognized token: ""'righ""",,,
1e939d14d1e8cb2be9b12f9f,"Count the number of patients diagnosed with dissection of aorta, abdominal who did not come to the hospital within 2 months in 2100.","SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of aorta, abdominal' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of aorta, abdominal' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) = '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.admission_location = 'home' AND strftime('%Y',admissions.admittime) = '2100' ) AND patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'dissection of aorta, abdominal' AND strftime('%Y',procedures.starttime) = '2100' ) HAVING datetime(admissions.dischtime) < datetime(procedures.starttime) AND datetime(admissions.dischtime) >= datetime(procedures.starttime,'-2 month')",,False,0.0,0.0005385875701904297,0,incomplete input,,,
3625536660a06042f6c55dae,What's the cost of a triglycer lab test?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycer' ) ),SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'triglycer lab test',,False,0.0,0.0012922286987304688,0,no such table: procedures,,,
82b93a79d0dad5db6d3f5918,Has patient 10008454 been in the hospital this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10008454 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM hospital_stays WHERE patient_id = 10008454 AND datetime(hospital_stays.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],False,0.0,0.0008881092071533203,0,no such table: hospital_stays,,,
9aad765d228011b95c3cf16c,Show me the top five diagnoses that have the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY T2.C2 ASC ) AS C3 FROM ( SELECT T1.icd_code, AVG(C1) AS C2 FROM ( SELECT patients.d_icd_diagnoses_icd_code, ( CASE WHEN patients.dischtime IS NOT NULL AND patients.outtime IS NOT NULL THEN datetime(patients.outtime) - datetime(patients.dischtime) ELSE 0 END ) / 86400.0 FROM patients WHERE patients.age BETWEEN 50 AND 60 AND strftime('%Y',patients.admittime) = '2100' GROUP BY patients.d_icd_diagnoses_icd_code ) AS T1 JOIN ( SELECT patients.d_icd_diagnoses_icd_code, AVG(C1) AS C2 FROM ( SELECT patients.d_icd_diagnoses_icd_code, ( CASE WHEN patients.dischtime IS NOT NULL AND patients.outtime IS NOT NULL THEN datetime(patients.outtime) - datetime(patients.dischtime) ELSE 0 END ) / 86400.0 FROM patients WHERE",,False,0.0,0.0007181167602539062,0,incomplete input,,,
d4b6c0167cad9291a4e1dbec,Is the value of troponin t in patient 10007058 from the last measurement on the first hospital visit greater than its second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT MIN( transfers.row_id ) FROM transfers WHERE transfers.careunit = 'med/surg' ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labresults.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'troponin t' ) ORDER BY labresults.charttime DESC LIMIT 1 ) > ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT MIN( transfers.row_id ) FROM transfers WHERE transfers.careunit = 'med/surg' ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labresults.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'troponin t' ) ORDER BY labresults.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",False,0.0,0.0005452632904052734,0,incomplete input,,,
70516111809660e05336d719,When was the first sputum microbiology test performed on patient 10021487 in 12/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'sputum microbiology' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.admission_location = 'emergency room' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0012831687927246094,0,no such table: procedures,,,
79c09379a9bdcb0e976df35f,Show me the top four most common microbiology tests since 1 year ago.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT T1.spec_type_desc FROM ( SELECT microbiology_tests.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiology_tests WHERE datetime(microbiology_tests.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiology_tests.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]",False,0.0,0.0008907318115234375,0,no such table: microbiology_tests,,,
ac0594e7c1c0b61c1072e703,What were the top five most common output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]",True,0.5066802501678467,0.5072982311248779,5,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}, {'long_title': 'electrocardiogram'}, {'long_title': 'enteral infusion of concentrated nutritional substances'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 24, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 59, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 73, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 135, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
45b3c545de90501570505db8,What was the dose of heparin flush (10 units/ml) that was prescribed since 04/2100 for the last time to patient 10004235?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = 'heparin flush (10 units/ml)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1",SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hcpc_proc_desc = 'heparin flush (10 units/ml)' AND prescriptions.chartevents_icustay_id IN ( SELECT patients.chartevents_icustay_id FROM patients WHERE patients.age = 100 AND patients.gender = 'male' AND patients.admittime >= '2100-04-01' AND patients.d_icd_diagnoses_icd_code = 'e11.9' ) AND prescriptions.chartevents_icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.age = 100 AND chartevents.gender = 'male' AND chartevents.admittime >= '2100-04-01' AND chartevents.d_icd_diagnoses_icd_code = 'e11.9' ) ORDER BY prescriptions.starttime DESC LIMIT 1,[],False,0.0,0.0006031990051269531,0,incomplete input,,,
42dafd4cb9bdc6f884302fb7,Calculate how many times patient 10021487 had the input of kcl (bolus) in 12/last year.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'","SELECT COUNT(*) FROM labevents WHERE labevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10021487 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year') ) AND admissions.pid = 10021487 ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime BETWEEN datetime(current_time,'start of year','-1 year') AND datetime(current_time,'start of year') AND strftime('%m',chartevents.charttime) = '12' ) WHERE labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'kcl (bolus)' )",[{'COUNT(*)': 0}],False,0.0,0.0007359981536865234,0,"unrecognized token: ""'""",,,
9a8ac4df220dc07a83eeae9b,When was patient 10019777's last insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s) treatment in 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y',procedures_icd.charttime) = '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures_starttime FROM procedures WHERE procedures.label = 'non-drug-eluting peripheral (non-coronary) vessel stent(s) insertion' AND procedures.subject_id = 10019777 AND strftime('%Y',procedures_starttime) = '2100' ORDER BY procedures_starttime DESC LIMIT 1",,False,0.0,0.0009233951568603516,0,no such table: procedures,,,
c1088984666feded19fe629d,Is patient 10020306 male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020306,SELECT patients.gender FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = 8507 ) AND chartevents.valuenum = 1 AND chartevents.charttime IN ( SELECT d_icd_procedures.charttime FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '13.9' AND d_icd_procedures.charttime IN ( SELECT chartevents.charttime FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = 8507 ) AND chartevents.valuenum = 1 ) ) ) AND patients.age IN ( SELECT d_icd_procedures.age FROM d_icd_procedures WHERE d_icd_procedures.icd_code = '13.9' AND d_icd_procedures.charttime IN ( SELECT chartevents.charttime FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linkfrom = 8507 ) AND chartevents.valuenum = 1 ) ) AND patients.d_icd_procedures_icd_code = '13.9' AND patients.age = d_icd_procedures.age AND patients.chartevents_id = d,[{'gender': 'F'}],False,0.0,0.0005488395690917969,0,incomplete input,,,
32fa88a37c2489a86ba893e5,When did patient 10027445 for the last time leave the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10027445 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT hospital_discharges.charttime FROM hospital_discharges WHERE hospital_discharges.patient_id = 10027445 AND hospital_discharges.dischtime IS NOT NULL ORDER BY hospital_discharges.dischtime DESC LIMIT 1,[{'dischtime': '2145-12-19 14:36:00'}],False,0.0,0.0009944438934326172,0,no such table: hospital_discharges,,,
7d00004b3e825ffc842ff770,"Among patients who were diagnosed with asthma, unspecified type, unspecified since 1 year ago, what are the top three most frequent diagnoses that followed afterwards in the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asthma, unspecified type, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asthma, unspecified type, unspecified' ) AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <=",,False,0.0,0.0008969306945800781,0,incomplete input,,,
c2eca2905474a01bac57fe3d,"In the first ICU visit, what was the first mean blood pressure for patient 10018328?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT d.valuenum FROM microbiom_icustays AS a JOIN microbiom_d_icustays ON a.icustay_id = microbiom_d_icustays.icustay_id JOIN microbiom_labevents AS b ON a.icustay_id = microbiom_labevents.icustay_id JOIN microbiom_d_labitems AS c ON b.itemid = microbiom_d_labitems.itemid JOIN microbiom_chartevents AS d ON a.icustay_id = microbiom_chartevents.icustay_id WHERE microbiom_d_labitems.label = 'mean blood pressure' AND a.age = 10018328 AND microbiom_chartevents.charttime BETWEEN a.intime AND a.outtime ORDER BY d.charttime ASC LIMIT 1,[],False,0.0,0.0009222030639648438,0,no such table: microbiom_icustays,,,
b822a4c44ce54f12b21a2ba9,Has any lab test been performed on patient 10015931 in 10/last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.chartkey IN ( SELECT patients.chartkey FROM patients WHERE patients.age >= 10 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = '13.95' AND patients.admittime >= datetime(current_time,'start of year','-1 year') )",[{'COUNT(*)>0': 0}],False,0.0,0.0009267330169677734,0,no such column: patients.chartkey,,,
393404a584eb0bb1b6bbe900,What was the last height reading for patient 10020944 in 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT d.valuenum FROM labevents d WHERE d.hadm_id IN ( SELECT c1.hadm_id FROM patients c1 WHERE c1.age >= 0 AND c1.gender = 'male' AND c1.d_icd_procedures = ' ' AND c1.charttime IS NOT NULL AND c1.charttime >= datetime(current_time,'start of year') AND c1.charttime < datetime(current_time,'start of year','+1 year') AND c1.d_icd_diagnoses = ' ' AND c1.d_icd_procedures_icd_to_char IS NOT NULL AND c1.d_icd_diagnoses_icd_to_char IS NOT NULL AND c1.spec_type IS NOT NULL AND c1.spec_type = ' ' AND c1.insurance IS NOT NULL AND c1.insurance = ' ' AND c1.admission_type IS NOT NULL AND c1.admission_type = ' ' AND c1.dischtime IS NOT NULL AND c1.dischtime >= datetime(current_time,'start of year') AND c1.dischtime < datetime(current_time,'start of year','+1 year') AND c1.admission_location IS NOT NULL AND c1.admission_location = ' ' AND c1.careunit IS NOT NULL AND",[],False,0.0,0.0007190704345703125,0,incomplete input,,,
3721cde992fe90dd17278b65,How many hours have passed since the patient 10021487 was admitted to the hospital?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.chartkey IN ( SELECT procedures.chartkey FROM procedures WHERE procedures.itemid IN ( SELECT definitions.linksto FROM definitions WHERE definitions.label = 'admission' ) ) AND transfers.patientid = 10021487 ORDER BY transfers.intime ASC LIMIT 1",[],False,0.0,0.0009214878082275391,0,no such table: procedures,,,
634500145917954d7e9ba9c0,What are the five most common treatments for patients aged 20s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.treatment FROM ( SELECT procedures.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures WHERE procedures.age BETWEEN 20 AND 29 AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures.drug ) AS T1 WHERE T1.C1 <= 5",,False,0.0,0.000919342041015625,0,no such table: procedures,,,
927645663d3fd105f686319c,"List the top five most frequent procedures that patients underwent during the same month after being diagnosed with adverse effect of anticoagulants, initial encounter in 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'adverse effect of anticoagulants, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'adverse effect of anticoagulants, initial encounter' ) AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <=",,False,0.0,0.000545501708984375,0,incomplete input,,,
70b7e8f278566e9443f31eaf,Has there been any results of the microbiological mrsa screen test for patient 10031757 since 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y',microbiologyevents.charttime) >= '2100'",SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 2100 AND admissions.gender = 'male' AND admissions.pid = 10031757 ) AND microbiologyevents.spec_type_desc = 'mrsa screen',[{'COUNT(*)>0': 0}],False,0.0,0.0015645027160644531,0,no such column: admissions.gender,,,
783af9c867b3757480fa6805,Can you tell me the top five most common procedures this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,True,0.10283279418945312,0.10332012176513672,0,,,,"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 29, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 64, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 78, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 140, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
ed31b107608f8a15bae7aa15,How much is a diagnosis of hypovolemia going to cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypovolemia' ) ),SELECT DISTINCT cost FROM microbiology_lab_cost WHERE microbiology_lab_cost.spec_type = 'hypovolemia',,False,0.0,0.0008978843688964844,0,no such table: microbiology_lab_cost,,,
c60ed59c6b7df6bf5fbfa0cf,How many hours have passed since the first time patient 10004733 has taken a albumin lab test during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', FROM ( SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.name = 'albumin' ) AND labevents.hospitalid = 10004733 ) ORDER BY labevents.charttime ASC LIMIT 1 ) ) FROM dual",[],False,0.0,0.00046062469482421875,0,"near ""FROM"": syntax error",,,
f3b876d4c257e4b4bc897442,Can you fetch me patient 10016810's yearly maximum albumin 25% input since 07/02/2100?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-02' GROUP BY strftime('%Y',inputevents.starttime)","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 50 AND admissions.gender = 'male' AND admissions.ethnicity = 'asian' AND admissions.admissiontype = 'emergency' AND admissions.insurance = 'medicare' ) AND chartevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.label = 'laparoscopic cholecystectomy' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-07-02' GROUP BY strftime('%Y',chartevents.charttime)",[],False,0.0,0.0012252330780029297,0,no such column: admissions.gender,,,
ce229386a278fc4dbc3f4f87,What was patient 10021487's last weight since 20 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-20 month') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT d.valuenum FROM labevents d WHERE d.hadm_id IN ( SELECT c.hadm_id FROM patients c WHERE c.age >= 20 AND c.gender = 'male' AND c.subject_id = 10021487 ) AND d.itemid IN ( SELECT b.itemid FROM d_icd_items b WHERE b.long_title = 'daily weight' ) ORDER BY d.charttime DESC LIMIT 1,[],False,0.0,0.001081228256225586,0,no such table: d_icd_items,,,
a75f7d749b9d5901f73d2d35,What's the maximum total hospital charged for a visit with a atypical lymphocytes lab test?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'atypical lymphocytes' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM( hospital_charges ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT labtests.itemid FROM labtests WHERE labtests.label = 'atypical lymphocytes' ) GROUP BY labevents.hadm_id ) AS T1,,False,0.0,0.0009152889251708984,0,no such table: labtests,,,
59e57b904fb229550751564d,What is the average daily number of patients who had embolism and thrombosis of other specified artery in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'embolism and thrombosis of other specified artery' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM microbiome_samples AS T2 WHERE T2.spec_type_desc = 'embolism and thrombosis of other specified artery' AND strftime('%Y',T2.deidentified_icustay_id_entrancetime) = '2100' GROUP BY strftime('%Y-%m-%d',T2.deidentified_icustay_id_entrancetime) ) AS T1",,False,0.0,0.0008492469787597656,0,no such table: microbiome_samples,,,
472793119170f9c8adb0b84b,Is patient 10021487's diastolic blood pressure ever less than 31.0 since 09/08/2100?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 31.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-08'",SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT procedureitems.itemid FROM procedureitems WHERE procedureitems.stay_id IN ( SELECT patients.stay_id FROM patients WHERE patients.charttime IS NOT NULL AND patients.age IS NOT NULL AND patients.gender IS NOT NULL AND patients.d_icd_diagnoses_icd_code IS NOT NULL AND patients.admission_type_desc IS NOT NULL AND patients.dischtime IS NOT NULL AND patients.age >= 50 AND patients.gender = 'male' ) ) AND labevents.valuenum < 31.0 AND labevents.charttime >= '2100-09-08' AND labevents.stay_id IN ( SELECT patients.stay_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' AND patients.d_icd_diagnoses_icd_code IS NOT NULL AND patients.admission_type_desc IS NOT NULL AND patients.dischtime IS NOT NULL AND patients.charttime IS NOT NULL AND patients.age IS NOT NULL AND patients.gender IS NOT NULL ) AND patients.subject_id = 10021487,[{'COUNT(*)>0': 0}],False,0.0,0.0006709098815917969,0,incomplete input,,,
234a24d7c0ae3805bd918372,What condition was patient 10008454 diagnosed with the last time on the first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT labevents.itemid FROM labevents WHERE labevents.charttime IN ( SELECT transfers.intime FROM transfers WHERE transfers.hospitaldisch IS NOT NULL AND transfers.age = ( SELECT MIN(transfers.age) FROM transfers WHERE transfers.hospitaldisch IS NOT NULL ) ) AND labevents.valuenum = ( SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.charttime IN ( SELECT transfers.intime FROM transfers WHERE transfers.hospitaldisch IS NOT NULL AND transfers.age = ( SELECT MIN(transfers.age) FROM transfers WHERE transfers.hospitaldisch IS NOT NULL ) ) ) ),,False,0.0,0.0005095005035400391,0,incomplete input,,,
5886a94103455554061fb16a,What was the quantity of glucose gel dose prescribed to patient 10020740 in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'glucose gel' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'","SELECT SUM(ins_orders.dollars) FROM ins_orders WHERE ins_orders.chartevents_icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 21054 ) AND chartevents.valuenum IS NOT NULL AND chartevents.charttime BETWEEN datetime(current_time,'start of year') AND datetime(current_time,'start of year','+0 year') AND chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10020740 AND admissions.admittime BETWEEN datetime(current_time,'start of year') AND datetime(current_time) ORDER BY admissions.admittime DESC LIMIT 1 ) ) ORDER BY chartevents.charttime ASC LIMIT 1 ) GROUP BY ins_orders.chartevents_icustay_id",[{'SUM(prescriptions.dose_val_rx)': None}],False,0.0,0.0004374980926513672,0,incomplete input,,,
e7d42c3433b73b5b7e9bab9a,"Has patient 10021312 been treated with a destruction of right lower lung lobe, via natural or artificial opening endoscopic since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10021312 ) AND procedures_icd.icd_code = '0jg0j0zjz' AND strftime('%Y',procedures_icd.charttime) >= '2100'",,False,0.0,0.0012056827545166016,0,no such table: visits,,,
e19ea171900405ad202eba5f,Retrieve the marital status of patient 10038081 on their first hospital visit.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patients.marital_status FROM patients WHERE patients.chartitems.chart_id IN ( SELECT admissions.chart_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.chart_id IN ( SELECT chartevents.chart_id FROM chartevents WHERE chartevents.valuenum = 10038081 AND chartevents.chartevents.itemid IN ( SELECT definition.itemid FROM definition WHERE definition.label = 'age' ) ) ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY admissions.admittime ASC LIMIT 1,[{'marital_status': 'SINGLE'}],False,0.0,0.0010654926300048828,0,no such table: definition,,,
6df8c8add4bde78a73d76071,When was the first time patient 10009035 received the procedure of extracorporeal circulation auxiliary to open heart surgery in the last hospital visit?,SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1,SELECT hospital_records.charttime FROM hospital_records WHERE hospital_records.hadm_id IN ( SELECT transfers.intime_time FROM transfers WHERE transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'age' ) AND labevents.valuenum = 10009035 ) ORDER BY transfers.intime_time DESC LIMIT 1 ) ) ORDER BY hospital_records.charttime ASC LIMIT 1,,False,0.0,0.0009405612945556641,0,no such table: hospital_records,,,
5f65914db7e338f8263f8fa7,When was patient 10001217 prescribed the drug heparin and ondansetron at the same time for the last time in 12/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10001217 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10001217 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT MIN(ord1.starttime) FROM microbiologyevents AS ord1 WHERE ord1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.gender = 'male' AND patients.d_icd_procedures = '13.99' AND patients.charttime IS NOT NULL AND strftime('%Y',patients.charttime) = strftime('%Y',current_time) - 1 AND patients.id = 10001217 ) ) AND ord1.spec_type_desc = 'heparin' AND strftime('%Y-%m',ord1.starttime) = strftime('%Y-%m',current_time) - 0 AND strftime('%d',ord1.starttime) = '12' EXCEPT SELECT MIN(ord2.starttime) FROM microbiologyevents AS ord2 WHERE ord2.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.gender = 'male' AND patients.d_icd_procedures = '13.99' AND patients.charttime IS NOT NULL AND strftime('%Y',patients.charttime) = strftime('%Y',current_time) - 1 AND patients.id = 10001217 ) ) AND ord2.spec_type_desc = 'ond",[],False,0.0,0.0006084442138671875,0,incomplete input,,,
a54ef0e3bf3dcba73ecf9d1f,"What are the five commonly prescribed drugs for patients diagnosed with personal history of malignant neoplasm of large intestine previously within 2 months, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T2.drug FROM ( SELECT patients.subject_id FROM patients WHERE patients.age >= 18 ) AS T1 JOIN ( SELECT patients.subject_id, prescriptions.drug FROM patients JOIN prescriptions ON patients.subject_id = prescriptions.subject_id WHERE prescriptions.starttime >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id JOIN ( SELECT patients.subject_id, procedures.icd_code FROM patients JOIN procedures ON patients.subject_id = procedures.subject_id WHERE procedures.icd_code = 'Z85.038' AND procedures.starttime >= datetime(current_time,'-1 year') ) AS T3 ON T2.subject_id = T3.subject_id WHERE T2.starttime >= datetime(T3.starttime,'-2 month') GROUP BY T2.drug ORDER BY COUNT(*) DESC LIMIT 5",,False,0.0,0.0005462169647216797,0,incomplete input,,,
ddb17df095695ae5f9fbddeb,Tell me the top three most common diagnoses for patients with age 60 or above in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d.icd_name FROM   ( SELECT   d_icd_icditems_icd_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiom ic   JOIN   d_icd_icditems d   ON   ic.icd_code = d.icd_icditems_icd_code   WHERE   ic.age >= 60   AND strftime('%Y',ic.charttime) = '2100'   GROUP BY   d_icd_icditems_icd_name ) AS T1   WHERE   T1.C1 <= 3",,False,0.0,0.0008678436279296875,0,no such table: microbiom,,,
89105357ecaae9b49a2a1134,How many patients received a closed [endoscopic] biopsy of bronchus after the procedure of arterial catheterization during the same hospital encounter?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",endoscopic,,False,0.0,0.000385284423828125,0,"near ""endoscopic"": syntax error",,,
16df9ac99e3822d7b993b443,"During this year, what are the top five most frequent lab tests given to patients during the same hospital encounter after pleurisy without mention of effusion or current tuberculosis?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pleurisy without mention of effusion or current tuberculosis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT d_labitems.itemname FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, admissions.charttime, admissions.dischtime, admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 60 AND admissions.admission_location = 'emergency room' AND admissions.admission_type = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND admissions.dischtime IS NOT NULL ) AS T1 JOIN ( SELECT events.subject_id, events.itemid, events.charttime, events.hadm_id FROM events WHERE events.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.label = 'pleurisy without mention of effusion or current tuberculosis' ) AND datetime(events.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.hadm_id = T2.hadm_id AND T1.charttime < T2.charttime AND datetime(T1.charttime,'start",,False,0.0,0.0005373954772949219,0,"unrecognized token: ""'st""",,,
22605cacd4a47bb1b91b1b75,What was the name of the drug that patient 10031757 had been prescribed two times in 11/this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 = 2","SELECT T2.drug FROM ( SELECT procedures.charttime, procedures.itemid FROM procedures WHERE procedures.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.chartid = 10031757 ) AND admissions.gender = ( SELECT DISTINCT patients.gender FROM patients WHERE patients.chartid = 10031757 ) ) AND procedures.itemid IN ( SELECT definitions.row_id FROM definitions WHERE definitions.linksto = 'prescriptions' AND definitions.linksto = 'procedures' ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.itemid FROM prescriptions WHERE prescriptions.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.chartid = 10031757 ) AND admissions.gender = ( SELECT DISTINCT patients.gender FROM patients WHERE patients.chartid = 10031757 ) ) ) AS T2 ON T1.charttime < T2.starttime WHERE T1.itemid = T2.itemid AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',T1.charttime) = '11' GROUP BY T2.drug HAVING COUNT(*) = 2",[],False,0.0,0.0008552074432373047,0,incomplete input,,,
e38192db81eb4aedd18e81f8,Calculate the total volume of mediastinal for patient 10005817 on 12/24/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'mediastinal' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-24'","SELECT SUM(d_icd_procedures_icd_items.charttime_1.charttime - d_icd_procedures_icd_items.charttime_0.charttime) FROM d_icd_procedures_icd_items WHERE d_icd_procedures_icd_items.charttime_0.charttime IS NOT NULL AND d_icd_procedures_icd_items.charttime_0.stdt = datetime(current_time,'start of year','-0 year') + interval '12-24' AND d_icd_procedures_icd_items.charttime_0.value = 'mediastinal' AND d_icd_procedures_icd_items.charttime_0.spec_type = 'for patient 10005817' JOIN d_icd_procedures_icd_items charttime_1 ON d_icd_procedures_icd_items.charttime_0.stdt = charttime_1.stdt AND d_icd_procedures_icd_items.charttime_0.spec_type = charttime_1.spec_type WHERE charttime_1.charttime IS NOT NULL AND charttime_1.stdt = datetime(current_time,'start of year','-0 year') + interval '12-24' AND charttime_1.value = 'mediastinal' AND charttime_1.spec_type = 'for patient 100058",[{'SUM(outputevents.value)': None}],False,0.0,0.0008287429809570312,0,"near ""'12-24'"": syntax error",,,
a07e014b5e2eb6177b5978a3,"Since 15 months ago, what was the last weight for patient 10011398?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-15 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT d.valuenum FROM labevents d WHERE d.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = 'Z00.00' ) AND d.charttime >= datetime(current_time,'-15 month') ORDER BY d.charttime DESC LIMIT 1",[],False,0.0,0.0009317398071289062,0,no such column: p.itemid,,,
23ecc70fdf2e92d39a932541,What would be the average yearly number of patients diagnosed with methicillin susceptible pneumonia due to staphylococcus aureus?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible pneumonia due to staphylococcus aureus' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM microbiologyevents T2 WHERE T2.spec_type_desc = 'blood culture' AND T2.org_name_desc = 'methicillin susceptible pneumonia due to staphylococcus aureus' GROUP BY strftime('%Y',T2.charttime) ) AS T1",,False,0.0,0.0009064674377441406,0,no such column: T2.org_name_desc,,,
882c567028490e3b5f7d3fcc,What is the count of patients admitted to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],True,0.18863630294799805,0.18908953666687012,1,,[{'COUNT( DISTINCT admissions.subject_id )': 174611}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
86741d2d640a5dbbfa5d1036,Can you tell me the last thyroid stimulating hormone value of patient 10010471 in 05/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroid stimulating hormone' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '05' ORDER BY labevents.charttime DESC LIMIT 1","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.charttime >= datetime(current_time,'start of year') AND datetime(admissions.admittime,'+4 year') = datetime(current_time,'start of year','-0 year') AND admissions.pid = 10010471 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'thyroid stimulating hormone' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '05' ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.0005583763122558594,0,incomplete input,,,
58f40bf6ff1c20a773a056ae,"Among the patients who were prescribed fentanyl citrate, what are the five most frequently prescribed drugs at the same time in this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'fentanyl citrate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT d.drug FROM   (   SELECT   t1.subject_id, t1.drug FROM   (   SELECT   subject_id,       drug,       d_icd_procedures_icd_items_key   FROM   microbiom.d_icd_procedures_icd_items_key   WHERE   d_icd_procedures_icd_items_key.icd_code = (   SELECT   d_icd_procedures_icd_items_key.icd_code   FROM   microbiom.d_icd_procedures_icd_items_key   WHERE   d_icd_procedures_icd_items_key.long_title = 'fentanyl citrate'   )   ) AS t1   JOIN   (   SELECT   subject_id,       drug,       d_icd_procedures_icd_items_key   FROM   microbiom.d_icd_procedures_icd_items_key   WHERE   d_icd_procedures_icd_items_key.icd_code = (   SELECT   d_icd_procedures_icd_items_key.icd_code   FROM   microbiom.d_icd_procedures_icd_items_key   WHERE   d_icd_procedures_icd_items_key.long_title = 'fentanyl citrate'   )   ) AS t2   ON t1.subject_id = t2.subject_id   WHERE   t1",[],False,0.0,0.0008380413055419922,0,incomplete input,,,
905bf1d8d8b2ee5cc48396ca,"Has the prescription of sodium chloride 0.9%, nicardipine iv, or ondansetron been given to patient 10039997 in 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND prescriptions.drug IN ( 'sodium chloride 0.9%', 'nicardipine iv', 'ondansetron' ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.drug IN ( 'sodium chloride 0.9%', 'nicardipine iv', 'ondansetron' ) AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age IS NOT NULL AND admissions.age >= 18 AND admissions.age < 85 AND admissions.gender = 'male' AND admissions.year = 2100 ) AND prescriptions.hadm_id = 10039997",[{'COUNT(*)>0': 0}],False,0.0,0.0008280277252197266,0,no such column: admissions.gender,,,
9aab7dbbef98a04db8de27da,"How much does the calcium, total lab test typically cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) )","SELECT DISTINCT cost FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'calcium, total lab test' )",,False,0.0,0.0008893013000488281,0,no such column: cost,,,
be39c5b68e4b0a9b3ed9659c,What age was patient 10013049 during their first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT DISTINCT patients.age FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.linksto = 'chartevents' AND definition.label = 'age' ) ) AND patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.linksto = 'chartevents' AND definition.label = 'outpatient' ) AND chartevents.valuenum = 0 ) AND patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.linksto = 'chartevents' AND definition.label = 'hospital admission' ) AND chartevents.valuenum = 1 ) AND patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.linksto = 'chartevents' AND definition.label = 'died' ) AND chartevents.valuenum = 0 ) AND patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.linksto = 'chartevents,,False,0.0,0.0005426406860351562,0,incomplete input,,,
7b95ae7410b397d1e2505afb,"Since 2100, what are the top four most commonly taken specimens for patients in the same hospital encounter after the diagnosis of personal history of malignant neoplasm of other gastrointestinal tract?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of other gastrointestinal tract' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of other gastrointestinal tract' ) AND strftime('%Y',diagnoses.chart_time) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.chart_time, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.chart_time) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,False,0.0,0.0005288124084472656,0,"unrecognized token: ""'personal history of malignant neoplasm o""",,,
45b34eeae5d3c8d44b703194,How much docusate sodium (liquid) dose has been prescribed to patient 10007818 on the first hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'docusate sodium (liquid)',SELECT SUM(d_icd_prescriptions.dose_val_rx) FROM d_icd_prescriptions WHERE d_icd_prescriptions.hcpc_procedure_desc = 'docusate sodium (liquid)' AND d_icd_prescriptions.charttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = d_icd_prescriptions.charttime ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = d_icd_prescriptions.charttime ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND d_icd_prescriptions.charttime < ( SELECT admissions.admittime FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = d_icd_prescriptions.charttime ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = d_icd_prescriptions.charttime ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 OFFSET 1 ) AND d_icd_prescriptions.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = d_icd_prescriptions.charttime ) AND admissions.gender = ( SELECT patients.gender FROM,[{'SUM(prescriptions.dose_val_rx)': None}],False,0.0,0.0008718967437744141,0,incomplete input,,,
8a2c412e28bd7e4d00a2c261,What number of hours have passed since patient 10021487 first received a ntprobnp lab test during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ntprobnp' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', FROM hospital_events WHERE subject_id = 10021487 AND hospital_events.label = 'admission' AND hospital_events.chart_time >= datetime(current_time,'-1 year')) ) FROM labevents WHERE labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'ntprobnp' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],False,0.0,0.0005826950073242188,0,"near ""FROM"": syntax error",,,
470efb33e7b9dd7a698151cf,How many patients stayed in the discharge lounge as a transfer care unit this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'discharge lounge' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.destination_lounge = 'discharge lounge' AND admissions.careunit = 'transfer' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0013012886047363281,0,no such column: admissions.destination_lounge,,,
8d027ecd151d527ed8671fee,What are the four most frequently conducted lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_labitems.item FROM   ( SELECT   d_labitems.item, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   d_labitems   WHERE   d_labitems.charttime >= strftime('%Y-01-01 00:00:00',2100)   GROUP BY d_labitems.item ) AS T1   WHERE T1.C1 <= 4",[],False,0.0,0.0010137557983398438,0,no such column: d_labitems.item,,,
8706d212667c3018e03000a7,Is the value of mean blood pressure of patient 10031757 second measured on the first ICU visit greater than it is first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT AVG(d_icd_icustays.charttime) FROM d_icd_labitems WHERE d_icd_labitems.itemid IN ( SELECT d_icd_icustays.chartevents.itemid FROM d_icd_icustays WHERE d_icd_icustays.icustay_id IN ( SELECT MIN(o_icustays.icustay_id) FROM o_icustays WHERE o_icustays.age = ( SELECT T1.age FROM ( SELECT o_icustays.age, DENSE_RANK() OVER ( ORDER BY o_icustays.age ) AS C1 FROM o_icustays WHERE o_icustays.charttime IS NOT NULL ) AS T1 WHERE T1.C1 = 1 ) AND o_icustays.admission_location = 'emergency room' ) ) AND d_icd_labitems.label = 'mean blood pressure' AND d_icd_icustays.chartevents.charttime >= o_icustays.intime AND d_icd_icustays.chartevents.charttime < o_icustays.outtime ORDER BY d_icd_icustays.chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT AVG(d_icd_icustays.charttime) FROM d_icd_labitems WHERE d_icd_labitems.itemid IN ( SELECT","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0006568431854248047,0,"unrecognized token: ""'emergency room""",,,
376ce2f69b8cda44c3960e60,What are the three most commonly administered lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT d_labitems.itemname FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",False,0.0,0.0009348392486572266,0,no such column: d_labitems.itemname,,,
73a44b74d4ae03e85322ee51,What does fusion or refusion of 2-3 vertebrae cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fusion or refusion of 2-3 vertebrae' ) ),SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'fusion or refusion of 2-3 vertebrae',,False,0.0,0.0008707046508789062,0,no such table: procedures,,,
c731547cf5d2fc4a71b9d129,How many days ago was the last time patient 10018081 was diagnosed with other and unspecified hyperlipidemia in their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', FROM ( SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) + ( SELECT labevents.charttime FROM labevents WHERE labevents.valuenum = ( SELECT MIN( labevents.valuenum ) FROM labevents WHERE labevents.label = 'other and unspecified hyperlipidemia' AND labevents.charttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) ) ) ) FROM dual",,False,0.0,0.0005357265472412109,0,"near ""FROM"": syntax error",,,
44ba2f356939ab27e43cbc9a,When was patient 10000032 first given a creatinine test in 05/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.charttime ASC LIMIT 1",SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'creatinine' ) AND labevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = '2100' ) ORDER BY labevents.charttime ASC LIMIT 1,[],False,0.0,0.0008745193481445312,0,no such table: procedures,,,
8777f5505af432365af01179,What is patient 10029291's difference in weight from the second value measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT admissions.charttime FROM labevents JOIN admissions ON labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'weight' ) AND labevents.hadm_id = admissions.hadm_id WHERE labevents.valuenum IS NOT NULL AND admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents JOIN admissions ON labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'weight' ) AND labevents.hadm_id = admissions.hadm_id WHERE labevents.valuenum IS NOT NULL ) ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT admissions.charttime FROM labevents JOIN admissions ON labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'weight' ) AND labevents.hadm_id = admissions.hadm_id WHERE labevents.valuenum IS NOT NULL AND admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents JOIN admissions ON labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'weight' ) AND labevents.h,"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0005388259887695312,0,incomplete input,,,
d0be97adb482380a1a57585d,How many times patient 10027602 have a foley output recorded on 12/05/this year?,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-05'","SELECT COUNT(*) FROM foley_output WHERE foley_output.charttime >= datetime(current_time,'start of year') AND foley_output.charttime < datetime(current_time,'start of year','+1 year','-1 second') AND foley_output.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.key = ( SELECT procedures_icd.key FROM procedures_icd WHERE procedures_icd.icd_code = '13.95' ) ) AND admissions.gender = 'male' AND admissions.age >= 50 ) AND foley_output.valuenum IS NOT NULL AND foley_output.hadm_id = 10027602 AND datetime(foley_output.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND datetime(foley_output.charttime,'day of month') = 12",[{'COUNT(*)': 0}],False,0.0,0.0004475116729736328,0,incomplete input,,,
1eff45de74ada2d6145da372,Has any laboratory test been performed on patient 10004733 this month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')","SELECT COUNT(*)>0 FROM labevents WHERE labevents.chartkey IN ( SELECT patients.chartkey FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' AND patients.d_icd_procedures_icd_code = 'J3300' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')",[{'COUNT(*)>0': 0}],False,0.0,0.0009312629699707031,0,no such column: patients.chartkey,,,
3e69022ac78531ddbbfd8b99,"Has patient 10016742 had any introduction of nutritional substance into lower gi, via natural or artificial opening treatment since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",SELECT COUNT(*)>0 FROM microbiologyevents WHERE patient_id = 10016742 AND organism_name = 'enterococcus faecalis' AND charttime >= '2100-01-01',,False,0.0,0.0007274150848388672,0,no such column: patient_id,,,
8e98cbdccd57c7ac55a6c6a1,How many patients received albuterol inhaler in the same month after the confirmation of toxic encephalopathy?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'toxic encephalopathy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'albuterol inhaler' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month')","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_studies a JOIN microbiome_studies b ON a.subject_id = b.subject_id WHERE a.spec_type_desc = 'toxic encephalopathy' AND b.spec_type_desc = 'albuterol inhaler' AND datetime(a.charttime,'start of month') = datetime(b.charttime,'start of month') AND a.charttime < b.charttime",,False,0.0,0.0008690357208251953,0,no such table: microbiome_studies,,,
0bc89b236b722c5eb64dffa8,"What is the maximum total hospital cost, which includes the procedure named insertion of catheter into spinal canal for infusion of therapeutic or palliative substances?",SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.key = ( SELECT patients.key FROM patients WHERE patients.age >= 20 ) AND procedures.name = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' GROUP BY procedures.key ) AS T1,,False,0.0,0.0009212493896484375,0,no such table: procedures,,,
ffbb740b9da08e9805048c7f,What was patient 10014729's insurance plan on the last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,"SELECT d.insurance_plan FROM microbiome_insurance_plan d WHERE d.chartkey IN ( SELECT t.chartkey FROM ( SELECT o.chartkey, o.row_id FROM microbiome_labevents o WHERE o.itemid IN ( SELECT p.itemid FROM microbiome_d_icd_items p WHERE p.long_title = 'insurance plan' ) AND o.valuenum IS NOT NULL ORDER BY o.charttime DESC ) AS t WHERE t.row_id IN ( SELECT s.row_id FROM ( SELECT o.chartkey, o.row_id FROM microbiome_labevents o WHERE o.itemid IN ( SELECT p.itemid FROM microbiome_d_icd_items p WHERE p.long_title = 'insurance plan' ) AND o.valuenum IS NOT NULL ORDER BY o.charttime DESC ) AS s WHERE s.chartkey = t.chartkey ) - 1 ) AND d.chartkey IN ( SELECT t.chartkey FROM ( SELECT o.chartkey, o.row_id FROM microbiome_labevents o WHERE o.itemid IN ( SELECT p.itemid FROM microbiome_d_icd_items p WHERE p.long_title = 'insurance plan' ) AND o.valuenum IS NOT NULL ORDER BY o.charttime DESC ) AS t WHERE t.row_id IN ( SELECT s.row_id FROM ( SELECT o.chartkey, o",[{'insurance': 'Other'}],False,0.0,0.0005502700805664062,0,incomplete input,,,
5d95e49bfd6d7191297dda3e,How many patients with ventricular tachycardia were there?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'ventricular tachycardia' ) ),SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'ventricular tachycardia' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0008573532104492188,0,no such table: procedures,,,
137af49a158f5739eb59024e,What is the 3-month survival probability for patients living with a asymptomatic human immunodeficiency virus [hiv] infection status diagnosis?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asymptomatic human immunodeficiency virus [hiv] infection status' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )",hiv,,False,0.0,0.0004913806915283203,0,"near ""hiv"": syntax error",,,
3508fba9387d18248281be4e,Was patient 10014078 diagnosed with a disease during their last hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.charttime IS NOT NULL AND admissions.age IS NOT NULL AND admissions.gender = 'male' AND admissions.spec_type IS NOT NULL AND admissions.spec_type = 'sputum' AND admissions.d_icd_procedures_icd_id IS NOT NULL AND admissions.d_icd_procedures_icd_id = 2100  FROM admissions WHERE admissions.gender = 'male' AND admissions.spec_type IS NOT NULL AND admissions.spec_type = 'sputum' AND admissions.d_icd_procedures_icd_id IS NOT NULL AND admissions.d_icd_procedures_icd_id = 2100  ORDER BY admissions.admittime DESC LIMIT 1 ) ),[{'COUNT(*)>0': 1}],False,0.0,0.0005629062652587891,0,"near ""FROM"": syntax error",,,
b1b111763ce05423f194b8d8,"What is the minimum total cost of a hospital that runs total protein, urine laboratory tests since 1 year ago?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, urine' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(LAB_RESULTS.cost) AS C1 FROM LAB_RESULTS WHERE LAB_RESULTS.spec_type_desc = 'total protein, urine' AND datetime(LAB_RESULTS.charttime) >= datetime(current_time,'-1 year') GROUP BY LAB_RESULTS.hadm_id ) AS T1",,False,0.0,0.0007634162902832031,0,no such table: LAB_RESULTS,,,
3c063dda3762046fb6f125fe,Get me the top four most frequently tested specimens that patients took in the same month after being diagnosed with pleural effusion in other conditions classified elsewhere.,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pleural effusion in other conditions classified elsewhere' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pleural effusion in other conditions classified elsewhere' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.chart_time, labevents.spec_type FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of month') = datetime(T2.chart_time,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,False,0.0,0.0005617141723632812,0,incomplete input,,,
f970e95c531ff8f40c37fadc,How many patients in 2100 received coronary arteriography using two catheters after the single internal mammary-coronary artery bypass procedure within the same hospital visit?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT a.subject_id ) FROM microbiome_study a JOIN ( SELECT DISTINCT o.subject_id, o.charttime, o.hadm_id FROM microbiome_study o WHERE o.spec_type_desc = 'single internal mammary-coronary artery bypass' AND strftime('%Y',o.charttime) = '2100' ) b ON a.subject_id = b.subject_id WHERE a.spec_type_desc = 'coronary arteriography' AND a.hadm_id = b.hadm_id AND a.charttime is not null AND b.charttime is not null AND datetime(a.charttime) >= datetime(b.charttime) AND strftime('%Y',a.charttime) = '2100' AND a.spec_type_desc = 'coronary arteriography using two catheters' GROUP BY a.hadm_id HAVING count( DISTINCT strftime('%J',a.charttime) ) = 1",,False,0.0,0.000530242919921875,0,incomplete input,,,
76a3b26583f61cc00377b6a2,Count the medications that patient 10004720 was prescribed since 04/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.chartevents_icustay_id IN ( SELECT patients_icustays.icustay_id FROM patients_icustays WHERE patients_icustays.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'",[{'COUNT(*)': 82}],False,0.0,0.0007867813110351562,0,no such table: patients_icustays,,,
ef5e50d5ccd02aaa3b7e4873,What percentile is a magnesium value of 2.0 among patients of the same age as patient 10037975 on their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.0","SELECT DISTINCT T1.C1 FROM ( SELECT patients.age, labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents JOIN patients ON labevents.subject_id = patients.subject_id WHERE labevents.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.type = 'lab' ) AND patients.gender = 'male' AND patients.age IS NOT NULL AND labevents.valuenum = 2.0 ) AS T1 WHERE T1.age = ( SELECT patients.age FROM patients WHERE patients.gender = 'male' AND patients.age IS NOT NULL AND patients.subject_id = 10037975 )",,False,0.0,0.0005352497100830078,0,incomplete input,,,
dbe56779e1a5f940e7fde7f8,Keep count of how many times patient 10020944 outputted oral gastric on 03/12/this year.,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'oral gastric' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-12'","SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10020944 AND organism_name = 'oral gastric' AND datetime BETWEEN datetime(current_year, '-0 year') AND datetime(current_year, '-0 year', '12-03')",[{'COUNT(*)': 0}],False,0.0,0.0009107589721679688,0,no such column: patient_id,,,
debd4fb35717b39a57ee2bec,Tell me the diagnosis cost of unspecified essential hypertension in a patient?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) ),"SELECT DISTINCT T1.cost FROM   ( SELECT   patients.subject_id, diagnoses.charttime   FROM     diagnoses   WHERE     diagnoses.label = 'unspecified essential hypertension'   AND     diagnoses.age >= 50   AND     diagnoses.age < 60 ) AS T1   JOIN   ( SELECT   patients.subject_id, procedures.charttime   FROM     procedures   WHERE     procedures.label = 'diagnosis'   AND     procedures.age >= 50   AND     procedures.age < 60 ) AS T2   ON T1.subject_id = T2.subject_id   WHERE T1.charttime < T2.charttime   ORDER BY T1.charttime ASC   LIMIT 1 OFFSET 0 JOIN   cost_table AS T3   ON T1.subject_id = T3.subject_id",,False,0.0,0.0007760524749755859,0,no such table: diagnoses,,,
16b479cf35ef4b2c6a5488a1,What is the total amount of kcl (bolus) input that patient 10020187 got since 02/02/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-02'","SELECT SUM(inputamount) FROM labevents WHERE patientid = 10020187 AND labitems = 'kcl (bolus)' AND strftime('%Y-%m-%d',labevents.charttime) >= '2100-02-02'",[{'SUM(inputevents.totalamount)': None}],False,0.0,0.0009093284606933594,0,no such column: inputamount,,,
4b28b1a0b4ccc7c20dbda5bc,What are the top four most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]",True,0.4454028606414795,0.4458808898925781,4,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}, {'long_title': 'electrocardiogram'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 28, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 63, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 77, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 139, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
ef2b6d1260dfe06ef2737e79,What is the 3-month survival rate for patients diagnosed with history of falling?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'history of falling' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT patients.charttime, patients.age, patients.gender, patients.d_icd_procedures_icd_id, patients.d_icd_diagnoses_icd_id, patients.admittime, patients.dischtime, patients.age, patients.gender, patients.d_icd_procedures_icd_id, patients.d_icd_diagnoses_icd_id, patients.admittime, patients.dischtime, patients.age, patients.gender, patients.d_icd_procedures_icd_id, patients.d_icd_diagnoses_icd_id, patients.admittime, patients.dischtime, patients.age, patients.gender, patients.d_icd_procedures_icd_id, patients.d_icd_diagnoses_icd_id, patients.admittime, patients.dischtime, patients.age, patients.gender, patients.d_icd_procedures_icd_id, patients.d_icd_diagnoses_icd_id, patients.admittime, patients.dischtime, patients.age, patients.gender, patients.d_icd_procedures_icd_id, patients.d_icd_diagnoses_icd_id, patients.admittime, patients.dischtime, patients.age, patients.gender, patients.d_icd_procedures_icd_id, patients.d_icd_di",,False,0.0,0.0005142688751220703,0,incomplete input,,,
78e5fca5ff0661c021019cac,What medication was patient 10009049 prescribed two times since 05/2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 = 2","SELECT d.drug FROM   ( SELECT   u.stay_id, d.drug, DENSE_RANK() OVER ( PARTITION BY u.stay_id ORDER BY d.starttime ASC ) AS c1 FROM microbiomic.studies_icustays_as u JOIN microbiomic.studies_d_icdrgs_as d ON u.stay_id = d.stay_id WHERE u.age >= 0 AND u.age < 1 AND u.gender = 'M' AND u.charttime >= '2100-05-01' AND d.starttime >= '2100-05-01' AND d.drug = 'docusate sodium' ) AS e1 WHERE e1.c1 = 2 AND e1.stay_id IN ( SELECT   u.stay_id FROM microbiomic.studies_icustays_as u WHERE u.age >= 0 AND u.age < 1 AND u.gender = 'M' AND u.charttime >= '2100-05-01' AND u.subject_id = 10009049 )","[{'drug': '0.9% Sodium Chloride'}, {'drug': '0.9% Sodium Chloride (Mini Bag Plus)'}, {'drug': 'CeftriaXONE'}, {'drug': 'Influenza Virus Vaccine'}, {'drug': 'Levofloxacin'}]",False,0.0,0.0004887580871582031,0,incomplete input,,,
aacbdaf47632d34594693d85,What was the name of the drug patient 10037861 was given within the same day after receiving right heart cardiac catheterization since 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT d.drug FROM microbiome.d_icd_procedures AS c JOIN microbiome.d_icd_procedures AS b ON c.charttime < b.charttime WHERE c.icd_code = '12.97' AND b.icd_code = '12.97' AND c.charttime BETWEEN strftime('%Y-08-01') AND strftime('%Y-12-31') AND c.stay_id IN ( SELECT s.stay_id FROM microbiome.d_icd_procedures AS s WHERE s.icd_code = '12.97' AND s.charttime BETWEEN strftime('%Y-08-01') AND strftime('%Y-12-31') ) AND d.drug = b.drug AND c.stay_id IN ( SELECT s.stay_id FROM microbiome.d_icd_procedures AS s WHERE s.icd_code = '12.97' AND s.charttime BETWEEN strftime('%Y-08-01') AND strftime('%Y-12-31') ) AND d.stay_id = 10037861 WHERE datetime(c.charttime,'start of day') = datetime(b.charttime,'start of day')",,False,0.0,0.0005292892456054688,0,incomplete input,,,
78b96d788febbe223bbeb490,What are the five commonly ordered medications for patients aged 50s?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures JOIN admissions ON procedures.hospital_id = admissions.hospital_id WHERE procedures.label = 'medications' AND admissions.age BETWEEN 50 AND 59 ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.drug, procedures.charttime FROM procedures JOIN admissions ON procedures.hospital_id = admissions.hospital_id WHERE procedures.label = 'medications' AND admissions.age BETWEEN 50 AND 59 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,False,0.0,0.00049591064453125,0,"unrecognized token: ""'me""",,,
1cbdcc09109e4edff4bdc980,What are the top three most commonly prescribed medicines in this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT admissions.subject_id, prescriptions.drug FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND admissions.age BETWEEN 50 AND 60 AND admissions.gender = 'male' GROUP BY admissions.subject_id, prescriptions.drug ) AS t2 GROUP BY t2.icd_code ) AS t3 WHERE t3.c1 <= 3 )",[],False,0.0,0.0005357265472412109,0,"unrecognized token: ""'mal""",,,
4ee164f320c671cddad63aa1,How many people received a prescription for dextromethorphan-guaifenesin (sugar free) throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dextromethorphan-guaifenesin (sugar free)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT prescriptions.subject_id FROM prescriptions WHERE prescriptions.drug = 'dextromethorphan-guaifenesin (sugar free)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],True,0.5839216709136963,0.5844180583953857,1,,[{'COUNT( DISTINCT patients.subject_id )': 0}],['COUNT( DISTINCT patients.subject_id )'],"[{""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH patients USING COVERING INDEX sqlite_autoindex_patients_2 (subject_id=?)""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN prescriptions""}]"
2143a6938a83abd7a5830ec5,When was the first time patient 10006580 had a maximum of platelet count on the first hospital stay?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'platelet count' ) AND labevents.valuenum = ( SELECT MAX( labevents.valuenum ) FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) ORDER BY labevents.charttime ASC LIMIT 1,[],False,0.0,0.0004901885986328125,0,incomplete input,,,
c47c43f5d2824c6b2c4f54fe,List the top five most frequent procedures performed since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS t1 WHERE t1.c1 <= 5 )",,True,0.5419902801513672,0.5426201820373535,5,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}, {'long_title': 'electrocardiogram'}, {'long_title': 'enteral infusion of concentrated nutritional substances'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE t1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 24, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 59, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 73, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 135, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN t1""}]"
13cdf52f7ef4abd4ac2134e8,Retrieve the top three most frequently prescribed drugs throughout this year.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT d.drug FROM   ( SELECT   d.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM   microbiologyevents m   JOIN   d_icditems d ON m.spec_type_desc = d.itemid   WHERE   datetime(m.charttime,'start of year') = datetime(current_time,'start of year','-0 year')   GROUP BY   d.drug ) WHERE   C1 <= 3",[],False,0.0,0.0009388923645019531,0,no such table: d_icditems,,,
0b519b394a591392e5d6f8e3,"Today, when was the first time that patient 10018081 had the minimum SaO2?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1","SELECT d.charttime FROM d_icustays AS a JOIN d_labitems AS d ON a.subject_id = d.subject_id WHERE a.icustay_id IN ( SELECT MIN(b.icustay_id) FROM d_icustays AS b WHERE b.subject_id = 10018081 AND b.outtime IS NOT NULL ) AND d.itemid IN ( SELECT DISTINCT chartevents.itemid FROM chartevents WHERE chartevents.valuenum IS NOT NULL AND chartevents.charttime >= datetime(current_time,'start of day') AND chartevents.label = 'o2 saturation pulseoxymetry' ) ORDER BY d.valuenum ASC, d.charttime ASC LIMIT 1",[],False,0.0,0.000957489013671875,0,no such table: d_icustays,,,
224bb4d0211cbc31df5ac6e5,"Count the number of patients who had their closed reduction of fracture with internal fixation, femur performed.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed reduction of fracture with internal fixation, femur' ) )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'closed reduction of fracture with internal fixation, femur' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],False,0.0,0.0011365413665771484,0,no such table: procedures,,,
52132e5911d6dc1ae05dcf5a,When was the first continuous invasive mechanical ventilation for less than 96 consecutive hours done for patient 10027445 since 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime ASC LIMIT 1",SELECT hospital_admissions.admittime FROM hospital_admissions WHERE hospital_admissions.chartevents_icustay_id IN ( SELECT chartevents_icustay_id FROM chartevents WHERE chartevents.valuenum < 96 AND chartevents.charttime >= '2100-01-01' AND chartevents.itemid IN ( SELECT itemid FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation' ) ) AND hospital_admissions.subject_id = 10027445 ORDER BY hospital_admissions.admittime ASC LIMIT 1,,False,0.0,0.0008847713470458984,0,no such table: hospital_admissions,,,
864335edd9d15c7c2203cf7f,What was patient 10020740's age on the first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT DISTINCT patients.age FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 10020740 AND chartevents.charttype = 'hospital admission' ) ORDER BY chartevents.charttime ASC LIMIT 1,,False,0.0,0.0010509490966796875,0,no such column: patients.age,,,
230ffeaf99bdda6a8e74e380,What was the average mean blood pressure on 03/07/this year for patient 10014729?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '03-07'","SELECT AVG(d1.valuenum) FROM labevents d1 WHERE d1.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' AND admissions.pid = 10014729 ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%Y-%m-%d',chartevents.charttime) = strftime('%Y-%m-%d',current_time) - 0 day AND chartevents.itemid IN ( SELECT distinct chartevents.itemid FROM chartevents WHERE chartevents.valuenum IS NOT NULL AND chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 50 AND admissions.gender = 'male' AND admissions.pid = 10014729 ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%Y-%m-%d',chartevents.charttime) = strftime('%Y-%m-%d',current_time) - 0 day ) ) AND datetime(d1.charttime,'start of year') = datetime(current_time,'start of year','-0",[{'AVG(chartevents.valuenum)': None}],False,0.0,0.0006334781646728516,0,"near ""day"": syntax error",,,
290c69f642635c781b5c7611,"For patients who were given other endovascular procedures on other vessels in 2100, what are the top four most frequent procedures that followed within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) AND strftime('%Y',procedures.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.charttime FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,False,0.0,0.0005681514739990234,0,incomplete input,,,
da43f657cbfc7f62319205b6,How many current patients belong to the 40s age category?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age BETWEEN 40 AND 49 AND patients.dischtime IS NULL,,False,0.0,0.0009181499481201172,0,no such column: patients.age,,,
e19b3138fb3b80c47b5d5688,Has patient 10022041 been admitted to an emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room',SELECT COUNT(*)>0 FROM emergencyevents WHERE emergencyevents.chartkey IN ( SELECT admissions.chartkey FROM admissions WHERE admissions.subject_id = 10022041 ),[{'COUNT(*)>0': 0}],False,0.0,0.0007922649383544922,0,no such table: emergencyevents,,,
44b322551dc60863f32aa258,What was the last procedure patient 10019385 had since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1 )","SELECT procedures.charttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10019385 AND strftime('%Y',admissions.admittime) >= '2100' ) AND strftime('%Y',admissions.admittime) < '2100' ) ORDER BY procedures.charttime DESC LIMIT 1",,False,0.0,0.0012683868408203125,0,no such table: procedures,,,
7eab95f496de2df04e1d2b80,Could you show me the top four most common diagnoses?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT t1.icd_code FROM ( SELECT icd_diagnoses_icd_icd_procedures.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM icd_diagnoses_icd_icd_procedures GROUP BY icd_diagnoses_icd_icd_procedures.icd_code ) AS t1 WHERE t1.C1 <= 4 )","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Hyperlipidemia, unspecified'}, {'long_title': 'Essential (primary) hypertension'}]",False,0.0,0.0011377334594726562,0,no such table: icd_diagnoses_icd_icd_procedures,,,
7a4a371e40e613a250b099d0,How much total input did patient 10021487 receive on 12/19/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-19'","SELECT SUM(input) FROM labevents WHERE labevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10021487 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ) AND admissions.pid = 10021487 ) AND chartevents.charttime BETWEEN datetime(current_time,'start of year','-0 year') AND datetime(current_time) AND chartevents.valuenum IS NOT NULL ORDER BY chartevents.charttime ASC LIMIT 1 ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10021487 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ) AND admissions.pid = 10021487 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',labevents.charttime) = '12-19'",[{'SUM(inputevents.totalamount)': None}],False,0.0,0.0006589889526367188,0,incomplete input,,,
ed91e258dd31d6431b37bd91,What medicine was prescribed to patient 10039708 for the first time since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.subject_id = 10039708 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Senna'}],True,0.4726881980895996,0.4731631278991699,1,,[{'drug': 'sodium chloride 0.9%'}],['drug'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 21, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
7eeda0d4bfae5ffe07de0b9b,How many hours has it been since the first time patient 10018081 stayed in the careunit emergency department on the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers_intime FROM microbiologyevents WHERE transfers_intime is NOT NULL AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND transfers_intime >= patients.charttime AND patients.age = 10018081 AND",[],False,0.0,0.0007503032684326172,0,"near ""FROM"": syntax error",,,
785297f1fb8d773e4c4a07e2,Could you tell me the marital status of patient 10012853 on their first hospital visit?,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patients.marital_status FROM patients WHERE patients.chartitems.chart_id IN ( SELECT admissions.chart_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.chart_id = ( SELECT patients.chart_id FROM patients WHERE patients.age = 10012853 ) ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY admissions.admittime ASC LIMIT 1,[{'marital_status': 'WIDOWED'}],False,0.0,0.0011944770812988281,0,no such column: patients.marital_status,,,
3f83bca7c25ce27ab09a7ef0,What is the difference between weights on patient 10003046 last measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'weight' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.admittime >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'weight' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",False,0.0,0.0006732940673828125,0,"unrecognized token: ""'wei""",,,
d8eb075e768231338b08ef56,Has patient 10027445 had any results of his or her mrsa screen microbiology tests in 09/this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '09'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '09'",[{'COUNT(*)>0': 0}],False,0.0,0.0011289119720458984,0,no such column: patients.hadm_id,,,
666e67f82411b8a3b4b429e7,Has patient 10005909 been to the e.r. in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(*)>0 FROM emergencyevents WHERE patientid = 10005909 AND strftime('%Y',emergencyevents.admittime) = '2100'",[{'COUNT(*)>0': 0}],False,0.0,0.0010302066802978516,0,no such table: emergencyevents,,,
6336898e3861f505fd6e2a25,How many days have there been since patient 10039831's admission to the hospital?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', FROM hospital admissions WHERE hospital admissions.chart_id = 10039831 ORDER BY hospital admissions.admittime ASC LIMIT 1 ) )",[],False,0.0,0.0008108615875244141,0,"near ""FROM"": syntax error",,,
3de8ef9d5ffcc52173897ea8,What was the first recorded height for patient 10020740 during their first hospital encounter?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(firsthospitaldata.height) FROM firsthospitaldata WHERE firsthospitaldata.chartitemskey IN ( SELECT firsthospitaldata.chartitemskey FROM firsthospitaldata WHERE firsthospitaldata.chartitemskey IN ( SELECT chartevents.chartitemskey FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.gender = 'male' AND admissions.pid = 10020740 ) ) ) ),[],False,0.0,0.0010902881622314453,0,no such table: firsthospitaldata,,,
0a6429bfa48cdb76d66bf9a6,How many days has it been since patient 10021487's hospital admission?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.chartkey IN ( SELECT procedures.chartkey FROM procedures WHERE procedures.itemid IN ( SELECT definitions.linksto FROM definitions WHERE definitions.label = 'hospital admission' ) ) AND transfers.patientid = 10021487 ORDER BY transfers.intime DESC LIMIT 1",[],False,0.0,0.0009739398956298828,0,no such table: procedures,,,
15b35d75bfa2fee08c48a6c6,When was the first time since 114 days ago that patient 10011398 had the maximum respiratory rate for?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-114 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",SELECT d.charttime FROM microbiologyevents d WHERE d.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age >= 114 AND patients.gender = 'male' AND patients.subject_id = 10011398 ) AND d.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'respiratory rate' ) ORDER BY d.charttime ASC LIMIT 1 OFFSET 113,[],False,0.0,0.0011518001556396484,0,no such table: procedures,,,
ec24c1254363c0ed83ac0fa9,How much does the cost of a other and unspecified escherichia coli [e. coli] diagnosis cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified escherichia coli [e. coli]' ) ),e. coli,,False,0.0,0.0004658699035644531,0,"near ""e"": syntax error",,,
01f7d958c0c0cf070ca363b1,Can you list the methods for taking morphine sulfate ir?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate ir',SELECT DISTINCT procedures.drug FROM procedures WHERE procedures.spec_type = 'morphine sulfate ir',[],False,0.0,0.0016932487487792969,0,no such table: procedures,,,
6968bd319470944ced5ca337,What is the cost of a medication named ibuprofen?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ibuprofen' ),SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'ibuprofen',,False,0.0,0.0009248256683349609,0,no such table: procedures,,,
a0cc19360d682b011b5a7c9e,What is the total hospital cost for patient 10021118's stay since 2100?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y',cost.chargetime) >= '2100'","SELECT SUM(hospital_cost) FROM hospital_stays WHERE patient_id = 10021118 AND strftime('%Y',hospital_stays.admittime) >= '2100'",,False,0.0,0.0013697147369384766,0,no such table: hospital_stays,,,
6ac4cfa978f125a71ca0e9b0,How much phenazopyridine was last prescribed since 10/2100 to patient 10005909?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND prescriptions.drug = 'phenazopyridine' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.admission_type = 'emergency' AND admissions.charttime >= datetime(current_time,'-1 year') ) AND prescriptions.drug = 'phenazopyridine' AND prescriptions.hadm_id = 10005909 AND strftime('%Y-%m-%d',prescriptions.starttime) >= datetime(current_time,'-1 year','start of year') AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1",[],False,0.0,0.0009028911590576172,0,incomplete input,,,
1d433e5813c63b26ef517551,What was the last glucose lab test result for patient 10022880 in 03/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 100 AND admissions.gender = 'male' AND admissions.charttime >= '2100-03-01' AND admissions.charttime < '2101-03-01' AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'glucose' ) AND labevents.hadm_id = admissions.hadm_id AND labevents.charttime >= '2100-03-01' AND labevents.charttime < '2101-03-01' ORDER BY labevents.charttime DESC LIMIT 1,[],False,0.0,0.0005512237548828125,0,"unrecognized token: ""'""",,,
54b62111b52beeb031b293c2,What new medicines were prescribed to patient 10018081 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT d1.drug FROM   (   SELECT   pres.drug   FROM   prescription pres   WHERE   pres.hadm_id IN   (   SELECT   careplan.hadm_id   FROM   careplan   WHERE   careplan.age = (   SELECT   MIMIC.covid_icu.age   FROM   MIMIC.covid_icu   WHERE   MIMIC.covid_icu.id = 10018081   )   )   AND   datetime(pres.starttime,'start of day') = datetime(current_time,'start of day','-1 day')   ) AS d1   EXCEPT   SELECT   pres.drug   FROM   prescription pres   WHERE   pres.hadm_id IN   (   SELECT   careplan.hadm_id   FROM   careplan   WHERE   careplan.age = (   SELECT   MIMIC.covid_icu.age   FROM   MIMIC.covid_icu   WHERE   MIMIC.covid_icu.id = 10018081   )   )   AND   datetime(pres.starttime,'start of day') = datetime(current_time,'start of day')",[],False,0.0,0.0012845993041992188,0,incomplete input,,,
e208ae3d19686c1132fb4168,How many patients died during the same hospital encounter after having been diagnosed in 2100 with varices of other sites?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'varices of other sites' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND strftime('%Y',T1.charttime) = '2100' ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND strftime('%Y',patients.dod) = '2100' ) as T3 ON T2.subject_id = T3.subject_id WHERE T2.hadm_id = T3.hadm_id","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 0 AND admissions.admission_type_desc = 'emergency room' AND admissions.charttime >= '2100-01-01' EXCEPT SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 0 AND admissions.admission_type_desc = 'emergency room' AND admissions.charttime >= '2100-01-01' WHERE admissions.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age >= 0 AND admissions.admission_type_desc = 'emergency room' AND admissions.charttime >= '2100-01-01' AND admissions.admission_id IN ( SELECT procedures.charttime, procedures.subject_id FROM procedures WHERE procedures.label = 'varices of other sites' AND procedures.charttime >= '2100-01-01' ) )",,False,0.0,0.0009500980377197266,0,"near ""WHERE"": syntax error",,,
bd928ffb40c6b3f69d82f2da,What was the last height record for patient 10019777 since 01/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT hospitalevents.charttime FROM hospitalevents WHERE hospitalevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 0 AND admissions.gender = 'male' AND admissions.spec_type IS NOT NULL AND admissions.spec_type = 'autopsy' ) AND hospitalevents.itemid IN ( SELECT definitions.itemid FROM definitions WHERE definitions.label = 'height' AND definitions.linksto = 'hospitalevents' ) AND hospitalevents.valuenum IS NOT NULL AND hospitalevents.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 0 AND admissions.gender = 'male' AND admissions.spec_type IS NOT NULL AND admissions.spec_type = 'autopsy' AND admissions.pid = 10019777 ) AND strftime('%Y-%m',hospitalevents.charttime) >= '2100-01' ORDER BY hospitalevents.charttime DESC LIMIT 1",[],False,0.0,0.0013518333435058594,0,incomplete input,,,
df207c83b6a4bbaeca1edcf9,What were the top five most common diagnoses that followed within the same month to patients who had received extracorporeal circulation auxiliary to open heart surgery in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.label = 'extracorporeal circulation auxiliary to open heart surgery' AND procedures.spec_type_desc = '2100' AND procedures.spec_type = '2100' GROUP BY admissions.subject_id ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.charttime FROM procedures WHERE procedures.spec_type_desc = '2100' AND procedures.spec_type = '2100' GROUP BY admissions.subject_id, procedures.icd_code ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime,'start of month') = datetime(T1.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,False,0.0,0.000545501708984375,0,incomplete input,,,
ebd6cc5909117f9e521d66c9,What was the first time patient 10018423 had their maximum respiratory rate during their last ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",SELECT MIN( d1.charttime ) FROM microbiologyevents d1 WHERE d1.hadm_id IN ( SELECT d2.hadm_id FROM patients d2 WHERE d2.age >= 0 AND d2.gender = 'male' AND d2.subject_id = 10018423 ) AND d1.valuenum = ( SELECT MAX( d3.valuenum ) FROM microbiologyevents d3 WHERE d3.hadm_id IN ( SELECT d4.hadm_id FROM patients d4 WHERE d4.age >= 0 AND d4.gender = 'male' AND d4.subject_id = 10018423 ) ) AND d1.spec_type_desc = 'respiratory rate' AND d1.linksto = 'last hospital admission',[],False,0.0,0.0010132789611816406,0,no such column: d2.hadm_id,,,
21fd9dd9363c6aebcc42bdb9,What was the last output that patient 10021487 has had on 12/10/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-10' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT d.output FROM labevents d WHERE d.patient_id = 10021487 AND datetime(d.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',d.charttime) = '12-10' ORDER BY d.charttime DESC LIMIT 1",[],False,0.0,0.0014786720275878906,0,no such column: d.output,,,
14d8196b90cb8b401ebd3a91,How long has it been in hours since the first time calcium carbonate was prescribed to patient 10021487 during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'calcium carbonate' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers_icustays.charttime) ) FROM transfers_icustays WHERE transfers_icustays.charttime IN ( SELECT prescriptions.charttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT icustays.hadm_id FROM icustays WHERE icustays.age = ( SELECT MIN(icustays.age) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT calculations FROM ( SELECT age(admissions.admittime,'current time') AS calculations FROM admissions WHERE admissions.pid = 10021487 ) ) ) ) ) AND prescriptions.drug = 'calcium carbonate' ) ORDER BY transfers_icustays.charttime ASC LIMIT 1",[],False,0.0,0.001977205276489258,0,"unrecognized token: ""'current """,,,
fae84ce9cc96b0e677f844f8,"Since 128 days ago, what was the maximum body temperature for patient 10021118?","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-128 day')","SELECT MAX(d_icd_procedures.charttime - datetime(current_time,'-128 day')) FROM d_icd_procedures WHERE d_icd_procedures.charttime >= datetime(current_time,'-128 day') AND d_icd_procedures.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'temperature' ) AND d_icd_procedures.charttime IN ( SELECT d_icustays.charttime FROM d_icustays WHERE d_icustays.age >= 50 AND d_icustays.hospitaldischtime IS NOT NULL ) AND d_icd_procedures.subject_id = 10021118",[{'MAX(chartevents.valuenum)': None}],False,0.0,0.0010833740234375,0,no such table: d_icustays,,,
49a4cd3cf6fcacac9a3bf922,When was the last time patient 10025612 was measured with a greater diastolic blood pressure than 59.0 since 02/02/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 59.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-02-02' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT patients.age FROM patients WHERE patients.row_id = labevents.hadm_id ) AND admissions.gender = ( SELECT patients.gender FROM patients WHERE patients.row_id = labevents.hadm_id ) ) AND labevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.name = 'arterial blood pressure diastolic' ) AND labevents.valuenum > 59.0 AND labevents.hadm_id = 10025612 AND strftime('%Y-%m-%d',labevents.charttime) >= '2100-02-02' ORDER BY labevents.charttime DESC LIMIT 1",[],False,0.0,0.0016126632690429688,0,no such table: definition,,,
64d6d6763577abb3e33ea4f0,Tell me the minimum total hospital cost for patient visits that include malignant neoplasm of intrahepatic bile ducts?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of intrahepatic bile ducts' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.chartkey IN ( SELECT admissions.chartkey FROM admissions WHERE admissions.age >= 20 ) AND procedures.label = 'malignant neoplasm of intrahepatic bile ducts' GROUP BY procedures.chartkey ) AS T1,,False,0.0,0.0009615421295166016,0,no such table: procedures,,,
88c772d92cd993b8ce3eb5a9,What was the name of the medication that patient 10004235 was prescribed two or more times?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T1.drug FROM ( SELECT procedure_icd.drug, COUNT(*) AS C1 FROM procedure_icd WHERE procedure_icd.charttime >= ( SELECT admissions.outtime FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.admissionlocation = 'emergency room' ORDER BY admissions.intime ASC LIMIT 1 ) AND procedure_icd.charttime < ( SELECT admissions.outtime FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.admissionlocation = 'hospital' ORDER BY admissions.intime ASC LIMIT 1 ) GROUP BY procedure_icd.drug ) AS T1 WHERE T1.C1 >= 2","[{'drug': '0.9% Sodium Chloride'}, {'drug': '0.9% Sodium Chloride (Mini Bag Plus)'}, {'drug': '5% Dextrose'}, {'drug': '5% Dextrose (EXCEL BAG)'}, {'drug': 'Acetaminophen IV'}, {'drug': 'Amiodarone'}, {'drug': 'Bag'}, {'drug': 'Bisacodyl'}, {'drug': 'Calcium Gluconate'}, {'drug': 'CefePIME'}, {'drug': 'Ciprofloxacin IV'}, {'drug': 'Diltiazem'}, {'drug': 'Docusate Sodium'}, {'drug': 'Famotidine'}, {'drug': 'Fentanyl Citrate'}, {'drug': 'Heparin'}, {'drug': 'Heparin Flush (10 units/ml)'}, {'drug': 'Hydrocortisone Na Succ.'}, {'drug': 'Insulin'}, {'drug': 'Iso-Osmotic Dextrose'}, {'drug': 'Iso-Osmotic Sodium Chloride'}, {'drug': 'Lactated Ringers'}, {'drug': 'Lidocaine 1% (For PICC/Midline Insertions)'}, {'drug': 'Magnesium Sulfate'}, {'drug': 'MetRONIDAZOLE (FLagyl)'}, {'drug': 'Metoprolol Succinate XL'}, {'drug': 'Metoprolol Tartrate'}, {'drug': 'Midazolam'}, {'drug': 'NORepinephrine'}, {'drug': 'OxycoDONE (Immediate Release) '}, {'drug': 'PHENYLEPHrine'}, {'drug': 'Pantoprazole'}, {'drug': 'Piperacillin-Tazobactam'}, {'drug': 'Potassium Chloride'}, {'drug': 'Prismasate (B22 K4)'}, {'drug': 'Prismasate (B32 K2)'}, {'drug': 'SW'}, {'drug': 'Sodium Bicarbonate'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Soln'}, {'drug': 'Sterile Water'}, {'drug': 'Vancomycin'}, {'drug': 'Vancomycin Oral Liquid'}, {'drug': 'Verapamil'}, {'drug': 'Warfarin'}]",False,0.0,0.0013060569763183594,0,incomplete input,,,
6375d8b399f74f248505155f,Count the number of times patient 10021487 in the current hospital encounter underwent the thoracentesis procedure.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracentesis' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ),SELECT COUNT(*) FROM procedureevents WHERE procedureevents.aga = 'thoracentesis' AND procedureevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 AND admissions.dischtime IS NULL ),[{'COUNT(*)': 0}],False,0.0,0.0008969306945800781,0,no such table: procedureevents,,,
174eb164f7575dec3a790c67,"In 2100, what are the four frequently ordered medications for patients in their 40s?","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 41 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 41 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.charttime,'start of year') = datetime(2100,'start of year') AND datetime(T2.starttime,'start of year') = datetime(2100,'start of year') AND datetime(T1.charttime) < datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,False,0.0,0.0007283687591552734,0,incomplete input,,,
af561948138efd557fdd722d,Give a list of the four most frequent medications that patients were prescribed during the same hospital encounter after being diagnosed with personal history of colonic polyps since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of colonic polyps' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of colonic polyps' ) AND strftime('%Y',diagnoses.chart_time) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, admissions.hadm_id, DENSE_RANK() OVER ( PARTITION BY admissions.subject_id ORDER BY admissions.admittime ) AS C2 FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.ic",,False,0.0,0.0010352134704589844,0,"near ""AN"": syntax error",,,
17cef57ccf7e9bd3a4e8882c,What label corresponds to motor current (ma) low (r)?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'motor current (ma) low (r)',SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'motor current (ma) low (r)',[],False,0.0,0.0008823871612548828,0,no such column: d_icd_procedures.short_title,,,
06b6dc7feba30e1bda1c5617,Could you retrieve patient 10005909's monthly average weight since 09/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-09' GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT AVG(d_icd_procedures.charttime - strftime('%J',patients.d_icd_procedures.charttime)) / 86400 FROM d_icd_procedures WHERE patients.gender = 'male' AND patients.age BETWEEN 50 AND 60 AND patients.d_icd_procedures.charttime >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',patients.d_icd_procedures.charttime) HAVING patients.d_icd_procedures.key = ( SELECT patients.key FROM patients WHERE patients.age BETWEEN 50 AND 60 AND patients.gender = 'male' AND patients.d_icd_procedures.charttime >= datetime(current_time,'-1 year') ORDER BY patients.d_icd_procedures.charttime ASC LIMIT 1 )",[],False,0.0,0.0008568763732910156,0,incomplete input,,,
fbbb58618f0b12172d3a2c3f,How much is the difference of weights of patient 10004720 last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'daily weight' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 0 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND labevents.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'daily weight' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET -2 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",False,0.0,0.0005917549133300781,0,incomplete input,,,
dc96f1034667710951f67126,Count the number of patients diagnosed with acute pyelonephritis in the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute pyelonephritis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'acute pyelonephritis' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,False,0.0,0.0014469623565673828,0,no such table: procedures,,,
5436413908d5e902536630e8,What was the name of the specimen test that patient 10018845 was given for the last time in 10/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT procedures.drug FROM procedures WHERE procedures.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.charttime >= datetime(current_time,'-10 year') AND transfers.hadm_id IN ( SELECT d_icd_procedures_icd_icd_products_key.hadm_id FROM d_icd_procedures_icd_icd_products_key WHERE d_icd_procedures_icd_icd_products_key.icd_code = procedures.icd_code ) ) ORDER BY transfers.charttime DESC LIMIT 1 ) ORDER BY procedures.charttime DESC LIMIT 1",[],False,0.0,0.0009510517120361328,0,no such table: procedures,,,
9c072625e88dff652ffe5371,Count the number of times that patient 10038933 took dextrose 5% on 09/26/2100.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-09-26'","SELECT COUNT(*) FROM microbiologyevents WHERE patient_id = 10038933 AND organism_name = 'dextrose 5%' AND strftime('%Y-%m-%d',microbiologyevents.charttime) = '2100-09-26'",[{'COUNT(*)': 0}],False,0.0,0.0014646053314208984,0,no such column: patient_id,,,
554ae2ae8045e12bdcbd48e1,What age was patient 10020740 on the first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT DISTINCT patients.age FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 1 AND chartevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.label = 'hospital admission' ) ) AND patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 1 AND chartevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.label = 'hospital admission' ) ) AND patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 1 AND chartevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.label = 'hospital admission' ) ) AND patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 1 AND chartevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.label = 'hospital admission' ) ) AND patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 1 AND chartevents.itemid IN ( SELECT definition.row_id FROM definition WHERE definition.label = 'hospital admission' ) ) AND patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents,,False,0.0,0.0010199546813964844,0,incomplete input,,,
c8c043eb89e83c83b6beeeb3,Can you calculate the duration in days of patient 10031757's first stay in the intensive care unit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT DISTINCT T1.C1 FROM ( SELECT T2.charttime, T2.valuenum, DATEDIFF(day,T1.admittime) AS C1 FROM ( SELECT admissions.subject_id, admissions.admittime FROM admissions WHERE admissions.subject_id = 10031757 ) AS T1 JOIN ( SELECT labevents.subject_id, labevents.charttime, labevents.valuenum FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.label = 'intensive care unit' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE DATEDIFF(day,T1.admittime,T2.charttime) >= 0 ORDER BY T1.admittime, T2.charttime ASC ) AS T3 WHERE T3.valuenum IS NOT NULL ORDER BY T3.C1 ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.7664004629477859}]",False,0.0,0.0008852481842041016,0,incomplete input,,,
a6fe0c3e866e450e5a3bcaf0,Can you find the five most frequently ordered laboratory test this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_labitems.itemname FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 ) ORDER BY d_labitems.itemname ASC LIMIT 1",[],False,0.0,0.001561880111694336,0,no such column: d_labitems.itemname,,,
c1ffcaa8f6eaee005e37aa5d,When did patient 10005909 last undergo a microbiology test on the last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT patients.age FROM patients WHERE patients.row_id = 10005909 ) AND admissions.admission_location = 'emergency room' ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'charttime': '2144-11-01 02:09:00'}],False,0.0,0.0012385845184326172,0,no such column: patients.age,,,
007c6a12f2a1a55bd3b09e1e,How many open and other replacement of aortic valve procedures have occurred since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open and other replacement of aortic valve' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.long_title = 'open and other replacement of aortic valve' AND strftime('%Y',procedures_icd.charttime) >= '2100'",,False,0.0,0.0018620491027832031,0,no such column: procedures_icd.long_title,,,
a16e5eeb260d3b031762211d,Tell me the name of the drug that patient 10021487 was first prescribed through the im route.,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT transfers.intime FROM transfers WHERE transfers.age = ( SELECT transfers.age FROM transfers WHERE transfers.hadm_id IN ( SELECT events.hadm_id FROM events WHERE events.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.valuenum = 10021487 AND chartitems.chart = 'events' ) ) ORDER BY transfers.intime ASC LIMIT 1 ) ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1,[],False,0.0,0.0012943744659423828,0,no such table: events,,,
c387a4c3a7bc1f1536ae7916,Is patient 10031404 male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10031404,SELECT patients.gender FROM patients WHERE patients.chartevents_id IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.itemid IN ( SELECT definition.linksto FROM definition WHERE definition.linksto = 8507 ) AND chartevents.valuenum = 1 AND chartevents.charttime IN ( SELECT transfers.charttime FROM transfers WHERE transfers.careunit = 'med/surg' AND transfers.admittime IN ( SELECT admissions.charttime FROM admissions WHERE admissions.hadm_id IN ( SELECT d_icd_procedures_icd_icd_items_r_icd_icd_procedures_r FROM d_icd_procedures_icd_icd_items_r_icd_icd_procedures_r WHERE d_icd_procedures_icd_icd_items_r_icd_icd_procedures_r.c1 = 10031404 ) ) ) ),[{'gender': 'F'}],False,0.0,0.0013229846954345703,0,incomplete input,,,
4bff1dd96412ee933ce201a2,Find the length in days of the last ICU stay for patient 10006053.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT DISTINCT T1.C1 FROM ( SELECT T2.charttime, T2.valuenum, DATEDIFF(day,T1.admittime,T2.charttime) AS C1 FROM ( SELECT admissions.subject_id, admissions.admittime FROM admissions WHERE admissions.subject_id = 10006053 ) AS T1 JOIN labevents AS T2 ON T1.subject_id = T2.subject_id WHERE T1.admittime < T2.charttime AND T2.itemid IN ( 2100 ) ORDER BY T1.admittime ASC, T2.charttime ASC ) AS T WHERE T.C1 >= 0 ORDER BY T.C1 DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.7513657407835126}]",False,0.0,0.0012347698211669922,0,no such column: day,,,
9637bc783f8bbca836af73b7,When did patient 10021487 receive his last input since 12/06/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-06' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT d1.starttime FROM labevents d1 WHERE d1.itemid IN ( SELECT DISTINCT procedures.itemid FROM procedures WHERE procedures.chartkey IN ( SELECT patients.chartkey FROM patients WHERE patients.age >= 50 AND patients.gender = 'male' AND patients.d_icd_procedures = '13.12' ) ) AND strftime('%Y-%m-%d',d1.starttime) >= '2100-12-06' ORDER BY d1.valuenum ASC, d1.starttime DESC LIMIT 1",[{'starttime': '2117-03-09 14:20:00'}],False,0.0,0.0017819404602050781,0,no such table: procedures,,,
68d14f27e5ba3606ce989f0b,What is the cost of a medication known as guaifenesin?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' ),SELECT DISTINCT procedures.cost FROM procedures WHERE procedures.label = 'guaifenesin',,False,0.0,0.001214742660522461,0,no such table: procedures,,,
d1cbc79c8f893b6d1d18523b,What is the minimum total cost of the hospital visits which involve dysthymic disorder since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysthymic disorder' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.icd_diagnosis = 'dysthymic disorder' AND strftime('%Y',procedures.charttime) >= '2100' GROUP BY procedures.charttime, procedures.admittime ) AS T1",,False,0.0,0.00173187255859375,0,no such table: procedures,,,
6aa28b1f973eb8725565aabc,Can you list the methods for taking methadone?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'methadone',SELECT DISTINCT procedures.drug FROM procedures WHERE procedures.drug = 'methadone',"[{'route': 'ORAL'}, {'route': 'PO/NG'}, {'route': 'PO'}, {'route': 'SL'}]",False,0.0,0.0011382102966308594,0,no such table: procedures,,,
4ff852f95fae6d06622555a4,What would be the daily maximum weight of patient 10024043 in their last hospital encounter?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MAX(d_icd_procedures.charttime - admissions.admittime) AS T1 FROM d_icd_procedures JOIN admissions ON d_icd_procedures.hadm_id = admissions.hadm_id WHERE d_icd_procedures.charttime >= admissions.admittime AND admissions.age = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY T1 DESC LIMIT 1,[],False,0.0,0.00162506103515625,0,no such column: d_icd_procedures.charttime,,,
6342a44540e55f3dc3b44fc5,How many patients died after having been diagnosed with facial weakness during the same hospital encounter throughout this year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'facial weakness' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-0 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE T2.hadm_id = T3.hadm_id","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND admissions.age >= 18 AND admissions.age < 89 AND admissions.insurance = 'medicare' EXCEPT SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND admissions.age >= 18 AND admissions.age < 89 AND admissions.insurance = 'medicare' AND admissions.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND admissions.age >= 18 AND admissions.age < 89 AND admissions.insurance = 'medicare' AND admissions.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.label = 'facial weakness' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) )",,False,0.0,0.0007348060607910156,0,incomplete input,,,
88823049d5169eac0fe75ddc,What is the daily average dose of d5 1/2ns that patient 10039831 took since 12/16/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-16' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)","SELECT AVG(T1.dose_val_rx) FROM ( SELECT SUM(d5 1/2ns.dose_val_rx) AS T1_sum FROM labevents WHERE labevents.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.spec_type_desc = 'd5 1/2ns' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.row_id_1 FROM transfers WHERE transfers.row_id_2 IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 10039831 AND chartevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'age' ) ) ) ) ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%Y-%m-%d',labevents.charttime) >= '2100-12-16' GROUP BY labevents.hadm_id , strftime('%Y-%m-%d',labevents.charttime) ) AS T1 JOIN ( SELECT SUM(d5 1/2ns.dose_val_rx) AS T2_sum FROM labevents WHERE labevents.itemid IN ( SELECT procedures",[],False,0.0,0.0009217262268066406,0,"near ""1"": syntax error",,,
301ae55bf7f25fd564f985aa,"Give me the top five most commonly prescribed medications within 2 months to the patients aged 40s after they were diagnosed with constipation, unspecified.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT t3.icd_code FROM ( SELECT t2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) ) AS t2 GROUP BY t2.icd_code ) AS t3 WHERE t3.c1 <= 5 )",,False,0.0,0.0006983280181884766,0,incomplete input,,,
3c2644bcbfce5414f79d1016,What's the minimum total cost of the hospital visits that had iso-osmotic sodium chloride in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic sodium chloride' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(procedures.cost) AS C1 FROM procedures WHERE procedures.drug = 'iso-osmotic sodium chloride' AND strftime('%Y',procedures.charttime) = '2100' GROUP BY procedures.admittime ) AS T1",,False,0.0,0.0013353824615478516,0,no such table: procedures,,,
f2d9ed56cde7d9f6f4b4bfe7,What is the number of patients who were diagnosed with facial weakness since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'facial weakness' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT procedures.subject_id FROM procedures WHERE procedures.drug = 'facial weakness' AND strftime('%Y',procedures.starttime) >= '2100' )",,False,0.0,0.0012249946594238281,0,no such table: procedures,,,
20652261cb0352fb90678734,What is the yearly average dose of po intake that patient 10001725 took since 04/03/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-03' GROUP BY strftime('%Y',inputevents.starttime)","SELECT AVG(T1.DAILY_TOTAL) FROM ( SELECT SUM( DRUGS.DOSAGE_VAL_RX ) AS DAILY_TOTAL FROM DRUGS WHERE DRUGS.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.row_id = ( SELECT transfers.row_id_1 FROM transfers WHERE transfers.row_id_2 IN ( SELECT chartevents.row_id FROM chartevents WHERE chartevents.valuenum = 10001725 AND chartevents.charttype = 'daily events' ) ) ) AND admissions.age IS NOT NULL ) AND DRUGS.drug = 'po' AND datetime(DRUGS.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY DRUGS.hadm_id, strftime('%Y-%m-%d',DRUGS.starttime) ) AS T1",[],False,0.0,0.0011801719665527344,0,incomplete input,,,
4a82faf774a9f3614964283f,What were the names of the output that patient 10004720 had last since 12/05/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-05' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT d.output_name FROM labevents d WHERE d.patient_id = 10004720 AND strftime('%Y-%m-%d',d.charttime) >= '2100-12-05' ORDER BY d.charttime DESC LIMIT 1",[{'label': 'Foley'}],False,0.0,0.0011107921600341797,0,no such column: d.output_name,,,
11c8c8af342244bb88c103ec,How much is patient 10020786 needed to pay for the cost of their hospital visit?,SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ),SELECT SUM( labevents.charttime - admissions.admittime ) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT DISTINCT admissions.age FROM admissions WHERE admissions.pid = 10020786 ) AND admissions.admission_location = 'emergency room' ) ORDER BY labevents.charttime ASC LIMIT 1,,False,0.0,0.0016350746154785156,0,no such column: admissions.admittime,,,
6daa9b7fb20a9577136bb303,What are the new medications prescribed to patient 10039831 today in comparison to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT d1.drug FROM   (   SELECT   prescriptions.drug   FROM   prescriptions   WHERE   prescriptions.hadm_id IN   (   SELECT   admissions.hadm_id   FROM   admissions   WHERE   admissions.age = ( SELECT   admissions.age   FROM   admissions   WHERE   admissions.pid = 10039831 ) AND admissions.gender = 'male'   )   AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day')   AND prescriptions.hadm_id = 10039831   ) AS d1   WHERE   d1.drug NOT IN   (   SELECT   prescriptions.drug   FROM   prescriptions   WHERE   prescriptions.hadm_id IN   (   SELECT   admissions.hadm_id   FROM   admissions   WHERE   admissions.age = ( SELECT   admissions.age   FROM   admissions   WHERE   admissions.pid = 10039831 ) AND admissions.gender = 'male'   )   AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')   AND prescriptions.hadm_id = 10039831   )",[],False,0.0,0.0007367134094238281,0,incomplete input,,,
70af8cdd705ae41288815362,What are some of the three common specimens sampled since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT T1.spec_type_desc FROM ( SELECT specimens.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM specimens WHERE strftime('%Y',specimens.charttime) >= '2100' GROUP BY specimens.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]",False,0.0,0.0014150142669677734,0,no such table: specimens,,,
c2a42482b7f7bf97e37b7a73,Has patient 10018328 visited the hospital for admission since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018328 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 1 AND admissions.gender = 'male' AND admissions.admission_type = 'admission' AND admissions.charttime >= datetime(current_time,'-1 year') AND admissions.subject_id = 10018328 )",[{'COUNT(*)>0': 1}],False,0.0,0.0009438991546630859,0,no such column: admissions.gender,,,
532b30aa4c94b277b88eba32,How many prescriptions were ordered for cyanocobalamin in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],True,0.667424201965332,0.6681439876556396,1,,[{'COUNT(*)': 6801}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}]"
e5cc41e0f6f46286a68677c5,How many people were discharged since 2100 from the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],True,0.20125365257263184,0.20174026489257812,1,,[{'COUNT( DISTINCT admissions.subject_id )': 172553}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
47dc2df1f6767f65907affb2,What are the top five most common output events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]",True,0.3318972587585449,0.33240175247192383,5,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}, {'long_title': 'electrocardiogram'}, {'long_title': 'enteral infusion of concentrated nutritional substances'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 21, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 56, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 70, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 132, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
6b781aa16f1cdc56b618c7cd,Call a research institute for information on a rare diagnosis.,,SELECT DISTINCT t1.spec_type_desc FROM microbiologyevents t1 WHERE t1.spec_type_desc IS NOT NULL AND t1.spec_type_desc IN ( SELECT t2.spec_type_desc FROM microbiologyevents t2 WHERE t2.spec_type_desc IS NOT NULL GROUP BY t2.spec_type_desc HAVING COUNT(*) < 3 ),,True,0.721428632736206,0.7226078510284424,5,,"[{'spec_type_desc': 'rectal - r/o gc'}, {'spec_type_desc': 'post-mortem viral culture'}, {'spec_type_desc': 'swab, r/o gc'}, {'spec_type_desc': 'peripheral blood lymphocytes'}, {'spec_type_desc': 'urine,prostatic massage'}]",['spec_type_desc'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN t1""}, {""id"": 10, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 16, ""parent"": 10, ""notused"": 0, ""detail"": ""SCAN t2""}, {""id"": 20, ""parent"": 10, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 67, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR DISTINCT""}]"
d4de34dfac56b48ccafd9eb4,Can you tell me the top three most common procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT t1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS c1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS t1 WHERE t1.c1 <= 3 )",,True,0.523322343826294,0.5240914821624756,3,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE t1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 24, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 59, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 73, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 135, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN t1""}]"
69356637e317ad0c9ca83dce,How many prescriptions were ordered for acetylcysteine (iv) in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine (iv)' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine (iv)' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],True,0.7576467990875244,0.7583544254302979,1,,[{'COUNT(*)': 1452}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}]"
915a29cc5d0d25f775a9230e,How many duloxetine prescription cases were there since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'duloxetine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'duloxetine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)': 1}],True,0.7090334892272949,0.7094979286193848,1,,[{'COUNT(*)': 4569}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}]"
d204e30ef557cf80cbde97fe,List the top five most frequent procedures performed during this year.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,True,0.13871383666992188,0.13924670219421387,0,,,,"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 29, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 64, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 78, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 140, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
14a8c9364f4f7aced0b46787,How many lactated ringers prescriptions were given out since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lactated ringers' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lactated ringers' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 0}],True,0.7742435932159424,0.774979829788208,1,,[{'COUNT(*)': 86623}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}]"
e6fc873eaca2527956432aa0,How many people were admitted to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],True,0.17924737930297852,0.1799452304840088,1,,[{'COUNT( DISTINCT admissions.subject_id )': 174611}],['COUNT( DISTINCT admissions.subject_id )'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR count(DISTINCT)""}, {""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN admissions""}]"
b33541a90c84005891412b3c,What is the count of prescriptions for guaifenesin since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 2}],True,0.7239060401916504,0.7243635654449463,1,,[{'COUNT(*)': 1007}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}]"
2430afd64917976291b6054a,Tell me the top four of the most common output events since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]",True,0.3606572151184082,0.3631107807159424,4,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}, {'long_title': 'electrocardiogram'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 28, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 63, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 77, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 139, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
679e9fb3a5f25dcf1ce8aa3c,Could you show me the top four most frequent outputs?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]",True,0.212785005569458,0.2132413387298584,4,,"[{'long_title': 'venous catheterization, not elsewhere classified'}, {'long_title': 'coronary arteriography using two catheters'}, {'long_title': 'other nonoperative respiratory measurements'}, {'long_title': 'electrocardiogram'}]",['long_title'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH d_icd_procedures USING INDEX sqlite_autoindex_d_icd_procedures_2 (icd_code=?)""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN procedures_icd""}, {""id"": 21, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 56, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 70, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 132, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
264e8e9083e7fe02916af314,What was the name of the medication that patient 10025612 was prescribed for the last time in 10/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.subject_id = 10025612 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1",[],True,0.47562360763549805,0.47606325149536133,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 29, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
64be714443bafc724b5d0d44,What are the ways to take emtricitabine-tenofovir (truvada)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'emtricitabine-tenofovir (truvada)',SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'emtricitabine-tenofovir (truvada)',[],True,0.6199419498443604,0.6204192638397217,4,,"[{'route': 'po'}, {'route': 'po/ng'}, {'route': 'ng'}, {'route': 'oral'}]",['route'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 13, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR DISTINCT""}]"
73710b96b938a24a7a5c86d5,Tell me the medication that patient 10014729 was prescribed for the first time?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ORDER BY prescriptions.starttime ASC LIMIT 1,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.subject_id = 10014729 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Milk of Magnesia'}],True,0.4010131359100342,0.4017343521118164,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 26, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
a2de199eb11275f923c798c8,Can you tell me the first medicine that was prescribed to patient 10007795?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) ORDER BY prescriptions.starttime ASC LIMIT 1,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.subject_id = 10007795 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Nicotine Patch'}],True,0.3541100025177002,0.35469889640808105,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 26, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
753a40539d0be72d6bec0d1c,"Since 2100, what were the five most frequently requested specimen tests?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT T.spec_type_desc FROM microbiologyevents T WHERE T.spec_type_desc IS NOT NULL AND strftime('%Y',T.charttime) >= '2100' GROUP BY T.spec_type_desc ORDER BY COUNT(*) DESC LIMIT 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]",True,0.6762340068817139,0.6767432689666748,5,,"[{'spec_type_desc': 'blood culture'}, {'spec_type_desc': 'urine'}, {'spec_type_desc': 'sputum'}, {'spec_type_desc': 'stool'}, {'spec_type_desc': 'swab'}]",['spec_type_desc'],"[{""id"": 8, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T""}, {""id"": 15, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 55, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
684346bf3b100ce2706bc5b6,How many patients received senna prescription since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'senna' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.subject_id IN ( SELECT prescriptions.subject_id FROM prescriptions WHERE prescriptions.drug = 'senna' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 29}],True,0.4980449676513672,0.49851322174072266,1,,[{'COUNT( DISTINCT patients.subject_id )': 37838}],['COUNT( DISTINCT patients.subject_id )'],"[{""id"": 5, ""parent"": 0, ""notused"": 0, ""detail"": ""SEARCH patients USING COVERING INDEX sqlite_autoindex_patients_2 (subject_id=?)""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN prescriptions""}]"
fb17ccd962fb6994c5822d11,How many tamoxifen citrate prescriptions were ordered in this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)': 0}],True,0.4391903877258301,0.439774751663208,1,,[{'COUNT(*)': 0}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}]"
d1d8f2df3141cf92ddc53228,How many prednisone prescription cases were there in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prednisone' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prednisone' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],True,0.5025601387023926,0.5030407905578613,1,,[{'COUNT(*)': 30751}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}]"
d7bfaa791dff50ff50ea52c1,Apply a non-linear regression model to predict the progression of patient health status using 'chartevents'.,,SELECT COUNT(*) FROM chartevents WHERE chartevents.valuenum >= 0.0,,True,1.3568453788757324,1.3580043315887451,1,,[{'COUNT(*)': 16670648}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN chartevents""}]"
e2e9e3d582524db3f2e7d55a,Tell me the name of the drug that was first prescribed to patient 10005817 during the last hospital visit via nu route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'nu' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND prescriptions.route = 'nu' ORDER BY prescriptions.starttime ASC LIMIT 1,[],True,0.9154849052429199,0.9159786701202393,1,,[{'drug': 'fluticasone propionate nasal'}],['drug'],"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 11, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 16, ""parent"": 9, ""notused"": 0, ""detail"": ""SCALAR SUBQUERY 1""}, {""id"": 25, ""parent"": 16, ""notused"": 0, ""detail"": ""SCAN admissions""}, {""id"": 42, ""parent"": 16, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 69, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}]"
760a949d971be61cb70b4e30,Perform a factor analysis on 'chartevents' to identify underlying relationships between various 'itemid'.,,SELECT COUNT(*) FROM chartevents WHERE chartevents.charttime >= current_time - 1 * 365 * 24 * 60 * 60,,True,1.6728076934814453,1.6737842559814453,1,,[{'COUNT(*)': 16671760}],['COUNT(*)'],"[{""id"": 3, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN chartevents""}]"
2a9d088ed54aa381d9b85246,What is capital amount compared to?,,"SELECT DISTINCT T1.valuenum / T2.valuenum FROM labevents AS T1, labevents AS T2 WHERE T1.itemid IN ( SELECT DISTINCT chartevents.itemid FROM chartevents WHERE chartevents.valuenum = 1.0 ) AND T2.itemid IN ( SELECT DISTINCT labevents.itemid FROM labevents WHERE labevents.valuenum = 1.0 ) AND T1.charttime < T2.charttime AND datetime(T1.charttime) >= datetime(current_time,'-1 year')",,True,2.947877883911133,2.949068546295166,0,,,,"[{""id"": 4, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T1""}, {""id"": 9, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN chartevents""}, {""id"": 24, ""parent"": 9, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR DISTINCT""}, {""id"": 37, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN T2""}, {""id"": 42, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 45, ""parent"": 42, ""notused"": 0, ""detail"": ""SCAN labevents""}, {""id"": 57, ""parent"": 42, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR DISTINCT""}, {""id"": 77, ""parent"": 0, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR DISTINCT""}]"
c3546915506c74cfcbd2b9ce,Show me the top five most frequently prescribed medications since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT d.drug FROM   ( SELECT   t.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM     ( SELECT    prescriptions.drug   FROM      prescriptions   WHERE     datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS t   GROUP BY   t.drug ) AS d WHERE d.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]",True,3.389338731765747,3.3898329734802246,5,,"[{'drug': '0.9% sodium chloride'}, {'drug': 'insulin'}, {'drug': 'sodium chloride 0.9%  flush'}, {'drug': 'acetaminophen'}, {'drug': 'furosemide'}]",['drug'],"[{""id"": 2, ""parent"": 0, ""notused"": 0, ""detail"": ""CO-ROUTINE d""}, {""id"": 5, ""parent"": 2, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 12, ""parent"": 5, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 21, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 56, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 70, ""parent"": 2, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 132, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN d""}]"
47fd000ef0b1033a8aabfac8,Show me the top five most frequently prescribed medications since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT d.drug FROM   ( SELECT   t.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1   FROM     ( SELECT    prescriptions.drug   FROM      prescriptions   WHERE     strftime('%Y',prescriptions.starttime) >= '2100' ) AS t   GROUP BY   t.drug ) AS d   WHERE   d.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]",True,3.9751827716827393,3.975780725479126,5,,"[{'drug': '0.9% sodium chloride'}, {'drug': 'insulin'}, {'drug': 'sodium chloride 0.9%  flush'}, {'drug': 'acetaminophen'}, {'drug': 'furosemide'}]",['drug'],"[{""id"": 2, ""parent"": 0, ""notused"": 0, ""detail"": ""CO-ROUTINE d""}, {""id"": 5, ""parent"": 2, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 12, ""parent"": 5, ""notused"": 0, ""detail"": ""SCAN prescriptions""}, {""id"": 17, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 52, ""parent"": 5, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 66, ""parent"": 2, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 128, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN d""}]"
46750fb096297aa719284222,Get me the top four most frequent lab tests throughout this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label IN ( SELECT T1.c1 FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.c1 <= 4 )",[],True,4.467727899551392,4.46843695640564,0,,,,"[{""id"": 2, ""parent"": 0, ""notused"": 0, ""detail"": ""SCAN d_labitems""}, {""id"": 7, ""parent"": 0, ""notused"": 0, ""detail"": ""LIST SUBQUERY 2""}, {""id"": 9, ""parent"": 7, ""notused"": 0, ""detail"": ""CO-ROUTINE T1""}, {""id"": 12, ""parent"": 9, ""notused"": 0, ""detail"": ""CO-ROUTINE (subquery-4)""}, {""id"": 19, ""parent"": 12, ""notused"": 0, ""detail"": ""SCAN labevents""}, {""id"": 29, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR GROUP BY""}, {""id"": 64, ""parent"": 12, ""notused"": 0, ""detail"": ""USE TEMP B-TREE FOR ORDER BY""}, {""id"": 78, ""parent"": 9, ""notused"": 0, ""detail"": ""SCAN (subquery-4)""}, {""id"": 140, ""parent"": 7, ""notused"": 0, ""detail"": ""SCAN T1""}]"
