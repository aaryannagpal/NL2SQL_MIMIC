id,question,true_query,result,generated_sql
7615134b4fa7ff6ddf73b525,Tell me the total number of patients who were discharged from the hospital in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],
828e100d1270a025a702476f,Tell me what was patient 10018423's daily maximum weight since 28 months ago?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"select max(weight) as daily_maximum_weight from (select * from patient_data where patient_id = 10018423 and record_date >= DATE_SUB(CURDATE(), INTERVAL 28 MONTH)) group by record_date"
138c2d22c5c0e542ad8688f0,What diagnosis did patient 10010471 receive in the first hospital encounter for the last time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,select diagnosis from patient_diagnoses where patient_id = 10010471 order by encounter_date desc limit 1
7a437c8dbddf61c5a8051a64,Show me the top three most frequent drugs that patients were prescribed within the same hospital visit after being diagnosed with hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts) this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts)' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"[select drug_name, count(*) as count from visits"
c47c4a63334997fb668032de,What the proccedural of the drugs against cancer is?,,,"SELECT drug_name, procedure FROM drugs WHERE disease='cancer'"
2e71a00ad2d28b3a77dfcd7e,Count the number of current patients who are in their 60 or above.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,,SQL Query Here
8716193b576f9f33068e792d,Are any new drugs prescribed to patient 10004733 today compared to the ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],[SELECT CASE WHEN COUNT(DISTINCT drug_name) > 0 THEN 'Yes' ELSE 'No' END AS NewDrugsPrescribed
85e6a823fac4aece9e3933ba,When did patient 10011398 get the microbiology test for the last time in 12/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(test_date) FROM microbiology_tests WHERE patient_id = 10011398 AND YEAR(test_date) = YEAR(CURRENT_DATE) AND MONTH(test_date) = 12
30472e5c27673faeb87b6a0d,What was the total number of patients on hematology/oncology in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL Query Here
a7865e6aada988aba5950707,Can you tell the yearly maximum dose of pacu crystalloid intake that patient 10008454 received since 08/2100?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pacu crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-08' GROUP BY strftime('%Y',inputevents.starttime)",[],select max(dose) from intake where patient_id = 10008454 and substance = 'pacu crystalloid' and date >= '08-2100' group by year(date)
db468e7d4e952084d2241b01,Could you list patient 10004235's monthly average weight since 03/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' GROUP BY strftime('%Y-%m',chartevents.charttime)",[],
9811bdd8dd976caed209c6a2,What percentile is the value of the mcv of 80.0 among patients of the same age as patient 10018423 during the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 80.0",,[SELECT PERCENT_RANK() OVER (ORDER BY mcv) AS percentile FROM `physionet-data.mimic-iv.admissions` WHERE mcv = 80.0 AND patientunitstayid IN (SELECT patientunitstayid FROM `physionet-data.mimic-iv.admissions` WHERE hadm_id IN (SELECT hadm_id FROM `physionet-data.mimic-iv.admissions` WHERE SUBJECT_ID IN (SELECT SUBJECT_ID FROM `physionet-data.mimic-iv.admissions` WHERE HADM_ID IN (SELECT HADM_ID FROM `physionet-data.mimic-iv.patients` WHERE SUBJECT_ID IN (SELECT SUBJECT_ID FROM `physionet-data.mimic-iv.patients` WHERE SUBJECT_ID IN (SELECT SUBJECT_ID FROM `physionet-data.mimic-iv.patients` WHERE HADM_ID IN (SELECT HADM_ID FROM `physionet-data.mimic-iv.admissions` WHERE SUBJECT_ID = (SELECT SUBJECT_ID FROM `physionet-data.mimic-iv.patients` WHERE HADM_ID = (SELECT HADM_ID FROM `physionet-data.mimic-iv.admissions` WHERE SUBJECT_ID = (SELECT SUBJECT_ID FROM
8730272c87597016340a1b9a,What was the overall amount of input for patient 10016742 since 07/11/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-11'",[{'SUM(inputevents.totalamount)': 36640.0}],SELECT SUM(amount) FROM patient_input WHERE patient_id = 10016742 AND date >= '2100-07-11'
ed8eb61d00ca803fbe330b9c,What are the top five most frequently performed procedures for patients who are 30s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT Procedure, COUNT(*) AS ProcedureCount FROM admissions WHERE Age BETWEEN 30 AND 39 GROUP BY Procedure ORDER BY ProcedureCount DESC LIMIT 5"
f7b36fae7e1f6246c0b81fd5,Count the number of hospital visits for patient 10022041 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10022041 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],SELECT COUNT(*) AS total_visits FROM hospital_visits WHERE patient_id = 10022041 AND date >= '2100-01-01'
e2b4b7e5509dd99e1a88449e,What is the percentile ranking of a phosphate test value of 8.7 for patients of the same age as patient 10014354 on their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.7",,select percentile_cont(0.5) within group (order by phosphate) over (partition by age) as phosphate_percentile_ranking from lab_tests where patient_id = 10014354 and test = 'phosphate' and visit = (select max(visit) from lab_tests where patient_id = 10014354) and age in (select age from lab_tests where patient_id = 10014354 and visit = (select max(visit) from lab_tests where patient_id = 10014354)) and phosphate = 8.7
77020ee533db2c04412900f0,What code is associated with icd-11 for helicobacter pylori in icd-10?,,,"select distinct h11.code from icd11 h11, icd10 h10 where h11.code = h10.code"
620d90e5c2bc12b7e637d7b2,"In patients who had the other repair of vessel in 2100, what were the four most common diagnoses that followed within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair of vessel' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM medical_records WHERE procedure_date = '2100' AND procedure_name = 'other repair of vessel' AND diagnosis_date BETWEEN procedure_date AND procedure_date + INTERVAL '2 months' GROUP BY diagnosis ORDER BY frequency DESC LIMIT 4"
02c15c7a4faad2a32636fac7,What was patient 10011398's documented weight on the last record in 12/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '12' ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT weight FROM patient_records WHERE patient_id = 10011398 AND record_date = (SELECT MAX(record_date) FROM patient_records WHERE patient_id = 10011398 AND DATE_FORMAT(record_date, '%Y-%m') = DATE_FORMAT(CURRENT_DATE, '%Y-12'))"
ce9d557587a02ef7b5b69000,When did last patient 10005348 have the minimum value of calculated total co2?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],"SELECT `visit date` FROM (SELECT `visit date`, MIN(`calculated total co2`) AS min_co2 FROM `cohort_10005348` GROUP BY `visit date`) AS subquery WHERE `calculated total co2` = min_co2 ORDER BY `visit date` DESC LIMIT 1"
5d18dc5b86410f1a0b68d571,"What is the diagnosis cost of urinary tract infection, site not specified?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) )",,select sum(diagnosis_cost) from claims where diagnosis_code='788.30'
81e40ba71ccb07316db2401c,When was the last time patient 10007058 had the minimum heart rate since 11/20/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-11-20' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(h.hadm_id) AS last_hadm_id, h.admittime AS last_admittime FROM heart a INNER JOIN heart h ON a.icustay_id = h.icustay_id WHERE a.icustay_id = 10007058 AND a.min <= h.min AND a.charttime >= '11/20/2100' GROUP BY a.icustay_id"
9d5b103ab75bc4e5ec507f0a,Calculate the length of stay in days for patient 10007058's last ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.022962963208556}]","SELECT DATEDIFF(check_out_date, check_in_date) AS length_of_stay FROM ICU_Stay WHERE patient_id = 10007058 ORDER BY check_in_date DESC LIMIT 1"
451dfc06ff9455d76225f86b,Can you point to a genetic test that patient 655 received?,,,SELECT test_name FROM patient_tests WHERE patient_id = 655
e7693ad9894979dd2cf53541,How much is the drug perphenazine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'perphenazine' ),,select price from drugs where name='perphenazine'
bf0f4f576e73bf0337820ba1,"What are the charges for a procedure called occlusion of right vertebral artery with intraluminal device, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' ) )",,"SELECT procedure_charge FROM Procedure_Charges WHERE procedure_name = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' LIMIT 1;"
56dc9b6a0a55ec1fc9f4a5c8,Could you inform me of the top four most common specimen tests that were conducted during this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",[],"SELECT test_name, COUNT(test_id) AS test_count FROM specimen_tests WHERE test_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY test_name ORDER BY test_count DESC LIMIT 4"
7dab61a9dbafa23e083cd77e,Was patient 10004720 given any gt flush medication on this month/08?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '08'",[{'COUNT(*)>0': 0}],SELECT medication_name FROM gt_flush_medications WHERE patient_id = 10004720 AND date_administered >= '2023-08-01' AND date_administered < '2023-09-01'
1533c631557452d754da7280,When was the last time patient 10004733 measured its heart rate greater than 118.0 during their first ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 118.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],"SELECT MAX(measurement_date) FROM (SELECT measurement_date FROM (SELECT measurement_date, value, ROW_NUMBER() OVER(PARTITION BY patientunitstayid ORDER BY measurement_date) AS rn FROM measurement WHERE measurement_name = 'HeartRate' AND value > 118.0) AS ranked_measurements WHERE rn = 1 AND patientunitstayid = (SELECT patientunitstayid FROM patient WHERE patientid = '10004733')) AS first_visit_measurements WHERE patientunitstayid = (SELECT patientunitstayid FROM patient WHERE patientid = '10004733')"
8d3d64b56c340125f70300f3,Count the number of drugs prescribed since 24 months ago for patient 10003046.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')",[{'COUNT(*)': 84}],"SELECT COUNT(*) AS 'DrugCount' FROM prescriptions WHERE patient_id = 10003046 AND prescription_date >= DATEADD(MONTH, -24, GETDATE())"
ca0b792691b7ae80aefbc093,Is there a genetic test that was given to patient 1561?,,,SELECT EXISTS(SELECT 1 FROM `genetic_tests` WHERE `patient_id` = 1561)
27c48e778f2f116680270dd6,Give me the top three most frequently prescribed drugs within 2 months for patients in their 20s who were diagnosed with long-term (current) use of anticoagulants.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 20 AND 29 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 drug_name, COUNT(*) AS frequency FROM prescriptions WHERE prescription_date BETWEEN DATEADD(MONTH, -2, GETDATE()) AND GETDATE() AND patient_age BETWEEN 20 AND 29 AND diagnosis = 'long-term (current) use of anticoagulants' GROUP BY drug_name ORDER BY frequency DESC"
74fa66a731eaa7d33a261eba,Calculate the length of stay in days for patient 10015860's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.7518518520519137}]","SELECT DATEDIFF(day, MIN(LOS.los_start), LOS.los_end) AS length_of_stay_in_days FROM LOS WHERE los_hadm_id = (SELECT hadm_id FROM ADMISSIONS WHERE subject_id = 10015860 AND hadm_id IN (SELECT los_hadm_id FROM LOS WHERE los_icustay_id IN (SELECT icustay_id FROM ICUSTAYS WHERE subject_id = 10015860 ORDER BY intime ASC LIMIT 1)))"
7817472ef455fc770676dced,How was patient 10020187 admitted in terms of admission type for the last time at the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10020187 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1",[],select distinct admission_type from admission_records where patient_id = 10020187 order by admission_date desc limit 1
fa7d7ca1c281f5d1e6a549c9,Has patient 10004720 had gastric meds input since 10/02/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-02'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM patient_medication_log WHERE patient_id = '10004720' AND medication_type = 'gastric' AND administration_date >= '2100-10-02'
a38ecaf9f7fe8c5a81432f27,What is the monthly maximum value of weight for patient 10009049 since 01/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT MAX(Weight) as MaxWeight, MONTH(Date) as Month FROM patient_data WHERE PatientID = '10009049' AND Date >= '01012000' GROUP BY MONTH(Date)"
a3279eb9747f960bcb7b62b6,What percentile is 16.5 white blood cells in a patient of the same age as patient 10031757 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 16.5",,SELECT ... FROM ... WHERE ...
97b11bd8315c504b3001f159,Expose the top five most frequent output events since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT output_events, COUNT(*) AS frequency FROM data WHERE timestamp > '2100-01-01' GROUP BY output_events ORDER BY frequency DESC LIMIT 5"
c07fa4ddf84fc8c4cfd717ab,What was the total dose of levetiracetam patient 10001217 had been prescribed in 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'levetiracetam' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(Dose) FROM Medication WHERE PatientID = '10001217' AND DrugName = 'Levetiracetam' AND PrescribedDate BETWEEN '2100-12-01' AND '2100-12-31'
27cbb7342a12ed24d5662980,"What was the drug that patient 10025463 was prescribed for during the same hospital encounter after the procedure of excision or destruction of other lesion or tissue of heart, endovascular approach?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision or destruction of other lesion or tissue of heart, endovascular approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT drug_name FROM prescriptions WHERE patient_id = '10025463' AND hospital_encounter_id = (SELECT hospital_encounter_id FROM procedures WHERE procedure_description = 'excision or destruction of other lesion or tissue of heart, endovascular approach')"
2ad3296a49ba1754c226eef3,What was the overall amount of input for patient 10007818 on 07/17/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-17'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input_amount) AS total_input FROM patient_inputs WHERE patient_id = '10007818' AND input_date = '2023-07-17'
32d7327a3beff353c0d3b98e,Tell me the name of the organism found in patient 10019172's last urine microbiology tests since 10/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT organism FROM microbiology_test WHERE patient_id = '10019172' AND test_type = 'urine' AND test_date >= '2100-10-01' ORDER BY test_date DESC LIMIT 1;
000f58d3abb4ad76b2ebc35c,When was the first time the respiratory rate of patient 10018081 was measured to be less than 23.0 today?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 23.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(MeasurementDate) FROM PatientVitals WHERE PatientID = '10018081' AND RespiratoryRate < 23.0 AND DATE(MeasurementDate) = CURDATE()
42338b681fd350441ca9efc0,Do patient 19894 have a appointment in another department?,,,SELECT * FROM appointments WHERE patient_id = 19894 AND department_id != (SELECT department_id FROM departments WHERE department_name = (SELECT department_name FROM departments WHERE patient_id = 19894 LIMIT 1))
43dc5805c85d11ad9ce1eb53,Count the total number of hospital visits made by patient 10029291 in the last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10029291 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SQL query
648035b87d03c40993442aeb,"On the current hospital visit, how many hours have passed since patient 10018081's first diagnosis of abnormal coagulation profile?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT EXTRACT(HOURS FROM AGE(current_hospital_visit.time, MIN(diagnosis.time))) AS hours_since_first_diagnosis FROM diagnosis INNER JOIN patient ON diagnosis.patient_id = patient.id INNER JOIN hospital_visit ON patient.id = hospital_visit.patient_id WHERE diagnosis.code = 'abnormal coagulation profile' AND diagnosis.patient_id = 10018081 AND hospital_visit.id = (SELECT id FROM hospital_visit WHERE patient_id = 10018081 ORDER BY time DESC LIMIT 1)"
d289ae08b9d6d02468d8c8d2,"Since 22 months ago, how much did patient 10019172 weigh during the first measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT weight FROM patient_measurements WHERE patient_id = 10019172 AND measurement_order = 1 AND date >= DATE_SUB(CURDATE(), INTERVAL 22 MONTH)"
6874b240b1ee6575829fb705,"Which were the three most commonly ordered procedures for patients previously diagnosed with streptococcus infection in conditions classified elsewhere and of unspecified site, streptococcus, group d [enterococcus] during the same month, since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'streptococcus infection in conditions classified elsewhere and of unspecified site, streptococcus, group d [enterococcus]' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT TOP 3 ProcedureID, COUNT(*) AS ProcedureCount FROM Procedures WHERE DiagnosisID IN (SELECT ID FROM Diagnoses WHERE Name = 'Streptococcus infection in conditions classified elsewhere and of unspecified site, Streptococcus, group D [Enterococcus"
0d8f8539a8e82f5daa90562f,What precautions should you follow after the cont inv mec ven 96+ hrs procedure?,,,SELECT precautions FROM post_procedure_instructions WHERE procedure_name = 'cont inv mec ven 96+ hrs'
7f9c0eb6e47a6e07284a459d,"Has patient 10007818 undergone a insertion of endotracheal airway into trachea, via natural or artificial opening since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal airway into trachea, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT * FROM `EDW_LIVE.dbo.ADM_FactProcedures` WHERE `PatientID` = '10007818' AND `ProcedureName` = 'Insertion of Endotracheal Airway into Trachea' AND `ProcedureDate` >= '2100-01-01'
30ed0a6953999ac4024916ae,What is the minimum total cost of the hospital which involves calculus of kidney?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT MIN(total_cost) FROM hospitals WHERE specialization LIKE '%kidney calculus%';
7b8292b0a8f2a804114ac706,"How many hours have elapsed since the last time during their current hospital encounter that patient 10004733 was diagnosed with chronic kidney disease, unspecified?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic kidney disease, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,SELECT EXTRACT(EPOCH FROM (NOW() - MAX(CASE WHEN diagnosis_code = 'CKD_unspecified' THEN encounter_time ELSE NULL END))) / 3600 AS hours_elapsed_since_last_diagnosis FROM patient_encounters WHERE patient_id = 10004733 AND encounter_type = 'hospital' AND encounter_status = 'current'
ffcd5cfa2ddc5dc30fef4cd5,"When, since 03/30/2100, was patient 10020740's respiratory rate measured less than 21.0 for the first time?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-03-30' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(measurement_date) FROM measurements WHERE patient_id = '10020740' AND respiratory_rate < 21.0 AND measurement_date > '03/30/2100'
1f400039f5811e19f5da4593,Do you think patient 29540 is subject to covid-19 testing?,,,SELECT testing_status FROM patient_testing WHERE patient_id = 29540;
63dc3947dde2cd40f4b0c364,How much metronidazole (flagyl) had been prescribed to patient 10001217 in total in 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'metronidazole (flagyl)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'",[{'SUM(prescriptions.dose_val_rx)': None}],select sum(quantity) from prescriptions where patient_id = 10001217 and medication_name = 'metronidazole' and date_prescribed between '12/01/2100' and '12/31/2100'
c0dcb9d8aed598dc3c1ff8fd,What is the cost for the drug acetazolamide sodium?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide sodium' ),,SELECT cost FROM drug WHERE name='acetazolamide sodium'
016d92926546ac6ede02409b,What is the anion gap percentile of 11.0 among patients of the same age as patient 10014729 during their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 11.0",,SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY (sodium - (chloride + bicarbonate))) OVER (PARTITION BY age) AS anion_gap_percentile FROM lab_results JOIN patients ON lab_results.patient_id = patients.patient_id WHERE lab_results.patient_id = '10014729' AND lab_results.encounter_id = (SELECT MIN(encounter_id) FROM lab_results WHERE lab_results.patient_id = '10014729')
4e4d519fec610e5878e325da,List the three most frequent specimens that were tested during this year.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",[],SQL Query Here
ffc00c5a91336c29e74e82e7,Name the three most frequently prescribed drugs in the same hospital visit following a diagnosis of pure hypercholesterolemia.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pure hypercholesterolemia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT DRUG_NAME, COUNT(DRUG_NAME) AS PRESCRIPTION_COUNT FROM PRESCRIPTIONS WHERE VISIT_ID IN (SELECT FOLLOWUP_VISIT_ID FROM DIAGNOSES WHERE ICD_CODE = 'E78.0') GROUP BY DRUG_NAME ORDER BY PRESCRIPTION_COUNT DESC LIMIT 3"
072f960a91e48e6fe38d81a1,Calculate the number of prescribed drugs for patient 10001725 in 04/this year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescriptions WHERE patient_id = 10001725 AND medication_date >= '2023-04-01' AND medication_date < '2023-05-01'
e8433f2ef9b3e709b1fe04cf,"Count the number of people who were diagnosed with other disorders of muscle, ligament, and fascia since 2100.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other disorders of muscle, ligament, and fascia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,SELECT COUNT(*) FROM diagnosis_records WHERE diagnosis_code LIKE 'other_disorders_of_muscle_ligament_fascia' AND date > '2100-01-01'
3a3cae7df796116acb43c341,"Give me the top three most frequent lab tests that patients were given after being diagnosed with allergic rhinitis, unspecified in the same hospital encounter in 2100.","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'allergic rhinitis, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,"[SELECT LabTest, COUNT(LabTest) AS Frequency"
4f998b87cac41752ae6d9248,What was the name of the insurance used for patient 10000032 during their last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicaid'}],"select visit_occurrence.visit_occurrence_id, insurance_plan.plan_name from visit_occurrence left join insurance_plan on visit_occurrence.insurance_plan_id = insurance_plan.insurance_plan_id where visit_occurrence.person_id = 10000032 and visit_occurrence.visit_occurrence_id = (select max(visit_occurrence_id) from visit_occurrence where person_id = 10000032)"
9e84a6e731e2b335a972b488,What was the last drug that was prescribed to patient 10038992 in their last hospital encounter via the oral route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1,[],select top 1 d.drug_name from prescription p join drug d on p.drug_id = d.id where p.patient_id = 10038992 and p.route = 'oral' and p.encounter_id in (select top 1 encounter_id from encounter where patient_id = 10038992 order by date desc) order by p.date desc
9da1c2b4d2477e7d54541e82,Show me the top three most frequent diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]","SELECT diagnosis, COUNT(*) AS frequency FROM patient_records GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3;"
3ed75cc0aecb87eee22cf8e5,"What are the four frequently ordered treatments for patients who were diagnosed with other and unspecified alcohol dependence, continuous during the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, continuous' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"select t.treatment_description, count(*) as num_treatments from orders o join treatments t on o.treatment_id=t.treatment_id where o.diagnosis='other and unspecified alcohol dependence' and o.month='continuous' group by t.treatment_description order by num_treatments desc limit 4"
d1c500e1dc43c5cae4cf9075,"What is the maximum total cost for a hospital visit that involved a amylase, ascites lab test?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' ) ) GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(TotalCost) AS MaximumTotalCost FROM HospitalVisits WHERE LabTests LIKE '%amylase%' AND LabTests LIKE '%ascites%';
ba17453769db45c0f15880db,"What are the five most commonly prescribed medications for patients who were diagnosed with atherosclerotic heart disease of native coronary artery without angina pectoris previously in the same month, in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery without angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT medication_name, COUNT(*) AS prescription_count FROM prescriptions JOIN diagnoses ON prescriptions.patient_id = diagnoses.patient_id WHERE diagnoses.condition = 'atherosclerotic heart disease of native coronary artery without angina pectoris' AND diagnoses.diagnosis_date >= '2100-01-01' AND diagnoses.diagnosis_date <= '2100-12-31' GROUP BY medication_name ORDER BY prescription_count DESC LIMIT 5"
b294fc478c483f32414156f0,"What are the top four most common specimens tested after receiving excision of left main bronchus, via natural or artificial opening endoscopic in the same hospital encounter since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"SELECT specimen, COUNT(*) AS specimen_count FROM lab_events WHERE endoscopic_procedure_name LIKE '%excision of left main bronchus%' AND specimen IS NOT NULL AND start_date >= '2100-01-01' GROUP BY specimen ORDER BY specimen_count DESC LIMIT 4"
a09c071ef325a1bc1e1417a1,"Provide a list of the four most common diagnoses that patients were diagnosed with within 2 months after undergoing the extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic procedure.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"[select distinct diagnosis, count(diagnosis) as count from MIMIC_III.DIAGNOSES_ICD where hadm_id in (select hadm_id from MIMIC_III.PROCEDURES_ICD where icd9_code in (select icd9_code from MIMIC_III.DIAGNOSES_ICD where icd9_code in (select icd9_code from MIMIC_III.DIAGNOSES_ICD where icd9_code regexp '^5194')) and hadm_id in (select hadm_id from MIMIC_III.PATIENTS where discharge_date between (select admittime from MIMIC_III.ADMISSIONS where hadm_id in (select hadm_id from MIMIC_III.PROCEDURES_ICD where icd9_code in (select icd9_code from MIMIC_III.DIAGNOSES_ICD where icd9_code in (select icd9_code from MIMIC_III.DIAGNOSES_ICD where icd9_code regexp '^5194')))) and date_add((select admittime from MIMIC_III.ADMISSIONS where hadm_id in (select hadm_id from M"
bb7840631855547af8253009,When was the last time that patient 10011398 was prescribed a medication since 10/2100 via im?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = 10011398 AND prescription_date >= '10/2100' AND route = 'im'
5103a06a571d43b9da46cda7,Tell me the length in days of the first stay for patient 10020740 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 7.446423612069339}]",select count(*) from stays where patient_id='10020740' and stay_type='icu' and stay_id in (select min(stay_id) from stays where patient_id='10020740' and stay_type='icu')
05c1bc3943f37d24fbc4a227,What was patient 10009049's last tested culture since 24 months ago?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-24 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'BLOOD CULTURE'}],"SELECT * FROM (SELECT DISTINCT ON (patient_id, culture_id) * FROM lab_results WHERE patient_id = 10009049 AND test_date >= NOW() - INTERVAL '24 months' ORDER BY patient_id, culture_id, test_date DESC) sub ORDER BY test_date DESC LIMIT 1"
5c872eafe61305c165ef7490,Tell me the reimbursement standard for a drug?,,,SELECT reimbursement_standard FROM drug_reimbursement WHERE drug_name = ?
0741b96a36302acf8ace5c02,When since 07/2100 did patient 10016810 receive the sodium test for the last time?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT MAX(visit_start_date) FROM patient_sodium_test WHERE patient_id = 10016810 AND visit_start_date >= '2021-07-01'
4e5496cc5a22509ea5c3e4e8,"Since 1 year ago, how many insertion of endotracheal airway into trachea, via natural or artificial opening procedures were there?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal airway into trachea, via natural or artificial opening' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,"select count(*) from procedures where procedure_name = 'insertion of endotracheal airway into trachea' and date_performed >= date('now', '-1 year')"
8b0171b645230d02485753dc,How many hours has it been since the first diagnosis of candidiasis of mouth in patient 10018081 during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidiasis of mouth' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"select datediff(hour, min(admission_date), getdate()) from admission where visit_id in (select visit_id from visit where patient_id = 10018081) and diagnosis = 'candidiasis of mouth' and visit_status != 'cancelled' and visit_status != 'dead' and admission_type='EMERGENCY'"
7699b4e5c410adc67ecb3537,What is the treatment that patient 10007795 was given two or more times since 23 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-23 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"SELECT treatment_name, COUNT(*) as times_given FROM treatments WHERE patient_id = '10007795' AND treatment_date >= DATE_SUB(CURDATE(), INTERVAL 23 MONTH) GROUP BY treatment_name HAVING COUNT(*) >= 2"
137db7f9de6adce5df221be5,How often did patient 10039997 go to the ICU on the first hospital encounter?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT( DISTINCT icustays.stay_id )': 1}],SELECT COUNT(*) FROM encounters WHERE patient_id = '10039997' AND encounter_type = 'ICU' AND encounter_number = 1
1858b068f17e456b42371330,Show the mean blood pressure changes of patient 10031757 last measured on the first ICU visit compared to the value second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT AVG(SecondLastBP.blood_pressure) - AVG(FirstLastBP.blood_pressure) AS MeanBPChange FROM (SELECT blood_pressure FROM blood_pressure_records WHERE patient_id = 10031757 AND visit_number = 1 ORDER BY measurement_date DESC LIMIT 2) AS FirstLastBP, (SELECT blood_pressure FROM blood_pressure_records WHERE patient_id = 10031757 AND visit_number = 1 ORDER BY measurement_date DESC LIMIT 2, 1) AS SecondLastBP"
2c1feec1d1f2e0f1260812d2,What are the three most common diagnoses of patients in their 30s this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) AS diagnosis_count FROM patients WHERE YEAR(birth_date) >= YEAR(CURDATE()) - 30 AND YEAR(birth_date) < YEAR(CURDATE()) - 29 GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 3"
08a1f3896026c957daada255,What's the average daily number of admissions for other specified coagulation defects in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified coagulation defects' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,SELECT AVG(daily_admissions) AS average_admissions FROM admissions WHERE condition = 'other specified coagulation defects' AND YEAR(admission_date) = 2100
d5968ba9a98b70f548218263,"So, the last glucose test result for the patient 10018423 on the last hospital visit was?",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1,[],"SELECT `Result` FROM `LabResults` WHERE `PatientID` = 10018423 AND `TestName` = 'Glucose' ORDER BY `VisitDate` DESC, `ResultDate` DESC LIMIT 1"
d22a0040ed5e1ed60f2c89ea,"What was the first time that patient 10004422 was prescribed aspirin ec and milk of magnesia in 01/this year, at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin ec' AND admissions.subject_id = 10004422 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'milk of magnesia' AND admissions.subject_id = 10004422 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"SELECT MIN(PRESCRIBING_TIME) as FIRST_PRESCRIBING_TIME FROM EHR_PHARMA WHERE PATIENT_ID = '10004422' AND (MEDICATION_NAME = 'aspirin ec' OR MEDICATION_NAME = 'milk of magnesia') AND DATE_PART('year', PRESCRIBING_TIME) = DATE_PART('year', CURRENT_DATE) AND DATE_PART('month', PRESCRIBING_TIME) = 1 GROUP BY PATIENT_ID HAVING COUNT(DISTINCT MEDICATION_NAME) = 2"
f4ea3a1a0ad748d9673ee4c3,"What was the name of the organism found in the first microbiology test conducted on patient 10021487's fluid,other since 03/2100?","SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid,other' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT organism_name FROM microbiology_tests WHERE patient_id = 10021487 AND fluid_type = 'other' AND test_date = (SELECT MIN(test_date) FROM microbiology_tests WHERE patient_id = 10021487 AND fluid_type = 'other' AND test_date >= '03-2100')
75f06d4831e589b2c6c537f0,What medication was prescribed for the last time since 04/2100 to patient 10015931?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'LORazepam'}],SELECT TOP 1 medication FROM patient_prescriptions WHERE patient_id = 10015931 AND prescription_date >= '04/2100' ORDER BY prescription_date DESC
f67318674d2ce3452b9792f6,When did patient 10038933 since 07/17/2100 for the first time have an input?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-17' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2148-09-10 13:30:00'}],select min(date) from inputevents_mv where subject_id=10038933 and date>'07/17/2100'
6857374e8a42190064459f79,"How much does a procedure known as drainage of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) )",,"select cost from procedures where procedure_name = 'Drainage of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic'"
10a89ace2e918f90758fc385,When did patient 10021487 receive the last prescription of sodium bicarbonate and famotidine at the same time in 12/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"SELECT MAX(prescribe_date) AS last_prescribe_date FROM patient_prescriptions WHERE patient_id = '10021487' AND drug_name IN ('sodium bicarbonate', 'famotidine') AND EXTRACT(YEAR FROM prescribe_date) = 12 AND EXTRACT(MONTH FROM prescribe_date) = 21 AND prescribe_date IN (SELECT prescribe_date FROM patient_prescriptions WHERE patient_id = '10021487' GROUP BY prescribe_date HAVING COUNT(DISTINCT drug_name) = 2)"
c469f81f092e3b28dadc05f4,What was diagnosed for patient 10002930 the last time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,SELECT TOP 1 diagnosis FROM diagnoses WHERE patient_id = 10002930 ORDER BY diagnosis_date DESC
24d90e86a7032d40c367258d,When did patient 10003046 last have their maximum SaO2 in the last ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(o.time) AS ""Last Max SaO2 Time"" FROM observation o INNER JOIN patient p ON o.patient_id = p.id WHERE p.id = '10003046' AND o.name = 'SaO2' AND o.value = (SELECT MAX(value) FROM observation WHERE patient_id = '10003046' AND name = 'SaO2' AND time BETWEEN (SELECT MIN(time) FROM icustay WHERE patient_id = '10003046') AND (SELECT MAX(time) FROM icustay WHERE patient_id = '10003046'))"
741e6bfd3ada80120eff4191,Has patient 10002930 received a medication prescription since 02/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02'",[{'COUNT(*)>0': 1}],select * from EMR_DATA where patient_id = 10002930 and encounter_type = 'medication' and encounter_datetime > '2000-02-01'
8325c8b0200f0d5f16e96fd7,How much did patient 10021487 weigh during their first measurement in 12/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-12' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT weight FROM measurements WHERE patient_id = 10021487 AND date = (SELECT MIN(date) FROM measurements WHERE patient_id = 10021487 AND date LIKE '12/%')
df4e908303402aa200726682,Provide me with all of the prescriptions received by patient 16879 in another department.,,,SELECT * FROM prescription_table WHERE patient_id = 16879 AND department_id <> (SELECT department_id FROM patient_table WHERE patient_id = 16879)
dd41fa87a9bb005a4d9cfe78,"If it is a cerebrovascular mri, what's the reimbursement standard?",,,select reimbursement_standard from cpt_cerebrovascular_mri where procedure_code = 'cerebrovascular_mri'
f7f753ce0654fdfa9372170c,How many days was patient 10029291's last stay in the intensive care unit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 6.4747916660271585}]",Your SQL query here
d0de144bda7a040a2f9dfa07,Can you tell me when patient 10007818's first microbiology test was in 06/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-06' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(date) FROM microbiology_tests WHERE patient_id = 10007818 AND date BETWEEN '06/01/2100' AND '06/30/2100'
53c2c01705d8513ebac151eb,What was the total of potassium chloride (powder) patient 10021118 had been prescribed since 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.drug = 'potassium chloride (powder)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(quantity) FROM prescriptions WHERE patient_id = '10021118' AND medication = 'potassium chloride (powder)' AND date_prescribed >= '2100-12-01'
9c5b3244cf12068e0fc12891,Will patient 28443 receive any additional immunology test?,,,select count(*) from order_detail where order_no=(select order_no from patient_info where patient_no='28443') and (item_name like '%immunology%')
695dff1ad99f6d2eb4de81db,"What are the five commonly ordered medications that patients aged 60 or above were prescribed in the same month after diagnosed with retention of urine, unspecified in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'retention of urine, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,top 5 medications
e3d50b7cc908a38055145b12,"What are the three most commonly prescribed medications for patients who were previously diagnosed with grand mal status within the same month, this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'grand mal status' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 medication_name, COUNT(*) as frequency FROM prescriptions WHERE patient_id IN (SELECT patient_id FROM diagnoses WHERE diagnosis_name = 'grand mal status' AND diagnosis_date >= DATEADD(month, -1, GETDATE()) AND YEAR(diagnosis_date) = YEAR(GETDATE())) GROUP BY medication_name ORDER BY frequency DESC"
ba3296488999e2e149c3a32e,How often was other enterostomy done?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other enterostomy' ),[{'COUNT(*)': 0}],select count(*) from surgery where procedure_name = 'other enterostomy'
5005d7619cfd562a1af8ba4e,What was the last time that patient 10003046 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003046 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(DischargeDate) FROM PatientDischarges WHERE PatientID = '10003046'
9ad2b349b566ce28567c5d6b,When was patient 10005817's last microbiological examination since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2135-01-16 16:27:00'}],SELECT MAX(examination_date) AS last_microbiological_examination_date FROM microbiological_examinations WHERE patient_id = 10005817 AND examination_date > '2100-03-31'
ddf67e92449897f5c52db5d2,List the top four most frequent microbiology tests that were given to patients after they were diagnosed with sepsis during the same hospital visit during this year.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sepsis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"SELECT test_name, COUNT(*) AS frequency FROM microbiology_tests WHERE patient_id IN (SELECT patient_id FROM diagnoses WHERE diagnosis = 'sepsis' AND admission_date BETWEEN '2023-01-01' AND '2023-12-31') AND test_date = admission_date AND YEAR(test_date) = 2023 GROUP BY test_name ORDER BY frequency DESC LIMIT 4"
7766442f90d1794d8c97fdfb,Has patient 10023117 entered the hospital in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10023117 AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT(*)>0': 0}],select * from admissions where patient_id = 10023117 and year(admission_date) = 2100
00b98d0bf4d50497625b257e,Has patient 10019917 been given any drugs in 04/last year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)>0': 0}],select * from admissions where patient_id = '10019917' and admission_date between '2022-04-01' and '2022-04-30' and drug_exposure_drug_type_concept_id is not null
d6557e346d781e08feab81d0,How many patients in 2100 were diagnosed with hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (luts)?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate with urinary obstruction and other lower urinary tract symptoms (luts)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )",,"SELECT COUNT(DISTINCT patient_id) FROM patient_diagnoses WHERE year_of_diagnosis=2100 AND diagnosis_code IN ('N40.1','R39.15')"
226565b9dfa316da14138b50,"What was patient 10007795's maximum amylase, ascites value?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' )",[{'MAX(labevents.valuenum)': None}],"SELECT MAX(Amylase) AS Max_Amylase, MAX(Ascites) AS Max_Ascites FROM `physionet-data.mimiciii_clinical.labevents` WHERE ItemID IN (50868, 50874) AND Subject_ID = 10007795"
810985919f9d2ed07555c4b0,What was the time of patient 10027445's last influenza a/b by dfa microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'influenza a/b by dfa' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT TOP 1 date_performed FROM microbiology_tests WHERE patient_id = 10027445 AND test_type = 'influenza a/b by dfa' AND date_performed >= '03/21/2000' ORDER BY date_performed DESC;
2a32cb9fdb4241702a454055,"For patients who received performance of cardiac output, continuous , what are the top five most frequent diagnoses that followed afterwards within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM patient_records WHERE procedure = 'performance of cardiac output, continuous' AND follow_up_date BETWEEN DATE_ADD(procedure_date, INTERVAL 1 DAY) AND DATE_ADD(procedure_date, INTERVAL 2 MONTH) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
6daf43327893e27cc1c785bb,What are the precautions that should be followed after the procedure of coronar arteriogr-1 cath?,,,SQL Query
dcc6094fae5bc1bb4de3c989,What was the last time in this hospital visit patient 10004733 had the minimum protein.,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],SELECT MAX(Visit_Date) FROM patient_tests WHERE Patient_ID = 10004733 AND Test_Name = 'Protein' AND Result = (SELECT MIN(Result) FROM patient_tests WHERE Patient_ID = 10004733 AND Test_Name = 'Protein')
d7d112f41aba75a33dcbeb67,What is the cost for the drug haloperidol?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'haloperidol' ),,select cost from drugs where name = 'haloperidol'
9ac29fcc00066ee270a82758,Has patient 26262 been provided with additional eye test?,,,select * from patient_records where patient_id = 26262 and additional_eye_test is not null
84cf86069630ec83176f8f8e,What were the top five most often performed treatments for patients in their 20s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"[SELECT T.treatment, COUNT(*) AS frequency"
2cceb4c8bccd163def8170ce,Has there been a alpha-fetoprotein lab test performed on patient 10038081 since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alpha-fetoprotein' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y',labevents.charttime) >= '2100'",[{'COUNT(*)>0': 0}],SELECT * FROM lab_tests WHERE patient_id = 10038081 AND test_name = 'alpha-fetoprotein' AND test_date > '2100-01-01'
78deb17fb4b0f07c1c1b0051,How many medications were assigned to patient 10004422 in the previous year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)': 0}],"select count(distinct drug_concept_id) from drug_exposure where person_id=10004422 and (exposure_start_date <= date_trunc('year', current_date - interval '1 year') and (exposure_end_date is null or exposure_end_date > date_trunc('year', current_date - interval '1 year')))"
70b635d6cbd4d6a5cf0cccfa,How many days was patient 10038933 in the intensive care unit during their last visit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 5.355196759104729}]","[SELECT SUM(DATEDIFF(day, AdmissionDate, DischargeDate)) AS DaysInICU"
cc1b03b3dc9e12a0e0841326,Has patient 10019385 been to the emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.admission_location = 'emergency room',[{'COUNT(*)>0': 0}],select count(*) as count from visits where patientid = 10019385 and facilitytype='ER'
f9308fa63d859b237ccb712b,What were the four most commonly given diagnoses for patients who had received anastomosis of hepatic duct to gastrointestinal tract before in the same month this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,[SELECT d.disease FROM
e443e032271f916c3381b735,When is the earliest next hospital visit of patient 73652?,,,select min(hospital_visit_date) from patient_visits where patient_id = 73652 and hospital_visit_date > current_date()
9a56a0173232de3b3d548756,"Since 2100, what are the top five most common medications prescribed in the same hospital visit to the patients aged 60 or above after they were diagnosed with unspecified acquired hypothyroidism?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified acquired hypothyroidism' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT medication_name, COUNT(medication_name) as medication_count FROM prescriptions INNER JOIN visits ON prescriptions.visit_id = visits.id INNER JOIN patients ON visits.patient_id = patients.id WHERE diagnosis = 'unspecified acquired hypothyroidism' AND patients.age >= 60 AND visit_date >= '2100-01-01' GROUP BY medication_name ORDER BY medication_count DESC LIMIT 5"
86c0624f79d2e1a57bd72381,What are the consumption methods of ampicillin sodium?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium',[{'route': 'IM'}],select distinct method from antibiotic_consumption where antibiotic_name='ampicillin sodium'
88c38001054f068df22c8b37,What was the name of the drug which patient 10027602 was prescribed in the same hospital visit after receiving a percutaneous [endoscopic] gastrostomy [peg] procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,SELECT DISTINCT m2.drug FROM mdearly_medication m2 INNER JOIN mdearly_procedures m1 ON m2.hadm_id = m1.hadm_id AND m2.starttime > m1.charttime WHERE m1.itemid = 228644 AND m1.value = 'PEG' AND m1.hadm_id IN (SELECT hadm_id FROM mdearly_procedures WHERE itemid = 228644 AND value = 'PEG' AND hadm_id = (SELECT hadm_id FROM mdearly_procedures WHERE subject_id = (SELECT subject_id FROM mdearly_procedures WHERE hadm_id = (SELECT hadm_id FROM mdearly_procedures WHERE subject_id = 10027602))) GROUP BY m2.drug) ORDER BY m2.starttime LIMIT 1
0f16647da206cfafc77bdb03,Does patient 15209 have acute pain due to trauma that is part of her family?,,,[select p.name from patients p
04f71c7e519351b6f93b7777,List the top five most frequent diagnoses that patients were diagnosed with within 2 months after receiving diagnostic ultrasound of digestive system since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"select Diagnosis, count(*) as frequency from diagnostic_records where procedure = 'diagnostic ultrasound of digestive system' and Date_Procedure >= '2100-01-01' and Diagnosis_Date - Date_Procedure <= 60 group by Diagnosis order by frequency desc limit 5"
37921e0dd6b843c93c0dacc1,Which are the top three most common lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],"SELECT lab_test, COUNT(*) AS frequency FROM lab_tests WHERE year = 2100 GROUP BY lab_test ORDER BY frequency DESC LIMIT 3"
5e099470827356f7917d86bf,Tell me the top five most commonly prescribed drugs in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5",[],"SELECT drug_name, COUNT(*) AS prescription_count FROM prescriptions WHERE year_prescribed = 2100 GROUP BY drug_name ORDER BY prescription_count DESC LIMIT 5"
45e5fa3d7ddb3e52763ec749,"What are the four most frequently given diagnoses for patients who had previously had bypass coronary artery, one artery from left internal mammary, open approach during the same month, throughout this year?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) as frequency FROM medical_records WHERE previous_procedure = 'bypass coronary artery, one artery from left internal mammary, open approach' AND EXTRACT(MONTH FROM procedure_date) = EXTRACT(MONTH FROM CURRENT_DATE) AND EXTRACT(YEAR FROM procedure_date) = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 4"
e4946b7c7c8d1c41eb7d77e2,What is the percentile of the hemoglobin value of 10.4 among patients of the same age as patient 10020740 on their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 10.4",,SELECT PERCENT_RANK() OVER (ORDER BY hemoglobin) AS percentile FROM patient_data WHERE age = (SELECT age FROM patient_data WHERE patient_id = 10020740 AND encounter_number = 1) AND encounter_number = 1;
170d16d87b8d77ec966d5f56,How many hours have elapsed since patient 10021487 has last received a protein lab test in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MAX(protein_tests.date), CURRENT_TIMESTAMP) AS hours_since_last_test FROM protein_tests JOIN lab_tests ON protein_tests.lab_test_id = lab_tests.id JOIN visits ON lab_tests.visit_id = visits.id WHERE visits.patient_id = 10021487 AND visits.visit_date BETWEEN '2023-01-01' AND '2023-12-31';"
add9d8c55cfa9b469ea183bf,Which are the top four most frequent output events during this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"SELECT TOP 4 OutputEvent, COUNT(*) AS Frequency FROM Production.OutputEventLog WHERE YEAR(EventDate) = YEAR(GETDATE()) GROUP BY OutputEvent ORDER BY Frequency DESC"
560ac67e93ac8a709bbc10ea,How many people were diagnosed with amyotrophic lateral sclerosis throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'amyotrophic lateral sclerosis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,SELECT COUNT(*) FROM diagnoses WHERE condition = 'amyotrophic lateral sclerosis' AND diagnosis_date BETWEEN '2023-01-01' AND '2023-12-31';
3bb6bf7407b7133944318142,When was patient 10005909 prescribed a acetaminophen and oxycodone (immediate release) at the same time for the first time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10005909 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'oxycodone (immediate release)' AND admissions.subject_id = 10005909 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT MIN(start_date) AS first_prescription_date FROM prescriptions WHERE patient_id = 10005909 AND ((drug_name = 'acetaminophen' AND strength = '325 mg') OR (drug_name = 'oxycodone' AND strength = '5 mg' AND formulation = 'immediate release')) GROUP BY patient_id HAVING COUNT(DISTINCT drug_name) = 2
e1784c5485d83cd0645a3d4e,Tell me the five most frequent treatments for patients aged 40s in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT treatment, COUNT(*) AS frequency FROM patients WHERE age BETWEEN 40 AND 49 AND year = 2100 GROUP BY treatment ORDER BY frequency DESC LIMIT 5"
63677b75a5d720c6cc3d41f2,How many of ticagrelor were prescribed to patient 10007058 in total in the last month?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND prescriptions.drug = 'ticagrelor' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month')",[{'SUM(prescriptions.dose_val_rx)': None}],"SELECT SUM(quantity) FROM prescriptions WHERE drug_name = 'ticagrelor' AND patient_id = '10007058' AND prescription_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 MONTH) AND CURRENT_DATE"
55ea65a1f7c485a457c4696d,What number of patients stayed in med/surg/gyn?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT SUM(med_surg) AS MedSurg, SUM(gyn) AS GYN FROM `physionet-data.mimiciv_clinical.admissions` WHERE med_surg IS NOT NULL OR gyn IS NOT NULL"
f8d725f820917d71a5301983,When was the first time when patient 10019568 had the minimum value of ptt?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],
85217448903d24f91d5ea081,What is the maximum total hospital cost for a person with streptococcal septicemia since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'streptococcal septicemia' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_hospital_cost) FROM inpatient_records WHERE condition = 'streptococcal septicemia' AND admission_date >= '2100-01-01'
7b241688629b0769f326af90,Has patient 10005909 had lab testing since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y',labevents.charttime) >= '2100'",[{'COUNT(*)>0': 1}],SELECT COUNT(*) FROM lab_events WHERE patient_num = '10005909' AND event_date > '2100-01-01'
3472f6614f855a1f74a08298,Has patient 10005866 been admitted to the emergency room since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT(*)>0': 0}],select * from admissions where patient_id='10005866' and service='ER' and date>='2100-01-01'
2a21e251ed3b120d205aa09a,When was patient 10035185's first input time since 04/13/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-13' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2120-05-13 17:26:00'}],SELECT MIN(input_time) AS first_input_time_since_date FROM `physionet-data.mimiciii_clinical.icustays` WHERE subject_id = 10035185 AND intime >= '04/13/2100'
26f7019ccc450e407b7f54db,Give me the top five most common lab tests since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT lab_test, COUNT(*) AS test_count FROM lab_results WHERE lab_date >= '2100-01-01' GROUP BY lab_test ORDER BY test_count DESC LIMIT 5"
bbd83d8b93e5221cf79488b1,What was the name of the output the last time patient 10029484 had since 11/10/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-10' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Void'}],"SELECT TOP 1 name FROM `output` WHERE `patient_id` = 10029484 AND `datetime` > ""2010-11-10"" ORDER BY `datetime` DESC"
9be85669c081afc82d4c6a57,"Count the number of patients who received a assistance with cardiac output using balloon pump, continuous procedure.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) as number_of_patients from procedures where assistance = 'cardiac output' and device = 'balloon pump' and type = 'continuous'
6e4750dd27d5b6fd5f5faf2e,How many patients received a d-dimer lab test since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'd-dimer' ) AND strftime('%Y',labevents.charttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],
122e9c77f038fff730af3012,How many patients were discharged from hospitals since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],"SELECT COUNT(DISTINCT patient_id) FROM hospital_discharges WHERE discharge_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR)"
6e40bf924c854c6bb7c3d749,When was first time the respiratory rate of patient 10020740 was greater than 17.0 on 06/15/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 17.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '06-15' ORDER BY chartevents.charttime ASC LIMIT 1",[],select distinct visit_id from visit_occ where patient_num=10020740 and visit_date='2023-06-15' and visit_occ_id in (select visit_occ_id from visit_detail where detail_num in (select detail_num from detail where detail in ('resp rate')) and value_num > 17.0)
26a928038c08abff85fc25c5,What were the total amount of or crystalloid intake input that patient 10018845 received since 02/12/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-12'",[{'SUM(inputevents.totalamount)': None}],"SELECT SUM(intake_amount) FROM patient_intake WHERE patient_id = '10018845' AND intake_date >= '02/12/2100' AND intake_type IN ('or', 'crystalloid')"
4ee0ef355bae021a512da458,"What was the first time that patient 10031757 was prescribed acetaminophen and phosphorus since 10/2100, at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phosphorus' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],[SELECT MIN(e1.event_time) AS FirstPrescriptionTime
24dea0b7b119c44087400b3d,What was the first measured value of heart rate for patient 10039831 on their current ICU visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],"SELECT MIN(measurement_datetime) AS FirstMeasurementTime, MIN(heart_rate) AS FirstHeartRateValue FROM icd.ahs_intensive_care WHERE patientunitstayid = 10039831 AND measurement_concept_id = 807108 AND measurement_datetime >= (SELECT MIN(intime) FROM icd.stays WHERE patientunitstayid = 10039831) ORDER BY measurement_datetime ASC LIMIT 1"
98718dac8212efcff4207af5,"On the last hospital stay, how much amitriptyline has been prescribed to patient 10002930 in total?",SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'amitriptyline',[{'SUM(prescriptions.dose_val_rx)': None}],select sum(Quantity) from AdmittedPatients a left join Prescriptions p on a.PatientID = p.PatientID where a.PatientID = '10002930' and a.AdmissionID in (select max(AdmissionID) from AdmittedPatients where PatientID = '10002930') and p.Medication = 'amitriptyline'
fa03821db7826057951a8f17,"What are the four most commonly prescribed medications for patients who were diagnosed with percutaneous transluminal coronary angioplasty status previously within 2 months, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'percutaneous transluminal coronary angioplasty status' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 drug FROM medical_records WHERE diagnosis = 'percutaneous transluminal coronary angioplasty status' AND prescription_date BETWEEN DATEADD(month, -2, GETDATE()) AND DATEADD(year, -1, GETDATE()) GROUP BY drug ORDER BY COUNT(*) DESC"
46a747d7b9992bd3eae9d736,Did patient 10022880 get a diagnosis during the first hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT DISTINCT(Diagnosis) FROM MedicalRecords WHERE PatientID = '10022880' AND VisitNumber = 1
35b0b505d474e73b841b45f6,What was the last weight of patient 10029291 recorded since 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1",[],select weight from patient_records where patient_id = '10029291' and record_date >= '03/2100' order by record_date desc limit 1
7151c86b2f910d26891150a0,Can you confirm the gender of patient 10026354?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10026354,[{'gender': 'M'}],select gender from patient where patient_id = '10026354'
cdf6333e8b6736879a871a9a,Calculate patient 10004720's total amount of tf residual output on this month/07.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tf residual' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '07'",[{'SUM(outputevents.value)': None}],SELECT SUM(amount) FROM tf_residual_output WHERE patient_id = 10004720 AND MONTH(date) = 7 AND YEAR(date) = YEAR(CURRENT_DATE)
0d923876f67a35e78f8044b8,What was the name of the drug that was prescribed to patient 10021487 last time through the iv route since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT medication_name FROM prescriptions WHERE patient_id = 10021487 AND administration_route = 'IV' AND order_date > '12/2100' ORDER BY order_date DESC LIMIT 1
38b98518dde0e0d276fdf109,Tell me the name of the diagnosis that patient 10020786 received the first time during their first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,[SELECT diagnosis_name FROM (
eddd42b7835d2666ea1728ba,Tell me the number of patients who were prescribed magnesium oxide during the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'magnesium oxide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) AS patient_count FROM prescriptions WHERE medication_name = 'magnesium oxide' AND prescription_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
66e17c14c6b5f8370524c964,How much does it cost for a acute and chronic cholecystitis diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and chronic cholecystitis' ) ),,SELECT cost FROM medical_costs WHERE diagnosis = 'acute and chronic cholecystitis';
be9080e8bd4d6236bf72ed25,What was a drug that patient 10021487 was prescribed for in the same day after receiving arterial catheterization since 2 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-2 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,"[SELECT DISTINCT d.drug, d.date"
fdc2cf2c322ae8d1a991cb88,"Since 01/2100, how much did patient 10031757 weigh during the first measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' ORDER BY chartevents.charttime ASC LIMIT 1",[],select weight from vitals where patient_id = '10031757' and vitals.visit_start_date = (select min(visit_start_date) from vitals where patient_id = '10031757' and visit_start_date >= '2001-01-01')
ef1717a5f8cb73c78748607d,What is the disinfection technique in a quarantine room??,,,select disinfection_technique from quarantine_room
0c36b014ddebc557e87c1e72,List the top five diagnoses that have the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT Diagnosis, COUNT(*) AS MortalityCount FROM Patients WHERE DateOfDiagnosis BETWEEN DATE_SUB(CURDATE(), INTERVAL 6 MONTH) AND CURDATE() AND Outcome = 'Deceased' GROUP BY Diagnosis ORDER BY MortalityCount DESC LIMIT 5"
5ec192bf57a5dff7718502ec,Calculate the length in days of patient 10031757's last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.1996527779847383}]","SELECT DATEDIFF(day, MAX(AdmitDTS), DischDTS) AS LengthOfLastStayInDays FROM Epic.Encounter WHERE PatientID = '10031757' AND Unit = 'ICU' GROUP BY PatientID, DischDTS ORDER BY DischDTS DESC LIMIT 1"
314415a08a9c1d6bd28fe89e,What should be done to stay safe after the cont inv mec ven <96 hrs?,,,SELECT action FROM safety_guidelines WHERE condition = 'cont inv mec ven <96 hrs'
054b6f8bf46fb8b641b71498,What is the name of the drug that should not be administered during the endovasc embol hd/nk ves?,,,SELECT drug_name FROM treatment_protocols WHERE treatment_name = 'endovasc embol hd/nk ves' AND contraindicated = TRUE
9b96ce996e808fd4f87d1eee,What was the total tf residual output in patient 10020944 in their first ICU visit?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tf residual' AND d_items.linksto = 'outputevents' ),[{'SUM(outputevents.value)': None}],select sum(tf_residual) from patient_data where patient_id = 10020944 and visit_number = 1
74504b66834c2700e6349766,What is the percentile urea nitrogen value of 17.0 among patients of the same age as patient 10004733 on the current hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 17.0",,SELECT NTILE(100) OVER (ORDER BY UreaNitrogen ASC) AS Percentile FROM LabResults WHERE PatientID IN (SELECT PatientID FROM Patients WHERE Age = (SELECT Age FROM Patients WHERE PatientID = '10004733')) AND LabName = 'Urea Nitrogen' AND EncounterID = (SELECT MAX(EncounterID) FROM Encounters WHERE PatientID = '10004733')
4d4dd766a53d16c73dfa5445,Tell me the total number of patients who were diagnosed with diplopia in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diplopia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )",,
0d8c124936a0fc726774b99e,What were the top three most frequently prescribed medicines in 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3",[],SELECT * FROM prescriptions WHERE year = '2100' ORDER BY frequency DESC LIMIT 3
48b89e86915910878671569f,How much was the difference in diastolic blood pressure of patient 10008287 last measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",[SELECT MAX(dia_bp) - MIN(dia_bp) AS diastolic_pressure_difference
9074ac00135a21bec34e6199,Give me the total volume of output for patient 10022880 on 04/03/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '04-03'",[{'SUM(outputevents.value)': None}],total volume of output
2dcb5e76008ed58c6fcf21ab,How many patients were prescribed the drug polyethylene glycol since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'polyethylene glycol' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT count(DISTINCT patients.patientid) FROM patients INNER JOIN prescriptions ON patients.patientid = prescriptions.patientid WHERE prescriptions.drug = 'polyethylene glycol' AND prescriptions.prescriptiondate >= DATEADD(year, -1, GETDATE())"
c7b252f65de6eab4598bf4ae,When was the last time yesterday that patient 10018081's systolic blood pressure was measured greater than 88.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 88.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(measurementdate) FROM bloodpress WHERE patientid = '10018081' AND Systolic > '88.0' AND measurementdate > DATE('now', '-2 day') AND measurementdate < DATE('now', '-1 day');"
f056ac2de0d1253ccdc6c556,Could you provide me with the three most frequent output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT output_events, COUNT(*) AS frequency FROM event_log WHERE date >= '2100-01-01' GROUP BY output_events ORDER BY frequency DESC LIMIT 3;"
19dd65ead0ee8862ebf01011,What was the accumulated output for patient 10039831 since 10/26/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-26'",[{'SUM(outputevents.value)': 6680.0}],SELECT SUM(output) FROM patient_data WHERE patient_id = 10039831 AND date >= '2100-10-26'
45de049f9307b8c592a68f2c,What is the total number of patients discharged from the hospital in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM hospital_discharges WHERE discharge_year = 2100
2a1243e7e7beeb3198544ff2,"Tell me the name of the prescription drug that patient 10015931 was prescribed in the same day after having a replacement of aortic valve with zooplastic tissue, percutaneous approach procedure since 4 months ago?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-4 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-4 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,"SELECT name FROM prescription_drugs WHERE patient_id = 10015931 AND prescription_date = (SELECT procedure_date FROM procedures WHERE patient_id = 10015931 AND procedure_type = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' AND procedure_date >= DATE_SUB(CURRENT_DATE, INTERVAL 4 MONTH))"
aea39d595c762f58e94e6bc6,What was patient 10021312's first measured absolute eosinophil count since 01/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01' ORDER BY labevents.charttime ASC LIMIT 1",[],Your SQL query here
a7f9bb55036040073e02ba0e,Find the number of current patients in the 20s age group.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 20 AND 29,,SELECT COUNT(*) FROM patients WHERE age BETWEEN 20 AND 29 AND current_status = 'current'
f859ac724e0f730a950f3efa,When was patient 10012552 discharged from the hospital for the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012552 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(date_of_discharge) FROM patient_discharge_records WHERE patient_id = 10012552
eb546f4e23ee7c0f0ace4e68,Do you suppose patient 3369 has experience side effects during a blood transfusion?,,,SELECT has_experienced_side_effects FROM blood_transfusion_data WHERE patient_id = 3369;
08e4e46ffbf10a71b11cc538,What was the amount of glucose gel dose prescribed to patient 10016150 during their last hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'glucose gel',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT * FROM encounters WHERE patient_id = '10016150' ORDER BY visit_date DESC LIMIT 1; WITH last_encounter AS (SELECT * FROM encounters WHERE patient_id = '10016150' ORDER BY visit_date DESC LIMIT 1) SELECT prescribed_dose FROM treatments WHERE encounter_id = (SELECT encounter_id FROM last_encounter) AND treatment_name = 'Glucose Gel Dose';
70b43bd19ed867f8f2420003,Has patient 10024043 come to the ER in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM EmergencyRoomVisits WHERE patient_id = '10024043' AND YEAR(visit_date) = 2100;
224e861c8a991fe5103027e4,Was patient 10020944 to the emergency room on their first hospital visit?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'COUNT(*)>0': 0}],[SELECT CASE WHEN EXISTS (
2bb75165325ab535ac14bae8,When did patient 10031757 have the bands lab test for the first time in 10/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bands' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime ASC LIMIT 1",[],select labtest_date from lab_tests where patient_id = 10031757 and labtest_name = 'bands' order by labtest_date asc limit 1
217aba84a14d98a4827d6be1,"What are the five commonly taken specimens for patients that were diagnosed with other disorders of neurohypophysis previously during the same hospital encounter, since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other disorders of neurohypophysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,select top 5 distinct specimen from labevents where hadm_id in (select hadm_id from diagnosis_icd where icd9_code in (select icd9_code from d_icd_diagnoses where category in ('other disorders of neurohypophysis') and icd9_code not like 'E%' and icd9_code not like 'V%' and icd9_code not like 'Y%')) and charttime between '2100' and '2400' and itemid in (select itemid from d_labitems)
dc99421b0fa75072b7fc597f,Which method of disinfection in the quarantine room is?,,,SELECT disinfection_method FROM Quarantine_Rooms WHERE room_number = 'Q123'
ba575890ff7ebaa1dcaa88c2,How many artificial tear ointment prescription instances occurred?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'artificial tear ointment',[{'COUNT(*)': 0}],SELECT COUNT(*) AS NumberOfPrescriptions FROM Prescription WHERE DrugName = 'Artificial Tear Ointment'
c0684c1ca2e984f005e2f914,What are five of the most frequent specimens taken since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]","select specimen, count(specimen) from specimen group by specimen order by count(specimen) desc limit 5;"
721e100bb5221ab0b783efb9,How much does it cost to get diagnostic of type 2 diabetes mellitus without complications?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus without complications' ) ),,SELECT charge FROM medical_services WHERE service_name = 'Type 2 Diabetes Mellitus Diagnosis Without Complications'
1f40a273d375689f569acb2e,What culture was patient 10016742 last tested during their first hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'spec_type_desc': 'STOOL'}],SELECT top_1(culture) FROM lab_results WHERE patient_id = 10016742 AND visit_number = 1 ORDER BY test_date DESC
750dbf95a8c1c5e4d75ecefe,How many times was patient 10023239 in the hospital this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023239 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT count(*) as HospitalVisits FROM HospitalVisits WHERE PatientID = '10023239' AND VisitDate >= '2023-01-01' AND VisitDate <= CURRENT_DATE;
7671f2895af9f8efa4666e20,"How many days has it been since the first time in their current hospital visit that patient 10004733 was diagnosed with hemiplegia, unspecified, affecting unspecified side?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified, affecting unspecified side' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,select count(*) as days_since_first_hemiplegia_diagnosis from (select distinct service_date from patient_visits where patient_id = 10004733 and service_date >= (select min(service_date) from patient_diagnoses where patient_id = 10004733 and diagnosis_code = 'hemiplegia unspecified affecting unspecified side' and visit_id = (select visit_id from patient_visits where patient_id = 10004733 and service_date = (select min(service_date) from patient_visits where patient_id = 10004733))) and visit_id = (select visit_id from patient_visits where patient_id = 10004733 and service_date = (select min(service_date) from patient_visits where patient_id = 10004733))) as visit_dates
b8b17acef0f82e15a62e972b,"Has patient 10010471 been ordered bag, ipratropium-albuterol neb, or ferric gluconate in 05/this year?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.drug IN ( 'ipratropium-albuterol neb', 'bag', 'ferric gluconate' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05'",[{'COUNT(*)>0': 0}],
b6ebd9e060d890c353600a6a,What was the first measurement of respiratory rate that patient 10008287 had since 268 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-268 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT * FROM measurements WHERE patient_id = 10008287 AND measurement_type = 'Respiratory Rate' AND measurement_date >= DATE_SUB(CURRENT_DATE, INTERVAL 268 DAY) ORDER BY measurement_date ASC LIMIT 1;"
22458c7e5433bc48eeb5f97c,When was the last time the systolic blood pressure of patient 10002495 was measured at a reading less than 101.0 on the last ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 101.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],"SELECT MAX(b.time) AS last_measurement_time FROM t_icuadmissions a, t_labs b WHERE a.icustay_id = b.icustay_id AND a.subject_id = 10002495 AND a.hadm_id = b.hadm_id AND b.result < 101.0 AND a.intime = (SELECT MAX(intime) FROM t_icuadmissions WHERE subject_id = 10002495)"
4fc4a020a5a905fbea065ca7,Show me the length of stay in days of patient 10037975 from the first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.87824074132368}]","SELECT SUM(DATEDIFF(discharge_date, admission_date)) AS length_of_stay_days FROM icu_stays WHERE patient_id = 10037975 ORDER BY admission_date ASC LIMIT 1"
c2f2672cddbd186cf0790169,What are the top four most frequently prescribed drugs?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]","SELECT drug_name, COUNT(*) as prescription_count FROM prescriptions GROUP BY drug_name ORDER BY prescription_count DESC LIMIT 4;"
f806b5540e6d98bc7a994ad3,What is the cost of a surgery called laparoscopic cholecystectomy?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) ),,SELECT cost FROM medical_procedures WHERE procedure_name = 'laparoscopic cholecystectomy' AND procedure_type = 'surgery'
f0a44b72608f1fb8a8a9bebc,Calculate the number of patients with other alteration of consciousness who were diagnosed since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other alteration of consciousness' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,SELECT count(*) FROM patient_records WHERE diagnosis_date > '2100-01-01' AND diagnosis_category = 'Other alteration of consciousness';
c6e9f8b7ab342b4f62878e06,When was the last time that patient 10007058 was prescribed medication since 03/2100 via the po route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(date_prescribed) AS last_prescription_date FROM prescriptions WHERE patient_id = '10007058' AND route = 'po' AND date_prescribed >= '03-2100-00'
7866a9173d7aff1bce72d3a6,What was the name of the specimen test that patient 10020944 had for the last time since 03/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'STOOL'}],SELECT Name FROM SpecimenTest WHERE PatientID=10020944 AND TestDate = (SELECT MAX(TestDate) FROM SpecimenTest WHERE PatientID=10020944 AND TestDate >= '03/2100')
2f22847b30b971f2903664c3,When was patient 10021118's last microbiological examination since 06/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2161-11-19 12:30:00'}],SELECT MAX(date) FROM microbiological_examinations WHERE patient_id = '10021118' AND date > '2100-06-01'
3377c0495e0a4873b8d561c0,Tell me the maximum SaO2 for patient 10027602's body on last month/25?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '25'",[{'MAX(chartevents.valuenum)': None}],select max(saO2) from [TABLE_ID
5f0250669656b6e45463dfba,"Name the four most frequently prescribed drugs within 2 months following a diagnosis of polyneuropathy, unspecified this year.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 medication_name, COUNT(medication_name) AS prescription_count FROM prescriptions WHERE diagnosis_code = (SELECT code FROM diagnoses WHERE description = 'polyneuropathy, unspecified') AND prescription_date BETWEEN DATEADD(MONTH, -2, GETDATE()) AND GETDATE() GROUP BY medication_name ORDER BY prescription_count DESC"
4171edfb2349dc1b264cd1dd,When did patient 10007818 have the first body temperature less than 98.9?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 98.9 ORDER BY chartevents.charttime ASC LIMIT 1,[],select date from temperature where patientid = 10007818 and temp < 98.9 order by date limit 1
0114a64085ec7d751f6e1bfd,What was the change in respiratory rate in patient 10026406 measured at 2100-01-12 13:00:00 compared to the value measured at 2100-01-12 12:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 13:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 12:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 13:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 12:00:00' )"": None}]",select `value` from `t1` where `itemid`=454 and `charttime`='2100-01-12 13:00:00' and `subject_id`=10026406 and `itemid` in (select `itemid` from `t1` where `subject_id`=10026406 and `itemid`=454 and `charttime`='2100-01-12 12:00:00') - (select `value` from `t1` where `itemid`=454 and `charttime`='2100-01-12 12:00:00' and `subject_id`=10026406)
be4864408d7e9c4cb2d27c8a,"Was the value of patient 10022017's chloride, whole blood second measured on the last hospital visit greater than the value first measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN MAX(CASE WHEN test_result_order = 2 THEN test_result END) > MAX(CASE WHEN test_result_order = 1 THEN test_result END) THEN 'Yes' ELSE 'No' END AS IsSecondMeasurementGreater FROM `physionet-data.mimiciii_clinical.labevents` WHERE subject_id = 10022017 AND itemid = 50814 AND hadm_id IN (SELECT hadm_id FROM `physionet-data.mimiciii_clinical.admissions` WHERE subject_id = 10022017 ORDER BY deathtime DESC, dischargetime DESC LIMIT 1)"
1533d0cd76139eb1dd097047,When was the first time patient 10020740 was measured with a heart rate greater than 65.0 on 03/28/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 65.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-28' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT measurement_date FROM patient_measurements WHERE patient_id = 10020740 AND measurement_type = 'heart_rate' AND measurement_value > 65.0 AND measurement_date = '03/28/2100' ORDER BY measurement_date ASC LIMIT 1
37cae934208b2a009d5fa703,Has patient 10038081 received any other endoscopy of small intestine treatment since 1 year ago?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,SQL query
935c667c51ade2f8d9a18b79,"Calculate the number of inspection of larynx, via natural or artificial opening endoscopic procedures performed since 2100.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of larynx, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,select count(*) from lab where lab.name like '%larynx%' and lab.date >= '2100-01-01' and lab.name like '%endoscopic%'
a3703a6f4da15988521301ef,List the top four diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT diagnosis, ROUND((3m_mortality/total)*100,2) AS mortality_rate FROM (SELECT diagnosis, SUM(3m_mortality) AS 3m_mortality, SUM(total) AS total FROM (SELECT diagnosis, COUNT(CASE WHEN death_in_3m = 'Yes' THEN 1 END) AS 3m_mortality, COUNT(*) AS total FROM patient_data GROUP BY diagnosis) subquery GROUP BY diagnosis) subquery2 ORDER BY mortality_rate DESC LIMIT 4;"
8521d760a18e114ce1c608b3,What is patient 10039997's gender?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10039997,[{'gender': 'F'}],SELECT gender FROM patient WHERE patient_id = '10039997'
609e5996320873f84ea60fe9,When was patient 10004733 prescribed the drugs heparin flush (100 units/ml) and vancomycin at the same time for the last time since 10/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin flush (100 units/ml)' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"select top 1 a.admit_date as last_admit_date, a.discharge_date as last_discharge_date from patient_encounter a inner join patient_medication b on a.patient_id = b.patient_id and a.encounter_id = b.encounter_id where a.patient_id = 10004733 and (b.medication_name = 'heparin flush (100 units/ml)' or b.medication_name = 'vancomycin') group by a.admit_date, a.discharge_date having count(distinct b.medication_name) = 2 order by a.admit_date desc"
782822c98c2534ba56c1c45b,What were the top five diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT Diagnosis, COUNT(Death) AS Deaths, COUNT(Death) * 1.0 / COUNT(PatientID) AS MortalityRate FROM PatientRecords WHERE DATEDIFF(month, AdmissionDate, DeathDate) <= 6 AND Death IS NOT NULL GROUP BY Diagnosis ORDER BY MortalityRate DESC LIMIT 5"
00bbbffdff5ee0427911211a,What was the output of patient 10027602 for the last time on this month/03?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '03' ORDER BY outputevents.charttime DESC LIMIT 1 )",[],SELECT output FROM measurements WHERE patient_id = 10027602 AND MONTH(measurement_date) = MONTH(CURDATE()) AND YEAR(measurement_date) = YEAR(CURDATE()) ORDER BY measurement_date DESC LIMIT 1
f6b867f588ae42e84d410450,What are the three most often performed treatments for patients aged 60 or above since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT Treatment.Name, COUNT(*) AS Frequency FROM Treatment JOIN Patient ON Treatment.PatientID = Patient.ID WHERE Patient.Age >= 60 AND Treatment.Date >= DATEADD(year, -1, GETDATE()) GROUP BY Treatment.Name ORDER BY Frequency DESC LIMIT 3"
06c554d6edfd2380ecdb7e9f,"Show me the top four most commonly prescribed drugs during the same hospital encounter to the patients aged 40s after diagnosed with alcohol abuse, unspecified since 1 year ago.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,SQL Query Here
b69d13810f1abe3029a6d7ba,What is the minimum total cost of the hospital visits include the medicine named prismasate (b32 k2) since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prismasate (b32 k2)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_cost) AS minimum_total_cost FROM visits JOIN medicines ON visits.visit_id = medicines.visit_id WHERE medicines.name = 'prismasate (b32 k2)' AND visits.visit_date > '2100-01-01'
c21cf578f81ff7a390dc8596,"What is the cost of a malignant neoplasm of lower lobe, bronchus or lung diagnosis?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower lobe, bronchus or lung' ) )",,"SELECT Cost FROM DiagnosisCosts WHERE DiagnosisName = 'Malignant neoplasm of lower lobe, bronchus or lung'"
5a4f493fdb61cf9a1f898407,Tell me the protocol of the anticancer drug?,,,SELECT protocol FROM anticancer_drugs
9c299b7dcbfbd561bf0f6f6b,When did patient 10038081 last have a blood culture microbiology test in 09/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(visit_start_date) FROM `physionet-data.mimiciii_clinical.labevents` WHERE subject_id = 10038081 AND itemid = 807 and (visit_start_date BETWEEN '2009-01-01' AND '2009-12-31')
22f424d1096d768470e60a6d,"What are the four most commonly tested specimens for patients who were diagnosed with chronic lymphocytic leukemia of b-cell type not having achieved remission previously in the same month, in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic lymphocytic leukemia of b-cell type not having achieved remission' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,SQL Query Here
6f8ec1a440771aa4151d974e,What was the drug that was prescribed to patient 10020740 for the last time in 03/2100 via the po route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",[],"SELECT drug_name FROM prescriptions WHERE patient_id = 10020740 AND route = 'po' AND prescription_date = (SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = 10020740 AND date_part('month', prescription_date) = 3 AND date_part('year', prescription_date) = 2100)"
40f923d3ceb04e98040b7c3e,Has patient 10007818 been tested on 25-oh vitamin d since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '25-oh vitamin d' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'",[{'COUNT(*)>0': 0}],select * from `patser` where patient_id = '10007818' and lab_test_name like '%25-oh vitamin d%' and lab_test_date >= '2010-04-01' limit 10
f54bb9ca547f05441bb1ce7d,"What is the diagnosis price for closed dislocation, multiple cervical vertebrae?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed dislocation, multiple cervical vertebrae' ) )",,SQL Query
412c09bd6869eec57b61b8ab,What are the top five most frequent microbiology tests in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",[],SQL Query
5d5185c385123b16a09f65af,Has any prescription drug been given to patient 10005909 during this year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT * FROM prescriptions WHERE patient_id = 10005909 AND YEAR(prescription_date) = YEAR(CURDATE()) AND drug_type = 'Prescription';
1e7e5b854e3946d368c6016f,Find the number of current patients in the 50s age group.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,,SELECT COUNT(*) FROM patients WHERE age >= 50 AND age < 60 AND status = 'current'
9b2ab198452a5ac2f78b9ebf,Could you provide the top five most common output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT event, COUNT(*) AS frequency FROM events WHERE event_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY event ORDER BY frequency DESC LIMIT 5"
3dcaebddfb2987ddb1dc6ae7,Show me patient 10018081's daily average weight in 2100.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT patient_id, AVG(weight) AS daily_avg_weight FROM patient_data WHERE patient_id = 10018081 AND YEAR(measurement_date) = 2100 GROUP BY patient_id, DATE(measurement_date)"
1413d85d169629ef664b2b96,How much is the cost for the drug nystatin cream?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nystatin cream' ),,SELECT cost FROM drugs WHERE name = 'nystatin cream'
7bd54b9aeab884f12aad013d,What are the single rooms that are currently available?,,,SELECT * FROM rooms WHERE type = 'single' AND status = 'available';
d73922f383164918bb919ccd,How many current patients fall into the 30s age group?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,,SELECT COUNT(*) FROM CurrentPatients WHERE Age BETWEEN 30 AND 39
0822c127d758cb84c86208ab,How old was patient 10023117 during their first hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,,SELECT age FROM patient_encounters WHERE patient_id = 10023117 ORDER BY encounter_date ASC LIMIT 1
efd5c9c44ecab92af5e496fa,In what ways can phenazopyridine be ingested?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'phenazopyridine',[{'route': 'ORAL'}],SELECT DISTINCT IngestionMethod FROM DrugUsage WHERE DrugName = 'phenazopyridine' AND IngestionMethod IS NOT NULL
3c0cb65bd0831752922d8073,Is patient 3273 aware of any ill effects of blood transfusion?,,,SELECT COUNT(*) FROM `Patient_Feedback` WHERE `Patient_ID` = 3273 AND `Feedback_Text` LIKE '%ill effects of blood transfusion%'
112cb104c8ac40bc947d642a,Calculate the number of patients staying in med/surg during this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from [mimiciv
af707d41fac6dee4c1688787,"Since 11/2100, when was patient 10021487's first microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2116-12-03 01:16:00'}],SELECT MIN(Date) FROM microbiology_tests WHERE Patient_ID = '10021487' AND Date >= '11/2100';
2eb3e9db6880c98531ae9697,What were some of the five common specimen tests given?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]",select top 5 test_type from speciments order by test_type
683c48b602131b125efece68,"For the last time in 03/this year, when was patient 10019777 prescribed vancomycin and iso-osmotic dextrose at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic dextrose' AND admissions.subject_id = 10019777 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(prescription_date) FROM patient_prescriptions WHERE patient_id = 10019777 AND (medication_name = 'vancomycin' OR medication_name = 'iso-osmotic dextrose') AND YEAR(prescription_date) = YEAR(CURRENT_DATE) GROUP BY patient_id HAVING COUNT(DISTINCT medication_name) = 2
bbd2daaab53a49a1140c416c,What did patient 10022041 get diagnosed with in the last hospital encounter for the first time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,SQL Query goes here
fc72497b8c3f4de11b1c418f,Tell me the percentile of the magnesium value of 2.4 among patients of the same age as patient 10011398 during the last hospital visit.,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.4",,SELECT PERCENT_RANK() OVER (ORDER BY magnesium) AS percentile_rank FROM blood_test_results WHERE patient_id = 10011398 AND visit_id = (SELECT MAX(visit_id) FROM blood_test_results WHERE patient_id = 10011398) AND age = (SELECT age FROM patients WHERE patient_id = 10011398) AND magnesium = 2.4;
937063660ee9c96fa16dd7f5,Calculate the number of people who had other and unspecified pneumonectomy in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other and unspecified pneumonectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )",,select count(*) as count from dars_nic_391419_j3w9t_collab.covid_deaths where other_specified_pneumonectomies = '2100'
5f397d9337e3f7c527ae89c4,Show the weight changes of patient 10019172 second measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT hospital_visits.patient_id, hospital_visits.visit_date, hospital_measurements.weight, hospital_measurements.measurement_sequence, (hospital_measurements.weight - LAG(hospital_measurements.weight) OVER (PARTITION BY hospital_measurements.patient_id, hospital_measurements.visit_date ORDER BY hospital_measurements.measurement_sequence)) AS weight_change FROM hospital_visits INNER JOIN hospital_measurements ON hospital_visits.visit_id = hospital_measurements.visit_id WHERE hospital_visits.patient_id = 10019172 AND hospital_measurements.measurement_type = 'Weight' AND hospital_measurements.measurement_sequence IN (1,2) ORDER BY hospital_visits.visit_date DESC, hospital_measurements.measurement_sequence LIMIT 1"
99302cc231fc961e9d68c413,Tell me the time when patient 10014729's SaO2 was less than 95.0 for the last time on 03/06/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 95.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-06' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT MAX(measurement_time) FROM (SELECT measurement_time FROM ecg_measurements WHERE patient_id = 10014729 AND measurement_time <= '03/06/2100' AND measurement_type = 'SaO2' AND measurement_value < 95.0) AS subquery
1a9e4c04cde439b3eb51a5ee,Could you tell me the top five most common procedures for patients aged 20s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"[SELECT TOP 5 procedure_name, COUNT(*) as procedure_count"
e487dbd0cdcc7e16522be18e,"In 2100, what are the top five most common microbiology tests that patients were diagnosed with in the same month after being diagnosed with personal history of malignant neoplasm of tongue?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of tongue' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 TestName, COUNT(*) as NumberOfTests FROM PatientTests WHERE DiagnosisCode = 'C02' AND TestDate > PatientDiagnosisDate AND YEAR(TestDate) = 2100 GROUP BY TestName ORDER BY NumberOfTests DESC"
4a6a55a4bf98ebabca394606,Is there a genetic test that patient 83062 recieved?,,,SELECT * FROM `genetic_tests` WHERE `patient_id` = 83062 LIMIT 1
4449c0b54dc6e4a7af5dc9d8,What was the first value of a myelocytes lab test of patient 10004235 during their last hospital visit?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'myelocytes' ) ORDER BY labevents.charttime ASC LIMIT 1,[],select top 1 l.value from lab_tests l where l.patient_id = '10004235' and l.test_name = 'myelocytes' and l.visit_id = (select max(visit_id) from lab_tests where patient_id = '10004235') order by l.test_date asc
07cfa2305771336777be3c17,How many current patients are there that are 60 or above?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,,SELECT COUNT(*) FROM patients WHERE age >= 60 AND status = 'current'
57ee9b35377fe295adfbf9c1,How much did patient 10031404 weigh during their last measurement since 21 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-21 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT weight FROM patient_measurements WHERE patient_id = 10031404 AND measurement_date > DATEADD(month, -21, GETDATE()) ORDER BY measurement_date DESC LIMIT 1"
1403522fcefbc7af92918f1c,"What was the drug that patient 10019385 was prescribed with within the same day after the performance of cardiac output, continuous in 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,SELECT drug_name FROM prescriptions WHERE patient_id = 10019385 AND prescription_date = (SELECT prescription_date FROM cardiac_output WHERE patient_id = 10019385 AND continuous = 1 AND date = '03/2100')
6cadd9bbd8f4e8547babc4a4,Has patient 10019172 undergone the extraction of other tooth procedure in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extraction of other tooth' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,"Select distinct encounterid from emr.encounter where patientid='10019172' and date>='2100-01-01' and date<='2100-12-31' and ICD9 in ('D7110', 'D7140')"
0664f9448edc539d0cb228a4,What was the admission type for patient 10038933's last visit to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038933 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1",[],SELECT `admission_type` FROM `visits` WHERE `patient_id` = 10038933 ORDER BY `visit_date` DESC LIMIT 1
8a93df214af665f8defd91d1,What was the change in systolic blood pressure in patient 10037975 second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT patient_id, visit_id, measurement_id, systolic_bp, (systolic_bp - FIRST_VALUE(systolic_bp) OVER (PARTITION BY patient_id, visit_id ORDER BY measurement_datetime ASC)) AS bp_change FROM blood_pressure_measurements WHERE patient_id = 10037975 AND visit_id = (SELECT MIN(visit_id) FROM blood_pressure_measurements WHERE patient_id = 10037975) AND measurement_id = 2 ORDER BY measurement_datetime ASC LIMIT 1"
53b45637910db65da16c946b,What procedure was given to patient 10029291 two or more times since 30 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"SELECT Procedure FROM PatientRecords WHERE PatientID = 10029291 AND ProcedureDate > DATE_SUB(CURDATE(), INTERVAL 30 MONTH) GROUP BY Procedure HAVING COUNT(Procedure) > 1;"
6767d8e3b7af5307480d3e8c,How many patients in 2100 received percutaneous abdominal drainage in the same hospital encounter after being diagnosed with unspecified viral hepatitis c with hepatic coma?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c with hepatic coma' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,SELECT COUNT(*) FROM patient_records WHERE diagnosis LIKE '%unspecified viral hepatitis c with hepatic coma%' AND procedure LIKE '%percutaneous abdominal drainage%' AND encounter_hospital_id IS NOT NULL AND EXTRACT(YEAR FROM encounter_date) = 2100
59b4f366d08a05218ec8287d,Tell me the top three most common lab tests since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(*) AS test_count FROM lab_tests WHERE test_date >= NOW() - INTERVAL 1 YEAR GROUP BY test_name ORDER BY test_count DESC LIMIT 3"
8b3ac39d04cb2b0c9c7c2ef7,"How many patients underwent a extirpation of matter from left femoral vein, percutaneous approach during the same month after the diagnosis of other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT COUNT(DISTINCT a.patient_id) FROM admissions a JOIN diagnoses d ON a.admission_id = d.admission_id AND d.code = 'OTHER_SURG_PROC_AS_CAUSE' AND d.diagnosis_date BETWEEN a.admission_date AND DATE_ADD(a.admission_date, INTERVAL 1 MONTH) JOIN procedures p1 ON a.patient_id = p1.patient_id AND p1.code = 'EXTIRPATION_OF_MATTER_FROM_LEFT_FEMORAL_VEIN_PERCUTANEOUS' AND p1.procedure_date BETWEEN d.diagnosis_date AND DATE_ADD(d.diagnosis_date, INTERVAL 1 MONTH) JOIN procedures p2 ON a.patient_id = p2.patient_id AND p2.code = 'ABN_REACT_OTHER_SURG_PROC_CAUSE' AND p2.procedure_date BETWEEN a.admission_date AND p1.procedure_date WHERE p1.note NOT LIKE '%misadventure%';"
e15aa00add2d775e41bd5338,Has patient 10004720 been prescribed any prescription drugs since 09/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'",[{'COUNT(*)>0': 1}],SELECT * FROM prescription_records WHERE patient_id = 10004720 AND prescription_date >= '2100-09-01'
a512e2c581e537c6e95d2626,Whats the pre serum transfusion nec checklist?,,,SELECT PreSerumTransfusionNecChecklist FROM Checklists WHERE ChecklistType = 'Nec'
70935d34cbc96deade5c1b18,"Is the value of patient 10007818's mesothelial cell, last measured on the first hospital visit, greater than the first value measured on the first hospital visit?",SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN (SELECT value FROM (SELECT value, hospital_visit_id FROM observations WHERE person_id = 10007818 AND observation_concept_id = 44814776 AND observation_date <= (SELECT MIN(observation_date) FROM observations WHERE person_id = 10007818 AND hospital_visit_id = (SELECT MIN(hospital_visit_id) FROM hospital_visits WHERE person_id = 10007818))) ORDER BY observation_date DESC LIMIT 1) > (SELECT value FROM (SELECT value, observation_date FROM observations WHERE person_id = 10007818 AND hospital_visit_id = (SELECT MIN(hospital_visit_id) FROM hospital_visits WHERE person_id = 10007818) ORDER BY observation_date ASC) LIMIT 1) THEN 'Yes' ELSE 'No' END AS 'Is_greater'"
f5897f6587ae16c7c674b41f,"Among patients in their 50s this year, what were the top three most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,
5d63012ba377b6abd13cc0ec,How much am I expected to pay for regional lymph node excision?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'regional lymph node excision' ) ),,SELECT SUM(billing_amount) as total_cost FROM healthcare_services WHERE procedure = 'regional lymph node excision';
68de14b96fc28cb3d5819bcb,"For the patients with age 60 or above, what are the top five most frequent diagnoses during this year?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis_code, COUNT(diagnosis_code) AS frequency FROM PatientRecords WHERE age >= 60 AND YEAR(diagnosis_date) = YEAR(CURRENT_DATE) GROUP BY diagnosis_code ORDER BY frequency DESC LIMIT 5"
d110cb39c939189ff2381a4e,Do you know how many operating rooms are currently available?,,,SELECT count(*) FROM operating_rooms WHERE availability_status = 'available'
fb7a0f8c9dc16e058b2fa6fb,What was the first drug prescribed since 07/2100 to patient 10039708 via the td route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND prescriptions.route = 'td' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT TOP 1 medication_name FROM prescriptions WHERE patient_id = '10039708' AND route = 'td' AND date_prescribed >= '2023-07-21' ORDER BY date_prescribed ASC
e157dcdbd534ede0dfd40a1f,What was the name of the organism found in the last microbiological examination of patient 10027602's mini-bal since 01/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],select b.last_examination_name from (select * from mini_bal where patient_id = 10027602) as a join examination b on a.microbiological_examination_id = b.id order by b.last_examination_date desc limit 1
3b684d2b82753b3d95f1dbc9,Tell me the blood type of patient 76327?,,,SELECT BloodType FROM PatientRecords WHERE PatientID = 76327
2ca1d1be2d4d07ebcd6b3235,Is patient 3403 subject to a covid-19 test?,,,"SELECT DISTINCT Patient.PatientID, Patient.Name, Test.TestDate, Test.Result FROM Patient INNER JOIN Test ON Patient.PatientID = Test.PatientID WHERE Patient.PatientID = 3403 AND Test.TestType = 'COVID-19';"
11f8c5631939928ad4f53641,What were the first phosphate results for patient 10039831 in 12/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT * FROM phosphate_results WHERE patient_id = 10039831 AND result_date BETWEEN '2100-12-01' AND '2100-12-31' ORDER BY result_date ASC LIMIT 1
17bc287452c28a3ba71e2fe5,"Count the number of patients who received a excision of right internal mammary artery, percutaneous endoscopic approach procedure.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS num_patients FROM procedures WHERE description LIKE '%excision of right internal mammary artery%' AND approach LIKE '%percutaneous endoscopic%';
c3b20e163f22e9c64873825c,When was the last time yesterday that patient 10004733's respiratory rate was measured greater than 23.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 23.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(measurement_time) FROM measurements WHERE patient_id = 10004733 AND measurement_type = 'respiratory_rate' AND measurement_value > 23.0 AND DATE(measurement_time) = DATE_SUB(CURDATE(), INTERVAL 1 DAY)"
53ad3791f3c9399dbc8de0c3,Calculate patient 10019172's length of stay for the first ICU stay in days.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.4558912040665746}]",SQL query here
ba16c2749e29db98a6103a5f,And what was the first time patient 10038933 was prescribed medication using the iv drip route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(date) FROM prescriptions WHERE patient_id = 10038933 AND route = 'iv drip'
45e96cdfdd32151dd3592509,What is the history of immuno cancer drugs in the last 5 years?,,,SQL Query Here
c26e31b284f5bd28c5239fc8,Tell me the name of the drug which patient 10021487 was prescribed within 2 days after having had a closed [endoscopic] biopsy of bronchus procedure since 9 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-9 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-9 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"select distinct dr.name from drug dr join prescription p on dr.id=p.drug_id join patient pat on p.patient_id=pat.id join procedure pro on pro.id=p.procedure_id and p.patient_id=pat.id where pat.id=10021487 and pro.name=""closed [endoscopic"
b6b8fff2d091a4950a8656fc,Did it happen on the last occasion that patient 16248 had a medicine they should take daily?,,,SELECT * FROM patient_medicines WHERE patient_id = 16248 AND medicine_name IN (SELECT medicine_name FROM daily_medicines) ORDER BY prescription_date DESC LIMIT 1
1938b1fa4edd438feb5ae416,Tell me the count of other laparoscopic umbilical herniorrhaphy procedures that took place.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other laparoscopic umbilical herniorrhaphy' ),[{'COUNT(*)': 0}],select count(*) from Procedure where procedure_description like '%laparoscopic umbilical herniorrhaphy%' and procedure_code not in (select procedure_code from Procedure where procedure_description like '%index case%')
ffdf7c7b7b7b047429a3497b,"What is the average total hospital expense that includes hemiplegia, unspecified affecting left nondominant side since 1 year ago?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified affecting left nondominant side' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT AVG(total_hospital_expense) FROM hospital_billing_data WHERE diagnosis LIKE '%hemiplegia%' AND side = 'left' AND side_description = 'nondominant' AND date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
6dcff6961c5881f37f24c90d,Has patient 10008454 received any lab tests in this month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')",[{'COUNT(*)>0': 0}],select * from lab_tests where patient_id = 10008454 and date >= '2023-10-01' and date <= '2023-10-31'
003276cc7c1bc688813d5aca,Show me patient 10014354's total void output amount since 08/11/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-08-11'",[{'SUM(outputevents.value)': None}],"select sum(total) as ""Total Void Output"" from output where patient_id = 10014354 and voided = 1 and voided_date >= '08/11/2100' and concept_id = 5089"
5deee54b966c7e4660cedfb8,Tell me the total volume of input that patient 10004422 was given on 01/21/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-21'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(volume) FROM patient_input WHERE patient_id = 10004422 AND input_date = 'YYYY-MM-DD'
52b6906b922b93a286a69090,What is the average total cost of a hospital that involves a procedure named other diagnostic procedures on lung or bronchus during this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_costs) FROM `healthcare.gov.hospital_cost_profile` WHERE procedure_name LIKE '%other diagnostic procedures on lung or bronchus%' AND YEAR(procedure_date) = YEAR(CURRENT_DATE());
a02303e787c9c6d217b02035,Calculate the total volume of input for patient 10029291 on 02/26/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-02-26'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(volume) FROM input_events WHERE subject_id = 10029291 AND date = '02/26/2100'
171cf2d1223b4c0cf47224a0,What was the duration in days of patient 10004235's last stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.952106482349336}]",select max(end_date - start_date) as duration_days from icu_stays where patient_id = 10004235
ae2b2591d8e2e64d87cd4240,List the single rooms that are available now?,,,SELECT room_number FROM rooms WHERE room_type = 'single' AND is_available = TRUE
03cee97f39a5dbd735cc25ea,How many patients in 2100 were discharged from the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM hospital_discharges WHERE year = 2100 AND discharged = TRUE
938fe2e5e3beaeff9c65cbe4,Retrieval of the top four most frequent outputs in this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"[SELECT output_name, COUNT(*) as frequency"
b5d0db7b72d315ea5e4647b0,Get me patient 10004733's total gastric meds input amount on 12/24/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'",[{'SUM(inputevents.totalamount)': None}],"SELECT SUM(`input_amount`) AS TotalGastricMeds FROM `medication_administration` WHERE `patient_id` = '10004733' AND `medication_type` = 'gastric' AND `date` = DATE_FORMAT(NOW(),'%Y-12-24');"
90c0a4f23c31e61cee1395c2,Avapro - How much does it cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'avapro' ),,select avg(cost) from prescriptions where medication='Avapro'
83e367047d0aa921f3cb6d91,When are dr. lail's rounds and procedures?,,,SELECT * FROM schedule WHERE doctor_name = 'Dr. Lail' AND (event_type = 'rounds' OR event_type = 'procedures');
5255f208c2e8f59e3a5737fd,What was the last prescription for patient 10005817?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[{'drug': 'HYDROmorphone (Dilaudid)'}],SELECT TOP 1 * FROM prescriptions WHERE patient_id = 10005817 ORDER BY prescription_date DESC
3fa74c4fb1defa83dd97682b,What was an insurance plan for patient 10005866 in their last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicaid'}],select plan_name from insurance_plans where patient_id = '10005866' and visit_date = (select max(visit_date) from visits where patient_id = '10005866')
0939295415266bebd843029a,Can you show me the five most frequent outputs in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],"SELECT output, COUNT(output) AS frequency FROM table_name WHERE year = 2100 GROUP BY output ORDER BY frequency DESC LIMIT 5"
1209cc6f2d89e79f32b5b025,Provide the sum total of inputs for patient 10029484 since 02/11/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-11'",[{'SUM(inputevents.totalamount)': 2540.0}],SELECT SUM(inputs) FROM patient_data WHERE patient_id = 10029484 AND input_date >= '02/11/2100'
fe412705ae90c13acf0a2033,Provide the count of hospital visits for patient 10009049 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10009049 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],SELECT COUNT(*) AS visit_count FROM HospitalVisits WHERE PatientID = 10009049 AND VisitDate >= '2100-01-01';
45cd303621fb1f3007600184,What are the prices of the drug propranolol?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'propranolol' ),,"SELECT drug_name, price FROM drugs WHERE drug_name='propranolol'"
257b96b1dd73002157d478e9,What output did patient 10038999 have for the last time since 04/14/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-14' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],"SELECT Output, OutputDateTime FROM PatientOutput WHERE PatientID = 10038999 AND OutputDateTime > '04/14/2100' ORDER BY OutputDateTime DESC LIMIT 1"
da5f3dae68433524c0462406,"For patients diagnosed with nontraumatic subarachnoid hemorrhage from left posterior communicating artery before, what are the top four most common treatments within the same month in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nontraumatic subarachnoid hemorrhage from left posterior communicating artery' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 treatment_name, COUNT(*) as treatment_count FROM patient_treatments WHERE diagnosis_code = 'nontraumatic_subarachnoid_hemorrhage' AND artery_location = 'left_posterior_communicating' AND treatment_date BETWEEN diagnosis_date AND DATEADD(month, 1, diagnosis_date) AND YEAR(diagnosis_date) = 2100 GROUP BY treatment_name ORDER BY treatment_count DESC"
1e7b6f713dc28ec89c51ea69,What are the three most frequently performed treatments for patients in their 40s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT treatment_type, COUNT(*) AS frequency FROM Treatments INNER JOIN Patients ON Treatments.patient_id = Patients.patient_id WHERE YEAR(Patients.birth_year) BETWEEN 2060 AND 2070 AND YEAR(Treatments.treatment_year) = 2100 GROUP BY treatment_type ORDER BY frequency DESC LIMIT 3"
51e820358aab679bf6555ec8,"Could you tell me the minimum total hospital cost that includes respiratory ventilation, greater than 96 consecutive hours since 1 year ago.","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_hospital_cost) FROM table_name WHERE respiratory_ventilation_duration >= 96 AND date >= CURRENT_DATE - INTERVAL '1 year'
44d5008230190a09f20e3682,Has patient 10022017 undergone a free calcium laboratory test since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM laboratory_tests WHERE patient_id = '10022017' AND test_type = 'free calcium' AND test_date > '2100-04-21'
3f2bb642b30df18f43f0428a,Tell me the monthly maximum amount of patient 10006053's cryoprecipitate input.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cryoprecipitate' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",[],"SELECT MONTH(Date) as Month, MAX(Amount) as MaxAmount FROM blood_transfusion WHERE PatientID = 10006053 AND Component = 'Cryoprecipitate' GROUP BY MONTH(Date) ORDER BY MONTH(Date) ASC"
3b6ed4de3ab4d728ea08e28b,Show us the top three most common microbiology tests since 2100.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]","SELECT TOP 3 TestName, COUNT(*) AS TestCount FROM MicrobiologyTests WHERE TestDate >= '2100-01-01' GROUP BY TestName ORDER BY TestCount DESC;"
65a61f863c5c62e515fe477a,"On 02/04/this year, what was the first respiratory rate value of patient 10020187?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-04' ORDER BY chartevents.charttime ASC LIMIT 1",[],select first_value(RespRate) over (order by TimeStamp) as FirstRespRate from patient_10020187_data where Date = '02/04/2023'
7e6b0e29fe9f32760b7fcfc5,Tell me the name of the organism found in patient 10016742's last bronchial washings microbiology tests?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT organism FROM microbiology_tests WHERE patient_id = 10016742 AND sample_type = 'bronchial washings' AND test_date = (SELECT MAX(test_date) FROM microbiology_tests WHERE patient_id = 10016742 AND sample_type = 'bronchial washings')
fbbd2e1b86a772b593ee1bb9,Does patient 3125 have traveled abroad?,,,SELECT HasTraveledAbroad FROM patient_data WHERE patient_id = '3125';
b56a5ca8c263bc1137aded80,What are the immuno-cancer drugs of last 5 years.,,,"SELECT drug_name, approval_date FROM immuno_cancer_drugs WHERE approval_date >= DATE_SUB(CURDATE(), INTERVAL 5 YEAR)"
716b0a0b383a839c836a20ba,Can you tell me which were the top five most frequently tested specimens in 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],"SELECT specimen, COUNT(*) as frequency FROM tests WHERE year = 2100 GROUP BY specimen ORDER BY frequency DESC LIMIT 5"
ffed9e72b74c6090bd75fda4,"Tell me the name of the drug which patient 10022041 was prescribed in the same day after having had a open reduction of fracture with internal fixation, humerus procedure since 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open reduction of fracture with internal fixation, humerus' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,SELECT drug_name FROM prescriptions WHERE patient_id = '10022041' AND DATE(prescription_date) = (SELECT DATE(procedure_date) + INTERVAL 1 DAY FROM procedures WHERE procedure_code = 'open_reduction_humerus' AND patient_id = '10022041')
834e30eb03b26e7bd61a9b19,How many times patient 10006053 came to the hospital this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10006053 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT COUNT(*) AS visit_count FROM hospital_visits WHERE patient_id = 10006053 AND visit_date >= '2023-01-01'
1550fe2c0834cad1b2dbef07,What was the dose of yellow cadd cassette that was last prescribed to patient 10014729 in 03/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND prescriptions.drug = 'yellow cadd cassette' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",[],dose
411e30b09a68ac73906064aa,What are the current numbers of operating rooms available?,,,select count(*) from OperatingRooms where status = 'available';
77ae0d9711456146d89f58ea,What was the organism found in patient 10021312's first bronchial washings test since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT organism FROM bronchial_washings WHERE patient_id = '10021312' AND test_date >= '2100-02-01' ORDER BY test_date ASC LIMIT 1
61ac6587433ff400f0293adc,"Among patients who were given excision of left internal mammary artery, percutaneous endoscopic approach , what are the top three most common specimens tested afterward within the same month?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left internal mammary artery, percutaneous endoscopic approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 test, COUNT(*) as frequency FROM `operations_and_tests` WHERE procedure_description='excision of left internal mammary artery, percutaneous endoscopic approach' GROUP BY test ORDER BY frequency DESC"
a8feb694e864b90b3695fce8,Can you tell me how many days patient 10015860 stayed in the ICU during their last stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.6421874999068677}]","SELECT DATEDIFF(MAX(DischargeDate), MIN(AdmissionDate)) AS DurationOfStay FROM ICUStays WHERE PatientID = 10015860 AND StayType = 'Last';"
65209ec4d53fcc5e5cd03c87,Calculate the total amount of or ebl of patient 10018081 since 10/03/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-03'",[{'SUM(outputevents.value)': None}],SELECT SUM(OR_EBL) AS total_or_ebl FROM patient_fees WHERE patient_id = '10018081' AND fee_date >= '2100-10-03'
30b60fadbc9e5ba919ab8f81,"What were the number of patients who received a total nucleated cells, csf test throughout this year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, csf' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) AS number_of_patients FROM lab_results WHERE test_name = 'total nucleated cells, csf' AND EXTRACT(YEAR FROM test_date) = EXTRACT(YEAR FROM CURRENT_DATE)"
2ca14c9e3ae55c6d467fa8c1,What was the total amount of furosemide that they prescribed to patient 10037861?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.drug = 'furosemide',[{'SUM(prescriptions.dose_val_rx)': None}],select sum(furosemide) from prescriptions where patient_id = '10037861'
42fee8cbef2d81610c0f6a7b,What is the blood type of patient 32168?,,,select blood_type from patients where patient_id = 32168
582b1e6739323885d6dd7148,What are the precautions to take after the packed cell transfusion procedure?,,,SELECT precautions FROM post_procedure_guidelines WHERE procedure_type = 'packed cell transfusion'
9f7b99f3d5e3095f6d354747,"Since 2100, what was patient 10016150 diagnosed with for the first time?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",,SELECT DISTINCT diagnosis FROM patient_records WHERE patient_id = '10016150' AND diagnosis_date >= '2100-01-01' ORDER BY diagnosis_date ASC LIMIT 1
522b43ceabd524cfde7e3316,Are any new drugs prescribed to patient 10039831 today compared to the ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],[SELECT DISTINCT a.medication_name FROM prescriptions AS a
0874a8eb9ae4f8b6bb50a1d4,When was patient 10019777 prescribed for the first time a medication via ng route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND prescriptions.route = 'ng' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(STARTDATE) as FirstPrescriptionDate FROM BRIH.PRESC WHERE PATIENTID='10019777' AND ROUTE='NG'
09a725954294822d94f728cd,How many hours has it been since the last time in the current hospital encounter that patient 10018081 was diagnosed with hypopotassemia?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypopotassemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"select (timestampdiff(hour, max(STARTDATE), now())) as time_since_last_hypopotassemia from DIAGNOSES_ICD where PERSON_ID = '10018081' and ICD9_CODE = '276.1' and STARTDATE >= (select max(STARTDATE) from ENCOUNTER where PERSON_ID = '10018081' and TYPE = 'A')"
af0bb751dca92abe9b101475,Count the number of patients who received a procedure in the previous year for closed [percutaneous] [needle] biopsy of kidney.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,"SELECT COUNT(*) FROM procedures WHERE procedure_name = 'closed percutaneous needle biopsy of kidney' AND date BETWEEN DATEADD(YEAR, -1, GETDATE()) AND GETDATE();"
cc37854387e108740577c491,When was last time patient 65759 had a medication that is something to take all the time...,,,SELECT MAX(STARTDATE) FROM LABORATORY_EVENTS WHERE PATIENTID = 65759 AND MEDICATIONNAME IN (SELECT NAME FROM MEDICATIONS WHERE TYPE = 'Chronic')
ab6219b3365eb3a41f89b20b,How many drugs were given to patient 10036156 last year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)': 0}],SELECT COUNT(DISTINCT drug_name) AS num_drugs FROM prescriptions WHERE patient_id = '10036156' AND date_prescribed BETWEEN '2022-01-01' AND '2022-12-31'
ab2f0e488953985801236fef,Calculate the length of stay in days for the first stay of patient 10007928 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.859664352145046}]",SELECT EXTRACT(DAY FROM (MAX(admit_date) - MIN(admit_date) + INTERVAL '1' DAY)) AS length_of_stay FROM admissions WHERE patient_id = 10007928 AND unit = 'ICU' GROUP BY patient_id HAVING MIN(admit_date) = (SELECT MIN(admit_date) FROM admissions WHERE patient_id = 10007928 AND unit = 'ICU')
6c892975c433bd0b8960e8d5,What was the amount of lidocaine 1% dose prescribed to patient 10001217 since 03/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'lidocaine 1%' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",[{'SUM(prescriptions.dose_val_rx)': None}],
29a1dcd96e7a8c556183b81f,Tell me the protocol of anti cancer drugs?,,,select protocol from anti_cancer_drugs
b51511a676f74b3a0f868b97,What is the difference in patient 10021487's weights measured at 2100-12-22 04:00:00 compared to the value measured at 2100-12-20 00:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-22 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-20 00:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-22 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-20 00:00:00' )"": None}]","SELECT (MAX(weight) - MIN(weight)) as weight_difference FROM patient_data WHERE patient_id = 10021487 AND measurement_time IN ('2100-12-22 04:00:00', '2100-12-20 00:00:00');"
7b2aaf2bdc86d0afb00d3cef,What was the last respiratory rate value patient 10027602 had on 12/04/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-04' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT respiratory_rate FROM patient_data WHERE patient_id = '10027602' AND datetime = (SELECT MAX(datetime) FROM patient_data WHERE patient_id = '10027602' AND DATE(datetime) = '12/04/2100')
9f046b17ea9354be7cebea95,What was the total void output in patient 10023239 since 03/11/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-11'",[{'SUM(outputevents.value)': None}],SELECT SUM(output) AS total_void_output FROM Void WHERE patient_id = 10023239 AND date >= '03/11/2100';
de2dd163eefb7cd6f7fe4767,What are the four most common output instances since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]","SELECT instance, COUNT(*) AS count FROM instances WHERE output_date >= '2100-01-01' GROUP BY instance ORDER BY count DESC LIMIT 4"
d736183a8eb133edc418c730,How many days have it been since the first stay of patient 10039831 on this hospital stay in the careunit surgical intensive care unit (sicu)?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'surgical intensive care unit (sicu)' ORDER BY transfers.intime ASC LIMIT 1",[],"select datediff(day, min(admit), current_date()) from ADMISSIONS where patientunitstayid in (select patientunitstayid from PATIENTS where patientid = 10039831 and icustayid in (select icustayid from ICUSTAYS where hadm_id in (select hadm_id from ADMISSIONS where unitstayid in (select unitstayid from ICUSTAYS where careunit = 'surgical intensive care unit (sicu)'))))"
1081d7abee1a338f85c00408,Did patient 10027602 take a gt flush medication on 12/06/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-06'",[{'COUNT(*)>0': 0}],SELECT * FROM Medications WHERE PatientID = 10027602 AND MedicationType = 'gt flush' AND Date = '12/06/2100';
663817ca2281ed4ca55f52e3,What was the change in creatinine in patient 10039708 last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","[select * from (select patient_id, creatinine, visit_id, value_order, value, visit_start_date from (select * from labevents where labevents.ITEMID = 50802) labevents1, (select * from (select max(visit_id) as visit_id from (select * from labevents where labevents.ITEMID = 50802) labevents2, (select * from visits where visits.hadm_id = labevents2.hadm_id) visits2) max_visit_id) max_visit_id1, (select * from (select visit_id, hadm_id from (select * from labevents where labevents.ITEMID = 50802) labevents3, (select * from visits where visits.hadm_id = labevents3.hadm_id) visits3) visit_hadm_id) visit_hadm_id1 where labevents1.visit_id = max_visit_id1.visit_id and labevents1.visit_id = visit_hadm_id1.visit_id and labevents1.hadm_id = visit_hadm_id1.hadm_id and labevents1.patient_id = 10039708) last_visit where value_order = 1) last_visit1, (select * from (select patient_id, creatinine, visit_id,"
340a6488743a4a60f4797d75,How many patients received a alanine aminotransferase (alt) lab test this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL Query Here
b06238b6f95478036e95125a,What diagnosis did patient 10016742 receive in 2100 for the first time?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",,SQL_QUERY
63f037abd22df66334ece29c,What is the maximum total cost of the hospital which involves hyperplasia of renal artery?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperplasia of renal artery' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT MAX(total_cost) FROM hospital WHERE disease='Hyperplasia of renal artery'
e5cad69b2c1bd6709789926f,"What is the number of patients that received a rbc, csf test during the previous year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, csf' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM lab_results WHERE test_name = 'rbc' OR test_name = 'csf' AND test_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW()"
bd1e0ce3084fab70f0a0f6db,Has any or colloid intake medication been given to patient 10039831 since 07/26/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-26'",[{'COUNT(*)>0': 0}],SELECT `DrugType` FROM `MedicationRecords` WHERE `PatientID` = 10039831 AND `DateAdministered` > '07/26/2100' AND (`DrugType` = 'colloid' OR `DrugType` LIKE '%or%')
f7f4a6f9abf6c8424b79c205,Count the current patients who are in the 60 or above.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,,SELECT COUNT(*) AS num_patients FROM patient WHERE age >= 60 AND current_status = 'In Treatment'
c57560772bbe0f01b4467b62,"Among patients who were diagnosed with calculus of bile duct without mention of cholecystitis, without mention of obstruction, what were the top five most common microbiology tests conducted in the same hospital encounter?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of bile duct without mention of cholecystitis, without mention of obstruction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"select top 5 microbiology_test_name, count(*) as frequency from microbiology_tests where hospital_encounter_id in (select id from diagnoses where diagnosis_name = 'calculus of bile duct' and cholecystitis_not_mentioned = true and obstruction_not_mentioned = true) group by microbiology_test_name order by frequency desc"
7b319dcf4efec30297a50d9b,How many patients were given ezetimibe since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ezetimibe' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 2}],SELECT COUNT(*) FROM patients WHERE medication = 'ezetimibe' AND year > 2100
488d42291ce547168cdb32bb,Tell me the name of the prescription drug that patient 10018501 was prescribed within 2 days after having a alcohol detoxification procedure in 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"select distinct drugname from prescriptions as p join procedures as proc on p.patient_id = proc.patient_id where p.patient_id = 10018501 and p.prescribe_date between proc.procedure_date and proc.procedure_date + interval '2' day and proc.procedure_type = 'alcohol detoxification' and to_char(proc.procedure_date, 'YYYYMM') = '2008'"
01270c1f37b90c29598b8e5c,Did patient 10001725 undergo repair of rectocele with graft or prosthesis in their last hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of rectocele with graft or prosthesis' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],[SELECT EXISTS(
f7778f20f71116c2c62f29b8,Calculate the sum of patient 10020944's input on 03/14/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '03-14'",[{'SUM(inputevents.totalamount)': None}],"SELECT SUM(NumInput) FROM tblinput WHERE PatientID = '10020944' AND CONVERT(VARCHAR(10), InputDateTime, 101) = '03/14/' + CAST(YEAR(GETDATE()) AS VARCHAR)"
e40b14c3c51819949e2f549e,How long did it take to get spinal canal explor nec for patient 18877?,,,"select case.patient_id, case.surgery_type, case.date_diagnosed, case.date_surgery, datediff(day, case.date_diagnosed, case.date_surgery) as days_to_surgery from patient_case case join surgery_details surgery on case.patient_id = surgery.patient_id where case.patient_id = 18877 and surgery.surgery_type = 'spinal canal explor nec'"
01c441f58a97f89226067a93,When was the last time that patient 10031757 has had the maximum systolic blood pressure since 92 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-92 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(systolic) AS max_systolic, timestamp AS last_recorded FROM blood_pressure WHERE patient_id = 10031757 AND timestamp >= NOW() - INTERVAL '92 days' ORDER BY timestamp DESC LIMIT 1"
8bc83605b6ede35754a1e843,Has there been any organism found in the first microbiological urine test of patient 10021118 in 12/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)>0': 0}],SELECT * FROM microbiological_urine_tests WHERE patient_id = 10021118 AND test_date = '12/2100' AND organism_detected IS NOT NULL LIMIT 1
6721130290e0d18224932b4d,What was the drug that was prescribed to patient 10027602 in the same hospital visit after the percutaneous [endoscopic] gastrostomy [peg] this month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,select dr_name from prescription where patient_id = 10027602 and hospital_id = (select hospital_id from procedure where patient_id = 10027602 and procedure_name = 'percutaneous [endoscopic
5cc361b3a9d1cee29ed3d437,"How many patients in 2100 were diagnosed with insomnia, unspecified within the same hospital visit after the diagnosis of other postprocedural status?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other postprocedural status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'insomnia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,SELECT COUNT(*) FROM patient_records WHERE diagnosis_code = 'insomnia_unspecified' AND visit_year = 2100 AND has_following_diagnosis = 'postprocedural_status'
b5dcc8918a0bc3fb72bf3b6b,What is the maximum total cost for a hospital including tests in the granular casts laboratory since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'granular casts' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_cost) FROM hospital_costs WHERE test_location='Granular Casts Laboratory' AND date >= '2100-01-01';
ace4be317f182e1697b40080,"Which were the three most commonly ordered procedures for patients previously diagnosed with acquired absence of organ, genital organs within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of organ, genital organs' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"select top 3 procedure_name, count(procedure_name) as num from procedures p join diagnosis d on p.patient_id = d.patient_id join organ_absence oa on d.patient_id = oa.patient_id where oa.absence_type = 'genital organs' and d.diagnosis_date >= dateadd(month, -2, current_date) group by procedure_name order by num desc"
17ff517f4cb7bc5330bbc4dd,How many hours have elapsed since patient 10018081's first stay in the careunit emergency department on this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT SUM(TIMESTAMPDIFF(HOUR, check_in_time, check_out_time)) as total_hours_spent FROM patient_visits WHERE patient_id = '10018081' AND visit_type = 'emergency_department' AND encounter_id = 'current_encounter_id';"
7bd7e129fb3ef8370555bf1b,What specimen test was first given during their last hospital encounter to patient 10011398?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}],select top 1 c1 from (select distinct specimen_test_id as c1 from lab_result where patient_id = 10011398 order by encounter_id desc) as t1
09552895d2ca5e482d2b314f,Tell me the percentile for platelet count of 332.0 among patients in the same age as patient 10014729 on the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 332.0",,SELECT PERCENT_RANK() OVER (ORDER BY platelet_count) AS percentile_rank FROM patient_data WHERE age = (SELECT age FROM patient_data WHERE patient_id = '10014729' AND visit_date = (SELECT MAX(visit_date) FROM patient_data WHERE patient_id = '10014729')) AND platelet_count >= 332.0
e93f9ba8d8777339be3240be,What was the first lab test result of the absolute neutrophil count for patient 10014354 on the last hospital visit?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute neutrophil count' ) ORDER BY labevents.charttime ASC LIMIT 1,[],
59217d3eca4038fcc33993f0,Tell me about all the medications that patient 99080 received in the other department.,,,"SELECT medication, department, date FROM patient_medications WHERE patient_id = 99080 AND department <> 'Current Department'"
54422dbdbf89248bf6be26fb,What was the number of times rosuvastatin calcium was prescribed in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'rosuvastatin calcium' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],select count(*) from prescriptions where medication = 'rosuvastatin calcium' and year = 2100
876c247db73f4411e78223a2,Retrieval of the top four most frequent outputs since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]","SELECT output, COUNT(*) AS frequency FROM output WHERE year >= 2100 GROUP BY output ORDER BY frequency DESC LIMIT 4;"
4711ca09480e8240ce0059df,What was the organism detected in patient 10021487's last blood culture microbiology test since 12/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT organism FROM microbiology_test_results WHERE test_type = 'blood culture' AND patient_id = '10021487' AND test_date = (SELECT MAX(test_date) FROM microbiology_test_results WHERE patient_id = '10021487' AND test_date >= '12/2100')
83ec58fae196e1e30c71c836,What was the name of the drug which was prescribed to patient 10009035 within 2 days after having received a extracorporeal circulation auxiliary to open heart surgery procedure in 05/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,[select distinct drug_name from prescriptions
94e88227ead8378786e00436,Which are the four top specimens that were tested during this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",[],"SELECT TOP 4 specimen_id, test_date FROM TestResults WHERE YEAR(test_date) = YEAR(CURDATE()) ORDER BY test_date DESC;"
02a069698a803a8419fa294c,Tell me the count of the drugs patient 10021118 was prescribed in 11/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11'",[{'COUNT(*)': 0}],
70d4f706eb7c1197729174d6,What were the five most common drugs prescribed since 1 year ago?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]","SELECT drug, COUNT(*) as frequency FROM prescriptions WHERE prescription_date > NOW() - INTERVAL '1 year' GROUP BY drug ORDER BY frequency DESC LIMIT 5"
9b39448454fb368c2b7fb229,Can you tell me what patient 10007795's last heart rate was during the first ICU visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT max(`HeartRate`) FROM `ICUAdmissions` WHERE `PatientID` = 10007795 AND `AdmissionNumber` = 1;
2aa7ae5c7002d9117a347f9e,Could you retrieve the top four diagnoses that have the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT diagnosis, MAX(3_month_mortality_rate) AS highest_mortality_rate FROM diagnoses GROUP BY diagnosis ORDER BY highest_mortality_rate DESC LIMIT 4"
44b3905875474271bf26457e,What are the reimbursement standards for cerebrovascular mri?,,,"SELECT reimbursement_amount, reimbursement_criteria FROM medical_procedure_costs WHERE procedure_name = 'cerebrovascular MRI' AND reimbursement_standards IS NOT NULL"
a229a64f2bf74f9fc9dfa626,In what ways can nystatin cream be ingested?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nystatin cream',[],select how_taken from product_description where product_name = 'nystatin cream'
42b32b8c9018073085ea61c5,How many operation rooms are now available?,,,SELECT COUNT(*) AS AvailableRooms FROM operation_rooms WHERE status = 'available'
b491a9d1d8f94456fa46b689,Tell me the number of patients discharged from the hospital throughout this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM discharges WHERE discharge_date BETWEEN '2023-01-01' AND '2023-12-31'
2a8475d3f201bfe0a949a29a,Has patient 10001217 since 2100 been given a l lab test?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'l' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y',labevents.charttime) >= '2100'",[{'COUNT(*)>0': 0}],"select * from lab_tests where patient_id=10001217 and date>=""2100-01-01"" and type=""l"" and result IS NOT NULL"
2c4e0725c06cb24d740f8090,Which immuno-cancer drugs were used for the last five years?,,,"SELECT drug_name FROM clinical_trials WHERE drug_type = 'immuno-cancer' AND trial_start_date >= DATE_SUB(CURDATE(), INTERVAL 5 YEAR)"
646e109b76831aec3246418b,What was the name of the procedure that was given two times to patient 10019777 since 13 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-13 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,SELECT procedure_name FROM procedures WHERE patient_id = 10019777 AND procedure_date > CURRENT_DATE - INTERVAL '13 months' GROUP BY procedure_name HAVING COUNT(procedure_name) = 2
5e26962b8d9bc2994ab47e5d,Can you calculate how many patients were prescribed ipratropium-albuterol neb during the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ipratropium-albuterol neb' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM patient_prescriptions WHERE drug_name = 'ipratropium-albuterol neb' AND prescription_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
5a9d2f417f6b862c0b7366e8,What was the last weight of patient 10002495 since 19 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-19 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],select weight from weight_records where patient_id = 10002495 and date >= (current_date - interval '19 months') order by date desc limit 1
d15888d8cda931dc5035830d,Can you tell me which were the top three most frequent specimens tested?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT Specimen, COUNT(*) AS Frequency FROM LaboratoryExaminationData GROUP BY Specimen ORDER BY Frequency DESC LIMIT 3"
69c7281826029c1b41a34049,What is the dosage of an opioid given to patient 4469?,,,"select opioid, dosage from patient_medication where patient_id = 4469 and medication_type = 'opioid'"
86633ae70ad8fa5a8c7ee1ad,"Of the patients of age 40s , what were the top three most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,SQL Query here
e47e7e616f3d5838b2aa30eb,When was the first time that patient 10004422 was prescribed medication during their last hospital encounter via the sc route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(date) FROM Prescription WHERE patient_id='10004422' AND route='sc' AND encounter_id=(SELECT MAX(encounter_id) FROM Encounters WHERE patient_id='10004422')
9e9c562a4ca1886263c6444c,"What was the name of the drug which patient 10007818 was prescribed during the same hospital visit after receiving a drainage of peritoneal cavity, percutaneous approach, diagnostic procedure in 07/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,SQL Query Here
22377f7f4ffda156f6c95713,Has patient 10012552 been diagnosed with any type of disease since 1 year ago?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')",,"SELECT * FROM Diagnosis WHERE patient_id = 10012552 AND diagnosis_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
7f9686faa27e555657f81477,Show me the top five most commonly prescribed drugs since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]",""""""""
657a58e806b8805fa2a4714d,How is trazodone typically taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'trazodone',[],SELECT form FROM medication_administration WHERE medication = 'trazodone';
f35e3b8882888f20f738170e,Tell me what to prepare before the non-invasive mech vent procedure,,,SELECT pre_procedure_instructions FROM NonInvasiveMechVentProcedures WHERE procedure_name = 'Non-Invasive Mech Vent' AND status = 'Active'
91e430cc8aa46185aee7b418,"What is the minimum total hospital cost for a patient suffering from collapsed vertebra, not elsewhere classified, thoracic region, initial encounter for fracture in 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'collapsed vertebra, not elsewhere classified, thoracic region, initial encounter for fracture' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT MIN(total_hospital_cost) as MinCost FROM `physionet-data.mimiciii_hospital_stays` WHERE `icd9_code` IN ('8051','8050') AND `hadm_id` IN (SELECT `hadm_id` FROM `physionet-data.mimiciii_diagnoses_icd` WHERE `seq_num` = 1 AND `icd9_code` IN ('8051','8050')) AND `admittime` >= '2010-01-01' AND `admittime` < '2011-01-01'"
1a35a4ed34f622e32e8c72ee,Tell me what the total foley output of patient 10020740 is on 03/24/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-24'",[{'SUM(outputevents.value)': None}],SELECT SUM(foley.output) AS total_foley_output FROM patient_records WHERE patient_id = 10020740 AND date = '03/24/2100' GROUP BY patient_id;
39a3cf3e83759a824ed64266,Has patient 10008287 been given any diagnosis since 1 year ago?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')",,"SELECT DISTINCT diagnosis FROM diagnoses WHERE patient_id = 10008287 AND diagnosis_date > DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
74693de7d313f1576fec3036,When was the first time that patient 10005909 has received a red blood cells lab test since 08/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT MIN(START_DATE) AS FirstTestDate FROM LAB_TESTS WHERE PATIENT_ID = '10005909' AND TEST_TYPE = 'Red Blood Cells' AND START_DATE >= '2100-08-01'
4e6d83c0c7ba1ea3a2bf658b,How many patients were diagnosed with acute diastolic (congestive) heart failure in the same month after the previous diagnosis with hypokalemia in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypokalemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute diastolic (congestive) heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT COUNT(DISTINCT p.patient_id) FROM patients p JOIN diagnoses d1 ON p.patient_id = d1.patient_id JOIN diagnoses d2 ON p.patient_id = d2.patient_id WHERE d1.diagnosis = 'hypokalemia' AND d2.diagnosis = 'acute diastolic heart failure' AND YEAR(d1.diagnosis_date) = 2100 AND MONTH(d1.diagnosis_date) = MONTH(d2.diagnosis_date) AND d2.diagnosis_date > d1.diagnosis_date AND d2.diagnosis_date <= DATE_ADD(d1.diagnosis_date, INTERVAL 1 MONTH)"
1770a690d77ad9ec94532a67,What was the admission type when patient 10018423 last entered the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018423 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1",[{'admission_type': 'EW EMER.'}],SELECT admission_type FROM admissions WHERE patient_id = 10018423 ORDER BY admission_date DESC LIMIT 1
49844eb3d519ede694dbad6b,List the top five most frequent specimens that patients were tested within 2 months after receiving percutaneous [endoscopic] gastrostomy [peg].,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"SELECT specimen_type, COUNT(specimen_type) AS count FROM lab_results JOIN patients ON lab_results.patient_id = patients.id WHERE procedure = 'percutaneous gastrostomy' AND test_date BETWEEN procedure_date AND DATE_ADD(procedure_date, INTERVAL 2 MONTH) GROUP BY specimen_type ORDER BY count DESC LIMIT 5"
513415b2f83b280737f76ca1,Retrieve the top four most frequent output occurrences throughout this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"SELECT output, COUNT(*) AS frequency FROM outputs WHERE YEAR(event_date) = YEAR(CURRENT_DATE) GROUP BY output ORDER BY frequency DESC LIMIT 4"
22c001b4fbec510a6a36e644,What's the minimum monthly number of admissions for hesitancy of micturition since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hesitancy of micturition' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,SELECT MIN(MonthlyAdmissionCount) FROM Admissions WHERE Diagnosis='Hesitancy of Micturition' AND Year=2100;
17f20674ea38a822c7cb6788,What time was the first time the systolic blood pressure of patient 10005817 was less than 128.0 in the first ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 128.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT MIN(time) FROM chartevents WHERE itemid = 220051 AND subject_id = 10005817 AND value < 128.0 AND hadm_id = (SELECT hadm_id FROM icustays WHERE subject_id = 10005817 AND stay_id = (SELECT MIN(stay_id) FROM icustays WHERE subject_id = 10005817))
a491772e3c26b8dfc1137679,"Has patient 10038081 had a lab test for glucose, ascites in 10/this year?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, ascites' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'",[{'COUNT(*)>0': 0}],"SELECT * FROM lab_tests WHERE patient_id = 10038081 AND test_name IN ('glucose', 'ascites') AND test_date BETWEEN '2023-10-01' AND '2023-10-31'"
acc452348f26357e7eee2d70,Calculate the total volume of input by patient 10019777 on 03/10/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-10'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input) FROM medical_data WHERE patient_id = '10019777' AND entry_date = '03/10/2100';
72046d186a8821cf81d3fec7,What was patient 10009035's weight the last time it was measured since 28 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"select max(weight) from health_records where patient_id = 10009035 and record_date >= date_sub(current_date, interval 28 month) limit 1"
6a258cd10ee1f1a03e0c9d23,How many patients stayed in careunit medical intensive care unit (micu) since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patient WHERE stay_date >= NOW() - INTERVAL 1 YEAR AND careunit = 'MICU'
5e629ad0ef424581e32da93e,Count the current patients who are in the 50s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,,SELECT COUNT(*) FROM patients WHERE age BETWEEN 50 AND 59 AND status = 'current'
3cec04d92cd89035dc5758b1,What were the four most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]",[SELECT * FROM (
83a394225c13181e2fd82725,"List the top three most frequent specimens that patients were tested in the same month after receiving fluoroscopy of superior vena cava using other contrast, guidance since 1 year ago.","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"SELECT Specimen, COUNT(Specimen) AS Frequency FROM Lab WHERE Date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND Date - fluoroscopy_date <= 30 AND fluoroscopy_procedure = 'Fluoroscopy of Superior Vena Cava using other contrast, guidance' GROUP BY Specimen ORDER BY Frequency DESC LIMIT 3"
c9cf1ade991005f5fffbd47d,What's the total of glucagon prescriptions since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 0}],SELECT SUM(glucagon_prescriptions) FROM healthcare_data WHERE year >= 2100
2dd85238210fd7a67447c15c,"Calculate the number of patients with altered mental status, unspecified who were diagnosed in 2100.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'altered mental status, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )",,SELECT COUNT(DISTINCT BENE_ID) AS patient_count FROM ADR_DETAILED WHERE DSCPTN_CD = 'G93.40' AND DSCPTN_YEAR = 2100 AND SEX_CD = 'U' AND RACE_CD = 'U';
78f0e0fcc6e1ea0b7d221630,What was the name of the output which patient 10007818 had for the last time on 07/03/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-07-03' ORDER BY outputevents.charttime DESC LIMIT 1 )",[],"SELECT last_name, first_name, output_name, date_collected FROM lab_output WHERE patient_id = 10007818 AND date_collected = (SELECT MAX(date_collected) FROM lab_output WHERE patient_id = 10007818 AND date_collected <= '2100-07-03')"
dd2de211b42f9be113f51d60,What is patient 10020944's sex?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020944,[{'gender': 'M'}],SELECT sex FROM patients WHERE patient_id = 10020944;
9541827f1eee21fcc491d39d,What diagnosis did patient 10022880 have last since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,"select * from (select dsn, max(vstdt) maxdate from t_diag where hno='10022880' and vstdt > sysdate - 365 group by hno, dsn) where maxdate = (select max(vstdt) from t_diag where hno='10022880' and vstdt > sysdate - 365)"
0de0194d965055a79103daf2,What does it cost to get cardiac arrest due to underlying cardiac condition diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac arrest due to underlying cardiac condition' ) ),,SELECT avg(cost) FROM medical_records WHERE diagnosis = 'Cardiac Arrest due to Underlying Cardiac Condition'
a342759e5ce55cf378df2630,Has patient 10015272 come into the ER?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.admission_location = 'emergency room',[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM er_visits WHERE patient_id = '10015272' AND visit_date IS NOT NULL
8fa8ed75a85186090d9db649,Has patient 10008287 been prescribed any prescription drugs since 28 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-28 month')",[{'COUNT(*)>0': 1}],"select count(*) as prescription_count from prescription where patient_id = '10008287' and drug_type = 'prescription' and prescription_date > add_months(current_date, -28)"
6b24642366cb89db4096210b,What's the rank of the top four most common output events in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"SELECT event, COUNT(*) AS frequency FROM `lunar-outpost-metrics.outpost_event_log` WHERE EXTRACT(YEAR FROM timestamp) = 2100 GROUP BY event ORDER BY frequency DESC LIMIT 4"
0878aade13d38cab157cad47,"After receiving laparoscopic robotic assisted procedure this year, what are the four most common diagnoses that patients received within the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic robotic assisted procedure' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT Diagnosis, COUNT(*) AS DiagnosisCount FROM PatientRecords WHERE ProcedureType = 'Laparoscopic Robotic Assisted' AND Year(ProcedureDate) = Year(CURRENT_DATE) GROUP BY Diagnosis ORDER BY DiagnosisCount DESC LIMIT 4"
6247e4ff884d2882517e9fa9,How much divalproex (delayed release) was first prescribed to patient 10038999 in 05/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND prescriptions.drug = 'divalproex (delayed release)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"select min(sum(quantity)), date from rxnorm_prescriptions where patient_id='10038999' and rxnorm_concept_id in (select rxnorm_concept_id from rxnorm_vocabulary where rxnorm_name='divalproex sodium delayed release') and date between '05/2100-01-01' and '05/2100-05-31' group by date order by date limit 1;"
613174eb83b532fe4e38b7fc,What is the name of the drug that should not be administered during the total splenectomy procedure?,,,SELECT drug_name FROM drug_safety WHERE procedure_name = 'total splenectomy' AND contraindicated = 'yes'
527f4ad3f397267a5cdd7622,Tell me about the most common three output events.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]",select * from [output_events
db075c3a76dad8cee21d6089,What kind of rooms are available now for singles?,,,SELECT room_type FROM rooms WHERE available_from <= CURDATE() AND available_to >= CURDATE() AND capacity = 1;
356174c53f28f728dccdef72,List the top four most common events that happened since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]","SELECT TOP 4 event, COUNT(*) AS event_count FROM Events WHERE date >= '2100-01-01' GROUP BY event ORDER BY event_count DESC"
a36cdf4e546071a6ffd31158,When was the first time patient 10020306 was discharged from hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020306 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2129-10-30 13:20:00'}],SELECT MIN(discharge_date) FROM admissions WHERE patient_id = '10020306' AND discharge_date IS NOT NULL
eee4eef5cba60f4be092bcb9,"Was the calcium, total value second measured on the first hospital visit of patient 10019568 greater than first measured on the first hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","select case when (select calcium_value from patient_lab_tests where patient_id = 10019568 and test_name = 'total calcium' and visit_number = 1 order by test_time asc limit 1,1) > (select calcium_value from patient_lab_tests where patient_id = 10019568 and test_name = 'total calcium' and visit_number = 1 order by test_time asc limit 1) then 'Yes' else 'No' end as result"
252547601fd6f7de68d6ad35,"How much is performance of cardiac output, continuous?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) )",,SELECT SUM(performance) AS TotalPerformance FROM cardiac_output WHERE type = 'continuous'
edf4e6f3df6825947d302e8e,When was the last time patient 10020944 measured its respiratory rate less than 21.0 since 348 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-348 day') ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT measurement_date FROM patient_measurements WHERE patient_id = 10020944 AND respiratory_rate < 21.0 AND measurement_date >= (CURRENT_DATE - INTERVAL '348 days') ORDER BY measurement_date DESC LIMIT 1
1fc3739dc0cf84ab7935fd38,What drug was the last drug prescribed for patient 10020786?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[{'drug': 'Ondansetron'}],select top 1 drug_name from prescriptions where patient_id = 10020786 order by prescription_date desc
6a5d0066989fdc73a130b8c2,What were the name of the treatment received by patient 10005909 two or more times since 04/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"[SELECT T1.treatment, count(*) as visit_count"
242ad67d83b98dc87f0a257c,Has patient 10038999 been administered any nacl 0.9% since 03/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03'",[{'COUNT(*)>0': 0}],
264556fad0e8f61d4b7fe7e9,What were the first alkaline phosphatase lab test results for patient 10019172 in 10/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT * FROM lab_results WHERE patient_id = '10019172' AND test_name = 'Alkaline Phosphatase' AND test_date = (SELECT MIN(test_date) FROM lab_results WHERE patient_id = '10019172' AND test_name = 'Alkaline Phosphatase' AND test_date LIKE '10/21%');
718c27e2ef2f6d9f2a3210f8,When was the last time that patient 10025612 had the minimum pco2 value on the last hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],select max(encounter.encounter_datetime) from (select encounter_id from obs where obs.person_id=10025612 and obs.concept_id=5089 and cast(value_as_number as integer)=min(cast(value_as_number as integer))) as x inner join encounter on x.encounter_id=encounter.encounter_id where encounter.encounter_type=2 order by encounter.encounter_datetime desc limit 1;
f4efae356977c3e6db1d472e,What is the name of the medication that was prescribed to patient 10037975 for the last time via the iv route since 02/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 Medication_Name FROM Prescriptions WHERE Patient_ID = 10037975 AND Route = 'iv' AND Date >= '2100-02-01' ORDER BY Date DESC
671afd8de1d5bdb9e0151ce2,When patient 10005817 was last discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005817 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(date_discharged) AS LastDischargeDate FROM patient_discharge_records WHERE patient_id = 10005817;
ddc7e149237d42b52700d717,What was the last value of the arterial blood pressure diastolic for patient 10008454 on their last ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],"SELECT MAX(date), diastolic FROM chartevents WHERE itemid IN (220051, 50843) AND subject_id = 10008454 AND charttime BETWEEN (SELECT MAX(admittime) FROM admissions WHERE subject_id = 10008454) AND (SELECT MAX(dischtime) FROM admissions WHERE subject_id = 10008454) GROUP BY subject_id ORDER BY MAX(date) DESC LIMIT 1"
7a01a7e71c780f176eb7b360,Can you give me the three most common output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT `event`, COUNT(*) as frequency FROM `output_events` WHERE `timestamp` > 2100000000000 GROUP BY `event` ORDER BY frequency DESC LIMIT 3"
93736e989193b9f5bc0fbdff,Tell me the minimum respiratory rate of patient 10026406 in the last ICU stay.,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ),[{'MIN(chartevents.valuenum)': None}],SELECT MIN(RespiratoryRate) as MinRespiratoryRate FROM [ICUStays
362416f9fea1bf8466b44a48,Tell me the top three most frequently tested specimens in 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",[],"SELECT specimen_name, COUNT(specimen_id) AS test_count FROM lab_results WHERE test_date BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY specimen_name ORDER BY test_count DESC LIMIT 3;"
f603f6954b5ed9f4cb1b3c15,"In 2100, how many patients underwent a venous catheterization, not elsewhere classified in the same month after the diagnosis of hepatic encephalopathy?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hepatic encephalopathy' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT COUNT(*) FROM medical_records WHERE procedure = 'venous_catheterization' AND diagnosis_code = 'hepatic_encephalopathy' AND YEAR(procedure_date) = 2100 AND procedure_date BETWEEN diagnosis_date AND DATE_ADD(diagnosis_date, INTERVAL 1 MONTH)"
cf6c8c0873569e3fe49b7317,"Hey, what was patient 10019172's minimum fibrinogen, functional value in 11/this year?","SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '11'",[{'MIN(labevents.valuenum)': None}],"select min(value) from lab_results where patient_id = '10019172' and test_name = 'Fibrinogen, functional' and test_date >= '2023-11-01' and test_date < '2024-01-01'"
163e20b7886f513a8897df5b,Can you tell me the name of the output patient 10004733 had for the last time on 12/28/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-28' ORDER BY outputevents.charttime DESC LIMIT 1 )",[],"SELECT MAX(output_date) AS last_output_date, output_name FROM patient_outputs WHERE patient_id = 10004733 AND output_date <= '2023-12-28' GROUP BY patient_id, output_name"
c1a94ccad673ddf5a68e93e3,What are the four most regularly ordered treatments for patients previously diagnosed with noncompliance with renal dialysis in the same hospital visit in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,SELECT TOP 4 Treatment FROM HospitalRecords WHERE Year = 2100 AND Diagnosis = 'Noncompliance with renal dialysis' AND VisitType = 'Same Hospital Visit' GROUP BY Treatment ORDER BY COUNT(*) DESC
5cb77adf0cc7efec9a38adba,Tell me the four most common diagnosis during this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"[SELECT Diagnosis, COUNT(*) AS Total"
723f3f4a1100077de462dfa3,Tell me the maximum total hospital cost that includes cefpodoxime proxetil in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'cefpodoxime proxetil' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(TotalHospitalCost) AS MaxCost FROM HospitalClaims WHERE Year = 2100 AND DrugName = 'cefpodoxime proxetil' AND CostType = 'TotalHospitalCost'
a4ead1605ee2cae02541b57b,How many people got prescriptions for adde last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'adde' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL Query
aa513e26eaa857febb6f4db0,What are the new drugs for patient 10004733 today compared to the earlier ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"SELECT a.drug, a.date FROM prescriptions a WHERE a.patient_id = 10004733 AND a.date = CURRENT_DATE AND NOT EXISTS (SELECT 1 FROM prescriptions b WHERE b.patient_id = 10004733 AND b.date = CURRENT_DATE - INTERVAL '1 day' AND a.drug = b.drug) ORDER BY a.date DESC"
b14e62dc0fdb8c7bba510c8a,Calculate patient 10019172's total output on 11/20/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-11-20'",[{'SUM(outputevents.value)': None}],SELECT SUM(output) FROM patient_output WHERE patient_id = 10019172 AND date = '11/20/2100';
c6de512d1247fb7333ad1c80,What was the last time that patient 10031757 had a maximum systolic blood pressure since 92 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-92 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(BloodPressure.Systolic) AS MaxSystolic, BloodPressure.CaptureTime AS LastCaptureTime FROM BloodPressure WHERE BloodPressure.PatientID = '10031757' AND BloodPressure.CaptureTime > DATEADD(DAY, -92, GETDATE()) ORDER BY BloodPressure.CaptureTime DESC LIMIT 1"
3717572f6b674f00be856aec,How many days have elapsed since patient 10018081 had received a red blood cells lab test for the last time on this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],Select the elapsed time in days between today's date and the most recent date on which patient with MRN=10018081 had a red blood cells lab test ordered during this encounter (visit).
f482fa51f88bdcc934bc4754,Can you list the single rooms that are available for rent now?,,,SELECT room_id FROM rooms WHERE room_type = 'Single' AND availability_status = 'Available'
88b0fb242af55f296a52b5d8,Can you tell me the first value of the bicarbonate test for patient 10001725 since 04/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT top 1 bicarbonate FROM lab_results WHERE patient_id = 10001725 AND date >= '04-01-2100' ORDER BY date ASC
99248704a41adef41854911d,How much is the average total hospital cost associated with hyperkalemia since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperkalemia' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(TotalHospitalCost) AS AverageCost FROM HospitalClaims WHERE DiagnosisCode = 'Hyperkalemia' AND ClaimDate >= '2100-01-01' GROUP BY DiagnosisCode;
132aee5ba3480c54ca8cee44,What are the top three most frequent microbiology tests since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]","SELECT test_name, COUNT(*) AS frequency FROM microbiology_tests WHERE test_date > '2100-01-01' GROUP BY test_name ORDER BY frequency DESC LIMIT 3"
ced779d97cae41941721bd34,"What number of days has it been since the first time patient 10018081 was diagnosed with encephalopathy, unspecified in this hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encephalopathy, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT DATEDIFF(CURRENT_DATE, MIN(E.date)) FROM encounters E WHERE E.patient_id = 10018081 AND E.diagnosis = 'encephalopathy, unspecified' GROUP BY E.patient_id"
bde07b33be302a136b2699b4,When should patient 74392 visit the hospital next?,,,SELECT next_visit_date FROM patient_scheduling WHERE patient_id = 74392
7a6b657fddbeb52ba6d8450c,Show me the top three most common diagnoses of patients with age 30s during this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"[SELECT diagnosis, COUNT(*) as diagnosis_count"
2814f1edb1bea5a93666884f,Number of patients who were given a insertion or replacement of other neurostimulator pulse generator procedure.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of other neurostimulator pulse generator' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS number_of_patients FROM procedures WHERE procedure_name IN ('insertion of other neurostimulator pulse generator', 'replacement of other neurostimulator pulse generator');"
e11c8d2b04cdfacf76cca4dd,Has patient 29806 had any other stool tests?,,,select * from lab_stool_test_results where patient_id = 29806 and test_id != 12345
1d5e1f6694e66a38eb9d48b3,Tell me the total number of patients who were diagnosed with open fracture of shaft of femur since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'open fracture of shaft of femur' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,SELECT COUNT(DISTINCT patient_id) FROM patients WHERE diagnosis = 'open fracture of shaft of femur' AND diagnosis_date > '2100-01-01'
e96d3b106469bfd953cd2583,"Was the potassium, urine reading for patient 10014078 second measured on the last hospital visit less than the value first measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN MAX(""K Urine"") < MIN(""K Urine"") THEN 'YES' ELSE 'NO' END AS ""Is Second Reading Less Than First"" FROM ""labevents"" WHERE ""subject_id"" = 10014078 AND ""category"" = 'Potassium' AND ""itemid"" = 50821 AND ""hadm_id"" = (SELECT MAX(""hadm_id"") FROM ""labevents"" WHERE ""subject_id"" = 10014078) GROUP BY ""hadm_id"""
6e552f2daf5bcd6d9a143315,Can you tell me the name of the diagnosis patient 10019568 received last since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,SELECT diagnosis_name FROM diagnoses WHERE patient_id = 10019568 AND diagnosis_date > '2100-01-01' ORDER BY diagnosis_date DESC LIMIT 1;
3ee6a4091b6e165e3eab53d4,When is the earliest appointment for patient 14467 for other departments?,,,SELECT MIN(appointment_time) AS earliest_appointment FROM appointments WHERE patient_id = 14467 AND department <> 'Cardiology'
4280ebde89a88a7f5565d9dd,W/is the code that corresponds to icd-11 for stomatits & mucosits nec in icd-10?,,,select code from icd11 where concept like '%stomatits & mucosits%'
23d5a55f9d6248b8d743d970,When was the first time patient 10004422 was prescribed a medication in 01/this year via the pr route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND prescriptions.route = 'pr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(DATETIME) as FirstPrescriptionDate FROM table_name WHERE PATIENT_ID = '10004422' AND YEAR(DATETIME) = YEAR(CURDATE()) AND MONTH(DATETIME) = 1 AND ROUTE = 'PR' AND DATETIME IS NOT NULL
c9f31ddb9aad553f281fb072,Can you tell which medicine was last prescribed to patient 10021118 via the oral method in 12/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'oral' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT * FROM prescriptions WHERE patient_id = '10021118' AND administration_method = 'oral' AND EXTRACT(YEAR FROM prescription_date) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY prescription_date DESC LIMIT 1
2d72caa3a5dafdb3b343b78e,Tell me the maximum total hospital cost that involves unspecified glaucoma in 2100.,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified glaucoma' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(TotalHospitalCost) AS MaxTotalHospitalCost FROM inpatient WHERE ConditionDescription LIKE '%unspecified glaucoma%' AND Year = 2100
233c13143fc7c9d92e63dbb4,What drugs are being added to the prescription of patient 10004733 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL Query Here
1f9b6689da5fdcc23879a5ac,What is the drug name that should not be administered during the above knee amputation procedure?,,,drug_name
73c5a29239e229c1e3d8d5f1,What was the first measurement of heart rate in patient 10004733's body since 22 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT TOP 1 measurement_date, heart_rate FROM patient_measurements WHERE patient_id = 10004733 AND measurement_date > DATEADD(DAY, -22, GETDATE()) ORDER BY measurement_date ASC"
3bf9272fcc3117ccfaed52f1,How much tamoxifen citrate was first prescribed to patient 10007795 since 10/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.drug = 'tamoxifen citrate' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT SUM(AMOUNT) FROM PRESCRIPTION WHERE RXNUMBER = 10007795 AND DRUG_NAME = 'TAMOXIFENE CITRATE' AND DATE >= '10/2100'
858671065bb8f7d96bf37f64,How was patient 10018328 last admitted to the hospital in terms of admission type?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018328 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1",[{'admission_type': 'SURGICAL SAME DAY ADMISSION'}],SELECT admission_type FROM admissions WHERE patient_id = '10018328' AND admission_date = (SELECT MAX(admission_date) FROM admissions WHERE patient_id = '10018328')
03e018e5065829295de0817f,When was patient 10022041 prescribed for the first time since 04/2100 a medication via sc route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(START_DATE) FROM OUTPATIENT_PRESERVATION WHERE PATIENT_NUM=10022041 AND MED_ROUTE='SC' AND START_DATE>'04/2100'
eac7992d495c881955ae12b8,Was patient 10021666 treated with insertion of (naso-)intestinal tube in the last year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of (naso-)intestinal tube' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"select * from Procedures where PatientID = '10021666' and ProcedureName LIKE '%insertion of (naso-)intestinal tube%' and DatePerformed >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
26b5659defc710e97b8055d7,What was the total amount of the output patient 10004733 had since 11/25/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-25'",[{'SUM(outputevents.value)': 17410.0}],select sum(output) from billing where patient_id=10004733 and date>'11/25/2100'
6084f134b156953797d6aff8,Can you tell me the name of the last output of patient 10004235?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 ),[{'label': 'Foley'}],"SELECT patient_id, name FROM Output WHERE patient_id = 10004235 ORDER BY output_date DESC LIMIT 1"
573ae8f84da94b97d13dd488,Tell me the average systolic blood pressure in patient 10021487 on 12/09/2100.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-09'",[{'AVG(chartevents.valuenum)': None}],SELECT AVG(Systolic_Blood_Pressure) AS Average_Systolic_BP FROM Blood_Pressure_Readings WHERE Patient_ID = '10021487' AND Reading_Date = '12/09/2100';
36ed6cc232d6795e6492644d,How many days has it been since the first rhabdomyolysis diagnosis of patient 10021487 on the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rhabdomyolysis' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT DATEDIFF(CURRENT_DATE, MIN(DiagnosisDate)) AS DaysSinceFirstDiagnosis FROM DiagnosisTable WHERE PatientID = '10021487' AND DiagnosisCode = 'rhabdomyolysis' AND EncounterID = (SELECT TOP 1 EncounterID FROM EncounterTable WHERE PatientID = '10021487' ORDER BY EncounterDate DESC) AND IsConfirmed = 1"
9bbd99cc180d65878b372ad9,Could you tell me the top three most common procedures for patients aged 30s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT procedure, COUNT(procedure) AS procedure_count FROM patient_records WHERE YEAR(admission_date) = 2100 AND age BETWEEN 30 AND 39 GROUP BY procedure ORDER BY procedure_count DESC LIMIT 3"
81ab57679b81047f17e36e2c,"What was the number of patients receiving venous catheterization, not elsewhere classified since 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )",,select count(patient_id) from catheterization where procedure_code = 'venous_catheterization' and procedure_date > '2100-01-01';
4b2f2ac3530b71844f36b481,Show me the top four diagnoses with the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT TOP 4 diagnosis, mortality_rate_6_month FROM patient_outcomes ORDER BY mortality_rate_6_month DESC"
44e0c98b6f1723e728d1382d,Which are the top three most common lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT `Test`, `Count` FROM `lab_tests` ORDER BY `Count` DESC LIMIT 3;"
99cc6b6a7018e6ce37338641,What are the top three common diagnoses since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as diagnosis_count FROM diagnoses WHERE date >= DATEADD(year, -1, GETDATE()) GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 3"
49da3f4c781d729017455057,How much am I expected to pay for central venous catheter placement with guidance?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) ),,Select the total expected payment from the 'CPT_Codes' table where the code is '36861' and the modifier is '26'
3dfb9565afee9c41fd63cc07,What is the percentile of 6.8 in the white blood cells lab test with the same age as patient 10009628 in their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 6.8",,SELECT PERCENT_RANK() OVER (ORDER BY `white blood cells`) FROM LabTests WHERE `patient id` = 10009628 AND `lab test` = 'white blood cells' AND `visit` = (SELECT MAX(`visit`) FROM LabTests WHERE `patient id` = 10009628) AND `age at test` = (SELECT `age at test` FROM LabTests WHERE `patient id` = 10009628 AND `lab test` = 'white blood cells' AND `visit` = (SELECT MAX(`visit`) FROM LabTests WHERE `patient id` = 10009628)) AND `white blood cells` <= 6.8
23016e3fbba29157468b85f0,What is the type of blood patient 10431 has.,,,SELECT BloodType FROM Patients WHERE PatientID = 10431
88eb5064597a8bdbd091db48,Does patient 7241 have a genetic test that they got?,,,select exists (select 1 from genetic_tests where patient_id=7241)
4fb913f81273537cc819bba4,"Which were the five most commonly ordered procedures for patients previously diagnosed with other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle during the same hospital encounter, since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"[SELECT procedure, COUNT(procedure) AS procedure_count"
65de4c7841bdbd16627b5d55,What are the top five most frequently taken specimens for patients within the same hospital visit after receiving thoracentesis?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracentesis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"select top 5 specimen from (select specimen, count(*) as specimen_count from specimenes group by specimen, visit_id order by specimen_count desc) as ranked_specimens group by specimen order by specimen_count desc limit 5;"
9c85a8ada2ee0422d27bcb39,What were the top five most common diagnoses that followed within 2 months for those who received insertion of endotracheal tube in this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal tube' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"select Diagnosis as Diagnosis, count(Diagnosis) as count from EMR where procedure='Insertion of Endotracheal Tube' and diagnosis_date between date_format(current_date, '%Y-01-01') and current_date and procedure_date between diagnosis_date- interval '2' month and diagnosis_date group by Diagnosis order by count desc limit 5;"
475d57ff575806d5690ed031,"During their first hospital encounter, what was the last time patient 10001217 had a medication via the iv route prescribed?",SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT TOP 1 prescription_time FROM prescriptions WHERE patient_id = 10001217 AND route = 'iv' ORDER BY prescription_time DESC
20de623f537039c51aaf5c1a,Give me the top three most commonly prescribed medications.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]",SELECT medication_name FROM prescriptions GROUP BY medication_name ORDER BY COUNT(*) DESC LIMIT 3
5cf893b312b240832f404b18,What is the void output for patient 10018845 since 103 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-103 day')",[{'SUM(outputevents.value)': None}],"SELECT * FROM patient_data WHERE patient_id = 10018845 AND DATEDIFF(CURDATE(), void_date) >= 103;"
6c72b9c6d194e26c1ee7f466,Does patient 21134 have any history of depressive disorder nec in his / her family?,,,SELECT * FROM PatientFamilyHistory WHERE PatientID = 21134 AND Condition = 'Depressive disorder nec'
8dbbbd8602f5f3527cad26cd,"What is the average total cost of a hospital, which includes a drug called lactulose since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lactulose' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_cost) FROM hospitals h JOIN hospital_drugs hd ON h.hospital_id = hd.hospital_id WHERE hd.drug_name = 'lactulose' AND hd.date >= '2100-01-01'
935b75442d1b950e70d20b8f,What was the name of the organism at the first sputum test of patient 10019777 since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT name FROM organism WHERE patient_id = 10019777 AND date >= '02/2100' ORDER BY date ASC LIMIT 1
bf8b0be840875d402d706d58,Can you show me the top five most frequent lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]",SQL query here
c4d75676ab4ff43eaf58b28b,When did patient 10021938 receive mrsa screen microbiology test the last time in 11/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '11' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],select max(date) from microbiology_tests where patient_id='10021938' and test_name='mrsa screen' and date like '2023-11%'
1ab67d97d6f153a086427f61,What was the name of the specimen given to patient 10002495 for the first time since 04/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'MRSA SCREEN'}],SELECT specimen_name FROM lab_tests WHERE patient_id = 10002495 AND date = (SELECT MIN(date) FROM lab_tests WHERE patient_id = 10002495 AND date >= '04/2100')
11a6356dddd6cc1e2a155810,Find out the number of hospital visits patient 10038933 had since 1 year ago.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10038933 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],SELECT COUNT(*) FROM hospital_visits WHERE patient_id = 10038933 AND visit_date > CURRENT_DATE - INTERVAL '1 year'
08ae61222ba27e2b2592fc0d,"During the last year, was patient 10001217 at the emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],select count(*) from visits where patientid=10001217 and facility='ER' and visitdate > now() - interval '1 year'
bd0c2e34f79eadadf992f4e2,How was patient 10005348 admitted in terms of admission type for the last time at the hospital?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10005348 ORDER BY admissions.admittime DESC LIMIT 1,[{'admission_type': 'EW EMER.'}],select admission_type from admission where patient_id=10005348 and admission_date = (select max(admission_date) from admission where patient_id=10005348)
767f78eb035eac463d6a7505,Get me the top five most common diagnoses during this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patient_records WHERE YEAR(visit_date) = YEAR(CURRENT_DATE) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
71e9ec4174f7ac09f0636302,What are patient 10019385's changes in respiratory rate second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT ""Delta"" FROM ""respiratory-rate"" WHERE ""PatientID"" = '10019385' AND ""VisitNumber"" = 1 AND ""DeltaType"" = 'SecondMinusFirst'"
e7e44b96a9f8a6f93d886bbd,What is the pricing for topiramate (topamax)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'topiramate (topamax)' ),,SELECT price FROM medications WHERE name='topiramate (topamax)'
55180086d87ad6ccdaca22f5,"For the last time since 03/2100, when was patient 10007818 prescribed vitamin d and aspirin at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10007818 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10007818 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = '10007818' AND (drug_name = 'vitamin d' OR drug_name = 'aspirin') AND prescription_date > '03/2100'
ad935ae937227d5927667234,What was the count of patients who were prescribed dexamethasone since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dexamethasone' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 7}],SELECT COUNT(*) FROM prescriptions WHERE drug_name = 'dexamethasone' AND date_prescribed >= '2100-01-01'
181fd571160a6bf269e75dda,Could you tell me the first arterial blood pressure diastolic value that patient 10005817 had?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],First Arterial Blood Pressure Diastolic Value
6208d84a6a16f8ac2b720298,How many days have elapsed since patient 10004733 stayed in the careunit medical/surgical intensive care unit (micu/sicu) for the last time on their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime DESC LIMIT 1",[],"[SELECT DATEDIFF(day, MAX(ADMITTIME), GETDATE()) AS days_elapsed"
9935a33215fc04cc9ed9c438,How many cases involved the prescription of sulfameth/trimethoprim ss this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'sulfameth/trimethoprim ss' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)': 0}],SELECT COUNT(*) AS total_cases FROM medication_prescriptions WHERE drug_name = 'sulfameth/trimethoprim ss' AND prescription_date BETWEEN '2023-01-01' AND '2023-12-31';
228014642a9c756b378d10cc,What drug was prescribed to patient 10010471 for the last time in the first hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[{'drug': 'Levofloxacin'}],SELECT top 1 drug_name FROM patient_prescriptions WHERE patient_id = '10010471' AND hospital_encounter_id = (SELECT MIN(hospital_encounter_id) FROM patient_encounters WHERE patient_id = '10010471') ORDER BY prescription_date DESC
7eb920ea8c935405a34f2187,What was the last time on their first ICU stay patient 10014078 had a minimum respiratory rate?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],SQL Query here
64d22396919485e14c973f06,What specimen test has patient 10038992 received for the last time since 10/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'BLOOD CULTURE'}],
17a79ba0e1aeb153b34e461a,Tell me the dose of an opioid prescribed to patient 1258?,,,SELECT dose FROM prescriptions WHERE patient_id=1258 AND drug_type='opioid';
4ce7bb3fe008b6d40897f421,When was patient 10020740 prescribed the drugs syringe (0.9% sodium chloride) and alteplase (catheter clearance) at the same time for the last time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'syringe (0.9% sodium chloride)' AND admissions.subject_id = 10020740 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alteplase (catheter clearance)' AND admissions.subject_id = 10020740 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],select max(a.drg_date) from (select drg.drg_date from drg where drg.patient_no='10020740' and drg.drug_code='syringe (0.9% sodium chloride)' group by drg.drg_date) as a left join (select drg.drg_date from drg where drg.patient_no='10020740' and drg.drug_code='alteplase (catheter clearance)' group by drg.drg_date) as b on a.drg_date=b.drg_date where a.drg_date=b.drg_date
2a09cc17e6b8947dbc425e98,How do i take precaution after the rt/left heart card cath procedure?,,,"SELECT precaution FROM HeartCathPrecautions WHERE procedureType IN ('rt heart card cath', 'left heart card cath')"
96e382017b141bc1518941f3,"Throughout this year, what are the three common diagnoses of patients of age 40s?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"select Diagnosis, count(*) as count from patient_diagnosis where birthdate between '1970-01-01' and '1980-12-31' group by diagnosis order by count desc limit 3"
9ff096e6083c879d4a6bfeb9,What is the name of the procedures that were given to patient 10015860 two or more times since 05/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,SELECT DISTINCT procedure_name FROM medical_records WHERE patient_id = 10015860 AND date >= '05/2100' GROUP BY procedure_name HAVING COUNT(*) > 1
f946291e703d6e542a4a7d37,Could you list the three most frequently prescribed medicines within the same hospital visit after a diagnosis of family history of ischemic heart disease was made during this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of ischemic heart disease' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"[SELECT TOP 3 m.med_name, COUNT(*) as prescription_count FROM `hms_hf_2m`.`visit_medicines` AS v JOIN `hms_hf_2m`.`medicines` AS m ON v.med_id = m.id WHERE v.visit_id IN (SELECT v1.visit_id FROM `hms_hf_2m`.`visit_diagnoses` AS v1 WHERE v1.diag_id IN (SELECT d.id FROM `hms_hf_2m`.`diagnoses` AS d WHERE d.description LIKE '%family history of ischemic heart disease%' AND YEAR(v1.visit_start_date) = YEAR(CURRENT_DATE)) AND v1.visit_id NOT IN (SELECT v2.visit_id FROM `hms_hf_2m`.`visit_diagnoses` AS v2 WHERE v2.diag_id IN (SELECT d.id FROM `hms_hf_2m`.`diagnoses` AS d WHERE d.description LIKE '%family history of ischemic heart disease%'))) AND v.med_prescription_date > (SELECT MIN(v3.visit_start_date) FROM `hms_hf_2m`.`visit_diagnoses` AS v3 WHERE v3.visit_id = v.visit_id AND v3.diag_id IN"
c98219f7cb3992603434bc25,Count the number of patients in neurology in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patients WHERE department = 'neurology' AND year_admitted = 2100;
001613e40181055fecd8dc18,Tell me the prescriptions patient 88180 has received from the other department.,,,
4613327670f705e8aa839350,Tell me the top five most frequently tested specimens since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]",""""""""
83fcd6e49ddcd0e710cd01fb,Could you retrieve the top five most conducted lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT TOP 5 Test_Name, COUNT(Test_ID) AS Test_Count FROM Lab_Tests WHERE Test_Date >= DATEADD(YEAR, -1, GETDATE()) GROUP BY Test_Name ORDER BY Test_Count DESC"
45147c4f6c84a8b896ec69ef,When since 07/2100 did patient 10007795 get the first microbiology test?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2136-04-14 14:31:00'}],SELECT MIN(date) AS first_microbiology_test_date FROM lab_results WHERE patient_id = '10007795' AND result_type = 'Microbiology' AND date > '2021-07-01'
3a5ab4d7328a4d17c25ac1f9,When was patient 10020740 last prescribed the medication via the td route in 05/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'td' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = '10020740' AND medication_route = 'td' AND EXTRACT(YEAR FROM prescription_date) = 2100 AND EXTRACT(MONTH FROM prescription_date) = 5
86c276704c3a408a1f31e367,"What is the total number of patients who underwent measurement of cardiac sampling and pressure, right heart, percutaneous approach?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, right heart, percutaneous approach' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS TotalPatients FROM procedure_procedure_code_value WHERE procedure_procedure_code_value.text LIKE '%measurement of cardiac sampling and pressure, right heart, percutaneous approach%'"
91985b654c4167748be8c66b,"During the first hospital encounter, was patient 10008454 admitted to an emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'COUNT(*)>0': 0}],select count(*) from hospital_encounter where patient_id = '10008454' and visit_type = 'emergency'
314918b25acf3b59dd2f8ad6,Can you tell me the top five most common treatments for patients in their 50s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"[SELECT Treatment, COUNT(*) AS Frequency FROM Patients"
892b40885727ac07a5ca1a88,Has patient 10018081 had a lab test done during this hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ),[{'COUNT(*)>0': 0}],SELECT COUNT(*) > 0 AS HadLabTest FROM lab_events WHERE encounter_id = (SELECT id FROM encounters WHERE patient_id = 10018081)
e595c43f7a0338c543bd80cb,Can you tell me when the last microbiology test for patient 10037975 was held since 29 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-29 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2185-01-22 02:55:00'}],"SELECT * FROM microbiology_tests WHERE patient_id = 10037975 AND test_date > DATE_SUB(CURDATE(), INTERVAL 29 MONTH) ORDER BY test_date DESC LIMIT 1"
fbd014c02af79a2d9c53a9d0,When was the first time patient 10038999 was prescribed a medication in 05/this year via the iv route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"select top 1 order_time from (select order_time from lab.orders o1 where o1.person_id=10038999 and order_time >= date_trunc('year', current_date) and order_time < date_trunc('year', current_date) + interval '1 year' and o1.order_type in ('pharmacy', 'refill') and o1.order_category in ('medication', 'injection', 'intravenous') and o1.route_code = 'IV') order by order_time limit 1"
9b0199c77936ada6960d0213,What was the last specimen test that was given to patient 10018328 since 17 months ago?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-17 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'URINE'}],[SELECT TOP 1 *
bf638c88c79e23f84c8e2529,Tell me the number of patients who were prescribed methylnaltrexone since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylnaltrexone' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 3}],SELECT COUNT(*) FROM prescriptions WHERE medication = 'Methylnaltrexone' AND prescribed_date >= '2100-01-01'
7a904ffff26972cedcca0166,What was the total amount of the output patient 10014078 had on 09/08/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '09-08'",[{'SUM(outputevents.value)': None}],SELECT SUM(amount) FROM output WHERE patient_id = '10014078' AND date = '2023-09-08'
95f50999819423b14b82ff47,Calculate the number of patients who were in the vascular careunit in the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patient_records WHERE careunit = 'vascular careunit' AND admission_date >= '2022-01-01' AND admission_date <= '2022-12-31'
f308aa77cb5c6fd783755cf4,And what was the last time patient 10022017 was prescribed medication using the oral route on their last hospital encounter?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"select top 1 encounter_date, encounter_id from encounter where patient_id = 10022017 and encounter_id = (select max(encounter_id) from encounter where patient_id = 10022017) and (select top 1 distinct pi.drug_id from prescription p inner join prescription_item pi on p.id = pi.prescription_id where p.encounter_id = encounter.encounter_id and pi.route = 'ORAL' order by pi.drug_id desc) is not null order by encounter_date desc"
c871c7a5d78c361289609381,What was the name of the medicine prescribed to patient 10037861 for the last time since 8 months ago?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-8 month') ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Influenza Vaccine Quadrivalent'}],"SELECT TOP 1 medicine_name FROM prescriptions WHERE patient_id = 10037861 AND prescription_date BETWEEN DATEADD(MONTH, -8, GETDATE()) AND GETDATE() ORDER BY prescription_date DESC"
00fbe516569113decea8de73,When was patient 10013049's last microbiological examination on their first hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'charttime': '2114-06-20 11:09:00'}],select max(date) from microbiology_exam where patient_id = '10013049' and visit_number = '1'
fe5c43f286b65fdccd87ecbd,Calculate the number of cardiac mapping procedures performed in the last year.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"SELECT COUNT(*) FROM cardiac_mapping_procedures WHERE procedure_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
2985f06b4e11ccad87836564,What percentile is chloride 104.0 among patients of the same age as patient 10002930 in their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 104.0",,"SELECT PERCENT_RANK() OVER (PARTITION BY age ORDER BY chloride) AS chloride_percentile FROM lab_events WHERE patient_id = (SELECT patient_id FROM (SELECT patient_id, MIN(hadm_id) AS first_encounter_id FROM lab_events GROUP BY patient_id) AS subquery WHERE patient_id = 10002930) AND lab_value = 104.0 AND itemid = (SELECT itemid FROM d_items WHERE category = 'chemistry' AND label = 'chloride')"
5c2aa0525c14c528390437bc,When was the last time since 04/2100 that patient 10020740 was prescribed with vancomycin and 5% dextrose at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10020740 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10020740 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(START_DATE) AS LastPrescribed FROM PRESCRIPTION WHERE PATIENT_NUM = '10020740' AND DRUG = 'Vancomycin' AND DRUG = '5%Dextrose' AND START_DATE >= '04/2100'
3f3da5d3397a4a8fe3d6fa12,Could you provide the total volume of output for patient 10015931 since 10/05/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-05'",[{'SUM(outputevents.value)': 10179.0}],SELECT SUM(volumes) FROM `physionet-data.mimiciii_clinical.outputevents` WHERE itemid = 227517 AND subject_id = 10015931 AND charttime >= '2100-10-05'
bbb5e4ef8fa79866856181d3,Patient 99747 is subject to covid-19 testing,,,SELECT * FROM patients WHERE patient_id = 99747 AND testing = 'covid-19'
3e18d6bc76b77c4f191e1259,"What is the price of a procedure named dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) )",,"SELECT price FROM procedure WHERE name = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic'"
c562491538e06939d07d281f,How much am I expected to pay for total esophagectomy?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ) ),,SELECT SUM(charges) FROM medical_procedures WHERE procedure_name = 'total esophagectomy'
202d3ee5d7d3e606014abe18,How much does it cost to get diagnostic of mechanical complication of automatic implantable cardiac defibrillator?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mechanical complication of automatic implantable cardiac defibrillator' ) ),,"SELECT ""cost"" FROM ""medical_services"" WHERE ""service_description"" = 'diagnostic of mechanical complication of automatic implantable cardiac defibrillator'"
4d49aa5a44c5a8b00e811bf8,"On their last hospital encounter, what was patient 10006053's age?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,SELECT patient_age FROM patient_records WHERE patient_id = 10006053 AND encounter_type = 'last hospital encounter'
2384e194896033ece54e7e01,How many levetiracetam prescriptions occurred?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'levetiracetam',[{'COUNT(*)': 14}],select count(*) as levetiracetam_prescriptions from prescriptions where drug = 'levetiracetam'
92360fdf128eef86912196c6,What is patient 10004235's minimum value of atypical lymphocytes in 03/2100?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'atypical lymphocytes' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",[{'MIN(labevents.valuenum)': None}],"SELECT MIN(value) AS Min_AtypicalLymphocytes FROM lab_results WHERE patient_id = '10004235' AND test_type = 'atypical_lymphocytes' AND date_part('month', result_date) = 03 AND date_part('year', result_date) = 2100;"
7c2d471282f8777074560c57,What was the name of the output the first time patient 10007928 had on their first ICU stay?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 ),[{'label': 'Foley'}],SELECT Name FROM Outputs WHERE PatientID = 10007928 AND ICUStayNumber = 1 ORDER BY OutputDatetime ASC LIMIT 1
91afc137c556b8c813b79b2a,"Since 03/2100, when did patient 10004235 receive the first sputum microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],[SELECT MIN(test_date) AS First_Sputum_Test_Date
ec318c164a262760140ba3ff,What is the number of drugs patient 10019172 was prescribed in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescriptions WHERE patient_id = 10019172 AND YEAR(date) = 2100
b1838eeaf67182e2d4080d5d,What were the top four most common specimens tested on patients in the same hospital encounter after the diagnosis of suicidal ideation?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,table name
3c0ac8693894186ae1e49461,Can you tell me the five most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]",Select the top 5 tests with the highest count from the microbiology_test table
41a9d1565306cee37678be20,Can you tell me the name of the last output of patient 10009035 since 03/02/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-02' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],SELECT TOP 1 output_name FROM patient_outputs WHERE patient_id = 10009035 AND output_date >= '03/02/2100' ORDER BY output_date DESC;
5cccb67414afa9206d2624db,What was the total or ebl output in patient 10027602 since 11/10/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-10'",[{'SUM(outputevents.value)': None}],select sum(total_ebl) as total_ebl_output from `physionet-data.mimic_core.patients` where subject_id = 10027602 and admission_date > '11/10/2100'
2a54dcb2e9a6ae1637d88ef8,When was the last time patient 10004422's SaO2 was less than 96.0 on 01/20/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 96.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-01-20' ORDER BY chartevents.charttime DESC LIMIT 1",[],select top 1 date from [vital sign
a0c6ba5a4eba9f8602ca88de,"In the last hospital encounter, was patient 10035185 diagnosed with any disease?",SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT disease FROM medical_records WHERE patient_id = 10035185 AND encounter_date = (SELECT MAX(encounter_date) FROM medical_records WHERE patient_id = 10035185)
5c5679626e1a978f60f24793,What is the difference between weights last measured on the first hospital visit compared to the second to last value measured on the first hospital visit for patient 10004720?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT `10004720`, `1`, `weight`, `weight` - LAG(`weight`, 2) OVER (PARTITION BY `id` ORDER BY visitno) AS `weight_difference` FROM `mimiciii_hospi` WHERE `weight` IS NOT NULL ORDER BY `weight_difference` DESC LIMIT 1"
6fede59c21de596953ecde6a,What was patient 10026354's total input amount of nacl 0.9% since 04/05/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-05'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input_amount) AS total_input_amount FROM infusion_events WHERE patient_id = '10026354' AND medication_name = 'nacl 0.9%' AND infusion_date >= '2100-04-05'
f9e2b0a131460704a8a57a4f,What are the top three most frequently performed procedures for patients who are 60 or above?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"select procedure_name, count(procedure_name) from medical_procedures where patient_age >= 60 group by procedure_name order by count(procedure_name) desc limit 3"
ced75cfc467f5facf66e9200,"Was in their first hospital encounter acetaminophen, aspirin, or furosemide prescribed to patient 10012853?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'acetaminophen', 'aspirin', 'furosemide' )",[{'COUNT(*)>0': 0}],"select patient_id, encounter_id, drug from prescriptions where patient_id = '10012853' and (drug = 'acetaminophen' or drug = 'aspirin' or drug = 'furosemide') and encounter_sequence = 1"
bf54c19771c5bb94ae4d9258,How many iso-osmotic dextrose prescription instances took place this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic dextrose' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescriptions WHERE description = 'iso-osmotic dextrose' AND YEAR(prescription_date) = YEAR(CURDATE())
65c849c2aad2c56207e5cd6e,What's the minimum total cost of the hospital encounters that involved a procedure called endoscopic insertion of stent (tube) into bile duct since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic insertion of stent (tube) into bile duct' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(Total_Cost) FROM hospital_encounters WHERE Procedure = 'Endoscopic insertion of stent (tube) into bile duct' AND Date > '2100-01-01'
62161016f653e9cf862c97dd,"When did patient 10038999 last receive the total protein, pleural test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT max(VisitDate) as LastTestDate FROM LABEVENTS WHERE Subject_id = 10038999 AND Itemid IN (SELECT Itemid FROM D_ITEMS WHERE Test_name = 'total protein, pleural')"
07032b1d51ef6d34a32ed424,Give me the top three most commonly prescribed medications since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]","SELECT TOP 3 MedicationName, COUNT(*) AS PrescriptionCount FROM Prescriptions WHERE Year >= 2100 GROUP BY MedicationName ORDER BY PrescriptionCount DESC"
65026ec4c48a494f09194273,Retrieve the top three most frequent lab tests in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],"SELECT lab_test, COUNT(*) AS frequency FROM lab_tests WHERE year = 2100 GROUP BY lab_test ORDER BY frequency DESC LIMIT 3"
4a8d139fbdf3433a295f03d3,Can you get me the top four most conducted lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","[SELECT Test, COUNT(Test) as test_count"
2e7f18557b9d9530eddacca0,How many hours has it been since the first time patient 10004733 visited careunit neurology during their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime ASC LIMIT 1",[],SELECT EXTRACT(EPOCH FROM CURRENT_TIMESTAMP - MIN(visit_start_time)) / 3600 AS hours_since_first_neurology_visit FROM visits WHERE patient_id = 10004733 AND careunit = 'neurology' AND CURRENT_VISIT_FLAG = 'Y' GROUP BY patient_id;
a311fd7b15cb7682fb46dbca,Has patient 10019917 visited the hospital since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019917 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT(*)>0': 1}],SELECT COUNT(*) AS visit_count FROM visits WHERE patient_id = 10019917 AND visit_date >= '2100-01-01'
476e4488035d145ab89ef7ae,How many patients stayed in careunit discharge lounge?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'discharge lounge' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patient_id) from stays where careunit='discharge lounge'
42caec4ca4a8bdfb2bf0e159,How many patients were given a creatinine lab test in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND strftime('%Y',labevents.charttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patient_id) from lab_test where lab_type = 'creatinine' and year = 2100
e14e80dd4ca4e48a6ecac19b,Can you tell me the average total hospital cost that involves lactated ringers this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lactated ringers' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_hospital_cost) AS average_cost FROM hospital_costs WHERE item_name = 'lactated ringers' AND year = '2023';
8060993fd02e3caa91347361,"Provide the top four most frequent diagnoses that patients were assigned within 2 months after receiving respiratory ventilation, greater than 96 consecutive hours.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,SQL Query Here
7c84a7a9dd72cfd25b8b859c,"Count the number of patients who received a procedure since 2100 for extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )",,SELECT COUNT(*) FROM medical_records WHERE procedure_code = 'EXTIRPATION_RIGHT_LOWER_LOBE' AND date >= '2100-01-01' AND method = 'ENDOSCOPIC'
40ce8982a0a966c5bbb74462,How much does the drug alprazolam cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'alprazolam' ),,SELECT AVG(price) AS AverageCost FROM medication WHERE name = 'alprazolam'
e720394bdbfa2cd55a520dc3,"After getting diagnosed with depressive disorder, not elsewhere classified, how many patients were found to have asymptomatic human immunodeficiency virus [hiv] infection status within 2 months since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'depressive disorder, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asymptomatic human immunodeficiency virus [hiv] infection status' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT COUNT(*) FROM diagnoses WHERE (diagnosis_description = 'Depressive Disorder, Not Elsewhere Classified' OR diagnosis_description = 'Depressive Disorder') AND (diagnosis_description = 'Asymptomatic HIV Infection' OR diagnosis_description = 'HIV Infection Status') AND date_diff(diagnosis_date, (SELECT MAX(diagnosis_date) FROM diagnoses WHERE diagnosis_description = 'Depressive Disorder, Not Elsewhere Classified' OR diagnosis_description = 'Depressive Disorder')) <= 60 AND diagnosis_date >= '2100-01-01'"
0f47e5f69b9a81be1ceeb52c,Can you tell me the last arterial blood pressure systolic of patient 10003046?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT max(Systolic) AS Last_Arterial_Blood_Pressure_Systolic FROM `physionet-data.mimiciii_v1.4.ARTERIAL_BLOODGAS` WHERE `ID` = 10003046
e7d4c4eea0ceb55fc4a7b51f,"During this hospital visit has iso-osmotic sodium chloride, lactated ringers, or metronidazole (flagyl) been prescribed for patient 10018081?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'iso-osmotic sodium chloride', 'lactated ringers', 'metronidazole (flagyl)' )",[{'COUNT(*)>0': 0}],"SELECT EXISTS(SELECT 1 FROM medical_records WHERE patient_id = '10018081' AND (prescribed_drug IN ('iso-osmotic sodium chloride', 'lactated ringers', 'metronidazole') AND visit_date = CURRENT_DATE)) AS prescribed_during_visit"
2a3d19cceb7e76962f6d84e6,Tell me all the prescriptions that patient 13054 received at the other department.,,,SELECT prescription FROM patient_records WHERE patient_id = 13054 AND department != 'CurrentDepartment'
3ac674efda7af01b7217b1a5,Tell me what the total foley output of patient 10006580 is since 03/10/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-10'",[{'SUM(outputevents.value)': None}],SELECT SUM(foley_output) FROM patient_data WHERE patient_id = 10006580 AND date >= '03/10/2100';
3d1061a32eb79f759245bffb,What was the count of patients who were prescribed glucagon during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS total_glucagon_prescriptions FROM prescriptions WHERE drug_name = 'glucagon' AND prescription_date BETWEEN '2023-01-01' AND '2023-12-31';
742e8151840906cdb2000fee,"Tell me the number of cases of extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic that occurred during this year.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,SELECT COUNT(*) FROM medical_procedures WHERE procedure_description LIKE '%extirpation of matter from left lower lung lobe%' AND procedure_type = 'endoscopic' AND procedure_date BETWEEN '2023-01-01' AND '2023-12-31'
e5dcbea951b8bc21c9c8bccf,What is the minimum total cost of the hospital visits which include medicines called ampicillin sodium since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_cost) AS min_total_cost FROM hospital_visits WHERE medicine_name = 'Ampicillin Sodium' AND date >= '2100-01-01'
fb466f1f12c24c1faea2fb13,"For the first time , how much lorazepam was prescribed to patient 10021487?",SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'lorazepam' ORDER BY prescriptions.starttime ASC LIMIT 1,[],select min(quantity) from prescription where patient_id = 10021487 and medication = 'lorazepam' and first_fill_date = (select min(first_fill_date) from prescription where patient_id = 10021487 and medication = 'lorazepam');
99327791c62b40dd242f407a,How much does the drug phenobarbital alcohol withdrawal dose taper (days 2-7) cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenobarbital alcohol withdrawal dose taper (days 2-7)' ),,SELECT SUM(cost) FROM drug_taper WHERE drug_name='phenobarbital' AND phase='alcohol withdrawal' AND phase_days BETWEEN 2 AND 7;
a77b1077b6a8778b2e1e5123,Was any free water medication given to patient 10024043 on 12/24/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'free water' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'",[{'COUNT(*)>0': 0}],
0a8995a9063c29d358b7b288,Tell me the average total hospital cost that involves atenolol in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'atenolol' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(TotalHospitalCost) FROM MedicalRecords WHERE MedicationName = 'Atenolol' AND Year = 2100
fa30ead3c41cae309bafcade,"What is the maximum total hospital cost including a rbc, pleural lab test since 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, pleural' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(Total_Hospital_Cost) FROM hospital_costs WHERE (Test_Type = 'RBC' OR Test_Type = 'Pleural Lab') AND Year >= 2100
ae715e89afd0fb60fdd2b53c,"Currently, how many patients are in the hospital?",SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(*) FROM patients WHERE status = 'admitted';
11e07c7cfecad5cb89401830,Give a count of the number of ICU visits of patient 10025612 in the first hospital visit.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT( DISTINCT icustays.stay_id )': 1}],""""""""
0f29c76985468daa67aa9e6d,What are the charges for a procedure called replacement of stent (tube) in biliary or pancreatic duct?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of stent (tube) in biliary or pancreatic duct' ) ),,SELECT charges FROM procedure_costs WHERE procedure_name = 'Replacement of stent (tube) in biliary or pancreatic duct';
38cab6c7f7f7fe731b55ebde,What is the code that corresponds to icd-11 for ac dvt/emb distl low ext in icd-10?,,,SELECT `icd11_code` FROM `code_conversion` WHERE `icd10_code` = 'I80.2'
9d89c1083e101a847c24df5f,What is the percentile of 96.0 for a po2 test given the same age as patient 10003400 on their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10003400 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 96.0",,"SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY po2) FROM (SELECT po2, age FROM labevents le JOIN (SELECT age FROM admissions a WHERE a.hadm_id IN (SELECT hadm_id FROM labevents le WHERE subject_id = 10003400 ORDER BY charttime DESC LIMIT 1) ) AS latest_encounter ON le.subject_id = latest_encounter.subject_id) AS po2_age_filtered WHERE age = (SELECT age FROM admissions a WHERE a.hadm_id IN (SELECT hadm_id FROM labevents le WHERE le.subject_id = 10003400 ORDER BY charttime DESC LIMIT 1))"
c1a661557ac7c238626ba6d2,What was the count of patients who were tested for base excess?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],Select count(distinct patient_id) from lab_results where test_name='base excess'
0a7229f1e72f42ee2dc14404,When was the first time patient 10008287 had an maximum po2 in their first hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],"SELECT MIN(date) FROM chartevents WHERE itemid=50806 AND subject_id=10008287 GROUP BY subject_id, hadm_id HAVING MAX(value) ORDER BY MIN(date) LIMIT 1"
713395a9d49099e4643f0ba9,When did patient 10029291 last get blood culture's microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],select max(test_date) from microbiology_tests where patient_id=10029291 and test_name='blood culture' and test_date>'2000-03-21'
b8f95a496d90e442273b2a33,"What was the last time that patient 10022041 was prescribed acetaminophen iv and phosphorus in 06/2100, at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen iv' AND admissions.subject_id = 10022041 AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phosphorus' AND admissions.subject_id = 10022041 AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"""""""<|file_sep|>""""""This script is for generating data for the test suite of the QDM-SQL task."
f9b43f1daa9180b4970abafe,Calculate the total volume of patient 10010471's input since 12/19/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19'",[{'SUM(inputevents.totalamount)': 37625.0}],SELECT SUM(input) AS total_input FROM patient_data WHERE patient_id = '10010471' AND input_date >= '12/19/2100';
3018865bd3e3ef7fcede4eb2,Could you list the five most common specimen tests carried out since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]","SELECT test_name, COUNT(*) AS test_count FROM tests WHERE date >= '2100-01-01' GROUP BY test_name ORDER BY test_count DESC LIMIT 5"
7f006b94d6653a3b89d33cc2,How many patients stayed on emergency department observation since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patientid) AS total_patients FROM emergency_department_observation WHERE admittime >= '2100'::time
96762825c5cbfa3426dc79a2,Is patient 10006580's hematocrit second measured on the first hospital visit less than the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","select count(*) from (select max(case when visit = 1 and seq = 2 then value else null end) < max(case when visit = 1 and seq = 1 then value else null end) as ""hematocrit_second_less_than_first"" from lab where lab.pat_id = 10006580 and lab.lab_test_name = 'Hematocrit') as subquery where hematocrit_second_less_than_first"
f2d594c951cd6c02275e0a17,Has there been any organism detected in the first microbiological examination of patient 10020944's sputum in 03/this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM microbiology_exam_results WHERE patient_id = '10020944' AND specimen_type = 'sputum' AND examination_stage = 'first' AND date_part('month', examination_date) = 3 AND result = 'detected' AND date_part('year', examination_date) = date_part('year', CURRENT_DATE)"
449a8617caa34f297b5f7f4a,When did patient 10015272 last take the microbiology test in 06/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(test_date) FROM microbiology_tests WHERE patient_id = '10015272' AND test_date BETWEEN '2100-06-01' AND '2100-06-30';
f9d583c499e7bd1c044a24a0,What was the drug that was prescribed to patient 10018501 within the same hospital visit after the alcohol detoxification since 10 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-10 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-10 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT medication_name FROM patient_records WHERE patient_id = 10018501 AND hospital_visit_date > (SELECT MIN(hospital_visit_date) FROM patient_records WHERE patient_id = 10018501 AND condition = 'alcohol detoxification' AND visit_date >= DATE_SUB(NOW(), INTERVAL 10 MONTH))"
9b8533703ff8eab23578f84c,Was patient 10022041 given a test on rdw in 06/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06'",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM blood_tests WHERE patient_id = '10022041' AND test_name = 'rdw' AND date_part('month', test_date) = 6 AND date_part('year', test_date) = 2100"
ae863d8431919bbfb1dca0db,What is the outpatient schedule today for dr. solis?,,,SELECT * FROM outpatient_schedule WHERE doctor_name = 'solis' AND appointment_date = CURRENT_DATE
91a1b7d722fd22c60cb7f9c7,"What are patient 10027602's changes in glucose, csf second measured on the first hospital visit compared to the first value measured on the first hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, csf' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, csf' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, csf' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, csf' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT (glucose_second - glucose_first) AS glucose_change, (csf_second - csf_first) AS csf_change FROM hospital_visits WHERE patient_id = 10027602 AND visit_number = 1"
f41dd60cef49db205a9a109e,What was the name of the drug that was last prescribed for patient 10027445 since 06/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Potassium Chloride'}],select top 1 drug_name from prescriptions where patient_id=10027445 and date_prescribed > '06/2100' order by date_prescribed desc
cd2f14c6acbcef17dcbd4989,What's the maximum yearly number of patients who had edema of male genital organs?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'edema of male genital organs' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,"SELECT MAX(yearly_patient_count) FROM (SELECT YEAR(visit_date) AS year, COUNT(DISTINCT patient_id) AS yearly_patient_count FROM patient_visits WHERE diagnosis = 'edema of male genital organs' GROUP BY YEAR(visit_date)) AS yearly_counts"
9d58a5b47d175751dafd7e2b,Reveal the drug name that was first prescribed to patient 10004235 via the po route in 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT drug FROM prescriptions WHERE patient_id = 10004235 AND route = 'po' AND YEAR(date_prescribed) = 2100 AND MONTH(date_prescribed) = 7 ORDER BY date_prescribed ASC LIMIT 1;
812b9c3cb24eb55cbd0989b6,What was the procedure conducted on patient 10020740 two or more times in 04/this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '04' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"[SELECT procedure, COUNT(*) AS frequency"
4741dccccfea59439b0c12b8,What is the maximum total hospital cost that involved a procedure called fluoroscopy of multiple coronary arteries using other contrast since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(Total_Hospital_Cost) AS MaxCost FROM hospital_charge WHERE Procedure_Description LIKE '%fluoroscopy of multiple coronary arteries using other contrast%' AND Date_of_Service >= '2100-01-01'
db1b480d2286ade3469fa410,What is the body weight change of patient 10038933 second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT (MAX(BODY_WEIGHT)-MIN(BODY_WEIGHT)) AS ""Body Weight Change"" FROM CHF.DATASET WHERE PATIENT_ID = 10038933 AND VISIT_NUMBER = (SELECT MAX(VISIT_NUMBER) FROM CHF.DATASET WHERE PATIENT_ID = 10038933)"
9f7246b3b545ea28dc8ff5ad,What was the minimum value of the respiratory rate of patient 10021666?,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ),[{'MIN(chartevents.valuenum)': None}],SELECT MIN(respiratory_rate) FROM `physionet-data.mimic_cxr.chest_xray_exam_table` WHERE subject_id = 10021666;
78784fbf49277b83517b9dba,Has patient 10026406 been to the er since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT(*)>0': 0}],select * from visits where patient_id = 10026406 and visit_type = 'ER' and timestamp >= '2100'
507c98230efbbf1d84008059,Is it patient 10003046's o2 saturation pulseoxymetry last measured on the last ICU visit greater than second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",select `10003046`.[`Patient`
5bdb71007a2f5b2c33e4bd71,What was the organism detected in patient 10016742's first swab microbiology test since 07/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'swab' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT organism FROM microbiology WHERE patient_id = '10016742' AND test_date >= '2023-07-21' ORDER BY test_date ASC LIMIT 1
23186572a878a351ae7acf5b,How many days have passed since patient 10018081's first hematocrit laboratory test on this hospital stay?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"select datediff(d, min(lab_drawn), max(los_discharge_date)) from lab where patient_id = 10018081 and lab_name = 'Hematocrit' and los_discharge_date is not null and isnumeric(lab_result) = 1"
8652b04e3fb0b55bfcabf37a,What was the count of patients who were prescribed phosphorus during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from prescriptions where medication='phosphorus' and prescription_date between '2022-01-01' and '2022-12-31'
c26a679f2556db96814fe4aa,What was the name of that first specimen test patient 10016742 got in 08/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT `specimen_name` FROM `specimen_tests` WHERE `patient_id` = 10016742 AND `test_date` BETWEEN '2023-08-01' AND '2023-08-31' ORDER BY `test_date` ASC LIMIT 1
c88b6042bd98d9ea98a91f19,What percentile is the value of 13.0 in anion gap among patients of the same age as patient 10024043 on the first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.0",,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY anion_gap) AS median_anion_gap FROM lab_results WHERE patient_id IN (SELECT patient_id FROM patients WHERE age = (SELECT age FROM patients WHERE patient_id = 10024043) AND encounter_id = (SELECT MIN(encounter_id) FROM encounters WHERE patients.patient_id = encounters.patient_id))
665268e8c88a193b5ec8005f,Please retrieve the daily maximum amount of patient 10022880's po intake input.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],"[select distinct date_format(record_date,'%Y-%m-%d') as date, max(amount) as max_amount"
0e480dd5efb5afb7821bf264,What did patient 10018081 first have as output on 12/31/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-31' ORDER BY outputevents.charttime ASC LIMIT 1 )",[],SQL Query
34477f844c8389585cdcabca,Has there been any organism detected during the first mrsa screen microbiology test of patient 10021118 since 05/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)>0': 0}],"select distinct o.organism, o.detected_at from microbiology_tests t join microbiology_organisms o on t.test_id = o.test_id where t.patient_id = 10021118 and t.test_type = 'mrsa screen' and t.test_date > '2100-05-01' order by o.detected_at"
774301e86755e13414d55d0b,What number of patients were in the emergency department since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM hospital_data WHERE department = 'emergency' AND admission_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
a2e230e390689e566a02bb77,Can you show me the three most frequently taken lab test?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(*) as test_count FROM lab_tests GROUP BY test_name ORDER BY test_count DESC LIMIT 3"
6277902bacde54e836a5d433,What are the four most commonly taken specimens for patients that received central venous catheter placement with guidance previously in the same hospital visit this year?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"select specimen, count(*) as count from lab_events where (category = 'Central Venous Catheter Placement' or category = 'Central Venous Catheter Placement with Guidance') and visit_occurrence_id in (select distinct visit_occurrence_id from lab_events where category = 'Central Venous Catheter Placement' or category = 'Central Venous Catheter Placement with Guidance') group by specimen order by count desc limit 4"
150dcba6b064df151fc6eaf3,How much is the difference of patient 10004235's weight last measured on the first hospital visit compared to the value first measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT last.visit_date - first.visit_date AS difference_in_days, last.weight - first.weight AS difference_in_weight FROM (SELECT visit_date, weight, ROW_NUMBER() OVER (PARTITION BY patient_id ORDER BY visit_date DESC) AS rn FROM patient_records WHERE patient_id = '10004235' AND visit_type = 'hospital') AS last WHERE rn = 1) AS last_visit, (SELECT visit_date, weight, ROW_NUMBER() OVER (PARTITION BY patient_id ORDER BY visit_date) AS rn FROM patient_records WHERE patient_id = '10004235' AND visit_type = 'hospital') AS first WHERE rn = 1) AS first_visit"
e96433c5e849a24c421d221b,"What was prescribed to patient 10015931 during the same hospital visit following their replacement of aortic valve with zooplastic tissue, percutaneous approach during this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT * FROM (SELECT p.patient_id, m.medication_name, m.medication_date FROM prescriptions p INNER JOIN medications m ON p.prescription_id = m.prescription_id WHERE p.patient_id = '10015931' AND m.medication_date BETWEEN (SELECT MAX(medication_date) FROM prescriptions p2 INNER JOIN medications m2 ON p2.prescription_id = m2.prescription_id WHERE p2.patient_id = '10015931' AND m2.medication_name LIKE '%aortic valve%' AND m2.medication_name LIKE '%zooplastic%' AND m2.medication_name LIKE '%percutaneous%') AND CURRENT_DATE) AS subquery WHERE subquery.medication_date <= DATE_ADD((SELECT MAX(medication_date) FROM prescriptions p3 INNER JOIN medications m3 ON p3.prescription_id = m3.prescription_id WHERE p3.patient_id = '10015931' AND m3.medication_name LIKE '%aortic valve%' AND m3.medication_name LIKE '%zooplastic%' AND m3.medication_name LIKE '%percutaneous%'), INTERVAL 1 MONTH);"
03d2b60423371ca98d1a99bc,"On their first hospital visit, was patient 10015272 given any diagnosis?",SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT diagnosis FROM patient_visits WHERE patient_id = '10015272' AND visit_number = 1
877f60bb26ea0d5229a4665b,What is the minimum total cost for the hospital when a rheumatoid factor lab test is involved since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rheumatoid factor' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT MIN(total_cost) FROM hospital_records WHERE lab_test = 'rheumatoid factor' AND test_date >= DATEADD(year, -1, GETDATE());"
82b62524391ca6823ef4cd75,How much does it cost to purchase diltiazem extended-release?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'diltiazem extended-release' ),,select distinct price from rxnorm where lower(name) like '%diltiazem extended-release%' and lower(name) not like '%free sample%'
01bc93ed00df686c5593006f,"For the last time, what was the medication that patient 10016150 was prescribed in 05/2100 via the im route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],select `Medication` from `MedicationAdministration` where `PatientID` = 10016150 and `Route` = 'IM' and `AdministrationDate` = (select max(`AdministrationDate`) from `MedicationAdministration` where `PatientID` = 10016150 and `Year` = 2100)
b6b449e2a6346dfeed443761,What were the three most frequently given diagnoses for patients who received anastomosis of hepatic duct to gastrointestinal tract previously within 2 months in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT diagnosis, COUNT(diagnosis) AS freq FROM patient_records WHERE procedure='anastomosis of hepatic duct to gastrointestinal tract' AND date_procedure BETWEEN DATE_SUB('2100-01-01', INTERVAL 2 MONTH) AND '2100-01-01' GROUP BY diagnosis ORDER BY freq DESC LIMIT 3"
51cdecbb594a8e0b5f169388,What was the last time on their current hospital visit patient 10021487 had the maximum plasma cells.,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'plasma cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],SELECT `last_date` FROM `patient` WHERE `patient_id` = 10021487 AND `last_date` IN (SELECT `date` FROM `observations` WHERE `observations`.`patient_id` = 10021487 AND `observations`.`component` = 'plasma cells' AND `value` = (SELECT MAX(`value`) FROM `observations` WHERE `observations`.`patient_id` = 10021487 AND `observations`.`component` = 'plasma cells'))
5e86d97c72cc49ff2ce98709,"List the top five most frequent diagnoses that patients were diagnosed with within 2 months after receiving bypass coronary artery, one artery from left internal mammary, open approach throughout this year.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 diagnosis, COUNT(diagnosis) as frequency FROM patient_records WHERE procedure_code = 'bypass_coronary_artery' AND approach = 'one_artery_from_left_internal_mammary' AND procedure_type = 'open' AND diagnosis_date BETWEEN procedure_date AND DATEADD(month, 2, procedure_date) AND YEAR(diagnosis_date) = YEAR(GETDATE()) GROUP BY diagnosis ORDER BY frequency DESC"
f8a7c82b3eb920c707fa250b,"On this month/10, when was the first input time for patient 10021487?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '10' ORDER BY inputevents.starttime ASC LIMIT 1",[],"SELECT MIN(input_time) FROM inputevents_mv WHERE subject_id = '10021487' AND category = 'Medications' AND input_date >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '9 months' AND input_date < DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '8 months'"
7b5324a4c69137200e0d74e2,What was the total amount of output from patient 10018081 since 12/19/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-19'",[{'SUM(outputevents.value)': 66945.0}],SQL Query Here
3751ff2eb0be4c22f7a8f752,How many days has it been since patient 10021487 first received the po2 lab test during their current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT DATEDIFF(CURRENT_DATE(), MIN(result_date)) AS days_since_first_test FROM lab_results WHERE encounter_id = (SELECT encounter_id FROM patients_encounters WHERE patient_id = 10021487 AND admission_date <= CURRENT_DATE() AND discharge_date >= CURRENT_DATE()) AND test_name = 'po2' AND patient_id = 10021487 GROUP BY patient_id"
21b5d63e1046e143cef88adf,When was the first time that patient 10007818 has been prescribed medication via the subcut route since 05/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'subcut' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],select distinct start_date from medication_events where patient_id='10007818' and route='subcut' and start_date > '05/21/00' order by start_date limit 1
bfda4e34737d0530a461ae0a,What was the total amount of chlorhexidine gluconate 0.12% oral rinse prescribed to patient 10011398 in the first hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(prescriptions.quantity) AS total_quantity FROM prescriptions INNER JOIN visits ON prescriptions.visit_id = visits.id WHERE prescriptions.medication = 'chlorhexidine gluconate 0.12% oral rinse' AND visits.patient_id = 10011398 AND visits.visit_number = 1;
a7a3de424d31c00f89567ff3,What are the five most frequently tested specimens for patients that received other incision of brain previously within 2 months in 2100?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"select top 5 Specimen from labevents l join patients p on l.subject_id = p.subject_id join admissions a on l.subject_id = a.subject_id join diagnoses_icd d on a.subject_id = d.subject_id where d.icd9_code = '995.2' and d.seq_num = 1 and a.admittime between dateadd(month, -2, '2100-01-01') and '2100-12-31' and p.gender = 'F' group by l.specimen order by count(*) desc"
8acb279371aec9d2ef64ac77,What treatment were provided to patient 10007795 two or more times in 08/this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '08' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"SELECT TreatmentID, COUNT(TreatmentID) AS TimesGiven FROM Treatments WHERE PatientID = 10007795 AND TreatmentDate BETWEEN '2023-08-01' AND '2023-08-31' GROUP BY TreatmentID HAVING COUNT(TreatmentID) >= 2;"
5732b3a1da02702d943f84d4,What output did patient 10018081 have for the first time since 04/07/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'OR Urine'}],SELECT `result.value` FROM `lab_tests` WHERE `patient_id` = 10018081 AND `test_date` >= '04/07/2100' ORDER BY `test_date` ASC LIMIT 1;
b5bfc514c70281b00a67544d,When was the last time patient 10004720 was measured respiratory rate greater than 9.0 on this month/06?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 9.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '06' ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(measurement_date) AS last_measurement_date FROM patient_measurements WHERE patient_id = '10004720' AND measurement_type = 'respiratory_rate' AND measurement_value > 9.0 AND DATE_TRUNC('month', measurement_date) = DATE_TRUNC('month', CURRENT_DATE)"
56a8d8e09edb2cee2e4d93a3,What is the medication that patient 4469 takes after that other department gives them?,,,select distinct medication from prescriptions where patient_id = 4469 and department = (select department from patient_history where patient_id = 4469)
632459fd456c31f024bdf938,How many times did patient 10004720 go to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],SELECT COUNT(*) AS Hospital_Visits FROM Hospital_Visits WHERE Patient_ID = '10004720' AND Visit_Date >= '2100-01-01';
1d1103ae4c20715e6f0ae678,Tell me the total clopidogrel dose that patient 10015931 has been prescribed since 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug = 'clopidogrel' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'",[{'SUM(prescriptions.dose_val_rx)': None}],"SELECT SUM(DOSE) AS Total_Dose FROM (SELECT DRUG, DOSE FROM PRESCRIBED_DRUGS WHERE PATIENT_ID = 10015931 AND DRUG = 'CLOPIDOGREL' AND DATE >= '12/2100' GROUP BY DRUG) AS Patient_Clopidogrel"
338a9d532066c9b092d97b39,Patient 10018328's age on their first hospital encounter was what?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,,"SELECT age FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY patient_id ORDER BY encounter_id) AS rn FROM encounter) WHERE patient_id='10018328' AND rn=1"
1e7f92fd5a7fad376555b6c5,When was patient 10004720 prescribed with a drug via the sc route for the first time in 12/this year?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'sc' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(prescription_date) AS first_sc_route_date FROM prescriptions WHERE patient_id = 10004720 AND route = 'sc' AND YEAR(prescription_date) = YEAR(CURRENT_DATE) AND MONTH(prescription_date) <= 12
a431657836c3ed7ccacaf64a,What was the name of the outputs that patient 10038933 first had since 03/26/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-26' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Foley'}],select name from outputs where patient_id = 10038933 and output_date >= '03/26/2100' order by output_date asc limit 1
17f65319b8a03eaeeb2840a5,What is dr. koch's outpatient treatment schedule today?,,,SELECT * FROM `outpatient_treatment_schedule` WHERE `doctor_id` = (SELECT `doctor_id` FROM `doctors` WHERE `name` = 'Dr. Koch') AND `date` = CURDATE()
9b0dc7c21af10bc7f1f0ef8b,How many patients were let go from hospitals in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS 'Number of Patients Discharged' FROM hospital_discharge_records WHERE discharge_year = 2100
d7a8e332af537a76ab296df1,What was patient 10023239's total volume of output since 03/06/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-06'",[{'SUM(outputevents.value)': 10250.0}],select sum(volume) from output where patient_id = '10023239' and date > '03/06/2100'
f460b01f60e21810e3c0e875,What would the average yearly number of patients diagnosed with coronary atherosclerosis of autologous vein bypass graft be since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,"select AVG(yearly_patients) from `physionet-data.mimiciii_clinical.diagnoses_icd` where icd_code in ('I25.7','Z95.1') and year >= 2100 group by year"
b4067b5953f2f9bf38f0cf12,"How many patients in 2100 were diagnosed with body mass index 35.0-35.9, adult within 2 months after the first diagnosis with anemia, unspecified?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"[SELECT count(distinct patid) FROM `physionet-data.mimiciii_clinical.admissions` admissions  JOIN `physionet-data.mimiciii_clinical.diagnoses_icd` diagnoses_icd ON admissions.hadm_id = diagnoses_icd.hadm_id  WHERE YEAR(admissions.admittime) = 2100 AND diagnoses_icd.icd9_code regexp '278.01|278.09|277.0|277.1|277.7|277.8|277.9|280|281.9|283.0|285.9|288.3|V62.41|V85.3|E65' AND diagnoses_icd.seq_num = 1 AND EXISTS (SELECT * FROM `physionet-data.mimiciii_clinical.diagnoses_icd` icd_anemia WHERE icd_anemia.hadm_id = admissions.hadm_id AND icd_anemia.icd9_code regexp '280' AND icd_anemia.seq_num = 1 AND icd_anemia.diagnoses_icd.charttime BETWEEN admissions.admittime AND DATE_ADD(admissions.admittime, INTERVAL 2 MONTH)) AND EXISTS (SELECT * FROM `physionet"
59e81ba463402dfebb19a04b,What's the cost to get other endovascular procedures on other vessels?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) ),,SQL Query Here
cd7621aeaf5bf1a22ca8394e,Has patient 91768 ever had any additional blood culture tests done.,,,SELECT DISTINCT * FROM blood_culture_tests WHERE patient_id = 91768
da332c7d00584e07d7258bc1,How many hours have passed since patient 10018081 last received a laboratory test of calculated total co2 in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MAX(lab_result.calculated_total_co2_date), NOW()) AS hours_since_last_test FROM lab_result WHERE lab_result.patient_id = 10018081 AND lab_result.test_type = 'Calculated Total CO2' AND lab_result.visit_id = (SELECT visit_id FROM visit WHERE patient_id = 10018081 ORDER BY visit_start_date DESC LIMIT 1) AND lab_result.calculated_total_co2_date IS NOT NULL"
044289b85d5894aef9a9825d,When did patient 10039831 receive a mrsa screen microbiology test for the first time since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(START_DT) FROM LAB_RESULTS WHERE PATIENT_ID = '10039831' AND TEST_CODE = 'MRSA Screen' AND START_DT > '03/2100'
6f8c9bec861a6567d7a9b284,When did patient 10029291's first input on 03/08/2100 occur?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-08' ORDER BY inputevents.starttime ASC LIMIT 1",[],SELECT input_date FROM inputs WHERE patient_id = '10029291' AND input_date >= '2100-03-08' ORDER BY input_date ASC LIMIT 1
e80cfa3eba8292aa667080e9,"In 2100, what are the top four most frequent medications prescribed during the same month to the patients in their 60 or above after they were diagnosed with atrial fibrillation?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"[SELECT TOP 4 medication_name, COUNT(*) AS frequency"
64cfab5e3bed0dbdd7d74834,When heparin and aspirin were prescribed to patient 10016150 for the last time in 05/this year at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"SELECT MAX(hd7.hcpcs_cd) AS max_heparin_date, MAX(hd7.hcpcs_cd) AS max_aspirin_date FROM `dataset*.unionall*.heparin` AS hd1 INNER JOIN `dataset*.unionall*.aspirin` AS hd7 ON hd1.patient_nbr = hd7.patient_nbr WHERE hd1.patient_nbr = 10016150 AND hd1.chartdate LIKE '2023-05%' AND hd7.chartdate LIKE '2023-05%' AND hd1.chartdate = hd7.chartdate"
c11781d3de0756093079a3b6,Give me the five most common microbiology tests since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]",SELECT TOP 5 test_name FROM microbiology_tests WHERE test_date >= '2100-01-01' GROUP BY test_name ORDER BY COUNT(*) DESC
3f24154f91b27bdc47594852,What are some of the immunocancerous drugs of the last 5 years,,,"SELECT DISTINCT drug_name, year_of_approval FROM drugs_table WHERE category = 'immunocancerous' AND year_of_approval >= YEAR(CURDATE()) - 5"
85c4cb07f011b2641b16c688,"What are the four most common diagnoses for patients who previously had the dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic procedure within 2 months since 1 year ago?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,Your SQL query here
32041f1a421a46a1ede56482,Calculate patient 10029484's total input amount of magnesium sulfate (bolus) on last month/23.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '23'",[{'SUM(inputevents.totalamount)': None}],select sum(amt) as total_mgso4 from chartevents where itemid=50912 and charttime between '2019-12-23 00:00:00' and '2019-12-30 23:59:59' and hadm_id = 10029484
3b483bc7971f9931801a356e,What are the top four commonly ordered treatments for patients in their 40s in this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT treatment, COUNT(*) as number_of_orders FROM patient_treatment_orders WHERE patient_age BETWEEN 40 AND 49 AND YEAR(order_date) = YEAR(CURDATE()) GROUP BY treatment ORDER BY number_of_orders DESC LIMIT 4"
5a251e4eca446bc174bf6ee3,Can you show me the three most frequently taken lab test since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","select TOP 3 lab_test, count(*) as frequency from patient_test where date_test >= date_sub(current_date(), interval 1 year) group by lab_test order by frequency desc"
4f945a0ea52625d2facbf443,What was the minimum platelet count value for patient 10021118 on their first hospital visit?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ),[{'MIN(labevents.valuenum)': None}],SELECT MIN(platelet_count) FROM lab_results WHERE patient_id = '10021118' AND visit_number = 1
8714a2c8bbdfbe82b744586d,When did patient 10008454 last have a maximum value of diastolic blood pressure on 12/06/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-06' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],SELECT MAX(diastolic_bp) FROM patient_vitals WHERE patient_id = '10008454' AND date = '2100-06-12'
13742e41da6ed8f3b472927c,"What are the five most typically ordered procedures for patients previously diagnosed with other symbolic dysfunction, which took place within 2 months in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other symbolic dysfunction' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"select top 5 p.Procedure, count(*) as Count from procedure p join patient pa on p.PatientID = pa.PatientID join diagnosis d on pa.DiagnosisID = d.DiagnosisID where d.DiagnosisName = 'symbolic dysfunction' and p.Date between dateadd(month, -2, '2100-01-01') and '2100-01-31' group by p.Procedure order by count(*) desc"
882e8bdaae60f6bdfa661677,"Give me the top three most frequent procedures that patients were given in the same hospital visit after receiving extirpation of matter from left common iliac vein, percutaneous approach since 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left common iliac vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"[SELECT procedure_name, COUNT(procedure_name) AS procedure_count"
9273f8ff183822a0ce4f95be,Ciprofloxacin iv - How much does it cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin iv' ),,"select ""cost"" from ""Ciprofloxacin iv"""
d0821c0025ab0c979c7f89c2,"When was the last time that patient 10015860 on the last hospital encounter was given a creatine kinase, mb isoenzyme lab test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT MAX(test_date) AS last_test_date FROM lab_tests WHERE patient_id = 10015860 AND test_name = 'Creatine Kinase, MB Isoenzyme' AND encounter_id = (SELECT MAX(encounter_id) FROM encounters WHERE patient_id = 10015860)"
339d3163e8bea1c8f13aabf3,What was the dose of insulin human regular that patient 10035185 was last prescribed?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND prescriptions.drug = 'insulin human regular' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT TOP 1 dose FROM Prescription JOIN Medication ON Prescription.medication_id = Medication.id WHERE patient_id = '10035185' AND Medication.name = 'Insulin human regular' ORDER BY date_prescribed DESC
84bfcde2dd95748732f9e8a4,When was patient 10019172 prescribed a medication via the po route the last time in 11/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(DATE) FROM prescriptions WHERE patient_id = '10019172' AND route = 'po' AND DATE BETWEEN '2100-11-01' AND '2100-11-30'
60d0f145200cc583dc1c9dbb,What genetic test did patient 70234 undergo?,,,SELECT test_name FROM genetic_tests WHERE patient_id = '70234';
80b96b20149664dff5b51fb1,"In 2100, what are the three frequently ordered treatments for patients who were diagnosed with personal history of other venous thrombosis and embolism within the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other venous thrombosis and embolism' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"select Treatment, count(*) as count from (select distinct t.PatientID, t.Treatment from Treatments t join Diagnoses d on t.PatientID = d.PatientID and t.OrderDate = d.DiagnosisDate where d.DiagnosisYear = 2100 and d.Diagnosis = 'Personal history of other venous thrombosis and embolism') t group by Treatment order by count desc limit 3"
0468c52ae504e3db09fd4e8d,Tell me what the top four most commonly prescribed drugs are in 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4",[],"SELECT DrugName, COUNT(PrescriptionID) as PrescriptionCount FROM Prescriptions WHERE Year = 2100 GROUP BY DrugName ORDER BY PrescriptionCount DESC LIMIT 4;"
73a651d26844c7e023b2bfc1,Share the four most frequently performed procedures since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT Procedure, COUNT(Procedure) AS Frequency FROM medical_records WHERE Date > DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY Procedure ORDER BY Frequency DESC LIMIT 4"
964c6e643ec90bc499a92aea,What are the three most common specimen tests that occurred in 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",[],SQL Query
dc2ea06004264d56a9d2fc41,What are the five most frequently ordered laboratory tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT LabTest, COUNT(*) AS NumberOfTests FROM LabOrders WHERE OrderDate > '2100-01-01' GROUP BY LabTest ORDER BY NumberOfTests DESC LIMIT 5"
b704681115ed8cf6b288919f,"Has patient 10016150 got a prescription for trazodone, rosuvastatin calcium, or metformin xr (glucophage xr) since 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.drug IN ( 'trazodone', 'rosuvastatin calcium', 'metformin xr (glucophage xr)' ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 0}],select distinct m.mbr_id from member m join prescription p on m.mbr_id = p.mbr_id join rxnorm r on p.ndc = r.ndc where m.mbr_id = 10016150 and ((r.rxnorm_name ilike '%trazodone%' or r.rxnorm_name ilike '%rosuvastatin calcium%' or r.rxnorm_name ilike '%glucophage xr%') and (p.rx_date >= '2021-01-01'))
966d1ead03418408fd0eccc1,How many patients were diagnosed with paroxysmal atrial fibrillation in 2100 after previously being diagnosed with pain in left shoulder within 2 months?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in left shoulder' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paroxysmal atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,[SELECT COUNT(DISTINCT PatientID) AS NumberOfPatients FROM Diagnoses AS AF
233eeb75a432587011a6b1bc,Has patient 10024043 entered the hospital?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10024043,[{'COUNT(*)>0': 1}],SELECT * FROM admissions WHERE patient_id = 10024043
47a339f3ee10d0098dafc8bd,Has patient 10038992 received a laboratory test since 08/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08'",[{'COUNT(*)>0': 1}],SELECT * FROM lab_results WHERE patient_id = 10038992 AND test_date > '2100-08-01'
a4ca19a5c33291f0beacd6c2,"What was the first time that the heart rate of patient 10018081 was, in the current ICU encounter, less than 85.0?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 85.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],"SELECT MIN(measurement_time) FROM `physionet-data.mimiciii_clinical.measurement` WHERE itemid IN (211, 220045) AND SUBJECT_ID = 10018081 AND HADM_ID = (SELECT HADM_ID FROM `physionet-data.mimiciii_clinical.icustay_detail` WHERE SUBJECT_ID = 10018081 ORDER BY INTIME DESC LIMIT 1) AND VALUE < 85.0"
dc972f955fcddfb8a89d6ba2,"List the top four most frequent microbiology tests given to patients after being diagnosed with accidental puncture or laceration during a procedure, not elsewhere classified in the same hospital visit throughout this year.","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental puncture or laceration during a procedure, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,
f59080441b975f79286dcd09,Tell me the top five most common lab tests since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(*) as frequency FROM lab_tests WHERE date >= '2100-01-01' GROUP BY test_name ORDER BY frequency DESC LIMIT 5"
11974f52e559145ce9f812f2,"Since 1 year ago, has patient 10009035 undergone a lab test?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 1}],SQL Query here
e6c07526b6246ff9377949ba,"Since 07/2100, what was the last drug that patient 10004720 was prescribed through the po/ng route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1",[],[SELECT prescription.drug_name
e24e59d7e21364890399468e,How much is the difference of patient 10003046's mean blood pressure measured at 2100-01-17 14:00:00 compared to the value measured at 2100-01-17 13:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-17 14:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-17 13:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-17 14:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-17 13:00:00' )"": None}]",select abs( (select mean_value from blood_pressure_data where patient_id = '10003046' and measurement_time = '2100-01-17 14:00:00') - (select mean_value from blood_pressure_data where patient_id = '10003046' and measurement_time = '2100-01-17 13:00:00') ) as difference
0ff24db141cbffff8252d7e6,When did the last discharge from the hospital happen for patient 10025612?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10025612 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2125-10-03 12:24:00'}],SELECT MAX(ED_3_4.DISP_DATETIME) AS LastDischargeDate FROM ED_3_4 WHERE PATID = '10025612'
d4677f8cd4b45df639326bef,Get the count of hospital visits by patient 10000032 since 1 year ago.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10000032 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 4}],"select count(*) from hospital_visits where patient_id = '10000032' and visit_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
5af27d478c355763b0000b8b,What are the precautions to take after the inc/exc/destr in ear nec procedure?,,,SELECT Precautions FROM Ear_Nec WHERE Procedure = 'inc/exc/destr' AND Section = 'PostOp' AND Condition = 'Ear'
12fbd03c50369014a82f4756,How many patients were let go from hospitals since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],"select count(distinct patient_id) from discharges where discharge_date between date_sub(now(), interval 1 year) and now()"
493f197a6d56dbacf99556ab,What are the three most regularly ordered treatments for patients previously diagnosed with anemia in other chronic diseases classified elsewhere during the same month in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia in other chronic diseases classified elsewhere' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,Your SQL query here
facfba9ab5edcbd30634f5b1,What was the average value of the SaO2 of patient 10023239?,SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ),[{'AVG(chartevents.valuenum)': None}],SELECT AVG(SaO2) FROM patient_measurements WHERE patient_id = 10023239
d06643d034d4d04e5457cae5,What are the total number of other and unspecified pneumonectomy procedures performed in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other and unspecified pneumonectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,SELECT count(*) FROM procedures WHERE year = 2100 AND (procedure_type = 'other pneumonectomy' OR procedure_type = 'unspecified pneumonectomy');
a962b9d8317a6e4edbdd29f0,What are the three most frequently prescribed drugs in the same hospital encounter to the patients aged 40s after they were diagnosed with acute embolism and thrombosis of left iliac vein in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute embolism and thrombosis of left iliac vein' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT drug_name, COUNT(*) AS frequency FROM prescriptions WHERE patient_age BETWEEN 40 AND 49 AND diagnosis = 'acute embolism and thrombosis of left iliac vein' AND encounter_year = 2100 GROUP BY drug_name ORDER BY frequency DESC LIMIT 3"
a40c239f553ad63c5c40cc4c,Can anyone tell me how many operating rooms are there now?,,,SELECT COUNT(*) AS `operating_rooms_count` FROM `operating_rooms` WHERE `status` = 'active';
c5b41500133543c1bd41eb66,How many patients were given metoprolol succinate xl prescriptions since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'metoprolol succinate xl' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS num_patients FROM prescriptions WHERE drug_name = 'metoprolol succinate xl' AND prescribed_date >= '2100-01-01';
24ad21be2a942f6c761d77d7,"During the first ICU stay, what was the first heart rate value of patient 10036156?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT first_value(hr) OVER (PARTITION BY pt_id ORDER BY row_id ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS first_hr FROM heart_rate WHERE pt_id = 10036156 AND first_icu_stay = 1
42a736dc3448b6c72bebe5a9,What's the minimum daily number of patients who were diagnosed with essential and other specified forms of tremor in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'essential and other specified forms of tremor' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,"SELECT MIN(daily_patients) FROM tremor_diagnoses WHERE diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' AND (diagnosis IN ('essential tremor', 'other specified forms of tremor')) GROUP BY diagnosis_date;"
825c5c877128209aef4d391e,"Tell me the cost of a procedure known as excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic.","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic' ) )",,"SELECT cost FROM procedure WHERE name = ""excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic"""
1e8e254a1ff71001475df244,What are the top five most frequent microbiology tests that patients were diagnosed with operating room of hospital as the place of occurrence of the external cause in the same month?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'operating room of hospital as the place of occurrence of the external cause' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"SELECT test_name, COUNT(test_name) AS test_count FROM microbiology_tests WHERE place_of_occurrence = 'operating room of hospital' GROUP BY test_name ORDER BY test_count DESC LIMIT 5;"
90ca159192db0f36dc910080,"What are the three most commonly ordered procedures for patients who were previously diagnosed with abdominal pain, unspecified site, which occurred within 2 months since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abdominal pain, unspecified site' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT procedure, COUNT(procedure) AS order_count FROM procedure_occurrence po JOIN person p ON po.person_id = p.person_id JOIN observation o ON po.person_id = o.person_id WHERE o.observation_concept_id = 1250 AND o.observation_date BETWEEN DATE_SUB('2100-01-01', INTERVAL 2 MONTH) AND '2100-01-01' GROUP BY procedure ORDER BY order_count DESC LIMIT 3"
b3d362f74a925702dfbb0a1d,"How many days have passed since the last time patient 10018081 received a lab test of sodium, urine during this hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"select datediff(current_date(), max(date)) from labevents where labevents.itemid = 50912 and labevents.subject_id = 10018081 and labevents.hadm_id = (select max(hadm_id) from labevents where labevents.subject_id = 10018081) and labevents.value is not null and labevents.value <> ''"
fbb2af617d1dcbd3c073bbe0,What were the top five frequent laboratory tests that patients had after they were diagnosed with paralytic ileus during the same hospital visit?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paralytic ileus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"[SELECT test_name, COUNT(*) AS test_count"
b9e107def562596e07c5c476,What is the average total hospital cost including a ck-mb index lab test?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ck-mb index' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT AVG(total_hospital_cost) AS average_total_cost FROM hospital_data WHERE test_type = 'ck-mb index lab test';
9e1a47f578512d0f3910fa36,Tell me the number of operating rooms available?,,,select count(*) from rooms where status = 'operating'
fe615a9fbe3f8b13bb56bbdf,How many days have elapsed since patient 10021487 has first received a other lab test on this hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT DATEDIFF(day, MIN(lab_date), MAX(hospital_visit_date)) AS days_elapsed FROM lab_tests WHERE patient_id = 10021487 AND test_type = 'other' AND hospital_visit_id = ? GROUP BY patient_id"
271c09dde1ad0ae0ce21d6e5,Can you list patient 10009628's daily maximum weight since 1 year ago?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT visit_id, visit_date, MAX(weight) AS daily_max_weight FROM `physionet-data.mimiciii_clinical.icustays` WHERE subject_id = 10009628 AND visit_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 YEAR) GROUP BY visit_id, visit_date ORDER BY visit_date ASC"
c578a495c2dae5a5b4a612bd,Can you get me the top five most conducted lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],"SELECT test_name, COUNT(*) AS test_count FROM lab_tests WHERE YEAR(test_date) = 2100 GROUP BY test_name ORDER BY test_count DESC LIMIT 5;"
b6d57a0c15272dbc69e39fc2,How many days has it been since the last time patient 10018081 visited careunit emergency department in this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1",[],"SELECT DATEDIFF(CURDATE(), MAX(visit_datetime)) FROM patient_visits WHERE patient_id = '10018081' AND careunit = 'emergency department' AND hospital_encounter_id = 'current_encounter_id'"
d24509cc1ab0dd341bb53f33,What was the last sodium chloride 0.9% dose that patient 10022880 was prescribed in 04/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND prescriptions.drug = 'sodium chloride 0.9%' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 [Dose
06f4ed18e0175feb847ceb18,Calculate the number of patients prescribed aluminum-magnesium hydrox.-simethicone in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'aluminum-magnesium hydrox.-simethicone' AND strftime('%Y',prescriptions.starttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) AS total_patients FROM prescriptions WHERE medication_name = 'aluminum-magnesium hydroxide-simethicone' AND prescription_date BETWEEN '2100-01-01' AND '2100-12-31'
c1b05b990820fdea69b71d1a,What are the five most commonly diagnosed diagnoses for patients who had previously received parenteral infusion of concentrated nutritional substances within 2 months since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,Your SQL goes here
d47700b1f0c8efe72117c59e,Tell me the five most common diagnoses since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS diagnosis_count FROM admissions WHERE admission_date >= '2100-01-01' GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 5"
c68f338d371ce9d209a15844,Reveal the drug name that was first prescribed to patient 10007818 via the iv route since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT drug_name FROM prescriptions WHERE patient_id = 10007818 AND route = 'iv' AND date_prescribed > '2100-05-01' ORDER BY date_prescribed ASC LIMIT 1
bfa5ac0d983d25c1bae0ffdb,"Was yellow cadd cassette, docusate sodium, or naloxone prescribed on the last hospital encounter for patient 10019568?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'yellow cadd cassette', 'docusate sodium', 'naloxone' )",[{'COUNT(*)>0': 0}],select * from prescriptions where patient_id = 10019568 and (drug_name = 'yellow cadd cassette' or drug_name = 'docusate sodium' or drug_name = 'naloxone') and encounter_date = (select max(encounter_date) from prescriptions where patient_id = 10019568)
2d4e78fac89671a4c99a7d95,Can you tell me when the last microbiology test for patient 10015931 was held since 9 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-9 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2177-03-27 11:54:00'}],"select top 1 test_date from microbiology_tests where patient_id = '10015931' and test_date >= date_sub(current_date, interval 9 month) order by test_date desc"
2c0f498a16183e884d741e15,What were the last alkaline phosphatase values of patient 10004733 in their current hospital visit?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT TOP 1 * FROM lab_tests WHERE patient_id = '10004733' AND test_name = 'alkaline phosphatase' AND visit_id = (SELECT MAX(visit_id) FROM visits WHERE patient_id = '10004733') ORDER BY test_date DESC
8940911fa3f2d95d03fc272e,Show me the top three most common treatments for patients aged 40s in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT treatment, COUNT(*) as treatment_count FROM patients WHERE YEAR(birth_date) BETWEEN 2060 AND 2069 AND YEAR(admission_date) = 2100 GROUP BY treatment ORDER BY treatment_count DESC LIMIT 3"
eb2f419e7f09df1b43df8f92,Tell me what the total foley output of patient 10039831 is since 07/14/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-14'",[{'SUM(outputevents.value)': None}],
af6abe939c498f156e856916,How much morphine sulfate (oral solution) 2 mg/ml was first prescribed to patient 10021312 in 08/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'morphine sulfate (oral solution) 2 mg/ml' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"select sum(quantity) from prescription where patient_id = '10021312' and medication = 'morphine sulfate (oral solution)' and strength = '2 mg/ml' and date_prescribed = (select min(date_prescribed) from prescription where patient_id = '10021312' and medication = 'morphine sulfate (oral solution)' and strength = '2 mg/ml' and strftime('%m', date_prescribed) = '08' and strftime('%Y', date_prescribed) = strftime('%Y', 'now'))"
299ef20e44a70d1ce5af952a,What are the new prescriptions for patient 10004733 today compared to those received yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"SELECT p.patient_id, p.prescription_date, p.medication_name FROM patient_prescriptions p WHERE p.patient_id = 10004733 AND p.prescription_date = CURRENT_DATE AND p.medication_name NOT IN (SELECT medication_name FROM patient_prescriptions WHERE patient_id = 10004733 AND prescription_date = CURRENT_DATE - INTERVAL '1 day')"
aafe7bc8473b0240ac6c912c,What is the maximum total cost of the hospital visits that included a medicine named heparin in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_cost) FROM hospital_visits WHERE medicine_name = 'heparin' AND YEAR(visit_date) = 2100
0cfe903dde7855d41478137f,How many patients had a ntprobnp lab test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ntprobnp' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS ""Patient Count"" FROM lab_test WHERE test_name = 'ntprobnp' AND test_date > DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
e8f9739dbbd0348fee454966,"During their last hospital encounter, what was patient 10037975's insurance plan?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicare'}],SELECT insurance_plan FROM hospital_encounters WHERE patient_id = 10037975 ORDER BY encounter_date DESC LIMIT 1
5ccf5c391f79452b6224e1f6,What was the name of the output that patient 10015860 got first?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) ORDER BY outputevents.charttime ASC LIMIT 1 ),[{'label': 'Void'}],SELECT name FROM (SELECT name FROM output WHERE patient_id = 10015860 ORDER BY date ASC) AS first_output LIMIT 1
3932e19e4ed3b0175cec67c4,Has patient 10007818 had a hospital admission in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007818 AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT(*)>0': 0}],SELECT * FROM admissions WHERE patient_id = 10007818 AND YEAR(admission_date) = 2100
56f862020ab17a92aac5b864,When did patient 10027602 get input for the first time since 06/13/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-13' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2201-10-30 12:08:00'}],SELECT MIN(input_date) FROM patient_data WHERE patient_id = '10027602' AND input_date > '06/13/2100'
1a393a5c12d21a7f7e392418,Retrieve the monthly minimum amount of patient 10001725's pre-admission/non-icu intake input since 03/12/2100.,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission/non-icu intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-12' GROUP BY strftime('%Y-%m',inputevents.starttime)",[],"SELECT EXTRACT(month FROM input_timestamp) AS month, MIN(amount) AS min_amount FROM patient_intake WHERE patient_id = 10001725 AND admission_status = 'pre-admission' AND department = 'non-icu' AND input_timestamp >= '2100-03-12' GROUP BY EXTRACT(month FROM input_timestamp) ORDER BY month ASC;"
c6a7a43a376d92df5f420f3d,Has patient 10009628 got a lab test in 09/this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '09'",[{'COUNT(*)>0': 0}],"select count(*) from lab_tests where patient_id = 10009628 and date_part('year', test_date) = date_part('year', current_date) and date_part('month', test_date) = 9"
09defcd24314b8496fb3d74c,What is the dosage of the prescribed opioid for patient 9619?,,,"SELECT OpioidName, Dosage FROM OpioidPrescription WHERE PatientID = '9619'"
207e6d0a6a9b812afab27ac7,Was the absolute eosinophil count value of patient 10038999 second measured on the first hospital visit less than the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN (SELECT absolute_eosinophil_count FROM eosinophil_count WHERE patient_id = 10038999 AND visit_number = 1 AND count_order = 'second') < (SELECT absolute_eosinophil_count FROM eosinophil_count WHERE patient_id = 10038999 AND visit_number = 1 AND count_order = 'first') THEN 'Yes' ELSE 'No' END AS Is_Lower
4ba1843465e5f775b2a892a8,What specimen test was last given in 11/2100 to patient 10005909?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(test) AS last_test FROM specimens WHERE patient_id = 10005909 AND test_date = '11/2100';
7f1d3e5201103ad28842a180,Please tell me what to prepare for the flexible sigmoidoscopy procedure,,,select * from procedure_preparation where procedure_name='flexible sigmoidoscopy'
5407c72b5374049d5ff42574,Can you tell me how much lansoprazole oral disintegrating tab costs?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lansoprazole oral disintegrating tab' ),,select avg(standard_cost) from drug where generic_name='lansoprazole oral disintegrating tab' and dosage='30 mg' and route='oral' and form='disintegrating tab'
d531eb280735fb30a757905a,"Will patient 7165 be provided with any additional urine,kidney test?",,,select * from test where patient_id=7165 and test_type='urine' or test_type='kidney'
64873d6508dd0dea262a7cd7,"Throughout this year, what are the top five most common microbiology tests that patients were diagnosed with within 2 months after being diagnosed with saddle embolus of pulmonary artery with acute cor pulmonale?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'saddle embolus of pulmonary artery with acute cor pulmonale' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"select top 5 test_name, count(test_name) as count from microbiology_tests mt join diagnoses d on mt.patient_id = d.patient_id join (select patient_id, diagnosis_date from diagnoses where diagnosis in ('saddle embolus of pulmonary artery with acute cor pulmonale')) seap on mt.patient_id = seap.patient_id and mt.test_date between seap.diagnosis_date and dateadd(month, 2, seap.diagnosis_date) group by test_name order by count desc"
692d3013b67039704bfb1551,What was the total amount of output from patient 10021312 since 252 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-252 day')",[{'SUM(outputevents.value)': 2675.0}],"SELECT SUM(output) AS TotalOutput FROM patient_output WHERE patient_id = 10021312 AND date >= DATE_SUB(CURDATE(), INTERVAL 252 DAY)"
88c671a2840f4530415bcdf6,"What were the number of patients who received a hematocrit, calculated test?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL Query Here
1697a8cad9b6a471e01ec05a,"What was the name of the organism discovered in the first fluid,other test of patient 10021487 since 9 months ago?","SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid,other' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-9 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],[SELECT o.name
05ffeff678368c17b77078d6,When did patient 10022017 depart hospital for the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",[],select max(admit_date) from admissions where patient_id = 10022017 and discharge_date is not null
a96ef9e34778c695552e52c6,What is the sex of patient 10010471?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10010471,[{'gender': 'F'}],SELECT sex FROM patient WHERE patient_id = 10010471;
a7deec7678c37db84888ba96,"What new medications are there for patient 10018081 today, compared to the prescriptions given yesterday?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],Your SQL Query Here
09d05723516e1dd76fa1efe3,What is the cost of thoracoscopic lobectomy of lung?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic lobectomy of lung' ) ),,"SELECT AVG(cost) FROM medical_procedures WHERE procedure_name = 'thoracoscopic lobectomy of lung' AND department = 'surgery' AND date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
4ef144ef1e3cc810f42069d1,When was the last time the diastolic blood pressure of patient 10018081 registered less than 56.0 since 02/28/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 56.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-02-28' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT MAX(MeasurementDate) AS LastLowDiastolicBP FROM EHR.OMOP.cdm_v5_0.ClinicalEvents WHERE PersonID = '10018081' AND MeasurementDate > '2100-02-28' AND MeasurementValue < 56.0 AND MeasurementType = 'Diastolic Blood Pressure'
e8162ad0bfd3adb9a2c2f908,Does patient 13473 have a report of stricture of artery in his / her family?,,,SQL query goes here
3b5a20289fcb449af1962529,Can you tell me the name of the output patient 10018081 had for the first time today?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(outputevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY outputevents.charttime ASC LIMIT 1 )",[],"SELECT TOP 1 o.Name FROM Output o JOIN OutputPatient op ON o.OutputId = op.OutputId WHERE op.PatientId = '10018081' AND o.Date = CAST(GETDATE() AS Date) ORDER BY o.Date, o.Time"
82ed4968374026cba4624178,How many patients were diagnosed with asymptomatic human immunodeficiency virus [hiv] infection status within 2 months after first being diagnosed with mononeuritis of unspecified site in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mononeuritis of unspecified site' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asymptomatic human immunodeficiency virus [hiv] infection status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT COUNT(DISTINCT patient_id) FROM diagnosis_events WHERE diagnosis_code = 'hiv' AND diagnosis_status = 'asymptomatic' AND event_date BETWEEN diagnosis_events.event_date AND DATE_ADD(diagnosis_events.event_date, INTERVAL 2 MONTH) AND EXISTS (SELECT 1 FROM diagnosis_events AS subquery WHERE subquery.diagnosis_code = 'mononeuritis_unspecified' AND subquery.event_date <= diagnosis_events.event_date AND YEAR(subquery.event_date) = 2100) AND YEAR(diagnosis_events.event_date) = 2100"
799e3b8dccd0212e2b71456d,When was patient 10022017 first urine microbiologic test since 07/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(visit_date) AS first_test_date FROM microbiologic_tests WHERE patient_id = '10022017' AND specimen_type = 'urine' AND visit_date >= '2100-07-21' AND test_result IS NOT NULL
2fa869cf56451cb9220ecb8a,How much lorazepam was prescribed to patient 10019777 first in 03/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND prescriptions.drug = 'lorazepam' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT SUM(quantity) FROM prescriptions WHERE patient_id = 10019777 AND drug_name = 'lorazepam' AND prescription_date BETWEEN '2023-03-01' AND '2023-03-31' ORDER BY prescription_date ASC LIMIT 1
55f66285eac844245d46c2a6,When was the first hospital discharge time for patient 10007058?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007058 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2167-11-11 14:23:00'}],SELECT MIN(discharge_time) FROM hospital_discharge_records WHERE patient_id = 10007058;
8236653d88c7fec0c10aeb71,"On the current hospital visit, how many hours have passed since patient 10004733's first diagnosis of blood in stool?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'blood in stool' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - (SELECT diagnosis_date FROM PatientDiagnosis WHERE patient_id = '10004733' AND diagnosis_code = 'blood_in_stool'))) / 3600 AS hours_since_first_diagnosis FROM PatientDiagnosis WHERE patient_id = '10004733' AND diagnosis_code = 'blood_in_stool' ORDER BY diagnosis_date ASC LIMIT 1;
4de48cd89d593e47d6e93688,Tell me the four most common lab tests in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"SELECT test_name, COUNT(test_id) as test_count FROM lab_tests WHERE YEAR(test_date) = 2100 GROUP BY test_name ORDER BY test_count DESC LIMIT 4"
a041560dafe724349feb959f,How many patients currently in the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patients WHERE current_hospitalization_status = 'Yes'
367b2116257001fe013bc048,When is the earliest next visit of patient 8773 for other departments?,,,select min(visit_date) from visits where patient_id = 8773 and dept_id != 'ED' and visit_date >= current_date()
a46388d3c77f04af56eb9f4a,What was the last famotidine dose that patient 10001725 was prescribed on their last hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'famotidine' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT MAX(famotidine_dose) FROM hospital_visits WHERE patient_id = '10001725' AND discharge_date = (SELECT MAX(discharge_date) FROM hospital_visits WHERE patient_id = '10001725')
6b3c9e4d732df9f3eda20c41,Has patient 10026354 been provided with any medication since 7 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-7 month')",[{'COUNT(*)>0': 1}],[SELECT DISTINCT m.medication_name
57e26730a40f2a68869265ef,Has patient 10031404 undergone any procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT COUNT(*) FROM procedures WHERE patient_id = 10031404 AND procedure_date > '2100-01-01'
7af1e69b20b9be325402ee3c,Is the creatinine value last measured on the last hospital visit in patient 10023239 greater than the value from the first measurement on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN MAX(CASE WHEN m.seq = (SELECT MAX(seq) FROM measurement WHERE mrn = 10023239 AND visit_id = (SELECT MAX(visit_id) FROM measurement WHERE mrn = 10023239)) THEN value END) > MAX(CASE WHEN m.seq = (SELECT MIN(seq) FROM measurement WHERE mrn = 10023239 AND visit_id = (SELECT MAX(visit_id) FROM measurement WHERE mrn = 10023239)) THEN value END) THEN 'Yes' ELSE 'No' END AS result FROM measurement m WHERE m.mrn = 10023239 AND m.visit_id = (SELECT MAX(visit_id) FROM measurement WHERE mrn = 10023239) AND m.itemid = 50800
29c36a36cc9362584821e13f,When were patient 10007795 last prescribed for gemfibrozil and heparin at the same time in 05/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10007795 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(STARTDATE) as LastPrescriptionDate FROM ENROLMENT WHERE PATID = 10007795 AND DRUGNAME = 'heparin' AND STARTDATE <= '05/31/2011' AND STARTDATE >= '05/01/2011' AND PATID IN (SELECT PATID FROM ENROLMENT WHERE DRUGNAME = 'gemfibrozil' AND STARTDATE <= '05/31/2011' AND STARTDATE >= '05/01/2011')
73275404fad47edb177ee8d4,When was patient 10021487 prescribed a 5% dextrose and furosemide at the same time for the first time this month?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'furosemide' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"select min(e.startdate) from ehr_treatment_exposure e where e.patient_id = '10021487' and e.startdate >= '2018-02-01' and e.startdate < '2018-03-01' and (e.drug_name = '5% dextrose' or e.drug_name = 'furosemide') and e.drug_name in (select drug_name from ehr_treatment_exposure where patient_id = '10021487' and startdate between e.startdate and e.enddate and drug_name in ('5% dextrose', 'furosemide')) group by e.patient_id, e.drug_name having count(distinct e.drug_name) = 2"
f51f73add40fa25cc0d3936a,What was the amount of insulin human regular that was prescribed to patient 10009035 for the last time since 05/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND prescriptions.drug = 'insulin human regular' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],[select distinct * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select *
9073e579594a4c3f92dad212,What were the top five diagnoses most frequently diagnosed in this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"select diagnosis, count(*) as frequency from encounters where encounter_date >= '2023-01-01' and encounter_date <= '2023-12-31' group by diagnosis order by frequency desc limit 5"
f8c81bc0c7a1707c6d543598,Tell me the name of the prescription drug that patient 10007058 was prescribed in the same hospital visit after having a fluoroscopy of multiple coronary arteries using other contrast procedure in 11/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '11' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,[select t2.drug_name
236ef17c9fdf9071b7c4a6b4,"What are the five most frequently prescribed drugs within 2 months to the patients aged 40s after they were diagnosed with constipation, unspecified?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 medication_name, COUNT(*) as prescription_count FROM prescriptions JOIN diagnoses ON prescriptions.patient_id = diagnoses.patient_id JOIN patients ON prescriptions.patient_id = patients.patient_id WHERE diagnoses.diagnosis_code = 'constipation_unspecified' AND diagnoses.diagnosis_date BETWEEN DATEADD(month, -2, GETDATE()) AND GETDATE() AND patients.age BETWEEN 40 AND 49 GROUP BY medication_name ORDER BY prescription_count DESC;"
479ae3deb06c95266bad80c8,What was patient 10027602's arterial blood pressure systolic for the first time since 244 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-244 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],[SELECT TOP 1 BP_systolic AS 'First Systolic BP'
bedebf884aabb5a8dcfaed9a,"Number of patients who were diagnosed in 2100 with urinary tract infection, site not specified.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )",,[SELECT COUNT(*) AS NumberOfPatients
99c9abca99f18fa8ddc1f20a,How old was patient 10006053 during their last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,"SELECT (DATEDIFF(year, p.dob, lhe.admit_date) - CASE WHEN DATEADD(year, DATEDIFF(year, p.dob, lhe.admit_date), p.dob) > lhe.admit_date THEN 1 ELSE 0 END) AS 'Age at Last Hospital Encounter' FROM person p JOIN (SELECT patient_id, MAX(admit_date) AS 'admit_date' FROM hospital_encounter GROUP BY patient_id) lhe ON p.person_id = lhe.patient_id WHERE p.person_id = 10006053;"
0dd4139bd1f8141dabb5746b,When will patient 92846 be next seen by the hospital?,,,SELECT MIN(appointment_date) FROM appointments WHERE patient_id = 92846 AND status = 'scheduled' AND appointment_date > CURRENT_DATE
89b3f7739b080ee0246b9f58,"In this year, has patient 10003046 received a diagnosis?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,SELECT COUNT(*) AS num_diagnoses FROM diagnosis WHERE patient_id = 10003046 AND YEAR(diagnosis_date) = YEAR(CURRENT_DATE)
df5256f4811843aaeca939a2,"For the last time , how much 0.9% sodium chloride (mini bag plus) was prescribed to patient 10026255?",SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND prescriptions.drug = '0.9% sodium chloride (mini bag plus)' ORDER BY prescriptions.starttime DESC LIMIT 1,[],select sum(quantity) from prescriptions where drug_name = '0.9% sodium chloride (mini bag plus)' and patient_id = 10026255 and date = (select max(date) from prescriptions where patient_id = 10026255 and drug_name = '0.9% sodium chloride (mini bag plus)')
9535260fe83b84161cfcbef0,What are the three commonly taken specimens for patients that received insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s) previously within the same month in this year?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,SELECT TOP 3 specimen_type FROM patient_records WHERE procedure = 'insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)' AND procedure_date BETWEEN '2023-01-01' AND CURRENT_DATE AND previous_procedure_date = procedure_date - INTERVAL '1 month' GROUP BY specimen_type ORDER BY COUNT(*) DESC;
618d392ae43e6fe30006328e,When did patient 10020187 have the maximum value of SaO2 for the first time during their first ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],SELECT MIN(EDV.DateTime) FROM EDV WHERE EDV.PatientID = '10020187' AND EDV.ICULOS = 0 AND EDV.SaO2 = (SELECT MAX(SaO2) FROM EDV WHERE EDV.PatientID = '10020187' AND EDV.ICULOS = 0)
a1faad0653a8f9dc687564e5,Could you calculate the total amount of output from patient 10012552 since 04/02/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-02'",[{'SUM(outputevents.value)': 8408.0}],SELECT SUM(output) FROM catheter_output WHERE patient_id = '10012552' AND date >= '2100-04-02'
0d6abd33276d5170877ee1fa,How much is the difference of heart rate of patient 10000032 last measured on the first ICU visit compared to the second to last value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT (MAX(bpm) - MIN(bpm)) AS heart_rate_difference FROM `physionet-data.mimiciii_v1.labevents` WHERE subject_id = 10000032 AND (charttime BETWEEN (SELECT MIN(charttime) FROM `physionet-data.mimiciii_v1.icustays` WHERE subject_id = 10000032) AND (SELECT MAX(charttime) FROM `physionet-data.mimiciii_v1.icustays` WHERE subject_id = 10000032)) AND itemid = 220045
d683e1297440d54816fb0549,"On 06/14/2100, what was the last value of heart rate of patient 10009049?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-06-14' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT MAX(heartRate) as lastHeartRateValue FROM patient_data WHERE patient_id = '10009049' AND timestamp = '06/14/2100'
e0871385561b20faaecfa48c,What is the total number of patients who were discharged from the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(patient_id) AS total_discharged FROM hospital_records WHERE discharge_date > '2100-01-01';
92eed7c2713d3eb38d53dcd1,What is the maximum total cost of the hospital visits that include hemodialysis since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_cost) FROM HospitalVisits WHERE treatment = 'hemodialysis' AND visit_date >= '2100-01-01';
65a768c5a05156a43362b231,"In 11/2100, what was the last time patient 10029484 had a medication via the po/ng route prescribed?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = 10029484 AND medication_route = 'po/ng' AND YEAR(prescription_date) = 2100 AND MONTH(prescription_date) = 11
78805907705a4fd44978901b,When was patient 10005817 prescribed 0.9% sodium chloride and insulin human regular at the same time for the last time in this month?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10005817 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin human regular' AND admissions.subject_id = 10005817 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"select max(date_prescribed) from prescriptions where patient_id = '10005817' and (medication_name = '0.9% sodium chloride' or medication_name = 'insulin human regular') and date_prescribed >= date_trunc('month', current_date) group by patient_id having count(distinct medication_name) = 2"
5452c625522e88957199e9f0,Tell me the total number of patients who were diagnosed with acute pyelonephritis since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute pyelonephritis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,SELECT COUNT(*) AS total_patients FROM patients WHERE diagnosis = 'acute pyelonephritis' AND diagnosis_date >= '2100-01-01'
40073884463d17bc3702a2fc,Did patient 10038999 undergo a c3 laboratory test in 06/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c3' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM lab_tests WHERE patient_id = '10038999' AND test_name = 'c3' AND test_date BETWEEN '2100-06-01' AND '2100-06-30'
6fd61e60148bb599c1a2a048,What is the sex of patient 10009035?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10009035,[{'gender': 'M'}],SELECT sex FROM `physionet-data.mimiciii_clinical.patients` WHERE subject_id = '10009035'
6dfb148b96ec46dd4baf1399,What is the minimum total hospital cost which includes a drug named phenobarbital alcohol withdrawal dose taper (days 2-7) since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phenobarbital alcohol withdrawal dose taper (days 2-7)' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_hospital_cost) FROM hospital_cost_table WHERE drug_name LIKE '%phenobarbital alcohol withdrawal dose taper%' AND (current_date - admission_date) >= INTERVAL '1 year'
1f9d4e5d9ff5a5dce1860541,"What were the top four most common microbiology tests for patients who were previously diagnosed with spinal stenosis, lumbar region, without neurogenic claudication within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"SELECT test_name, COUNT(*) AS frequency FROM microbiology_tests WHERE patient_diagnosis = 'spinal stenosis, lumbar region, without neurogenic claudication' AND test_date BETWEEN DATE_SUB(diagnosis_date, INTERVAL 2 MONTH) AND diagnosis_date GROUP BY test_name ORDER BY frequency DESC LIMIT 4"
bcf8bddfe8dcd3e449454450,So how many hours has passed since patient 10021487's first traumatic hemothorax without mention of open wound into thorax diagnosis during this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic hemothorax without mention of open wound into thorax' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT TIMESTAMPDIFF(HOUR, MIN(admit_date), NOW()) AS hours_since_first_diagnosis FROM patient_records WHERE patient_id = 10021487 AND diagnosis = 'traumatic hemothorax' AND 'open wound into thorax' NOT IN (SELECT DISTINCT diagnosis FROM patient_records WHERE patient_id = 10021487 AND visit_date BETWEEN admit_date AND discharge_date) AND visit_date = (SELECT MAX(visit_date) FROM patient_records WHERE patient_id = 10021487)"
c3cb7b770179052c67712e37,Patient 10009628's age during their last hospital visit was what?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,SELECT age FROM hospital_visits WHERE patient_id = '10009628' ORDER BY visit_date DESC LIMIT 1
1a89de1d88c68408b38a9c56,"In 2100, how many medications were prescribed to patient 10006053?","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],select count(*) from medication_prescriptions where patient_id = 10006053 and year = 2100
7c5c504415d7c151349eda86,When did patient 10019385 have a last free calcium laboratory test?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) ORDER BY labevents.charttime DESC LIMIT 1,[],select the latest date from `labevents` where `itemid` is the item code for free calcium and `subject_id` equals 10019385
65f468deef71db0042d17c04,Provide the monthly maximum weight of patient 10005909 during the first hospital visit.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT MAX(WEIGHT) AS MaxWeight, EXTRACT(MONTH FROM ADMISSION_DATE) AS Month FROM [DATASET"
a0fe46cb093192a88d6cf061,When did patient 10010471 last receive a lab test for troponin t during the first hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,[],"SELECT MAX(admit_datetime) AS ""Last Lab Test Date"" FROM LAB_EVENTS WHERE patient_id = '10010471' AND labtestname = 'troponin t' AND hospital_nbr = 1"
deb0649dc5dfba070e57b20a,"What were the top four most common procedures that occurred within the same hospital visit for patients who had extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic before since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT procedure_name, COUNT(*) as count FROM procedures WHERE hospital_visit_id IN (SELECT hospital_visit_id FROM procedures WHERE procedure_name = 'Extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' AND procedure_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AND procedure_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND hospital_id = (SELECT hospital_id FROM procedures WHERE procedure_name = 'Extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' AND procedure_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) GROUP BY procedure_name ORDER BY count DESC LIMIT 4"
9c7b53fbe9d379b7315c6ec8,What was the organism's name found in the last blood culture test of patient 10038999 in the last hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],select distinct (a.value) from observation b where b.subject_id = 10038999 and b.encounter_id in (select max(encounter_id) from observation where subject_id = 10038999 group by subject_id) and b.concept_id = 3025314 and b.value_source_concept_id in (select c.concept_id from concept c where c.concept_name like '%organism%') and b.value_source_concept_id is not null and b.value_source_concept_id != 'Unspecified' and b.observation_datetime = (select max(d.observation_datetime) from observation d where d.observation_id = b.observation_id) and b.value_source_value is not null and b.value_source_value != 'Unspecified'
f17da97011f380b6bc7c87eb,Show me the top five most common diagnoses of patients aged 60 or above this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,Your SQL Query Here
c1ae78fc2d85e6eca4bb40d9,How many patients had thoracoscopic lobectomy of lung done in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic lobectomy of lung' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )",,SELECT COUNT(*) FROM patient_data WHERE procedure = 'thoracoscopic lobectomy of lung' AND YEAR(procedure_date) = 2100
bd3f5f6c3bbd8425f3cceaf4,What was the last time in 03/this year patient 10019777 had the maximum absolute monocyte count.,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute monocyte count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],SELECT TOP 1 RecordedTime FROM BloodWork WHERE PatientID = '10019777' AND YEAR(RecordedTime) = YEAR(GETDATE()) AND AbsoluteMonocyteCount = (SELECT MAX(AbsoluteMonocyteCount) FROM BloodWork WHERE PatientID = '10019777' AND YEAR(RecordedTime) = YEAR(GETDATE())) ORDER BY RecordedTime DESC
5067e04f2073e7595e4a57ad,When did patient 10039708 receive the last blood culture microbiology test during the first hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood culture' ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT TOP 1 date_performed AS LastBloodCultureDate FROM laboratory_events WHERE patient_id = '10039708' AND hospital_visit_id IN (SELECT hospital_visit_id FROM hospital_visits WHERE patient_id = '10039708' ORDER BY admission_date ASC LIMIT 1) AND test_type = 'Blood Culture Microbiology' ORDER BY date_performed DESC
09c4726f77bd8073eeb8d985,Calculate the number of medicines that patient 10015860 was prescribed since 10/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'",[{'COUNT(*)': 644}],select count(distinct m.medicine_name) as total_medicines from patient_medication p join medicine m on p.medicine_id = m.id where p.patient_id = 10015860 and p.prescription_date >= '2100-10-01'
ffbd9d197177ca7b317f66cb,Can I know the total output amount for patient 10039997 since 04/16/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-16'",[{'SUM(outputevents.value)': 5735.0}],SELECT SUM(output_amount) AS total_output_amount FROM patient_outputs WHERE patient_id = 10039997 AND output_date >= '2100-04-16'
c99ab73b237415f36d5185ab,Reveal the three most frequently prescribed medications during this year.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3",[],"SELECT medication_name, COUNT(*) AS prescription_count FROM prescriptions WHERE YEAR(prescription_date) = YEAR(CURDATE()) GROUP BY medication_name ORDER BY prescription_count DESC LIMIT 3"
bf8467e0d8948ac0db8f7fa1,"What are the three most frequently taken specimens for patients diagnosed with spinal stenosis, lumbar region, without neurogenic claudication previously within 2 months, in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"SELECT specimen_type, COUNT(*) AS frequency FROM procedures WHERE diagnosis = 'spinal stenosis' AND region = 'lumbar' AND neurogenic_claudication = FALSE AND procedure_date BETWEEN DATE '2100-01-01' AND DATE '2100-02-28' GROUP BY specimen_type ORDER BY frequency DESC LIMIT 3"
341d7a85d3366d8be3f55673,"Among patients who were administered fluoroscopy of superior vena cava using other contrast, guidance in 2100, what were the top three most common treatments that they received within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT TOP 3 TREATMENT_CODE, COUNT(*) AS TREATMENT_FREQUENCY FROM PROCEDURES p INNER JOIN TREATMENTS t ON p.PATIENT_ID = t.PATIENT_ID WHERE p.CODE = 'F0002' AND p.PROCEDURE_DATE BETWEEN '2021-01-01' AND '2021-03-01' GROUP BY TREATMENT_CODE ORDER BY TREATMENT_FREQUENCY DESC"
6fa5f1bd8164edcb10243287,What is the ward id that patient 10278 may be admitted?,,,SELECT ward_id FROM admissions WHERE patient_id = 10278;
890eb501221e32541f524d63,What are the three most frequently prescribed drugs?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]",SQL Query here
f294c7fe72b5826f97ff068a,Can you tell me the average respiratory rate for patient 10018501's body in their first ICU visit?,SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ),[{'AVG(chartevents.valuenum)': None}],SELECT AVG(respiratory_rate) FROM `physionet-data.mimiciii_clinical.icustays` INNER JOIN `physionet-data.mimiciii_clinical.chartevents` ON icustays.subject_id = chartevents.subject_id AND icustays.hadm_id = chartevents.hadm_id AND icustays.icustay_id = chartevents.icustay_id WHERE icustays.subject_id = 10018501 AND chartevents.itemid = 220277 AND icustays.icustay_number = 1
4eafb35434eb46de4c718a26,What was the name of the drug which was prescribed to patient 10020740 within 2 days after having received a endoscopic removal of stone(s) from biliary tract procedure since 9 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic removal of stone(s) from biliary tract' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-9 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-9 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,[SELECT DISTINCT drug.name
ee73ce9db61eca17bccfc7ee,Does patient 57050 have a past overseas travel experience?,,,SELECT EXISTS (SELECT 1 FROM `Patient` WHERE `id` = '57050' AND `overseas_travel_history` = TRUE)
d5331cbc78765c496545988f,Retrieve the top four most common lab tests.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(*) AS test_count FROM lab_tests GROUP BY test_name ORDER BY test_count DESC LIMIT 4"
9a6863fb555783adad183af6,Has patient 10006580 undergone any laboratory tests since 13 months ago?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(labevents.charttime) >= datetime(current_time,'-13 month')",[{'COUNT(*)>0': 1}],SELECT * FROM lab_tests WHERE patient_id = 10006580 AND test_date > CURRENT_DATE - INTERVAL '13 months'
cfc537434f52b06b620d9254,What is the minimum total expenditure of a hospital that involves the medication clarithromycin since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'clarithromycin' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_expenditure) AS minimum_expenditure FROM HospitalMedicationExpenditure WHERE medication_name = 'clarithromycin' AND year >= 2100;
11bbd36c75760dc9c37a98e7,"What was the maximum value of patient 10038999's total protein, pleural since 03/2100?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, pleural' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'",[{'MAX(labevents.valuenum)': None}],"SELECT MAX(""Total Protein, Pleural"") AS MaxProtein FROM lab_results WHERE ""Patient ID"" = '10038999' AND ""Specimen Collection Date"" >= '03/2100'"
98703366748022f38c396dfa,How much is the difference of patient 10027602's heart rate second measured on the last ICU visit compared to the value first measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SQL Query
bb88168bfe852b10ec4208d8,How many patients since 2100 left the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) AS patient_count FROM admissions WHERE discharge_date >= '2100-01-01';
306f0ab7b65335f49a4bfc03,What was patient 10029291's insurance name on their last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicare'}],select distinct i.name from patient p inner join insurance i on p.insurance_id = i.id where p.id = 10029291 order by p.visit_date desc limit 1
09b0a7c875a861f6dca89576,What is patient 10011398's difference in heart rate from the value measured at 2100-12-27 10:00:00 compared to the value measured at 2100-12-27 09:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 10:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 09:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 10:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 09:00:00' )"": None}]","SELECT p.patientid, h1.hr - h2.hr AS heart_rate_difference FROM patient p JOIN hr h1 ON p.patientid = h1.patientid JOIN hr h2 ON p.patientid = h2.patientid AND h1.sampledatetime = '2100-12-27 10:00:00' AND h2.sampledatetime = '2100-12-27 09:00:00' WHERE p.patientid = '10011398'"
14b3bbee2a55aa5ae2fdf038,What's the maximum total cost of a hospital that involves type 2 diabetes mellitus with diabetic polyneuropathy?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus with diabetic polyneuropathy' ) ) GROUP BY cost.hadm_id ) AS T1,,select max(totcost) from lab where diag like '%type 2 diabetes mellitus%' and diag like '%diabetic polyneuropathy%'
5d5d324fca23706de226e43a,"First time, what drug was prescribed for patient 10014729 since 02/2100?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Milk of Magnesia'}],"SELECT MIN(prescription_date) AS first_prescription_date, drug_name FROM prescriptions WHERE patient_id = 10014729 AND prescription_date >= '2100-02-01' GROUP BY drug_name ORDER BY first_prescription_date LIMIT 1"
5542edc6eab94af30e250d96,What was the name of the drug that in the last hospital encounter patient 10038992 was first prescribed?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Sodium Chloride 0.9%  Flush'}],"select top 1 drug_name from prescriptions where patient_id = 10038992 and encounter_id = (select max(encounter_id) from encounters where patient_id = 10038992) order by encounter_start_date desc, prescription_time asc"
8cdc13df0df6b0ba2bfeed8c,I want to know the ward id that patient 1784 can go in and get in?,,,SELECT ward_id FROM Ward WHERE capacity > (SELECT COUNT(*) FROM Patient WHERE ward_id = Ward.ward_id) AND bed_type = (SELECT bed_type FROM Patient WHERE patient_id = 1784)
f46e8931e74e00facf2ddbd7,Could you tell me how many patients stayed in the neuro surgical intensive care unit (neuro sicu) careunit during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro surgical intensive care unit (neuro sicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(patientid) FROM careunit WHERE name = 'neuro sicu' AND date BETWEEN '2023-01-01' AND '2023-12-31';
0d3e4b5300ddd4eb6f8b7629,Tell me the total number of patients in neurology.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS total_patients FROM patients WHERE department = 'neurology';
4d42e61430e34d4e1be887dc,What was the organism found in the first mrsa screen test of patient 10020740 since 05/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],select organism from mrsa_screen where patient_id=10020740 order by test_date asc limit 1
6b877eb6c1fe51cbc74bc649,How many times was midazolam prescribed during the last year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)': 0}],"SELECT COUNT(*) FROM prescriptions WHERE drug_name = 'midazolam' AND prescription_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW()"
2e778bf667b5fbe90f44ef33,"Has patient 10040025 been prescribed with the medication clonidine patch 0.2 mg/24 hr, avapro, or spironolactone?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND prescriptions.drug IN ( 'clonidine patch 0.2 mg/24 hr', 'avapro', 'spironolactone' )",[{'COUNT(*)>0': 0}],[SELECT DISTINCT a.person_id
f375194eb5908ee511e720c4,"What was the first reticulocyte count, automated value during the last month for patient 10039708?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'reticulocyte count, automated' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT first_value(automated_value) OVER (ORDER BY date ASC) as first_reticulocyte_count FROM lab_results WHERE patient_id = '10039708' AND test_name = 'reticulocyte count, automated' AND date >= CURRENT_DATE - INTERVAL '1 month' AND date < CURRENT_DATE"
4562721f05a7c2b2666b8324,When was the last time that patient 10029291 in their last ICU visit had a mean blood pressure that was greater than 110.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 110.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],"SELECT `ICUStayId`, `ICULOS`, MAX(`MeanBloodPressure`) AS MaxPressure FROM `mimic_icu.patients` WHERE `PatientNumber` = 10029291 AND `MeanBloodPressure` > 110.0 GROUP BY `ICUStayId` ORDER BY `ICULOS` DESC LIMIT 1"
9d188dcdbafa3802c326bff0,Do you know the ward id of patient 31854 to which they are admitted?,,,SELECT ward_id FROM admissions WHERE patient_id = 31854
032dbf61616563e773c37078,"During this year, what are the top three most common medications prescribed during the same month to the patients aged 60 or above after they were diagnosed with leukocytosis, unspecified?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'leukocytosis, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 Medication, COUNT(*) AS PrescriptionCount FROM Prescriptions WHERE Month(DatePrescribed) = Month(GETDATE()) AND Year(DatePrescribed) = Year(GETDATE()) AND PatientAge >= 60 AND DiagnosisCode = 'Leukocytosis, unspecified' GROUP BY Medication ORDER BY PrescriptionCount DESC"
6e94c2a9ff1a11c41777ecf8,How much heparin was prescribed to patient 10036156 last since 05/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.drug = 'heparin' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SQL Query Here
0aab4dbdaf2cafdd4466a80a,Could you list the three most common specimen tests carried out?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT test_name, COUNT(*) AS test_count FROM tests ORDER BY test_count DESC LIMIT 3;"
2cf073ab2616ed40e6caa63d,Which medication was patient 10004235 prescribed during the same hospital encounter following the simple excision of other lymphatic structure procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,select * from `mimic-iv`._prescriptions p inner join `mimic-iv`._procedures pr on p.subject_id = pr.subject_id and p.hadm_id = pr.hadm_id and p.ordertime between pr.starttime and pr.endtime where p.subject_id = 10004235 and pr.icd9_code = '0' and pr.procedure_name = 'simple excision of other lymphatic structure' and pr.starttime > (select pr2.starttime from `mimic-iv`._procedures pr2 where pr2.subject_id = p.subject_id and pr2.hadm_id = p.hadm_id and pr2.icd9_code = pr.icd9_code and pr2.procedure_name = pr.procedure_name and pr2.starttime < pr.starttime order by pr2.starttime desc limit 1)
65e654ff18e5887458e5aa25,Could you tell me the three most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]",your sql here
9628d71c349327c8e53e3df4,Could you provide me with the three most frequent output events this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],"SELECT output_event, COUNT(*) AS event_count FROM event_log WHERE event_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY output_event ORDER BY event_count DESC LIMIT 3;"
bb9f9e41ece52e577d67ea85,Is there a code that matches icd-11 for male gen inflam dis nec in icd-10?,,,[SELECT '1' FROM codes
f1e1021aefe5f99b0283d0b0,How much is the maximum total cost of the hospital visits that involve a drug named bisacodyl since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bisacodyl' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_cost) FROM visits WHERE drug_name = 'bisacodyl' AND visit_year >= 2100;
e1e117c17a8d654329d349cf,Give me the top three most frequent treatments patients received within 2 months after being diagnosed with other abnormal glucose in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other abnormal glucose' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT treatment, COUNT(*) as frequency FROM patient_records WHERE diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' AND diagnosis_code = 'other_abnormal_glucose' AND treatment_date BETWEEN diagnosis_date AND DATE_ADD(diagnosis_date, INTERVAL 2 MONTH) GROUP BY treatment ORDER BY frequency DESC LIMIT 3"
8f2bc494dad4b896a4fa2912,What are the top five most common specimens tested after receiving hemodialysis in the same month in 2100?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,SQL Query Here
7e545989763b5dd9c6a9df0b,What is the percentile of the anion gap value of 25.0 among patients of the same age as patient 10007818 during their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 25.0",,SELECT PERCENT_RANK() OVER (ORDER BY anion_gap) FROM lab_results WHERE patient_id IN (SELECT patient_id FROM hospital_encounters WHERE patient_id IN (SELECT patient_id FROM patients WHERE patient_id = 10007818) AND encounter_num = 1) AND lab_test_name = 'Anion Gap' AND lab_result_value = 25.0
819929d03e825e64c34b20ad,Tell me about the most common five output events since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT event_name, COUNT(*) AS frequency FROM OutputEvents WHERE year >= 2100 GROUP BY event_name ORDER BY frequency DESC LIMIT 5"
f12b990bb88ff1470ae0fbd2,What was the admission type during patient 10023239's first entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10023239 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1",[{'admission_type': 'EW EMER.'}],select ...
e238659bcf9847845f0c8f30,Give me patient 10007928's length of stay in days for the last ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.859664352145046}]","SELECT DATEDIFF(day, MIN(admission_date), MAX(discharge_date)) AS LengthOfStay FROM icu_stays WHERE patient_id = '10007928' AND stay_id = (SELECT MAX(stay_id) FROM icu_stays WHERE patient_id = '10007928')"
7d6cd973b881473d4b309a26,Provide the count of ICU visits for patient 10022017 last year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 0}],SELECT COUNT(*) AS icu_visits_last_year FROM admissions WHERE patient_id = 10022017 AND admission_type = 'ICU' AND YEAR(admission_date) = YEAR(CURRENT_DATE - INTERVAL 1 YEAR);
77bf5aa2f4ab92df9d557a77,What was the drug name that patient 10037861 was first prescribed through the ih route on the last hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'ih' ORDER BY prescriptions.starttime ASC LIMIT 1,[],select distinct drug_name from prescriptions where patient_id = 10037861 and route = 'ih' order by visit_date desc limit 1
9dbe9323c793aa4ded67391f,"Tell me the maximum total cost of a hospital visit involving a total nucleated cells, csf lab test?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, csf' ) ) GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_charge) AS max_total_cost FROM lab_tests WHERE test_name = 'total nucleated cells' AND test_type = 'csf lab test'
e6fc71341c7764ba95e7f656,What's the cost of a drug known as ranitidine (liquid)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ranitidine (liquid)' ),,SELECT cost FROM Drugs WHERE name='ranitidine' AND form='liquid'
b081cbc08146d7b9ab265566,Does patient 69761 have a scheduled appointment in another department?,,,SELECT EXISTS(SELECT 1 FROM APPOINTMENT WHERE patient_id = 69761 AND department_id <> (SELECT department_id FROM APPOINTMENT WHERE patient_id = 69761 LIMIT 1))
503c5dc62ab633d813594e59,What was the last specimen test given to patient 10007818 during their last hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'spec_type_desc': 'BLOOD CULTURE'}],"[SELECT MAX(test_date) AS last_test_date, test_type"
4bb969590b7a2c2464c7bb44,Tell me the length of time in days for patient 10019172's last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.4558912040665746}]",
db4af3e1cff04a496f2168cb,"Among patients who underwent excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic since 2100, what were the top four diagnoses they received within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 Diagnosis, COUNT(*) AS DiagnosisCount FROM PatientRecords WHERE Procedure = 'excision of right main bronchus' AND ProcedureType = 'natural or artificial opening endoscopic' AND ProcedurePurpose = 'diagnostic' AND ProcedureDate >= '2100-01-01' GROUP BY Diagnosis ORDER BY DiagnosisCount DESC"
1f7e6a11b09b66d4eb7904e1,Which drug was the last one prescribed for patient 10037861 since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Influenza Vaccine Quadrivalent'}],SELECT TOP 1 drug FROM prescriptions WHERE patient_id = 10037861 AND prescription_date >= '2100-07-01' ORDER BY prescription_date DESC
416bb5f6b916ace9fd639fbc,Retrieve patient 10015272's daily average weight on their last hospital visit.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],SELECT AVG(weight) AS DailyAverageWeight FROM patient_visits WHERE patient_id = 10015272 AND visit_date = (SELECT MAX(visit_date) FROM patient_visits WHERE patient_id = 10015272) GROUP BY visit_date
7824e920bc0ac651cb49b706,Which immunocauteries have been used for the last five years?,,,SELECT DISTINCT Immunocauteries FROM Treatments WHERE Year >= YEAR(CURDATE()) - 5
6bffa26dd035a9778fad2e76,Can you confirm what was the last heart rate for patient 10016150?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT heart_rate FROM patient_readings WHERE patient_id = '10016150' ORDER BY reading_time DESC LIMIT 1
17c962c6c3323c0e76fe972c,Just a quick look closed bronchial biopsy but how long did it take for patient 28443??????,,,SELECT duration FROM bronchial_biopsy_records WHERE patient_id = 28443 AND procedure_status = 'closed'
0385a3df53040e9eb91837ff,What is the procedure that patient 10007795 received two times?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,select procedure from patient_procedure where patient_id = 10007795 group by procedure having count(procedure) = 2
5d325bcbd050d7d6eabfcab9,Have any procedures been performed on patient 10019568 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,select * from procedures where patient_id = 10019568 and start_time >= '2100' order by start_time desc limit 1
113cd45e55e5ce4b019aad28,What's the total of phenytoin infatab prescriptions since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phenytoin infatab' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 0}],SELECT SUM(COST) FROM phenytoin_infatab WHERE DATE >= '2100-01-01'
aaf18ebab994cddb6afcd715,"On the first hospital stay, what was the last diagnosis for patient 10038081?",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,SELECT last_diagnosis FROM hospital_stays WHERE patient_id = 10038081 AND stay_number = 1 ORDER BY admission_date DESC LIMIT 1
45fcb3df912430805e7d3f94,What was the medication patient 10005817 was prescribed for the last time on the last hospital encounter via the ng route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'ng' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"[SELECT medication, encounter_date"
5fb41130df29e6ca3349cd41,What is the difference between respiratory rate second measured on the last ICU visit compared to the first value measured on the last ICU visit for patient 10019172?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT D1.resprate - D2.resprate AS resprate_difference FROM icustays AS I1, d_items AS D1, d_items AS D2 WHERE I1.subject_id = 10019172 AND D1.icustay_id = I1.icustay_id AND D2.icustay_id = I1.icustay_id AND D1.charttime = (SELECT MAX(charttime) FROM d_items WHERE icustay_id = I1.icustay_id AND itemid = 220045) AND D2.charttime = (SELECT MIN(charttime) FROM d_items WHERE icustay_id = I1.icustay_id AND itemid = 220045) AND D1.itemid = 220045 AND D2.itemid = 220045;"
f361e5d739050e86c0f5c75f,"On 10/22/this year, what was the average value of the diastolic blood pressure for patient 10031757?","SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '10-22'",[{'AVG(chartevents.valuenum)': None}],SELECT AVG(`diastolic`) FROM `health_records` WHERE `patient_id` = '10031757' AND `date` = '2023-10-22'
781a848c0f1a072d4667722d,Is patient 21074 subject to tests involving covid-19?,,,"SELECT COUNT(*) AS test_count FROM test_results WHERE patient_id = 21074 AND test_name IN ('COVID-19', 'COVID-19 PCR', 'COVID-19 Antigen')"
653d08c20f74e5bc126dbcac,"Get me the top five most frequent medications that patients were prescribed with during the same month after being diagnosed with personal history of other endocrine, nutritional and metabolic disease.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other endocrine, nutritional and metabolic disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 medication_name, COUNT(*) AS prescription_count FROM prescriptions p JOIN diagnoses d ON p.patient_id = d.patient_id WHERE d.diagnosis_code = 'Personal history of other endocrine, nutritional and metabolic disease' AND MONTH(p.prescription_date) = MONTH(d.diagnosis_date) AND YEAR(p.prescription_date) = YEAR(d.diagnosis_date) GROUP BY medication_name ORDER BY prescription_count DESC"
c62375c94b9f079a0f6c7c91,When was the first time when patient 10020187 was prescribed 0.9% sodium chloride and levetiracetam at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10020187 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'levetiracetam' AND admissions.subject_id = 10020187 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"select min(a.start_date) as earliest_date from medication_events a, medication_events b where a.patient_id=b.patient_id and a.medication_id=""0.9% sodium chloride"" and b.medication_id=""levetiracetam"" and a.start_date=b.start_date and a.patient_id=10020187 group by a.patient_id"
ad87f821d1417e88606b21d0,What are the five most commonly diagnosed diagnoses for patients who had previously received laparoscopic lysis of peritoneal adhesions within 2 months in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic lysis of peritoneal adhesions' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) as diagnosis_count FROM diagnoses WHERE patient_id IN (SELECT patient_id FROM procedures WHERE procedure_name='laparoscopic lysis of peritoneal adhesions' AND procedure_date BETWEEN '2100-01-01' AND '2100-02-28') GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 5"
85d696e2a18d54f7bdd92de8,What was the last instance when the respiratory rate of patient 10018501 was less than 35.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 35.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],"SELECT measurement_date, respiratory_rate FROM patient_measurements WHERE patient_id = '10018501' AND respiratory_rate < 35.0 ORDER BY measurement_date DESC LIMIT 1"
b6ac0c7fa5f88067047b90e0,When was the last time patient 10004720 had the maximum ptt since 12/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],"SELECT MAX(PTT) AS MaxPTT, MAX(DATE) AS LastDate FROM lab_results WHERE PATIENT_ID = 10004720 AND DATE >= '12/2100' GROUP BY PATIENT_ID"
238589d4d2a414a0aa04c9b5,Can you tell me about patient 10000032's age during the first hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,,SELECT age FROM encounters WHERE patient_id = '10000032' ORDER BY encounter_date ASC LIMIT 1
b9dd894208060adb71afcbfc,What was the drug first prescribed to patient 10013049 in the first hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': '5% Dextrose'}],"select dr_treatment, min(encounter) from lab_encounter where mrn='10013049' group by dr_treatment order by encounter limit 1"
adfe9182219ecbbfa21f841f,Tell me the name of the output patient 10004235 had for the first time on 03/24/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-24' ORDER BY outputevents.charttime ASC LIMIT 1 )",[],SELECT name FROM outputs WHERE patient_id = 10004235 AND date = '2023-03-24' ORDER BY date ASC LIMIT 1
eeac21ba672f8b7b97fbede4,Can you tell me when the first microbiology test for patient 10027445 was held since 16 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2142-07-31 06:07:00'}],"SELECT MIN(date) as first_microbiology_test_date FROM microbiology_tests WHERE patient_id = 10027445 AND date > DATE_SUB(CURRENT_DATE, INTERVAL 16 MONTH)"
d83c205b14f14e3bcf90bd5a,What are the four most frequently administered procedures for patients aged 20s in this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT Procedure, COUNT(*) AS Frequency FROM patient_data WHERE Age BETWEEN 20 AND 29 AND Year = 2023 GROUP BY Procedure ORDER BY Frequency DESC LIMIT 4"
5a676f9bd9eb81f901577ab1,Tell me the price of diazepam.,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'diazepam' ),,SELECT price FROM pharmaceuticals WHERE generic_name='diazepam' AND dosage='5mg';
db74cd1a2f794e17f35ddec4,When was patient 10021666 last mrsa screen microbiologic test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT date FROM microbiologic_tests WHERE patient_id = '10021666' AND test_name = 'mrsa_screen' ORDER BY date DESC LIMIT 1
5cd6bddbc341bdc7d39bab2f,When did on their first hospital visit patient 10038933 take the first microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'charttime': '2148-09-10 15:29:00'}],select min(m.microbiology_test_date) from microbiology_tests m join patient_visits p on m.patient_id = p.patient_id where p.patient_id = 10038933 and p.visit_number = 1
7b58a0880a46238d4e9722c0,What to prepare for the pulmon art wedge monitor procedure?,,,SELECT procedure_name FROM `CPT_Codes` WHERE `Procedure Description` LIKE '%pulmon%wedge monitor%'
48d5f819ed7042b8dca4b7e5,How many days elapsed since patient 10004733 received his red blood cells lab test for the last time in the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(CURDATE(), MAX(date)) AS Days_Elapsed FROM lab_tests WHERE patient_id = 10004733 AND test_name = 'red blood cells' AND visit_id = (SELECT MAX(visit_id) FROM visits WHERE patient_id = 10004733)"
c1ead7f66a477b8a69f1baea,Patient 10009628's hyaline casts second measured on the last hospital visit is less than the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",select count(*) from lab_events where person_id='10009628' and lab_name='Hyaline Casts' and lab_value < (select lab_value from lab_events where person_id='10009628' and lab_name='Hyaline Casts' order by visit_occurrence_date desc limit 1 offset 1) and visit_occurrence_date = (select max(visit_occurrence_date) from lab_events where person_id='10009628')
a40106b94aad93108e39fdbe,What was the drug prescribed to patient 10031757 for the first time via po route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND prescriptions.route = 'po' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SQL Query
fcd6e9ee48fbda60a4afb671,Has patient 10039831 taken a or colloid intake drug since 12/29/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-29'",[{'COUNT(*)>0': 0}],"SELECT * FROM Intake WHERE patient_id = 10039831 AND drug_name IN ('a', 'colloid') AND intake_date > '2100-12-29'"
3df2ee46a071840f122d563f,"What's the minimum total cost of a hospital that involves other and unspecified alcohol dependence, in remission in 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, in remission' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT MIN(total_cost) FROM cost WHERE alcohol_dependence IN ('involving_other_substances', 'unspecified') AND remission_status = 'in_remission' AND year = 2100;"
6349f71964ff7e144cdd2cba,Retrieve the top four most common lab tests since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT lab_test, COUNT(*) AS test_count FROM lab_tests WHERE test_date > DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) GROUP BY lab_test ORDER BY test_count DESC LIMIT 4"
76c3866059784b87210a1f13,What was the total amount of input for patient 10015931 since 07/04/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04'",[{'SUM(inputevents.totalamount)': 57765.0}],SELECT SUM(input_amount) AS total_input FROM patient_records WHERE patient_id = '10015931' AND input_date >= '07-04-2100';
bc08d5ab35121023062e0264,What was the drug that patient 10004235 was prescribed for in the same hospital encounter after the procedure of laparoscopic cholecystectomy in 07/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,select dr_name from procedure p join encounter e on p.enc_id = e.id join drug_rx d on e.id = d.enc_id where p.pro_name = 'laparoscopic cholecystectomy' and e.patient_id = 10004235 and p.date > (select date from procedure where patient_id = 10004235 and pro_name = 'laparoscopic cholecystectomy') order by p.date limit 1
83f52912d78ee9b03c4a66a7,"Did patient 10018423 have a introduction of other therapeutic substance into heart, open approach on the first hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )",[{'COUNT(*)>0': 0}],SQL Query here
f224a6e013d318ebe61083f8,What was the drug first prescribed to patient 10039708 in 11/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SQL Query
2dfbec4e54ac5d6edf34216d,What was patient 10002495's first measured rdw-sd in 06/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT MIN(rdw_sd) AS first_rd_w_sd FROM lab_tests WHERE patient_id = 10002495 AND test_date BETWEEN '2023-06-01' AND '2023-06-30' ORDER BY test_date ASC LIMIT 1
9fec7adf6776835d66f06d90,What specimen test has patient 10038999 received for the last time since 06/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'PLEURAL FLUID'}],SELECT test_name FROM specimen_tests WHERE patient_id = 10038999 AND test_date IN (SELECT MAX(test_date) FROM specimen_tests WHERE patient_id = 10038999 AND test_date >= '06/2100' GROUP BY test_name)
a8e86dcf95b5f3203f351589,What was the total number of drugs patient 10039997 was prescribed during their first hospital encounter?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)': 45}],select sum(drug_count) from (select count(*) as drug_count from patient_encounter_de_identified where patient_num='10039997' and encounter_num='1')
60460642bc6fa663ac944b18,What kind of diagnosis did patient 10019385 receive last since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,SELECT diagnosis_description FROM diagnoses WHERE patient_id = 10019385 AND diagnosis_date > '2100-01-01' ORDER BY diagnosis_date DESC LIMIT 1
26ce902d74db9f732e88776c,What was the total number of patients staying in hematology/oncology since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patid) from admissions where patid in (select patid from admissions where admtype='inpatient' and admtype='hematology/oncology' and admdate>=(current_date()-interval '1 year'))
f9adfa5449b4f14c535921e5,Has any free water medication been given to patient 10018081 since 1 day ago?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'free water' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-1 day')",[{'COUNT(*)>0': 0}],SELECT DISTINCT m.medication_name FROM patient_treatment pt JOIN medication m ON pt.medication_id = m.id WHERE pt.patient_id = '10018081' AND pt.date >= CURDATE() - INTERVAL 1 DAY AND m.is_free = TRUE
0f4c478ccc115578767ec3fb,When was patient 10004733 last given an input since 03/10/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-10' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2174-12-12 18:00:00'}],select max(date) from patient_data where patient_id = 10004733 and date > '03/10/2100' and input is not null
2ca6827b5997d6850fe15912,Has patient 10007058 got a lab test during this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT * FROM lab_tests WHERE patient_id = 10007058 AND test_date BETWEEN '2023-01-01' AND '2023-12-31';
949e6e0fe8bdf465a1964e73,How was patient 10005348 first admitted to the hospital in terms of admission type?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10005348 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1",[{'admission_type': 'ELECTIVE'}],select admission_type_id from MIMIC_III.admissions where subject_id=10005348 and hadm_id=(select min(hadm_id) from MIMIC_III.admissions where subject_id=10005348)
1a8c4898fa6341d62be1f722,What was the name of the last medication that was prescribed to patient 10031757 since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Potassium Chloride (Powder)'}],SELECT top 1 name FROM prescriptions WHERE patient_id = 10031757 AND prescription_date > '07/2100' ORDER BY prescription_date DESC
36961c041d723a40cd3af9bc,"How many instances of lumbar and lumbosacral fusion of the posterior column, posterior technique procedures have been completed?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'lumbar and lumbosacral fusion of the posterior column, posterior technique' )",[{'COUNT(*)': 0}],SELECT COUNT(*) AS procedure_count FROM procedures WHERE description LIKE '%lumbar and lumbosacral fusion%' AND description LIKE '%posterior column%' AND description LIKE '%posterior technique%'
7c25dcee711f95e8760994eb,What are the ways to consume caphosol?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'caphosol',[],SELECT DISTINCT caphosol_ways_consumption FROM consumption_methods WHERE product_name = 'Caphosol'
48a5e161532f3acc6752f577,Tell me the top three most prevalent procedures for patients aged 20s in this year.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT Procedure, COUNT(*) AS Frequency FROM MedicalRecords WHERE Age BETWEEN 20 AND 29 AND YEAR(ProcedureDate) = YEAR(CURDATE()) GROUP BY Procedure ORDER BY Frequency DESC LIMIT 3"
74d964eb743c57b2e97f9876,Have any diagnoses been made for patient 10003400 since 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'",,select * from Diagnosis where PersonId = 10003400 and Date >= '2100-01-01'
073c3923948729f403a5e5a3,Can you tell me patient 10031404's daily maximum weight since 2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"[SELECT MAX(Weight) as DailyMaxWeight, Date"
3c79d8c37eae0b006674c9c6,Count the number of patients who took glucose gel since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucose gel' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) FROM medical_records WHERE medication = 'glucose gel' AND date_taken >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
cac51b303e4b48200febb2a0,Could you provide the total volume of output for patient 10035185 since 02/02/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-02'",[{'SUM(outputevents.value)': 3905.0}],SELECT SUM(VolumeOutput) FROM `physionet-data.mimiciii_clinical.mechvent` WHERE subject_id = 10035185 AND charttime >= '2100-02-02'
3890e55b1b0c07ff2b11bb35,How many hours have it been since patient 10039831 had received a ptt laboratory test during this hospital encounter for the last time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],Your answer here
d5306618a151094326d339bc,What was the total foley volume that patient 10026354 had since 10/04/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04'",[{'SUM(outputevents.value)': None}],select sum(foley) from fluka_foley_volume where patient_id = '10026354' and date >= '10/04/2100'
5750149e3e7fafb11a1a5090,Can you list patient 10037975's daily maximum weight during the first hospital encounter?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT MAX(WEIGHT) AS DailyMaxWeight, ENCOUNTER_NUM FROM MINI WHERE MRN = 10037975 GROUP BY ENCOUNTER_NUM ORDER BY ENCOUNTER_NUM;"
d6dcd3648703a4fe15c42513,Have any lab tests been performed on patient 10008287 in 10/this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'",[{'COUNT(*)>0': 0}],select * from lab_tests where patient_id = '10008287' and date between '2023-10-01' and '2023-10-31'
fb25b72d8fbcca4ca0b23169,What is the cost of a closed fracture of lumbar vertebra without mention of spinal cord injury diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of lumbar vertebra without mention of spinal cord injury' ) ),,select sum(totalcharges) from inpatient where drgdescription like '%closed fracture of lumbar vertebra without mention of spinal cord injury diagnosis%'
a6e53a5c90ec55b54a024a95,When are dr. young's rounds and procedures?,,,"SELECT `rounds`.`start_time` AS `start_time`, `rounds`.`end_time` AS `end_time`, `procedures`.`name` AS `procedure`, `procedures`.`start_time` AS `procedure_start_time`, `procedures`.`end_time` AS `procedure_end_time` FROM `rounds` LEFT JOIN `procedures` ON `rounds`.`doctor_id` = `procedures`.`doctor_id` WHERE `rounds`.`doctor_name` = 'Dr. Young' OR `procedures`.`doctor_name` = 'Dr. Young' ORDER BY `rounds`.`start_time`, `procedures`.`start_time`"
1d3f884b7931238b1dbb1779,Show me the top three most common diagnoses of patients with age 40s this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) AS count FROM patient_records WHERE YEAR(diagnosis_date) = YEAR(CURDATE()) AND age BETWEEN 40 AND 49 GROUP BY diagnosis ORDER BY count DESC LIMIT 3"
0abf006890a1a4993c0e275b,Give me patient 10023239's total d5lr input since 230 days ago.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-230 day')",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input) FROM d5lr WHERE patient_id = 10023239 AND date >= NOW() - INTERVAL '230 days'
0994bfb0d80d586c3e6b991b,How much is the average total cost of a hospital that involves a drug named amitriptyline in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,select avg(total_cost) from hospital_table where drug_name='amitriptyline' and year=2100
861a7b73edbd60ca44e59f7c,"How many patients with candidal stomatitis were diagnosed in the same month after previously being diagnosed with anxiety disorder, unspecified in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anxiety disorder, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidal stomatitis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT COUNT(DISTINCT p.patient_id) FROM patients p JOIN diagnoses d1 ON p.patient_id = d1.patient_id JOIN diagnoses d2 ON p.patient_id = d2.patient_id WHERE d1.diagnosis = 'anxiety disorder, unspecified' AND d1.diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' AND d2.diagnosis = 'candidal stomatitis' AND d2.diagnosis_date = DATE_ADD(MONTH, 1, d1.diagnosis_date)"
af7b45da0507ce22b22901c2,Tell me the insurance plan in place for patient 10000032 on the first hospital encounter.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],SELECT insurance_plan FROM encounters WHERE patient_id = 10000032 AND encounter_number = 1
d9d32742eb8e9436fd593092,What is a drug that should not be administered during cont inv mec ven 96+ hrs?,,,SELECT Drug FROM DrugAdministration WHERE Condition = 'cont inv mec ven 96+ hrs' AND Administration = 'No'
31fc326ca001513cb405a126,What are the newly prescribed drugs for patient 10039831 today compared to those prescribed yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],
6cd24d0a30123968e0158324,"For the last time since 2100, what was patient 10006580 diagnosed with?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,SELECT diagnosis FROM patient_records WHERE patient_id = 10006580 ORDER BY visit_date DESC LIMIT 1
bca05145ac82b49ae8acc4b4,What's the count of patients who left the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],select count(*) from patient where year(discharge_date) >= 2100
773553bf367568bb392e4143,How many patients stayed at the trauma sicu (tsicu) since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'trauma sicu (tsicu)' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM admissions WHERE admission_date >= '2100-01-01' AND discharge_date <= '2100-12-31' AND ward_name = 'tsicu'
1d64d81dcd56c92b92cf34ad,Did patient 10021938 have any diagnoses during the first hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT * FROM Diagnosis WHERE Patient_ID = 10021938 AND Encounter_Num = 1
3ab088d1de4a0ae537c766a2,What was the last time that patient 10004733 had a minimum heart rate on this month/30?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '30' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],select * from chartevents where subject_id = 10004733 and itemid = 211 and charttime <= 'YYYY-MM-DD 23:59:59' and charttime > 'YYYY-MM-DD 00:00:00' and value <= (select min(value) from chartevents where subject_id = 10004733 and itemid = 211 and charttime <= 'YYYY-MM-DD 23:59:59' and charttime > 'YYYY-MM-DD 00:00:00') order by charttime desc limit 1;
a5f1e48fb3c060e9e95251f2,"Total number of patients who had drainage of peritoneal cavity, percutaneous approach in 2100.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )",,"SELECT COUNT(DISTINCT a.patient_id) AS total_patients FROM ADMISSION a JOIN SURGERY s ON a.patient_id = s.patient_id AND a.adm_id = s.adm_id WHERE s.surg_proc = 'Drainage of peritoneal cavity, percutaneous approach' AND YEAR(a.adm_date) = 2100"
f0220d6aa14301805fc7e420,Is that patient 15945 has an appointment in another department?,,,select distinct on (p.id) p.id from visits v join patients p on v.patient_id = p.id where p.id = 15945 and (v.department_name != 'Radiology' and v.department_name != 'Cardiology')
b91fff10d613c5660031b070,Tell me the dose of an opioid prescribed to patient 13897?,,,SELECT dose FROM prescriptions WHERE patient_id=13897 AND medication_category='opioid'
efc40de8a506d0e04de52dd0,When and where are the rounds and procedures of dr. coburn?,,,SQL Query Here
4862ed4025ee2b4c353f6545,How much is the minimum total hospital cost with other cysts of jaws since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cysts of jaws' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SQL Query here
f21b3abcfb7c410d3b31bc30,Number of patients who were diagnosed with multiple myeloma not having achieved remission.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'multiple myeloma not having achieved remission' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT p.patient_id) FROM patient_records p WHERE p.diagnosis = 'multiple myeloma' AND p.status NOT IN ('remission', 'partial remission')"
8419db544e116248cf67bf17,Count the number of patients who had their nucleated red cells tested in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'nucleated red cells' ) AND strftime('%Y',labevents.charttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM nucleated_red_cells_tests WHERE test_date BETWEEN '2100-01-01' AND '2100-12-31';
cc7cd55d5065328b8c5164e1,What amount of neostigmine has been prescribed to patient 10011398 for the first time since 01/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND prescriptions.drug = 'neostigmine' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"SELECT MIN(prescription_date), SUM(amount_prescribed) FROM prescriptions WHERE patient_id = 10011398 AND drug_name = 'neostigmine' AND prescription_date >= '2100-01-01' GROUP BY patient_id HAVING MIN(prescription_date) = prescription_date"
f3adc97fcfd46233a705b0b8,What was patient 10007818's first peritoneal fluid's microbiology test time during their first hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],"SELECT TOP 1 microbiology_test_time FROM peritoneal_fluid_tests WHERE patient_id = 10007818 ORDER BY hospital_visit_date ASC, microbiology_test_time ASC"
2bc57e6b3e44d9ecf6f1c242,When did patient 10016742 get their last input?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) ORDER BY inputevents.starttime DESC LIMIT 1,[{'starttime': '2178-07-25 14:05:00'}],SELECT MAX(date) FROM input WHERE patient_id = 10016742;
a14b794e12f6637f98c72ade,"Among patients aged 40s , what are the top three most common diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as diagnosis_count FROM patients WHERE age BETWEEN 40 AND 49 GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 3"
f5b78cf9f326f6c6ae745067,How many patients were discharged from the hospital in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patients WHERE discharge_year = 2100
381c1509334fff03b367f5e0,When did patient 10035185 have a base excess lab test for the first time in 05/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT MIN(lab_test_date) FROM lab_tests WHERE patient_id = 10035185 AND test_type = 'base excess' AND lab_test_date LIKE '05/2100%';
7d56993bcf3d2b526fae33a7,"In 04/2100, did patient 10007928 undergo a lab test?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND strftime('%Y-%m',labevents.charttime) = '2100-04'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM lab_tests WHERE patient_id = 10007928 AND date_of_test >= '04/01/2100' AND date_of_test < '05/01/2100' AND test_performed IS NOT NULL
4775d3a9d0fb326081985b5e,How was patient 10031404 admitted in terms of admission type for the first time?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10031404 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1",[{'admission_type': 'URGENT'}],SELECT admission_type FROM admissions WHERE patient_id = 10031404 ORDER BY admission_date ASC LIMIT 1
728bd4f1812fb837f2f3ff6b,What was the first value of a epithelial cells lab test of patient 10016150?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) ORDER BY labevents.charttime ASC LIMIT 1,[],SELECT TOP 1 `epithelial cells` FROM `lab_results` WHERE `patient_id` = '10016150' ORDER BY `test_date` ASC
aeb553a68c282c81e16d7c44,Have you seen patient 47460 receiving additional blood (ebv) tests?,,,SELECT COUNT(*) AS additional_blood_tests FROM lab_tests WHERE patient_id = '47460' AND test_type LIKE '%ebv%';
f52d83becf30a588f36e34f3,Has any gastric meds been given to patient 10029291 in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'",[{'COUNT(*)>0': 0}],SELECT * FROM medication_records WHERE patient_id = 10029291 AND medication_type = 'gastric' AND administration_date >= '2022-12-01' AND administration_date < '2023-01-01';
08f5481de0c251a808376406,"During the last hospital encounter, what was the insurance plan of patient 10015931?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicare'}],SQL Query
ccc5d12c1c88d7a708f03f70,"What are the four most frequently taken specimens for patients diagnosed with iatrogenic pneumothorax previously in the same month, in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'iatrogenic pneumothorax' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"SELECT specimen, COUNT(*) AS count FROM (SELECT specimen, patient_id, EXTRACT(MONTH FROM date_collected) AS month_collected, EXTRACT(YEAR FROM date_collected) AS year_collected, diagnosis, EXTRACT(YEAR FROM patient_dob) AS patient_birthyear FROM specimen JOIN patient USING (patient_id) JOIN diagnosis USING (patient_id) WHERE diagnosis = 'iatrogenic pneumothorax' AND EXTRACT(YEAR FROM date_collected) = 2100) AS subquery GROUP BY specimen ORDER BY count DESC LIMIT 4"
3b2a3869e8ca4ddc183bfbfe,What is the number of patients that received a thyroxine (t4) test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroxine (t4)' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM labevents WHERE test = 't4' AND date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
4556bf5fa6cf416c4f84dfea,When did patient 10004733 last have a maximum SaO2 on this month/29?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],SELECT MAX(record_date) FROM vitals WHERE patient_id = 10004733 AND record_date >= '2023-10-01' AND record_date <= '2023-10-29' AND measurement = 'SaO2'
a6c506df1317e23580129055,Does patient 6921 have an overseas history of travel?,,,select * from patient_records where patient_id = 6921 and overseas_travel = 'yes'
9330e1bf456cb3ad13b7333e,Which are the five most commonly taken lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","select LabTestId, count(*) as 'count' from LabTests group by LabTestId order by count(*) desc limit 5"
fe2b896743388c3285fd2973,What's the rank of the top three most common output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]",SQL QUERY HERE
99ffb7abd20ff1b14fcdae61,Provide the count of hospital visits for patient 10008287 in the previous year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10008287 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],"SELECT COUNT(*) FROM admissions WHERE patient_id = 10008287 AND admission_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
b562038e8a76b7d15b8694eb,What was the organism detected during the last abscess microbiology test of patient 10001217 in the last hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT DISTINCT microbiology_test.organism_detected FROM microbiology_test INNER JOIN patient_visit ON microbiology_test.visit_id = patient_visit.id WHERE patient_visit.patient_id = 10001217 AND microbiology_test.type = 'abscess' AND microbiology_test.test_date = (SELECT MAX(test_date) FROM microbiology_test WHERE visit_id = patient_visit.id)
a4aa999285ef6d36e9f1f2b6,When was patient 10019568 prescribed a yellow cadd cassette and bupivacaine 0.1% at the same time for the last time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'yellow cadd cassette' AND admissions.subject_id = 10019568 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bupivacaine 0.1%' AND admissions.subject_id = 10019568 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT prescription_date FROM prescriptions WHERE patient_id = 10019568 AND (drug_name = 'yellow cadd cassette' OR drug_name = 'bupivacaine 0.1%') GROUP BY prescription_date HAVING COUNT(DISTINCT drug_name) = 2 ORDER BY prescription_date DESC LIMIT 1
3fcd3dd1926914800ea40cbb,What was the drug prescribed to patient 10016150 for the last time since 04/2100 via the im route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1",[],"SELECT ""Medication"".""Medication Name"", MAX(""Encounter"".""Encounter Date"") AS ""Last Prescription Date"" FROM ""Encounter"" JOIN ""Medication"" ON ""Encounter"".""Encounter ID"" = ""Medication"".""Encounter ID"" WHERE ""Encounter"".""Patient ID"" = 10016150 AND ""Medication"".""Route"" = 'IM' AND ""Encounter"".""Encounter Date"" >= '04/2100' GROUP BY ""Medication"".""Medication Name"" ORDER BY ""Last Prescription Date"" DESC LIMIT 1"
b2f9b52ce74d61a7d5f2395b,How many days was patient 10022281's last stay in the intensive care unit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.4465393517166376}]",SELECT SUM(LENGTH_OF_STAY) FROM ICU_STAYS WHERE PATIENT_ID = '10022281' ORDER BY CHECKOUT_DATE DESC LIMIT 1
28a983d2c071ad3739459886,Provide the count of ICU visits for patient 10004733 during this year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT icustays.stay_id )': 0}],SELECT COUNT(*) FROM ICU_stays WHERE PatientID = '10004733' AND YEAR(AdmissionDate) = YEAR(CURDATE())
8155288647172c49b5a66196,What was the first output during their first ICU visit for patient 10025612?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 ),[{'label': 'Foley'}],SELECT TOP 1 output FROM icu_visits WHERE patient_id = '10025612' ORDER BY visit_date ASC;
a01e64e03c8ea6881cad8b6c,What was the name of patient 10012853's insurance during the last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicare'}],SELECT TOP 1 [Insurance Name
9bae33f8c355733757e36325,What are the top three diagnoses of patients in their 60 or above since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as count FROM medical_records WHERE age >= 60 AND date_of_diagnosis >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY diagnosis ORDER BY count DESC LIMIT 3"
42b510fee11c5b77449a9840,What is the maximum total cost of the hospital visits that included injection of anesthetic into spinal canal for analgesia in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection of anesthetic into spinal canal for analgesia' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,"select max(TotalCost) from (select sum(TotalCost) as TotalCost from Encounter join Diagnosis using (EncounterID) where year(Encounter.Date)=2100 and DiagnosisCode in ('G0010','G0020') group by EncounterID) as TotalCostPerEncounter"
47b3d7f69bda0102d243c44b,Could you provide the top four most common output events in this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"SELECT event_type, COUNT(*) AS event_count FROM Events WHERE YEAR(event_time) = YEAR(CURRENT_DATE()) GROUP BY event_type ORDER BY event_count DESC LIMIT 4"
193a8bd008df2bc9ae99adf8,What are the top five most frequently prescribed drugs in this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5",[],"SELECT TOP 5 drug_name, COUNT(*) AS prescription_count FROM prescriptions WHERE YEAR(prescription_date) = YEAR(CURRENT_DATE) GROUP BY drug_name ORDER BY prescription_count DESC;"
e7d1fbad4727f90f548eeaae,How much does patient 10007818 weigh difference last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","[select patient_id, ((select measurement_value from measurement where visit_occurrence_id=(select visit_occurrence_id from visit_occurrence where visit_occurrence_id= (select max(visit_occurrence_id) from visit_occurrence where patient_id = 10007818 and visit_concept_id = 9201)) and measurement_concept_id = 50800900 and measurement_date=(select max(measurement_date) from measurement where visit_occurrence_id = (select visit_occurrence_id from visit_occurrence where visit_occurrence_id= (select max(visit_occurrence_id) from visit_occurrence where patient_id = 10007818 and visit_concept_id = 9201))) and measurement_id in (select max(measurement_id) from measurement where visit_occurrence_id = (select visit_occurrence_id from visit_occurrence where visit_occurrence_id= (select max(visit_occurrence_id) from visit_occurrence where patient_id = 10007818 and visit_concept_id = 9201)) and measurement_concept_id = 50800900))-(select measurement_value from measurement where visit_occurrence_id=(select visit_occurrence_id from visit_occurrence where visit_occurrence_id= (select max(visit_occurrence_id) from visit_occurrence where"
c30028359953f37651a81962,Has patient 10019172 been admitted into the hospital in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019172 AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT(*)>0': 0}],SELECT * FROM admissions WHERE patient_id = '10019172' AND YEAR(admission_date) = 2100;
68abea0b746f09a1730c8a20,Give me the total amount of output since 12/01/2100 for patient 10005817.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-01'",[{'SUM(outputevents.value)': 41303.0}],select sum(output) from icd_output where patient_id = 10005817 and date > '2100-12-01'
06082342b67bc9539dd5dce6,What are the prices for the drug called lidocaine 5% patch?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lidocaine 5% patch' ),,SELECT price FROM drugs WHERE name = 'lidocaine 5% patch'
77eb3ba985eb3df7b7b03d98,What was the oxycodone-acetaminophen dose that patient 10022281 was last prescribed in 06/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND prescriptions.drug = 'oxycodone-acetaminophen' AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ORDER BY prescriptions.starttime DESC LIMIT 1",[],select max(dosage) from prescriptions where patient_id = 10022281 and medication = 'Oxycodone-Acetaminophen' and date_prescribed like '06/2100%'
362ddfa50f43176eb146320b,"Among patients who underwent excision of other bile duct , what were the top four diagnoses they received within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"[SELECT diagnosis, COUNT(*) AS frequency FROM patients"
15e6224c6a4f4b69e45e2059,What was the amount of bag that patient 10012853 were prescribed in total in 04/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.drug = 'bag' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(bag) FROM patient_orders WHERE patient_id = 10012853 AND order_date BETWEEN '04/01/2100' AND '04/30/2100';
72ad619b7c1288429ab0e7e8,Does patient 32163 have any abscess left?,,,SELECT EXISTS(SELECT 1 FROM medical_records WHERE patient_id = 32163 AND condition = 'abscess' AND status = 'present')
acf918458c8addc978e6c8d7,Can you tell me the cost for the procedure called extracorporeal circulation auxiliary to open heart surgery?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) ),,SELECT cost FROM procedure_costs WHERE procedure_name = 'extracorporeal circulation auxiliary to open heart surgery';
5132adcd87a30d937fa216b4,Can you please share with me the name of the diagnosis that patient 95909 received in the other department?,,,SELECT diagnosis FROM other_department_diagnoses WHERE patient_id = 95909
0097bca5984143bf4c458509,What were the top three most common lab tests done this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],SQL Query
3ba76ddc2f81e4273838d8ae,"What is the average total hospital cost that involved ileostomy, not otherwise specified since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT AVG(total_hospital_cost) FROM inpatient_claims WHERE procedure = 'ileostomy, not otherwise specified' AND admission_date >= '2100-01-01'"
3859ca46fafef561a7272be8,Can you tell me patient 10015272's daily maximum weight in this year?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT MAX(weight) AS 'Daily Maximum Weight', date FROM patient_data WHERE patient_id = '10015272' AND YEAR(date) = YEAR(CURDATE()) GROUP BY date"
b60a37507f5ac0a7a99bb5b2,What was the dose of clonidine patch 0.2 mg/24 hr that was first prescribed to patient 10040025 on the last hospital encounter?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'clonidine patch 0.2 mg/24 hr' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT * FROM `drug_orders` WHERE `patient_id` = '10040025' AND `drug_name` = 'clonidine patch 0.2 mg/24 hr' ORDER BY `order_date` DESC LIMIT 1
70419e78d304638558059cf9,"When was the first time patient 10005817, since 12/02/2100, had the maximum systolic blood pressure?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-02' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],[SELECT MIN(measurement_date) AS earliest_max_systolic_date
315fe7012ff34a06a1448165,Did patient 10009035 receive any solution on 05/12/this year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '05-12'",[{'COUNT(*)>0': 0}],SELECT * FROM `tbl_prescriptions` WHERE `patient_id` = '10009035' AND `medicine_name` LIKE '%solution%' AND `prescription_date` = '2023-05-12'
82db68532c1fe0fc76c6c017,Calculate the number of hospital visits made by patient 10015272 since 1 year ago.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10015272 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],"SELECT COUNT(*) AS visit_count FROM admissions WHERE patient_id = '10015272' AND admission_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
ffd78170fcf2def8a4cfe87e,Can you get me the top four most conducted lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(test_name) AS test_count FROM lab_tests WHERE test_year > 2100 GROUP BY test_name ORDER BY test_count DESC LIMIT 4"
f750f0fa41e0b4e4dbe37ba3,Tell me the amount of multivitamins input that patient 10021666 received.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'multivitamins' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],SELECT SUM(quantity) FROM input_records WHERE patient_id = '10021666' AND drug_type = 'multivitamin'
74758a7e91cabecd02edc1c8,"What was the name of the drug patient 10021118 was prescribed with within 2 days after having received a performance of cardiac output, continuous procedure in this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT d.name FROM Drug d JOIN Prescription p ON d.drug_id = p.drug_id JOIN Patient pa ON p.patient_id = pa.patient_id WHERE pa.patient_id = 10021118 AND p.prescription_date BETWEEN (SELECT DATE(ProcedureDate) FROM Procedure WHERE patient_id = 10021118 AND procedure_name = 'Cardiac Output, Continuous') AND DATE_ADD((SELECT DATE(ProcedureDate) FROM Procedure WHERE patient_id = 10021118 AND procedure_name = 'Cardiac Output, Continuous'), INTERVAL 2 DAY) AND MONTH(p.prescription_date) = MONTH((SELECT DATE(ProcedureDate) FROM Procedure WHERE patient_id = 10021118 AND procedure_name = 'Cardiac Output, Continuous')) AND YEAR(p.prescription_date) = YEAR((SELECT DATE(ProcedureDate) FROM Procedure WHERE patient_id = 10021118 AND procedure_name = 'Cardiac Output, Continuous'))"
4534d3ce04ba517f06d9eeec,"What is the average total hospital cost, which includes other alteration of consciousness since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other alteration of consciousness' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_hospital_cost) FROM hospital_costs WHERE consciousness_alteration_since_2100 = TRUE
22e1a21fc783d4bd45120187,Could you tell me the first heart rate value that patient 10008454 had on this month/03?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '03' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(heartRate) AS FirstHeartRateValue FROM patientData WHERE patientID = '10008454' AND month = '03' AND year = YEAR(CURRENT_DATE) AND heartRate IS NOT NULL LIMIT 1;
ba956e22bb92d02f3abbcb3c,How much does phenytoin infatab cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenytoin infatab' ),,SELECT price FROM medications WHERE name='Phenytoin Infatab'
fabc6fda184e4c3f17a6f07e,What are the top five most common specimens being tested for patients who were diagnosed with transfusion related acute lung injury (trali) within 2 months since 1 year ago?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'transfusion related acute lung injury (trali)' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"SELECT specimen_type, COUNT(*) AS frequency FROM lab_tests INNER JOIN diagnoses ON lab_tests.test_id = diagnoses.test_id WHERE diagnoses.diagnosis_date BETWEEN CURRENT_DATE - INTERVAL '1 YEAR' AND CURRENT_DATE - INTERVAL '2 MONTHS' AND diagnoses.diagnosis = 'TRALI' GROUP BY specimen_type ORDER BY frequency DESC LIMIT 5;"
5ce9e6b643c409ca7510c4f0,How many patients were administered syringe (iso-osmotic dextrose) since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'syringe (iso-osmotic dextrose)' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM patient_treatments WHERE treatment_type = 'syringe (iso-osmotic dextrose)' AND timestamp >= '2100-01-01T00:00:00Z'
08b21636e8a003182b06159f,When was the first hospital discharge for patient 10035185?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10035185 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[],select min(discharge_date) from hospital_discharges where patient_id = '10035185';
1d5758a11b098e86ecfcc86d,What was the total amount of insulin that they prescribed to patient 10012552 in 04/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND prescriptions.drug = 'insulin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'SUM(prescriptions.dose_val_rx)': None}],select sum(Quantity) from prescriptions where PatientID=10012552 and ProductID='Insulin' and MONTH(DatePrescribed) = 4 and YEAR(DatePrescribed) = YEAR(CURDATE())
3c902daacd4588721711f210,Give me the top five most commonly prescribed medications.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]","SELECT medication, COUNT(*) AS prescription_count FROM prescriptions GROUP BY medication ORDER BY prescription_count DESC LIMIT 5;"
11b1d4acc1e68f70deb1fd99,What is the total number of patients who underwent fiber-optic bronchoscopy throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fiber-optic bronchoscopy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,SELECT COUNT(*) AS total_patients FROM bronchoscopy_records WHERE procedure_type = 'fiber-optic' AND YEAR(procedure_date) = YEAR(CURDATE())
bf1e8983b1cc3c09f253f07c,Tell me the top three most commonly prescribed medications.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]","select drug_name, count(*) as prescription_count from prescriptions group by drug_name order by prescription_count desc limit 3"
0c6cdc444ee911941bfd23f0,Calculate the number of medicines that patient 10039708 was prescribed during the last month.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month')",[{'COUNT(*)': 0}],"select count(medication_id) from (select distinct medication_id, encounter_id from encounter_drugorder where person_id = 10039708 and start_date >= (select max(start_date) from encounter_drugorder where person_id = 10039708) - interval '1 month') as subquery"
e1e75ab26d91e343b7b0ea17,What was the last value of patient 10038933's lab test for glucose in their last hospital encounter?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1,[],"select top 1 lab_test_name, test_result as last_value from lab_results where patient_id='10038933' and lab_test_name='glucose' order by encounter_date desc, test_date desc"
16ca0a5e17d4cb11df70a0d0,What was the diagnosis for patient 10015931 the first time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,SELECT TOP 1 diagnosis FROM diagnosis WHERE patient_id = '10015931' ORDER BY date ASC
8647d1bf21a4ae9c764a0b98,What was patient 10027602's average value of mch in 11/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11'",[{'AVG(labevents.valuenum)': None}],"select avg(mch) as avg_mch from (select mch,visit_occurrence_id from lab_results where person_id='10027602' and visit_occurrence_id in (select visit_occurrence_id from visit_occurrence where person_id='10027602' and visit_concept_id=9202 and visit_start_date<'2011-12-01' and visit_start_date>='2011-11-01')) as mch_in_11_2011"
4ca27aac7d23ace022562d03,What was the first time patient 10020944 received wbc in a lab test on the last hospital stay?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'wbc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,[],select min(test_date) from lab_events where person_id = 10020944 and test_type = 'wbc' and visit_id = (select max(visit_id) from visits where person_id = 10020944)
c0abdf612c0f0fba7baee7ec,Can you inform me of the first neutrophils test result for patient 10002495 in 06/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT top_1 result FROM neutrophils_tests WHERE patient_id = '10002495' AND date_part('year', test_date) = '06' AND date_part('year', test_date) = '2100';"
b72b79de6cb86da03d64e09c,Was there any diagnosis that patient 10029291 was received in the first hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],Select diagnosis from hospital_encounter where patient_id = 10029291 and encounter_number = 1
1bd7abf7a8f3aefc71dd2357,What was the drug last prescribed to patient 10019568 since 11 months ago?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-11 month') ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'HYDROmorphone (Dilaudid)'}],"select prescription.drug as drug from prescription where prescription.patient_id='10019568' and prescription.prescription_date >= DATEADD(month, -11, GETDATE()) order by prescription.prescription_date desc limit 1"
a762ae81d4a2a3d7d99c19e7,Tell me the amount of total foley that patient 10010471 had since 07/14/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-14'",[{'SUM(outputevents.value)': None}],SELECT SUM(total_foley) FROM patient_records WHERE patient_id = '10010471' AND foley_date >= '07/14/2100'
258a0365b34cfcb6501ad3c2,How much did patient 10026354 weigh when measured for the last time since 14 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT TOP 1 weight FROM measurements WHERE patient_id = 10026354 AND measurement_date > DATEADD(MONTH, -14, GETDATE()) ORDER BY measurement_date DESC"
f18a1ffa1752d917bfb094ac,Is the pt value of patient 10018081 second measured on the current hospital visit greater than the value from the first measurement on the current hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN MAX(CASE WHEN CAST(EXTRACT(epoch FROM (CURRENT_TIMESTAMP - s.admission_time)) / 3600 AS INTEGER) = 1 THEN s.pt END) < MAX(CASE WHEN CAST(EXTRACT(epoch FROM (CURRENT_TIMESTAMP - s.admission_time)) / 3600 AS INTEGER) = 2 THEN s.pt END) THEN 'Yes' ELSE 'No' END AS ""Is Second PT Greater?"" FROM labevents s WHERE s.subject_id = 10018081 AND s.hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = 10018081 ORDER BY admittime DESC LIMIT 1) AND s.itemid = 50812"
5035c14e77fc86f7e758328a,"In total, how many patients were prescribed potassium chloride (powder) since 1 year ago?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chloride (powder)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM prescriptions WHERE medication_name = 'potassium chloride (powder)' AND date_prescribed >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
4222a76175b0c9d9dbc75006,"Has there been a performance of cardiac output, continuous procedure performed on patient 10021118 since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,"SELECT COUNT(*) FROM procedures WHERE procedure_name = 'Performance of Cardiac Output, Continuous' AND patient_id = '10021118' AND date >= '2100-01-01'"
72666450524051b2095429f8,Is it patient 10012552's arterial blood pressure mean last measured on the first ICU visit less than first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN MIN(MEAN) > (SELECT MEAN FROM BLOOD_PRESSURE WHERE PATIENT_ID = '10012552' AND ADMISSION_ID = 'first_admission_id' AND CATEGORY = 'arterial' AND PARAMETER = 'MEAN' ORDER BY MEASUREMENT_DATETIME ASC LIMIT 1) THEN 'Yes' ELSE 'No' END AS Is_Mean_Less_First FROM BLOOD_PRESSURE WHERE PATIENT_ID = '10012552' AND ADMISSION_ID = 'first_admission_id' AND CATEGORY = 'arterial' AND PARAMETER = 'MEAN';
1175293359f3af457f69e353,Was any magnesium sulfate (bolus) medication provided to patient 10019172 on the first ICU visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],select * from table_name where patient_id = '10019172' and admission_number = 1 and medication_name = 'magnesium sulfate (bolus)';
f6bc08951df014b4c74d7be6,What was patient 10009628's maximum systolic blood pressure reading on 10/03/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-03'",[{'MAX(chartevents.valuenum)': None}],select max(systolic) from blood_pressure_records where patient_id = 10009628 and date = '10/03/2100'
8b3bbb2614914b69a0d35d7f,What was the admission type for patient 10027445's first entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1",[],SELECT TOP 1 AdmissionType FROM HospitalAdmissions WHERE PatientID = 10027445 ORDER BY AdmissionDate ASC
f59622e4ac592f700d2dbc87,Have any procedures been performed on patient 10005817 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,select count(*) from procedure_event where subject_id = 10005817 and hadm_id = (select hadm_id from admission where subject_id = 10005817 and admittime >= '2100')
5b550bcb1829cb627ed0e4b7,Which drug was the last one prescribed for patient 10008454 since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Labetalol'}],Your SQL query here
113ee06f4d8c5df754253b48,How many drugs were given to patient 10023239 since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 148}],SELECT COUNT(DISTINCT drug) FROM medical_records WHERE patient_id = 10023239 AND date >= '2100-01-01';
04d6acb457c7debd55705e51,Is the value of respiratory rate of patient 10010471 second measured on the last ICU visit greater than the value first measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",[select case when (select value from chartevents where icustay_id in (select icustay_id from icustay_detail where subject_id = '10010471' and stay_type = 'ICU' order by intime desc limit 1) and itemid = 211 and charttime in (select charttime from chartevents where icustay_id in (select icustay_id from icustay_detail where subject_id = '10010471' and stay_type = 'ICU' order by intime desc limit 1) and itemid = 211 order by charttime desc limit 1)) > (select value from chartevents where icustay_id in (select icustay_id from icustay_detail where subject_id = '10010471' and stay_type = 'ICU' order by intime desc limit 1) and itemid = 211 and charttime in (select charttime from chartevents where icustay_id in (select icustay_id from icustay_detail where subject_id = '10010471' and stay_type = 'ICU' order by intime desc limit 1) and itemid = 211 order by charttime limit 1)) then 'Yes'
e8d600176ca42258e8ab175a,How many aspirin prescriptions were administered since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'aspirin' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 12}],SELECT COUNT(*) FROM prescription WHERE medication = 'aspirin' AND date_prescribed >= '2100-01-01'
8478e6de5e5ee9e5033f7355,How many patients since 2100 were diagnosed with bacteremia within the same month after the diagnosis of unspecified essential hypertension?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bacteremia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,SELECT COUNT(*) AS patient_count FROM labevents le JOIN labevents le2 ON le.subject_id = le2.subject_id AND le.hadm_id = le2.hadm_id AND le.chartdate BETWEEN le2.chartdate AND le2.chartdate + INTERVAL '1 MONTH' WHERE le.ITEMID = 50868 AND le.VALUE >= '1' AND le2.ITEMID = 4282 AND le2.VALUE >= '1' AND le.CHARTDATE >= '2100-01-01'
3968a40f9da4c7f52e8f7dea,What is the dose of the prescribed opioid for patient 76372??,,,SELECT opioid_dose FROM opioid_prescriptions WHERE patient_id = 76372
26e74aadac80448d7df8bab6,What immuno-cancer medications have been used for the last five years?,,,"SELECT drug_name FROM immuno_cancer_meds WHERE usage_date >= DATEADD(year, -5, GETDATE())"
41edf4dce9244c624133d08a,What was the output of patient 10018423 for the first time since 03/06/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-06' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Foley'}],"SELECT min(output_date) AS FirstOutputDate, output_value FROM patient_output WHERE patient_id = 10018423 AND output_date >= '03/06/2100'"
a4ae3581ae94bfe56b9a4d3e,Has patient 10007058 received a laboratory test for anion gap in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y',labevents.charttime) = '2100'",[{'COUNT(*)>0': 0}],select * from laboratory_test where patient_id=10007058 and test_name='anion gap' and test_year=2100
02c83f838a71d8a05881f29c,Count the number of patients in med/surg since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS patient_count FROM patients WHERE unit = 'med/surg' AND admission_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
eec94693605289856658f678,Show me the daily maximum weight of patient 10003046 in 01/this year.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '01' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT CAST(date AS DATE) AS 'Date', MAX(weight) AS 'Max Weight' FROM PatientWeight WHERE patient_id = '10003046' AND MONTH(date) = 1 AND YEAR(date) = YEAR(CURDATE()) GROUP BY CAST(date AS DATE) ORDER BY CAST(date AS DATE) ASC;"
afa0e569514d9221f0ed8ad6,How much is the drug named tobramycin sulfate?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'tobramycin sulfate' ),,SELECT price FROM drugs WHERE name='tobramycin sulfate'
d27110d877b8d72776989d66,Please count the hospital visits made by patient 10027445 in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],select count(*) from visits where patient_id=10027445 and year=2100
9f95244492614327ffaf076b,How many hours has it been since patient 10018081's first abnormal coagulation profile diagnosis in the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,SELECT EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - MIN(diagnosis_time))) / 3600 AS hours_since_first_abnormal FROM coagulation_profiles WHERE patient_id = 10018081 AND abnormal = TRUE AND encounter_id = (SELECT encounter_id FROM encounters WHERE patient_id = 10018081 ORDER BY start_time DESC LIMIT 1) GROUP BY patient_id
535fb807f200d61057c1b7a0,"What was the top three most frequent diagnoses that patients were diagnosed with within 2 months after receiving inspection of tracheobronchial tree, via natural or artificial opening endoscopic?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"[select D.Diagnosis, count(D.Diagnosis) as cnt"
c5f4c7e6139e15ca5adacd50,Show me the top three microbiology tests.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]","""""""<|endofstatement|>"""""""
d19f3fd4aedf7fd997534d9e,When did patient 10021487 have the first systolic blood pressure observed to be greater than 100.0 since 12/05/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 100.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-05' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(OBSERVATION_DATETIME) FROM patient_observations WHERE patient_id = 10021487 AND systolic_blood_pressure > 100.0 AND OBSERVATION_DATETIME > '12/05/2100'
1b5f2850fe93f1eb4438b9dd,When are dr. holmes's rounds and procedures?,,,"select round, procedure from schedule where doctor='dr. holmes'"
af69042027761577e56622e9,What is the length of time patient 89875 had to undergo packed cell transfusion?,,,"SELECT DATEDIFF(DAY, date_admitted, date_discharged) AS transfusion_duration FROM patients WHERE patient_id = 89875 AND treatment = 'packed cell transfusion'"
44de7bcceae079f9e8bfdaaf,"Among patients who underwent replacement of aortic valve with zooplastic tissue, percutaneous approach since 2100, what were the top five most common procedures that followed within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,
4c511e76ad5fcd971a417e7f,Tell me the number of patients diagnosed with fibromyalgia since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fibromyalgia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,SELECT COUNT(*) AS Total_Fibromyalgia_Patients FROM `PatientRecords` WHERE `Diagnosis` = 'fibromyalgia' AND `Year_Diagnosed` >= 2100
0544bc6c320c47d80b7b3c78,Calculate the total number of medications that patient 10023117 was prescribed on the first hospital encounter.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)': 18}],SELECT COUNT(DISTINCT medication_id) FROM medications WHERE patient_id = '10023117' AND hospital_encounter_id = (SELECT hospital_encounter_id FROM hospital_encounters WHERE patient_id = '10023117' AND encounter_sequence = 1)
bfc0ef948f41f613e7769bc1,Does patient 23070 have overseas travel history?,,,SELECT * FROM patient_history WHERE patient_id = 23070 AND overseas_travel = 'Yes'
f2f331a5387ccf3bfd476a39,Was patient 10037861 through any surgery in the first hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],"[select p.patient_id, p.name, m.hospital_id, count(*) as num_surgeries"
903fa8b66fbddfcd2c54d16c,Has patient 49176 ever experienced a side effect during a blood transfusion?,,,SELECT DISTINCT BloodTransfusion.PatientID FROM BloodTransfusion JOIN SideEffects ON BloodTransfusion.TransfusionID = SideEffects.TransfusionID WHERE BloodTransfusion.PatientID = '49176' AND SideEffects.Severity = 'High'
e44cd0b41cda6c3cab6b967e,How many hours have elapsed since patient 10018081 stayed in the careunit emergency department for the last time on this hospital stay?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1",[],"SELECT DATEDIFF(HOUR, MAX(careunit_admissions.admit_dt), CURRENT_TIMESTAMP) FROM careunit_admissions WHERE patient_id = '10018081' AND careunit_admissions.description = 'Emergency Department' AND careunit_admissions.hospital_stay_id = (SELECT MAX(hospital_stay_id) FROM careunit_admissions WHERE patient_id = '10018081' AND careunit_admissions.description = 'Emergency Department')"
177414b028ffe63adf88e436,What is the checklist before the therapeu plasmapheresis procedure?,,,SELECT checklist FROM procedures WHERE procedure_name = 'therapeu plasmapheresis'
ee59f6b32fc0b17f2e1e888b,Can you tell how many times patient 10031757 visited the ICU since 1 year ago?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 2}],SELECT COUNT(*) FROM icustays WHERE subject_id = 10031757 AND intime > (CURRENT_DATE - INTERVAL '1 year')
2eec2f8d9b73d99dd0701546,What are the five most commonly taken specimens for patients that received insertion of one vascular stent previously within 2 months this year?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of one vascular stent' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"SELECT specimen, COUNT(*) AS specimen_count FROM patient_procedures JOIN specimen_collection ON patient_procedures.patient_id = specimen_collection.patient_id WHERE patient_procedures.procedure_date BETWEEN DATEADD(MONTH, -2, GETDATE()) AND GETDATE() AND patient_procedures.procedure_type = 'vascular stent insertion' AND specimen_collection.collection_date <= patient_procedures.procedure_date GROUP BY specimen ORDER BY specimen_count DESC LIMIT 5;"
d12cf57d8405a554dab7fa15,What are the five most frequently ordered medications that patients in their 60 or above were prescribed within 2 months after being diagnosed with abnormal coagulation profile in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal coagulation profile' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"select top 5 m.medicinename, count(m.medicinename) as total from Medication m join Diagnosis d on m.patientid = d.patientid join Patients p on p.patientid = m.patientid where d.diagnosiscode = 'abnormal coagulation profile' and d.diagnosisdate between '2100-01-01' and '2100-02-28' and p.age >= 60 and m.orderdate between d.diagnosisdate and dateadd(month, 2, d.diagnosisdate) group by m.medicinename order by total desc"
c08a8ca378cac26a4872dd1c,What were the top four most common lab tests done this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"select test_type, count(test_type) as test_count from lab_tests where test_date >= '2023-01-01' group by test_type order by test_count desc limit 4"
1d73f76e9729625f5d313029,Is the white blood cells level of patient 10001725 last measured on the first hospital visit less than the first measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN MAX(CASE WHEN visit_id = 'first' THEN wbc ELSE NULL END) < MIN(wbc) THEN 'Yes' ELSE 'No' END AS result FROM patient_data WHERE patient_id = '10001725' AND visit_id = 'first' AND measurement_type = 'white blood cells';
f727d26ce2437b323535a192,"For the patients with age 50s, what are the top five most frequent diagnoses since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"select top 5 diagnosis, count(*) as freq from patient_diagnosis where age/10=5 and year>=2100 group by diagnosis order by freq desc"
3203c674e0262061c0e9ecc5,Provide the sum total of inputs for patient 10007818 since 03/02/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-02'",[{'SUM(inputevents.totalamount)': 162565.80000305176}],SELECT SUM(input) FROM admissions WHERE patient_id = 10007818 AND date >= '03/02/2100'
8f4606909a78a1bbf2992c5c,"In their first hospital encounter, what was the last recorded weight for patient 10038081?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],select max(weight) as last_weight from measurements where patient_id = 10038081 and date = (select min(date) from measurements where patient_id = 10038081) and weight is not null
d792cf5775c1f4e850ffcde0,What was the last weight of patient 10004720 recorded?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT weight FROM patient_records WHERE patient_id = '10004720' ORDER BY record_date DESC LIMIT 1
943c84d543c4adfc73e1771b,What was the cost of the drug sodium glycerophosphate?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'sodium glycerophosphate' ),,"SELECT drug_name, cost FROM drug_costs WHERE drug_name = 'sodium glycerophosphate' ORDER BY date DESC LIMIT 1"
76752df29fef2ffe6127c97b,Was patient 10040025's chloride last measured on the last hospital visit greater than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN MAX(cl2.value) > MIN(cl2.value) THEN 'Yes' ELSE 'No' END as IsGreater FROM patient_10040025_visit_10040025_encounter_10040025_order_10040025_lab_cl2 cl2 GROUP BY cl2.visit_id ORDER BY cl2.result_date DESC LIMIT 1
e98f22d20d446f796e001b97,I want to know the total volume of input patient 10019777 has received on 03/03/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-03'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input_volume) AS TotalVolume FROM patient_inputs WHERE patient_id = '10019777' AND date = '2100-03-03';
b9fee2e62bcc843043e0a954,What output did patient 10026354 last have on 10/30/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-30' ORDER BY outputevents.charttime DESC LIMIT 1 )",[],select top 1 test_type from lab_tests where patient_id = '10026354' and test_date = (select max(test_date) from lab_tests where patient_id = '10026354' and test_date <= '2023-10-30') order by test_date desc
a773e86681735be6c53a92b5,"Count the number of patients who received a procedure this year for bypass coronary artery, two arteries from coronary artery, open approach.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,"SELECT COUNT(DISTINCT PatientId) FROM medical_records WHERE ProcedureCode = 'bypass coronary artery, two arteries from coronary artery, open approach' AND ProcedureDate BETWEEN '2023-01-01' AND '2023-12-31'"
39d97a0dad007c5882b2d34b,"For patients who received destruction of right main bronchus, via natural or artificial opening endoscopic in 2100, what are the top three most frequent diagnoses that followed afterwards within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT TOP 3 Diagnosis, COUNT(*) AS Frequency FROM PatientRecords WHERE Procedure = 'Destruction of right main bronchus via natural or artificial opening endoscopic' AND ProcedureDate = 2100 AND FollowUpDate BETWEEN ProcedureDate AND DATEADD(MONTH, 2, ProcedureDate) GROUP BY Diagnosis ORDER BY Frequency DESC"
94b0437ac528f3909e945a5f,Tell me the four most common diagnosis since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) AS diagnosis_count FROM patient_records WHERE diagnosis_date >= DATE_SUB(NOW(), INTERVAL 1 YEAR) GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 4"
f11bfe4033fc6ace5d5cf382,"Did patient 10021312 receive any destruction of left main bronchus, via natural or artificial opening endoscopic treatment in the previous year?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of left main bronchus, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"SELECT procedure_code FROM patient_procedures WHERE patient_id = '10021312' AND procedure_code LIKE 'Destruction of left main bronchus%' AND procedure_type IN ('Endoscopic', 'Natural opening', 'Artificial opening') AND procedure_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) AND CURRENT_DATE"
eae749337c708ec5697cf97e,What was the name of the medicine prescribed to patient 10020740 for the first time since 03/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Sodium Chloride 0.9%  Flush'}],SELECT medication_name FROM prescriptions WHERE patient_id = 10020740 AND date >= '2100-03-01' ORDER BY date ASC LIMIT 1
662a8bb09520c819a88e24a6,How many hours has it been since the last unspecified septicemia diagnosis of patient 10018081 during this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified septicemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"select sum(datediff(hour, diagnosis_time, now())) from septicemia_diagnoses where patient_id = '10018081' and hospital_visit_id = (select id from hospital_visits where patient_id = '10018081' and end_time > now()) and diagnosis_type is null"
a30a6f58cc091f3a0949184c,What were the five most commonly ordered lab tests for patients who were previously diagnosed with acute and subacute necrosis of liver within 2 months?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT test_name, COUNT(*) as test_count FROM lab_tests lt INNER JOIN diagnoses d ON lt.patient_id = d.patient_id WHERE d.diagnosis_code IN ('acute_necrosis', 'subacute_necrosis') AND d.diagnosis_date >= DATE_SUB(lt.test_date, INTERVAL 2 MONTH) GROUP BY test_name ORDER BY test_count DESC LIMIT 5"
e88b565b3eebfa84d07aba21,How much glyburide has patient 10015860 been prescribed in 10/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.drug = 'glyburide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10'",[{'SUM(prescriptions.dose_val_rx)': None}],[SELECT SUM(d.quantity) AS total_glyburide_quantity
4e87cca0b7f4f1c42928e016,How much will it cost me to get laparoscopic robotic assisted procedure done?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic robotic assisted procedure' ) ),,SELECT cost FROM medical_procedures WHERE procedure_type = 'laparoscopic robotic assisted' AND patient_age BETWEEN 20 AND 40
08777eb92c5be85c5613f0dd,When did the last hospital discharge of patient 10007795 occur?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007795 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT discharge_date FROM hospital_discharges WHERE patient_id = 10007795 ORDER BY discharge_date DESC LIMIT 1
c1adc1dd4db93616537a4296,Tell me the insurance plan of patient 10025612 on the first hospital visit.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Medicare'}],SELECT insurance_plan FROM hospital_visits WHERE patient_id = 10025612 ORDER BY visit_date ASC LIMIT 1
31792c8a6ad3a8418c47001b,What was the name of the drug that was prescribed to patient 10001217 during the same hospital encounter after having had a spinal tap procedure during this month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,[SELECT drg.drg_name FROM prescriptions pres
85cf7ff0c55460da32489392,Has patient 10006580 been through any surgery?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ),[{'COUNT(*)>0': 1}],SELECT DISTINCT procedure_name FROM medical_records WHERE patient_id = 10006580 AND procedure_type = 'surgery';
884dee5de94299004db9a1f2,How many current patients fall into the 60 or above age group?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,,SQL Query here
e5b93830a2376294094a1f1b,What was the amount of ezetimibe that was prescribed to patient 10021666 for the last time in 03/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'ezetimibe' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",[],top 1
bbe597ef5bc885d0751caef3,Tell me the name of the last specimen test patient 10002495 had received in 06/this year.,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '06' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],"SELECT specimen_test_name FROM test_results WHERE patient_id = 10002495 AND test_date BETWEEN DATE_FORMAT(NOW() ,'%Y-06-01') AND NOW() ORDER BY test_date DESC LIMIT 1;"
366e4fe872705e8dbb87ae20,How many pseudoephedrine prescription instances took place during the previous year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'pseudoephedrine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescriptions WHERE drug_name='pseudoephedrine' AND year=YEAR(NOW())-1;
cc628d6e0b5a259cf31aa0cf,When has patient 10029291 had the last input on 02/28/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '02-28' ORDER BY inputevents.starttime DESC LIMIT 1",[],SELECT MAX(ITEM_DATE) AS Last_Input_Date FROM ADT_ADM_REJ WHERE MRN = 10029291 AND ITEM_DATE < '2023-02-28'
e156f73b1bfc7f7069b386b3,Which are the four most commonly taken lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",SQLQuery
3438f141d7038a0bf312f74b,What was patient 10012552's last measured po2?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT po2_value FROM patient_measurements WHERE patient_id = 10012552 ORDER BY measurement_date DESC LIMIT 1
b9709f43c5ff64a2dd1b4d47,When was the last time that patient 10037975's SaO2 was measured at less than 90.0 on their last ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 90.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],[SELECT max(measurement_date) AS last_measurement_date
5d7c5f7770c961d7c84c8499,When did patient 10019172 have the maximum ph value the last time in 11/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],"select max(ph) as Max_ph_value, datetime from `my_data` where patient_id = '10019172' and datetime like '11/2100%' order by datetime desc limit 1"
c3f33ef0036d9efd71c23adc,What is the cost for the medicine phytonadione?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phytonadione' ),,SELECT price FROM drug WHERE name = 'phytonadione'
fb08961df2b632f9644c112c,When was patient 10015860's last hospital discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10015860 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2193-11-27 21:58:00'}],SELECT MAX(discharge_date) FROM hospital_discharges WHERE patient_id = '10015860' AND discharge_date IS NOT NULL
f7175ad460d1ff7aae62b0fa,What is patient 10038933's ketone change last measured on the first hospital visit compared to the value second to last measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SQL Query Here
cce128d8f29c8e7564cc8cc8,Patient 10015931 was diagnosed on the first hospital encounter for the first time with what?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,SELECT diagnosis_code FROM hospital_encounters WHERE patient_id = '10015931' AND encounter_number = 1 ORDER BY diagnosis_date ASC LIMIT 1
5b7ca8d49d2817d537c89baa,When were patient 10021938 first prescribed for nifedipine cr and calcium acetate at the same time since 09/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'nifedipine cr' AND admissions.subject_id = 10021938 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'calcium acetate' AND admissions.subject_id = 10021938 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT MIN(start_date) FROM prescriptions WHERE patient_id = 10021938 AND ((drug_name = 'nifedipine cr' AND drug_name = 'calcium acetate') AND start_date >= '2100-09-21')
b11ba285107d208de9e518f1,"Since the last diagnosis of patient 10018081 with overflow incontinence in this hospital encounter, how many hours have passed?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'overflow incontinence' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT TIMESTAMPDIFF(HOUR, (SELECT diagnosis_time FROM patient_diagnosis WHERE patient_id = 10018081 AND diagnosis = 'overflow incontinence' ORDER BY diagnosis_time DESC LIMIT 1), NOW()) AS hours_since_last_diagnosis"
9645c89ce0e75ea8d9ab156a,Do you know the average alanine aminotransferase (alt) value of patient 10004733 in 12/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12'",[{'AVG(labevents.valuenum)': None}],SELECT AVG(alt) FROM patient_records WHERE patient_id = 10004733 AND date = '12/2100'
0edf383920d07410f686cb96,"In 03/this year, when did patient 10019777 first receive the immature granulocytes test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immature granulocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT MIN(ADMITTIME) FROM labevents WHERE SUBJECT_ID = 10019777 AND ITEMID = 50824 AND EXTRACT(MONTH FROM ADMITTIME) = 3 AND EXTRACT(YEAR FROM ADMITTIME) = EXTRACT(YEAR FROM CURRENT_DATE) AND CHARTTIME <= ADMITTIME
5933a57b83835c59ed518dbf,Can you tell me the first heart rate of patient 10007928 on the last ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],"SELECT heart_rate FROM patient_data WHERE patient_id = 10007928 ORDER BY admission_date DESC, measurement_time ASC LIMIT 1"
2ec6cb1efc895f9201b5cf60,How many days have elapsed since the first time during their current hospital visit patient 10021487 got a other lab test?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],Your SQL query here
fbb777a428c35d8695cc62d5,What is the minimum value of ketone on patient 10036156 in 07/this year?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'",[{'MIN(labevents.valuenum)': None}],select min(ketone) from labevents where subject_id = 10036156 and itemid = 5084 and charttime between '2018-07-01' and '2018-07-31'
621f1abf8ceb45784a8a62b6,How many prescriptions for albumin 25% (12.5g / 50ml) were made last year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'albumin 25% (12.5g / 50ml)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescriptions WHERE drug_name = 'albumin 25%' AND dosage = '12.5g / 50ml' AND prescription_date BETWEEN '2022-01-01' AND '2022-12-31';
aad14eeea5e885e1009d3b1e,Has there been a procedure that patient 10001217 had since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT * FROM procedure_events WHERE person_id = '10001217' AND procedure_date >= '2100-01-01'
7a9d8c4e3514be8609110241,How much does a hospital typically spend minimum on a drug named morphine sr (ms contin)?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'morphine sr (ms contin)' ) GROUP BY cost.hadm_id ) AS T1,,SELECT MIN(`amount`) FROM `spending` WHERE `drug_name` = 'Morphine SR (MS Contin)'
c70087e768a59793cb584211,Can you tell me the top five most common lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]",SQL Query Here
a990c12b1e421dffb6cca4e2,What are the five most frequently ordered medications that patients in their 30s were prescribed during the same month after being diagnosed with unspecified essential hypertension in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 39 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 Medication_Name, COUNT(Medication_ID) AS Frequency FROM Prescriptions WHERE Diagnosis_Code = 'Unspecified Essential Hypertension' AND YEAR(Diagnosis_Date) = 2100 AND MONTH(Prescription_Date) = MONTH(Diagnosis_Date) AND PATIENT_AGE BETWEEN 30 AND 39 GROUP BY Medication_Name ORDER BY Frequency DESC"
167a500ff70d846339538bb9,When was the first time that patient 10023239 was prescribed medication via the iv drip route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(order_date) FROM prescriptions WHERE patient_id = 10023239 AND route = 'iv drip'
1c66f7fcfad7cbff26b54abe,"What are the top five most common microbiology tests for people who were diagnosed with respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia earlier within 2 months, since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"select top 5 test_name, count(*) as count from microbiology_tests where diagnosis='respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia' and date_performed >= '2100-01-01' and date_performed <= '2100-02-28' group by test_name order by count desc"
acb8470937bc4a7d0d9b622d,Can you confirm the gender of patient 10027602?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10027602,[{'gender': 'F'}],SELECT gender FROM patient WHERE id = 10027602
adcbe9f6b33c50d6f8540cda,When was the first hospital discharge time for patient 10022017?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[],SELECT MIN(discharge_time) FROM hospital_discharge WHERE patient_id = '10022017'
18d972f8815b6dbf2e9141c3,What was the admission type for patient 10039708's last admission to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039708 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1",[{'admission_type': 'OBSERVATION ADMIT'}],"SELECT top_admission_type FROM (SELECT admission_type, admission_date FROM admissions WHERE patient_id = 10039708 ORDER BY admission_date DESC) AS last_admission"
c7af43822b2032b4d685af10,"Among patients who took other repair of vessel in 2100, what are the top five most frequent diagnoses that followed in the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair of vessel' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM medical_records WHERE procedure = 'repair of vessel' AND year(procedure_date) = 2100 GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
cc5fbcfde89a0973970e7397,What was the total length of excise diaphragm lesion procedure for patient 594?,,,"select sum(l.length) from excise_diaphragm_lesion l, patient p where l.patient_id = p.patient_id and p.patient_id = 594"
eb588610d7a73daedf0f76c1,Was the value of patient 10001217's monocytes last measured on the first hospital visit greater than the value second to last measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT CASE WHEN MAX(m1.value) > MAX(m2.value) THEN 'Yes' ELSE 'No' END AS Result FROM lab_results m1 INNER JOIN lab_results m2 ON m1.patient_id = m2.patient_id AND m2.lab_test = m1.lab_test AND m2.date_collected < m1.date_collected AND m1.lab_test = 'Monocytes' WHERE m1.patient_id = 10001217 AND m2.lab_test = 'Monocytes' AND m1.visit_id = m2.visit_id AND m1.visit_id IN (SELECT MIN(visit_id) FROM lab_results WHERE patient_id = 10001217) ORDER BY m1.date_collected DESC, m2.date_collected DESC LIMIT 2,1)"
ceb8a5c222865829ffc00ea9,At what time did the last incident of patient 10019172 having a maximum SaO2 occur on last month/20?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '20' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],select * from patient_10019172 where timestamp = (select max(timestamp) from patient_10019172 where timestamp > '2020-11-01 00:00:00' and timestamp < '2020-11-30 23:59:59' and SaO2 = (select max(SaO2) from patient_10019172 where timestamp > '2020-11-01 00:00:00' and timestamp < '2020-11-30 23:59:59')) order by timestamp desc limit 1
a4da025718f83d20130260ea,When was patient 10004235's first discharge from the hospital?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004235 ORDER BY admissions.dischtime ASC LIMIT 1,[{'dischtime': '2196-03-04 14:02:00'}],select min(discharge_date) as FirstDischargeDate from discharges where patient_id = '10004235'
e73df961ffb6ab9df8d8eeab,What specimen test was given in their last hospital encounter to patient 10013049 for the last time?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}],SELECT TOP 1 LabTest FROM HospitalEncounters WHERE PatientID = 10013049 ORDER BY EncounterDate DESC
b5ce6c822904c206071d56a5,How many hours elapsed since patient 10004733 received his sodium lab test for the last time during the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(hour, MAX(date_of_na_lab), GETDATE()) FROM sodium_labs WHERE patient_id = 10004733 AND encounter_id = (SELECT encounter_id FROM encounters WHERE patient_id = 10004733 ORDER BY encounter_start_date DESC LIMIT 1) AND status = 'completed'"
c566bb57a34d5a1e6092531a,When did patient 10018081 have the maximum respiratory rate the first time since 76 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-76 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],SELECT date FROM vitals WHERE patient_id = 10018081 AND respiratory_rate = (SELECT MAX(respiratory_rate) FROM vitals WHERE patient_id = 10018081 AND date >= (CURRENT_DATE - INTERVAL '76 days')) ORDER BY date LIMIT 1;
f96633ec8fc87fce8f72854a,What is patient 10008287's gender?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10008287,[{'gender': 'F'}],select gender from patients where patient_id = 10008287;
d8a47bc9987e7055d48e418b,Show me the top three most frequent output instances during this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],
762190765b6e9b306ee94b34,What is the earliest visit of patient 97834 to other departments?,,,select min(date) from visits where patientid = 97834 and department != 'General Medicine'
0b6c432395ef9fcbfe105e93,Has any side effects been experienced by patient 3267 during a blood transfusion,,,SELECT COUNT(*) FROM `adverse_events` WHERE `patient_id` = '3267' AND `procedure_type` = 'blood transfusion';
3b3ec25a9c5acf7aca6a592b,Have any procedures been carried out on patient 10008287 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT * FROM procedures WHERE patient_id = '10008287' AND date > '2100-01-01'
3922a8bf089907b9a543783e,"After receiving enteral infusion of concentrated nutritional substances during this year, what are the three most common diagnoses that patients received within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT TOP 3 Diagnosis, COUNT(*) as Frequency FROM PatientRecords WHERE EnteralInfusionDate BETWEEN DATEADD(year, -1, GETDATE()) AND GETDATE() AND DateOfDiagnosis BETWEEN EnteralInfusionDate AND DATEADD(month, 2, EnteralInfusionDate) GROUP BY Diagnosis ORDER BY Frequency DESC"
6ef2fe833cee5960612ae052,Does patient 10211 have an appointment in other department?,,,SELECT * FROM appointments WHERE patient_id = 10211 AND department_id != (SELECT department_id FROM appointments WHERE patient_id = 10211 LIMIT 1)
c3ec8c1023fa687bb2624e68,Can you provide me the daily average amount of or colloid intake that patient 10039831 received in their current hospital visit?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],SELECT AVG(quantity) AS DailyAverage FROM intake_events WHERE patient_id = 10039831 AND visit_id = (SELECT visit_id FROM visit_occurrence WHERE person_id = 10039831 ORDER BY visit_start_date DESC LIMIT 1) AND (drug_concept_id = 38000328 OR drug_concept_id = 38000143) GROUP BY visit_start_date;
6ef2183a66a1c25b6446eee9,How long did patient 18457 receive below knee amputat nec?,,,SELECT SUM(duration) FROM patient_treatment_records WHERE patient_id = 18457 AND treatment_type = 'below_knee_amputat_nec'
6fbc822299d5ed6324fb6280,What immuno-cancer drugs have been in use for the last five years?,,,"SELECT DISTINCT drug_name FROM immuno_cancer_drugs WHERE approved_date >= DATE_SUB(CURDATE(), INTERVAL 5 YEAR)"
98f2f619a8c325c797be99a3,What was the name of that first specimen test patient 10003046 got in the first hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}],SELECT specimen_name FROM patient_visits JOIN specimens ON patient_visits.specimen_id = specimens.id WHERE patient_visits.patient_id = 10003046 AND visit_number = 1
fff1f1751b80965886ad5fbd,What was the total number of drugs patient 10000032 was prescribed since 03/2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",[{'COUNT(*)': 81}],SELECT COUNT(*) FROM Prescriptions WHERE patient_id = '10000032' AND date_prescribed >= '03/2100'
20b78d286ce05435b56b849f,What was patient 10026354's first measurement for arterial blood pressure diastolic since 06/24/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-24' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT TOP 1 diastolic_bp AS FirstDiastolicBp FROM PatientMeasurements WHERE patient_id = 10026354 AND measurement_date > '2100-06-24' AND measurement_type = 'arterial_blood_pressure_diastolic' ORDER BY measurement_date ASC;
b84f8bef2656a98e1a21f179,What is the percentile of 42.0 in the laboratory test with platelet count at the same age of patient 10000032 in the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 42.0",,select percentile_cont(0.5) within group (order by laboratory_test__platelet_count) from (select * from laboratory_test where patient_id = 10000032 and visit_id = 1) as subquery
72faafda75d4e4a844d6cd9d,Please provide the three most common tests performed on specimens since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT TestName, COUNT(*) as TestCount FROM LabTests WHERE SpecimenDate > DATEADD(year, -1, GETDATE()) GROUP BY TestName ORDER BY TestCount DESC LIMIT 3"
15b58da2d88da3aa6b767f4e,What was the last diagnosis for patient 10012853?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,SELECT diagnosis FROM PatientRecords WHERE patient_id = 10012853 ORDER BY visit_date DESC LIMIT 1
db398e1ac2a8d286cc4b53bb,"What is the minimum total cost of a hospital stay involving adverse effect of unspecified antiepileptic and sedative-hypnotic drugs, initial encounter?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'adverse effect of unspecified antiepileptic and sedative-hypnotic drugs, initial encounter' ) ) GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_cost) FROM medical_records WHERE diagnosis_code = 'T42.3X1A' AND encounter_type = 'initial';
064e1e18ab989d89c93ed694,How many patients were diagnosed with acute post-thoracotomy pain within 2 months after first being diagnosed with accidents occurring in residential institution in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidents occurring in residential institution' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute post-thoracotomy pain' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,SELECT COUNT(*) AS patient_count
053a84a3939291b5875a4bb2,Tell me the amount of kcl (bolus) input that patient 10004235 received on 03/21/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-21'",[{'SUM(inputevents.totalamount)': None}],select sum(amount) from chartevents where itemid = 220045 and subject_id = 10004235 and charttime = '03/21/2100'
74800adca8d5382b227f11fc,When was the last time the heart rate of patient 10027602 was measured to be greater than 95.0 on last month/26?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 95.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '26' ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(Measurement_Date) FROM Heart_Rate WHERE Patient_ID = 10027602 AND Measurement_Value > 95.0 AND Measurement_Date BETWEEN DATE_FORMAT(CURDATE() - INTERVAL 1 MONTH, '%Y-%m-01') AND LAST_DAY(CURDATE() - INTERVAL 1 MONTH)"
3a8edca352170e0eec95d919,Give me the top three most common lab tests throughout this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],"[SELECT lab_tests.name, COUNT(lab_tests.test_id) as test_count FROM lab_tests"
79d16bbe75c1b79b191237dd,Can you tell the three most frequent lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],"SELECT lab_test_name, COUNT(*) AS frequency FROM lab_tests WHERE year = 2100 GROUP BY lab_test_name ORDER BY frequency DESC LIMIT 3;"
60ea85db45d1ad1ad72cf62a,Has patient 10010471 received any lab tests since 07/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07'",[{'COUNT(*)>0': 1}],SELECT * FROM lab_tests WHERE patient_id = 10010471 AND test_date >= '2100-07-21'
cf057692f01ed1e43b7ab26f,What is the value of patient 10018845's monthly average or crystalloid intake input during their first hospital visit?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",[],"select avg(crystalloid) from inputevents_mv where patient_id = 10018845 and category = ""Intravenous intake"" and (charttime between (select starttime from admission where patient_id = 10018845) and (select endtime from admission where patient_id = 10018845)) group by patient_id"
99ba97a4365a81e47395a5e1,Has patient 10026255 experienced any surgeries since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT * FROM surgeries WHERE patient_id = 10026255 AND date >= '2100-01-01'
babb2410ee949a2d7a609b15,Give me the total volume of output for patient 10011398 since 01/19/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19'",[{'SUM(outputevents.value)': 4314.0}],SELECT SUM(output_volume) AS total_volume FROM patient_outputs WHERE patient_id = '10011398' AND output_date >= '2100-01-19'
c9d8cdde8cb8a16012cdc065,What was the drug that was last prescribed to patient 10019568 via the ivpca route in the first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'ivpca' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"select top 1 m.medicine_name, m.medicine_id, m.route from medicine m join prescription p on m.medicine_id = p.medicine_id where p.patient_id = 10019568 and m.route = 'ivpca' and p.hospital_id = 1 order by p.prescription_time desc"
fede243c3b7b2698d441af96,The first time patient 10004733 was prescribed lidocaine 1% and heparin flush (10 units/ml) at the same time in 12/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin flush (10 units/ml)' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lidocaine 1%' AND admissions.subject_id = 10004733 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"SELECT TOP 1 e.encounter_id, e.visit_id, e.visit_date FROM encounter e JOIN orders o ON e.encounter_id = o.encounter_id WHERE o.patient_id = 10004733 AND o.drug = 'lidocaine 1%' AND o.order_date = '12/2100' AND EXISTS (SELECT 1 FROM orders o2 WHERE o2.patient_id = 10004733 AND o2.drug = 'heparin flush (10 units/ml)' AND o2.order_date = o.order_date) ORDER BY e.visit_date, e.visit_id"
218a35d3fd0012d75ff34412,Show me the top four microbiology tests.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]",SELECT TOP 4 test_name FROM microbiology_tests ORDER BY test_count DESC
e3ef5dc86e154039d7839324,When was the last time patient 10021118 had the minimum monocytes in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],select max(date) from blood_tests where patient_id=10021118 and monocytes=(select min(monocytes) from blood_tests where patient_id=10021118 and date like '2023-12%') and date like '2023-12%'
7c14ad97c239a78381bd7174,Has patient 10002495 gotten any medication since 03/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",[{'COUNT(*)>0': 1}],select * from EHR.medication where patient_id = 10002495 and date >= '03/2100'
4fd17cfcc175d92c67e22fdb,When last did patient 10004422 have the maximum respiratory rate on 01/19/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '01-19' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],"SELECT max_value, max_datetime FROM `physionet-data.mimiciii_clinical.icustays` WHERE SUBJECT_ID = 10004422 AND HADM_ID = 10004422 AND (max_datetime BETWEEN '2023-01-19 00:00:00' AND '2023-01-19 23:59:59') ORDER BY max_datetime DESC LIMIT 1;"
592fc15a830589ea90962e04,How many patients were present in the emergency department observation in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS number_of_patients FROM observation WHERE department = 'emergency' AND year = 2100
feb492e9caf0343b3c2f2166,Count the total number of hospital visits made by patient 10021118 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10021118 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],SELECT COUNT(*) FROM Hospital_Visits WHERE PatientID = '10021118' AND Visit_Date >= '2100-01-01'
d0c0f7766e9f698b1439c34e,"What are the three commonly ordered medications for patients who were diagnosed with atrial fibrillation previously in the same hospital visit, in this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 medication_name, COUNT(*) AS order_count FROM prescriptions WHERE diagnosis_code = 'Atrial Fibrillation' AND visit_date = diagnosis_date AND YEAR(diagnosis_date) = YEAR(CURRENT_DATE) GROUP BY medication_name ORDER BY order_count DESC"
07a08dc4b74589ad11ceabfd,Can you show me the top four frequent output events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]",SELECT * FROM event_log ORDER BY event_count DESC LIMIT 4
ee1994bbfcf913af08ad4dd8,Can you tell me which were the top four most frequent specimens tested in 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",[],"SELECT specimen_type, COUNT(*) AS frequency FROM Test WHERE year = 2100 GROUP BY specimen_type ORDER BY frequency DESC LIMIT 4"
fd8bbc85aa480d84c446fef0,Tell me the maximum respiratory rate for patient 10039831's body since 06/29/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-29'",[{'MAX(chartevents.valuenum)': None}],SELECT MAX(respiratory_rate) FROM patient_data WHERE patient_id = 10039831 AND body = 'specific_body' AND datetime >= '2100-06-29'
15f218ddc4b0e3bc25f8f534,Was patient 10026255 checked into the hospital in the previous year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026255 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],SELECT hospitalization_id FROM hospitalization WHERE patient_id = 10026255 AND admission_date BETWEEN '2022-01-01' AND '2022-12-31'
80a3a1b02bca2873dc0308c4,"This year, has patient 10031757 been diagnosed with any disease?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,select * from patient_diseases where patient_id = 10031757 and YEAR(diagnosis_date) = YEAR(CURRENT_DATE)
b94c880fccb8435757f8e05b,Calculate patient 10008454's length of stay in days for the first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.983888888731599}]",SELECT SUM(julianday(LEAVE_TIME) - julianday(ENTER_TIME)) AS LengthOfStayDays FROM ICU_STAYS WHERE PATIENT_ID = 10008454 ORDER BY ENTER_TIME ASC LIMIT 1
2869bb3db5897f9d72d506b0,What are the five most commonly prescribed medications for patients who were previously diagnosed with other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle within 2 months?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other motor vehicle traffic accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 Medication, COUNT(Medication) AS Frequency FROM PatientPrescriptions WHERE PreviousDiagnosis = 'Motor Vehicle Traffic Accident involving collision with motor vehicle injuring driver of motor vehicle other than motorcycle' AND PrescriptionDate BETWEEN DiagnosisDate AND DATEADD(MONTH, 2, DiagnosisDate) GROUP BY Medication ORDER BY Frequency DESC;"
38d26509efa287e305910833,"Since 1 year ago, how many patients required dorzolamide 2%/timolol 0.5% ophth.?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dorzolamide 2%/timolol 0.5% ophth.' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM prescriptions WHERE drug = 'dorzolamide 2%/timolol 0.5%' AND prescription_date >= CURRENT_DATE - INTERVAL '1 year'
cd0bcb070c47177a7ad4ff35,"In the last year, how many patients were provided with vancomycin oral liquid?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin oral liquid' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS patient_count FROM prescriptions WHERE medication_name = 'vancomycin oral liquid' AND prescription_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
cefa3a76e1b80de7cca8cbf1,"What are the three frequently prescribed medications within 2 months to the patients aged 60 or above after diagnosed with chronic kidney disease, unspecified since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic kidney disease, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 medication_name, COUNT(*) AS prescription_count FROM prescriptions WHERE patient_age >= 60 AND diagnosis = 'chronic kidney disease, unspecified' AND diagnosis_date >= DATEADD(month, -12, GETDATE()) AND prescription_date >= DATEADD(month, -2, GETDATE()) GROUP BY medication_name ORDER BY prescription_count DESC"
12f5279f948c5fccb5f94517,What were the total amount of magnesium sulfate (bolus) input that patient 10005817 received since 12/25/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-25'",[{'SUM(inputevents.totalamount)': None}],select sum(input_amount) from chartevents where itemid=5087 and subject_id=10005817 and charttime<'12/25/2101' and input_type='Bolus'
725d74abd24c1af33ef5d212,When did patient 10002428's first microbiological test occur?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'charttime': '2155-07-15 02:00:00'}],"SELECT MIN(test_date) AS ""First_Test_Date"" FROM microbiological_tests WHERE patient_id = 10002428;"
24155b9f4c00416b2b4a02d5,Can you tell me the first time on last month/12 patient 10005909 had a maximum heart rate?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '12' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(visit_date) FROM patient_readings WHERE patient_id = '10005909' AND heart_rate = (SELECT MAX(heart_rate) FROM patient_readings WHERE patient_id = '10005909' AND visit_date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND visit_date < CURDATE())"
0925d99c93fdf4626caf71cc,Get the count of hospital visits by patient 10019777 during this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019777 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT COUNT(*) FROM hospital_visits WHERE patient_id = 10019777 AND EXTRACT(YEAR FROM visit_date) = EXTRACT(YEAR FROM CURRENT_DATE);
c2e4f992fdf2b0fe03106e5a,Tell me the total number of patients in neuro stepdown since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS total_patients FROM patients WHERE unit = 'neuro stepdown' AND admission_date >= DATEADD(year, -1, GETDATE())"
e39761455f93b4f0ebb90b4e,Retrieve the top four most frequent diagnoses of patients with age in their 20s this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis_code, COUNT(*) AS diagnosis_frequency FROM patient_records WHERE YEAR(birth_date) > YEAR(CURDATE()) - 21 AND YEAR(birth_date) <= YEAR(CURDATE()) - 20 AND YEAR(record_date) = YEAR(CURDATE()) GROUP BY diagnosis_code ORDER BY diagnosis_frequency DESC LIMIT 4"
60c25b9b360a4037bd94de94,When was the last time that patient 10027602 has had the maximum diastolic blood pressure in their last ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],SQL Query
2bbc414d187b0af13c72744e,"Tell me the top four most commonly prescribed medications in the same month to patients in their 60 or above who were diagnosed with congestive heart failure, unspecified since 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT medication_name, COUNT(*) AS prescription_count FROM prescriptions INNER JOIN diagnoses ON prescriptions.patient_id = diagnoses.patient_id INNER JOIN patients ON prescriptions.patient_id = patients.id WHERE diagnoses.condition = 'Congestive Heart Failure, Unspecified' AND diagnoses.diagnosis_date > '2100-01-01' AND patients.age >= 60 AND prescriptions.prescription_date = diagnoses.diagnosis_date GROUP BY medication_name ORDER BY prescription_count DESC LIMIT 4"
b17a81cf82fe8e6f3d0705eb,What is the average value of absolute eosinophil count in patient 10019385's body in 03/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'",[{'AVG(labevents.valuenum)': None}],SELECT AVG(ABSOLUTE_EOSINOPHIL_COUNT) FROM lab_results WHERE PATIENT_ID = '10019385' AND TEST_DATE BETWEEN '2023-03-01' AND '2023-03-31'
d9de692b97657d92d074c361,How many times did patient 10006580 attend the hospital in the previous year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10006580 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],"SELECT COUNT(*) AS visit_count FROM HospitalVisits WHERE patient_id = 10006580 AND visit_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE();"
179e0c7223f1d82e5c946ad0,"How many congestive heart failure, unspecified patients in this year were diagnosed during the same month after being diagnosed with other nonspecific abnormal finding of lung field?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific abnormal finding of lung field' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT COUNT(*) FROM i2b2demodata.observation_fact WHERE observation_concept_cd IN (SELECT concept_id FROM i2b2demodata.concept WHERE concept_name='Congestive Heart Failure, Unspecified') AND YEAR(observation_datetime) = YEAR(CURDATE()) AND MONTH(observation_datetime) = MONTH(CURDATE()) AND observation_id IN (SELECT observation_id FROM i2b2demodata.observation_fact WHERE observation_concept_cd IN (SELECT concept_id FROM i2b2demodata.concept WHERE concept_name='Other Nonspecific Abnormal Findings of Lung Field') AND observation_datetime < (SELECT observation_datetime FROM i2b2demodata.observation_fact WHERE observation_id = i2b2demodata.observation_fact.observation_id))"
6ee64a55e047a6157abffad9,Has any prescriptions been given to patient 10006580 since 03/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",[{'COUNT(*)>0': 1}],SQL Query
e93b96a3e733e74dba4a0f26,Tell me the number of patients diagnosed with type 2 diabetes mellitus with unspecified complications.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus with unspecified complications' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from diabetes_patient_records where diagnosis = 'type 2 diabetes mellitus' and complications = 'unspecified';
261c55328ac8ffc4792c6e5e,What is the maximum total cost for a hospital visit that involved a uric acid lab test in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'uric acid' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_cost) AS max_total_cost FROM Hospital_Visits_HV_2100 WHERE visit_included_lab_test_uric_acid = 'Y'
394a6722595bd4c93789a2b6,"Metoprolol tartrate, phytonadione, or vitamin d has been prescribed for patient 10003400.","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND prescriptions.drug IN ( 'metoprolol tartrate', 'phytonadione', 'vitamin d' )",[{'COUNT(*)>0': 0}],"select count(*) from prescribable where patient_id = 10003400 and prescribable_id in ('metoprolol tartrate', 'phytonadione', 'vitamin d')"
0ad44ecce7e9c2eea3028673,Has patient 10009049 undergone any laboratory tests since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'",[{'COUNT(*)>0': 1}],SELECT * FROM laboratory_tests WHERE patient_id = '10009049' AND test_date >= '2100-04-01'
cdd34197e0de15595e116b81,Can you tell me the last o2 saturation pulseoxymetry of patient 10020740 on 04/04/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-04-04' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT TOP 1 o2_saturation FROM pulseoxymetry_records WHERE patient_id = '10020740' AND record_date = '2100-04-04' ORDER BY record_time DESC
34bcde5942f36df939445209,How are the precautions after the creat esophagastr sphinc procedure?,,,select precaution from table_name where procedure = 'creatin esophagostomysphincteroplasty'
6e7eea4d83bc22c485bd34f3,What is the maximum monthly number of people diagnosed with compression of brain since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'compression of brain' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,"SELECT MAX(count) AS maximum_monthly_diagnoses FROM (SELECT DATE_FORMAT(diagnosis_date, '%Y-%m') AS diagnosis_month, COUNT(*) AS count FROM health_records WHERE condition = 'compression of brain' AND YEAR(diagnosis_date) >= 2100 GROUP BY diagnosis_month) AS monthly_counts"
8df09dad6578de1a0c901527,Did patient 10006580 have any prescriptions for medicines on their last hospital encounter?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) FROM prescriptions WHERE patient_id = 10006580 AND encounter_date = (SELECT MAX(encounter_date) FROM encounters WHERE patient_id = 10006580)
54cf4ad46263c89423b40945,Tell me the top five most frequent procedures that patients were given within the same hospital visit after receiving repair of other hernia of anterior abdominal wall since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of other hernia of anterior abdominal wall' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT Procedure, COUNT(*) AS Frequency FROM HospitalVisits WHERE PrimaryProcedure = 'Repair of other hernia of anterior abdominal wall' AND VisitTime > '2100' GROUP BY Procedure ORDER BY Frequency DESC LIMIT 5"
1607c40d51d24cbf1164290b,Has any prescription drug been given to patient 10022880 since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 1}],SELECT DISTINCT drug_name FROM prescriptions WHERE patient_id = 10022880 AND date_prescribed > '2100-01-01';
827992b8de480860fb744924,"On the current hospital visit, how many days passed since the first other fluid overload diagnosis of patient 10021487?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other fluid overload' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT DATEDIFF(day, (SELECT MIN(DiagnosisDate) FROM Diagnoses WHERE PatientID = '10021487' AND ICDCode = 'E87.70'), (SELECT VisitDate FROM Visits WHERE PatientID = '10021487' AND VisitDate = (SELECT MAX(VisitDate) FROM Visits WHERE PatientID = '10021487'))) AS DaysSinceFirstDiagnosis FROM Visits WHERE PatientID = '10021487' AND VisitDate = (SELECT MAX(VisitDate) FROM Visits WHERE PatientID = '10021487') LIMIT 1;"
329d0bb92a0e71548c78f544,Can you tell me how many days patient 10007818 stayed in the ICU during their last stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 20.528680555988103}]",SELECT MAX(length_of_stay) FROM ICUStays WHERE patient_id = '10007818' AND stay_date = (SELECT MAX(stay_date) FROM ICUStays WHERE patient_id = '10007818')
6ad5a9078781b4734aa37e35,What is the total count of patients who stayed in careunit vascular in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from patient where careunit = 'vascular' and yearofstay = 2100
ac606737f9bd303254cf3a86,"After getting diagnosed with hemiplegia and hemiparesis following cerebral infarction affecting left non-dominant side, how many patients were found to have bradycardia, unspecified in the same hospital visit since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia and hemiparesis following cerebral infarction affecting left non-dominant side' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bradycardia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,"select count(distinct a2c.patient_id) from a2c_encounter a2c inner join a2c_diagnosis a2d on a2c.encounter_id = a2d.encounter_id where a2d.visit_class='A' and a2d.code in ('I63.3','G81.3','G81.2','I45.9') and a2d.encounter_id in (select distinct a2d1.encounter_id from a2c_diagnosis a2d1 inner join a2c_procedure a2p on a2d1.encounter_id = a2p.encounter_id where a2p.code in ('94.81')) and a2c.visit_start_time >= '2100' and a2c.visit_start_time < '2200'"
ebbbea82024643bb7a0d0271,Show me the top three most commonly prescribed drugs within 2 months to the patients aged 60 or above after diagnosed with do not resuscitate since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'do not resuscitate' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"[SELECT drug_name, COUNT(*) AS prescription_count FROM prescriptions"
dff52a931ff5d9812d2e68c8,"How many patients were diagnosed with bradycardia, unspecified since 2100 after previously being diagnosed with polyneuropathy, unspecified in the same month?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bradycardia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"select count(distinct a.person_id) from condition_occurrence a inner join condition_occurrence b on a.person_id=b.person_id and a.condition_concept_id=b.condition_concept_id where a.condition_concept_id = 4168539 and b.condition_concept_id = 4269495 and a.condition_start_date >= '2100-01-01' and a.condition_start_date between b.condition_start_date and add_months(b.condition_start_date, 1)"
323d3cb95ad2c7d62dfd8cb3,Tell me the name of the output patient 10039831 had for the first time since 12/29/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-29' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'OR EBL'}],SELECT name FROM output_patient_10039831 WHERE date >= '12/29/2100' ORDER BY date ASC LIMIT 1
45e515311022b0e3085d278f,When was the first time in which patient 10016742 had the minimum heart rate on 08/02/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '08-02' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",[],"select min(heartrate) as min_heartrate, time from ecg_data where patient_id = 10016742 and date = '2023-08-02';"
22386e52d5ee964fb29ac28b,Calculate the total quantity of output of patient 10004235.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ),[{'SUM(outputevents.value)': 9553.0}],select sum(quantity) from `physionet-data.mimiciii_clinical.outputevents` where patient_id = 10004235
7c03a7d1027f6d34619316ee,Will patient 739 get any blood (ebv) tests???,,,select * from blood_tests where patient_id = 739 and test_type = 'ebv'
a14c0a5446f2f1b57b2a4c07,How much is the price for glycerin supps?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'glycerin supps' ),,select avg(price) from (select distinct price from products where product_name like '%glycerin%supps%')
c9769b44044478c7148aed85,What's the diastolic blood pressure difference of patient 10021118's body last measured on the last ICU visit compared to the value first measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SQL Query
4be47d4fcbaf07a2f5b1d8ac,"Among patients diagnosed with bite of other animal except arthropod in 2100, what are the top five most common lab tests that followed afterward during the same month?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bite of other animal except arthropod' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT test_name, COUNT(*) AS test_count FROM lab_tests WHERE patient_id IN (SELECT patient_id FROM diagnoses WHERE diagnosis = 'Bite of other animal except arthropod' AND year = 2100) AND EXTRACT(MONTH FROM test_date) = EXTRACT(MONTH FROM diagnosis_date) GROUP BY test_name ORDER BY test_count DESC LIMIT 5"
4be515e40345fb288dd58aa5,When was the first time of input time of patient 10007818 on 07/10/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-07-10' ORDER BY inputevents.starttime ASC LIMIT 1",[],SELECT MIN(input_time) FROM patient_records WHERE patient_id = '10007818' AND DATE(input_date) = '2100-07-10'
279b2975d141762b456cd18d,Tell me the name of the diagnosis that patient 10855 received in the other department,,,select diagnosis from diagnoses where patient_id = 10855 and department = 'other'
9c7986d4a90c81c0aaaf986f,When was the first blood culture microbiology test of patient 10039708's performed since 23 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-23 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],"SELECT MIN(performed_at) FROM blood_tests WHERE patient_id = 10039708 AND test_type = 'microbiology' AND performed_at >= DATEADD(month, -23, GETDATE())"
2c1c7ca9c89b574bbf2e0995,What was the minimum monthly number of patients who had hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts) in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,SQLQuery
88fdf3da1ae1fa49b61efe01,What was the number of times trimethoprim was prescribed since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'trimethoprim' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)': 0}],"SELECT COUNT(*) AS PrescriptionsCount FROM prescriptions WHERE medication = 'trimethoprim' AND prescription_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
94556faa4ba7d0ff0917653d,When did patient 10002428 get a blood culture microbial test for the first time since 05/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],select top 1 distinct date from lab_test where patient_id = 10002428 and test_name = 'Blood Culture Microbial' and date >= '05/2100' order by date asc
5e25f7703857496eb27b9a2a,Has patient 13329 experienced any side effects during a blood transfusion?,,,"SELECT patient_id, side_effect FROM blood_transfusion_records WHERE patient_id = 13329 AND side_effect IS NOT NULL"
6ad09c06402234bbbe81de49,"What was the last time, on this month/06, that patient 10008454's mean blood pressure was less than 108.0?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 108.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '06' ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(record_date) FROM (SELECT record_date, AVG(blood_pressure) AS mean_bp FROM patient_records WHERE patient_id = '10008454' AND MONTH(record_date) = 6 AND YEAR(record_date) = YEAR(CURRENT_DATE) GROUP BY record_date) AS subquery WHERE mean_bp < 108.0"
59c00de184347b5897bcc303,Can you tell me the cost of mediastinoscopy?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'mediastinoscopy' ) ),,SELECT AVG(procedure_cost) as avg_cost FROM medical_procedures WHERE procedure_name = 'mediastinoscopy';
44ccda4ff4ceaa8e1e95040c,When was the first microbiology test that was given to patient 10027445 since 08/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2142-07-31 06:07:00'}],SELECT TOP 1 test_date FROM microbiology_tests WHERE patient_id = '10027445' AND test_date > '2008-08-01' ORDER BY test_date ASC
64633965444f470a4ca586e8,How soon is patient 4758's next hospital visit?,,,select top 1 visit_date from visits where patient_id=4758 and visit_date >= getdate() order by visit_date
99db8d08ce7c7dc5e23bb2ab,Has patient 10007928 had a hospital admission during this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM admissions WHERE patient_id = 10007928 AND admission_date >= '2023-01-01' AND admission_date <= '2023-12-31';
c0f3de8a38ca15677c20c16d,"Tell me, was magnesium sulfate (bolus) given to patient 10007818 during the first ICU visit?",SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM event_table WHERE subject_id = '10007818' AND event_name = 'magnesium sulfate (bolus)' AND category = 'Medication' AND visit_id LIKE 'ICU%' AND charttime BETWEEN 'ICU_admission_time' AND 'ICU_discharge_time'
c1052714fdc43216d8caaaa3,What are the four diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT Diagnosis, COUNT(Deceased) AS MortalityCount FROM PatientRecords WHERE DischargeDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 3 MONTH) AND CURDATE() GROUP BY Diagnosis ORDER BY MortalityCount DESC LIMIT 4"
22a17e0cd02cf807c470a259,Can you tell me the total volume of pre-admission output for patient 10037975 since 351 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-351 day')",[{'SUM(outputevents.value)': None}],"SELECT SUM(pre_admission_output) FROM pre_admission_output WHERE patient_id = 10037975 AND output_date >= DATE_SUB(CURDATE(), INTERVAL 351 DAY)"
980016183fee2c1f4ae611ae,Has patient 10007818 undergone laboratory tests since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',labevents.charttime) >= '2100'",[{'COUNT(*)>0': 1}],"SELECT patient_id, test_name, test_date FROM lab_results WHERE patient_id = 10007818 AND test_date >= '2100-01-01' ORDER BY test_date ASC"
5bf08c9869d070204f3790e2,When was the first time that in 05/2100 patient 10018423 was prescribed a medication via nu?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND prescriptions.route = 'nu' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(date) FROM prescription WHERE patient_id = 10018423 AND medication_via = 'nu' AND date >= '05/2100'
dc086ae27c1b78b95332d217,Is the o2 saturation pulseoxymetry level of patient 10011398 last measured on the first ICU visit less than the first measurement on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN (SELECT O2_SAT_PULSEOXIMETRY FROM MEASUREMENTS WHERE PATIENT_ID = '10011398' AND MEASUREMENT_TYPE = 'O2_SAT_PULSEOXIMETRY' AND ICU_VISIT_NUMBER = 1 ORDER BY MEASUREMENT_DATETIME DESC LIMIT 1) < (SELECT O2_SAT_PULSEOXIMETRY FROM MEASUREMENTS WHERE PATIENT_ID = '10011398' AND MEASUREMENT_TYPE = 'O2_SAT_PULSEOXIMETRY' AND ICU_VISIT_NUMBER = 1 ORDER BY MEASUREMENT_DATETIME ASC LIMIT 1) THEN 'Yes' ELSE 'No' END AS Is_Last_Measurement_Less
f95edd83ff3d509561310e88,How many days have it been since patient 10021487 had received a mch laboratory test during this hospital visit for the first time?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT DATEDIFF(day, MIN(lab_test_date), CURRENT_DATE) FROM laboratory_tests WHERE patient_id = 10021487 AND visit_id = (SELECT MIN(visit_id) FROM laboratory_tests WHERE patient_id = 10021487) AND test_type = 'mch'"
646dc3c2d9906fbf675e6443,How many hours have it been since patient 10004733 had received a hematocrit laboratory test on the current hospital encounter for the last time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MAX(t.timecreated), NOW()) FROM labevents t JOIN (SELECT visit_num FROM (SELECT visit_num, MIN(ROW_ID) AS visit_num FROM labevents WHERE SUBSTRING(charttime, 1, 10) = DATE(NOW()) AND SUBSTRING(charttime, 12, 8) = '00:00:00' GROUP BY visit_num) t2 WHERE t2.visit_num IN (SELECT visit_num FROM labevents WHERE SUBSTRING(charttime, 1, 10) = DATE(NOW()) AND SUBSTRING(charttime, 12, 8) = '00:00:00' AND itemid IN (51262, 51265) AND SUBJECT_ID=10004733)) t3 ON t.visit_num = t3.visit_num WHERE t.itemid IN (51262, 51265) AND t.SUBJECT_ID=10004733"
a7bf9a18f2ed133ccc62c5c3,"In 2100, has patient 10039708 been diagnosed with anything?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'",,SELECT DISTINCT d.diagnosis FROM diagnoses d WHERE d.patient_id = '10039708' AND d.diagnosis_date >= '2100-01-01' AND d.diagnosis_date <= '2100-12-31'
ff717f132bef7b20380c93f7,What was the name of the organism that was found in the last microbiology test on patient 10021487's abscess since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT organism_name FROM microbiology_tests WHERE patient_id = '10021487' AND test_date = (SELECT MAX(test_date) FROM microbiology_tests WHERE patient_id = '10021487' AND abscess = TRUE AND test_date >= '02/21/2000')
bcda489a731952e657ccee47,When was the last time that patient 10027445 had a minimum respiratory rate on 09/09/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-09-09' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],select max(recorded_at) from measurement where person_id = 10027445 and measurement_concept_id = 50919074 and recorded_at <= '2100-09-09'
110ca8ef52a592fe8201ca1c,What diagnosis did patient 10005866 have last in the first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,select top 1 d.diagnosis from icd d join visit v on d.visit_id=v.visit_id where v.patient_id=10005866 and v.admit_date=v.discharge_date order by d.visit_id desc
a035bf3a134c3a5f16e7e841,"How many hours elapsed since the first time patient 10021487 received a rbc, pleural lab test on this hospital visit?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"select date_part('day', now()-min(date_drawn)) from lab_events where patient_id = 10021487 and order_id = 'rbc, pleural' and visit_occurrence_id = 100000001 and result is not null"
89aa1f3b263599aa7da317e8,What was the name of the output which patient 10018081 had last had since 10/31/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-31' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],select distinct(output_name) from output where output.patient_id = '10018081' and output.date > '2010-10-31' order by output.date desc limit 1;
103007809bffe0c602448146,How many patients were let go from hospitals in the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) as discharged_patients FROM hospital_records WHERE discharge_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
2add4b6f52a7f92255a99795,Could you list patient 10021938's daily average weight since 07/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-07' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT DATE, AVG(weight) FROM weight_records WHERE patient_id = 10021938 GROUP BY DATE"
0f415abf215849df3c74d8fb,What is the average value of bicarbonate in patient 10025612's body?,SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ),[{'AVG(labevents.valuenum)': None}],SELECT AVG(bicarbonate) AS average_bicarbonate FROM patient_data WHERE patient_id = '10025612' AND bicarbonate IS NOT NULL;
3f720ea93f94700efe7fe7ee,What is the percentile of 4.46 for a red blood cells test given the same age as patient 10026406 on the first hospital stay?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 4.46",,[SELECT PERCENT_RANK() OVER (ORDER BY red_blood_cells ASC) AS percentile_rank FROM laboratoryevents WHERE (hadm_id IN (SELECT hadm_id FROM labevents WHERE subject_id = (SELECT subject_id FROM labevents WHERE hadm_id = (SELECT hadm_id FROM ADMISSIONS WHERE subject_id = (SELECT subject_id FROM labevents WHERE itemid = (SELECT itemid FROM DATADICT WHERE lower(description) LIKE 'red blood cells%') AND subject_id = (SELECT subject_id FROM labevents WHERE itemid = (SELECT itemid FROM DATADICT WHERE lower(description) LIKE 'red blood cells%') AND hadm_id = (SELECT hadm_id FROM labevents WHERE subject_id = 10026406)) AND hadm_id = (SELECT hadm_id FROM ADMISSIONS WHERE subject_id = (SELECT subject_id FROM labevents WHERE itemid = (SELECT itemid FROM DATADICT WHERE lower(description) LIKE 'red blood cells%') AND subject_id = (SELECT subject_id FROM labevents WHERE itemid = (SELECT itemid FROM DATADICT WHERE lower(description) LIKE 'red blood cells%') AND hadm_id = (SELECT hadm_id FROM labevents WHERE subject_id = 10026406
b6e5095ddd979d4bfc1eecfb,Could you retrieve the top four most conducted lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT `name` FROM `lab_tests` WHERE `test_date` >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) GROUP BY `name` ORDER BY COUNT(*) DESC LIMIT 4"
51e8f8f67f2e66a1e780c1a3,What are the five most common prescriptions since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]","SELECT TOP 5 PrescriptionName, COUNT(*) as PrescriptionCount FROM Prescriptions WHERE Year >= 2100 GROUP BY PrescriptionName ORDER BY PrescriptionCount DESC"
9c16ed565a5fe37955e8407d,Was a procedure performed on patient 10015860 during the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,select count(*) from procedureevents_mv where patientid = 10015860 and yearofservice < extract(year from current_date) and yearofservice >= extract(year from current_date) -1
e72c9c21aabd74b3648906ef,"When was the first time that in 04/2100 patient 10024043 had the maximum of total protein, urine?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, urine' ) AND strftime('%Y-%m',labevents.charttime) = '2100-04' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],select max(total_protein) from lab_results where patient_id='10024043' and test_name='urine' and date='04/2100'
49d1bd3a4560ab072f7825a7,What was the last heart rate value patient 10004720 had?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT hr FROM heart_rate WHERE patient_id = 10004720 ORDER BY date DESC LIMIT 1
bfd437d57f4e32153e438f0c,What was the organism found in patient 10037975's first sputum test since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT organism FROM sputum_tests WHERE patient_id = 10037975 ORDER BY test_date ASC LIMIT 1
30604ac94506d0892a2fd65e,"How many instances of the dilation of left common iliac vein with intraluminal device, percutaneous approach procedure were there during the last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"SELECT COUNT(*) FROM procedure WHERE procedure_name='dilation of left common iliac vein with intraluminal device, percutaneous approach' AND procedure_date >= DATEADD(year, -1, GETDATE())"
d7f6b7afdf1779d271fed4bc,What is the total count of patients who stayed in careunit med/surg/gyn during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"select count(distinct patientid) as count from admission where careunit in ('MED/SURG','GYN') and year(admitdate) = YEAR(CURDATE());"
59ecedfe8f2703a51503c566,Tell me the name of the specimen test that patient 10009049 first received since 02/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'MRSA SCREEN'}],SELECT TOP 1 test_name FROM specimen_tests WHERE patient_id = '10009049' AND test_date >= '02/2100' ORDER BY test_date ASC
6cd63183970459480e3afa9b,"After receiving simple excision of other lymphatic structure in this year, what are the four most common diagnoses that patients received in the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) as diagnosis_count FROM patient_records WHERE procedure_code = 'excision_lymphatic_structure' AND YEAR(procedure_date) = YEAR(CURDATE()) GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 4;"
d5e1e8e66d78933ac955b076,When did patient 10021487 have the last respiratory rate observed to be less than 14.0 since 09/07/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 14.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-07' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT MAX(observation_date) AS last_low_respiratory_rate_date FROM patient_observations WHERE patient_id = 10021487 AND observation_date >= '2100-09-07' AND respiratory_rate < 14.0
46ff832eeb6e9d538497577e,What's the count of patients who left the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) FROM patient_discharge WHERE discharged = 1
7f130db92be0aad49a7104a6,What new drugs are prescribed for patient 10004733 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT drug_name FROM prescriptions WHERE patient_id = 10004733 AND prescription_date = CURRENT_DATE AND drug_name NOT IN (SELECT drug_name FROM prescriptions WHERE patient_id = 10004733 AND prescription_date = CURRENT_DATE - INTERVAL '1 day')
40adf249c767a37afb9398c6,What do you do to disinfect the quarantine room?,,,SELECT procedures.procedure_name FROM procedures INNER JOIN rooms ON procedures.room_id = rooms.id WHERE rooms.name = 'quarantine'
c327e43875d95df50f74425e,"When was the first time that patient 10005817 had the hematocrit, calculated maximum value?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],[SELECT MIN(visit_occurrence.visit_start_date) AS FirstHematocritDate
897c83c8728e2e3ada59235e,List the top four most frequent microbiology tests given to patients after being diagnosed with physical restraints status within 2 months.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'physical restraints status' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"SELECT `lab_test_name`, COUNT(`lab_test_name`) AS test_count FROM `lab_tests` JOIN `patient_status` ON `lab_tests`.`patient_id` = `patient_status`.`patient_id` WHERE `patient_status`.`diagnosis` = 'Physical Restraints Status' AND `lab_tests`.`test_date` BETWEEN DATE_SUB(`patient_status`.`diagnosis_date`, INTERVAL 2 MONTH) AND `patient_status`.`diagnosis_date` GROUP BY `lab_test_name` ORDER BY test_count DESC LIMIT 4"
1d22e6440ebc8254221ff9ab,What is the type of blood that patient 18457 has?,,,select blood_type from patients where patient_id = 18457;
a789bf245942cca833ba3d9e,How much does a hospital typically spend maximum on a drug named guaifenesin since 1 year ago?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,select max(amount) from purchase where drug_name='guaifenesin' and purchase_date>current_date-1*365
fc0310f4a0e6c3791fc800f8,"What is the average expense for assistance with cardiac output using balloon pump, continuous?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) )",,"SELECT AVG(expense) AS AverageExpense FROM patient_procedures WHERE procedure_description='Assistance with Cardiac Output using Balloon Pump, Continuous'"
c921232bb890d4227c27bc79,Get the count of the number of hospital visits of patient 10023117 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023117 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 7}],SELECT COUNT(*) AS total_visits FROM hospital_visits WHERE patient_id = 10023117 AND visit_date >= '2100-01-01';
878e753f48874ad8f8ceab3c,Tell me the minimum total hospital cost that involves closed [endoscopic] biopsy of bronchus?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) ) GROUP BY cost.hadm_id ) AS T1,,"SELECT MIN(total_hospital_costs) FROM inpatient_cost_detail JOIN diagnosis ON inpatient_cost_detail.hospital_admission_id=diagnosis.hospital_admission_id WHERE diagnosis.primary_diagnosis_code IN ('34.7','34.7A')"
a5661f4d9bc983fe089c2f6d,Was patient 10010471 given any drugs in the previous year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],"SELECT DISTINCT drug FROM prescriptions WHERE patient_id = 10010471 AND prescription_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) AND CURRENT_DATE"
e76aa0d663560abbc03fe1a7,What was a drug that patient 10004733 was prescribed for within 2 days after receiving enteral infusion of concentrated nutritional substances on the current hospital encounter?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,SELECT DISTINCT drug_name FROM prescriptions JOIN patients ON prescriptions.patient_id = patients.patient_id WHERE patients.patient_id = 10004733 AND prescriptions.prescription_date BETWEEN (SELECT enteral_infusion_date FROM procedures JOIN patients ON procedures.patient_id = patients.patient_id WHERE patients.patient_id = 10004733 AND procedures.procedure_type = 'enteral_infusion') AND (SELECT enteral_infusion_date + INTERVAL '2 days' FROM procedures JOIN patients ON procedures.patient_id = patients.patient_id WHERE patients.patient_id = 10004733 AND procedures.procedure_type = 'enteral_infusion')
d8f75bffa5cc49d6e7389a89,I need the total volume of input for patient 10005909 since 07/05/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-05'",[{'SUM(inputevents.totalamount)': 16695.0}],SELECT SUM(inputVolume) FROM input_records WHERE patient_id = 10005909 AND input_date >= '2100-07-05'
10379bc71183afe73e396f57,What percentile is 0.9 creatinine in a patient of the same age as patient 10020740 during the first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 0.9",,[SELECT PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY creatinine)
e44f5a7695147c0b38ec316e,What was the last hospital admission type for patient 10018845?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018845 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1",[{'admission_type': 'EW EMER.'}],select top 1 admission_type_desc from T1 order by admission_date desc where patient_nbr=10018845
e54a1e3c51bc1b0c7bca37f7,"Since 2100, what are the top five most frequently ordered lab tests for patients in the same hospital visit after being diagnosed with flatulence, eructation, and gas pain?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'flatulence, eructation, and gas pain' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,
86e644ff0d66b3aee390fc72,What was the total dosage of polyethylene glycol prescribed to patient 10021312 since 05/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'polyethylene glycol' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'",[{'SUM(prescriptions.dose_val_rx)': None}],select sum(dosage) as total_dosage from prescriptions where patient_id = 10021312 and medication = 'polyethylene glycol' and date_prescribed >= '05/2100'
75054e4a84c29aca4b3607df,What was the total number of input patient 10021487 has received since 09/07/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-07'",[{'SUM(inputevents.totalamount)': 169730.0}],SELECT SUM(input_count) AS TotalInputs FROM patient_records WHERE patient_id = '10021487' AND input_date >= '09/07/2100'
9e442d16828a578f4b27bb6f,What is the difference in patient 10019777's weights last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT `weight` FROM `weight_measurements` WHERE `patient_id` = 10019777 AND (`date` = (SELECT MAX(`date`) FROM `weight_measurements` WHERE `patient_id` = 10019777 AND `visit_order` = 1) OR `date` = (SELECT DATE_SUB((SELECT MAX(`date`) FROM `weight_measurements` WHERE `patient_id` = 10019777 AND `visit_order` = 1), INTERVAL 1 DAY))) ORDER BY `date` DESC LIMIT 2"
7fafde7941ee8321b6875326,"Tell me the number of cases of dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic that occurred in 2100.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,SELECT COUNT(*) FROM medical_procedures WHERE procedure = 'dilation of lower esophagus with intraluminal device' AND method = 'endoscopic' AND (entry_route = 'natural' OR entry_route = 'artificial') AND year = 2100
736dfe17a5c5844830732c5c,What was the name of the drug that patient 10001217 was prescribed with during the same hospital visit after undergoing spinal tap since 30 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-30 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT prescribed.drug_name FROM prescribed JOIN patient ON prescribed.patient_id = patient.id WHERE patient.id = '10001217' AND patient.visit_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 30 MONTH) AND CURRENT_DATE AND prescribed.visit_date = patient.visit_date AND EXISTS (SELECT * FROM procedures WHERE procedures.patient_id = patient.id AND procedures.procedure_name = 'spinal tap' AND procedures.visit_date = patient.visit_date)"
ef9e46557f7fe863d42a695e,Provide the total input volume for patient 10020786 on 07/01/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-01'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input_volume) FROM patient_data WHERE patient_id = '10020786' AND date = '2023-07-01';
cae94b9b74b0ff5b8f016878,"For patients who undertook dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic within the same hospital visit, what are the top three most frequent specimens tested afterward this year?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"SELECT specimen, COUNT(specimen) AS frequency FROM medical_procedures JOIN specimens_on_file USING(procedure_id) WHERE procedure_description LIKE '%dilation of lower esophagus with intraluminal device%' AND procedure_type = 'via natural or artificial opening endoscopic' AND visit_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY specimen ORDER BY frequency DESC LIMIT 3"
962f54bae45dac154aceeff8,Can you tell me how many days patient 10005909 stayed in the ICU during their last stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.677384258713573}]",SELECT COUNT(*) FROM icustays WHERE patientunitstayid = 10005909;
12fb8402b00499381bd3ff8c,What was the drug patient 10008287 was prescribed for the first time using the po/ng route since 06/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT DISTINCT drug_name FROM prescriptions WHERE patient_id = 10008287 AND route = 'po/ng' AND start_date >= '2100-06-01' ORDER BY start_date ASC LIMIT 1
e60e3b0dd9bb998ce08e850c,"Since 30 months ago, what was patient 10004720's first weight measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-30 month') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT TOP 1 measurement_date, weight FROM health_records WHERE patient_id = 10004720 AND measurement_type = 'weight' AND measurement_date >= DATEADD(MONTH, -30, GETDATE()) ORDER BY measurement_date ASC"
02885cc1fb11efec74cb16fd,When did first patient 10021487 have the maximum value of amylase during this hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],SELECT MAX(date) FROM lab_tests WHERE patient_id = 10021487 AND test_name = 'amylase' AND result IS NOT NULL
5bfa8dfb474aab488d477069,"Did patient 10021118 undergo the excision of right saphenous vein, percutaneous endoscopic approach procedure in the last year?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right saphenous vein, percutaneous endoscopic approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"SELECT COUNT(*) FROM procedure_logs WHERE patient_id = '10021118' AND procedure_name = 'Excision of Right Saphenous Vein, Percutaneous Endoscopic Approach' AND procedure_date > CURRENT_DATE - INTERVAL '1 year'"
ac29c708a74c9c79fcbab164,Count the number of current patients who are in their 30s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,,SELECT COUNT(*) AS NumberOfPatients FROM patients WHERE age BETWEEN 30 AND 39 AND current_status = 'current'
e9a36293a5d2d223562338c9,What was the name of the organism that was found during the last mini-bal test of patient 10021487 since 11/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT organism_name FROM test_results WHERE patient_id = 10021487 AND test_type = 'mini-bal' AND timestamp >= '11/2100' ORDER BY timestamp DESC LIMIT 1
3e6c40802e7951b28402583b,When was the last input time of patient 10027602 since 11/26/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2201-12-13 16:51:00'}],SELECT MAX(input_time) AS last_input_time FROM patient_records WHERE patient_id = '10027602' AND input_time > '2021-11-26'
1f89610cbce4f404c0d528e6,When did patient 10002428's last microbiological test occur since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2156-05-17 19:58:00'}],SELECT MAX(TestDate) AS LastMicrobiologicalTestDate FROM PatientTests WHERE PatientID = 10002428 AND TestDate >= '2100-03-01' AND TestType = 'Microbiological'
fb44777e76712299533eaf79,What is the cost for the procedure right heart cardiac catheterization?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) ),,SELECT Cost FROM Procedures WHERE ProcedureName = 'Right Heart Cardiac Catheterization'
e1b0ecc193437991940016e6,"Has patient 10029484 been on glipizide xl, 0.9% sodium chloride, or insulin human regular as prescribed?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.drug IN ( 'glipizide xl', '0.9% sodium chloride', 'insulin human regular' )",[{'COUNT(*)>0': 0}],"select * from prescription where patient_id='10029484' and (drug_name in ('glipizide xl', '0.9% sodium chloride', 'insulin human regular'))"
b51cf6ccd388a090596b77a3,When was patient 10004720's first hospital discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2186-11-17 18:30:00'}],SELECT MIN(discharge_date) FROM hospital_records WHERE patient_id = '10004720';
a6dfce8ef3e5a14b57bd2d11,What is the correct dosage of the prescribed opioid to patient 19428?,,,SELECT opioid_dosage FROM opioid_prescriptions WHERE patient_id = 19428
26e67a0d26da3791abc625a2,How many times was olanzapine prescribed during this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'olanzapine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescriptions WHERE medication = 'olanzapine' AND EXTRACT(YEAR FROM prescription_date) = EXTRACT(YEAR FROM CURRENT_DATE);
5941ed9f1a4d31ed438338d9,"Throughout this year, what are the top four most frequently ordered lab tests for patients in the same month after being diagnosed with unspecified essential hypertension?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,
9ecd148b83207e3fbed2a937,What was the condition patient 10020740 was diagnosed with first time since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",,"select distinct dsn.condition_concept_id, c.concept_name, dsn.condition_start_date from ds_new_diagnoses dsn inner join concept c on dsn.condition_concept_id=c.concept_id where dsn.person_id=10020740 and dsn.condition_start_date>date('now','-365 day') order by dsn.condition_start_date limit 1"
778dec17c4569dd7f4da476a,What kind of medicine does patient 17638 take after they got the instruction of another department at our hospital,,,SELECT medication_type FROM patient_medications WHERE patient_id = 17638 AND department = 'another department'
a5e6297c3b4d206acb9998da,When was the first microbiology test that was given to patient 10014354 since 4 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-4 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2146-10-09 03:13:00'}],SQL Query
32bd2842efa8e518c4f30155,"How many times was a drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedure done?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' )",[{'COUNT(*)': 0}],[SELECT count(DISTINCT encounter_id) FROM procedure_procedure_occurrence WHERE ( ( ( ( value_as_concept_id = '267517008' ) AND ( ( modifier_concept_id = '116454008' ) AND ( qualifier_concept_id = '91613000' ) ) ) AND ( ( value_source_value LIKE 'drainage%' ) AND ( qualifier_source_value LIKE '%bronchus%' ) ) AND ( ( value_source_concept_id = '267517008' ) AND ( modifier_source_concept_id = '116454008' ) AND ( qualifier_source_concept_id = '91613000' ) ) ) ) AND ( ( procedure_concept_id = '380003' ) OR ( procedure_source_value = 'Drainage of right lower lobe bronchus' ) ) AND ( ( procedure_concept_id IN ( SELECT distinct concept_id FROM concept WHERE ( ( ( domain_id = 'Procedure' ) OR ( domain_id = 'Measurement' ) ) OR ( domain_id = 'Observation' ) ) AND ( ( standard_concept = 'S' ) OR ( standard_concept = 'C' ) ) ) ) OR ( procedure_source_concept_id IN ( SELECT distinct concept_id FROM concept WHERE ( (
024e5c4760ca03ad0215c516,When was patient 10001725 first prescribed the medication via the im route during their last hospital encounter?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1,[],select min(start_date) as first_prescribed_date from (select * from ehr_drug_exposure where person_id = 10001725 and route_concept_id = 38000280 and end_date = (select max(end_date) from ehr_encounter where person_id = 10001725))
b280ebdb1c738becbca7cc1d,When was the last time that patient 32755 had a medication that was regularly taken?,,,select max(visit_date) from visit_occurrence where visit_occurrence.person_id = 32755 and visit_occurrence.visit_concept_id = 9203
2ca4465dba3c16260aab1d62,Calculate the number of loratadine prescriptions in 2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'loratadine' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) AS loratadine_prescriptions_in_2100 FROM prescriptions WHERE drug_name = 'Loratadine' AND YEAR(prescription_date) = 2100;
a8f04b428e4feaac42d610de,Has patient 10015860 come to the ER during this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],"SELECT patient_id, visit_date FROM er_visits WHERE patient_id = 10015860 AND YEAR(visit_date) = YEAR(CURDATE())"
b6cd8d8d63a88cfb0db6d978,What are the four commonly taken specimens for patients that were diagnosed with other late effects of cerebrovascular disease previously during the same month?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other late effects of cerebrovascular disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"SELECT DISTINCT specimen_type FROM claims WHERE diag_type = 'other late effects of cerebrovascular disease' AND service_date BETWEEN DATE_FORMAT(NOW(), '%Y-%m-01') AND LAST_DAY(NOW())"
3c7c50f6746a47772cb02cbf,Did patient 10007928 take a nacl 0.9% medication in their first hospital visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM medevents WHERE person_id = '10007928' AND visit_id IN (SELECT visit_id FROM visits WHERE person_id = '10007928' ORDER BY admission_date ASC LIMIT 1) AND (drug_name = 'nacl 0.9%' OR drug_name LIKE '%nacl 0.9%')
902c95e30f8c9752224d22f9,Are there any changes in the prescribed drugs of patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"select * from prescriptions where patient_id = 10039831 and prescription_date in (current_date, current_date - interval '1 day')"
b64781d0b4bde8ed18b8cb5d,Show me the monthly maximum weight of patient 10018081 since 2100.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) >= '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT visit_month, MAX(weight) FROM patient WHERE patientid = 10018081 AND visit_month >= 2100 GROUP BY visit_month"
d701f4d1d856c591e1e4c95d,What is the number of patients who had a globulin test in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'globulin' ) AND strftime('%Y',labevents.charttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],[SELECT COUNT(DISTINCT Patient_ID) AS NumberOfPatients
40e8dd3b84d22a385983c8f7,Can you tell me the maximum SaO2 for patient 10016742's body on 08/03/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-08-03'",[{'MAX(chartevents.valuenum)': None}],SELECT MAX(SaO2) FROM patient_records WHERE patient_id = 10016742 AND body_location = 'body' AND record_date = '2100-08-03'
2207f2b9a9690a68915d6ab4,What are the four most common treatments for patients who are 50s this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT TOP 4 Treatment, COUNT(*) AS Frequency FROM Patients WHERE YEAR(CURRENT_TIMESTAMP) - YEAR(BirthDate) BETWEEN 50 AND 59 GROUP BY Treatment ORDER BY Frequency DESC"
4202b117d324f6285ecaf255,How many hours have elapsed since patient 10004733's first stay in the careunit medical/surgical intensive care unit (micu/sicu) during their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT SUM(TIMESTAMPDIFF(HOUR, admission_time, discharge_time)) AS total_hours_elapsed FROM patient_stays WHERE patient_id = 10004733 AND careunit IN ('MICU', 'SICU') AND admission_time >= (SELECT MIN(admission_time) FROM patient_stays WHERE patient_id = 10004733 AND visit_id = (SELECT MAX(visit_id) FROM patient_stays WHERE patient_id = 10004733))"
bd799ac5e9eb3fc8ae226402,What was the organism's name of the last foreign body microbiology test done on patient 10007795?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'foreign body' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT organism_name FROM foreign_body_microbiology WHERE patient_id = '10007795' ORDER BY test_date DESC LIMIT 1
6a6845f8f10630a1084755dd,What is the cost of the drug named nicardipine iv?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nicardipine iv' ),,select cost from drug where name = 'nicardipine iv'
94c416e60fecdda4973a6173,Has there been any organism detected during the last mrsa screen microbiology test of patient 10015860 since 05/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],SELECT DISTINCT `organism` FROM `test_results` WHERE `patient_id` = '10015860' AND `test_type` = 'mrsa screen microbiology' AND `date` >= '2100-05-01' AND `result` = 'detected';
e219db6bec1a6b0c74699c00,"When did patient 10039831 last have the minimum amount of sodium, whole blood in 12/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],"select date from lab_tests where patient_id = '10039831' and test_name = 'sodium, whole blood' and date = (select min(date) from lab_tests where patient_id = '10039831' and test_name = 'sodium, whole blood' and date >= '12/21/2000')"
9eaee8b12a9d726c44201f25,Do you remember which immuno-cancer drugs have been used over the past five years?,,,select name from drugs where drug_type='immuno-cancer' and year>2016
27b1b0cb6cac06060411bcfb,How many patients were in neurology?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(patient_id) AS patient_count FROM patient_records WHERE department = 'neurology';
f1501b008c57806e4fdc437f,Can you tell me the name of the diagnosis patient 10020740 received first in their last hospital encounter?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,SQL Query
4c0c525de0bed58277a23a11,What was the aggregate input volume for patient 10021312 since 07/16/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-16'",[{'SUM(inputevents.totalamount)': 3300.0}],select sum(input_volume) from inputevents_mv where subject_id=10021312 and inputdate>='07/16/2100'
341a4ea74a6802ad1a55e2ff,When was the first microbiology test that was given to patient 10015931 since 05/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2176-11-15 22:07:00'}],SELECT MIN(DATE) FROM microbiology WHERE patient_id = '10015931' AND DATE >= '2100-05-01'
44091b4ad36dad1ed6a3d8b1,What changes were made in the prescription of patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],select ... from ... where ...
d1c26e1486ac8b878082f4ea,Retrieval of the top three most frequent outputs in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],"SELECT output, COUNT(*) as frequency FROM space_mission_output WHERE year = 2100 GROUP BY output ORDER BY frequency DESC LIMIT 3"
c1b3f37142e9c9cf9ba75b12,What was the condition patient 10014729 was diagnosed with last time during the first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,SELECT diagnosis FROM patient_records WHERE patient_id = 10014729 ORDER BY visit_date ASC LIMIT 1
3de9617a7e8dcc80de879fc5,What was the name of the output that patient 10039831 got first since 12/23/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-23' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'OR EBL'}],SELECT output_name FROM medical_records WHERE patient_id = '10039831' AND date >= '2100-12-23' ORDER BY date ASC LIMIT 1
ae6519f14e5f7700af940f59,Has patient 10004235 received any treatment of laparoscopic cholecystectomy since 1 year ago?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,SELECT ... FROM ... WHERE ...
2ff2e805ec42ef3feedcd1aa,What was the number of patients receiving thoracoscopic decortication of lung during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracoscopic decortication of lung' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,SELECT count(*) FROM patient_records WHERE procedure = 'thoracoscopic decortication of lung' AND YEAR(procedure_date) = YEAR(CURDATE());
a00afef4fe749df9db791752,What is the maximum cost to the hospital that involves other fluid overload?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other fluid overload' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT MAX(Cost_to_Hospital) FROM `cost_of_care` WHERE `Diagnosis` = 'Other fluid overload';
5e93d590379eb00b3a76b6aa,When has patient 10020740 been prescribed medication for the last time in 04/2100 via the po route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(date) FROM prescriptions WHERE patient_id = 10020740 AND date BETWEEN '01-APR-2100' AND '30-APR-2100' AND route = 'po' AND status = 'active'
455145565c06c0334318ab67,"On this month/18, when was the last input time of patient 10010471?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '18' ORDER BY inputevents.starttime DESC LIMIT 1",[],SELECT max(InputTime) FROM Patient WHERE PatientID = '10010471' AND MONTH(InputTime) = MONTH(CURRENT_DATE) AND YEAR(InputTime) = YEAR(CURRENT_DATE)
9ae1e99a336fdea068c22d52,What was the first drug that was prescribed to patient 10021312 via the po/ng route in 09/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ORDER BY prescriptions.starttime ASC LIMIT 1",[],select top 1 drug_name from prescriptions where patient_id = 10021312 and route = 'po/ng' and prescription_date >= 'YYYY-09-01' and prescription_date < 'YYYY-10-01' order by prescription_date asc
ac99a2f4b7ce6677c8f21cf0,What are the five most frequently ordered medications that patients in their 40s were prescribed within 2 months after being diagnosed with esophageal reflux in this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"select top 5 t3.medicine_name, count(*) as cnt from (select distinct t1.medicine_id, t1.patient_id from orders t1,diagnoses t2 where t1.patient_id = t2.patient_id and t1.order_date between dateadd(month,-2,t2.diagnosis_date) and t2.diagnosis_date and t2.diagnosis = 'esophageal reflux' and datepart(year,t2.diagnosis_date) = datepart(year, getdate()) and datepart(year, t1.order_date) = datepart(year, getdate()) and datepart(month, t1.order_date) = datepart(month, getdate())) t4, medicine t3 where t4.medicine_id = t3.medicine_id group by t3.medicine_name order by cnt desc"
06b1eef22357320dc0f8a64a,"For the first time, what was the medication that patient 10026255 was prescribed during the first hospital encounter via the ih route?",SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'ih' ORDER BY prescriptions.starttime ASC LIMIT 1,[],select top 1 drug_name from drug_exposure de where de.person_id = 10026255 and de.drug_type_concept_id = 38000280 and de.route_concept_id = 38000280 and de.visit_occurrence_id in (select top 1 visit_occurrence_id from visit_occurrence where person_id = 10026255 order by visit_start_date) order by drug_exposure_start_date
69d6df3a555ac16f922234f9,What was the first specimen test that was given to patient 10023239 since 04/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'MRSA SCREEN'}],select * from specimen_test st left join specimen s on st.specimen_id = s.specimen_id where s.patient_id = 10023239 and st.test_date > '04/2100' order by st.test_date limit 1
1e3b44203311b415f4712cc6,"During their last hospital encounter, was patient 10031404 given any diagnosis?",SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT * FROM diagnosis WHERE patient_id = '10031404' AND encounter_id = (SELECT MAX(encounter_id) FROM encounters WHERE patient_id = '10031404')
91405986ac7029c89c4e111c,Tell me the name of an output that patient 10013049 has first had since 03/07/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'OR Urine'}],SELECT o.output_name FROM Output o INNER JOIN Patient p ON o.patient_id = p.id WHERE p.id = '10013049' AND o.output_date = (SELECT MIN(output_date) FROM Output WHERE patient_id = '10013049' AND output_date >= '03/07/2100')
3ce0aee35413ee29a66136d0,What was the last drug prescribed to patient 10007058 during the last month via the iv route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime DESC LIMIT 1",[],Your SQL query here
26aa4388a8897474b77aa481,What was the total number of drugs patient 10005817 was prescribed since 08/2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'",[{'COUNT(*)': 435}],select count(*) from prescriptions where patient_id = 10005817 and presc_date >= '08/2100'
a07f951288594d0721e53be7,Has patient 10021938 come into the ER in this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT * FROM EmergencyRoomVisits WHERE patientID = '10021938' AND year(visitDate) = year(CURRENT_DATE)
cb26c31984006b29f2c93878,Does patient 83038 have a family history of any disease?,,,select Family_History from Patient_Medical_Record where Patient_ID = '83038' and Family_History is not null
8b4571147c610648de61a6ab,"On 05/08/this year, what was the first o2 saturation pulseoxymetry reading for patient 10018328?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '05-08' ORDER BY chartevents.charttime ASC LIMIT 1",[],select top 1 o2_saturation from pulseoxymetry_readings where patient_id = 10018328 and reading_date = '2023-05-08' order by reading_time asc
56eab13d0583a58c43247431,How many drugs have been prescribed to patient 10008454 since 2 months ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month')",[{'COUNT(*)': 139}],select count(DISTINCT drug_name) from prescriptions where patient_id='10008454' and prescription_date >= NOW() - interval '2 months';
ac7bf3a501336d2c4fb93d27,"What were the three most commonly ordered lab tests for patients who were previously diagnosed with edema of male genital organs in the same month, this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'edema of male genital organs' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,
b3a9bd9b492cf5ebf684f04b,What were the four most common lab tests given since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",SQL Query
ae10b786bdd68be86808411b,"What is the total count of performance of cardiac output, continuous procedures that were done since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT COUNT(*) FROM performance WHERE procedure_name = 'cardiac output continuous' AND procedure_time >= '2100:00:00'
67ea2ec7c02ee83ea4a04d59,Tell me the total input for patient 10016742 since 07/23/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-23'",[{'SUM(inputevents.totalamount)': 36640.0}],SELECT SUM(input) FROM patient_records WHERE patient_id = 10016742 AND date >= '07/23/2100'
95b288888e266b0b15c485fd,Retrieve the top three most common diagnoses for patients with age 50s during this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patients WHERE EXTRACT(YEAR FROM age) = EXTRACT(YEAR FROM CURRENT_DATE) AND age BETWEEN 50 AND 59 GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3"
4f42b7f15b57fa921a5c03ea,How many hours has it been since the first other chronic nonalcoholic liver disease diagnosis of patient 10021487 on the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other chronic nonalcoholic liver disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT TIMEDIFF(MAX(diagnosis_date), MIN(diagnosis_date)) FROM patient_diagnoses WHERE patient_id = 10021487 AND diagnosis_type = 'other chronic nonalcoholic liver disease' AND visit_id = (SELECT visit_id FROM patient_visits WHERE patient_id = 10021487 ORDER BY visit_date DESC LIMIT 1)"
e1dd13daac1ecaf666f55bc2,"Hey, what was patient 10029291's maximum ptt value in 03/2100?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",[{'MAX(labevents.valuenum)': None}],SELECT MAX(ptt) FROM lab_results WHERE patient_id = 10029291 AND test_date BETWEEN '03/01/2100' AND '03/31/2100'
54ecb54032c2c4402da787c8,"Of the patients aged 30s since 1 year ago, what are the top three most common procedures?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,SQL Query Here
8a3f528d01b5216685826b2a,What number of patients stayed in medicine/cardiology during the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine/cardiology' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) FROM inpatient_stays WHERE specialty_code IN ('M', 'C') AND admission_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
d3c7771380374c5d73ffd28f,Tell me the amount of foley patient 10021487 had on 12/21/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-21'",[{'SUM(outputevents.value)': None}],
921bedddb3b4dad89ed751aa,"What were the five most frequently ordered procedures for patients who had also received drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"[SELECT TOP 5 procedure_name, COUNT(*) AS procedure_count"
fc990cb9419776227c9994e7,Show me patient 10014078's total amount of magnesium sulfate (bolus) input on 09/07/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-09-07'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input_amount) FROM patient_medication_administration WHERE patient_id = 10014078 AND medication_name = 'magnesium sulfate' AND administration_route = 'bolus' AND CAST(administration_date AS DATE) = '2100-09-07';
73a58a83894d2589594daf4a,What were the five most frequent output events in this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],SELECT TOP 5 * FROM events WHERE event_year = YEAR(GETDATE()) ORDER BY occurrence_count DESC
163d3f81e0ca38daf1f919a2,"When was the last time the mean blood pressure of patient 10021118 was greater than 74.0, on this month/05?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 74.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '05' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT MAX(MeasurementDate) FROM BloodPressureReadings WHERE PatientID = '10021118' AND MeanValue > 74.0 AND MeasurementDate >= '05-01' AND MeasurementDate < '06-01'
47ca8eab856cae1f24914f04,What were the last pt lab test results for patient 10022880 in 03/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1",[],
ce36c547c1a37852e65fc5c3,Can you get me the top four diagnoses that have the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT Diagnosis, COUNT(*) AS NumberOfPatients, SUM(CASE WHEN Status = 'Deceased' THEN 1 ELSE 0 END) AS Deaths, (SUM(CASE WHEN Status = 'Deceased' THEN 1 ELSE 0 END) / COUNT(*)) * 100 AS MortalityRate FROM PatientRecords WHERE DiagnosisDate > DATE_SUB(CURDATE(), INTERVAL 6 MONTH) GROUP BY Diagnosis ORDER BY MortalityRate DESC LIMIT 4"
e86ed01755d7638dbad6517f,"Has patient 10016742 received any treatment of respiratory ventilation, greater than 96 consecutive hours?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 )",[{'COUNT(*)>0': 0}],SELECT COUNT(*) AS TreatmentCount FROM PatientTreatments WHERE PatientID = 10016742 AND TreatmentType = 'Respiratory Ventilation' AND Duration > 96
3d81d416bd9cb490c9afa856,How often was morphine sulfate (oral solution) 2 mg/ml prescribed since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate (oral solution) 2 mg/ml' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 0}],select count(distinct rxnum) from rxnorm.dbo.rxnorm_rx where nppes_provider_type = 'R' and nppes_provider specialty_description = 'Pain Management' and nppes_entity_code = '1' and nppes_provider_state = 'FL' and (ingredient = 'Morphine sulfate (oral solution) 2 mg/ml' or (rxcui=2089010 and rxcui=2089010)) and  start_date >= '2100-01-01' and  start_date <= '2100-12-31'  and ingredient_rank = '1' and rxnorm_rank = '1'
2ca8e56caf706c6147547a1a,During what first time did patient 10020944 have the minimum basophils level?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],select min(date) from lab_results where patient_id=10020944 and test_name='basophils'
72f7cf565eac6853d4a5f4bc,Can you show me the drug that patient 10007058 was first prescribed since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': '5% Dextrose'}],SELECT drug_name FROM prescriptions WHERE patient_id = '10007058' AND start_date >= '07/2100' ORDER BY start_date ASC LIMIT 1
fd430b3bc6f281ccc988453c,How many days have passed since the last time patient 10021487 has received a glucose-lab test on their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(DAY, MAX(GlucoseLabTestDate), GETDATE()) FROM PatientRecords WHERE PatientID = 10021487 AND HospitalVisitID = (SELECT MAX(HospitalVisitID) FROM PatientRecords WHERE PatientID = 10021487) AND GlucoseLabTestDate IS NOT NULL AND GlucoseLabTestDate <= CURRENT_DATE GROUP BY PatientID, HospitalVisitID;"
239fb5f5541fdf88fed6bf3c,What was patient 10004733's respiratory rate for the last time on 12/23/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-23' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT respiratory_rate FROM patient_vitals WHERE patient_id = '10004733' AND date = '12/23/2100' ORDER BY time DESC LIMIT 1
e66bc926c13901e2b96e1418,What were the four most common drugs prescribed this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4",[],"SELECT drug_name, COUNT(*) AS prescription_count FROM prescriptions WHERE year = YEAR(CURDATE()) GROUP BY drug_name ORDER BY prescription_count DESC LIMIT 4"
d86c1530c01a8065fe956df5,What was the drug patient 10010471 was prescribed for the last time using the po route since 03/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",[],"SELECT DISTINCT ON (patient_id) drug_name, date, route FROM patient_records WHERE patient_id = 10010471 AND route = 'po' AND date >= '03/21/2000' ORDER BY patient_id, date DESC"
01f974128b8f1c4383263191,What was the aggregate input volume for patient 10027602 since 09/26/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-26'",[{'SUM(inputevents.totalamount)': 81320.0}],SQL Query Here
34b93ea1246f25eeebd0e8c9,Provide me with the name of the diagnosis patient 3277 received in the other department.,,,SELECT `Diagnosis`.`Name` FROM `Diagnosis` INNER JOIN `Patients` ON `Diagnosis`.`PatientID` = `Patients`.`ID` WHERE `Patients`.`ID` = 3277 AND `Diagnosis`.`DepartmentID` != `Patients`.`DepartmentID` LIMIT 1;
d83c8510ff1184c1d92ff459,What was patient 10014354's first measurement for respiratory rate on 10/20/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '10-20' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT min(measurement_date) FROM covid_biospec_vital WHERE patient_id = 10014354 AND measurement_type = 'Respiratory Rate' AND measurement_date >= '2023-10-20' AND measurement_date < '2023-10-21' ORDER BY measurement_date ASC LIMIT 1
ea46c6446f611ab80789ec15,Give me patient 10007058's total lr input on last month/23.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '23'",[{'SUM(inputevents.totalamount)': None}],"SELECT SUM(lr_input) FROM patient_records WHERE patient_id = 10007058 AND DATE_FORMAT(record_date, '%Y-%m') = DATE_FORMAT(DATE_SUB(LAST_DAY(CURRENT_DATE()), INTERVAL 1 MONTH), '%Y-%m')"
96c87d6620403ab5197e010c,"For the last time in 08/this year, what was the drug that patient 10027445 was prescribed via sc route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'sc' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT DISTINCT DrugName FROM Prescriptions WHERE PatientID = '10027445' AND Route = 'SC' AND PrescriptionDate = (SELECT MAX(PrescriptionDate) FROM Prescriptions WHERE PatientID = '10027445' AND YEAR(PrescriptionDate) = YEAR(CURRENT_DATE) AND MONTH(PrescriptionDate) = 8)
296ec4ec76a62cac4fd007bb,Tally up the number of patients who received a red blood cells lab test in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND strftime('%Y',labevents.charttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM lab_tests WHERE test_name = 'red blood cells' AND test_date BETWEEN '2100-01-01' AND '2100-12-31'
13bbb7977ea8096ece5542dc,Which are the top four most frequent procedures patients had within 2 months after being diagnosed with personal history of other malignant neoplasm of skin since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other malignant neoplasm of skin' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT ProcedureName, COUNT(*) as Frequency FROM Procedures INNER JOIN Diagnoses ON Procedures.PatientID = Diagnoses.PatientID WHERE Diagnoses.DiagnosisDate > '2100-01-01' AND Diagnoses.DiagnosisCode = 'Z85.820' AND DATEDIFF(month, Diagnoses.DiagnosisDate, Procedures.ProcedureDate) <= 2 GROUP BY ProcedureName ORDER BY Frequency DESC LIMIT 4"
c1d67292940ffad4ade361e9,Whats the reimbursement standard for a cerebrovascular mri?,,,select * from reimbursement where procedure = 'cerebrovascular MRI'
b822898d1d41ded52d61fbed,What were the top four most common diagnoses that followed within 2 months for those who received diagnostic ultrasound of digestive system since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"select diagnosis, count(*) as frequency from diagnoses where diagnosis_date between (select min(diagnosis_date) from diagnoses where procedure='Diagnostic ultrasound of digestive system') and (select date_add(min(diagnosis_date), interval 2 month) from diagnoses where procedure='Diagnostic ultrasound of digestive system') and patient_id in (select patient_id from procedures where procedure='Diagnostic ultrasound of digestive system' and procedure_date>=2100) group by diagnosis order by frequency desc limit 4"
89ef9c7f4b5b2407980dfada,Was patient 10019777 on any vital high protein (full) in 03/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-03'",[{'COUNT(*)>0': 0}],SELECT ...
ba4c239a6efd2a45b4fd4c15,What are the four most frequent microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]","SELECT test_name, COUNT(test_id) AS frequency FROM microbiology_tests WHERE test_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY test_name ORDER BY frequency DESC LIMIT 4"
bec56d5d887095fdec4a748d,How many prescriptions were prescribed in 2100 for iso-osmotic sodium chloride?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic sodium chloride' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) AS num_prescriptions FROM prescriptions WHERE year = 2100 AND medication = 'iso-osmotic sodium chloride';
37e1a7e88398803e5188be91,How many patients stayed on cardiac vascular intensive care unit (cvicu) during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac vascular intensive care unit (cvicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patientid) from admission where cvicu = 1 and dchdate >= '2021-01-01' and dchdate < '2022-01-01'
6a0ee1b4229838dcbe29e41a,What was the number of times cepacol (menthol) was prescribed in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cepacol (menthol)' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescription WHERE medication_name = 'cephacol (menthol)' AND year_prescribed = 2100
e1ea16fb2fe09b1b73839ca3,Show me the top four most frequent lab tests in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"select lab_test, count(*) as frequency from lab_tests group by lab_test order by frequency desc limit 4"
e346948b183416231db2bb3c,Count the number of hospital visits that patient 10019917 had in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019917 AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT COUNT(*) FROM hospital_visits WHERE patient_id = '10019917' AND visit_date BETWEEN '2100-01-01' AND '2100-12-31'
a5b1c0e43266c3abbd391cf4,Tell me the number of patients who were prescribed ferric gluconate since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ferric gluconate' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) AS patient_count FROM prescriptions WHERE medication = 'ferric gluconate' AND prescribed_date >= '2100-01-01'
17c8391662dfc6e28aa56464,How many drugs have been prescribed to patient 10023239 in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],select count(distinct drug) from prescriptions where patient_id = 10023239 and year = 2100
561c6a4161ac2feb86d80aed,How many times phosphorus was ordered in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM orders WHERE element = 'phosphorus' AND YEAR(order_date) = 2100
04572e0972a7993db0621881,When was the last microbiological test of patient 10037861 since 01/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2117-03-20 11:30:00'}],SELECT max(test_date) FROM microbiological_tests WHERE patient_id = '10037861' AND test_date > '2021-01-01'
c296b026cf38437fb7dfc933,How many people were given prescriptions for albumin 25% (12.5g / 50ml) since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'albumin 25% (12.5g / 50ml)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE drug_name = 'albumin 25% (12.5g / 50ml)' AND prescription_date >= CURRENT_DATE - INTERVAL '1 year'
bae6bdda5b9a9cb808040a25,How much does patient 10019777 weigh difference last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT ""Patient 10019777"", MAX(""Weight"") - MIN(""Weight"") AS ""Weight Difference"" FROM ""Vital Signs"" WHERE ""Patient ID"" = 10019777 AND ""Visit Date"" = (SELECT MAX(""Visit Date"") FROM ""Vital Signs"" WHERE ""Patient ID"" = 10019777) GROUP BY ""Patient 10019777"""
ca4e42b32f0b7c47922fe65e,Has patient 10003046 experienced any surgeries during this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,select surgery_date from surgery_records where patient_id = '10003046' and surgery_date >= 'YYYY-01-01' and surgery_date <= 'YYYY-12-31'
72aa0a8195cef04d785d835c,When was patient 10029291's last input time since 03/05/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-05' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2123-03-04 21:45:00'}],SELECT MAX(input_time) AS last_input_time FROM patient_data WHERE patient_id = 10029291 AND input_time >= '03/05/2100'
85e40ee7c74d7603718dca90,"Among patients who were administered dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic this year, what were the top three most common treatments that they received in the same hospital encounter?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"select treatment_name, count(*) as treatment_count from patient_treatments pt join patient_encounters pe on pt.encounter_id = pe.id join treatments t on pt.treatment_id = t.id where pe.procedure_type = 'dilation of left main bronchus with intraluminal device' and pe.procedure_method = 'natural or artificial opening endoscopic' and pe.procedure_date >= '2023-01-01' and pe.procedure_date < '2024-01-01' group by treatment_name order by treatment_count desc limit 3"
b6cb5bc47c02678729d05510,Are there new medications in the prescription of patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],select count(*) from prescriptions where patient_id = 10039831 and medication_id not in (select medication_id from prescriptions where patient_id = 10039831 and date = current_date - interval '1 day') and date = current_date;
44f2c9be4fc4e3268e1c8ba0,What was the last time of patient 10019385 staph aureus swab microbiology test since 02/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT TOP 1 test_datetime FROM microbiology_results WHERE patient_id = '10019385' AND test_type = 'staph aureus swab' AND test_datetime >= '02/2100' ORDER BY test_datetime DESC
98f8d45306d4c05c5916a214,What were the most frequent diagnoses among the top five in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT Diagnosis, COUNT(*) AS Frequency FROM PatientRecords WHERE Year = 2100 GROUP BY Diagnosis ORDER BY Frequency DESC LIMIT 5;"
5182aaa70c734958ef8e43ba,"Since 10/2100, when did patient 10038992 last get prescribed vitamin d and felodipine at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'felodipine' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = 10038992 AND medication IN ('vitamin d', 'felodipine') AND prescription_date >= '2010-10-01' GROUP BY patient_id HAVING COUNT(DISTINCT medication) = 2"
32eaf17262d5b8862394bdba,What was the name of the drug prescribed for patient 10004235 within the same day after having received a anastomosis of hepatic duct to gastrointestinal tract procedure in 07/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,SELECT drug_name FROM prescriptions JOIN procedures ON prescriptions.patient_id = procedures.patient_id WHERE prescriptions.patient_id = 10004235 AND prescriptions.prescription_date = procedures.procedure_date AND procedures.procedure_name = 'anastomosis of hepatic duct to gastrointestinal tract' AND YEAR(procedures.procedure_date) = 2100 AND MONTH(procedures.procedure_date) = 7;
c3771288ef450c465644693b,What was the first drug that was prescribed to patient 10021487 via the pr route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime ASC LIMIT 1,[],select top 1 drug_name from prescription where patient_id = '10021487' and route = 'pr' order by prescription_date asc
f06393ab8b048f69f34b0dd2,When was the last time since 141 days ago patient 10010471's SaO2 was less than 100.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 100.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-141 day') ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT MIN(MeasurementDate) FROM Labs WHERE PatientID = 10010471 AND SaO2 < 100.0 AND MeasurementDate > CURRENT_DATE - INTERVAL '141 days'
a39b48bf94054784fed63d35,What is today's outpatient schedule with dr. welling?,,,SELECT * FROM outpatient_schedule WHERE doctor='dr. welling' AND date=CURRENT_DATE
03a5a6bba8bab1a26a453a24,Count the number of patients who were discharged during the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patient_discharge WHERE discharge_date BETWEEN '2022-01-01' AND '2022-12-31'
853d39a04eeeedbb0a28a7d6,How much was the difference in weight of patient 10004422 measured at 2100-01-25 05:00:00 compared to the value measured at 2100-01-24 06:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 05:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-24 06:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 05:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-24 06:00:00' )"": None}]","SELECT ABS(MAX(w.weight) - MIN(w.weight)) AS weight_difference FROM weight w WHERE w.patient_id = '10004422' AND w.date_time IN ('2100-01-25 05:00:00', '2100-01-24 06:00:00');"
614926ee15e952ef06fec83f,What does a procedure under the name procedure on single vessel cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedure on single vessel' ) ),,SELECT cost FROM procedures WHERE name = 'procedure' AND vessel_type = 'single vessel'
f7259128c751b9fb354668d9,When was patient 10016150's last discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10016150 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2142-05-15 19:49:00'}],SELECT MAX(AdmitDateTime) FROM Admissions WHERE PatientID = '10016150'
72544e79d8ced4be6541a0a1,"What were the four most commonly performed lab tests for patients who were previously diagnosed with other primary cardiomyopathies within 2 months, since 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other primary cardiomyopathies' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,select * from lab_tests order by count desc limit 4 where diagnosis='other primary cardiomyopathies' and date between '2100-01-01' and '2100-02-28'
409925c52ea74d305cc42742,Tell me the name of an output that patient 10007058 has last had on last month/25?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',outputevents.charttime) = '25' ORDER BY outputevents.charttime DESC LIMIT 1 )",[],"SELECT Output.Name FROM Output WHERE Output.PatientId = '10007058' AND Output.Date >= DATEADD(month, DATEDIFF(month, 0, GETDATE()) - 1, 0) AND Output.Date < DATEADD(month, DATEDIFF(month, 0, GETDATE()), 0) ORDER BY Output.Date DESC LIMIT 1"
549e20a8edaac5f7b05ecb41,Did patient 68280 experience side effects during a blood transfusion?,,,SELECT * FROM hospital_records WHERE patient_id = 68280 AND procedure = 'blood transfusion' AND side_effects IS NOT NULL;
1013430fc9817f02c815005a,Tell me the cost of a procedure known as continuous invasive mechanical ventilation for 96 consecutive hours or more.,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for 96 consecutive hours or more' ) ),,SELECT cost FROM medical_procedures WHERE procedure_name = 'continuous invasive mechanical ventilation' AND duration_hours >= 96
51beaf6f4ac792c505183c8f,Could you list the top three most common lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],"SELECT `lab_test`, COUNT(`lab_test`) AS test_count FROM `lab_tests` WHERE `year` = 2100 GROUP BY `lab_test` ORDER BY test_count DESC LIMIT 3"
e0d6ebb9ae85186bd60eadb3,What are the four most commonly ordered medications since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]","[SELECT MedicationName, COUNT(OrderID) AS OrderCount"
b208f8a2d2336ea49139fb02,Give me the top three most frequent lab tests that patients were given after being diagnosed with knee joint replacement in the same month in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'knee joint replacement' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT lab_test, COUNT(lab_test) AS frequency FROM lab_tests WHERE patient_id IN (SELECT patient_id FROM procedures WHERE diagnosis='knee joint replacement' AND YEAR(diagnosis_date)=2100 AND MONTH(diagnosis_date)=MONTH(procedure_date)) GROUP BY lab_test ORDER BY frequency DESC LIMIT 3"
bbfa77367f4475e333c7a834,What is today's outpatient schedule with dr. burgess?,,,SELECT * FROM outpatient_schedule WHERE doctor_name = 'dr. burgess' AND date = CURRENT_DATE()
0ef02974483ac960722b84f8,How much does the mcv change in patient 10021312 second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SQL Query
a7913ace036061bcf8f67934,Is patient 10037975's hemoglobin value last measured on the first hospital visit less than the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",Your SQL query here
ab8619ab9a2d54411ff482fb,What was the name of the drug patient 10021487 was prescribed with within the same hospital visit after having received a enteral infusion of concentrated nutritional substances procedure throughout this month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,[SELECT DISTINCT d.drug_name
bf0f46e8fb7361b565f0acd6,Tell me patient 10005817's total volume of output on 12/25/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-25'",[{'SUM(outputevents.value)': None}],SELECT SUM(volume) FROM patient_output WHERE patient_id = 10005817 AND date = '12/25/2023';
1e6bb4278191e2e7636f9b0b,"What were the five most frequently ordered procedures for patients who had also received drainage of left pleural cavity, percutaneous approach within the same month this year?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 Procedure, COUNT(*) AS Frequency FROM Procedures WHERE PatientID IN (SELECT PatientID FROM Procedures WHERE Procedure = 'drainage of left pleural cavity, percutaneous approach' AND MONTH(ProcedureDate) = MONTH(GETDATE()) AND YEAR(ProcedureDate) = YEAR(GETDATE())) AND MONTH(ProcedureDate) = MONTH(GETDATE()) AND YEAR(ProcedureDate) = YEAR(GETDATE()) GROUP BY Procedure ORDER BY Frequency DESC"
4aeee894b32b67b1daf7f21d,I need the total volume of input for patient 10027602 since 06/23/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-23'",[{'SUM(inputevents.totalamount)': 81320.0}],SELECT SUM(volume) FROM input_measurements WHERE patient_id = '10027602' AND measurement_date >= '2100-06-23'
1f9a407aceb5f8d72e3a565a,"Since 1 year ago, has patient 10022041 been to an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 0}],select visit_date from patient_visits where patient_id = '10022041' and department = 'Emergency Room' and visit_date > now() - interval '1 year'
7f8e8713a9f47bec5ebb47bb,What is the total number of patients discharged from the hospital in the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(patient_id) AS total_discharged FROM discharges WHERE discharge_date BETWEEN '2022-01-01' AND '2022-12-31';
ddbdcf0355e30978ef2bda62,How many prescriptions for tramadol were made throughout this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tramadol' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)': 0}],SELECT COUNT(*) AS total_tramadol_prescriptions FROM prescriptions WHERE medication_name = 'tramadol' AND EXTRACT(YEAR FROM prescription_date) = EXTRACT(YEAR FROM CURRENT_DATE)
61467a096265ec16474e107e,What are the five most frequently administered procedures for patients aged 50s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT procedure, COUNT(procedure) AS procedure_count FROM patient_procedures WHERE age BETWEEN 50 AND 59 AND procedure_date >= NOW() - INTERVAL '1 YEAR' GROUP BY procedure ORDER BY procedure_count DESC LIMIT 5;"
cd943bf7074ac723717f6ade,"Tell me the minimum total cost of a hospital that involved subarachnoid hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness since 1 year ago.","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'subarachnoid hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,[SELECT MIN(THYPO_HOSP_TOTAL_COST) FROM TAH
e1b2ba03357e942fcffc9832,What was the name of that output that patient 10039831 first had since 10/23/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-23' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'OR EBL'}],select distinct o.output_name from output o join patient p on o.patient_id = p.id where o.patient_id = 10039831 and o.date >= '10/23/2100' order by o.date asc limit 1
9b97c77977d5e0060179aa15,What is the number of operating rooms available at this time?,,,SELECT COUNT(*) AS available_rooms FROM operating_rooms WHERE status = 'available' AND NOW() BETWEEN start_time AND end_time
7ae9d2ebad321231f55eb04c,Has patient 10015860 received any laboratory testing in 10/last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) AS LabTestCount FROM lab_tests WHERE patient_id = 10015860 AND test_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW()"
195ea0933db24ed2ac3c0a71,"What were the first chloride, urine values of patient 10009049 during their first hospital encounter?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, urine' ) ORDER BY labevents.charttime ASC LIMIT 1",[],"select * from labevents where itemid in (50912,50931) and subject_id = 10009049 and hadm_id = (select min(hadm_id) from labevents where subject_id = 10009049)"
f07f334bbccde1c7406d1f43,When did patient 10027602 last have a mini-bal microbiology test since 10/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(event_date) AS last_test_date FROM lab_events WHERE patid = 10027602 AND labtest_id = 'mini-bal microbiology' AND event_date >= '2100-10-01'
e1c8e8780d98ea2f4d439813,Gather the total number of times patient 10019917 visited the hospital in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019917 AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT COUNT(*) FROM admissions WHERE patient_id = '10019917' AND visit_date >= '2100-01-01' AND visit_date < '2101-01-01'
bf9ce789f4d2ca8fc80ad3e1,Can you tell which medicine was first prescribed to patient 10027445 via the ih method in 08/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'ih' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT * FROM prescriptions WHERE patient_id = 10027445 AND method = 'ih' AND year = '08' AND quarter = 'this' ORDER BY prescription_date ASC LIMIT 1
fc1d2f78dd540b2cf1aed9b9,So what are the types of blood patient 8016 has.,,,SELECT BloodType FROM Patients WHERE PatientID = 8016
523f9419c20f37e75f17f229,What was the amount of ondansetron that patient 10027445 were prescribed in total?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.drug = 'ondansetron',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(order_quantity) FROM prescriptions WHERE patient_id = '10027445' AND drug_name = 'ondansetron';
1eb6a80e3bcffd099385b474,When did patient 10020944 have the maximum sodium value for the last time in their first hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],select max(result_date) from lab_results where person_id = 10020944 and result_value = (select max(result_value) from lab_results where person_id = 10020944 and lab_field_id = 50865 and visit_occurrence_id = (select min(visit_occurrence_id) from visit_occurrence where person_id = 10020944)) and lab_field_id = 50865 and visit_occurrence_id = (select min(visit_occurrence_id) from visit_occurrence where person_id = 10020944)
cff67763de893e7028b45382,Is there any genetic test that patient 53392 received?,,,SELECT * FROM genetic_tests WHERE patient_id = 53392
726a0de52d59010c160bbe92,What was the minimum bicarbonate value for patient 10006580 on the last hospital encounter?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ),[{'MIN(labevents.valuenum)': None}],SELECT MIN(bicarbonate) FROM lab_results WHERE patient_id = 10006580 AND encounter_id = (SELECT MAX(encounter_id) FROM lab_results WHERE patient_id = 10006580)
06aaefb80b31fdff1837ad61,Has any medicine been prescribed to patient 10029291 since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 1}],select * from prescription where patient_id=10029291 and date>'21-01-01'
cbf01f06a75320ed354d25af,What was the first prescription for patient 10021118 since 17 months ago?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-17 month') ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': '5% Dextrose'}],SQL query
97d179e16fffa9fb76504042,Are patient 10009035's bicarbonate levels second measured on the first hospital visit less than the levels first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN second_hco3 > first_hco3 THEN 'Yes' ELSE 'No' END AS IsSecondHCO3LevelHigher FROM (SELECT first(first_hco3) AS first_hco3, second(second_hco3) AS second_hco3 FROM labevents WHERE subject_id = 10009035 AND hadm_id IN (SELECT MIN(hadm_id) FROM labevents WHERE subject_id = 10009035 GROUP BY subject_id) AND itemid IN (SELECT itemid FROM d_labitems WHERE label LIKE '%HCO3%')) AS FirstVisitLevels"
d0ae32ba9d0feee58d99a6bc,Calculate the sum of patient 10018423's input since 03/21/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-21'",[{'SUM(inputevents.totalamount)': 18250.0}],SELECT SUM(input) as TotalInput FROM patient_data WHERE patient_id = 10018423 AND date >= '03/21/2100'
d8839ecf07fe219f65ec8de5,What is the price of a diagnosis for cellulitis and abscess of trunk?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cellulitis and abscess of trunk' ) ),,"SELECT Diagnosis, Price FROM DiagnosisCost WHERE Diagnosis IN ('Cellulitis', 'Abscess of trunk')"
0679067bdc3a032cbc68f962,Tell me the average total cost of a hospital that contains personal history of methicillin resistant staphylococcus aureus?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of methicillin resistant staphylococcus aureus' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT AVG(totalcost) AS AverageTotalCost FROM hospital WHERE personal_history_of_mrsa = true
565427eaa17c1b7db560f4e9,"Among patients diagnosed with other pulmonary embolism without acute cor pulmonale, what were the top five most common microbiology tests conducted within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other pulmonary embolism without acute cor pulmonale' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 test_name, COUNT(*) AS test_count FROM microbiology_tests JOIN diagnoses ON microbiology_tests.patient_id = diagnoses.patient_id WHERE diagnoses.condition = 'other pulmonary embolism without acute cor pulmonale' AND microbiology_tests.test_date BETWEEN diagnoses.diagnosis_date AND DATEADD(month, 2, diagnoses.diagnosis_date) GROUP BY test_name ORDER BY test_count DESC"
ac5c206d44772bba22a9ebfe,What are the top three most frequent drugs prescribed to patients in the same month after the diagnosis of gastro-esophageal reflux disease without esophagitis?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 DRUG, COUNT(*) AS FREQUENCY FROM PRESCRIPTIONS WHERE MONTH(PRESCRIPTION_DATE) = MONTH(DIAGNOSIS_DATE) AND YEAR(PRESCRIPTION_DATE) = YEAR(DIAGNOSIS_DATE) AND PATIENT_ID IN (SELECT PATIENT_ID FROM DIAGNOSES WHERE ICD_CODE = 'K21.9') GROUP BY DRUG ORDER BY FREQUENCY DESC;"
6d177c7ee3f8bf320492ec8b,What were the five most frequent microbiology tests that occurred in this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",[],"SELECT test_name, COUNT(*) as frequency FROM microbiology_tests WHERE YEAR(test_date) = YEAR(CURRENT_DATE) GROUP BY test_name ORDER BY frequency DESC LIMIT 5"
9e339e1a8f7393ed2f0a342e,What are the new single rooms?,,,SELECT * FROM room WHERE type = 'single' AND is_new = TRUE
e8888e24b833fbc7c8316ded,Can you tell me the top three diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",,"SELECT Diagnosis, AVG(DeathWithin3Months) AS MortalityRate FROM (SELECT Diagnosis, CASE WHEN DATEDIFF(DeathDate, DiagnosisDate) <= 90 THEN 1 ELSE 0 END AS DeathWithin3Months FROM PatientRecords) AS DerivedTable GROUP BY Diagnosis ORDER BY MortalityRate DESC LIMIT 3"
0a36ca6e9f221dc69fc7f8de,Has there been any organism observed in patient 10001217's first csf;spinal fluid microbiology test since 07/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND microbiologyevents.spec_type_desc = 'csf;spinal fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)>0': 0}],csf_microbiology_results
52505c841a4763efd35adac6,What are the top five common microbiology tests in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",[],SELECT name FROM tests WHERE category = 'Microbiology' AND year = 2100 ORDER BY frequency DESC LIMIT 5
58820822f031297565e686b7,Wanna the last time that patient 26799 had a medication that should be taken regularly?,,,SELECT MAX(date) AS last_medication_time FROM medication_records WHERE patient_id = 26799 AND medication_type = 'regularly-taken' AND date <= CURRENT_DATE
dae5f9c47a5e0608624786d7,"On the current hospital visit, how many days passed since the last anxiety state, unspecified diagnosis of patient 10004733?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anxiety state, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,select count(*) from chartnote where patient_id = 10004733 and icd_code = '300.00' and visit_id = (select max(visit_id) from chartnote where patient_id = 10004733) and visit_id != (select visit_id from chartnote where patient_id = 10004733 and icd_code = '300.00' order by visit_id desc limit 1)
d4667791b23ee3c61987de79,Can i tell if patient 1205 has need prphyl vc vrl hepat in hisher family?,,,"[SELECT * FROM (SELECT * FROM (SELECT DISTINCT pat.patient_id, pat.person_id, pat.date_created, pat.date_modified, pat.date_voided, pat.voided, pat.name, pat.gender, pat.birthdate, pat.birthdate_estimated, pat.death_date, pat.death_date_unknown, pat.date_changed_to_dead, pat.void_reason, pat.pregnancy_outcome, pat.outcome_other, pat.outcome_date, pat.outcome_other_description, pat.external_id, pat.external_ref, pat.pregnancy_status, pat.pregnancy_status_date, pat.pregnancy_status_comment, pat.location_id, pat.creator, pat.date_changed_to_incare, pat.patient_identifier_id, pat.patient_address_id, pat.patient_voided, pat.patient_disabled, pat.patient_chart_appointment, pat.patient_blood_group, pat.patient_currently_pregnant, pat.patient_date_current_pregnancy, pat.patient_conception_date, pat.patient_conception_date_estimated, pat.patient_conception_method, pat.patient_conception_method_other, pat.patient_conception_method_other_desc, pat.patient_conception_type, pat.patient_conception_type_other, pat.patient_conception_type_other_desc, pat.patient_conception_number, pat.patient_conception_trimester"
0dac4285b866c55eacef22d7,How much does patient 10018501 weigh difference last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","select weight_diff from (select (weight - first_value(weight)) as weight_diff, patient_id, visit_occurrence_id, row_number() over (partition by patient_id, visit_occurrence_id order by visit_start_date desc) as rn from (select p.person_id as patient_id, vo.visit_occurrence_id, vo.visit_start_date, w.weight, first_value(w.weight) over (partition by p.person_id, vo.visit_occurrence_id order by w.measurement_datetime asc) as first_value from person p inner join visit_occurrence vo on p.person_id=vo.person_id inner join measurement w on p.person_id=w.person_id and w.measurement_concept_id in (3023540, 3023541, 3023539, 3018351, 3018352) where p.person_id=10018501) as weight_measurements) where rn=1"
3ef161ccc95ceeb7a1c4f53a,When did patient 10005348 first get sputum microbial tests in the last hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],SELECT MIN(date_collected) FROM microbiology_sputum WHERE patient_id = '10005348' AND visit_id = (SELECT visit_id FROM visits WHERE patient_id = '10005348' ORDER BY visit_start_date DESC LIMIT 1)
14f4bb19aad791593fd86e30,Show me the top three most frequent output instances since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]",
b2d904b2d1f152b67f7b2b51,"Since 07/10/2100, what was patient 10027445's first respiratory rate?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-07-10' ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(measurement_date) AS first_measurement_date, respiratory_rate FROM patient_measurements WHERE patient_id = '10027445' AND measurement_date >= '2100-07-10' AND respiratory_rate IS NOT NULL AND respiratory_rate <> ' ' GROUP BY patient_id HAVING respiratory_rate IS NOT NULL"
79690c25ac2b2e1a3f74269c,"Was the creatine kinase, mb isoenzyme reading for patient 10004733 last measured on the current hospital visit less than the first value measured on the current hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN MIN(CASE WHEN ""ObservationDateTime"" IN (SELECT MAX(""ObservationDateTime"") FROM ""Observation"" WHERE ""PatientID"" = 10004733 AND ""ConceptName"" = 'Creatine kinase, mb isoenzyme' AND ""ObservationStatus"" = 'Final') THEN ""NumericValue"" END) > MAX(CASE WHEN ""ObservationDateTime"" IN (SELECT MIN(""ObservationDateTime"") FROM ""Observation"" WHERE ""PatientID"" = 10004733 AND ""ConceptName"" = 'Creatine kinase, mb isoenzyme' AND ""ObservationStatus"" = 'Final') THEN ""NumericValue"" END) THEN 'Yes' ELSE 'No' END AS Result FROM ""Observation"" WHERE ""PatientID"" = 10004733 AND ""ConceptName"" = 'Creatine kinase, mb isoenzyme' AND ""ObservationStatus"" = 'Final'"
7a4312f3777e3813772be85d,What was the last time of input of patient 10022041?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) ORDER BY inputevents.starttime DESC LIMIT 1,[{'starttime': '2187-05-20 15:10:00'}],SELECT `last_input_time` FROM `patient_data` WHERE `patient_id` = 10022041 ORDER BY `last_input_time` DESC LIMIT 1
4a9c408414e0cb27d0bc9e3b,How much does it cost to get diagnostic of personal history of poliomyelitis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of poliomyelitis' ) ),,select cost from service_costs where description = 'diagnostic of personal history of poliomyelitis'
bd64eba2a9801db69c14dd75,How much did patient 10005817 weigh the first time it was measured in 12/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-12' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT weight FROM patient_measurements WHERE patient_id = '10005817' AND date = (SELECT MIN(date) FROM patient_measurements WHERE patient_id = '10005817' AND date LIKE '12/2100%')
a9c112441a88402a143e7d68,When was the first time patient 10006053's heart rate was greater than 105.0 on the last ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 105.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT MIN(ChartDate) AS FirstExceedanceDate FROM chartevents WHERE ItemID = 211 AND Value > 105.0 AND Subject_ID = 10006053 AND HADM_ID = (SELECT MAX(HADM_ID) FROM icustays WHERE Subject_ID = 10006053) AND Value IS NOT NULL
6ba230c3cb949791fde3229f,How much nystatin oral suspension has been prescribed to patient 10024043 in total?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND prescriptions.drug = 'nystatin oral suspension',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(quantity) FROM prescriptions WHERE patient_id = '10024043' AND medication_name = 'nystatin oral suspension';
decffce701731474c7a1532f,What are the single rooms which are now available?,,,SELECT room_id FROM bookings WHERE room_type='single' AND availability='now' ORDER BY room_id ASC;
45128f30bf831e9b55cca497,How many times did patient 10026255 attend the hospital this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026255 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SQL Query
d016293ab625d79f2dc0ca33,When was the last time the SaO2 of patient 10021487 was measured on the last ICU stay at less than 98.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 98.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],"select max(v2.value_datetime) as LastTimeSaO2LessThan98 from t_observation v1 left join t_observation_value v2 on v1.observation_id = v2.observation_id where v1.patient_id = 10021487 and v1.value_coded = 1179 and v2.value_numeric < 98.0 and v1.encounter_id in (select max(encounter_id) from t_patient_encounter where patient_id = 10021487 group by patient_id, location_id)"
23a3bff9e2c821e3f091088a,When did patient 10019777 get an input for the last time since 03/04/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-04' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2187-02-17 20:00:00'}],select * from input_events where person_id = '10019777' and input_date > '03/04/2100' order by input_date desc limit 1
55106da0f8f7722ca97968ca,What was the first time patient 10004733 received ph in a lab test in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime ASC LIMIT 1",[],Date
4b334d0f16aebc57870989a3,So how many hours have passed since patient 10021487's first closed fracture of four ribs diagnosis during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of four ribs' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"select extract(epoch from (max(t1.timestamp) - min(t1.timestamp))) / 3600 as duration from (select t.timestamp from labevents t, d_items d where t.itemid in (select itemid from d_items where label like 'Closed Fracture of Four Ribs%' and category in ('Injury', 'Trauma') and site='Chest') and t.hadm_id in (select hadm_id from d_patients where subject_id = 10021487) and t.charttime between (select admittime from d_admissions where hadm_id in (select hadm_id from d_patients where subject_id = 10021487)) and (select dischtime from d_admissions where hadm_id in (select hadm_id from d_patients where subject_id = 10021487)) and t.hadm_id in (select hadm_id from d_patients where subject_id = 10021487)) t1"
9d99fa18449a20ae42392b52,"What was the last dose of glucagon in 09/2100, prescribed to patient 10027445?","SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.drug = 'glucagon' AND strftime('%Y-%m',prescriptions.starttime) = '2100-09' ORDER BY prescriptions.starttime DESC LIMIT 1",[],"SELECT * FROM Dose WHERE drug = ""glucagon"" AND patient = 10027445 AND timestamp = (SELECT MAX(timestamp) FROM Dose WHERE drug = ""glucagon"" AND patient = 10027445 AND timestamp LIKE ""09/2100%"")"
615149dac9c4e11fbde8d9bc,How many patients had a lymphs lab test since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphs' ) AND strftime('%Y',labevents.charttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) AS patient_count FROM lab_tests WHERE test_type = 'lymphs' AND date >= '2100-01-01'
a3d0c04ad119ac98baeec6ac,"Since 04/04/2100, when did patient 10018501 have their last input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-04' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2141-08-01 19:44:00'}],
740e35ffd9a5157bb6bf16ad,Count the number of people who were diagnosed with open fracture of shaft of femur.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'open fracture of shaft of femur' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM diagnoses WHERE condition = 'open fracture of shaft of femur'
4d79af33c083f4da6c760216,Was patient 10037861 provided with any medication on the first hospital visit?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],select count(*) from visits v join meds m on v.visitid=m.visitid where v.patientid=10037861 and v.visitnumber=1
d9585c679577af82dd88c509,What is the number of drugs patient 10019172 was prescribed since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)': 168}],SQL Query
0565efc9f6e08966694b0d93,How many times did patient 10001217 go to the hospital?,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10001217,[{'COUNT( DISTINCT admissions.hadm_id )': 2}],Your SQL query here
4e9aac252394c9a79ea2005d,Will any additional blood culture test be done on patient 76275?,,,select * from patient_tests where patient_id = '76275' and test_name = 'blood culture' and test_date > (select max(test_date) from patient_tests where patient_id = '76275' and test_name = 'blood culture')
04252ccebd8d2d108f1880fc,What are the top three most frequent procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,SQL Query Here
d4e9772857153946f3bf287d,Can you indicate the daily average dose of replete with fiber (full) that patient 10021487 received since 9 months ago?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'replete with fiber (full)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-9 month') GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],
715cc33a6ffeecdcb8a10831,Tell me the length in days of the first stay for patient 10020187 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 5.452662038151175}]","SELECT DATEDIFF(DATE(DischargeTime), DATE(AdmissionTime)) AS LengthOfStay FROM PatientRecords WHERE PatientID = 10020187 AND StayType = 'ICU' AND AdmissionTime = (SELECT MIN(AdmissionTime) FROM PatientRecords WHERE PatientID = 10020187 AND StayType = 'ICU')"
7b4a60c5a197fac6bff1cdf5,"When did patient 10027445 receive a sodium, urine lab test on the first occasion?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT MIN(test_date) AS first_test_date FROM lab_tests WHERE patient_id = '10027445' AND test_type = 'sodium, urine'"
3df956fea1348d1046fdd09d,When are dr. oneill's rounds and procedures?,,,SELECT * FROM schedule WHERE doctor='Dr. O'Neill'
91bfc5a70401d51bfca3e0d1,What was the total 5% dextrose dose that patient 10004235 has been prescribed?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = '5% dextrose',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(5percent_dextrose) AS total_dextrose_dose FROM prescriptions WHERE patient_id = '10004235'
0ef0e1be7cef42de551d0ac7,When was the first time patient 10007818 had been prescribed medication through the pr route on the first hospital encounter?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(encounter_date) FROM prescriptions WHERE patient_id = 10007818 AND route = 'pr' AND encounter_number = 1
e07bc2b8ae12376224aac0c9,Tell me the top three most prevalent procedures for patients aged 40s since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"[SELECT Procedure, COUNT(*) AS Frequency"
9304aef38384b969a06b3abe,What was the maximum monthly number of patients who had hemothorax in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemothorax' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,"SELECT MAX(mth) FROM (SELECT COUNT(DISTINCT patient_id) AS mth FROM hospital WHERE diagnosis = 'hemothorax' GROUP BY YEAR(admission_date), MONTH(admission_date)) AS monthly_hemothorax"
0e1d898b2e27b9241962d250,Tell me the count of phlebography of the portal venous system using contrast material procedures that took place since 2100.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'phlebography of the portal venous system using contrast material' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT COUNT(*) FROM `phlebography_of_portal_venous_system_using_contrast_material_procedure` WHERE `date` > '2100-01-01'
2bdbdd95fe3cb63a5fe57218,Let me know the total quantity of input patient 10012552 received on 04/06/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '04-06'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(quantity) FROM [TABLE_ID
a7419fe163e1296529d925bc,What was the name of the organism found in the first bronchoalveolar lavage microbiology test of patient 10007818 in 07/this year?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],"select top 1 o.name from organism o where o.organismid in (select distinct l.organismid from bronchoalveolar_lavage_microbiology l where l.patientid=10007818 and l.testdate in (select min(b.testdate) from bronchoalveolar_lavage_microbiology b where b.patientid=10007818 and substring(b.testdate,1,7)='07/2023')) order by l.testdate asc"
25a3fc060e58489fa5108651,"In this year, has patient 10018423 visited an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT visit_type FROM patient_visits WHERE patient_id = '10018423' AND visit_date BETWEEN '2023-01-01' AND '2023-12-31' AND visit_type = 'Emergency'
46a6c77172cbf9196d74a902,What were the top five most common specimen tests conducted?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]","SELECT test, COUNT(*) AS frequency FROM specimen_tests GROUP BY test ORDER BY frequency DESC LIMIT 5"
b6403378bbfbec78e67126fc,Tell me the four most frequent treatments for patients aged 30s in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT treatment, COUNT(*) AS frequency FROM patient_records WHERE YEAR(age) / 10 = 21 GROUP BY treatment ORDER BY frequency DESC LIMIT 4"
122180d2410c37fb1d467316,Provide the count of ICU visits for patient 10020740 since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 5}],"select count(*) from ADRICU where PATIENTID='10020740' and ADMISSIONDATE >= DATEADD(year, -1, GETDATE())"
89541b5a85b5b5b3125bf003,Did patient 10016150 undergo the angiocardiography of left heart structures in their first hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'angiocardiography of left heart structures' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],SELECT ... FROM ... WHERE ...
ce7977eba118e89d42bc63b2,What was the diagnosis for patient 10029484 the last time during this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,SELECT diagnosis FROM medical_records WHERE patient_id = 10029484 AND visit_date = (SELECT MAX(visit_date) FROM medical_records WHERE patient_id = 10029484 AND YEAR(visit_date) = YEAR(CURDATE()))
25df58c9b9009d8a32d96d15,Tell me the number of patients discharged from the hospital last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS number_of_patients_discharged FROM admissions WHERE discharge_date BETWEEN '2022-01-01' AND '2022-12-31'
98340bd550d51478d6ada232,Could you inform me the total output amount of patient 10012552 on 04/04/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-04-04'",[{'SUM(outputevents.value)': None}],select sum(output_amount) from patient_output_records where patient_id=10012552 and output_date='04/04/2100'
c8b35c10890db1d889786310,Tell the name of the diagnosis that was received by patient 81840 at the other department.,,,SELECT diagnosis_name FROM diagnoses WHERE patient_id = 81840 AND department != 'current_department'
5dbb876ab254d8863d9a17ce,What is the daily average input of d5 1/2ns that patient 10022281 is getting during their last ICU stay?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],select avg(b.input) from input b where b.itemid=216 AND b.icustay_id in (select icustay_id from icustay where subject_id=10022281 and intime in (select max(intime) from icustay where subject_id=10022281))
6d3a86657cfb5924c8e4dbbb,When did patient 10038933 receive an input for the first time?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) ORDER BY inputevents.starttime ASC LIMIT 1,[{'starttime': '2148-09-10 13:30:00'}],SELECT MIN(date) AS first_input_date FROM patient_inputs WHERE patient_id = 10038933
e3e406fe664e626c9595b4ec,Is there a test that patient 65759 had been given?,,,SELECT test_id FROM test_results WHERE patient_id = 65759;
ede3b2dd4e96f4b8027fd757,Retrieve the top three most frequent output occurrences since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]",SQL Query
387697552eec0b37359509db,What was the name of the drug that patient 10004235 was prescribed in the same day after having received a laparoscopic cholecystectomy procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic cholecystectomy' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,SELECT p.name FROM patient p WHERE p.id = '10004235' AND p.date_of_birth = '1964-09-18'
682b7c020d47e07237753b11,"Was ketorolac, simvastatin, or lactated ringers prescribed to patient 10011398 during their first hospital encounter?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'ketorolac', 'simvastatin', 'lactated ringers' )",[{'COUNT(*)>0': 0}],SELECT DISTINCT medication_name FROM prescriptions WHERE patient_id = 10011398 AND (medication_name = 'ketorolac' OR medication_name = 'simvastatin' OR medication_name = 'lactated ringers') AND encounter_order = 1;
d1054cc1b2ffa4b3b7000b34,What was patient 10007058's first tested specimen in 11/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '11' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT specimen FROM tests WHERE patient_id = 10007058 AND test_date = (SELECT MIN(test_date) FROM tests WHERE patient_id = 10007058 AND EXTRACT(MONTH FROM test_date) = 11 AND EXTRACT(YEAR FROM test_date) = EXTRACT(YEAR FROM CURRENT_DATE))
f93cc51e5d7120ee4b957451,What was the total volume of void that patient 10007058 had since 09/10/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-09-10'",[{'SUM(outputevents.value)': None}],SELECT SUM(Volume) AS TotalVoidVolume FROM PatientRecords WHERE PatientID = 10007058 AND Date >= '09/10/2100' AND Type = 'Void'
26904ee0e2e1e4ac50b43168,What was the first time patient 10016742 has had the maximum SaO2 on 08/11/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '08-11' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],SELECT MIN(MeasurementDateTime) FROM AdtDataV.VitalSign WHERE PatientID = '10016742' AND SaO2 = (SELECT MAX(SaO2) FROM AdtDataV.VitalSign WHERE PatientID = '10016742' AND CAST(MeasurementDateTime AS DATE) = '2023-08-11') AND CAST(MeasurementDateTime AS DATE) = '2023-08-11' AND SaO2 IS NOT NULL
921675022a09cbed462a1741,What is the total number of hemodialysis procedures that took place in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,Your SQL query goes here
23e582ea53646d1236eee37e,"In total, what was the input amount of dextrose 5% that patient 10027602 received on 11/23/this year?","SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '11-23'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(amount) as TotalDextrose5 FROM fluid_administration WHERE patient_id = 10027602 AND fluid_name LIKE 'dextrose 5%' AND date_administered = '2023-11-23'
7cefa5cf7a599ae5c96e8eb5,What culture was patient 10007928 last tested since 02/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'STOOL'}],SELECT DISTINCT c.culture FROM patient_tests p JOIN cultures c ON p.culture_id = c.id WHERE p.patient_id = 10007928 AND p.test_date >= '02/2100' ORDER BY p.test_date DESC LIMIT 1
4d5ceeafba15c9090fc8776b,When did patient 10019172 receive a blood culture microbiology test for the last time since 10/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],select max(date) from microbiology where patient_id = 10019172 and test_name = 'Blood Culture' and date > '10/21'
91233f4f7f64dbd5fbd43579,Present the count of ICU visits for patient 10006053 since 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',icustays.intime) >= '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 2}],SELECT count(*) AS icu_visit_count FROM patient_icu_visits WHERE patient_id = '10006053' AND visit_date >= '2100-01-01'
db0b8e8e0ddcba04c82bb7f0,What was patient 10010471's last measurement for o2 saturation pulseoxymetry on 12/17/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-17' ORDER BY chartevents.charttime DESC LIMIT 1",[],select the last measurement of o2 saturation pulseoximetry for patient 10010471 on 12/17/this year
34a5e8b5a91c17bdf4999b17,"Give me the count of inspection of tracheobronchial tree, via natural or artificial opening endoscopic procedures that occurred since 2100.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT COUNT(*) FROM `AHA_Inspection` WHERE `InspectionType` LIKE '%tracheobronchial%' AND `ProcedureType` LIKE '%endoscopic%' AND `Date` >= '2100-01-01';
d5f33799e7f8110fd11cd073,What was the last time that patient 10008454 had a maximum value of lactate dehydrogenase (ld) in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],"[select max(ld) as max_ld, visit_occurrence_id, visit_occurrence_datetime as visit_date"
7fc9012c75133098e145243a,"Retrieve the top four most frequent procedures that patients were given within 2 months after receiving occlusion of right vertebral artery with intraluminal device, percutaneous approach throughout this year.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT procedure_name, COUNT(*) as frequency FROM medical_records WHERE procedure_date BETWEEN (SELECT DATE_ADD(event_date, INTERVAL 2 MONTH) FROM medical_records WHERE procedure_name = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach') AND (CURRENT_DATE()) AND event_year = YEAR(CURRENT_DATE()) GROUP BY procedure_name ORDER BY frequency DESC LIMIT 4"
052079a05ce7afbbced7a57a,"Of the patients of age 60 or above since 2100, what were the top three most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT Diagnosis, COUNT(*) AS Frequency FROM Patients WHERE Age >= 60 AND AdmissionDate >= '2100-01-01' GROUP BY Diagnosis ORDER BY Frequency DESC LIMIT 3"
e474a2417040aa88bad3b8f1,How many patients stayed at the emergency department in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL query
44c07c98fe50b60cd61a2569,What are patient 10021118's changes in free calcium last measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","select `free calcium last`- `free calcium first` from labevents where itemid in (50852,50813) and `charttime` between (select `admittime` from admissions where `hadm_id` = 10021118) and (select `dischtime` from admissions where `hadm_id` = 10021118) and `subject_id` = 10021118 order by `charttime` limit 2"
583645b19b83246b4e37528d,What new drugs are prescribed for patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"SELECT new_drugs.drug_name, new_drugs.date_prescribed FROM (SELECT drug_name, MAX(date_prescribed) AS date_prescribed FROM prescriptions WHERE patient_id = 10018081 AND date_prescribed = CURRENT_DATE GROUP BY drug_name) AS new_drugs LEFT JOIN (SELECT drug_name, MAX(date_prescribed) AS date_prescribed FROM prescriptions WHERE patient_id = 10018081 AND date_prescribed = CURRENT_DATE - INTERVAL '1 DAY' GROUP BY drug_name) AS old_drugs ON new_drugs.drug_name = old_drugs.drug_name WHERE old_drugs.drug_name IS NULL;"
bc12c47d96a21b5e21142ed7,Show me the top five microbiology tests.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]",SELECT * FROM tests WHERE category = 'Microbiology' ORDER BY popularity DESC LIMIT 5;
97d2fe4c7a06a3344798570f,Was patient 10029291 to the er during their last hospital encounter?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'COUNT(*)>0': 0}],SELECT * FROM er_visits WHERE patient_id = 10029291 AND visit_date = (SELECT MAX(encounter_date) FROM encounters WHERE patient_id = 10029291)
3e3f93fb3a2e4577befd898b,Calculate patient 10006053's total output since 86 days ago.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-86 day')",[{'SUM(outputevents.value)': 7045.0}],"SELECT SUM(Quantity) AS TotalOutput FROM Output WHERE PatientID = 10006053 AND Date >= DATE_SUB(CURDATE(), INTERVAL 86 DAY)"
5d2e380e135d1c3beebbb4b8,Display the top four most commonly prescribed drugs.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]","select drug_name, count(*) as prescription_count from prescriptions group by drug_name order by prescription_count desc limit 4"
8b6ecc1e8d51fdbbd657d6be,What was the last hospital discharge time for patient 10011398?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10011398 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(discharge_time) AS last_discharge_time FROM hospital_discharge_records WHERE patient_id = 10011398;
14dc70100f62f8b317f16a1c,I want to know the ward id that patient 65962 can go in and get in?,,,SELECT ward_id FROM hospital_wards WHERE bed_availability > 0 AND bed_capacity >= (SELECT COUNT(*) FROM patients WHERE ward_id = hospital_wards.ward_id) AND (SELECT COUNT(*) FROM patients WHERE ward_id = hospital_wards.ward_id AND condition = (SELECT condition FROM patients WHERE patient_id = 65962)) < (SELECT COUNT(*) FROM patients WHERE ward_id = hospital_wards.ward_id) * 0.8
af5718c6edddceb0646a23e6,How many current patients exist?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS PatientCount FROM Patients WHERE DischargeDate IS NULL
08eeb31e70fedda9acf60d5d,When will patient 57023 be able to visit other departments?,,,select * from patient_appointments where patient_id = 57023 and status = 'approved' and department != 'current_department'
8fb8495a86fc33185eb96c55,What is the protocol of anticancer drugs.,,,select protocol from drug where disease='cancer'
d1786dec0eca017b0b1f5d7b,"Count the number of patients who received unilateral simple mastectomy in the same hospital visit after being diagnosed with personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,"SELECT COUNT(DISTINCT patient_id) FROM patient_records WHERE diagnosis_code IN ('G45', 'I63') AND procedure_code = 'BC' AND visit_date BETWEEN '2100-01-01' AND '2100-12-31' AND EXISTS (SELECT 1 FROM patient_records pr2 WHERE pr2.patient_id = patient_records.patient_id AND pr2.procedure_code = 'BC' AND pr2.visit_date > patient_records.visit_date)"
ad2310914d9164e853dba7ed,Tell me the amount of total foley that patient 10007058 had since 11/23/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-23'",[{'SUM(outputevents.value)': None}],SELECT SUM(FOLEY_AMT) as TotalFoley FROM BILLED_CHARGES WHERE PAT_ID = '10007058' AND CHARGE_DATE >= '11/23/2100';
ff8f65ff38e91c62de0fab77,What is the maximum total hospital cost involving a drug named aspirin (buffered) since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'aspirin (buffered)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,select max(total_hospital_cost) from cost_analysis where drug_name='aspirin (buffered)' and admission_year >= 2100
2195808ddabb497385b40858,Get the count of hospital visits by patient 10017492 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10017492 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 2}],SELECT COUNT(*) AS visit_count FROM HospitalVisits WHERE patient_id = 10017492 AND visit_date >= '2100-01-01'
4e9b234a6ce9fa0007c2e212,When was patient 10015860 prescribed with a drug via the im route for the last time on the first hospital stay?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT MAX(end_date) FROM prescription WHERE patient_id = '10015860' AND route = 'im' AND stay_id IN (SELECT MIN(stay_id) FROM stay WHERE patient_id = '10015860')
366c5196b25e3189805acc33,How long was temporary tracheostomy taking for patient 78131?,,,SELECT procedure_duration FROM tracheostomy_procedures WHERE patient_id = 78131 AND procedure_type = 'temporary'
4fbd8deeeee7c2df137faa1a,What is patient 10039831's maximum asparate aminotransferase (ast) value in their current hospital visit?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ),[{'MAX(labevents.valuenum)': None}],SELECT MAX(ast) FROM lab_results WHERE patient_id = 10039831 AND visit_id = (SELECT visit_id FROM visits WHERE patient_id = 10039831 ORDER BY visit_date DESC LIMIT 1)
1ae02fd40242a1f6626facb2,How many hours has it been since patient 10039831 stayed in the careunit discharge lounge in this hospital encounter for the first time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime ASC LIMIT 1",[],"select extract(epoch from age(current_timestamp, min(d.discharge_dt))) / 3600 from careunit_stays s join discharges d on s.careunit_stay_id=d.careunit_stay_id where s.patient_id=10039831 and s.careunit_code='discharge lounge' and s.hospital_encntr_id=d.hospital_encntr_id"
78c274657cd4e1d8e8b02190,Tell me the five most common diagnoses since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(diagnosis) AS count FROM diagnosis WHERE date >= DATE_SUB(NOW(), INTERVAL 1 YEAR) GROUP BY diagnosis ORDER BY count DESC LIMIT 5"
613a190f2257871bd0c6a395,How much of a difference is there in patient 10029291's weight last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT ((SELECT w1.weight_value - w2.weight_value) AS weight_difference FROM weight w1 JOIN weight w2 ON w1.person_id = w2.person_id AND w1.visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM weight WHERE person_id = 10029291 AND visit_occurrence_id = (SELECT MIN(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 10029291)) AND w2.visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM weight w JOIN visit_occurrence v ON w.visit_occurrence_id = v.visit_occurrence_id WHERE w.person_id = 10029291 AND v.visit_occurrence_id = (SELECT MIN(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 10029291) - 1)) FROM dual
027be20fe6b2508766d312ac,How many mupirocin cream 2% prescriptions took place?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'mupirocin cream 2%',[{'COUNT(*)': 0}],SELECT COUNT(*) AS prescription_count FROM prescriptions WHERE medication_name = 'mupirocin cream 2%';
4bcd1b55582a8d4b902af134,What was the drug prescribed to patient 10018845 for the last time via sc route since 09/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT ... FROM ... WHERE ... ORDER BY ... LIMIT ...
b210336ce9274694af8855f6,What was an insurance plan for patient 10018845 on the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],select plan from insurance where patient_id = 10018845 and encounter_num = 1;
2d292b7a053eb9f6d89638af,Retrieve patient 10027602's monthly maximum weight since 1 year ago.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"select max(weight) from patient_10027602_weight where date > DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) group by month(date)"
d53217eec061327cdf9bf36c,Prazosin - How much does it cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'prazosin' ),,SELECT AVG(Price) AS AveragePrice FROM Medications WHERE Name = 'Prazosin'
1c513ac8c299151372834f1a,How many operating rooms are there now?,,,SELECT COUNT(*) AS number_of_operating_rooms FROM rooms WHERE type = 'operating' AND status = 'available'
3eebaf8381530fd2b515bfc8,What new meds are prescribed to patient 10039831 today compared to the ones from yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"select distinct c.name from prescription p, medication c where p.drug=c.id and p.patient=10039831 and p.date=current_date and not exists (select * from prescription pp where pp.drug=c.id and pp.patient=10039831 and pp.date=current_date-1)"
39619ec2f079e47413f41d16,"List the top three most frequent specimens that patients were tested in the same hospital encounter after receiving introduction of other therapeutic substance into heart, open approach since 2100.","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 Specimen, COUNT(*) AS Frequency FROM lab_tests WHERE ProcedureCode = 'Introduction of other therapeutic substance into heart, open approach' AND TestDate > '2100-01-01' GROUP BY Specimen ORDER BY Frequency DESC;"
13bf5b0281c0d443bd4ea538,"During the last ICU visit, what was the average value of the systolic blood pressure of patient 10038933?",SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ),[{'AVG(chartevents.valuenum)': None}],SELECT AVG(Systolic_BP) FROM ICU_Visits WHERE patient_id = '10038933' AND visit_date = (SELECT MAX(visit_date) FROM ICU_Visits WHERE patient_id = '10038933')
9f35654e31c2a74dccf4e709,What was the average value of heart rate for patient 10029291 on 03/02/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-02'",[{'AVG(chartevents.valuenum)': None}],SELECT AVG(HeartRate) FROM PatientData WHERE PatientID = '10029291' AND Date = '03/02/2100'
7bf454dec8755f5d448775d0,"What is the cost of a surgery called performance of urinary filtration, multiple?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of urinary filtration, multiple' ) )",,"select distinct ""Costs"".""cost"" from ""Costs"", ""Procedures"", ""Diagnoses"" where ""Procedures"".""name""='performance of urinary filtration, multiple' and ""Costs"".""procedure_id""=""Procedures"".""id"" and ""Procedures"".""diagnosis_id""=""Diagnoses"".""id"""
933c11a9ca710be4b2120713,Has patient 9038 ever experienced a side effect during a blood transfusion?,,,SELECT COUNT(*) FROM SideEffects WHERE PatientID = 9038 AND Procedure = 'Blood Transfusion' AND SideEffectOccurred = 'Yes'
ecbdf8f66488345ecb0ba8bf,What drug was patient 10025463 prescribed for during the same day after undergoing catheter based invasive electrophysiologic testing in 11/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '11' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,[select distinct p.drug
7a94050770d72ccb6594539a,Can you give me patient 10008454's daily average packed red blood cells input?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],SELECT AVG(packed_red_blood_cells) AS average_daily_packed_red_blood_cells FROM patient_blood_transfusion WHERE patient_id = 10008454 GROUP BY admission_date
9adca592b48d4fd0d62f45d1,"How many patients were given extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM `treatment` WHERE `treatment`.`treatment_name` = 'Extirpation of Matter from Left Lower Lobe Bronchus' AND `treatment`.`approach` IN ('Natural or artificial opening', 'Endoscopic')"
e2c201a20662ad1fab6cc5ef,Has patient 2127 had an appointment in another department?,,,SELECT COUNT(*) FROM appointments WHERE patient_id = 2127 AND department_id NOT IN (SELECT department_id FROM appointments WHERE patient_id = 2127)
dbb4226192d4ef37cbf426dd,"Since 07/2100, when did patient 10031757 last get prescribed lactated ringers and metronidazole (flagyl) at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"select max(e.encounter_date) as last_prescribed_date from encounter e join encounter_drug ed on e.encounter_id = ed.encounter_id join concept_name cn on ed.concept_name_id = cn.concept_id where e.patient_id = 10031757 and e.encounter_date >= '2100-07-01' and cn.name in ('lactated ringers', 'metronidazole (flagyl)') group by e.patient_id having count(distinct cn.name) = 2"
0d4e20e0fef8cae36b234d1b,When did patient 10004422's first input on 01/25/2100 occur?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-01-25' ORDER BY inputevents.starttime ASC LIMIT 1",[],SELECT MIN(event_time) FROM patient_data WHERE patient_id = 10004422 AND event_date = '01/25/2100';
3afcd24ffddc745b26111a19,Does patient 20000 have any inherited disease?,,,select * from patient where patient_id = '20000' and has_inherited_disease = true
cbcb60f4c34e7c1afabdf477,What is the average total cost for a hospital including tests in the rheumatoid factor laboratory?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rheumatoid factor' ) ) GROUP BY cost.hadm_id ) AS T1,,select avg(total_cost) as average_cost from hospital_costs join lab_tests on hospital_costs.hospital_id = lab_tests.hospital_id where lab_tests.test_type = 'Rheumatoid Factor' and lab_tests.laboratory = 'Rheumatoid Factor Laboratory'
de257ec1deb940f9cc31497a,Can you tell me the name of the diagnosis patient 10031404 received last during their last hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,"SELECT diagnosis FROM medical_records WHERE patient_id = 10031404 ORDER BY visit_date DESC, diagnosis_date DESC LIMIT 1"
5fd4f4ab7afda4e90c2af26a,What is the average monthly number of patients suffering from personal history of sudden cardiac arrest since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of sudden cardiac arrest' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,"SELECT strftime('%Y-%m', date) AS month, AVG(patients) AS average_patients FROM cardiac_arrest WHERE condition = 'personal_history' AND date >= '2100-01-01' GROUP BY month ORDER BY month;"
3cfe1a9f322b92f0841576db,What was the first dose of nicardipine iv prescribed to patient 10005817 since 12/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.drug = 'nicardipine iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(administration_time) as FirstDoseTime FROM `physionet-data.mimiciii_clinical.icustays` INNER JOIN `physionet-data.mimiciii_clinical.dose` ON `physionet-data.mimiciii_clinical.icustays`.subject_id = `physionet-data.mimiciii_clinical.dose`.subject_id AND `physionet-data.mimiciii_clinical.icustays`.hadm_id = `physionet-data.mimiciii_clinical.dose`.hadm_id WHERE `physionet-data.mimiciii_clinical.dose`.drug = 'nicardipine' AND `physionet-data.mimiciii_clinical.dose`.route = 'IV' AND `physionet-data.mimiciii_clinical.icustays`.subject_id = 10005817 AND `physionet-data.mimiciii_clinical.dose`.administration_time >= '2100-12-00 00:00:00' GROUP BY `physionet-data.mimiciii_clinical.dose`.subject_id
55298e7d2d87edab46d2e4e0,How many patients received a globulin lab test since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'globulin' ) AND strftime('%Y',labevents.charttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM lab_tests WHERE test_type = 'globulin' AND test_date >= '2100-01-01'
69b33b1e544e77eca6472b64,Give me the four most common microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]",SQL Query Here
0e303986f42987d1f61a3da5,"What drug was prescribed to patient 10021118 within 2 days after the procedure of performance of cardiac output, continuous during this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT drug FROM prescriptions WHERE patient_id = 10021118 AND prescription_date BETWEEN (SELECT procedure_date FROM procedures WHERE procedure_type = 'performance of cardiac output, continuous' AND patient_id = 10021118 AND procedure_date >= DATE_FORMAT(NOW(), '%Y-%m-01')) AND (SELECT procedure_date FROM procedures WHERE procedure_type = 'performance of cardiac output, continuous' AND patient_id = 10021118 AND procedure_date >= DATE_FORMAT(NOW(), '%Y-%m-01')) + INTERVAL 2 DAY AND prescription_date < LAST_DAY(NOW())"
a3e6f2a97bc4bdaab7616bd2,What percentile is 2.3 on a lactate test among patients of the same age as patient 10015272 during the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.3",,Your SQL Query Here
b1baeec40f8e02dc63c8b5e3,"What was the drug that patient 10031404 was prescribed for during the same hospital visit after undergoing drainage of pericardial cavity, percutaneous approach since 02/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-02' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,SELECT drug FROM `mimiciv_drug` WHERE patientunitstayid = 10031404 AND drgcode = '035' AND startoffset >= 02/2100 AND endoffset <= 02/2100
8146ea91c180f5ff5edacc7d,"When did patient 10026354 have the maximum value of sodium, whole blood last in 10/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],"SELECT MAX(sodium_whole_blood) AS max_sodium, visit_start_date FROM labevents JOIN visits ON labevents.visit_id = visits.visit_id WHERE labevents.person_id = 10026354 AND labevents.itemid = 50912 AND YEAR(visit_start_date) = 2100 AND MONTH(visit_start_date) = 10"
ce4f4d6348cd296c4415f38c,When did patient 10000032 receive a mrsa screen microbiology test for the first time since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(date) AS FirstMRSA_Screen_Date FROM microbiology_tests WHERE patient_id = 10000032 AND test_type = 'mrsa screen' AND date >= '03/2100';
eb91c0a8a1e1ee146a155b80,"In 05/2100, when did patient 10007795 first get prescribed iso-osmotic dextrose and 5% dextrose at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic dextrose' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT MIN(prescription_time) AS first_prescription_time FROM prescriptions WHERE patient_id = 10007795 AND (medication_name = 'iso-osmotic dextrose' OR medication_name = '5% dextrose') AND YEAR(prescription_date) = 2100 AND MONTH(prescription_date) = 5 GROUP BY patient_id HAVING COUNT(DISTINCT medication_name) = 2
2aa05532775a51572241041f,Tell me the minimum total cost of a hospital that contains patient room in hospital as the place of occurrence of the external cause?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'patient room in hospital as the place of occurrence of the external cause' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT MIN(total_cost) FROM hospital_table WHERE place_of_occurrence = 'patient room in hospital' AND external_cause IS NOT NULL
be83182a8a89eceb013c4764,What was the name of the organism in the first sputum microbiology test of patient 10009049 on the first hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],select top 1 [Organism
0a91b31731530c53ab09872e,"What is the minimum total cost of the hospital encounters that involve a procedure named destruction of right main bronchus, via natural or artificial opening endoscopic since 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_cost) FROM [hospital encounter
e6f3a62b65568a7ae075f4d2,List the five most frequent specimens that were tested since 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]","SELECT specimen_name, COUNT(*) as test_count FROM specimens_tests WHERE test_year >= 2100 GROUP BY specimen_name ORDER BY test_count DESC LIMIT 5"
6d09ba5be77b8bf9cc8b08a8,Tell me the total volume of input for patient 10005817 since 04/03/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-03'",[{'SUM(inputevents.totalamount)': 166435.0}],SELECT SUM(input_volume) AS TotalInputVolume FROM patient_records WHERE patient_id = '10005817' AND date >= '04/03/2100';
4a52128ae4a63ad0dc8d6410,What are the top three diagnoses associated with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",,"[SELECT diagnosis, COUNT(*) AS count"
c91e6629b913e405efe9b9e5,"How many patients received dilation of left common iliac vein with intraluminal device, percutaneous approach treatment within 2 months after having been diagnosed with accidental puncture and laceration of a circulatory system organ or structure during a circulatory system procedure since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental puncture and laceration of a circulatory system organ or structure during a circulatory system procedure' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT COUNT(*) FROM treatment_table WHERE treatment_type = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' AND treatment_date BETWEEN DATE_ADD(diagnosis_date, INTERVAL 2 MONTH) AND (SELECT MAX(treatment_date) FROM treatment_table WHERE procedure_type = 'accidental puncture and laceration of a circulatory system organ or structure during a circulatory system procedure' AND procedure_date >= '2100-01-01') AND diagnosis_date >= (SELECT procedure_date FROM procedure_table WHERE procedure_type = 'accidental puncture and laceration of a circulatory system organ or structure during a circulatory system procedure' AND procedure_date >= '2100-01-01')"
0dcdf1950d75981036938d0f,The value of hyaline casts of patient 10038992 was last measured on the last hospital visit less than first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",select value from laboratory_records where patient_id = 10038992 and measurement_type = 'hyaline casts' order by visit_date desc limit 1
297288464d61d257567d25a2,What are the new medications prescribed to patient 10018081 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT p2.medication AS new_medication FROM prescriptions p1 LEFT JOIN prescriptions p2 ON p1.patient_id = p2.patient_id AND p2.date_prescribed = CURDATE() WHERE p1.patient_id = 10018081 AND p1.date_prescribed = CURDATE() - INTERVAL 1 DAY AND p2.medication IS NOT NULL AND p2.medication NOT IN (SELECT medication FROM prescriptions WHERE patient_id = 10018081 AND date_prescribed = CURDATE() - INTERVAL 1 DAY)
c3627e6abec2c90a0651a0e7,"Tell me the top three most commonly prescribed medications within the same hospital visit to patients in their 50s who were diagnosed with chronic obstructive pulmonary disease, unspecified since 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic obstructive pulmonary disease, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"[SELECT medication, COUNT(*) AS prescription_count FROM prescriptions"
daf529dca91ee00e8da51d58,What were the three most common tests conducted on specimens throughout this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",[],Your SQL query goes here
e8f80475c0b36304390859e0,Tell me the number of patients who stayed in coronary care unit (ccu) since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'coronary care unit (ccu)' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS number_of_patients FROM patients WHERE unit = 'CCU' AND admission_time >= '21:00:00';
e741a395203aabb321b46310,What was the drug that was prescribed to patient 10016150 for the last time in 05/this year via the po route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 drug_name FROM prescriptions WHERE patient_id = 10016150 AND date_prescribed >= '2023-05-01' AND date_prescribed <= '2023-05-31' AND route = 'PO' ORDER BY date_prescribed DESC
b1ee8ce4305d98f2883b695b,"How many patients were diagnosed in 2100 with intestinal infection due to other organism, not elsewhere classified?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to other organism, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )",,SQL Query
05334e2bb5ed306293d184c4,Provide the top four most frequent diagnoses that patients were assigned within 2 months after receiving excision of other bile duct.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT Diagnosis, COUNT(Diagnosis) AS DiagnosisCount FROM medical_records WHERE Procedure = 'excision of other bile duct' AND DiagnosisDate BETWEEN ProcedureDate AND DATE_ADD(ProcedureDate, INTERVAL 2 MONTH) GROUP BY Diagnosis ORDER BY DiagnosisCount DESC LIMIT 4;"
fee1526403313e5913e5874b,How many other ascites patients since 1 year ago were diagnosed in the same hospital encounter after being diagnosed with posttraumatic stress disorder?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'posttraumatic stress disorder' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ascites' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,"SELECT COUNT(*) FROM patients WHERE diagnosis = 'posttraumatic stress disorder' AND encounter_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW() AND hospital_encounter = 'same' AND additional_diagnosis = 'ascites'"
33c954c2cec837a4ccd734f7,What was the total output that patient 10014354 had since 07/09/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-09'",[{'SUM(outputevents.value)': 26195.0}],select sum(output) as total_output from output_records where patient_id = 10014354 and date >= '2100-09-07'
c189d34efcb37085fa7b7cb4,What was the number of patients who were prescribed click change <--- to choose a base solution in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'click change <--- to choose a base solution' AND strftime('%Y',prescriptions.starttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patients WHERE prescribed_solution = 'click change' AND year = 2100
8c1904ba5ce5733337e19e75,Can you report the first heart rate for patient 10018845?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT `HR` AS `Heart_Rate` FROM `hr` WHERE `subject_id` = '10018845' ORDER BY `t` ASC LIMIT 1;
3e2742de9d17a14d3e82aa41,What are the newly prescribed medicines for patient 10004733 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],[SELECT DISTINCT med_name
b2690f1d201d900a6e245a5a,Tell me what the top three most commonly prescribed drugs are?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]","[SELECT TOP 3 DrugName, COUNT(*) AS PrescriptionCount"
5d0429ce6caa78a35b8b997e,Tell me the id of the ward where patient 55281 can be admitted?,,,SELECT ward_id FROM admissions WHERE patient_id = 55281 LIMIT 1;
18f859e690e5c53434768ab0,What diagnosis did patient 10031757 receive in 2100 for the first time?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",,SELECT diagnosis FROM patient_records WHERE patient_id = '10031757' AND diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' ORDER BY diagnosis_date ASC LIMIT 1
5edb9312f6f7f742fcdce8fc,Has patient 10014078 had a lab test done since 03/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'",[{'COUNT(*)>0': 1}],SELECT * FROM lab_results WHERE patient_id = '10014078' AND test_date > '03-21-2000'
1d938ae21a7a7d593616d380,Can you tell me the total volume of chest tube #1 output for patient 10035185 since 04/17/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'chest tube #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-17'",[{'SUM(outputevents.value)': None}],SELECT SUM(volume) FROM patient_data WHERE patient_id = '10035185' AND date >= '04/17/2100' AND tube_number = 1
be826cd58248f2874aea7651,Tell me the length of stay in days of patient 10016810's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.488912038039416}]",
1a5433aa4aa1b3959ef3e77f,Which are the four most common specimens tested?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]",SQL Query Here
4981e0855f969f301153a2e2,What was the number of patients that were given a protein test since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND strftime('%Y',labevents.charttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(patient_id) FROM test_results WHERE test_type = 'protein' AND test_date >= '2100-01-01'
169bc0cd29c8abe63a931a22,What was the name of the drug that was first prescribed to patient 10020306 through the iv route last month?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime ASC LIMIT 1",[],"SELECT drug_name FROM prescriptions WHERE patient_id = '10020306' AND route = 'iv' AND prescription_date BETWEEN DATE_FORMAT(CURDATE() - INTERVAL 1 MONTH, '%Y-%m-01') AND LAST_DAY(CURDATE() - INTERVAL 1 MONTH) ORDER BY prescription_date DESC LIMIT 1"
6fae636a877faa698dbc3148,"This year, how many patients were provided with lidocaine 5% patch?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lidocaine 5% patch' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"select count(distinct patid) from (select patid, date, sum(doseunit) as total from (select patid, date, case when drugname='lidocaine 5%' and form='patch' then doseunit else 0 end as doseunit from drugexposure) group by patid, date having total>0) group by date"
4f2d444fc44c6244f4d959c7,Tell me the top four most commonly prescribed drugs in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4",[],"SELECT drug_name, COUNT(*) AS prescription_count FROM prescriptions WHERE year = 2100 GROUP BY drug_name ORDER BY prescription_count DESC LIMIT 4"
24273ce507fa41634f03e1bd,How much is the price for acetazolamide?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide' ),,SQL Query
ffe1a02ee978769dd4f4e53d,When did patient 10004733 get their last input on 12/24/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-24' ORDER BY inputevents.starttime DESC LIMIT 1",[],SELECT date FROM patient_inputs WHERE patient_id = '10004733' AND input_date = '2100-12-24' ORDER BY date DESC LIMIT 1
a3dd56dec5262895f50e89b7,How many hours have elapsed since the first time on this hospital stay patient 10021487 received a lab test for basophils?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT DATEDIFF(HOUR, MIN(lab_date), CURRENT_TIMESTAMP) as Hours_Elapsed FROM lab_tests WHERE patient_id = 10021487 AND test_type = 'basophils' GROUP BY patient_id;"
3c937ae915d99a3eb8b08241,How many patients were staying in neuro stepdown since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM admissions WHERE unit_name = 'neuro stepdown' AND admission_time > '2100'::time;
21a3e839651e25cd7da1dac9,Has patient 10021938 received any surgery since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT * FROM surgeries WHERE patient_id = 10021938 AND date >= '2100-01-01'
fd514da0acdf2220eacb5f1f,What was the name of the insurance used for patient 10001217 in their first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],SELECT insurance_name FROM hospital_encounters WHERE patient_id = '10001217' AND encounter_number = 1
c1bede41699794dd619feb6b,What's the price of a procedure referred to as other electric countershock of heart?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) ),,SELECT ...
040d18e997bb872c3314ccba,Tell me what was patient 10008454's monthly minimum weight since 2 months ago?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-2 month') GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"select date_trunc('month', observation_datetime) as month, min(weight) as min_weight from ehr.lab_observation where person_id = 10008454 and observation_datetime >= now() - interval '2 months' group by month order by month"
8d73f28463798e2fa6a31b3a,What was the last time patient 10016742 has had the maximum respiratory rate?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],SQL Query Here
c4eba636bd543d4b237a1e3c,What was the dose of pseudoephedrine that in 11/2100 patient 10026354 was first prescribed?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND prescriptions.drug = 'pseudoephedrine' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT dose FROM PseudoephedrinePrescriptions WHERE patient_id = 10026354 AND date = (SELECT MIN(date) FROM PseudoephedrinePrescriptions WHERE patient_id = 10026354) AND month = 11 AND day = 2100
f86dbfb605a8cf22c7785807,What was the total amount of glucagon that they prescribed to patient 10015931 since 05/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug = 'glucagon' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'",[{'SUM(prescriptions.dose_val_rx)': None}],"select sum(prescribed_amount) as ""total glucagon prescribed"" from prescriptions where patient_id = '10015931' and drug_name = 'glucagon' and order_date >= '05/2100'"
239fa629d1e7317b24ec198e,What is the cost for the drug duloxetine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'duloxetine' ),,SELECT cost FROM drug_costs WHERE drug_name = 'duloxetine'
fc608735d9ab6fc5bd43a04c,What is the average total cost for the hospital when a triiodothyronine (t3) lab test is involved since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triiodothyronine (t3)' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_cost) FROM patient_records WHERE lab_tests LIKE '%triiodothyronine%' AND visit_date >= '2100-01-01';
a62df61b51406f3e15d17418,Tell me the name of the first specimen test patient 10021938 had received on their last hospital encounter.,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}],SELECT TOP 1 d.name FROM specimendetail d JOIN encounter e ON d.encounter_id=e.encounter_id JOIN patient p ON e.patient_id=p.patient_id WHERE p.patient_id='10021938' AND e.encounter_type_id=OUTPATIENT AND e.encounter_datetime = (SELECT MAX(encounter_datetime) FROM encounter WHERE patient_id='10021938') ORDER BY d.specimen_datetime ASC
b88f292ca552b0ea6d9929d1,"During the last hospital visit, did patient 10037861 receive a right heart cardiac catheterization treatment?",SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],"SELECT ""Right Heart Catheterization"" AS Treatment, COUNT(*) AS Occurrences FROM `PatientVisits` WHERE `PatientID` = 10037861 AND ""Right Heart Catheterization"" IS NOT NULL AND VisitDate = (SELECT MAX(VisitDate) FROM `PatientVisits` WHERE `PatientID` = 10037861)"
03b4e3ee9ffa442c8b1b6f34,"What was the drug that was prescribed to patient 10002495 within the same day after the measurement of cardiac sampling and pressure, right heart, percutaneous approach in 06/this year?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, right heart, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,select d.drug from procedure p join drug d on p.drug_id = d.id where p.patient_id = 10002495 and p.date = (select date from cardiac_measurement where patient_id = 10002495 and date = (select max(date) from cardiac_measurement where patient_id = 10002495 and date like '2023-06%'))
b711a8c66ded68ed4cd6199c,What are the total average expenses for a hospital involving a laboratory test for oxygen since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,[SELECT SUM(`Total Expenses`) / COUNT(DISTINCT `Hospital Name`) AS `Average Expenses`
b4ca4b338d97b7278100eed6,When was the last time when patient 10026354 was prescribed iso-osmotic sodium chloride and 0.9% sodium chloride (mini bag plus) at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'iso-osmotic sodium chloride' AND admissions.subject_id = 10026354 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride (mini bag plus)' AND admissions.subject_id = 10026354 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = 10026354 AND ((drug_name = 'iso-osmotic sodium chloride' AND drug_name2 = '0.9% sodium chloride (mini bag plus)') OR (drug_name = '0.9% sodium chloride (mini bag plus)' AND drug_name2 = 'iso-osmotic sodium chloride'))
0ba53e15e28cc6c41c12f29b,When and where are the rounds and procedures of dr. canpos?,,,"SELECT date, location FROM rounds_and_procedures WHERE doctor_name = 'dr. canpos'"
a410edd0be9764d12a841458,Has patient 52018 an appointment at the other department?,,,SELECT EXISTS (SELECT 1 FROM appointment WHERE patient_id = 52018 AND department != 'current_department')
f599a974b9f48dd1b8bee774,"Since 1 year ago, has patient 10020187 been in an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 0}],"SELECT * FROM encounters WHERE patient_id = 10020187 AND type = 'ER' AND encounter_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
bccd2741d2ab3570194f6bc7,What was the name of the medication that patient 10016150 was last prescribed?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[{'drug': 'Aspirin'}],select distinct medication_name from prescriptions where patient_id = 10016150 order by prescription_date desc limit 1;
84e5d95551d30c43dcfd59af,Did patient 10015860 receive a other skin graft to other sites treatment during their last hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other skin graft to other sites' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],select * from `condition_occurrence` where person_id=10015860 and condition_concept_id=4032109 and visit_occurrence_id=(select max(visit_occurrence_id) from visit_occurrence where person_id=10015860)
d7cb00a4818527abbd869e4f,What is the minimum total hospital cost that involved fluoroscopy of multiple coronary arteries using other contrast procedure since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,procedures_and_hcpcs_procedure_summary_claims
0688645b190580e5eaf4bad5,How many operating rooms are available now?,,,SELECT COUNT(*) AS available_operating_rooms FROM OperatingRooms WHERE status='available';
190982f3687093b621a95f14,"What's the cost to get drainage of pericardial cavity, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity, percutaneous approach' ) )",,"SELECT charge_amount FROM medical_procedure_table WHERE procedure_name = 'Drainage of Pericardial Cavity, Percutaneous Approach'"
f65af6870b5d460f82233782,Could you inform me the total output amount of patient 10022281 since 06/03/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-03'",[{'SUM(outputevents.value)': 2332.0}],SELECT SUM(quantity) FROM dispensing WHERE person_id = 10022281 AND dispense_date >= '2100-06-03'
3105970deb871dbf0e604cb4,What is the cost of the drug named mirtazapine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'mirtazapine' ),,select cost from drug where drug_name = 'mirtazapine'
2d36357172aa4aae8c662e86,"What are the costs of other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure diagnosis?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other surgical procedures as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) )",,"SELECT 'Cost' FROM 'table_name' WHERE 'Surgical Procedure' IN ('Procedure1', 'Procedure2', ...) AND 'Complication' = 'Abnormal Reaction' OR 'Complication' = 'Later Complication' AND 'Misadventure' = 'Not Mentioned';"
fc919be1cf3be39f5788b8c3,Can you tell me when the first lymphocytes test of patient 10007795 was conducted in 04/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1",[],
66c9f492519459a4e0775016,What was the output patient 10007818 had on 07/15/this year on the last occasion?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '07-15' ORDER BY outputevents.charttime DESC LIMIT 1 )",[],select * from lab_results where patient_id=10007818 and result_date=(select max(result_date) from lab_results where patient_id=10007818 and result_date like '2023-07-15%') order by result_date desc limit 1
6562f562696c0b8ddfd04a29,"Since 1 year ago, has patient 10001217 been at the emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 0}],select count(*) from emergency_room_visits where patient_id = 10001217 and visit_date >= '2022-03-21'
ae413e6191c531e7f585a405,Has patient 10021312 been provided any medications since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 1}],SELECT Medications.MedicationName FROM Medications JOIN Patients ON Medications.PatientID = Patients.PatientID WHERE Patients.PatientID = '10021312' AND Medications.DatePrescribed >= '2100-01-01'
9a53dfd94198f8a68458fa6d,What were the top four most common lab tests done since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT lab_test, count(*) AS test_count FROM lab_tests WHERE date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) GROUP BY lab_test ORDER BY test_count DESC LIMIT 4"
8f5e6c6df7b4307eb679bfd9,Could you list the five most common specimen tests carried out throughout this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],"[SELECT TOP 5 Test_Name, COUNT(Test_Name) AS Test_Count"
1e114a0ca464f5bf590ace7d,Do you think patient 24132 is subject to covid-19 testing?,,,"SELECT patient_id, covid19_test FROM patient WHERE patient_id = 24132"
e1a987c52eaba2b8697dbc00,What was the first time in 04/this year patient 10012853 was prescribed a medication via the po route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(medication_start_date) FROM prescriptions WHERE patient_id = '10012853' AND medication_route = 'PO' AND YEAR(medication_start_date) = YEAR(CURRENT_DATE) AND MONTH(medication_start_date) = 4
753481148eded16306edf567,What is the ward identification of patient 15968 able to be admitted to?,,,SELECT ward_id FROM patient_ward WHERE patient_id = 15968;
94401d1b08ae71f5ad65ac7b,What was patient 10020944's total volume of output on 03/10/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-10'",[{'SUM(outputevents.value)': None}],SELECT SUM(volume) AS total_volume FROM patient_output WHERE patient_id = 10020944 AND date = '03/10/2100';
9460f94a4daa58493e8ebbed,What was patient 10020786's first tested culture in 07/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],select first_tested_culture from table where patient_id = 10020786 and test_date >= '07/01/2100' and test_date <= '07/31/2100' order by test_date asc limit 1
18d6cbfdf913f50a3617e481,"What is patient 10029291's difference in fibrinogen, functional from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT (fibrinogen_last - fibrinogen_first) as fibrinogen_difference FROM (SELECT fibrinogen AS fibrinogen_last, LAG(fibrinogen) OVER (PARTITION BY patient_id ORDER BY visit_date) AS fibrinogen_first FROM hospital_visits WHERE patient_id = '10029291' AND visit_type = 'first' ORDER BY visit_date DESC LIMIT 2) as subquery WHERE fibrinogen_first IS NOT NULL"
99fccf1659e27afc7dd17ad2,Tell me the amount of total foley that patient 10010471 had since 03/08/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-08'",[{'SUM(outputevents.value)': None}],SELECT SUM(amount) AS total_foley_amount FROM foley WHERE patient_id = '10010471' AND date >= '03/08/2100'
f53ea28051ef658c6e955c6f,What percentile is 32.9 on a hematocrit test among patients of the same age as patient 10029291 on the first hospital stay?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 32.9",,select percent_rank() over (order by hct) as percentile from (select hct from labevents where itemid = 50868 and subject_id = (select subject_id from labevents where itemid = 50868 and hadm_id = (select hadm_id from labevents where itemid = 50868 and subject_id = 10029291 and value = 32.9) limit 1) order by hct) where value = 32.9 limit 1
2e302933ba1ba62f25b09b46,Calculate the number of prescribed drugs for patient 10022880 since 19 months ago.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-19 month')",[{'COUNT(*)': 63}],"SELECT count(distinct(drug_name)) as `Number of Prescribed Drugs` FROM `claims` WHERE `patient_id` = '10022880' AND `date_of_service` >= DATE_SUB(CURDATE(), INTERVAL 19 MONTH)"
b2a5c5b1233bd06110dd5253,"Since 2100, what was the top four most frequent diagnoses patients were diagnosed with within 2 months after receiving excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 diagnosis, COUNT(*) AS frequency FROM diagnoses WHERE procedure_code = 'excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic' AND date BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY diagnosis ORDER BY frequency DESC"
893c2935450c5d908b4a566a,What is the procedure that patient 10007818 received two times?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,select procedure from procedure_log where patient_id = 10007818 group by procedure having count(*) = 2
d0b77b1523060bc5563a0484,Tell me the five most common microbiology tests for patients who were previously diagnosed with coronary atherosclerosis of autologous vein bypass graft in the same month in 2100.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"SELECT test_name, COUNT(*) AS test_count FROM microbiology_tests WHERE patient_diagnosis = 'coronary atherosclerosis of autologous vein bypass graft' AND YEAR(test_date) = 2100 AND MONTH(test_date) = MONTH(diagnosis_date) GROUP BY test_name ORDER BY test_count DESC LIMIT 5"
9def26468b7d6f3093845934,"What is the cost of dislocation of jaw, initial encounter diagnostic?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dislocation of jaw, initial encounter' ) )",,select cost from medical_codes where diagnosis='dislocation of jaw' and encounter_type='initial' and code_type='diagnostic'
7d2d2036da24495b7017dd89,"What is the total number of days that have passed since patient 10021487's first potassium, whole blood lab test in their current hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT DATEDIFF(day, MIN(lab_result_date), GETDATE()) AS total_days_since_first_test FROM lab_results WHERE patient_id = '10021487' AND lab_name = 'potassium, whole blood' AND visit_occurrence_id = (SELECT visit_occurrence_id FROM lab_results WHERE patient_id = '10021487' ORDER BY visit_occurrence_id DESC LIMIT 1) GROUP BY patient_id, visit_occurrence_id"
909967a65d2b569fddd45064,"In 2100, how many medications were prescribed to patient 10004733?","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) AS 'Total Prescriptions' FROM Prescriptions WHERE Year = 2100 AND Patient_ID = '10004733';
03126bd2f49e133b299a8f4d,How many times was olanzapine prescribed since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'olanzapine' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 1}],SQL query to be generated
1108d7271243b64d3250ee9e,Has patient 10000032 gone through any procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT * FROM `procedure` WHERE `patient_id` = '10000032' AND `date` >= '2100-01-01'
a1b5fd9738bdb0ab96eb89a9,What was the medication that patient 10004733 was prescribed for during the same day after receiving enteral infusion of concentrated nutritional substances since 05/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,"select distinct m.medication, m.date from medication m where m.patient_id = 10004733 and m.date > (select date from enteral_infusion where patient_id = 10004733 and product = 'concentrated nutritional substances' and time = '05/2100')"
04195370f600639421b6233c,Was there a enteral infusion of concentrated nutritional substances procedure performed on patient 10003046 on the first hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM Procedures WHERE patient_id = '10003046' AND procedure_name = 'Enteral Infusion of Concentrated Nutritional Substances' AND encounter_number = 1
b0dd61356a38fe4d8c8eda84,What are the newly prescribed drugs for patient 10004733 today compared to those prescribed yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT DISTINCT d1.drug_name FROM prescription AS p1 JOIN drug AS d1 ON p1.drug_id = d1.id JOIN prescription AS p2 ON p1.patient_id = p2.patient_id AND p1.drug_id != p2.drug_id JOIN drug AS d2 ON p2.drug_id = d2.id WHERE p1.patient_id = 10004733 AND p1.prescription_date = CURRENT_DATE AND p2.prescription_date = CURRENT_DATE - INTERVAL '1 day' AND NOT EXISTS (SELECT 1 FROM prescription AS p3 JOIN drug AS d3 ON p3.drug_id = d3.id WHERE p3.patient_id = p1.patient_id AND p3.prescription_date = CURRENT_DATE - INTERVAL '1 day' AND d1.drug_name = d3.drug_name)
837a8f55375dcee9e103dbce,Has patient 10021118 been prescribed any prescription drugs throughout this year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT * FROM prescription_drug_events WHERE patient_id = '10021118' AND event_date >= '2023-01-01' AND event_date <= '2023-12-31'
7234f29b92615d05cfbde52f,When did patient 10036156 receive an input for the first time in their first ICU visit?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime ASC LIMIT 1,[{'starttime': '2157-07-01 05:00:00'}],SELECT MIN(input_time) FROM input_events WHERE patient_id = 10036156 AND visit_id IN (SELECT visit_id FROM admissions WHERE patient_id = 10036156 ORDER BY admission_time ASC LIMIT 1)
bbd60fbc1489752c6364f8bf,"On their last ICU visit, what was the last arterial blood pressure mean value of patient 10038933?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT MAX(mean_value) FROM `physionet-data.mimiciii.patients` WHERE `patientunitstayid` = 10038933 AND `itemid` = 220051
f4d15c6e05db8c46f07c865f,Give me the count of patients who were prescribed polyethylene glycol last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'polyethylene glycol' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS patient_count FROM prescriptions WHERE medication_name = 'Polyethylene Glycol' AND DATE_PART('year', prescription_date) = DATE_PART('year', CURRENT_DATE) - 1"
1c5f16182f446c154f204081,"When, , was the first time patient 10031404 was prescribed a medication via the iv route?",SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(MedicationOrder.OrderDateTime) FROM MedicationOrder JOIN MedicationRoute ON MedicationOrder.RouteId = MedicationRoute.RouteId JOIN Patient ON MedicationOrder.PatientId = Patient.PatientId WHERE Patient.PatientId = 10031404 AND MedicationRoute.RouteDescription = 'IV'
c123e03a1725cd7b860dadff,Tell me what was patient 10021487's daily minimum weight since 18 months ago?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-18 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"select distinct date, min(weight) from `physionet-data.mimiciv_clinical.measurement` where subject_id = 10021487 and itemid = 451 and date > (select date(max) from `physionet-data.mimiciv_clinical.patients`) - interval 18 month"
781463ec4654dbff8c5df153,Did patient 10002930 have any prescriptions for medicines in their last hospital visit?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM prescriptions WHERE patient_id = '10002930' AND visit_date = (SELECT MAX(visit_date) FROM visits WHERE patient_id = '10002930')
f7c14865b950690588b06349,List the top five most frequent events occurring since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT event_name, COUNT(*) as frequency FROM events WHERE year >= 2100 GROUP BY event_name ORDER BY frequency DESC LIMIT 5"
9dfc1f05e2a00f866e5a96b6,Does patient 31880 have a history of late effect acute polio in his/her family?,,,SELECT has_history_of_late_effect_acute_polio FROM Family_History WHERE patient_id = 31880
c7a759042b7285ebd4faf3f8,"What were the five most frequently diagnosed microbiology tests for patients who were diagnosed with cardiac arrest due to underlying cardiac condition before in the same hospital visit, in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac arrest due to underlying cardiac condition' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,SQL Query
dc56faa6ef9caadfd8ca6880,What is the number of ICU visits for patient 10025612 in 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND strftime('%Y',icustays.intime) = '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 0}],SELECT COUNT(visit_id) FROM icu_stays WHERE patient_id = 10025612 AND year_of_visit = 2100
a6fe11704f68e1f821cfc45e,Count the number of people who were diagnosed with postprocedural heart failure following other surgery since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural heart failure following other surgery' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,SELECT COUNT(*) FROM medical_records WHERE diagnosis = 'postprocedural heart failure following other surgery' AND year >= 2100
82497b82db1a47d9940db063,Can you tell me when the last asparate aminotransferase (ast) test of patient 10015272 was conducted in 06/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT MAX(test_date) AS last_test_date FROM patient_tests WHERE patient_id = '10015272' AND test_name = 'asparate aminotransferase (ast)' AND EXTRACT(MONTH FROM test_date) = 6 AND EXTRACT(YEAR FROM test_date) = EXTRACT(YEAR FROM CURRENT_DATE);
61f9f600cf87c85106cb2efd,"Has patient 10007795 got a prescription for acetaminophen, pregabalin, or pantoprazole in 04/last year?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.drug IN ( 'acetaminophen', 'pregabalin', 'pantoprazole' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)>0': 0}],"SELECT DISTINCT patient_id, medication_name FROM prescriptions WHERE patient_id = 10007795 AND (medication_name = 'acetaminophen' OR medication_name = 'pregabalin' OR medication_name = 'pantoprazole') AND prescription_date BETWEEN 'YYYY-04-01' AND 'YYYY-04-30'"
77238633972ba57331af47e1,What was the total amount of ciprofloxacin 0.3% ophth soln that patient 10026354 has been prescribed since 10/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND prescriptions.drug = 'ciprofloxacin 0.3% ophth soln' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(quantity) FROM prescriptions WHERE drug_name = 'ciprofloxacin 0.3% ophth soln' AND patient_id = '10026354' AND date_prescribed >= '2010-10-01'
11c5ddc438e48b537cf7d477,When did patient 10000032 last get prescribed lactulose and fluticasone propionate 110mcg at the same time in 08/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactulose' AND admissions.subject_id = 10000032 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'fluticasone propionate 110mcg' AND admissions.subject_id = 10000032 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(visit_date) FROM (SELECT visit_date FROM visits WHERE patient_id = 10000032 AND (drug = 'lactulose' OR drug = 'fluticasone propionate 110mcg') AND visit_date BETWEEN '2100-08-01' AND '2100-08-31' GROUP BY visit_date HAVING COUNT(DISTINCT drug) = 2) AS subquery
3fa2f28fcf723a8ae5b496cd,What is patient 10001217's SaO2 change measured at 2100-12-05 21:00:00 compared to the value measured at 2100-12-05 20:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-05 21:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-05 20:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-05 21:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-05 20:00:00' )"": None}]",SELECT (B.SaO2 - A.SaO2) AS SaO2_change FROM patient_observations A JOIN patient_observations B ON A.patient_id = B.patient_id WHERE A.patient_id = '10001217' AND A.observation_datetime = '2100-12-05 20:00:00' AND B.observation_datetime = '2100-12-05 21:00:00' AND A.parameter = 'SaO2' AND B.parameter = 'SaO2'
6c4b2c8d659fcb229d747557,Is patient 32168 in the family of a person with react-indwell urin cath?,,,SELECT * FROM patient_records WHERE patient_id = 32168 AND family_member_id IN (SELECT person_id FROM medical_conditions WHERE condition = 'react-indwell urin cath')
48a6844f3ba6022354e2d189,What steps should i take before the drsl/dslmb fus post/post procedure?,,,select distinct a.step_name from drsl_dslmb_procedure a where a.step_order between (select step_order from drsl_dslmb_procedure where step_name='fus post') and (select step_order from drsl_dslmb_procedure where step_name='post procedure')
67a50aa49b80a0cadb830e34,What precautions should i take after a exploratory laparotomy procedure?,,,select precautions from postoperative_care where procedure = 'exploratory laparotomy'
d939b033b5e6b326580d0570,How many hours have passed since patient 10004733 had the last pt lab test in their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MAX(PtLab.TestDate), NOW()) AS HoursSinceLastTest FROM PtLab WHERE PtLab.PatientID = 10004733 AND PtLab.VisitID = (SELECT MAX(VisitID) FROM PtLab WHERE PtLab.PatientID = 10004733)"
6ddb92afc3aeb9e8294f6e45,"Tell me the name of the drug patient 10021312 was prescribed in the same hospital encounter after having received a excision of left main bronchus, via natural or artificial opening endoscopic procedure since 04/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"select distinct p.drug_name from patient_encounter pe, procedure pr, drug_prescribed p where pe.patient_id = 10021312 and pe.encounter_id = pr.encounter_id and pr.procedure_name = 'Excision of left main bronchus, via natural or artificial opening endoscopic' and pr.date > '04/2100' and pe.encounter_id = p.encounter_id and pr.encounter_id > (select encounter_id from procedure where procedure_name = 'Excision of left main bronchus, via natural or artificial opening endoscopic' and patient_encounter_id = 10021312 and date > '04/2100' order by date asc limit 1) order by p.date desc limit 1"
243503fcb552e825a3b62d0c,Is the patient 10018423 a male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10018423,[{'gender': 'M'}],SELECT gender FROM patients WHERE patient_id = 10018423
54234a211c3fb7360ae4e161,What amount of fish oil (omega 3) has been prescribed to patient 10004457 for the last time during their last hospital encounter?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'fish oil (omega 3)' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT prescription_quantity FROM prescriptions WHERE patient_id = 10004457 AND drug_name = 'fish oil (omega 3)' AND encounter_date = (SELECT MAX(encounter_date) FROM encounters WHERE patient_id = 10004457 AND discharge_date IS NOT NULL)
84a492082c7e8112ea7f1544,When was the last time that patient 10037861 was given a specific gravity lab test?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT MAX(TestDate) AS LastTestDate FROM LabTests WHERE PatientID = 10037861 AND TestType = 'Specific Gravity'
0d22269bdd7bfa8481b101b5,What was patient 10005817's total volume of output since 06/04/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-04'",[{'SUM(outputevents.value)': 41303.0}],SELECT SUM(output_volume) FROM patient_output WHERE patient_id = 10005817 AND record_date >= '06/04/2100'
dc8519f946507f8fe299e28d,How many patients left the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) AS patients_left_since_2100 FROM hospital_records WHERE discharge_date >= '2100-01-01'
e973b4ccb6182ec1b934fe53,How much is the maximum total hospital bill when it includes a triiodothyronine (t3) lab test in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triiodothyronine (t3)' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_bill) FROM hospital_data WHERE lab_test = 't3' AND year = 2100
2fd61472c7569c2469bef07e,Has patient 10005348 received a medication prescription since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 1}],SELECT * FROM prescription WHERE patient_id = '10005348' AND prescription_date >= '2100-01-01'
a39005834defa0da659aa0e9,How many ascorbic acid prescriptions occurred in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'ascorbic acid' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SQL Query
74eaa2aea6b2bc5d95b46140,"What was the first time that the SaO2 of patient 10004422 was, on 01/22/this year, less than 96.0?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 96.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '01-22' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(MeasurementDateTime) AS FirstLowSaO2Time FROM PatientData WHERE SubjectID = '10004422' AND MeasurementDateTime BETWEEN '2023-01-22 00:00:00' AND '2023-01-22 23:59:59' AND SaO2 < 96.0
07c7d0b230f28eb2bba883d4,Has patient 10005909 been provided any medications since 11/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'",[{'COUNT(*)>0': 1}],select * from patient_medication where patient_id = 10005909 and medication_date > '11/21/00'
383586ac765d783e5374a6c0,What was the name of the drug that during their first hospital visit patient 10016150 was first prescribed?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Nitroglycerin SL'}],SELECT medication_name FROM prescriptions WHERE patient_id = '10016150' AND visit_number = 1 ORDER BY prescription_date ASC LIMIT 1
754e29dd9545b861d06c17c4,What is the average hospital cost to include a drug called acetylcysteine (iv) during this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine (iv)' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(hospital_cost) FROM tbl_hospital_cost WHERE drug_name = 'Acetylcysteine (IV)' AND year = YEAR(CURDATE())
1dd7881fb93e0f171b1c67dc,"For the last time on the first hospital stay, what was patient 10018423 diagnosed with?",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,SELECT diagnosis FROM patient_diagnoses WHERE patient_id = 10018423 AND hospital_stay_number = (SELECT MAX(hospital_stay_number) FROM patient_diagnoses WHERE patient_id = 10018423) LIMIT 1;
75cb3e513ae45223b3f00a57,When was patient 10022017's first discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[],SELECT MIN(date) FROM patient_discharge_records WHERE patient_id = '10022017'
1429055dfad66664c7bf35fe,"When was the first time the SaO2 of patient 10018081 was greater than 92.0, on 12/29/this year?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 92.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(record_date) FROM (SELECT record_date FROM patient_data WHERE patient_id = 10018081 AND SaO2 > 92.0 AND record_date >= '2023-12-29' AND record_date < '2023-12-30') AS subquery
1f1579d6f5886ce1d80398a0,"In this year, what was the last diagnosis for patient 10012552?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,"select max(date) max_date, code from diagnosis where pid='10012552' group by code order by max_date desc;"
12a5396f55e7c3fd73c0c640,"For patients who undertook drainage of left main bronchus, via natural or artificial opening endoscopic, diagnostic in the same month, what are the top three most frequent specimens tested afterward since 1 year ago?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"SELECT specimen, COUNT(*) AS frequency FROM Procedures WHERE procedure_description LIKE '%drainage of left main bronchus%' AND procedure_type IN ('natural opening', 'artificial opening') AND procedure_purpose = 'diagnostic' AND procedure_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY specimen ORDER BY frequency DESC LIMIT 3;"
924c0d9895d24fb53c79fb4a,"What is the average expense for dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) )",,"SELECT AVG(expense) FROM medical_procedures WHERE procedure_name = ""dilation of right main bronchus with intraluminal device"" AND approach = ""natural or artificial opening endoscopic"";"
fd1fe8945ba7f1d84a6e557a,When was the last discharge time of patient 10020944 from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020944 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(DischargeDate) FROM HospitalDischarges WHERE PatientID = '10020944'
cb605fd1d340ab1ad0afe330,What is the drug to avoid during the exc/dest hrt lesion open.,,,SELECT drug_name FROM contraindications WHERE condition = 'exc/dest hrt lesion open' AND drug_name IS NOT NULL;
8cdcafd00523784d37d8dad5,Which immuno-cancer drugs have been used for the last five years?,,,SQL Query here
f99e58fee0562c646b3dc682,Has any prescriptions been given to patient 10022017 during this year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT EXISTS (SELECT * FROM prescriptions WHERE patient_id = '10022017' AND YEAR(date_prescribed) = YEAR(CURRENT_DATE))
9b6f8be92fbf3a67eba1ac22,What are the five most frequently prescribed drugs during the same hospital encounter to the patients aged 60 or above after they were diagnosed with street and highway accidents in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'street and highway accidents' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,select top 5 prescription.drug from prescription inner join diagnosis on prescription.encounter_id = diagnosis.encounter_id where diagnosis.condition = 'street and highway accidents' and diagnosis.date in (select date from diagnosis where diagnosis.condition = 'street and highway accidents' and diagnosis.age >= 60 and YEAR(diagnosis.date) = 2100) group by prescription.drug order by count(prescription.drug) desc
216744fcbadbfb5384e8c226,What are the top four commonly ordered treatments for patients in their 30s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"select treatment, count(treatment) as order_count from treatment order by order_count desc limit 4"
07bde541ff2932869ecb4912,How many doses of omeprazole have been prescribed to patient 10023117 on the last hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'omeprazole',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT COUNT(*) AS TotalDoses FROM prescriptions WHERE patient_id = 10023117 AND medication_name = 'omeprazole' AND hospital_encounter = (SELECT MAX(encounter_id) FROM hospital_encounters WHERE patient_id = 10023117);
8509828abb4a1380dd44f76c,Did patient 10011398 receive any disease diagnoses during the last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,SELECT * FROM diagnoses WHERE patient_id = 10011398 AND diagnosis_date BETWEEN '2022-03-15' AND '2023-03-15'
470175d0ccd7f8d9a81e4c14,"Has patient 10038999 undergone the drainage of left pleural cavity, percutaneous approach, diagnostic throughout this year?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,select count(*) from `SNOMEDCT_US_PROCEDURES` where `patient_num` = 10038999 and `code` = '365470009' and `year` = year(current_date()) and `code` = '365470009' and `type` = 'D' and `modifier` = 'PR'
52f3a2c6b4d044c06fd15131,What was the name of the specimen test which patient 10000032 has first received since 04/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'URINE'}],SELECT Name FROM SpecimenTest WHERE PatientID = '10000032' ORDER BY DateReceived ASC LIMIT 1
40ee187ccec9edfec26c08d6,When was patient 10007818 prescribed pantoprazole and vial at the same time for the last time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10007818 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vial' AND admissions.subject_id = 10007818 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(date_prescribed) FROM prescriptions WHERE patient_id = 10007818 AND (medication_name = 'pantoprazole' OR medication_name = 'vial') GROUP BY patient_id HAVING COUNT(DISTINCT medication_name) = 2
b594bc62abf53801dd98efe3,Please count the hospital visits made by patient 10012853 in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10012853 AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],select count(*) from `bigquery-public-data.hpo_clinical.cdm_hiv_clinical_patient_visit` where patient_num = 10012853 and visit_start_date between '2100-01-01' and '2100-12-31'
a86aa0f3bbf78e814aab9af4,What is the foley output for patient 10026354 since 03/01/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-01'",[{'SUM(outputevents.value)': None}],SELECT * FROM foley_output WHERE patient_id = 10026354 AND date >= '03/01/2100'
6fb7db09905b3e0b6571bb41,When and where are the rounds and procedures of dr. moore?,,,"SELECT procedure_date, procedure_location FROM patient_records WHERE doctor_name = 'Dr. Moore' AND procedure_status = 'Scheduled'"
54f536c0e9bc497653648fa1,What is the difference between SaO2 last measured on the last ICU visit compared to the first value measured on the last ICU visit for patient 10022041?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT (LAST_VALUE(SaO2) OVER (PARTITION BY patientunitstayid ORDER BY charttime ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) - FIRST_VALUE(SaO2) OVER (PARTITION BY patientunitstayid ORDER BY charttime ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS SaO2_difference FROM icustays JOIN chartevents ON icustays.icustay_id = chartevents.icustay_id WHERE patientunitstayid = (SELECT patientunitstayid FROM icustays WHERE hospitaldischargeoffset = (SELECT MAX(hospitaldischargeoffset) FROM icustays WHERE patientunitstayid IN (SELECT patientunitstayid FROM icustays WHERE patient_id = 10022041)) AND patient_id = 10022041)
1936469b953a861d9b26f745,What's the maximum total hospital cost that involved alcohol detoxification?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT MAX(total_hospital_cost) FROM hospital_stays WHERE services_rendered LIKE '%alcohol detoxification%';
cbcdc4db6f2c0f87986c08eb,"What was the first time that patient 10018501 had a minimum value of calcium, total?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],"SELECT MIN(`Calcium, total`) AS `MinCalcium`, `ObservationDateTime` FROM `LabResults` WHERE `PatientID` = '10018501' ORDER BY `ObservationDateTime` ASC LIMIT 1"
1ece08272edfd635b238cb47,Give me the count of patients who were prescribed nifedipine cr last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nifedipine cr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM prescriptions WHERE medication_name = 'nifedipine cr' AND prescription_date BETWEEN '2022-01-01' AND '2022-12-31';
95bf452438092fdf90c9955f,What was the minimum value of patient 10014729's protein in 03/2100?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",[{'MIN(labevents.valuenum)': None}],SELECT MIN(protein_value) FROM patient_data WHERE patient_id = '10014729' AND protein_date = '03/2100';
1558f54b2c3bec57f2893d4f,What are the three most frequent procedures for patients aged 30s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT Procedure, COUNT(*) as Frequency FROM patients WHERE Age BETWEEN 30 AND 39 GROUP BY Procedure ORDER BY Frequency DESC LIMIT 3"
39a0e7eaffab936c1439a5fa,Is the respiratory rate level of patient 10026406 measured at 2100-01-12 13:00:00 less than measured at 2100-01-12 12:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 13:00:00' ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 12:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 13:00:00' ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-12 12:00:00' )"": None}]",SELECT CASE WHEN (SELECT RespiratoryRate FROM PatientMeasurements WHERE PatientID = 10026406 AND MeasurementTime = '2100-01-12 13:00:00') < (SELECT RespiratoryRate FROM PatientMeasurements WHERE PatientID = 10026406 AND MeasurementTime = '2100-01-12 12:00:00') THEN 'Yes' ELSE 'No' END AS IsRespiratoryRateLess
0063d54603cf0f791a4f2d03,Has patient 10027445 had a right heart cardiac catheterization procedure in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,SELECT ... FROM ... WHERE ...
1ebe06aacc066a61c6d64f52,Has patient 10023117 received any diagnoses since 1 year ago?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')",,SELECT DISTINCT diagnosis FROM medical_records WHERE patient_id = 10023117 AND diagnosis_date > CURRENT_DATE - INTERVAL '1 year'
72f9d3cf5bb88a5d34be8b2e,How many patients were discharged from the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) FROM hospital_discharges WHERE discharge_date > '2100-01-01'
001bd30793469267511dbbbb,What is the price of a diagnosis for sepsis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sepsis' ) ),,SELECT price FROM diagnosis WHERE condition = 'sepsis'
8288ab2fa75b4a191de46940,Tell me the count of the drugs patient 10040025 was prescribed during their first hospital encounter.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)': 28}],SELECT COUNT(DISTINCT drug_name) FROM prescriptions WHERE patient_id = '10040025' AND encounter_id IN (SELECT MIN(encounter_id) FROM encounters WHERE patient_id = '10040025')
11bb6b4e96dfc29737cec768,What was the duration of the circumcision procedure for patient 3277?,,,SELECT duration FROM circumcision_procedures WHERE patient_id = 3277;
045bf7ee10229a2cde7504e7,What kind of immunocancer drugs have been out for the last five years?,,,"SELECT name FROM drugs WHERE drug_class='immunocancer' AND approval_date > DATE_SUB(CURDATE(), INTERVAL 5 YEAR) AND status='available'"
ee344b98a4a7a22b3443b8a1,When was the first time that patient 10014729 has been prescribed ketorolac and sodium bicarbonate at the same time since 16 months ago?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ketorolac' AND admissions.subject_id = 10014729 AND datetime(prescriptions.starttime) >= datetime(current_time,'-16 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10014729 AND datetime(prescriptions.starttime) >= datetime(current_time,'-16 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SQL query
3da43478d4e899fc1b0f0fe3,How is nystatin oral suspension taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nystatin oral suspension',[],SELECT ... FROM ... WHERE ...
f34ae2771a3ae71a42d66a89,What was the first dose of insulin prescribed to patient 10014729 in 03/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND prescriptions.drug = 'insulin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(Dose) as First_Dose FROM Insulin_Prescriptions WHERE Patient_ID = '10014729' AND YEAR(Prescription_Date) = YEAR(CURDATE()) AND MONTH(Prescription_Date) = 3
995e071fb1a801ad2552a7c2,What is the outpatient schedule of dr. brunner today?,,,
bb2aaeceb6f9b4fb421cf918,Tell me the total foley output of patient 10022880 since 04/03/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-03'",[{'SUM(outputevents.value)': None}],
5f697dd690488492bf17ca8e,What were some of the four common specimen tests given since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]",select distinct test_name from specimen_tests where test_date >= '2100-01-01' limit 4
2366c7c9140924ccf9f4b123,How many patients last year left the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL Query
a8ed1315b3325cab2ae9dcee,"Can you provide the name of the drug that was prescribed to patient 10022017 within 2 days post bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach procedure in the last hospital visit?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT drug FROM prescriptions WHERE patient_id = 10022017 AND drug IN (SELECT drug FROM prescriptions WHERE visit_id IN (SELECT visit_id FROM procedures WHERE procedure = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' AND visit_id IN (SELECT MAX(visit_id) AS last_visit FROM procedures GROUP BY patient_id))) AND DATEDIFF(prescription_date, (SELECT procedure_date FROM procedures WHERE procedure = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' AND visit_id = prescriptions.visit_id)) <= 2"
54714e162bde7b10c34ed1c1,"During the first hospital visit, what was patient 10012853's age?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,,SELECT age FROM patient_visits WHERE patient_id = 10012853 AND visit_number = 1
c4c116a340d78cd933a79870,Could you tell me the four most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]","select test, count(test) as test_count from microbiology_tests group by test order by test_count desc limit 4"
4e2be276b6289a600da28a19,"Has patient 10021312 had a inspection of tracheobronchial tree, via natural or artificial opening endoscopic since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,select count(*) from endoscopie_procedure_ep where patient_id = 10021312 and (ep_description ilike '%inspection of tracheobronchial tree%' or ep_description ilike '%inspection of tracheobronchial tree%') and (ep_date > '2100-01-01') and ep_procedure_type = 'ENDOSCOPIE' and ep_access = 'NATURAL OR ARTIFICIAL OPENING ENDOSCOPIC' and ep_endoscopie_type = 'BRONCHOSCOPY'
6d4fb4147666cb3f5be2c8be,Tell me the name of the diagnosis that patient 10009035 received last since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,"SELECT TOP 1 diagnosis_name FROM diagnosis WHERE patient_id = '10009035' AND diagnosis_date > DATEADD(year, -1, GETDATE()) ORDER BY diagnosis_date DESC"
dbb471287262410819ef2986,What were the last red blood cells lab test results for patient 10021118 since 10/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10' ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT result_date, result_value FROM lab_tests WHERE test_type = 'red blood cells' AND patient_id = '10021118' AND result_date >= '10/2100' ORDER BY result_date DESC LIMIT 1"
42450225f8907884075ad901,Provide the top four most common treatments since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT treatment, COUNT(*) as frequency FROM patient_records WHERE treatment_date >= DATE_SUB(NOW(), INTERVAL 1 YEAR) GROUP BY treatment ORDER BY frequency DESC LIMIT 4"
b8c5fe61ece23bbbe04cf389,What's the minimum total cost of the hospital visits that involve a procedure called cardiac mapping throughout this year?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(visit_total_cost) FROM HospitalVisits WHERE procedure_name = 'cardiac mapping' AND visit_date >= '2023-01-01' AND visit_date <= '2023-12-31'
e582763c64c4e8a81b029c81,How much is the drug zolpidem tartrate?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'zolpidem tartrate' ),,"SELECT ""drug_name"", ""drug_cost"" FROM ""drugs"" WHERE ""drug_name"" = 'zolpidem tartrate'"
e0d157e7655d68add3bb76d5,"What is the cost of a diagnosis of surgical operation with anastomosis, bypass, or graft, with natural or artificial tissues used as implant causing abnormal patient reaction, or later complication, without mention of misadventure at time of operation?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'surgical operation with anastomosis, bypass, or graft, with natural or artificial tissues used as implant causing abnormal patient reaction, or later complication, without mention of misadventure at time of operation' ) )",,"SELECT SUM(ProcedureCost) FROM Procedures WHERE ProcedureType IN ('surgical operation with anastomosis', 'bypass', 'graft') AND ImplantType IN ('natural', 'artificial') AND (PatientReaction = 'abnormal' OR Complication = 'later complication') AND Misadventure IS NULL"
6264718a6161659bf85a5b7c,What is the maximum total cost of the hospital encounters that include a medicine named prasugrel since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prasugrel' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT MAX(total_cost) AS maximum_total_cost FROM (SELECT encounter_id, SUM(cost) AS total_cost FROM (SELECT hpo.encounter_id, m.drug_name, e.cost FROM encounters e INNER JOIN medicines m ON e.medicine_id = m.medicine_id INNER JOIN hospital_provider_organization hpo ON e.hpo_id = hpo.hpo_id WHERE m.drug_name = 'prasugrel' AND e.encounter_date >= '2100-01-01') AS prasugrel_encounters GROUP BY encounter_id) AS encounter_costs"
62984005cb4a2bebf693573b,When patient 10029484 first had a mrsa screen microbiology test since 01/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(test_date) as first_mrsa_screen_date FROM microbiology_tests WHERE patient_id = 10029484 AND test_type = 'mrsa screen' AND test_date >= '2100-01-01'
d327924a18220cf4ac6ca8ba,"In 2100, which are the four most frequent lab tests given to patients within the same month after they are diagnosed with personal history of alcoholism?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of alcoholism' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 lab_test_code, COUNT(*) as frequency FROM lab_tests WHERE YEAR(test_date) = 2100 AND test_date <= DATEADD(month, 1, diagnosis_date) AND diagnosis_code = 'personal history of alcoholism' GROUP BY lab_test_code ORDER BY frequency DESC"
f6401e3fea26ee15aed66ec1,Was the lactate reading for patient 10015860 last measured on the first hospital visit less than the value second to last measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT CASE WHEN (SELECT lactate FROM lab_results WHERE subject_id = '10015860' AND visit_id = (SELECT visit_id FROM visits WHERE subject_id = '10015860' AND visit_type = 'Baseline') ORDER BY test_date DESC LIMIT 1 OFFSET 0) < (SELECT lactate FROM lab_results WHERE subject_id = '10015860' AND visit_id = (SELECT visit_id FROM visits WHERE subject_id = '10015860' AND visit_type = 'Baseline') ORDER BY test_date DESC LIMIT 1 OFFSET 1) THEN 'Yes' ELSE 'No' END AS comparison_result FROM dual;
f66542e8f77bde61ef62dc26,"Since 07/2100, has patient 10006053 had any input of dextrose 50%?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-07'",[{'COUNT(*)>0': 0}],SELECT * FROM patient_treatments WHERE patient_id = 10006053 AND treatment_date > '2100-07-01' AND treatment = 'dextrose 50%'
aa9cf98a6cfcfc591fd1d744,What is the maximum yearly number of patients affected by other specified hypotension?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified hypotension' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,"SELECT MAX(yearly_count) AS maximum_yearly_patients FROM ""ConditionEraStats"" WHERE condition_concept_id = 4234256"
50179ff508b40f8259d4eb6e,What was patient 10021666's last tested culture?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'spec_type_desc': 'URINE'}],SELECT TOP 1 Culture FROM PatientCultures WHERE PatientID = '10021666' ORDER BY TestDate DESC;
5d8ba988aeacba3a822c6143,Retrieve the top five most frequent diagnoses of patients with age in their 50s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM patient_records WHERE age BETWEEN 50 AND 59 GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
a2a83e230687e10b793748e7,Was patient 10016150 admitted into the hospital in the previous year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10016150 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],"SELECT * FROM HospitalAdmissions WHERE PatientID = '10016150' AND AdmissionDate >= DATEADD(year, -1, GETDATE()) AND AdmissionDate < GETDATE()"
d8caee9d95e20089a90e7c8c,"During this year, has patient 10007928 been at the emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],"select distinct a.patient_id, a.visit_date from visit a where a.patient_id=10007928 and a.visit_type='ER' and a.visit_date between '2021-01-01' and '2021-12-31'"
8d848bb37c4790115eb54b25,How many patients were in neuro stepdown in the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(patient_id) FROM PatientRecords WHERE admission_type = 'neuro stepdown' AND YEAR(admission_date) = YEAR(CURRENT_DATE) - 1
54258b49d9028f2fcc83e6d8,Tell me the total output since 03/07/2100 for patient 10039997.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07'",[{'SUM(outputevents.value)': 5735.0}],SELECT SUM(output) AS total_output FROM patient_data WHERE patient_id = '10039997' AND date >= '2100-07-03'
8140c1e65784238caf1362ad,Calculate the total number of medications that patient 10007818 was prescribed since 1 year ago.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)': 320}],"SELECT COUNT(*) AS TotalMedications FROM Prescription WHERE PatientID = '10007818' AND PrescriptionDate >= DATEADD(year, -1, GETDATE());"
90029829a3c76198a7de717b,What was the organism's name found in the first urine test of patient 10031757 in 10/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT `Organism Name` FROM `Urine Tests` WHERE `Patient ID` = '10031757' AND `Test Date` = (SELECT MIN(`Test Date`) FROM `Urine Tests` WHERE `Patient ID` = '10031757') LIMIT 1
41b9a346811b51fc23501b6f,What was the first drug prescribed to patient 10037861 via the iv route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT `drug_name` FROM `prescriptions` WHERE `patient_id` = '10037861' AND `route` = 'iv' ORDER BY `prescription_date` ASC LIMIT 1
d668c80dc28d9c4f1a984524,Does patient 73693 have any travel history abroad?,,,SELECT travel_history FROM patient_records WHERE patient_id = '73693' AND destination_country != 'home_country'
118bc51491df8cdec1b69a69,Could you tell me the name of the drug prescribed to patient 10018081 within 2 days after the enteral infusion of concentrated nutritional substances procedure since 09/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-09' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT Prescription.drug_name FROM Prescription WHERE Prescription.patient_id = '10018081' AND Prescription.date BETWEEN (SELECT DATEADD(day, 2, EnteralInfusion.date) FROM EnteralInfusion WHERE EnteralInfusion.patient_id = '10018081' AND EnteralInfusion.procedure_name = 'concentrated nutritional substances' AND EnteralInfusion.date >= '09/2100') AND CURRENT_DATE"
76c552ca9be899eab747b7a3,What is the name of the drug that should not be administered during the spinal canal explor nec treatment?,,,SELECT DrugName FROM Medication WHERE Treatment = 'spinal canal explor nec' AND ShouldNotBeAdministered = 'YES'
a092e1a9ae5251db64ee68be,What's the number of patients who were other nonspecific abnormal finding of lung field diagnosed this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific abnormal finding of lung field' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,SELECT COUNT(*) AS total_other_nonspecific_abnormal_findings FROM radiology_reports WHERE diagnosis = 'Other nonspecific abnormal finding of lung field' AND YEAR(diagnosis_date) = YEAR(CURDATE());
f2becb6d3806bef1b31ac86a,When was the first input time for patient 10008454 on this month/07?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '07' ORDER BY inputevents.starttime ASC LIMIT 1",[],SELECT min(input_time) FROM patient_records WHERE patient_id = 10008454 AND EXTRACT(MONTH FROM input_time) = 7 AND EXTRACT(YEAR FROM input_time) = EXTRACT(YEAR FROM CURRENT_DATE)
d73c8f5b0105e85440aa6baf,What are the maximum yearly number of patients diagnosed with glucocorticoid deficiency since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'glucocorticoid deficiency' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,"SELECT YEAR(diagnosis_date) AS year, MAX(patient_count) AS max_patients FROM (SELECT diagnosis_date, COUNT(*) AS patient_count FROM patient_records WHERE diagnosis = 'glucocorticoid deficiency' AND YEAR(diagnosis_date) >= 2100 GROUP BY YEAR(diagnosis_date), MONTH(diagnosis_date)) AS monthly_counts GROUP BY year"
f22d564ed9f345b78756fe88,"Since 2100, what are the top five most common microbiology tests that patients were diagnosed with within 2 months after being diagnosed with noncompliance with renal dialysis?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"SELECT t.test_name, COUNT(t.test_id) AS test_count FROM microbiology_tests t INNER JOIN patient_tests pt ON t.test_id = pt.test_id INNER JOIN patients p ON pt.patient_id = p.patient_id WHERE pt.test_date BETWEEN DATE_SUB(pt.diagnosis_date, INTERVAL 2 MONTH) AND pt.diagnosis_date AND p.diagnosis = 'noncompliance with renal dialysis' AND pt.test_date >= '2100-01-01' GROUP BY t.test_name ORDER BY test_count DESC LIMIT 5"
49bd4300b2e50aa508c70a40,"For patients who were previously diagnosed with fall resulting in striking against other object, what are the top four most frequent treatments in the same month since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fall resulting in striking against other object' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 treatment, COUNT(treatment) as frequency FROM patient_records WHERE diagnosis = 'fall resulting in striking against other object' AND treatment_date >= DATEADD(year, -1, GETDATE()) GROUP BY treatment ORDER BY frequency DESC"
306cfa6b9fa0c1c51c7dcd49,What new medications were prescribed to patient 10039831 today as compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL Query
670b3cac2ff679b4a4fb429c,"How many patients underwent extirpation of matter from left common iliac vein, percutaneous approach within 2 months after the diagnosis of operating room of hospital as the place of occurrence of the external cause, in the last year?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'operating room of hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left common iliac vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT COUNT(*) AS NumberOfPatients FROM Procedures WHERE procedure_code = 'ExtirpationOfMatterLeftCommonIliacVeinPercutaneous' AND diagnosis_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW() AND procedure_date <= DATE_ADD(diagnosis_date, INTERVAL 2 MONTH) AND procedure_location = 'OperatingRoom' AND place_of_occurrence = 'Hospital'"
46943daaedc4da5c2540a50c,"On 12/29/this year, what was the minimum value of the respiratory rate for patient 10004733?","SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29'",[{'MIN(chartevents.valuenum)': None}],SELECT MIN(respiratory_rate) FROM patient_data WHERE patient_id = '10004733' AND date = '2023-12-29';
a8f5c987ca37c40bc1eac5cc,Could you inform me of the minimum vitamin b12 value for patient 10021666?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ),[{'MIN(labevents.valuenum)': None}],SELECT MIN(vitamin_b12) FROM patient_data WHERE patient_id = 10021666
f8961f88221514dc6b646933,"Hey jo, tell me what that diagnosis was that patient 20801 got in that other department",,,SELECT diagnosis FROM medical_records WHERE patient_id = 20801 AND department = 'Other'
64a1ee1c1e25b6f646865939,What was the admission type for patient 10021312's first visit to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10021312 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1",[],SELECT admission_type FROM visits WHERE patient_id = 10021312 ORDER BY visit_date ASC LIMIT 1
9c318ab198a0c0e5c19cd4b6,Were any procedures carried out on patient 10001217 in their first hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) AS Procedure_Count FROM Hospital_Visits WHERE Patient_ID = 10001217 AND Visit_Number = 1 AND Procedure_Carried_Out = 'Yes'
6dd0dd2307f507f9c42eea63,What medicine does patient 80555 take after being prescribed by the other medical department of our hospital?,,,SELECT m.name FROM prescriptions p JOIN patients pat ON p.patient_id = pat.id JOIN medicines m ON p.medicine_id = m.id WHERE pat.id = 80555 AND p.department = 'Other' ORDER BY p.date_prescribed DESC LIMIT 1;
d55a49b733c16c813474898b,Retrieve the top five most common diagnoses for patients with age 50s this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patient_records WHERE age BETWEEN 50 AND 59 AND year = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
5c292b2eff5ea33b4c5658b2,What was the total cerebral ventricular #1 volume that patient 10027602 had since 03/08/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cerebral ventricular #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-08'",[{'SUM(outputevents.value)': None}],SQL Query Here
6b5b9ccd032dd84eb4439664,"When has patient 10019172 been given chloride, whole blood test for the first time since 07/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-07' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT MIN(visit_occurrence.visit_date) AS first_time FROM visit_occurrence JOIN condition_occurrence ON visit_occurrence.visit_occurrence_id = condition_occurrence.visit_occurrence_id WHERE condition_occurrence.person_id = 10019172 AND condition_concept_id = 3099757 AND visit_occurrence.visit_date > '2100-07-01' GROUP BY condition_occurrence.person_id
127ee80e549fe86039373e27,So how many days has passed since patient 10018081's last other ventral hernia without mention of obstruction or gangrene diagnosis in the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ventral hernia without mention of obstruction or gangrene' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT DATEDIFF(day, MAX(svc_date), GETDATE()) FROM (SELECT DISTINCT svc_date FROM mrn_encounter WHERE mrn = 10018081 AND encounter_type = 'current' AND service_type = 'surgery' AND service_name = 'Other ventral hernia repair without mention of obstruction or gangrene' AND svc_date IS NOT NULL) AS LastEncounter"
f870fc9332fe7c3778488b46,When was the first time patient 10011398 was prescribed drugs via po on their last hospital encounter?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po' ORDER BY prescriptions.starttime ASC LIMIT 1,[],select first(encounter.discharge_time) from encounter join prescription on encounter.id = prescription.encounter_id where encounter.patient_id = 10011398 and prescription.route = 'po' and encounter.encounter_type = 'inpatient' and prescription.encounter_id = (select max(encounter_id) from encounter where patient_id = 10011398 and encounter_type = 'inpatient')
be4e133fd657b3c989be8b0b,How many hours has it been since the first stay of patient 10021487 in the careunit trauma sicu (tsicu) on this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1",[],SQL Query here
a1a26b44387af2430b609395,Could you calculate the total amount of output from patient 10021487 since 10/22/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-22'",[{'SUM(outputevents.value)': 71508.0}],SELECT SUM(output) FROM patient_output WHERE patient_id = 10021487 AND entry_date >= '10/22/2100'
49a64438974f40760d7b4448,What is the diagnosis price for postprocedural hemorrhage of a circulatory system organ or structure following a cardiac catheterization?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural hemorrhage of a circulatory system organ or structure following a cardiac catheterization' ) ),,select diagnosis_price from AHA.dbo.ahaidshccv2 where description='postprocedural hemorrhage of a circulatory system organ or structure following a cardiac catheterization'
0b0a39c4b7112434084d3daa,Give me the length of stay in days for patient 10022041 during their first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.8923842599615455}]","SELECT DATEDIFF(day, MIN(admission_date), MIN(discharge_date)) AS length_of_stay FROM patient_stay WHERE patient_id = 10022041 AND stay_type = 'ICU' GROUP BY patient_id"
9f458a33e3737acb61d26a1c,Tell me about the four most common specimens tested since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]","[SELECT specimen, COUNT(*) AS frequency"
e3050cd2b1f00826b18a4be8,What is the price for ursodiol?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ursodiol' ),,"SELECT ""Price"" FROM ""Medications"" WHERE ""Name"" = 'ursodiol';"
41539321bbcb2564370db4b1,When are dr. hurdle's rounds and procedures?,,,"SELECT DISTINCT event_date, start_time, procedure_type FROM hospital_events WHERE event_date >= '2023-04-01' AND event_date <= '2023-04-30' AND staff_id = (SELECT id FROM staff WHERE name = 'Dr. Hurdle') AND (procedure_type = 'Round' OR procedure_type = 'Procedure') ORDER BY event_date, start_time;"
ec6cfedc417520a4d86f2365,"Has patient 10025612 been on scopolamine patch, 5% dextrose, or acetaminophen as prescribed since 09/2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND prescriptions.drug IN ( 'scopolamine patch', '5% dextrose', 'acetaminophen' ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'",[{'COUNT(*)>0': 0}],"SELECT DISTINCT m.medicine_name FROM medicine m WHERE m.patient_id = 10025612 AND m.medicine_name IN ('Scopolamine Patch', '5% Dextrose', 'Acetaminophen') AND m.prescription_date >= '09/21/00' AND m.administration_status = 'Administered as Prescribed'"
ff6ea5e1101cdc2781d7466a,Please retrieve the monthly maximum amount of patient 10015931's nacl 0.9% input since 09/07/2100.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-07' GROUP BY strftime('%Y-%m',inputevents.starttime)",[],
1c0ad5aee8b258ad464b0c2d,What is the name of a procedure patient 10038081 underwent two or more times since 07/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,SELECT procedure_name FROM procedures WHERE patient_id = '10038081' AND procedure_date >= '07/2100' GROUP BY procedure_name HAVING COUNT(*) >= 2
e9dd16ce54ed38fae39646d8,What was patient 10009035's minimum systolic blood pressure in their first ICU visit?,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ),[{'MIN(chartevents.valuenum)': None}],select min(`systolic_bp`) from `icu_visits` where `patient_id` = '10009035' and `visit_number` = 1
80466ce112a1c1006d70d876,What were the top four most frequent diagnoses with which patients were diagnosed after receiving excision of other bile duct within 2 months?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM patient_records WHERE procedure = 'excision of other bile duct' AND diagnosis_date BETWEEN procedure_date AND DATE_ADD(procedure_date, INTERVAL 2 MONTH) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 4"
0ce9c8a93ef40fa209454a71,Find out the number of drugs given to patient 10014729 in 04/this year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)': 0}],SELECT COUNT(*) AS number_of_drugs FROM prescriptions WHERE patient_id = '10014729' AND date_prescribed >= '2023-04-01' AND date_prescribed <= '2023-04-30' GROUP BY patient_id;
240c55269dbe044f71ee51c5,What is the average yearly number of people diagnosed with rheumatic disorders of both mitral and aortic valves since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,SQL Query Here
56ad123e50882b48474bc758,What are the five commonly ordered medications that patients aged 60 or above were prescribed within the same month after diagnosed with other nonspecific findings on examination of urine?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other nonspecific findings on examination of urine' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,SQL Query
953ded6c199c40900648aa89,Is patient 10021938's bicarbonate value last measured on the last hospital visit less than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","[select distinct (case when (select bicarbonate from labevents where subject_id=10021938 and category=""Chemistry"" and (charttime between (select min(charttime) from labevents where subject_id=10021938 and category=""Chemistry"" and (charttime between (select max(charttime) from labevents where subject_id=10021938 and category=""Critical Care"" and (charttime between (select min(charttime) from labevents where subject_id=10021938 and category=""Critical Care"") and (select max(charttime) from labevents where subject_id=10021938 and category=""Critical Care""))) and (select max(charttime) from labevents where subject_id=10021938 and category=""Critical Care"" and (charttime between (select min(charttime) from labevents where subject_id=10021938 and category=""Critical Care"") and (select max(charttime) from labevents where subject_id=10021938 and category=""Critical Care"")))))) and (charttime < (select max(charttime) from labevents where subject_id=10021938 and category=""Chemistry"" and (charttime between (select min(charttime) from labevents where subject_id=10021938 and category=""Chem"
13bee07976257e0b38f5e9b3,What was the procedure conducted on patient 10020740 two or more times in 05/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"SELECT procedure_code, COUNT(procedure_code) AS times_performed FROM outpatient_claims WHERE patient_id = '10020740' AND procedure_date LIKE '05/2100%' GROUP BY procedure_code HAVING COUNT(procedure_code) >= 2;"
569bfe18989623d3f5c6678a,Count up how many times patient 10006580 was admitted to the ICU since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}],SELECT COUNT(*) FROM [ICUSTAYS
fc46ccfbdac692e517e9d7fe,What is the cost for the medicine metformin (glucophage)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'metformin (glucophage)' ),,SELECT cost FROM medicines WHERE name = 'metformin (glucophage)'
eec30a374f5a614dddb5c128,What are the methods for taking caphosol?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'caphosol',[],SELECT methods FROM caphosol_usage
b5e8c7efd2cc02936f14bf95,When did patient 10039831 since 03/24/2100 for the last time have an input?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-24' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2115-12-30 13:05:00'}],SELECT MAX(input_date) as last_input_date FROM patient_inputs WHERE patient_id = 10039831 AND input_date >= '03/24/2100'
dd9d9407871fb618bd52f8a9,What was the medicine that was prescribed to patient 10004235 during the same hospital visit after undergoing excision of other bile duct since 04/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of other bile duct' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,select * from medicine where patient_id = 10004235 and hospital_visit_id = (select hospital_visit_id from patient_visits where patient_id = 10004235 and procedure = 'excision of other bile duct' and visit_date > '04/2100')
2561607a3178d1491081ba75,What was the name of the organism found in the last microbiology test conducted on patient 10007795's urine since 05/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],select name from microbiology_test where patient_id = 10007795 and specimen_type = 'urine' order by test_date desc limit 1
40af2c18046760f0127c35fb,What is the maximum total hospital cost for a drug named levetiracetam since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'levetiracetam' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_cost) FROM drug_cost WHERE drug_name = 'levetiracetam' AND year >= 2100
39d219c7d6cf5c42a50daf25,Work out the total amount of input patient 10016742 received since 04/15/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-15'",[{'SUM(inputevents.totalamount)': 36640.0}],SELECT SUM(input_amount) AS total_input_amount FROM patient_records WHERE patient_id = 10016742 AND date >= '04/15/2100'
1816be0b35b828a815b17b16,How many days has it been since the first acquired absence of intestine (large) (small) diagnosis for patient 10018081 on the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of intestine (large) (small)' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT DATEDIFF(day, MIN(a.drg_date), GETDATE()) FROM absences a INNER JOIN encounters e ON a.encounter_id = e.encounter_id INNER JOIN patients p ON e.patient_id = p.patient_id WHERE a.code = 'intestine (large) (small)' AND p.patient_id = '10018081' AND e.hospital_encounter_id = (SELECT hospital_encounter_id FROM encounters WHERE patient_id = '10018081' ORDER BY encounter_date DESC LIMIT 1)"
0112d30f1318ad87f07d5ace,What is the count of quetiapine fumarate prescriptions made since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'quetiapine fumarate' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescriptions WHERE medication = 'quetiapine fumarate' AND date_prescribed >= '2100-01-01';
0a507e5e6d94656aec03e31d,"During the first ICU visit, when did patient 10025612 have their last input?",SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,[{'starttime': '2125-09-30 15:00:00'}],"select min(time) from chartevents where itemid in (211, 51, 3420, 455, 6701, 678, 6702, 6789, 679, 223900, 220051, 220052, 224690, 220180, 224691, 220179, 220178, 224697, 224110, 225310) and subject_id = 10025612 and hadm_id in (select hadm_id from icustays where subject_id = 10025612 and stay_id = 1)"
eacb97f691e333004c824387,"Can you provide the name of the drug that was prescribed to patient 10038999 during the same day post excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedure in 06/this year?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left upper lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,select distinct drug_name from (select drug_name from drug_events where drug_type='PRESCRIPTION' and person_id=10038999 and (date(drug_start_date) between date((select date of service from procedure_events where person_id=10038999 and concept_id=3096256 limit 1)) and date((select date of service from procedure_events where person_id=10038999 and concept_id=3096256 limit 1)) + interval 1 day))
e629cd0656dc5fe7580121c9,How many individuals are current patients in their 20s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 20 AND 29,,SELECT COUNT(*) FROM `physicians_2` WHERE `age` BETWEEN 20 AND 29 AND `is_current_patient` = 1
4bb1514c5befb0ece60fdb11,Has there been any organism found in patient 10020740's last sputum microbiology test in 04/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],SELECT * FROM microbiology_test_results WHERE patient_id = '10020740' AND test_date = '2100-04-01' AND test_type = 'sputum' AND organism_found IS NOT NULL
5768d20678cf5c0dad75054a,Give me patient 10027602's total output on 11/26/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '11-26'",[{'SUM(outputevents.value)': None}],"SELECT patient_id, admission_date, SUM(total_output) AS total_output FROM patient_records WHERE patient_id = 10027602 AND admission_date = '2023-11-26' GROUP BY patient_id, admission_date;"
7f326a0a5a46eb805b8f5a56,Show me the top five most common diagnoses of patients with age 30s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) as frequency FROM medical_records WHERE patient_age BETWEEN 30 AND 39 AND year=2100 GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
55351822938c1ebf04f6ef79,How many days was patient 10009049's last stay in the intensive care unit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.217499999795109}]","SELECT DATEDIFF(MAX(DischargeDate), MIN(AdmissionDate)) FROM PatientRecords WHERE PatientID = 10009049 AND UnitType = 'Intensive Care Unit'"
3dd575660bbbf5e93e445cfb,"During their first hospital visit, what was the insurance of patient 10011398?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],SELECT insurance FROM first_admissions WHERE patient_id = 10011398
e7f9bc2207fce85235ec07aa,Retrieve the top three most frequent procedures that patients were given in the same month after receiving injection or infusion of thrombolytic agent since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection or infusion of thrombolytic agent' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT procedure_name, COUNT(*) as frequency FROM medical_records WHERE procedure_date >= '2100-01-01' AND procedure_date < DATE_ADD(injection_date, INTERVAL 1 MONTH) AND procedure_category = 'post-thrombolytic' GROUP BY procedure_name ORDER BY frequency DESC LIMIT 3"
db5bac94ce7826d253dc454e,"What are the top three most common microbiology tests that patients had after the diagnosis of abdominal pain, unspecified site in the same month?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abdominal pain, unspecified site' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 test_name, COUNT(*) AS test_count FROM microbiology_tests INNER JOIN diagnosis ON microbiology_tests.patient_id = diagnosis.patient_id WHERE diagnosis.code = 'abdominal pain, unspecified site' AND microbiology_tests.test_date >= DATEADD(MONTH, -1, diagnosis.diagnosis_date) GROUP BY test_name ORDER BY test_count DESC"
8174f666b42de86d7c8231a4,Calculate the length of stay in days for the last stay of patient 10005817 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 15.972812499850988}]",SQL Query
43b3a2950b00b6d8b6b27c84,"What was the drug that patient 10015931 was prescribed with within the same hospital visit after the replacement of aortic valve with zooplastic tissue, percutaneous approach since 5 months ago?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-5 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT drug_name FROM prescriptions WHERE patient_id = 10015931 AND visit_id IN (SELECT visit_id FROM procedures WHERE procedure_description LIKE '%replacement of aortic valve with zooplastic tissue, percutaneous approach%' AND visit_date BETWEEN DATE_SUB(NOW(), INTERVAL 5 MONTH) AND NOW()) AND visit_id > (SELECT visit_id FROM procedures WHERE procedure_description LIKE '%replacement of aortic valve with zooplastic tissue, percutaneous approach%' AND patient_id = 10015931) ORDER BY visit_date ASC LIMIT 1"
b0c7bdb6be37ebfe3feb04a6,"What are the four frequently ordered medications for patients diagnosed with hemorrhage of rectum and anus previously within 2 months, in this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage of rectum and anus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,select distinct drug_name from medication_order o join diagnosis d on o.patient_id = d.patient_id join (select patient_id from diagnosis where dname = 'hemorrhage of rectum and anus' and date >= (DATE(NOW()) - INTERVAL 2 MONTH) and date < DATE(NOW()) group by patient_id) d1 on d1.patient_id = o.patient_id where d.dname = 'hemorrhage of rectum and anus' and o.date >= DATE(NOW()) and o.date < (DATE(NOW()) + INTERVAL 1 YEAR) group by drug_name order by count(*) desc limit 4
1d8e1854e955b721c482a91d,What was the last hospital admission type for patient 10005866?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10005866 ORDER BY admissions.admittime DESC LIMIT 1,[{'admission_type': 'OBSERVATION ADMIT'}],[SELECT TOP 1 AdmissionType
1990af17fa6d2e02b4b63fe9,When did patient 10009035 have the minimum body temperature for the last time since 295 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-295 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],select distinct min(time_stamp) as min_time from m_health_patient_daily_statistics where patient_id = 10009035 and body_temperature = (select min(body_temperature) from m_health_patient_daily_statistics where patient_id = 10009035 and time_stamp >= now() - interval 295 day) and time_stamp >= now() - interval 295 day
b3b04512888e6be067ea0094,"What are the total number of assistance with cardiac output using balloon pump, continuous procedures performed since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,"SELECT COUNT(*) AS total_procedures FROM cmo_outcome WHERE cmo_outcome_date >= '2100-01-01' AND cmo_outcome_name='Assistance with cardiac output using balloon pump, continuous'"
accce2ad12559dd458516192,What was the total or urine output of patient 10035185 in the first ICU stay?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ),[{'SUM(outputevents.value)': None}],SELECT SUM(urine_output) FROM patient_data WHERE patient_id = '10035185' AND stay_id = (SELECT MIN(stay_id) FROM patient_data WHERE patient_id = '10035185');
c68906dafb0c5fe36f9c5d48,What's the price of a procedure referred to as endoscopic control of gastric or duodenal bleeding?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic control of gastric or duodenal bleeding' ) ),,select procedure_price from procedures where procedure_name='Endoscopic control of gastric or duodenal bleeding'
152ff0308ad4afd9693231f2,What was the last time when patient 10013049 received a bicarbonate lab test in their first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT MAX(lab_datetime) FROM lab_tests WHERE person_id = 10013049 AND lab_test_name = 'Bicarbonate' AND hospital_visit_id IN (SELECT hospital_visit_id FROM hospital_visits WHERE person_id = 10013049 AND visit_order = 1)
c6ff88c99785463abe05ab14,Does an appointment have been had by patient 17462 in other department?,,,SELECT * FROM appointments WHERE patient_id=17462 AND department_id != (SELECT department_id FROM appointments WHERE patient_id=17462 ORDER BY appointment_date ASC LIMIT 1)
f5e30b7ed7e2dc03d9e33f9d,What were the top five diagnoses of patients with age 60 or above in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS num_patients FROM medical_records WHERE age >= 60 AND year = 2100 GROUP BY diagnosis ORDER BY num_patients DESC LIMIT 5;"
0d5c93359124d85b4946ec95,Is patient 739 tested for covid-19?,,,SELECT covidTestResult FROM patientRecords WHERE patientID = 739
0d3343e3e64231d00abab91e,How was patient 10039997 admitted to the hospital in terms of admission type for the first time?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039997 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1",[{'admission_type': 'SURGICAL SAME DAY ADMISSION'}],SQL Query Here
7fe3a3267061ac2383bb66cb,List the top five most occurring events in 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],"SELECT event_name, COUNT(*) AS frequency FROM events WHERE YEAR(event_date) = 2100 GROUP BY event_name ORDER BY frequency DESC LIMIT 5;"
6992e079d5cc2aa7a2bb6cbe,Does patient 5142 have a travel history from overseas?,,,SELECT EXISTS(SELECT 1 FROM patient_history WHERE patient_id = '5142' AND travel_history IS NOT NULL AND overseas = TRUE) AS has_overseas_travel;
3ba708e58388ca50083283e8,Retrieve the top five most frequent lab tests that patients had after being diagnosed with calculus of kidney within the same month since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 test_name, COUNT(*) as frequency FROM patient_records WHERE diagnosis_date >= '2100-01-01' AND diagnosis_code = 'N20.0' AND test_date BETWEEN diagnosis_date AND DATEADD(month, 1, diagnosis_date) GROUP BY test_name ORDER BY frequency DESC;"
dbd23b051c5c2e2ce67a439b,Tell me the five most frequent treatments for patients aged 60 or above.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,SQL Query
d34f3b955bd78b3126293e64,When did patient 10855 last take a proper medication?,,,SELECT MAX(date_taken) FROM medication_log WHERE patient_id = 10855 AND is_proper = TRUE
975a9d2f0afd09663ee67165,How is nifedipine typically consumed?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nifedipine',"[{'route': 'PO'}, {'route': 'ORAL'}]",SELECT consumption_method FROM medications WHERE medication_name = 'Nifedipine'
dbe29d2282f5b3aed0d011d3,Has patient 10029291 gone to an emergency room since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM er_visits WHERE patient_id = 10029291 AND visit_date > '2100-01-01'
3cb1c84c070748104d4fe00c,"What was the last time, today, that patient 10039831's respiratory rate was less than 21.0?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY chartevents.charttime DESC LIMIT 1",[],""""""""
a9632d75ba6d979b5decdf12,Can you name the procedure/treatment that patient 10007795 was given two times in 05/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,select distinct t1.TREATMENT from TREATMENT t1 join TREATMENT t2 on t1.TREATMENT=t2.TREATMENT and t1.PATIENT_ID=t2.PATIENT_ID and t1.TREATMENT_DATE!=t2.TREATMENT_DATE where t1.PATIENT_ID=10007795 and t1.TREATMENT_DATE between '05-01-2100' and '05-31-2100' group by t1.TREATMENT having count(t1.TREATMENT)=2
62547959e3baf6a4703c5fbb,How many hours have passed since the first time that patient 10039831 stayed in careunit surgical intensive care unit (sicu) in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'surgical intensive care unit (sicu)' ORDER BY transfers.intime ASC LIMIT 1",[],SELECT EXTRACT(EPOCH FROM (NOW() - MIN(admittime))) / 3600 FROM admissions WHERE patient_id = '10039831' AND careunit = 'Surgical Intensive Care Unit' AND visit_id = (SELECT visit_id FROM admissions WHERE patient_id = '10039831' AND visit_starttime <= NOW() AND visit_endtime >= NOW())
5584a484b396e900b09a1ff9,Has patient 10026406 been to the E.R.?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.admission_location = 'emergency room',[{'COUNT(*)>0': 0}],SELECT * FROM ER_Visits WHERE patient_id = '10026406'
6ce32236a45e40ed7a60af77,Can you tell me when patient 10008454's last microbiology test was since 5 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-5 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2110-12-07 03:05:00'}],"select top 1 testdate from lab_results where patientid = '10008454' and testtype = 'microbiology' and testdate > dateadd(month, -5, getdate()) order by testdate desc"
3e53f449eb365ab960c6aa59,"For the first time since 08/2100, what specimen test did patient 10007795 get?","SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'BLOOD CULTURE'}],SELECT test_name FROM specimen_tests WHERE patient_id = 10007795 ORDER BY test_date ASC LIMIT 1
f98f47f9d3ab7a1af147e5ac,How many prescriptions for nifedipine cr were made since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'nifedipine cr' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)': 0}],"SELECT COUNT(*) FROM prescriptions WHERE medication_name='nifedipine cr' AND date_prescribed >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
9ee9faec0727283454a64f52,What is the number of (aorto)coronary bypass of four or more coronary arteries procedures carried out?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of four or more coronary arteries' ),[{'COUNT(*)': 0}],SELECT COUNT(*) FROM procedures WHERE procedure_name = 'aortocoronary bypass' AND number_of_coronary_arteries >= 4;
fa56e6f995ce65468f6bac6a,How many of 0.9% sodium chloride were prescribed to patient 10005817 in total since 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.drug = '0.9% sodium chloride' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(quantity) FROM prescriptions WHERE patient_id = '10005817' AND medication_name = '0.9% sodium chloride' AND prescription_date >= '12/2100'
a959a44bac364940384687df,"How many patients received insertion of infusion device into superior vena cava, percutaneous approach treatment in the same hospital encounter after being diagnosed with food in respiratory tract, part unspecified causing asphyxiation, initial encounter in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'food in respiratory tract, part unspecified causing asphyxiation, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into superior vena cava, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,SELECT COUNT(*) FROM patient_records WHERE diagnosis_code = 'food_in_respiratory_tract_asphyxiation_initial' AND treatment_code = 'insertion_infusion_device_superior_vena_cava_percutaneous' AND encounter_date BETWEEN '2100-01-01' AND '2100-12-31' AND same_encounter = TRUE
2985a08b2d895846538fee43,Provide the length in days of the first visit for patient 10026406 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.48175925901159644}]","SELECT DATEDIFF(day, MIN(ADMITTIME), MAX(ADMITTIME)) AS 'First Visit Length in Days' FROM ICUSTAYS WHERE SUBJECT_ID = 10026406 GROUP BY SUBJECT_ID LIMIT 1"
7299ff6d3a692b4da823bc87,What was the name of the medicine prescribed to patient 10027445 for the first time in 08/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT DISTINCT Medication_Name FROM Prescriptions WHERE Patient_ID = '10027445' AND Prescription_Date >= '2023-08-01' ORDER BY Prescription_Date ASC LIMIT 1
4f56cb9467f8f3d5205a4396,What was the three most common lab test given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT LabTest, COUNT(LabTest) AS TestCount FROM patient_tests GROUP BY LabTest ORDER BY TestCount DESC LIMIT 3"
9401e788946c189532687a96,Do you think patient 14203 may have a family history of any diseases?,,,SELECT * FROM FamilyHistory WHERE PatientID = 14203
b9e7f10e8737b4fd67bc29db,Calculate the number of medicines that patient 10010471 was prescribed since 13 months ago.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month')",[{'COUNT(*)': 119}],SQL_QUERY_GOES_HERE
3cfbe0e30b718f625d69a2c5,When did patient 10013049 get the mcv lab test on the last hospital stay for the last time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT `admission_date` FROM `lab_events` WHERE `patient_id` = 10013049 AND `lab_test` = 'mcv' ORDER BY `admission_date` DESC LIMIT 1
447267ea557ee396e8eade57,What was the total vitamin d dose that has been prescribed in 05/2100 to patient 10035185?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND prescriptions.drug = 'vitamin d' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(Dose) FROM Prescription WHERE DatePrescribed BETWEEN '05/01/2100' AND '05/31/2100' AND PatientID = '10035185' AND MedicationName = 'Vitamin D'
f76e82ade10ee685ac166e82,What's the cost of a procedure named other endovascular procedures on other vessels?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) ),,SELECT cost FROM Procedures WHERE procedure_name = 'other endovascular procedures on other vessels'
21b660c0148b20c1b1c2131d,Has patient 10022880 acquired any medication in 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)>0': 0}],select * from medication_records where patient_id = '10022880' and date_prescribed >= '2100-01-01' and date_prescribed < '2101-01-01' and medication_acquired = true
0dbcca2edb8dc4ada9f1ae3a,When did patient 10038081 receive a peritoneal fluid microbiology test first?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],SELECT min(TestDate) FROM patient_tests WHERE PatientID = 10038081 AND TestType = 'Peritoneal Fluid Microbiology'
58dc0f1db2dd25ed12cb221c,"Among patients aged 60 or above since 1 year ago, what are the top five most common diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,
5e6f873f02b4c4a0d2ee764a,What was the first drug prescribed last month to patient 10005909 via the sc route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND prescriptions.route = 'sc' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime ASC LIMIT 1",[],"SELECT TOP 1 medication_name FROM prescription_records WHERE patient_id = '10005909' AND route = 'sc' AND date_prescribed BETWEEN DATEADD(month, -1, GETDATE()) AND GETDATE() ORDER BY date_prescribed ASC"
9b11adf840122cc37bef0ed4,Tell me about the most common four output events during this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"[SELECT TOP 1 output_event, COUNT(*) as frequency"
bc7ad8b3ef9492deca744662,"Since 1 year ago, what was patient 10008287 diagnosed with for the last time?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,"SELECT diagnosis FROM medical_records WHERE patient_id = 10008287 AND diagnosis_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW() ORDER BY diagnosis_date DESC LIMIT 1"
a70c341de1bc993eef26586f,Was magnesium sulfate (bolus) administrated to patient 10007928 in 04/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-04'",[{'COUNT(*)>0': 0}],SELECT `medications`.`medication` FROM `admissions` JOIN `medications` ON `admissions`.`patient_id` = `medications`.`patient_id` AND `medications`.`admission_id` = `admissions`.`admission_id` WHERE `patient_id` = 10007928 AND `medications`.`medication` LIKE '%magnesium sulfate (bolus)%' AND `admissions`.`admission_date` BETWEEN '2100-04-01' AND '2100-04-30'
02e100aec6d99e6f5934caa5,What are the three most common diagnoses for patients who previously had the excision of dental lesion of jaw procedure within 2 months since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,brackets
1c1615f9c154aca940cea316,When was patient 10038992's last discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10038992 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT discharge_date FROM patient_records WHERE patient_id = '10038992' ORDER BY discharge_date DESC LIMIT 1
6716a47fafd5bf2d15dae0e8,Has patient 10005866 gone through any procedure this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,SELECT * FROM procedures WHERE patient_id = 10005866 AND date >= '2023-01-01'
e630dab0aeb52cb103a0b242,Tell me patient 10023239's maximum value of heart rate since 04/15/2100.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-04-15'",[{'MAX(chartevents.valuenum)': None}],SELECT MAX(heart_rate) FROM patient_data WHERE patient_id = 10023239 AND date >= '04/15/2100'
52fe2640719f3ea2cd5cc5ba,"What was the name of the drug which was prescribed to patient 10007818 within the same day after having received a introduction of nutritional substance into central vein, percutaneous approach procedure in 07/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into central vein, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,"select distinct pdr.drug_name from patient_procedure pp inner join patient_drug pdr on pp.patient_id = pdr.patient_id where pp.patient_id = 10007818 and pp.date = '2100-07-21' and pp.procedure_name = 'Introduction of nutritional substance into central vein, percutaneous approach' and pdr.date_prescribed = pp.date"
5d2dfd7a5a2882eb9da2724d,"Among patients who were given closed [percutaneous] [needle] biopsy of kidney , what are the top five most common specimens tested afterward within 2 months?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 `specimen_tested` FROM `patient_records` WHERE `procedure` = 'closed percutaneous needle biopsy of kidney' AND `test_date` BETWEEN procedure_date AND DATE_ADD(procedure_date, INTERVAL 2 MONTH) GROUP BY `specimen_tested` ORDER BY COUNT(*) DESC;"
814787a2d9c20960f6b872b9,Was patient 10020740 to the E.R. during the last year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],"SELECT * FROM visit_occurrence WHERE person_id = '10020740' AND visit_concept_id = (SELECT concept_id FROM concept WHERE concept_name = 'Emergency Department Visit') AND visit_start_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) AND CURRENT_DATE"
2a505caf854db532714351f3,At what time did the first incident of patient 10006053 having a maximum mean blood pressure occur on last month/16?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '16' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],[SELECT MIN(event_time) AS first_incident_time
08afa3fcbebe341dfdf62b15,Can you find the three most frequent drugs that were prescribed during the same month after a gastro-esophageal reflux disease without esophagitis diagnosis was given since 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT drug_name, COUNT(*) as prescription_count FROM prescriptions WHERE diagnosis = 'gastro-esophageal reflux disease without esophagitis' AND YEAR(prescription_date) >= 2100 AND MONTH(prescription_date) = MONTH(diagnosis_date) GROUP BY drug_name ORDER BY prescription_count DESC LIMIT 3;"
41380d1d5d0e6d1c497a8317,"Calculate the number of people who had respiratory ventilation, greater than 96 consecutive hours.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patient_id) as total_patients from patient_records where ventilation_type = 'respiratory' and ventilation_duration > 96
db0814178ef902c3c2b96f95,How was patient 10018845 admitted to the hospital in terms of admission type for the first time?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10018845 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1",[],SELECT * FROM admissions WHERE patient_id = 10018845 AND admission_seq_num = 1
c243f4fb931374310bdb207c,When did patient 10037928 have the first minimum sodium value in 11/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],"select min_value, date from sodium where patient_id = 10037928 and date between '11/2100' and '11/2100' order by date limit 1"
816890403b923f91deda0dda,How many days have elapsed since the last time patient 10018081 got a phosphate lab test during the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],Your Encounter Filter Here
c7a42a6138402a2496be2e3d,When was the first time patient 10008454 systolic blood pressure was measured less than 123.0 since 142 days ago.,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 123.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-142 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],[SELECT MIN(medical_events.event_start_datetime) AS first_low_bp_date
cba569373f71ae7e9628bf97,What was the accumulated output for patient 10009628 on 10/02/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-02'",[{'SUM(outputevents.value)': None}],select output from patient_records where patient_id = 10009628 and date = '2023-10-02'
ef005db9fac61254bdbabbe7,What was the name of the drug that was prescribed last to patient 10011398 in 12/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1",[],select top 1 drug_name from prescriptions where patient_id = 10011398 and visit_date between '2023-12-01' and '2023-12-31' order by visit_date desc
54bc89ef44d4c2ee5d31aeec,How many total esophagectomy procedures were conducted?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ),[{'COUNT(*)': 0}],SELECT COUNT(*) as total_esophagectomy_procedures FROM esophagectomy_procedures
44ff2488f2d3d5682b6994b8,The last time patient 19175 had something to take on a regular basis?,,,SELECT MAX(date) AS LastRegularIntakeDate FROM intake_events WHERE patient_id = 19175 AND regular == 1
a8030f14c8d26bf536bbb2e7,Has patient 10001217 got a l laboratory test this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'l' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT * FROM laboratory_tests WHERE patient_id = '10001217' AND test_date >= '2023-01-01'
2eabc9e68c01f195e82de460,What is the number of patients who were discharged from the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],"SELECT COUNT(DISTINCT patient_id) FROM hospital_discharges WHERE discharge_date >= DATE_SUB(NOW(), INTERVAL 1 YEAR);"
4c7f81e40d7fe7c76ef35275,How many patients since 1 year ago were diagnosed with mitral valve disorders within the same month after the diagnosis of alkalosis?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alkalosis' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mitral valve disorders' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT COUNT(DISTINCT patients.patient_id) FROM patients INNER JOIN diagnoses ON patients.patient_id = diagnoses.patient_id WHERE diagnoses.condition = 'alkalosis' AND diagnoses.date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW() AND EXISTS (SELECT 1 FROM diagnoses as mitral_valve_diagnoses WHERE mitral_valve_diagnoses.patient_id = patients.patient_id AND mitral_valve_diagnoses.condition = 'mitral valve disorders' AND MONTH(mitral_valve_diagnoses.date) = MONTH(diagnoses.date) AND YEAR(mitral_valve_diagnoses.date) = YEAR(diagnoses.date))"
ad521f49d4f6250463adc2a9,Calculate the number of prescribed drugs for patient 10007795 in 10/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-10'",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescriptions WHERE patient_id = 10007795 AND prescription_date BETWEEN '2100-10-01' AND '2100-10-31'
1f8f753b781c5e7a44238a71,What was the three most common lab test that was given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",SELECT LabTest FROM lab_results ORDER BY COUNT(LabTest) DESC LIMIT 3
0a103802ca827b13141a5a60,"For patient 10018081, how many hours have passed since the last diagnosis with long-term (current) use of anticoagulants in their current hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"[SELECT TIMESTAMPDIFF(HOUR, MAX(diagnosis_date), CURRENT_TIMESTAMP) AS hours_since_last_anticoagulant_use"
abf1227f05449e3179b9185d,Was patient 10037861 involved in any medical procedure during the last hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],select distinct m.medical_procedure_id from patient_encounter p inner join medical_procedure m on p.encounter_id = m.encounter_id where p.patient_id = 10037861 and p.encounter_type = 'last' and m.medical_procedure_id is not null
1452ce7ea3c5edec118c2e61,Has patient 10021312 gotten any medication this year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT COUNT(*) AS MedicationCount FROM prescriptions WHERE patient_id = 10021312 AND YEAR(prescription_date) = YEAR(CURDATE())
f9db2f1ae379485d2157c06b,Calculate the length of stay in days for the last stay of patient 10001725 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.338587962090969}]","select datediff(day, (select max(ADMITDATETIME) from ICU where icustay_id = (select icustay_id from ICU where HADM_ID = (select max(HADM_ID) from ICU where SUBJECT_ID = (select SUBJECT_ID from ICU where ICUSTAY_ID = (select icustay_id from ICU where SUBJECT_ID = 10001725 and HADM_ID in (select max(HADM_ID) from ICU where SUBJECT_ID = 10001725 and ICUSTAY_ID in (select icustay_id from ICU where SUBJECT_ID = 10001725)))))), DISCHDATETIME) as length_of_stay from ICU where icustay_id = (select icustay_id from ICU where SUBJECT_ID = 10001725 and HADM_ID in (select max(HADM_ID) from ICU where SUBJECT_ID = 10001725 and ICUSTAY_ID in (select icustay_id from ICU where SUBJECT_ID = 10001725))))"
2b1f21750fa632e9b0f7a19f,Did patient 10021938 have a lab test during the previous month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",[{'COUNT(*)>0': 0}],
8bfd5025332346ae9908634c,Give me patient 10016810's total output since 06/01/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-01'",[{'SUM(outputevents.value)': 5090.0}],SELECT SUM(output) FROM medical_records WHERE patient_id = 10016810 AND date >= '06/01/2100'
3316ce93c81fea759846ffdb,Get me the top five most frequent events this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],
d557347f082c26133868efb1,Tell me the length in days of the last stay for patient 10016150 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.15594907384365797}]",SELECT MAX(LOS) as 'Last ICU Stay Length' FROM ICUStays WHERE PatientID = '10016150'
7346582042d3b9bcee31329c,How many hours has it been since the first time patient 10021487 visited careunit trauma sicu (tsicu) in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1",[],"select datediff(hour, min(entrytime), max(entrytime)) from (select entrytime from t_edw_cdh_v_clinical_events where person_id = 10021487 and careunit = 'trauma sicu' and visit_id = (select visit_id from t_edw_cdh_v_person_current_visit where person_id = 10021487)) as subquery;"
45b872b3b1c160f0ef5249c5,What is the total number of patients who stayed in careunit emergency department observation since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(*) FROM careunit WHERE description='emergency department observation' and date_entered>='2100-01-01'
f2265be3b7f96b9827e002f2,What was the total output that patient 10020786 had since 07/01/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-01'",[{'SUM(outputevents.value)': 925.0}],SELECT SUM(OUTPUT) as TotalOutput FROM PATIENT_OUTPUT WHERE PATIENT_ID = 10020786 AND OUTPUT_DATE >= '2100-07-01'
4168e2277f26fb151490a2c0,What is the cost of defibrination syndrome diagnostic?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'defibrination syndrome' ) ),,SELECT cost FROM medical_procedures WHERE diagnosis = 'defibrination syndrome'
cc3ae3ee46938d74fbd6ba5e,Number of patients who were diagnosed throughout this year with hepatic encephalopathy.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hepatic encephalopathy' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,SELECT count(*) FROM diagnoses WHERE condition = 'hepatic encephalopathy' AND date BETWEEN '2023-01-01' AND '2023-12-31'
c8c508b6537bf061dae5066a,What was the output that patient 10022880 first had on 04/03/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-04-03' ORDER BY outputevents.charttime ASC LIMIT 1 )",[],"SELECT MIN(output_date), output FROM patient_outputs WHERE patient_id = '10022880' AND output_date >= '04/03/2100' ORDER BY output_date ASC LIMIT 1"
1bd83a6f25d3ac9d966ec9e9,What was the total number of input patient 10020944 has received on 03/07/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '03-07'",[{'SUM(inputevents.totalamount)': None}],"SELECT SUM(input_count) AS total_input_count FROM PatientInput WHERE patient_id = 10020944 AND date = DATE_FORMAT(NOW() ,'%Y/%m/%d') - INTERVAL DAYOFMONTH(NOW())+6 DAY"
39b8b45889cc5475dedfa102,Count the ICU visits of patient 10018328 since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}],"SELECT COUNT(*) AS ICU_Visits FROM icustays WHERE subject_id = 10018328 AND intime >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR)"
a2556a4a997d1f09c6a72589,How much heparin was given to patient 10020740 for the last time in 06/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'heparin' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT * FROM `heparin_administration` WHERE `patient_id` = 10020740 AND `date` = (SELECT MAX(`date`) FROM `heparin_administration` WHERE `patient_id` = 10020740 AND `date` LIKE '06/%')
6246ddb668aaa2fe1adb0353,How many hours have passed since last time that patient 10004733 stayed in careunit neurology in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1",[],"select datediff(hour, max(convert(datetime, StayDate + ' ' + StayTime)), convert(datetime, getdate())) from patientstay where PatID = 10004733 and HOSPID = 1 and CareUnit = 'NEUROLOGY' and VisitNumber = (select max(VisitNumber) from patientstay where PatID = 10004733 and HOSPID = 1)"
c152c5dd0a1f2626db79696c,What is the ward id that allows patient 55247 to be admitted?,,,select ward_id from admissions where patient_id = 55247
b9aa9ee30245b8000f1127e3,"How many patients underwent extirpation of matter from left femoral vein, percutaneous approach in this year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,"SELECT COUNT(*) AS ""Total Patients"" FROM medical_records WHERE procedure = 'Extirpation of Matter from Left Femoral Vein, Percutaneous Approach' AND YEAR(procedure_date) = YEAR(CURDATE());"
9a8d0a7f72b2f306a779ac82,Has patient 10010471 been checked into the hospital since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10010471 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 1}],"SELECT `CheckInDate` FROM `PatientCheckIn` WHERE `PatientID` = 10010471 AND `CheckInDate` > DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
8ca8f566936f59b5c916eadf,"In patients who had the resection of vessel with replacement, thoracic vessels since 1 year ago, what were the three most common diagnoses that followed in the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'resection of vessel with replacement, thoracic vessels' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patient_records WHERE procedure_date >= NOW() - INTERVAL 1 YEAR AND procedure_type = 'thoracic vessel resection with replacement' GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3"
1ca13ce347fd46ac69499979,What was diagnosed for patient 10037928 the first time in their first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,SELECT ... FROM ... WHERE ...
5442daaf8455ec924ced4a84,Will patient 99082 be given any additional stool (received in transport system) test?,,,select count(*) from lab_results where patient_id = 99082 and test_name = 'stool' and result_date = (select max(result_date) from lab_results where patient_id = 99082)
163f4af47f19becb80903c30,How many medications were assigned to patient 10035185 since 8 months ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-8 month')",[{'COUNT(*)': 104}],"SELECT COUNT(*) FROM Meds WHERE PatientID = 10035185 AND DatePrescribed >= DATE_SUB(CURDATE(), INTERVAL 8 MONTH)"
28b46c82ec1854678938782d,Please tell me the sex of patient 10014078.,SELECT patients.gender FROM patients WHERE patients.subject_id = 10014078,[{'gender': 'F'}],"SELECT ""sex"" FROM `patients` WHERE ""patient_id"" = '10014078' LIMIT 1;"
87cc300179a5fe28e3498b5e,Did patient 10004235 experience any procedure in the last year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"select * from procedure_occurrence where person_id=10004235 and procedure_date>=date_sub(curdate(),interval 1 year)"
7c03fe01f161036f720f6d7e,Has there been any organism detected in the first microbiological examination of patient 10019385's urine on their last hospital encounter?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'COUNT(*)>0': 0}],[select count(1) from labevents le
f8421512590cea257bf8a931,"Retrieve the top three most frequent medications that patients were prescribed in the same month after being diagnosed with hyperlipidemia, unspecified since 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperlipidemia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,
6a1bd90b69ca958eeb14cef8,Has patient 10007795 gotten any medication since 03/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",[{'COUNT(*)>0': 1}],SELECT * FROM medication_records WHERE patient_id = 10007795 AND date >= '03/2100'
58dca5f1f34e6a0994b147eb,When was the last time the heart rate of patient 10005909 was measured to be less than 106.0 since 04/04/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 106.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-04-04' ORDER BY chartevents.charttime DESC LIMIT 1",[],[SELECT MAX(measurement_date) AS last_measurement_date
1d9b591db242abe298d896a5,"Among patients diagnosed with diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled since 1 year ago, what are the top five medications prescribed within 2 months to patients in their 40s?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"[SELECT medication, COUNT(*) as prescription_count"
9d3fa7a1702389bcc1a4904b,When did the first time patient 10016742 had the maximum value of respiratory rate during their first ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(STARTDATE) FROM ICUReadings WHERE SUBJECT_ID = '10016742' AND CATEGORY = 'respiratory rate' AND ROW_ID IN (SELECT ROW_ID FROM ICUReadings WHERE SUBJECT_ID = '10016742' AND CATEGORY = 'respiratory rate' GROUP BY SUBJECT_ID, CATEGORY, ROW_ID HAVING MAX(VALUE) = (SELECT MAX(VALUE) FROM ICUReadings WHERE SUBJECT_ID = '10016742' AND CATEGORY = 'respiratory rate'));"
ee04b4b7af645ba90c2bd384,What's the reimbursement standard for pharmaceuticals?,,,select reimbursment from drug where reimbursment is not null
cdeaa55f2c3e7ba95eec9c4a,When did patient 10021487 have the minimum value of creatinine first in the current hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],SELECT MIN(RESULT_DATE) FROM LAB_RESULTS WHERE PATIENT_ID = '10021487' AND RESULT_VALUE = (SELECT MIN(RESULT_VALUE) FROM LAB_RESULTS WHERE PATIENT_ID = '10021487' AND ENCOUNTER_ID = (SELECT MAX(ENCOUNTER_ID) FROM ENCOUNTERS WHERE PATIENT_ID = '10021487'))
7f6a053c4c7996cce251e27b,Tell me the average overall hospital cost that includes potassium chl 20 meq / 1000 ml d5lr since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_charge) FROM hospital_charge WHERE drug_name = 'potassium chloride 20 mEq in 1000 ml D5W' AND charge_date >= '2100-01-01'
9d8591acb0d3258f159e45cc,"What is the average yearly number of patients affected by diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled since 2100?","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,"SELECT AVG(yearly_patient_count) FROM diabetes_statistics WHERE complication_description = '' AND type_description IN ('Type II', 'Unspecified Type', 'Without mention') AND control_status = 'Not stated as uncontrolled' AND year >= 2100"
f6ad015f8e12733510bfd83d,"When, in 12/this year, was the last time patient 10021487 was prescribed a medication via the tp route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'tp' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(prescription_date) FROM prescription_data WHERE patient_id = '10021487' AND prescription_route = 'TP' AND EXTRACT(MONTH FROM prescription_date) <= 12 AND EXTRACT(YEAR FROM prescription_date) = EXTRACT(YEAR FROM CURRENT_DATE)
07c1c8b47f2651220e2fa40f,How many patients stayed on med/surg?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT MRN) AS patient_count FROM hospital_stays WHERE service_type = 'Med/Surg'
0e79ae45b54260645fa447df,Has patient 5828 had any additional catheter tip-iv test performed on him?,,,SQL Query Here
776aa437e8c7772107f91170,Did patient 10021312 have any prescriptions for medicines on their last hospital encounter?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) FROM prescriptions WHERE patient_id = 10021312 AND encounter_id = (SELECT MAX(encounter_id) FROM encounters WHERE patient_id = 10021312)
be2ea8ec1974fc0574f2921f,"Has patient 10021487 had a total nucleated cells, pleural test done in 10/last year?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) AS test_count FROM laboratory_tests WHERE patient_id = 10021487 AND test_name = 'total nucleated cells, pleural' AND test_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW()"
8767ec4e6f5bb384a55e1f3a,"Since 2100, what are the top five most frequent procedures that patients received within 2 months after being diagnosed with pseudomonas infection in conditions classified elsewhere and of unspecified site?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pseudomonas infection in conditions classified elsewhere and of unspecified site' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"select top 5 procedure_name, count(*) as frequency from procedures p join diagnoses d on p.patient_id = d.patient_id where d.condition = 'pseudomonas infection in conditions classified elsewhere and of unspecified site' and p.date >= d.date and p.date <= dateadd(month, 2, d.date) group by procedure_name order by frequency desc"
1d7daad1762a274e42d1274a,"What's the cost for drainage of left pleural cavity, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) )",,"select distinct concept_code from snomedct where term like '%drainage of left pleural cavity, percutaneous approach%' order by concept_code desc"
4dbad1cc3c3af06c5664a2ad,"During the last year, was patient 10014354 in an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM medical_records WHERE patient_id = 10014354 AND visit_type = 'emergency' AND visit_date BETWEEN '2022-01-01' AND '2022-12-31'
6e39fda592a8e6af9e50df9b,"Since 10/2100, lactated ringers, cisatracurium besylate, or glucose gel has been prescribed for patient 10018081.","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.drug IN ( 'lactated ringers', 'cisatracurium besylate', 'glucose gel' ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'",[{'COUNT(*)>0': 0}],"[SELECT DISTINCT p.name, a.start_date"
c1cbfb46dafe04deb682724d,Can you tell me the first recorded weight for patient 10015272?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT MIN(weight) FROM patient_measurements WHERE patient_id = 10015272 AND measurement_type = 'weight' GROUP BY patient_id
4cc7f474aee41be6f9a8dc37,What is the code in icd-11 for klebsiella pneumoniae in icd-10?,,,select code from ICD11 where desc like '%klebsiella pneumoniae%' and icd10_code = 'J15.2'
ecdd6175747da4a32daa8f99,What was the name of the medication which patient 10021487 was prescribed during the same day after receiving enteral infusion of concentrated nutritional substances since 06/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,SELECT ...
43ac9cba569c151427df4304,What did patient 10021666 have last as the output since 03/28/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-28' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],SELECT output FROM patient_records WHERE patient_id = 10021666 AND date >= '03/28/2100' ORDER BY date DESC LIMIT 1
f1d835a5bb021603f18ae280,Do you know patient 9566 went to another country?,,,select count(*) from visits where patient_id = '9566' and country != 'US'
51ad9f66e93f33042ccc4669,When did patient 10039831 get their first input since 11/24/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-24' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2115-12-28 20:38:00'}],SELECT MIN(InputDate) FROM PatientInputData WHERE PatientID = '10039831' AND InputDate > '11/24/2100'
f2fb4d6b40dabed3a0ffdc3e,Show me patient 10010471's daily maximum weight since 2100.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"select patient_id, date, max(weight) from daily_weight_records where patient_id = 10010471 and date >= '2100-01-01' group by patient_id, date order by date"
53cdff279789d1183c4e5a86,What about the single rooms out there now?,,,select * from room where roomtype='single' and status='available'
555c677326428762a09481c7,Has patient 10021312 been provided any medications?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ),[{'COUNT(*)>0': 1}],SELECT DISTINCT medication FROM patient_records WHERE patient_id = 10021312
9d2d12172b2bedc5632b132e,Has patient 10038933 been on any boost glucose control (full) since 02/04/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'boost glucose control (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-04'",[{'COUNT(*)>0': 0}],select count(*) from medical_records where patient_id = '10038933' and treatment_name = 'boost glucose control (full)' and treatment_date >= '2100-02-04'
5ae7505a2520a19129c81edd,What is the body weight change of patient 10020740 last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT pw1.body_weight - pw2.body_weight AS weight_change FROM patient_weight pw1 JOIN patient_weight pw2 ON pw1.visit_id = pw2.visit_id AND pw1.encounter_id = pw2.encounter_id AND pw1.patient_id = pw2.patient_id WHERE pw1.patient_id = 10020740 AND pw1.visit_id = (SELECT visit_id FROM patient_visit WHERE patient_id = 10020740 AND visit_concept_id = 9202 ORDER BY visit_start_date ASC LIMIT 1) AND pw1.encounter_id = (SELECT encounter_id FROM patient_encounter WHERE patient_id = 10020740 AND visit_id = pw1.visit_id ORDER BY encounter_start_date DESC LIMIT 1) AND pw2.seq_num = (SELECT MAX(seq_num) FROM patient_weight WHERE visit_id = pw1.visit_id AND encounter_id = pw1.encounter_id AND seq_num < (SELECT seq_num FROM patient_weight WHERE visit_id = pw1.visit_id AND encounter_id = pw1.encounter_id ORDER BY seq_num DESC LIMIT 1))
50d49912da164775f9dc831f,Give me patient 10021487's total peptamen bariatric (full) input.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'peptamen bariatric (full)' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input) FROM nutritional_intake WHERE patient_id = 10021487 AND product_name = 'peptamen bariatric (full)'
cb1a4e3e68a3305cbed774f1,What was the name of the drug that was prescribed first to patient 10022017 since 04/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Sodium Chloride 0.9%  Flush'}],"SELECT MIN(prescription_date) AS first_prescription_date, drug_name FROM prescriptions WHERE patient_id = 10022017 AND prescription_date >= '04/2100' ORDER BY prescription_date ASC LIMIT 1"
c8b3ff2eeceef81045187d16,What were the name of the treatment received by patient 10038081 two or more times in their last hospital encounter?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,SQL Query here
ee69065549df2afefab7aae1,What is patient 10018328's gender?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10018328,[{'gender': 'F'}],SELECT patient_gender FROM patient_info WHERE patient_id = '10018328';
def6d375a2be3ced2d907c6d,What are the various ways to consume 5% dextrose (excel bag)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = '5% dextrose (excel bag)',[],SELECT method_of_consumption FROM medical_procedures WHERE solution_name = '5% dextrose' AND solution_type = 'excel bag'
919fd2fec23929480d56959a,How much is the difference of urea nitrogen of patient 10021118 second measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT ABS(MIN(m1.value)-MIN(m2.value)) AS difference FROM medical_records m1 JOIN medical_records m2 ON m1.patient_id = m2.patient_id WHERE m1.patient_id = '10021118' AND m1.type = 'Urea Nitrogen' AND m1.visit_number = 1 AND m1.measurement_sequence = 2 AND m2.type = 'Urea Nitrogen' AND m2.visit_number = 1 AND m2.measurement_sequence = 1
d6b7b3ab6732956bc3e0fc24,How many hours have passed since patient 10021487 got his first diagnosis of acidosis on this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acidosis' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"select datediff(hour, (select visit_start_datetime from hospital_visit where visit_id = (select visit_id from visit_detail where patient_id = 10021487 and diagnosis = ""acidosis"" and is_primary = 1 order by visit_start_datetime desc limit 1)), current_timestamp) as hours_since_first_acidosis_diagnosis"
b88e4ef160b32df83a1e6e63,How many drugs were given to patient 10004720 since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)': 82}],"SELECT COUNT(*) AS TotalDrugs FROM drug_administration WHERE patient_id = 10004720 AND date_administered >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
0f03144b28c1a640986c7ffc,When was the last test of patient 10008454's microbiology urine since 09/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SQL Query Here
029b91056c419bf0d15c3c15,What precautions should you follow after the nonop cardiac/vasc exam procedure?,,,SELECT precaution FROM medical_guidelines WHERE procedure = 'nonop cardiac/vasc exam' AND category = 'Aftercare'
1153946181f7d7b47dbdc917,When did patient 10007818 receive the tobramycin test for the last time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tobramycin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT MAX(date) FROM lab_tests WHERE patient_id = 10007818 AND test_name = 'tobramycin';
ae481d3d9b25f812bf25bdfd,"What are the four commonly given procedures for patients that also received other incision of brain previously within the same hospital visit, since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,Your SQL Query Here
f80d944a40468e69f130d0ca,How much does personal history of other diseases of digestive system cost to get diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other diseases of digestive system' ) ),,SELECT AVG(cost) FROM diagnostic_tests WHERE category='other diseases of digestive system' AND category_type='personal history' AND category_group='diagnostic tests';
447ce94b8c1311a33e0848fc,What new meds are prescribed to patient 10004733 today compared to the ones from yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT DISTINCT T1.medication_name FROM patient_meds T1 LEFT JOIN patient_meds T2 ON T1.patient_id = T2.patient_id AND T2.date = 'yesterday' WHERE T1.patient_id = 10004733 AND T1.date = 'today' AND T2.medication_name IS NULL
f04c7d3113bb51fa52b5acf5,"What is patient 10002495's difference in cholesterol, total from the last value measured on the last hospital visit compared to the first value measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT MAX(totcholesterol) - MIN(totcholesterol) AS cholesterol_difference FROM labevents WHERE subject_id = 10002495 AND hadm_id = (SELECT MAX(hadm_id) FROM labevents WHERE subject_id = 10002495)
7a05f054a0d752aa65a229c4,When did patient 10039997 last receive an input since 08/11/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-11' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2134-09-08 17:50:00'}],SELECT MAX(date) FROM patient_treatment WHERE patient_id = '10039997' AND date > '08/11/2100' AND treatment_type = 'input'
88d1d764d3e45a0ff254d45a,"Among patients diagnosed with other diseases of lung, not elsewhere classified, what are the top three most common lab tests conducted within the same hospital visit in this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of lung, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,SQL Query
6f1219fa346b449ef48710c1,Tell me the total volume of input for patient 10014354 since 10/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-12'",[{'SUM(inputevents.totalamount)': 29320.0}],SELECT SUM(input_volume) AS total_volume FROM patient_data WHERE patient_id = 10014354 AND input_date >= '10-12-2100';
ac0778f01b4dfce5b48de369,List the top five most frequently prescribed medications since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]","SELECT medication_name, COUNT(*) AS prescription_count FROM prescriptions WHERE prescription_date >= DATE_SUB(NOW(), INTERVAL 1 YEAR) GROUP BY medication_name ORDER BY prescription_count DESC LIMIT 5;"
d8df22b2ce5cbb8d4e6d6f4d,How much is the drug named bag?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'bag' ),,SQL Query here
ad2612489dcd53ed00312d17,"How many days have elapsed since the last time patient 10021487 was diagnosed with injury to liver without mention of open wound into cavity laceration, unspecified in their current hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to liver without mention of open wound into cavity laceration, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"select extract(days from current_date - max(v.date)) as ""Elapsed Days"" from visits v inner join visit_details vd on v.visit_id = vd.visit_id inner join diagnoses d on vd.diagnosis_id = d.diagnosis_id where v.patient_id = 10021487 and d.term = 'Injury to liver without mention of open wound into cavity laceration, unspecified' and v.visit_end_date is null and v.visit_start_date = (select max(v2.visit_start_date) from visits v2 where v2.patient_id = 10021487 and v2.visit_end_date is null)"
e449057b794c66a951ffc20d,Can you tell me the total amount of metoprolol succinate xl that patient 10020944 has been prescribed in 03/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'metoprolol succinate xl' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(quantity) AS total_mg FROM prescriptions WHERE patient_id = '10020944' AND drug_name = 'metoprolol succinate xl' AND order_date BETWEEN '03/01/2100' AND '03/31/2100'
4293159f67c757b21ef6659a,Count the number of patients who had their other cell tested in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'other cell' ) AND strftime('%Y',labevents.charttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from (select distinct patient_id from patient_test_other_cell where test_year=2100) as t
71e8c2b5076850658d8e63ed,"Among patients who were given destruction of right lower lung lobe, via natural or artificial opening endoscopic in 2100, what are the top four most common specimens tested afterward during the same hospital visit?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,Specimen
820528745b6eb9d481abf58f,Can you tell me the top four most common treatments for patients in their 30s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT treatment, COUNT(*) as patient_count FROM patient_records WHERE age BETWEEN 30 AND 39 GROUP BY treatment ORDER BY patient_count DESC LIMIT 4"
8bbc16e7b33ddf49226c0c8e,How much sodium bicarbonate was prescribed the last time since 11/2100 to patient 10006053?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND prescriptions.drug = 'sodium bicarbonate' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT total_quantity FROM prescriptions WHERE patient_id = 10006053 AND ingredient = 'sodium bicarbonate' AND date_prescribed BETWEEN '2023-11-01' AND CURRENT_DATE ORDER BY date_prescribed DESC LIMIT 1
bbfcc311f9650f6a3a91f0b6,What is the average monthly number of patients diagnosed with bariatric surgery status?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bariatric surgery status' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,Your SQL query here
c868b0184dd86f732c24d8f6,What immuno-cancer drugs are in use over the last five years?,,,"SELECT drug_name FROM immuno_cancer_drugs WHERE approval_date >= DATE_SUB(CURDATE(), INTERVAL 5 YEAR) AND status = 'in use'"
062575cdb38e709723edbb54,What was the drug that patient 10018081 was prescribed for the last time using a po/ng route since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1",[],
f6ff7f1d41f19c951d2854e9,Get me the top five most frequent procedures that patients received within 2 months after receiving closed [endoscopic] biopsy of bronchus since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 ProcedureCode, COUNT(*) AS ProcedureCount FROM PatientProcedures WHERE ProcedureDate BETWEEN DATEADD(MONTH, -2, ProcedureDate) AND ProcedureDate AND PrecedingProcedureCode = 'Closed Endoscopic Biopsy of Bronchus' AND ProcedureDate >= '2100-01-01' GROUP BY ProcedureCode ORDER BY ProcedureCount DESC"
6c01e0679abf5f4770e5efe4,What are the five most frequently ordered laboratory tests this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],Your SQL Query Here
d936f940a2ec69a598302c7c,What is the difference between mean blood pressure on patient 10002495 last measured on the last ICU visit compared to the value second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT AVG(bp_value) - LAG(AVG(bp_value)) OVER (PARTITION BY patient_id ORDER BY visit_date DESC) AS bp_difference FROM blood_pressure_measurements WHERE patient_id = '10002495' AND visit_date IN (SELECT DISTINCT visit_date FROM blood_pressure_measurements ORDER BY visit_date DESC LIMIT 2);
a112ad7cd8202090ededa192,What was the first o2 saturation pulseoxymetry value that patient 10004733 had on this month/23?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '23' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT TOP 1 PulseOximetry FROM Patient_O2_Saturation WHERE PatientID = '10004733' AND Date >= '2023-04-01' AND Date < '2023-05-01' ORDER BY Date ASC
3c11cf08e04cd8e55787eb1f,What was the last time patient 10009035 had a mrsa screen microbiology test in 05/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],"SELECT MAX(date) as ""Last MRSA Screen Date"" FROM microbiology WHERE patient_id = 10009035 AND test_name = 'mrsa screen' AND YEAR(date) = YEAR(CURRENT_DATE) AND MONTH(date) = 5"
5c86eada276c78a8735e0dfb,What are the new drugs prescribed to patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT DISTINCT Drug FROM Prescriptions WHERE PatientID = 10039831 AND DatePrescribed = CURRENT_DATE AND Drug NOT IN (SELECT Drug FROM Prescriptions WHERE PatientID = 10039831 AND DatePrescribed = CURRENT_DATE - INTERVAL '1 DAY')
110b301bfc80d9c150556b92,What was measured as patient 10007795's weight during the last check in 05/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.charttime) = '05' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT Weight FROM Measurements WHERE PatientID = '10007795' AND DateOfMeasurement = (SELECT MAX(DateOfMeasurement) FROM Measurements WHERE PatientID = '10007795' AND DateOfMeasurement LIKE '2023-05%')
8c6f20f6c2e2c7185fddb381,What is the average total hospital expense that includes malignant neoplasm of rectosigmoid junction since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of rectosigmoid junction' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SQL Query Here
fa8402cd41bf604fac740f8c,Has patient 10026354 had nacl 0.9% given since 03/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03'",[{'COUNT(*)>0': 0}],SELECT * FROM medication_records WHERE patient_id = '10026354' AND medication_name = 'nacl 0.9%' AND administration_date >= '03/2100';
650faa5ad60fd0f4f2dee70a,What is the procedure on anticancer drugs?,,,SELECT * FROM drugs WHERE category = 'anticancer'
9ab9f7bcf85120221b47db91,Get me the top four most frequent diagnoses for patients of age 40s since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) as frequency FROM PatientRecords WHERE age BETWEEN 40 AND 49 AND diagnosis_date >= CURDATE() - INTERVAL 1 YEAR GROUP BY diagnosis ORDER BY frequency DESC LIMIT 4"
f7afdc32d94d128115a2b257,"Has patient 10002428 been ordered 0.45% sodium chloride, lisinopril, or heparin since 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND prescriptions.drug IN ( 'lisinopril', '0.45% sodium chloride', 'heparin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 0}],SELECT patient_id FROM orders WHERE patient_id = 10002428 AND (order_description LIKE '%0.45% sodium chloride%' OR order_description LIKE '%lisinopril%' OR order_description LIKE '%heparin%') AND order_date >= '2100-01-01'
03f81bdff77fe530b0d0fe7d,Can you indicate the daily maximum dose of solution that patient 10031757 received during their first ICU stay?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],SELECT MAX(dose) FROM daily_dose WHERE patient_id = 10031757 AND stay_id = (SELECT MIN(stay_id) FROM icustay_detail WHERE patient_id = 10031757)
ce6918d801a0e9dc37e563ce,What were the top four most frequently prescribed medicines this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4",[],SELECT medication_name FROM prescriptions WHERE prescription_date >= '2023-01-01' AND prescription_date <= '2023-12-31' GROUP BY medication_name ORDER BY COUNT(*) DESC LIMIT 4
f613480747542c410142b4ea,When was the last input time since 07/11/2100 for patient 10021487?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-11' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2117-03-09 14:20:00'}],YourTableName
c1f369fb99bd717e87c34253,"On their first hospital encounter, was patient 10009049 given any diagnosis?",SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT 'yes' AS diagnosis_given FROM hospital_visits WHERE patient_id = '10009049' AND diagnosis IS NOT NULL AND encounter_number = 1 LIMIT 1;
07c43928bf97ed8bc8540e78,Tell me the name of the output patient 10025612 had for the last time?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 ),[{'label': 'Foley'}],SELECT name FROM Output WHERE patient_id = 10025612 ORDER BY date DESC LIMIT 1
0c1c6ad6a0a679043de5adc2,How long ago did patient 52647 receive a medication that should be taken regularly?,,,"SELECT DATE_DIFF(CURRENT_DATE, MIN(medication_administration.date_administered), DAY) AS days_since_last_medication FROM `bigquery-public-data.hospitals_fhir.patient` p INNER JOIN `bigquery-public-data.hospitals_fhir.medication_administration` m ON p.id = m.subject_id WHERE p.id = '52647' AND m.medication_reference IS NOT NULL AND m.additional_notes LIKE '%regular%';"
af3705067de009f76d7a8031,What was the number of patients who were prescribed iso-osmotic dextrose in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic dextrose' AND strftime('%Y',prescriptions.starttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL Query Here
1d930d1bc64cf3b52d4cfe25,Tell me the total output on 11/28/this year for patient 10027602.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '11-28'",[{'SUM(outputevents.value)': None}],
63e5457b5b019e78c8dbf939,What were the top three most common microbiology tests for patients who were previously diagnosed with neoplasm of unspecified nature of endocrine glands and other parts of nervous system within the same hospital visit since 1 year ago?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'neoplasm of unspecified nature of endocrine glands and other parts of nervous system' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3",,"SELECT top_3_microbiology_tests, COUNT(*) AS test_count FROM microbiology_tests JOIN patients ON microbiology_tests.patient_id = patients.id WHERE patients.diagnosis IN ('neoplasm of unspecified nature of endocrine glands', 'neoplasm of other parts of nervous system') AND microbiology_tests.visit_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) AND CURRENT_DATE GROUP BY top_3_microbiology_tests ORDER BY test_count DESC LIMIT 3"
86f9f9f4d49dd3a3f7c9fedf,What was the new drug for patient 10039831 today compared to the one prescribed yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"SELECT d2.drug_name AS today_drug, d1.drug_name AS yesterday_drug FROM (SELECT drug_name, patient_id, order_date FROM drug_orders WHERE patient_id = 10039831 AND order_date = CURRENT_DATE) d2 LEFT JOIN (SELECT drug_name, patient_id, order_date FROM drug_orders WHERE patient_id = 10039831 AND order_date = CURRENT_DATE - INTERVAL '1 day') d1 ON d2.patient_id = d1.patient_id"
11a79e0284c0d972831a98a0,When was the last input time since 10/09/2100 for patient 10021938?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-09' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2181-10-26 20:38:00'}],SELECT MAX(input_date) FROM patient_data WHERE patient_id = '10021938' AND input_date > '2100-10-09'
cd1253c3a3d160eab14d31d4,How much is the difference of glucose of patient 10021938 last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT ABS(MIN(glucose) - MAX(glucose)) FROM visits WHERE patient_id = 10021938 GROUP BY patient_id HAVING MIN(visit_date) = MAX(visit_date)
7e56a0516c482d121cd99bc1,Has there been any organism observed in patient 10021118's last staph aureus swab microbiology test since 1 year ago?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],[SELECT DISTINCT om2.organism
5f192a749e3dc5e91eff2fd7,The value of mch of patient 10004733 was last measured on the current hospital visit greater than second to last measured on the current hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","select `10004733`.`mch` from (select `10004733`.`mch`, `10004733`.`encounter_id` from `labevents` as `10004733` where `10004733`.`itemid` = 50868 and `10004733`.`person_id` = 10004733 order by `10004733`.`charttime` desc) as `last_value` join (select `10004733`.`mch`, `10004733`.`encounter_id` from `labevents` as `10004733` where `10004733`.`itemid` = 50868 and `10004733`.`person_id` = 10004733 order by `10004733`.`charttime` desc limit 1,1) as `second_to_last_value` on `last_value`.`encounter_id` = `second_to_last_value`.`encounter_id` where `last_value`.`mch` > `second_to_last_value`.`mch`;"
16690ffc32c0b935ca799d7f,What are the five most frequently performed treatments for patients in their 60 or above in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT treatment, COUNT(*) AS frequency FROM patient_treatments WHERE YEAR(date) = 2100 AND age >= 60 GROUP BY treatment ORDER BY frequency DESC LIMIT 5"
5812f2aa2ec32908144ea996,What is the name of the procedures that were given to patient 10005909 two or more times?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,SQL Query Here
abe78de7464f93993da9c600,How many hours elapsed since the first time patient 10039831 received a phosphate lab test on this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT EXTRACT(EPOCH FROM (MAX(EXTRACT(EPOCH FROM pha_datetime)) - MIN(EXTRACT(EPOCH FROM pha_datetime))))/3600 FROM laboratory_events WHERE patient_id = 10039831 AND lab_test_type = 'Phosphate' GROUP BY patient_id
132963e711d7f2dfe87f94dc,What was the last hospital admission type for patient 10021666 during?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10021666 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1",[],SQL Query
c9b9077631942180f3a3b0ed,What is the precautionary measure following the head & neck endarter nec procedure?,,,SQL Query Here
6b368507937b705eba056861,"What are the five most frequently given lab tests for patients that were diagnosed with family history of malignant neoplasm of breast previously during the same hospital visit, in 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of breast' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"[SELECT lab_test, COUNT(*) AS frequency"
1e2f66da2eb65a0b588daf76,How many patients were given a basophils lab test during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM lab_tests WHERE test_name = 'Basophils' AND YEAR(test_date) = YEAR(CURRENT_DATE) AND test_result IS NOT NULL
695030002227c1585f70824e,"Among patients diagnosed with accidental fall on or from other stairs or steps since 2100, what are the top three medications prescribed within the same month to patients in their 30s?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental fall on or from other stairs or steps' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 39 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"select top 3 med_code, med_name, count(*) as number_prescribed from nyc_po_patients p inner join nyc_po_prescriptions r on p.patid = r.patid inner join nyc_po_visit_occurrence v on p.patid = v.patid inner join nyc_po_drug_exposure d on r.rxnorm = d.rxt_id where d.exposure_start_date between v.visit_start_date and v.visit_end_date and v.visit_concept_id = 4299424 and v.visit_start_date >= '2100-01-01' and d.exposure_start_date >= '2100-01-01' and r.age <= 40 and r.age >= 30 group by med_code, med_name order by number_prescribed desc"
467265322cf858e76174f260,"What are the total maximum expenses for a hospital involving a laboratory test for thyroxine (t4), free?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroxine (t4), free' ) ) GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_max) FROM `condition_occurrence` c JOIN `procedure_occurrence` p ON c.person_id = p.person_id WHERE c.condition_concept_id = 4021891 AND c.condition_source_value LIKE '%T4 Free%' AND p.procedure_concept_id = 38000254
2c1f374a404a551c3391df72,How many patients had angiocardiography of left heart structures done throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'angiocardiography of left heart structures' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,SELECT COUNT(DISTINCT PatientID) FROM PatientRecords WHERE Procedure = 'Angiocardiography' AND HeartStructure = 'Left' AND YEAR(ProcedureDate) = YEAR(CURDATE());
4a31a2d75cf6e073cdeef706,What was the name of the drug that was first prescribed for patient 10001725 since 04/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Ondansetron'}],SELECT name FROM prescriptions WHERE patient_id = 10001725 ORDER BY date_prescribed ASC LIMIT 1
00979fbe4ba004cc20246b9a,Patient 15209 is subject to covid-19 testing,,,SELECT * FROM `labevents` WHERE `itemid` = 811 and `subject_id` = 15209
fabcb3ee15b98badd66dcd76,How much was the difference in body temperature of patient 10005817 from the second-to-last value measured to the last value measured during the final ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT ... FROM ... WHERE ...
dfa9c58ea0197508d2682000,Was any prescription drug given to patient 10004235 in 03/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-03'",[{'COUNT(*)>0': 0}],SELECT * FROM prescriptions WHERE patient_id = '10004235' AND date_prescribed BETWEEN '2100-03-01' AND '2100-03-31';
2c36fe674f06fe07c1c1b71d,Is the value of anion gap of patient 10015272 last measured on the last hospital visit less than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN MAX(ag) > MIN(ag) THEN 'Yes' ELSE 'No' END AS Is_Lower FROM (SELECT ag, ROW_NUMBER() OVER (PARTITION BY patient_id ORDER BY visit_date DESC, lab_test_date DESC) AS rn FROM lab_results WHERE patient_id = 10015272 AND test_name = 'Anion Gap') AS last_visit WHERE rn = 1;"
d72835768250c3efcfb0ef0f,Let me know the total quantity of input patient 10027602 received on last month/24.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '24'",[{'SUM(inputevents.totalamount)': None}],"SELECT SUM(Quantity) FROM InputEvents WHERE PatientID = '10027602' AND EventDate >= DATEADD(month, -1, CAST(GETDATE() AS date)) AND EventDate < CAST(GETDATE() AS date)"
7b1b135317d758d40c445a0d,"Last time, what drug was prescribed for patient 10023117 on the last hospital stay?",SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[{'drug': 'HYDROmorphone (Dilaudid)'}],SELECT medication_name FROM prescriptions WHERE patient_id = '10023117' AND admission_date = (SELECT MAX(admission_date) FROM hospital_stays WHERE patient_id = '10023117')
68ed3b6273aa80637c7691c7,"In this year, what were the top four most commonly tested specimens?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",[],Your SQL query here
44142bfb9b0cf7c3ae3ebb6a,"Since 1 year ago, how many medications were prescribed to patient 10025612?","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)': 86}],"SELECT COUNT(*) as TotalPrescriptions FROM prescriptions WHERE patient_id = 10025612 AND prescription_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
3c3c48b480fadfdd63afc64a,What is the name of the procedures that were given to patient 10016742 two times since 07/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,select distinct p.name from procedure p where p.patient_id = 10016742 and p.procedure_date > '07/2100' and (select count(*) from procedure where patient_id = 10016742 and name = p.name) >= 2
4391a17af3d3dc9b48eb23de,Retrieve the top three most frequent procedures that were delivered to patients within 2 months after they received fluoroscopy of multiple coronary arteries using low osmolar contrast in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using low osmolar contrast' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,PROCEDURES
6fab218a9bcfb128b745f81b,Tell me what the top four most common diagnoses of patients with an age of 20s?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) AS diagnosis_count FROM patient_records WHERE age BETWEEN 20 AND 29 GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 4"
d8493e7bf9c18bcd8edb3a40,What was the drug that patient 10019777 was prescribed for the first time using a neb route during their last hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'neb' ORDER BY prescriptions.starttime ASC LIMIT 1,[],appropriate fields
290e46c4e70581545b39621a,What was the name of the outputs that patient 10029484 last had?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 ),[{'label': 'Void'}],SELECT `output_name` FROM `outputs` WHERE `patient_id` = 10029484 ORDER BY `date` DESC LIMIT 1
be52dc50e6aaa98ddf135fe9,What is the reimbursement model for drug?,,,select distinct reimbursement_model from drug
0d012e621517a4059d3caf10,Could you inform me the total output amount of patient 10021938 since 86 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-86 day')",[{'SUM(outputevents.value)': 690.0}],SQL Query Here
4587dd491b8793e1feba1da6,When was the last time patient 10018081 SaO2 was measured less than 99.0 yesterday.,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 99.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT MAX(measurement_time) FROM patient_vitals WHERE patient_id = 10018081 AND SaO2 < 99.0 AND DATE(measurement_time) = DATE(NOW() - INTERVAL 1 DAY)
f8c155d806d238a7b40fccc9,"For patient 10017492, what was the first polys reading during their last hospital visit?",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) ORDER BY labevents.charttime ASC LIMIT 1,[],"SELECT polys FROM patient_visits WHERE patient_id = 10017492 ORDER BY visit_date DESC, reading_time ASC LIMIT 1"
d2edfd01c7ab2bfa13268728,How many days have elapsed since patient 10004733 has first received a eosinophils lab test during this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT DATEDIFF(day, MIN(test_date), CURRENT_DATE) AS days_elapsed FROM lab_results WHERE patient_id = '10004733' AND test_type = 'eosinophils' AND encounter_id = CURRENT_ENCOUNTER_ID;"
99da27a442847a01bbdb593a,What is the count of famotidine prescriptions made?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'famotidine',[{'COUNT(*)': 7}],SELECT COUNT(*) FROM prescriptions WHERE drug_name = 'famotidine';
04c15bde72e4c64e49a380e7,How much is the total minimum cost for a hospital that includes a amylase lab test?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) ) GROUP BY cost.hadm_id ) AS T1,,"select distinct on (h.hospital_name) h.hospital_name, min(sum(t.cost)) from hospital h inner join test t on t.hospital_id = h.hospital_id where t.test_name = 'amylase' group by h.hospital_name order by h.hospital_name, min(sum(t.cost))"
25c3e1d8afe894678fc6be2a,When was the last time last month that patient 10019172 was prescribed with syringe and 0.9% sodium chloride at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'syringe' AND admissions.subject_id = 10019172 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10019172 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],
c0b58eb14940edd013085528,What was the organism detected during the first bronchial washings microbiology test of patient 10021312 since 08/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],"[select distinct m.sample_id, m.result, m.unit, m.tested_date, m.tested_by, p.patient_id, p.name, p.dob, p.gender"
d526b1d43696d492cab8fec9,How many current patients are there in the 30s age group?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,,SELECT count(*) FROM patient WHERE age BETWEEN 30 AND 39 AND CURRENT_DATE <= (date_of_birth + INTERVAL '30 years')
4086b5f6f40bd2dfb3952f6d,What was patient 10021666's minimum SaO2 in their first ICU stay?,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ),[{'MIN(chartevents.valuenum)': None}],select min(`SpO2`) from `mimiciii.icustays` where `subject_id`=10021666 and `hadm_id` in (select `hadm_id` from `mimiciii.icustays` where `subject_id`=10021666 order by `intime` asc limit 1)
a2c0369e9e1db224ff7cb590,What was the drug patient 10022281 was prescribed for the last time using the sc route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT prescription.drug_name FROM prescription WHERE patient_id = '10022281' AND route = 'sc' ORDER BY prescription_date DESC LIMIT 1
f93686c3008e71187f331de5,What were the four most frequent lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(*) as test_count FROM lab_tests WHERE test_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) GROUP BY test_name ORDER BY test_count DESC LIMIT 4;"
84f5dabf19eb4e0fd354fbef,What was the first respiratory rate in patient 10027445's body on 08/12/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '08-12' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT min(respiratory_rate) AS First_Rate FROM patient_data WHERE patient_id = '10027445' AND date = '2023-08-12' ORDER BY time_of_measurement ASC LIMIT 1
af48025f4da1ed8f5c1616e3,How many hours has it been since the first stay of patient 10004733 in the careunit medicine during this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MIN(starttime), MAX(endtime)) AS hours_since_first_stay FROM patient_stays WHERE patient_id = 10004733 AND careunit = 'medicine';"
e7b550eaa8e671a43a12d80f,Has there been any dextrose 5% given to patient 10004720 since 07/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-07'",[{'COUNT(*)>0': 0}],select * from labevents where subject_id=10004720 and itemid=50912 and charttime>datetime('2005-07-21 00:00:00')
631830633e3ef0505c85ca98,Calculate the total number of medications that patient 10004457 was prescribed throughout this year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)': 0}],SELECT COUNT(*) AS total_medications FROM prescriptions WHERE patient_id = '10004457' AND EXTRACT(YEAR FROM prescription_date) = EXTRACT(YEAR FROM CURRENT_DATE)
3ab5f4f4e306a69472e20429,Has patient 23224 an appointment in another hospital department?,,,select count(*) from appointments where patient_id = 23224 and department != (select department from appointments where patient_id = 23224 limit 1)
434dfa0e21a4e11280d53e6e,What was patient 10005909's daily average value of body weight in 2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],SELECT AVG(body_weight) FROM patient_data WHERE patient_id = 10005909 AND measurement_date BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY measurement_date
40aa706064637ead2ae39af7,How many patients were diagnosed with atherosclerotic heart disease of native coronary artery with unspecified angina pectoris within 2 months after first being diagnosed with atherosclerotic heart disease of native coronary artery with unstable angina pectoris since 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unspecified angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,SELECT COUNT(*) AS patient_count FROM patient_diagnoses pd1 WHERE pd1.diagnosis_code = 'atherosclerotic_heart_disease_native_coronary_angina_unspecified' AND EXISTS (SELECT 1 FROM patient_diagnoses pd2 WHERE pd2.patient_id = pd1.patient_id AND pd2.diagnosis_code = 'atherosclerotic_heart_disease_native_coronary_angina_unstable' AND pd2.diagnosis_date BETWEEN pd1.diagnosis_date - INTERVAL '2 MONTH' AND pd1.diagnosis_date AND pd2.diagnosis_date >= '2100-01-01')
29183d163063354c6c818147,Is there any medication that patient 10021487 has received since 12/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'",[{'COUNT(*)>0': 1}],select distinct medication from medication_history where patient_id = 10021487 and date >= '12/2100'
4fd5da8b9c864e5a3800f681,"What were the five most commonly performed lab tests for patients who were previously diagnosed with other diseases of bronchus, not elsewhere classified in the same hospital encounter, since 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of bronchus, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT lab_test_name, COUNT(*) AS test_count FROM lab_tests INNER JOIN diagnoses ON lab_tests.patient_id = diagnoses.patient_id WHERE diagnoses.disease_code LIKE 'J98.8%' AND lab_tests.encounter_date >= '2100-01-01' GROUP BY lab_test_name ORDER BY test_count DESC LIMIT 5"
a1a5f421d9b782f7e987091a,When and where are the rounds and procedures of dr. conerly?,,,
02964db902a561eae10282a2,"Did patient 10017492 have total protein, csf tests in 03/2100?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",[{'COUNT(*)>0': 0}],csf_tests
3a60895a1bcc132fc939a54a,What is the name of the medication which should not be administered during the contrast arteriogram-leg treatment?,,,SELECT Name FROM Medication WHERE NotAdministeredDuring LIKE '%contrast arteriogram-leg%'
37805d9674cc2e4525168916,"Among patients in their 60 or above this year, what were the top four most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"[select d.Dx, count(*) as diagnosis_count"
61a27855d733cbb01f805863,What was the procedure conducted on patient 10000032 two or more times?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,select procedure from procedure_occurrence where person_id = 10000032 group by procedure having count(procedure) >= 2
571c7531441ce4b75b1fe333,What was the first drug prescribed to patient 10009628 in 10/this year via the ng route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND prescriptions.route = 'ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"select prescription.drug_name, min(prescription.datetime) from prescription where prescription.patient_id = 10009628 and year(prescription.datetime) = 10 and prescription.route = 'ng' group by prescription.drug_name order by min(prescription.datetime) asc limit 1"
5e75262ac3a25d12e75712dc,So how many days has passed since patient 10004733's first pneumonitis due to inhalation of food or vomitus diagnosis on their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pneumonitis due to inhalation of food or vomitus' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT DATEDIFF(day, MIN(dtdx), GETDATE()) FROM {relevant_table} WHERE pid = 10004733 AND icd9cm LIKE '518%';"
9de280a78a2a5c2a9872c3b4,What was the name of the organism that was found in the first microbiology test on patient 10037861's urine since 08/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT name FROM microbiology_tests WHERE patient_id = 10037861 AND test_type = 'urine' AND test_date >= '08/2100' ORDER BY test_date ASC LIMIT 1
d3693b3ee981749f8a199c7b,"For the last time since 07/2100, what specimen test did patient 10007818 get?","SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'BLOOD CULTURE'}],select t2.test_type from test_results t1 inner join test_types t2 on t1.test_type_id=t2.test_type_id where t1.patient_id=10007818 order by t1.test_date desc limit 1
460140392f817cccb9e244d4,Retrieve the top five most frequent lab tests that patients had after being diagnosed with noncompliance with renal dialysis in the same hospital visit since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,select lab_test from lab_tests where visit_id in (select visit_id from visits where diagnosis = 'Noncompliance with renal dialysis' and visit_date >= '2100-01-01') group by lab_test order by count(lab_test) desc limit 5
3f37877d41058e4ed337aadb,What was the organism found in the first microbiology test done on the patient 10021312's bronchial washings since 03/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND microbiologyevents.spec_type_desc = 'bronchial washings' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT organism FROM microbiology_tests WHERE patient_id = '10021312' AND test_type = 'bronchial washings' ORDER BY test_date ASC LIMIT 1
024f3a6b35669ffe35709f85,I would like to know the top three diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",,"[SELECT diagnosis,"
45b7526b9941e4579af43e6c,Could you retrieve the top five most common outputs in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],"SELECT output, COUNT(*) AS frequency FROM simulation_results WHERE year = '2100' GROUP BY output ORDER BY frequency DESC LIMIT 5;"
4ae26018d8ea48c61224e513,"How many patients underwent spinal tap during the same hospital encounter after the diagnosis of unspecified essential hypertension, last year?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,"SELECT COUNT(DISTINCT patient_id) FROM encounter WHERE encounter_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE() AND diagnosis_code = 'essential_hypertension' AND procedure_code = 'spinal_tap' AND encounter_id IN (SELECT encounter_id FROM encounter WHERE diagnosis_code = 'essential_hypertension')"
de871565192e846d9c7ca39a,Did patient 10022017 have a pt test done in 10/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',labevents.charttime) = '2100-10'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM pt_tests WHERE patient_id = '10022017' AND test_date = '10/2100'
bb4344288238a4637074b5b3,Count how many patients were discharged from hospital throughout this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL Query
333df3a7ec5a12c84b0e951e,What was the total of zolpidem tartrate patient 10021487 had been prescribed in 12/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'zolpidem tartrate' AND strftime('%Y-%m',prescriptions.starttime) = '2100-12'",[{'SUM(prescriptions.dose_val_rx)': None}],"select sum(a.quantity) from orders o,order_detail a where a.order_id=o.order_id and a.medicine='zolpidem tartrate' and o.patient_id='10021487' and o.date between '2012-12-01' and '2012-12-31'"
5abb89ffecbb35ddc1f5b163,How much does vancomycin oral liquid cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin oral liquid' ),,select AVG(unit_price) from drug_cost where drug_name='vancomycin oral liquid' and formulation='liquid'
d1296c6e0fcaaa1292187c95,When was the last microbiological test of patient 10022281 since 06/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2125-06-17 05:30:00'}],select max(test_date) from microbiological_tests where patient_id = 10022281 and test_date > '06-2100'
a8ce51c1370a7fb07b65da1c,What's the protocol for anticancer drugs?,,,SELECT DISTINCT protocol FROM DrugProtocols WHERE drug_type = 'anticancer'
14a36d4ffabe710c621140cf,When was the last input of patient 10004733 during the last ICU visit?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,[{'starttime': '2174-12-12 18:00:00'}],select max(input_date) from icu_stays where patient_num='10004733'
c1b9f618d57148f9613d4e17,Which procedure was performed on patient 10027602 two or more times since 11/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-11' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"SELECT procedure_name, COUNT(*) AS times_performed FROM procedures WHERE patient_id = 10027602 AND date >= '11/2100' GROUP BY procedure_name HAVING COUNT(*) >= 2;"
1aa406c499de99518294077e,Tell me the minimum total hospital cost that involves endoscopic control of gastric or duodenal bleeding?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic control of gastric or duodenal bleeding' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT MIN(TOTALCOST) FROM HCCPUB2005 WHERE HCPCS LIKE '%G0105%' OR HCPCS LIKE '%G0104%'
abb065f7fb28acb0c3c8fb68,Tell me the top four most common diagnoses for patients aged 20s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,SQL Query
dcefbced3548a05ff203d8a9,Count the number of hospital visits that patient 10027602 had in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10027602 AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],select count(*) from visit where patient_id=10027602 and year=2100
f6001dcc7f0b69fb01da77ee,Calculate how many drugs patient 10007058 was prescribed since 09/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'",[{'COUNT(*)': 43}],select count(*) as num_drugs from prescription where patient_id = 10007058 and start_date >= '09/2100'
47b903aa15da43a35db353c7,"After getting diagnosed with acute on chronic diastolic heart failure, how many patients were found to have postinflammatory pulmonary fibrosis within 2 months in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,
bb02020436904947b9602d44,Tell me the percentile of the red blood cells value of 3.03 among patients of the same age as patient 10010471 in the first hospital encounter.,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 3.03",,SELECT PERCENT_RANK() OVER (ORDER BY red_blood_cells) AS percentile_rank FROM lab_tests WHERE patient_id IN (SELECT patient_id FROM patient_visits WHERE patient_id = 10010471 AND visit_type = 'first hospital encounter') AND red_blood_cells = 3.03
97b55cd17bce748e8c767456,I want to know the total volume of input patient 10001725 has received since 04/05/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-05'",[{'SUM(inputevents.totalamount)': 4450.0}],SELECT SUM(Volume) FROM (SELECT Volume FROM input WHERE PatientID = 10001725 AND Date >= '04/05/2100') AS subquery
395c9fa32c41aa7400cb5a87,"Count the number of people who received insertion of infusion device into right atrium, percutaneous approach in the same month after having been diagnosed with unspecified atrial flutter in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified atrial flutter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into right atrium, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT COUNT(*) FROM medical_records WHERE procedure_code = 'Insertion of infusion device into right atrium, percutaneous approach' AND diagnosis_code = 'Unspecified atrial flutter' AND YEAR(procedure_date) = 2100 AND MONTH(procedure_date) = MONTH(diagnosis_date)"
b2c10ed422acd1b5e903bf20,Show me patient 10020740's yearly maximum weight since 28 months ago.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') GROUP BY strftime('%Y',chartevents.charttime)",[],"[SELECT YEAR(date) AS Year, MAX(weight) AS MaxWeight"
d6c2a396d94d370d6f2348f2,How many patients were present in the vascular since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(*) FROM chartevents WHERE itemid = 227242 AND value >= 2100
c8434cc6732c978c99684d40,"On their first hospital visit, did patient 10020944 receive a venous catheterization, not elsewhere classified treatment?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM patient_records WHERE patient_id = '10020944' AND first_visit = TRUE AND treatment = 'venous catheterization, not elsewhere classified'"
0a52d95713114e75cad62068,How many patients had a diagnosis of edema of male genital organs?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'edema of male genital organs' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS patient_count FROM patient_diagnoses WHERE diagnosis_description = 'edema of male genital organs'
b0e8ceb89dac04c7f918d0aa,What was the condition patient 10038999 was diagnosed with last time in the first hospital encounter?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,select top 1 diagnosis from hospital_encounters where patient_id = '10038999' and hospital_encounter_id = (select min(hospital_encounter_id) from hospital_encounters where patient_id = '10038999') order by visit_date desc
b9f6116b0b39e50a2fa629e1,Is the value of anion gap last measured on the first hospital visit of patient 10005348 greater than its value second to last measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","select case when (select ag_last from (select ag, row_number() over (partition by patient_id order by hospital_visit_date desc) as rn from lab_results where patient_id = 10005348 and lab_test = 'anion_gap' and hospital_visit_number = 1) as subquery where rn = 1) > (select ag_last from (select ag, row_number() over (partition by patient_id order by hospital_visit_date desc) as rn from lab_results where patient_id = 10005348 and lab_test = 'anion_gap' and hospital_visit_number = 1) as subquery where rn = 2) then 'Yes' else 'No' end as comparison_result from dual"
07d28012648c5a33f74fb154,What were the three most common tests conducted on specimens since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]",SQL query to answer the question here
45055dee9d62c2fec5046a84,What medication was prescribed to patient 10021312 last time during the last hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[{'drug': 'Metoprolol Tartrate'}],SELECT last_prescription.medication FROM patient_records INNER JOIN hospital_visits ON patient_records.patient_id = hospital_visits.patient_id AND patient_records.patient_id = '10021312' INNER JOIN prescriptions ON hospital_visits.visit_id = prescriptions.visit_id WHERE hospital_visits.visit_date = (SELECT MAX(visit_date) FROM hospital_visits WHERE patient_id = '10021312') ORDER BY prescriptions.prescription_date DESC LIMIT 1;
0901f19617fd97688d40bbbd,When was the last time that on the last hospital stay patient 10021312 was prescribed a medication via po?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT max(admit_date) as last_admission_date FROM ADMISSIONS WHERE patient_id = 10021312; SELECT max(end_date) as last_medication_date FROM MEDICATIONS WHERE patient_id = 10021312 and route = 'PO' and admission_id IN (SELECT admission_id FROM ADMISSIONS WHERE patient_id = 10021312 AND admit_date = (SELECT max(admit_date) FROM ADMISSIONS WHERE patient_id = 10021312));
efd275d1b7116eb72bf67aaa,Calculate the number of closed [endoscopic] biopsy of bronchus procedures performed in 2100.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,SELECT count(*) FROM `physionet-data.mimiciii_procedures` WHERE `category` = 'Endoscopy' and `name` = 'Closed [endoscopic
9247b77bedc088fb1beb2f9c,What was the name of the organism discovered in the first sputum test of patient 10029291 in 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],"select ?organism from SputumTest where patient_id=10029291 and test_date=""02/2100"" order by test_date asc limit 1"
95b867d0cf6c28bfdd679151,How many hours has it been since the first other staphylococcus pneumonia diagnosis for patient 10004733 in their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other staphylococcus pneumonia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT EXTRACT(HOURS FROM AGE(current_timestamp, MIN(admit_date))) FROM diagnosis WHERE icd_code = 'J13' AND patient_id = 10004733 AND diagnosis_type = 'other' AND encounter_id = (SELECT encounter_id FROM admission WHERE patient_id = 10004733 ORDER BY admit_date DESC LIMIT 1)"
c66698669f239c7f44238998,What are the five most common laboratory tests undertaken by patients during the same hospital visit following a diagnosis of other cirrhosis of liver?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cirrhosis of liver' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"select lab_tests.lab_name, count(*) as count from lab_tests inner join lab_encounter on lab_encounter.lab_test_id = lab_tests.id inner join encounter on encounter.id = lab_encounter.encounter_id inner join visit on visit.id = encounter.visit_id inner join obs on obs.encounter_id = encounter.id where obs.concept_id = 164901 and obs.value_coded in (select concept2 from concept_map2concept where concept1 in (select concept_id from concept_name where name = ""Other cirrhosis of liver"" and voided = 0)) group by lab_tests.lab_name order by count(*) desc limit 5"
2cffa622f6560d843482b50d,How much is the cost of the acute and subacute hepatic failure without coma diagnosing?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute hepatic failure without coma' ) ),,SELECT SUM(Cost) FROM HealthcareCosts WHERE DiagnosisCode = 'AcuteHepaticFailureNoComa' OR DiagnosisCode = 'SubacuteHepaticFailureNoComa';
a3a2597423bb12f178e4e5b7,Can you show me the drug that patient 10020740 was last prescribed in 04/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1",[],"SELECT prescription.drug FROM prescription WHERE prescription.patient_id = 10020740 AND prescription.date BETWEEN DATE_FORMAT(NOW(), '%Y-04-01') AND LAST_DAY(DATE_FORMAT(NOW(), '%Y-04-01')) ORDER BY prescription.date DESC LIMIT 1;"
23ef89f430d2312cd46e8a1d,Could you list the daily average lr input of patient 10013049?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],"SELECT `date`, AVG(`lr_input`) AS `avg_daily_lr_input` FROM `patient_10013049_data` WHERE `lr_input` IS NOT NULL GROUP BY `date` ORDER BY `date` ASC;"
870ff7dd4c46ed086c2c0376,Calculate patient 10007928's length of stay in days for the first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.859664352145046}]","SELECT ROUND(DATEDIFF(MIN(discharge_time), MAX(enter_time)), 2) FROM t_icu_stay WHERE patient_id = '10007928' AND discharge_location = 'Discharged' AND enter_time = (SELECT MIN(enter_time) FROM t_icu_stay WHERE patient_id = '10007928' AND discharge_location = 'Discharged')"
6e3ef13b7c663dcb6c9945ec,When was the last time that patient 10266 had a medication that should be taken regularly?,,,SELECT MAX(date) FROM prescription_records WHERE patient_id = 10266 AND is_regular_medication = TRUE;
592209b6b448207dfea92c06,When did patient 10027602 get input since 07/25/2100 for the last time?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-25' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2201-12-13 16:51:00'}],SELECT MAX(input_date) FROM patient_inputs WHERE patient_id = 10027602 AND input_date >= '07/25/2100';
e6251eca229881bceb8a97c7,I would like to know what dr. garcia's on today's outpatient schedule.,,,SELECT * FROM outpatient_schedule WHERE doctor_name = 'Dr. Garcia' AND appointment_date = CURRENT_DATE;
690bde321b749a8d1310a710,What is the number of patients who had a macrophages test in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'macrophages' ) AND strftime('%Y',labevents.charttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) AS num_patients FROM lab_tests WHERE test_name = 'Macrophages' AND YEAR(test_date) = 2100;
11f0c0917f60ce2086cc646c,How many patients with noncompliance with renal dialysis were diagnosed within 2 months after previously being diagnosed with personal history of tobacco use?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT COUNT(DISTINCT patient_id) FROM patient_records WHERE diagnosis_code = 'noncompliance with renal dialysis' AND diagnosis_date <= DATE_ADD(diagnosis_date, INTERVAL 2 MONTH) AND EXISTS (SELECT 1 FROM patient_records AS prev_record WHERE prev_record.patient_id = patient_records.patient_id AND prev_record.diagnosis_code = 'personal history of tobacco use' AND prev_record.diagnosis_date < patient_records.diagnosis_date)"
e9f0066c2e5b7c4c2d7fe515,How many patients had a diagnosis of methicillin susceptible pneumonia due to staphylococcus aureus during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible pneumonia due to staphylococcus aureus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,SELECT count(*) FROM patient_diagnoses WHERE diagnosis_name = 'Methicillin Susceptible Pneumonia Due to Staphylococcus Aureus' AND diagnosis_date >= '2023-01-01' AND diagnosis_date <= '2023-12-31'
8e4ed37b59452ca69b3481b2,Which method of disinfection is in the quarantine room?,,,select method_of_disinfection from quarantine_room
4464d8ca9583f59be4160810,What were the top five frequent laboratory tests that patients had after they were diagnosed with intermediate coronary syndrome during the same hospital visit in this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intermediate coronary syndrome' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,SQL Query
2fb580e18c83d31b38426b65,Tell me the count of the drugs patient 10026354 was prescribed since 2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 60}],SELECT count(DISTINCT drug) AS drug_count FROM prescriptions WHERE patient_id = 10026354 AND date >= '2100-01-01'
92a24aa83e1c66451f13de62,When did patient 10031757 last get swab's microbiology test during their last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'swab' ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],select distinct last swab's microbiology test date from lab where patient id = '10031757' and hospital encounter id = (select max(hospital encounter id) from hospital encounters where patient id = '10031757')
9f640a77c4f06183632d1120,"What was the name of the drug prescribed for patient 10002495 in the same hospital visit after having received a dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach procedure since 22 months ago?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-22 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-22 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"select distinct(drug_name) from prescriptions where patient_id = 10002495 and admission_date > (select admission_date - interval '22 month' from admissions where patient_id = 10002495 and procedure_description = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach')"
db2dac9cf4438079183f8b61,"On their last hospital encounter, how old was patient 10038081?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,SELECT age FROM hospital_encounters WHERE patient_id = 10038081 AND encounter_date = (SELECT MAX(encounter_date) FROM hospital_encounters WHERE patient_id = 10038081)
3274494f44c1ffdda4c98220,What was the daily maximum input of piggyback for patient 10021666 in the first ICU stay?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],select max(input) from piggyback where patient = 10021666 and stay = 1 group by date order by date
1aaa39bc1ab0805e5a3b83be,"What percentile is the fibrinogen, functional value of 86.0 in the same age group as patient 10013049 during the first hospital encounter?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 86.0",,SQL Query here
66c02202fa82b6035ee4845c,"Since the last diagnosis of patient 10004733 with unspecified sinusitis (chronic) during this hospital visit, how many hours have passed?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sinusitis (chronic)' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT TIMESTAMPDIFF(HOUR, diagnosis_time, NOW()) AS hours_since_diagnosis FROM patient_diagnoses WHERE patient_id = 10004733 AND diagnosis = 'unspecified sinusitis (chronic)' AND diagnosis_time = (SELECT MAX(diagnosis_time) FROM patient_diagnoses WHERE patient_id = 10004733 AND diagnosis = 'unspecified sinusitis (chronic)')"
fc39ef8cc2866f09ef373bdd,Could you unfold the three most frequent outputs since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","select output, count(*) from experiments where year >= 2100 group by output order by count(*) desc limit 3;"
cc3323ca987760bede847423,What was the first time patient 10038081 had a blood (toxo) microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood (toxo)' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT TOP 1 test_datetime FROM lab_events WHERE pat_id = '10038081' AND test_name = 'blood (toxo) microbiology' AND test_datetime > '03/2100' ORDER BY test_datetime ASC
f3fb1b7298f0046e0b6c55ba,Has there been a hospital admission for patient 10016810 since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10016810 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 1}],"select * from admissions where patient_id = 10016810 and date >= date_sub(now(), interval 1 year)"
055f3e16faecc90b5ba954f2,What new medications were prescribed to patient 10018081 today as compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],
bf3cde9944a2d256d7dea6dd,Tell me the sum of the input volume for patient 10020786 since 07/01/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-01'",[{'SUM(inputevents.totalamount)': 7140.0}],medical_records
f14cb951f41a1c19af6d82c9,"What is the average total cost for a hospital including tests in the amylase, ascites laboratory this year?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT AVG(total_cost) FROM hospital_costs WHERE test_name = 'amylase, ascites laboratory' AND YEAR(date) = YEAR(CURDATE())"
3591d10cf8e7b2175165ea6c,"When did patient 10006053 have the bilirubin, direct lab test for the first time during the last hospital visit?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, direct' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT MIN(date) AS first_bilirubin_test_date FROM lab_tests WHERE patient_id = '10006053' AND test_name = 'bilirubin_direct' AND visit_id IN (SELECT visit_id FROM visits WHERE patient_id = '10006053' ORDER BY visit_date DESC LIMIT 1)
ae00fe5dbb359a903185aab9,Can you tell me if patient 10031757 is male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10031757,[{'gender': 'F'}],SELECT gender FROM patients WHERE patient_id = '10031757'
94693223b09516e219df459b,What was the minimum daily number of patients who had intestinal infection due to clostridium difficile in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to clostridium difficile' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,SELECT MIN(patient_count) FROM daily_patient_statistics WHERE infection_type = 'Clostridium difficile' AND year = 2100
cb9ef2da0330655eb9c04acb,When did patient 10026354 receive the first prescription of ciprofloxacin 0.3% ophth soln and dexamethasone ophthalmic susp 0.1% at the same time in 10/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ciprofloxacin 0.3% ophth soln' AND admissions.subject_id = 10026354 AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'dexamethasone ophthalmic susp 0.1%' AND admissions.subject_id = 10026354 AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"[select distinct encounter_date from (select encounter_date,encounter_type from (select encounter_date,encounter_type from (select encounter_date,encounter_type,rxnorm_concept_id from (select encounter_date,encounter_type,rxnorm_concept_id from (select encounter_date,encounter_type,rxnorm_concept_id from (select encounter_date,encounter_type,concept_id as rxnorm_concept_id from (select encounter_date,encounter_type,concept_id from (select encounter_date,encounter_type,concept_id from (select encounter_date,encounter_type,concept_id from (select encounter_date,encounter_type,concept_id from (select e.encounter_date,e.encounter_type,c.concept_id from encounter e,concept c,concept_ancestor ca where e.patient_id = 10026354 and c.concept_id = ca.descendant_id and ca.ancestor_id in (select distinct c.concept_id from concept c,concept_relationship cr where c.concept_name='ciprofloxacin 0.3% ophth soln' and cr.relationship_id='RxNorm equivalent' and cr.concept_id_2=c.concept_id) and e.encounter_id = c.source_concept_id) union ("
a291e9eb06fbda894cbb7a33,"In 10/this year, what was the maximum mcv value for patient 10018845?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'",[{'MAX(labevents.valuenum)': None}],SELECT MAX(mcv) FROM lab_results WHERE patient_id = 10018845 AND test_date BETWEEN '2023-10-01' AND '2023-10-31'
c7f69643d20645a5bd715035,What kind of diagnosis did patient 10031757 receive first on their first hospital encounter?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,"SELECT Diagnosis FROM patient_encounters WHERE Patient_ID = 10031757 ORDER BY Encounter_Date ASC, Encounter_Time ASC LIMIT 1;"
dbb22b767c34f1cecea22ea4,"What are the four most commonly prescribed medications for patients who were diagnosed with facial weakness previously within 2 months, in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'facial weakness' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 Medication, COUNT(Medication) AS Prescription_Count FROM Patient_Medication WHERE Diagnosis = 'Facial Weakness' AND PrescriptionDate BETWEEN DATEADD(MONTH, -2, '2100-01-01') AND '2100-12-31' GROUP BY Medication ORDER BY Prescription_Count DESC"
0653e85d090882590ea6b4ce,Can you tell me about patient 10022880's age on the last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,SELECT `Patient Age` FROM `Encounter` WHERE `Patient ID` = '10022880' ORDER BY `Encounter Date` DESC LIMIT 1
baba1d99e845eb5d22b1c46a,Tell me the sum of the input volume for patient 10013049 since 05/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-12'",[{'SUM(inputevents.totalamount)': 10945.0}],select sum(input_volume) from records where patient_id = 10013049 and date > '05/12/2100'
0a0992495803104da30af972,What was the organism's name of the first urine microbiology test done on patient 10016150 since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],select top 1 o.Name from microbiology_test mt inner join organism o on mt.organismid = o.OrganismID where mt.patientid = 10016150 and mt.type = 'Urine' and mt.test_date >= '02/2100' order by mt.test_date asc;
e626a72073cf3197a0efbd87,Tell me patient 10011398's average value of systolic blood pressure on this month/27.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '27'",[{'AVG(chartevents.valuenum)': None}],"SELECT AVG(systolic_blood_pressure) AS average_systolic_blood_pressure FROM patients WHERE patient_id = 10011398 AND DATE_FORMAT(measurement_date, '%Y-%m') = '2023-03'"
618f91256c79080bd2fc27d0,Tell me the top three most prevalent procedures for patients aged 60 or above.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT procedure_code, COUNT(*) AS frequency FROM medical_records WHERE patient_age >= 60 GROUP BY procedure_code ORDER BY frequency DESC LIMIT 3"
0b0c7f34ee233cef21378070,What was the name of the procedure that was given two times to patient 10027602 during the last month?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,"SELECT procedure_name FROM procedures WHERE patient_id = '10027602' AND procedure_date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) GROUP BY procedure_name HAVING COUNT(*) > 1 ORDER BY procedure_name ASC LIMIT 1"
7fa7ba261095aaef6e6a3b4f,What is the maximum total hospital expense that includes sepsis due to escherichia coli [e. coli] in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sepsis due to escherichia coli [e. coli]' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(TotalExpense) FROM HospitalExpenses WHERE Year = 2100 AND Diagnosis LIKE '%sepsis due to escherichia coli%';
eb9fcf1a569a58fe71b1b257,When was the last time patient 10040025 was discharged from hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10040025 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(discharge_date) AS last_discharge_date FROM hospital_stays WHERE patient_id = '10040025';
f2298b0bf7b7aa99bc543176,Tell me the method of disinfection in a quarantine?,,,SELECT method_of_disinfection FROM quarantine_protocols WHERE context='disinfection'
27f16675ba7f39ec5b46e3bf,What was the first medication that patient 10016150 was prescribed in 05/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT TOP 1 Medication FROM Prescriptions WHERE PatientID = 10016150 AND PrescriptionDate >= '2023-05-01' ORDER BY PrescriptionDate ASC;
ff61f56376566ef1959962de,How was patient 10015931 admitted in terms of admission type for the last time?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10015931 ORDER BY admissions.admittime DESC LIMIT 1,[{'admission_type': 'URGENT'}],select top 1 * from ADMISSIONS where person_id = 10015931 order by admission_date desc
65b2855ba05f13d02f85adcd,What was the organism's name found in the last urine test of patient 10007928 in 04/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT TOP 1 organism_name FROM urine_test_results WHERE patient_id = '10007928' AND test_date = (SELECT MAX(test_date) FROM urine_test_results WHERE patient_id = '10007928' AND test_date BETWEEN '2100-04-01' AND '2100-04-30') ORDER BY test_date DESC
d091004cb9fc04cd233d1142,Does patient 25951 have a documented record of legal blindness-usa def in his / her family?,,,SELECT EXISTS(SELECT 1 FROM medical_records WHERE patient_id = 25951 AND (record_description LIKE '%legal blindness-usa def%' OR record_description LIKE '%blindness-usa def%') AND record_type = 'family_history')
9879a8df02f5078e4cc9405e,What was the name of the diagnosis that patient 10038992 received for the first time during the first hospital encounter?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,SELECT DISTINCT diagnosis_name FROM diagnosis WHERE patient_id = 10038992 AND hospital_encounter_id = (SELECT MIN(hospital_encounter_id) FROM diagnosis WHERE patient_id = 10038992)
dc47e1e9c572da5b543bcf0e,"What are the five commonly taken specimens for patients that received excision of right internal mammary artery, percutaneous endoscopic approach previously within 2 months since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 specimen FROM procedure_codes WHERE procedure_description = 'excision of right internal mammary artery, percutaneous endoscopic approach' AND date BETWEEN DATEADD(month, -2, '2100-01-01') AND '2100-01-01';"
e65b59a5ae495773129a972f,Calculate the number of patients who were in the neuro stepdown careunit in this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS NumberOfPatients FROM Admissions WHERE CareUnit = 'neuro stepdown' AND AdmissionDate BETWEEN '2023-01-01' AND '2023-12-31'
e7d455d2f4e0704722248c62,"Since 08/11/2100, when was the last input time for patient 10039997?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-11' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2134-09-08 17:50:00'}],select max(input_time) from patient_data where patient_id='10039997' and input_time >= '08/11/2100'
ba92f2f766b9d7fdf7e30e5d,Which procedure was performed on patient 10016742 two or more times since 21 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-21 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"SELECT Procedure, COUNT(*) as Frequency FROM procedures WHERE Patient_ID = '10016742' AND DATEDIFF(month, Procedure_Date, GETDATE()) <= 21 GROUP BY Procedure HAVING COUNT(*) >= 2"
05424dfd1bc74bf21ddc5688,What were the top five diagnoses most frequently diagnosed in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"[select diagnosis, count(*) as diagnosis_count"
99ae2a1c4797235aeeccbd8a,What is the number of patients who were prescribed bupivacaine 0.1% since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupivacaine 0.1%' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT PatientID) FROM Prescriptions WHERE DrugName = 'bupivacaine' AND Concentration = '0.1%' AND PrescriptionDate >= '2100-01-01'
4f7a1d19e6fadf0e7b619491,Has patient 10014354 visited an emergency room since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) AS ER_visits FROM visits WHERE patient_id = 10014354 AND visit_type = 'Emergency' AND visit_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
7da9c0a5790b317cead06455,What was the drug that patient 10011398 was prescribed for the last time using a oral route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT drug_name FROM prescriptions WHERE patient_id = 10011398 AND route = 'oral' AND prescription_date = (SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = 10011398 AND route = 'oral')
119d4b9159d345fd67da01be,Has there been any organism found in patient 10021118's last staph aureus swab microbiology test since 08/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],select count(*) from microbiology_tests where organism = 'staph aureus' and patient_id = '10021118' and test_type = 'swab' and test_datetime >= '08/2100'
0468ce0daa5a2cba57e45350,What is the number of patients who were prescribed ramipril since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ramipril' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 4}],SELECT COUNT(DISTINCT patient_id) FROM prescription_events WHERE drug_name = 'ramipril' AND date >= '2100-01-01'
b7f15ad17e5a4047c43d42e6,When did patient 10018081 last receive a lab test for sodium since 10/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT MAX(test_date) AS last_test_date FROM lab_tests WHERE patient_id = 10018081 AND test_name = 'Sodium' AND test_date >= '2100-10-01'
a087cf65a777e7f24185f1a9,Is the patient 10009049 a male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10009049,[{'gender': 'M'}],SELECT gender FROM Patient WHERE patient_id = 10009049;
4830ab94fb0c437406b08947,"Since 02/2100, when was patient 10021312's first microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2113-08-16 16:22:00'}],select min(test_date) from microbiology_tests where patient_id='10021312' and test_date >= '02/2100'
371d12824fa1ffd7ef5e90e7,What is the dose of the prescribed opioid for patient 99647??,,,select dose from prescriptions where patient_id = 99647 and medication_type = 'opioid'
97516d1ecb3c025c618fb0ef,Please count the hospital visits made by patient 10002930 in this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10002930 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT COUNT(*) FROM HospitalVisits WHERE PatientID = '10002930' AND VisitDate BETWEEN '2023-01-01' AND '2023-12-31';
942603b5dceccf0a7d2a31df,What is the number of patients who were discharged from the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) FROM admissions WHERE discharge_date IS NOT NULL
320d0d42e2bc3e896297a919,What is the white blood cells percentile of 11.6 among patients of the same age as patient 10004720 during their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 11.6",,SELECT PERCENT_RANK() OVER (ORDER BY lab_result) AS percentile FROM lab_results WHERE lab_test = 'WBC' AND patient_id IN (SELECT patient_id FROM visits WHERE age = (SELECT age FROM patients WHERE patient_id = 10004720) AND visit_date = (SELECT MAX(visit_date) FROM visits WHERE patient_id = 10004720)) AND lab_result = 11.6
888e5315d7db699f3ac78093,What is the minimum total hospital cost that includes a drug named ciprofloxacin hcl?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin hcl' ) GROUP BY cost.hadm_id ) AS T1,,"[SELECT MIN(hospital_total_costs) FROM (SELECT hospital_total_costs FROM (SELECT DISTINCT hospital_total_costs, d.drug FROM (SELECT hospital_total_costs, drug_cost, drug_quantity FROM (SELECT hospital_id, hospital_total_costs FROM (SELECT hospital_id, SUM(total_cost) AS hospital_total_costs FROM inpatient_claims WHERE year = 2008 GROUP BY hospital_id) AS hospital_cost GROUP BY hospital_id) AS cost JOIN (SELECT hospital_id, SUM(drug_cost) AS drug_cost, SUM(drug_quantity) AS drug_quantity FROM (SELECT hospital_id, drug_cost, drug_quantity, drug_name FROM (SELECT hospital_id, drug_cost, drug_quantity, ds.drug_name FROM inpatient_claims AS ic JOIN drug_strength AS ds ON ic.narcotic_drug = ds.ndc) AS drug_info GROUP BY hospital_id, drug_name) AS drug_group GROUP BY hospital_id) AS drug_totals ON cost.hospital_id = drug_totals.hospital_id) AS cost_drug GROUP BY hospital_total_costs, drug_cost, drug_quantity) AS cost_drug_info JOIN (SELECT hospital_id, drug, SUM(drug_cost) AS drug_cost, SUM(drug_quantity) AS drug_quantity FROM (SELECT hospital_id, drug, drug_cost, drug_quantity"
a0e105397fe459f9ad540eef,What was the senna dose that patient 10021666 was last prescribed in 03/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'senna' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT `senna_dose` FROM `patient_medications` WHERE `patient_id` = 10021666 AND `medication_name` = 'senna' ORDER BY `prescription_date` DESC LIMIT 1
8c389720f8914eabd76867e2,What are the five most common prescriptions in 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5",[],"SELECT `Prescription`, COUNT(`Prescription`) AS `Frequency` FROM `MedicalRecords` WHERE `Year` = 2100 GROUP BY `Prescription` ORDER BY `Frequency` DESC LIMIT 5;"
a975cd9e522a7abecfd9d1ff,What was patient 10001725's daily maximum weight this year?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],select max(weight) from measurements where patientid = 10001725 and measurementdate between '2023-01-01' and '2023-12-31' group by measurementdate
065b726dbf86eb804accd168,"For the last time since 02/2100, what was the drug that patient 10014078 was prescribed via iv drip route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND prescriptions.route = 'iv drip' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT drug_name FROM prescriptions WHERE patient_id = '10014078' AND route = 'iv drip' ORDER BY date DESC LIMIT 1
bb93faad71aaa3ed0164496c,What is the minimum total expenditure of a hospital that involves the medication potassium chl 20 meq / 1000 ml d5 1/2 ns?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5 1/2 ns' ) GROUP BY cost.hadm_id ) AS T1,,select min(total_expenditure) from prescriptions where medication_name like '%potassium chl 20 meq / 1000 ml d5 1/2 ns%'
90c223d20a0599528657b6d3,What organism was found in patient 10001725's last urine test during their first hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT Organism FROM PatientUrineTests WHERE PatientID = 10001725 AND EncounterNumber = 1 ORDER BY TestDate DESC LIMIT 1
6fb281ee6d2d6ec101b35dc4,Show me the top three most frequent drugs that patients were prescribed within the same hospital visit after being diagnosed with hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts) throughout this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts)' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 medication, COUNT(*) AS frequency FROM patient_records WHERE diagnosis = 'hypertrophy (benign) of prostate without urinary obstruction and other lower urinary tract symptom (luts)' AND visit_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY medication ORDER BY frequency DESC"
5e120295af4004e7fa588d2f,What total amount of sarna lotion was prescribed to patient 10018501 during the first hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'sarna lotion',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(AMOUNT) FROM VISITS JOIN ORDERS ON VISITS.VISIT_ID = ORDERS.VISIT_ID WHERE VISIT_ID = (SELECT VISIT_ID FROM VISITS WHERE PATIENT_ID = '10018501' ORDER BY ADMIT_DATE LIMIT 1) AND DRUG = 'Sarna Lotion'
e855fab09bf918229922f967,What was the drug that patient 10015860 was prescribed for during the same day after the procedure of other fasciectomy?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other fasciectomy' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,[SELECT DISTINCT m.drug
2ba257c83dfd7776e8506244,"Throughout this year, what are the top five most common lab tests ordered for patients in the same hospital encounter after dysphagia, oropharyngeal phase?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphagia, oropharyngeal phase' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,SELECT labtest FROM labresults WHERE encounterid IN (SELECT encounterid FROM swallowdiagnostic WHERE phase = 'oropharyngeal' AND symptom = 'dysphagia') GROUP BY labtest ORDER BY COUNT(labtest) DESC LIMIT 5;
bbe2b568ffdaf7c89fb508ab,How long did proximal gastrectomy take for patient 366?,,,SELECT duration FROM surgical_procedures WHERE patient_id = 366 AND procedure_name = 'proximal gastrectomy';
52b4c6302fbd18b90e270e93,How many patients were given single internal mammary-coronary artery bypass since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )",,SELECT count(*) FROM patient_records WHERE procedure = 'single internal mammary-coronary artery bypass' AND procedure_date >= '2100-01-01';
16efb111485f01232222a8c4,What was the duration of the packed cell transfusion procedure for patient 9566?,,,SELECT duration FROM packed_cell_transfusions WHERE patient_id = 9566
b6d9cd67e22e2ef748217cd1,"In patients who had the extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic since 2100, what were the four most common diagnoses that followed during the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) AS diagnosis_count FROM patient_records WHERE procedure_description LIKE '%extirpation of matter from left lower lobe bronchus%' AND procedure_date >= '2100-01-01' AND procedure_type IN ('natural', 'artificial', 'endoscopic') GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 4"
12f5143349944b924783990d,Has there been a hospital admission for patient 10020740 since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020740 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 1}],"SELECT COUNT(*) AS admission_count FROM ADMISSION WHERE HADM_ID = 10020740 AND ADMITTIME >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
a978c41bf772b0328ae1c73e,Please tell me the exact prescriptions patient 4269 received from the other department.,,,SELECT prescription_details FROM patient_prescriptions WHERE patient_id = 4269 AND department_id <> (SELECT department_id FROM departments WHERE department_name = 'Current Department')
e330c2e4df1717b019f638e1,"Tell me the average total hospital cost that includes personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits.","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits' ) ) GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_hospital_cost) AS avg_cost FROM patient_data WHERE personal_history_tia = 1 AND cerebral_infarction_without_residual_deficits = 1
5238005ffc47bc3719f52f2a,"Calculate the number of patients who underwent a laboratory test for urea nitrogen, urine since 1 year ago.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"select count(distinct patient_id) from labevents where test_name = 'urea nitrogen' and test_result = 'urine' and test_date >= date('now','-1 year')"
e7aa4b2720464fe5f689b5f0,When was the first hospital discharge time for patient 10035185?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10035185 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2120-05-17 16:00:00'}],SELECT MIN(date) as FirstDischargeDate FROM hospital_discharge_times WHERE patient_id = 10035185
982fb7efe92d6f33dcdb9848,What are the top five diagnoses associated with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT diagnosis, SUM(death_in_6months) AS total_deaths FROM `physionet-data.mimiciii_diagnoses_icd` GROUP BY diagnosis ORDER BY total_deaths DESC LIMIT 5"
3aab4c6e3c824c26d1f50ebe,What was the name of the output which patient 10029484 had for the last time since 04/06/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-06' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Void'}],SELECT output_name FROM patient_outputs WHERE patient_id = 10029484 AND output_date = (SELECT MAX(output_date) FROM patient_outputs WHERE patient_id = 10029484 AND output_date >= '04/06/2100')
f888fddd502f84dfdc3b3bcb,How many days has it been since the first time patient 10018081 stayed in their current hospital visit in the careunit trauma sicu (tsicu)?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT DATEDIFF(CURRENT_DATE, MIN(admitdate)) AS days_since_first_stay FROM ADMISSIONS WHERE patientunitstayid = 10018081 AND careunit = 'trauma sicu' AND visitnumber = (SELECT visitnumber FROM ADMISSIONS WHERE patientunitstayid = 10018081 ORDER BY admitdate DESC LIMIT 1) LIMIT 1"
5b78e15830003c4050414093,Was patient 10006053 diagnosed with anything during their first hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT diagnosis FROM hospital_records WHERE patient_id = '10006053' AND visit_number = 1;
6a55f374b69cde6051e87af6,Was the hematocrit value of patient 10036156 last measured on the last hospital visit less than the value second to last measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT CASE WHEN (SELECT hematocrit FROM lab_results WHERE patient_id = 10036156 AND visit_id = (SELECT MAX(visit_id) FROM visits WHERE patient_id = 10036156) ORDER BY measurement_time DESC LIMIT 1, 1) < (SELECT hematocrit FROM lab_results WHERE patient_id = 10036156 AND visit_id = (SELECT MAX(visit_id) FROM visits WHERE patient_id = 10036156) ORDER BY measurement_time DESC LIMIT 1) THEN 'Yes' ELSE 'No' END AS result;"
36f1d4c5bd1c63cf74545e1f,What is the code in icd-11 for renal & ureteral dis nos in icd-10?,,,SELECT icd11_code FROM ICD11 WHERE icd10_code = 'N28.9'
8304664f47f63bb4e4aedbc5,Count the current patients who are in the 40s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,,select count(distinct patid) from patient where age between 40 and 49
425e31a5bea537ada730003e,What was the last time patient 10005817 was prescribed medications via the ng route throughout this month?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.route = 'ng' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(date) AS last_prescription_date FROM prescriptions WHERE patient_id = 10005817 AND route = 'ng' AND date >= '2023-03-01' AND date <= '2023-03-31';
6d770f5dad11c867295ac4f0,How many hours has elapsed since the last time during their current hospital encounter patient 10018081 had received a specific gravity lab test?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MAX(lab_timestamp), NOW()) AS elapsed_hours FROM lab_tests WHERE patient_id = 10018081 AND test_type = 'specific gravity' AND encounter_id = (SELECT encounter_id FROM encounters WHERE patient_id = 10018081 AND encounter_status = 'current')"
1afcc723ae25dcbcaee4919e,When did patient 10018081 first get mrsa screen microbial tests in 12/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(test_date) as FirstTestDate FROM microbiology_tests WHERE patient_id = '10018081' AND test_name = 'mrsa screen' AND test_date BETWEEN '2023-12-01' AND '2023-12-31'
0bf13d65d6a6c37aaf9ffd42,How many patients were administered divalproex (delayed release) since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'divalproex (delayed release)' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS NumberOfPatients FROM medical_records WHERE medication = 'divalproex (delayed release)' AND date_administered > '2100-01-01'
52ab9f0636d7c7efa44fbe81,"Since 2100, what were the top three most common specimens tested on patients during the same month after the diagnosis of polyneuropathy, unspecified?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'polyneuropathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"[SELECT specimen_type, COUNT(*) AS count"
99a500fd67403f12fc30f8b6,What were the top five most frequent diagnoses that followed within 2 months for those patients who received diagnostic ultrasound of digestive system?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 diagnosis, COUNT(*) AS frequency FROM diagnoses WHERE patient_id IN (SELECT patient_id FROM procedures WHERE procedure_name = 'Diagnostic Ultrasound of Digestive System') AND date <= DATEADD(month, 2, procedure_date) GROUP BY diagnosis ORDER BY frequency DESC"
a566581cd7454020e0914ed3,I would love to know the name of the diagnosis that patient 25763 received in the other department.,,,SELECT diagnosis FROM diagnoses WHERE patient_id = 25763 AND department != 'current_department_name';
538445bd77fd441ff8085f91,What was the first time during their last ICU stay patient 10022281 had a maximum systolic blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(measurement_datetime) FROM chartevents WHERE itemid IN (220051, 220050) AND SUBJECT_ID=10022281 AND HADM_ID=(SELECT HADM_ID FROM icustays WHERE SUBJECT_ID=10022281 ORDER BY INTIME DESC LIMIT 1)"
a2cad7bd6649d8cc2f3b637d,"On the first hospital stay, did patient 10020187 visit an emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'COUNT(*)>0': 0}],SELECT visit_type FROM patient_visits WHERE patient_id = '10020187' AND visit_order = 1 AND visit_type = 'emergency' LIMIT 1
8fe4b6848aa995f8ab0554ae,"On the first hospital stay, did patient 10005817 undergo a single internal mammary-coronary artery bypass procedure?",SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],"[select case_stays.case_stay_id, procedure_events.procedure_id, procedure_events.procedure_type"
1153c548a9a77ae4687c8846,Can you provide the total number of outputs patient 10018845 had since 03/10/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-10'",[{'SUM(outputevents.value)': 2442.0}],SELECT count(*) AS total_outputs FROM Output WHERE patientid = '10018845' AND outputtime >= '03/10/2100'
701c361638b72b18b59910b7,"Retrieve the top five most frequent procedures that patients were given during the same hospital encounter after receiving inspection of tracheobronchial tree, via natural or artificial opening endoscopic in 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT procedure, COUNT(*) AS frequency FROM procedures WHERE parent_encounter IN (SELECT encounter_id FROM procedures WHERE procedure = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' AND date BETWEEN '2100-01-01' AND '2100-12-31') AND date BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY procedure ORDER BY frequency DESC LIMIT 5"
11334e5323118eea80ce40d5,What were the top three most common procedures in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT procedure, COUNT(procedure) as frequency FROM (SELECT procedure FROM operations WHERE YEAR(operation_date) = 2100) AS subquery GROUP BY procedure ORDER BY frequency DESC LIMIT 3"
30e8031670f0d3838d940ec4,What was the last time when patient 10006580 received a creatinine lab test since 03/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT TOP 1 * FROM Labs WHERE PatientID = 10006580 AND Test = 'creatinine' AND DateTime >= '03/21/2000' ORDER BY DateTime DESC
00249e27093cdde779012293,"Has docusate sodium (liquid), glucose gel, or heparin been prescribed since 2100 to patient 10036156?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.drug IN ( 'docusate sodium (liquid)', 'glucose gel', 'heparin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM prescription WHERE medication IN ('docusate sodium (liquid)', 'glucose gel', 'heparin') AND patient_id = 10036156 AND date_prescribed >= '2100-01-01'"
5519ee451e8ab94af344b52d,What was the cost of the drug syringe (iso-osmotic dextrose)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'syringe (iso-osmotic dextrose)' ),,SELECT cost FROM DrugSyringe WHERE isotonicity = 'iso-osmotic' AND sugar = 'dextrose'
a3fbabc4125bd38ac2aed4db,Has patient 10039831 been given any drugs since 08/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'",[{'COUNT(*)>0': 1}],"SELECT drug.name, drug.dose, drug.dose_unit, drug.frequency FROM drug WHERE drug.patient_id = 10039831 AND drug.date >= '2000-08-21'"
4a5bb0f951af309dfe062485,When was the last time patient 10021487 had input on this month/11?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '11' ORDER BY inputevents.starttime DESC LIMIT 1",[],SELECT MAX(date) FROM patient_data WHERE patient_id = 10021487 AND EXTRACT(MONTH FROM date) = 11
58be20bc10780428cb236a2e,What are the precautions to take after the opn/oth rep mtrl vlv-tis procedure?,,,SELECT precautions FROM `post_operative_care` WHERE procedure = 'opn/oth rep mtrl vlv-tis' LIMIT 1
171a187b546228165ca60f92,"The first time , when was patient 10004720 prescribed insulin and artificial tear ointment at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin' AND admissions.subject_id = 10004720 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'artificial tear ointment' AND admissions.subject_id = 10004720 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"[select min(d.dttm) as FirstTimeWhenPatient10004720PrescribedInsulinAndArtificialTearOintmentSameTime from (select d.dttm from (select b.patientid,b.orderitemid,b.orderid,b.dttm from (select patientid,orderid,orderitemid,max(dttm) as dttm from (select a.patientid,a.orderid,a.orderitemid,b.dttm from (select patientid,orderid,orderitemid from (select patientid,orderid from (select patientid,orderid from (select patientid,orderid from (select patientid,orderid from (select distinct patientid,orderid from (select patientid,orderitemid,orderid from (select patientid,orderid,orderitemid from (select patientid,orderitemid from (select patientid,orderitemid from (select patientid,orderitemid from (select patientid,orderitemid from (select patientid,orderitemid from (select a.patientid,a.orderid,b.orderitemid from (select patientid,orderid from (select patientid,orderid from (select patientid,orderid from (select patientid,orderid from (select patientid,orderid from orders where patientid=10004720) a inner join (select"
ef47010e396a58191a716c15,Show me the top three most commonly prescribed drugs since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]","[SELECT TOP 3 drug_name, COUNT(*) AS prescription_count"
a61a197e35f3b625c9540a0a,"In 2100, what are the top four most common specimens tested for patients previously diagnosed with obstructive chronic bronchitis with (acute) exacerbation within 2 months?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'obstructive chronic bronchitis with (acute) exacerbation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 specimen_type, COUNT(*) AS test_count FROM (SELECT DISTINCT patient_id, specimen_type FROM lab_tests WHERE year = 2100 AND patient_id IN (SELECT patient_id FROM diagnoses WHERE condition = 'obstructive chronic bronchitis with (acute) exacerbation' AND diagnosis_date BETWEEN DATEADD(month, -2, GETDATE()) AND GETDATE())) AS recent_tests GROUP BY specimen_type ORDER BY test_count DESC"
6a8ea90422439952b0b95d0a,How many medications were prescribed since 27 months ago to patient 10027445?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-27 month')",[{'COUNT(*)': 230}],SQL Query Here
0293a5acee37151a49ceaa8a,Has any dextrose 50% been given to patient 10016742 since 20 months ago?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-20 month')",[{'COUNT(*)>0': 0}],"SELECT * FROM medications WHERE patient_id = '10016742' AND medication = 'Dextrose 50%' AND date_administered >= DATEADD(month, -20, GETDATE());"
b60fe48723590c9d8172f6c7,Tell me the time when patient 10020187's mean blood pressure was less than 91.0 for the first time on 02/03/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 91.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-03' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(MeasurementTime) FROM `physionet-data.mimiciii_v1.measurement` WHERE SubjectID = '10020187' AND `Value` < 91.0 AND DATE(MeasurementTime) BETWEEN '2023-02-01' AND '2023-02-28' AND ItemID = 220051
93e00f471a0dcb56dfb1ea6e,Tell me the yearly maximum amount of patient 10014354's nacl 0.9% input.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)",[],"SELECT YEAR(date), MAX(amount) AS max_amount FROM (SELECT date, SUM(amount) AS amount FROM input WHERE patient_id = 10014354 AND type = 'nacl 0.9%' GROUP BY date) AS daily_amounts GROUP BY YEAR(date);"
d4ffd536638a0b500dea5e1d,What was the name of the drug patient 10017492 was prescribed within the same hospital visit after having received a spinal tap procedure in 03/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"select distinct prescription.drug_name from prescription, procedure, visit where prescription.patient_id = 10017492 and prescription.visit_id = visit.id and visit.hospital_id = procedure.visit_id and procedure.name = 'spinal tap' and procedure.date between '03/01/this year' and '03/31/this year' and prescription.visit_id = (select visit.id from procedure, visit where procedure.visit_id = visit.id and procedure.name = 'spinal tap' and procedure.date between '03/01/this year' and '03/31/this year' and visit.patient_id = 10017492 order by visit.date asc limit 1, 1)"
5c3f52d548353aad5447d804,"On this month/04, what was the last heart rate reading for patient 10004720?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '04' ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(measurement_time) as Last_Heart_Rate_Measurement, value FROM measurement WHERE value_source_name='Heart Rate' AND person_id=10004720 AND measurement_date BETWEEN '2023-04-01' AND '2023-04-30' GROUP BY measurement_date ORDER BY Last_Heart_Rate_Measurement DESC LIMIT 1"
05d218c03d4f3db81a54165a,Could you tell me how many patients stayed in the medical/surgical intensive care unit (micu/sicu) careunit since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM `physionet-data.mimiciii_clinical.admissions` WHERE `careunit` IN ('MICU', 'SICU') AND `admittime` >= (CURRENT_DATE - INTERVAL 1 YEAR)"
5a4d87a7bd80bc03275287c6,"Tell me the top four most frequent procedures that patients were given within 2 months after receiving excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic since 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,SQL Query Here
1089bbe66e821577636739ae,"In the last hospital encounter was readi-cat 2 (barium sulfate 2% suspension), glipizide xl, or sodium chloride 0.9% prescribed for patient 10029484?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'readi-cat 2 (barium sulfate 2% suspension)', 'glipizide xl', 'sodium chloride 0.9%' )",[{'COUNT(*)>0': 0}],"[SELECT DISTINCT ON (h.patient_id, m.medication_name) m.medication_name, h.encounter_date"
3280dd533a7cef123247bde5,When did the last hospital discharge of patient 10004720 occur?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004720 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2186-11-17 18:30:00'}],SELECT MAX(admit_date) FROM hospital_discharge WHERE patient_id = 10004720
1286e054ab8b363bfd212296,How many days have elapsed since the last time patient 10021487 was diagnosed with other iatrogenic hypotension during this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"select count(distinct date) from (select date, patient_nbr from (select date, patient_nbr, max(date) over (partition by patient_nbr) as last_date from admissions where patient_nbr = 10021487) as t1 where date = last_date) as t2 where date <= to_date('2023-09-15', 'yyyy-mm-dd')"
292e05db320f21dac9efa68e,When was the first time that patient 10038081 since 136 days ago had a respiratory rate that was less than 14.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 14.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-136 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],"select min(recorded at) from `labevents` where subject_id = 10038081 and itemid = 220277 and value < 14.0 and recorded at >= cast(date_sub(current_date, interval 136 day) as date)"
4e62b0e57830a46896da0604,Reveal the four most frequently prescribed medications since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]","[SELECT medication_name, COUNT(*) as frequency"
067417d484687c9d57f7dfcd,What is the procedure that patient 10029291 received two times in 03/this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,"SELECT procedure_name FROM Procedures WHERE patient_id = 10029291 AND date_part('year', date) = date_part('year', CURRENT_DATE) AND date_part('month', date) = 3 AND COUNT(*) > 1 GROUP BY procedure_name;"
03cdbce2386e1c8684bf2a13,What were the four most frequent lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","select test_name, count(test_name) as frequency from lab_tests where test_date >= '2100-01-01' group by test_name order by frequency desc limit 4"
b7d1939430a21c6f12cd36da,How many ampicillin-sulbactam prescriptions occurred in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'ampicillin-sulbactam' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) AS prescription_count FROM prescriptions WHERE antibiotic = 'Ampicillin-Sulbactam' AND year = 2100;
5c5d5137fe45b2eb60a11cc5,What were the top four most common diagnoses that followed within 2 months for those who received enteral infusion of concentrated nutritional substances in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,SQL Query
0eb69f6e47ab63c055e2df90,Was patient 10038081 treated with percutaneous abdominal drainage on the first hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],SQL Query
742320113523a87f95b0f270,Can you tell me the name of the last output of patient 10018845 since 10/02/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-02' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],SELECT TOP 1 output_name FROM patient_outputs WHERE patient_id = '10018845' AND output_date >= '2100-02-10' ORDER BY output_date DESC
ef58c8f426926b9b7c5610fc,"List the top three most frequent diagnoses that patients were diagnosed with within 2 months after receiving respiratory ventilation, greater than 96 consecutive hours.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as diagnosis_count FROM patient_records WHERE diagnosis_date BETWEEN ventilation_date AND DATE_ADD(ventilation_date, INTERVAL 2 MONTH) AND ventilation_duration > 96 GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 3"
339bd7b7cb9460146cc1f5a0,What is the percentile ranking of a glucose test value of 176.0 for patients of the same age as patient 10038992 on the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 176.0",,[SELECT PERCENT_RANK() OVER (ORDER BY glucose) AS percentile_rank
3d262da4f3ade06a2f6f3db1,"What is the maximum total cost of hospitalization that includes the glucose, ascites laboratory test since 1 year ago?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, ascites' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"select max(total_cost) from hospitalizations where (glucose_test_date > DATE_SUB(CURDATE(), INTERVAL 1 YEAR) or ascites_test_date > DATE_SUB(CURDATE(), INTERVAL 1 YEAR))"
ddf32de215f19f42c2a8ddf6,Calculate patient 10007928's total amount of foley output on 04/14/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-04-14'",[{'SUM(outputevents.value)': None}],SELECT SUM(OUTPUT_VOLUME) AS TotalFoleyOutput FROM INPUT_OUTPUT WHERE PATIENT_ID = 10007928 AND DATE = '04/14/2100' AND PROCEDURE = 'Foley'
7de6019246eb50aa7a443936,What was the amount of fluticasone-salmeterol diskus (100/50) prescribed to patient 10021666 in total in 03/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'fluticasone-salmeterol diskus (100/50)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(quantity) AS total_prescribed FROM prescription_records WHERE patient_id = '10021666' AND medication = 'fluticasone-salmeterol diskus (100/50)' AND YEAR(prescription_date) = YEAR(CURRENT_DATE) AND MONTH(prescription_date) = 3;
7acfb197a239ef58e7f08525,When patient 9619 is scheduled for the earliest hospital visit?,,,SELECT MIN(visit_date) FROM hospital_visits WHERE patient_id = 9619;
df0baa783ad628147be24b1a,"When, during their last ICU stay, was patient 10002495's respiratory rate measured greater than 21.0 for the first time?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 21.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT MIN(measurement_date) FROM measurements WHERE subject_id = 10002495 AND measurement_type = 'Respiratory Rate' AND measurement_date BETWEEN (SELECT MIN(admittance_date) FROM admissions WHERE subject_id = 10002495 AND icu_stay = (SELECT MAX(icu_stay) FROM admissions WHERE subject_id = 10002495)) AND (SELECT MAX(discharge_date) FROM discharges WHERE subject_id = 10002495 AND icu_stay = (SELECT MAX(icu_stay) FROM admissions WHERE subject_id = 10002495)) AND value > 21.0
fa4ebfb881b70db087e81779,Has patient 10008454 got a lymphocytes laboratory test in 12/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',labevents.charttime) = '2100-12'",[{'COUNT(*)>0': 0}],"select * from labevents where subject_id=10008454 and itemid=50862 and (charttime between '2012-12-01' and '2012-12-31') and value not in (-99, 0)"
72be988adaa416d79f2d4060,What was patient 10009628's heart rate for the first time during their last ICU visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],select top 1 hr from chartevents where itemid=211 and hr is not null and subject_id=10009628 and (charttime between (select max(charttime) from chartevents where itemid=211 and subject_id=10009628 and (charttime between (select max(charttime) from chartevents where itemid=211 and subject_id=10009628 and icustay_id in (select icustay_id from icustays where subject_id=10009628))))) and icustay_id in (select icustay_id from icustays where subject_id=10009628) order by charttime
ae87fc8fc5ccf8578f0ec36c,"What is the cost of introduction of nutritional substance into upper gi, via natural or artificial opening?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) )",,Select cost_of_introduction From procedures Where procedure_name='Nutritional_substance_into_upper_gi'
5661fb129ea343e46075bab5,Tell me the type of blood of patient 31854?,,,select type of blood from patients where patient_id = 31854
38e2f42ebf3b484fd618abc2,Does patient 54386 have any overseas experience?,,,SELECT patient_id FROM Patient WHERE patient_id = 54386 AND overseas_experience = 'Yes';
21516330871ebef6b95137ea,Show me the top three most frequent events that took place in 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],"SELECT event, COUNT(*) as frequency FROM events_table WHERE year = 2100 GROUP BY event ORDER BY frequency DESC LIMIT 3"
462cd9e5980b86409d6557d8,What was the name of the medication that patient 10024043 was first prescribed in 04/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT TOP 1 medication_name FROM prescriptions WHERE patient_id = '10024043' AND date_prescribed >= '2100-04-01' ORDER BY date_prescribed ASC
ee04db0976616af28ba6a8a5,Can I know the total output amount for patient 10014078 since 172 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-172 day')",[{'SUM(outputevents.value)': 9445.0}],Your SQL query here
4b2e4f08510d69ad89b581ce,What percentile is the alkaline phosphatase value of 129.0 in the same age group as patient 10003046 during the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 129.0",,SQL Query
d165a95f794e3d301e6f6179,Give me the top three most commonly prescribed medications within 2 months to patients aged 60 or above after they were diagnosed with hypoxemia since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypoxemia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"select drg, count(*) as cnt from mdepu2 where drg in (select drg from mdepu2 where adm_date between to_date('2100-01-01', 'yyyy-mm-dd') and to_date('2100-03-31', 'yyyy-mm-dd') and diag_icd in (select code from diagnosis_icd where desc like 'hypoxemia%' and category='D') and age>=60 group by drg order by cnt desc limit 3) group by drg order by cnt desc limit 3"
515fbb81432c9872301c377a,Which drug was the last one prescribed for patient 10007818 in 07/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 medication FROM prescriptions WHERE patient_id = '10007818' AND prescription_date BETWEEN 'YYYY-07-01' AND 'YYYY-07-31' ORDER BY prescription_date DESC
b77757e9df39efd72596255e,What are the average monthly number of patients diagnosed with malignant neoplasm of unspecified part of unspecified bronchus or lung in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,SELECT AVG(monthly_patient_count) AS average_monthly_patients FROM bronchus_or_lung_cancer WHERE year = 2100 AND diagnosis_code = 'C34.90';
40e1b2eb72eb67d84b772be6,What was the total guaifenesin-dextromethorphan dose that has been prescribed in 08/this year to patient 10021312?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'guaifenesin-dextromethorphan' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08'",[{'SUM(prescriptions.dose_val_rx)': None}],select sum(guaifenesin_dose + dextromethorphan_dose) as total_guaifenesin_dextromethorphan_dose from prescriptions where patient_id = 10021312 and date_prescribed >= '2023-08-01' and date_prescribed <= '2023-08-31'
486691bb6da24ab4f1918724,Tell me the first output of patient 10015860 since 06/05/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Void'}],SELECT TOP 1 output FROM patient_outputs WHERE patient_id = 10015860 AND output_date >= '06/05/2100' ORDER BY output_date ASC
c04f16fa062bc81f8c917962,When did patient 10010471 first take the microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'charttime': '2155-12-03 19:58:00'}],Select the earliest date from the microbiology table where patient_id is 10010471
7b14cdcd4cf8cd3ffdc02db7,Can you tell me how much fentanyl patch costs?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl patch' ),,SELECT AVG(Unit_Price) AS AverageCost FROM drug WHERE drug_name = 'Fentanyl Patch'
129e758237d6a21a110b1f7c,What is the ward id that patient 3929 can be admitted?,,,SELECT ward_id FROM admissions WHERE patient_id = 3929
d44b7e9b8f15bdcd053d65f3,"Since 2100, how often was excision of left saphenous vein, percutaneous endoscopic approach done?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,"SELECT COUNT(*) FROM Procedures WHERE procedure_name = 'Excision of Left Saphenous Vein, Percutaneous Endoscopic Approach' AND year >= 2100;"
722cbb6c7cc7ed4d2c24e87d,"What were the top three most frequent specimens ordered for patients after being diagnosed with renal sclerosis, unspecified in the same hospital encounter since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'renal sclerosis, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"SELECT specimen_type, COUNT(specimen_type) AS frequency FROM medical_records WHERE diagnosis = 'renal sclerosis, unspecified' AND encounter_date >= '2100-01-01' GROUP BY specimen_type ORDER BY frequency DESC LIMIT 3"
db2e74ae7eb32d3ddbdbe8b2,How much does patient 10005817 weigh based on the last measurement since 07/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-07' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT `weight` FROM `measurements` WHERE `patient_id` = 10005817 AND `date` > '2100-07-21' ORDER BY `date` DESC LIMIT 1
e1c93dd5e81567e826a17f47,"Since 2100, what are the top five most common microbiology tests that patients were diagnosed with after the diagnosis of noncompliance with renal dialysis in the same hospital encounter?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"SELECT microbiology_test_name, COUNT(*) as test_count FROM microbiology_tests INNER JOIN diagnoses ON microbiology_tests.patient_id = diagnoses.patient_id WHERE diagnoses.condition_name = 'Noncompliance with renal dialysis' AND microbiology_tests.test_date >= '2100-01-01' GROUP BY microbiology_test_name ORDER BY test_count DESC LIMIT 5"
edcb877560f680ecc90bffc6,Can you tell me the last recorded weight for patient 10007928 since 19 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-19 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(Weight) AS LastRecordedWeight FROM HealthData WHERE PatientID = 10007928 AND Date >= DATE_SUB(CURDATE(), INTERVAL 19 MONTH)"
232cc5cdd5e1b965d61da342,What is the total number of patients who were discharged from the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) AS total_discharged FROM patients WHERE discharge_date >= NOW() - INTERVAL '1 year'
6699dac0cf704c408038528e,"Has patient 10019777 received a venous catheterization, not elsewhere classified treatment since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,"SELECT COUNT(*) AS CatheterizationCount FROM Treatment WHERE PatientID = 10019777 AND TreatmentCode = 'Venous Catheterization, NEC' AND TreatmentDate >= '2100-01-01'"
1aa433cdad6f6e1610a4c24f,Tell me the top five most frequent lab tests that patients were given in the same hospital visit after being diagnosed with personal history of pulmonary embolism.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of pulmonary embolism' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"select LabTest, count(LabTest) as Frequency from LabTests where HospitalVisitID in (select HospitalVisitID from Diagnoses where ICDCode = 'V12.1') group by LabTest order by Frequency desc limit 5"
5c0ef35bdd581b7068ef254e,"What was the last time in 11/2100 patient 10006053 had the minimum potassium, whole blood value?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) = '2100-11' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],[SELECT MAX(RecordDate) AS LastDateOfMinPotassium
6c0364360a42833597617b98,What was the name of the organism found in patient 10027602's first sputum microbiology test since 05/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],select sputum_test.first_sputum_microbiology_test_microorganism from patient p join sputum_test on p.patient_id = sputum_test.patient_id where p.patient_id = 10027602 and sputum_test.test_date >= '05/2100' order by sputum_test.test_date asc limit 1
366c5a5077a210313a50c552,Get me the top four most frequent drugs that patients were prescribed within 2 months after being diagnosed with esophageal reflux since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT drug_name, COUNT(*) as frequency FROM prescriptions INNER JOIN diagnoses ON prescriptions.patient_id = diagnoses.patient_id WHERE diagnoses.condition = 'esophageal reflux' AND diagnoses.diagnosis_date >= '2100-01-01' AND prescriptions.prescription_date BETWEEN diagnoses.diagnosis_date AND diagnoses.diagnosis_date + INTERVAL '2 months' GROUP BY drug_name ORDER BY frequency DESC LIMIT 4;"
cd05e6424347ce699cf7b7cd,Quantify the number of patients who were tested since 1 year ago for absolute lymphocyte count.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute lymphocyte count' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from lab_results where test_name = 'Absolute Lymphocyte Count' and test_date > (current_date - interval '1 year')
45e27a5adb524da103b1963d,When was the first time that patient 10027602 had the maximum red blood cells value in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],"[SELECT MAX(red_blood_cells), visit_start_datetime"
070f868f0ab84f4ec3f3982b,Does patient 69895 have a genetic test that they got?,,,"select distinct patient_id, test_id from genetic_tests where patient_id = 69895"
2ce2c777d5cf2c8bf9c60de2,How many insertion of drug-eluting coronary artery stent(s) treatments were executed since 1 year ago?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of drug-eluting coronary artery stent(s)' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,"SELECT COUNT(*) AS total_insertions FROM patient_treatments WHERE treatment_type = 'drug-eluting coronary artery stent' AND treatment_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
5da552e4bce7844817e8e4ec,When was patient 10026406's last discharge from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10026406 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2133-03-04 17:05:00'}],select max(date_of_discharge) as last_discharge from (select date_of_discharge from discharge_events where patient_id = '10026406' and date_of_discharge is not null) as patient_discharges
bc8f51d9cc16b51ab2a55aaa,Count the number of patients who had their uric acid tested.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'uric acid' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT PATIENT_ID) FROM PATIENT_TESTS WHERE TEST_NAME = 'URIC ACID';
6408991bd45a8b1bed727d8d,What is the daily minimum input of or packed rbc intake that patient 10005817 is getting since 11/2100?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or packed rbc intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-11' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],"SELECT date, input, rbc_units_per_unit FROM `physionet-data.mimic-iv.admissions` WHERE subject_id = 10005817 AND (input LIKE '%RBC%' OR packed_rbc LIKE '%RBC%') AND date >= '2100-11-01' ORDER BY date ASC LIMIT 1"
75dcf661ef83b60c79a0aa34,Is the respiratory rate reading for patient 10026406 last measured on the first ICU visit less than the value second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT CASE WHEN (SELECT respiratory_rate FROM patient_readings WHERE patient_id = '10026406' AND icu_visit_number = 1 ORDER BY measurement_time DESC LIMIT 1) < (SELECT respiratory_rate FROM patient_readings WHERE patient_id = '10026406' AND icu_visit_number = 1 ORDER BY measurement_time DESC LIMIT 1, 1) THEN 'Yes' ELSE 'No' END as is_less"
f4d88d6b65c3f2fef3bf62c5,"How many times, in the previous year, was a coronary arteriography using two catheters procedure ordered?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,SELECT COUNT(*) FROM procedure_occurrence WHERE procedure_concept_id= 38000848 AND person_id IN (SELECT person_id FROM cohort WHERE cohort_definition_id= 1012) AND YEAR(occurrence_date)= 2017
aeeff9dc3dd3312a35c0af6c,Did patient 10015860 have a lab test last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM lab_results WHERE patient_id = '10015860' AND test_date BETWEEN '2022-01-01' AND '2022-12-31';
23a4576cc256bed45465d6f4,What is the code that corresponds in icd-10 to icd-11 for delirium d/t other cond?,,,"SELECT icd_10_code, icd_11_code FROM mappings WHERE icd_10_code LIKE '%delirium d/t other cond%'"
1ba68173e9103374da571bcf,What was patient 10018423's insurance name on their last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Other'}],SELECT insurance_name FROM patient_visits WHERE patient_id = 10018423 ORDER BY visit_date DESC LIMIT 1
2fe3354da7c1d59bea4dda70,How much is the cost for the drug sodium chloride 3% inhalation soln?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'sodium chloride 3% inhalation soln' ),,SELECT cost FROM drug_costs WHERE drug_name = 'sodium chloride 3% inhalation soln'
157b31fa4605dab06049c427,Have any diagnoses been made for patient 10038081 on the last hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) as DiagnosisCount FROM diagnoses WHERE patient_id = 10038081 AND visit_id = (SELECT MAX(visit_id) FROM visits WHERE patient_id = 10038081)
3ca5f7f58238739a39418242,What was the last time patient 10012552 has had the minimum mean blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],SELECT MAX(medication_date) FROM patient_medication_history WHERE patient_id = 10012552 AND mean_bp = (SELECT MIN(mean_bp) FROM patient_medication_history WHERE patient_id = 10012552)
52d67bef474996c117256e92,What is the percentile of the mchc value of 34.3 among patients of the same age as patient 10017492 on their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 34.3",,SELECT PERCENT_RANK() OVER (ORDER BY mchc) AS percentile_rank FROM lab_results WHERE patient_id != '10017492' AND encounter_id = (SELECT MAX(encounter_id) FROM lab_results WHERE patient_id = '10017492') AND age = (SELECT age FROM patients WHERE patient_id = '10017492') AND mchc IS NOT NULL AND mchc != '34.3'
b8f6fd0f9b950b22019dc5f9,How many hours have elapsed since patient 10021487's first stay in the careunit trauma sicu (tsicu) during their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT SUM(julianday('now', 'localtime') - julianday(admit_time)) AS hours_elapsed FROM patient_encounters WHERE patient_id = 10021487 AND careunit = 'tsicu' AND encounter_id = (SELECT MAX(encounter_id) FROM patient_encounters WHERE patient_id = 10021487)"
0186746594c1cf90e38d4ffd,Has patient 10006053 had a lab test for basophils since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y',labevents.charttime) >= '2100'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM lab_tests WHERE patient_id = 10006053 AND test_name = 'basophils' AND date_taken > '2100-01-01'
224fe50640fe06e9fd64e1cd,Tell me the name of the last specimen test patient 10014354 had received since 10/2100.,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'BLOOD CULTURE'}],SELECT specimen_test_name FROM `unioned_ehr_specimen_tests` WHERE person_id = '10014354' AND specimen_test_date >= '2021-10-21' ORDER BY specimen_test_date DESC LIMIT 1
30444a0364fc39ff849021b5,Calculate the number of ICU visits for patient 10004720 in the last hospital encounter.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT( DISTINCT icustays.stay_id )': 1}],[SELECT COUNT(*) AS ICU_Visit_Count
1f6fb1acb94a920e308918de,Can you point to a genetic test that patient 28447 received?,,,SELECT test_name FROM genetic_tests WHERE patient_id = 28447
96550da61d7335c3ccc3d5d0,What is the cost for a drug named lidocaine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lidocaine' ),,"SELECT drug_name, cost FROM prescriptions WHERE drug_name = 'lidocaine'"
e530d92c14e1178895ca7c89,When was the last time that patient 10020740 has been prescribed lidocaine 1% and heparin flush (10 units/ml) at the same time in 04/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lidocaine 1%' AND admissions.subject_id = 10020740 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin flush (10 units/ml)' AND admissions.subject_id = 10020740 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"SELECT MAX(admit_time) FROM prescriptions WHERE patient_id = '10020740' AND drug_name = 'lidocaine 1%' AND heparin_flush = '10 units/ml' AND DATE_PART('year', admit_time) = 2023 AND DATE_PART('month', admit_time) = 4"
d4cc44e155d21e53108993c3,Has patient 10027602 received any insertion or replacement of external ventricular drain [evd] treatment?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ),[{'COUNT(*)>0': 0}],"select * from procedures where patient_id='10027602' and procedure_type in ('insertion', 'replacement') and device='external ventricular drain'"
55f8f1cd25a1f682cc88512b,What is the price for the drug cyanocobalamin?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' ),,SELECT price FROM drugs WHERE name = 'cyanocobalamin'
c9fe1f1b8ec77f4a772615c7,"What was the last time, on the last ICU stay, that patient 10025612's heart rate was greater than 75.0?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 75.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT MAX(measurement_date) FROM patient_measurements WHERE patient_id = 10025612 AND measurement_value > 75.0 AND measurement_type = 'heart_rate' AND icu_stay_end_date IN (SELECT MAX(icu_stay_end_date) FROM patient_icu_stays WHERE patient_id = 10025612)
ea10182ca02a264d05d0a0c6,Tell me the total 0.9% sodium chloride dose that patient 10001217 has been prescribed during their first hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = '0.9% sodium chloride',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(dose) FROM hospitalization_patient_prescriptions WHERE patient_id = 10001217 AND type = '0.9% Sodium Chloride' AND visit_number = 1
76de61af821cbfa636cc92fe,Calculate the total quantity of output of patient 10018081 since 12/12/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-12'",[{'SUM(outputevents.value)': 66945.0}],SELECT SUM(output_quantity) AS TotalOutput FROM patient_output WHERE patient_id = 10018081 AND date >= '12/12/2100';
bae75ab280f0f80ba298c0cb,Patient 10037928's age on their last hospital encounter was what?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,SELECT age FROM patients WHERE patient_id = 10037928 AND encounter_id = (SELECT MAX(encounter_id) FROM encounters WHERE patient_id = 10037928)
9906ee00ac2183b7e809821c,List the top four most frequently prescribed medications since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]","SELECT name, COUNT(*) AS frequency FROM prescriptions WHERE prescription_date >= '2100-01-01' GROUP BY name ORDER BY frequency DESC LIMIT 4;"
7f24de340048d1b87aca545d,What is the total number of hospitalized patients now?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS total_hospitalized_patients FROM `bigquery-public-data.cdc_nchs_nmmr_hosp_mortality.hosp_mortality` WHERE `discharge_status` LIKE 'Hospitalized'
34586824e9cd0af359187e34,When are dr. williams's rounds and procedures?,,,"[SELECT ""Procedure"".""Procedure Date"", ""Rounds"".""Round Time"", ""Patients"".""Patient Name"""
0cd28c037e9d62e1fe5d608a,List the top five most common diagnoses in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS diagnosis_count FROM patient_records WHERE YEAR(diagnosis_date) = 2100 GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 5"
f335eed9cf01ee1b0747a75a,Tell me what the top five most common diagnoses of patients with an age of 30s since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) as count FROM patient_records WHERE age BETWEEN 30 AND 39 AND admission_date >= DATEADD(year, -1, GETDATE()) GROUP BY diagnosis ORDER BY count DESC LIMIT 5"
1ada788cf4c8e059533b5f04,"Since 2100, how many patients had been diagnosed with alcohol dependence, in remission?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol dependence, in remission' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,"SELECT COUNT(DISTINCT patient_id) FROM Diagnosis WHERE diagnosis = 'alcohol dependence, in remission' AND diagnosis_date >= '2100-01-01';"
94565cd9b8a667a9b65034a4,I am curious what the protocols for the drugs that work to treat cancer.,,,"SELECT drug_name, protocol FROM treatment_protocols WHERE condition = 'cancer'"
e99894fa240f028ed3221457,How many patients were diagnosed in 2100 with pericardial effusion (noninflammatory)?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pericardial effusion (noninflammatory)' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )",,select count(patient_id) from echocardiogram where year=2100 and diagnosis='pericardial effusion (noninflammatory)'
6af5326ec076b32f85b4e657,How much is the cost of the encounter for palliative care diagnosing?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for palliative care' ) ),,"select sum(cost) from encounter where diagnosis=""palliative care"""
b8fc22b947af56744b197ad0,Has patient 10022041 been admitted into the hospital throughout this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT COUNT(*) AS Admission_Count FROM admission WHERE patient_id = '10022041' AND year(date) = year(CURDATE())
037d3be256bd398ee1db08ce,What's the cost of a drug known as clonazepam?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'clonazepam' ),,"SELECT name, cost FROM drug WHERE name = 'clonazepam'"
fd5726998d426a2fdca616fc,"Fetch the top three most frequent procedures that were administered to patients within 2 months after they had ileostomy, not otherwise specified.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"[SELECT ProcedureName, COUNT(*) as Frequency"
13540fd048d7adb5f077165f,"Do you know the maximum total protein, ascites value of patient 10006053?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, ascites' )",[{'MAX(labevents.valuenum)': None}],"SELECT MAX(total_protein), MAX(ascites) FROM patient_data WHERE patient_id = 10006053"
42fb2b34ffcff69466b09384,What was the admission type during patient 10007795's last entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10007795 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1",[],select top 1 admission_type_id from ADMISSIONS where patient_id='10007795' order by discharge_dt desc
987c9d2214cdf8dd1eff384d,How much ciprofloxacin iv had been prescribed to patient 10018081 in total since 11/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.drug = 'ciprofloxacin iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(qty) FROM `hivmigration_observations` WHERE person_id = 10018081 AND concept_id = 160124 AND voided = 0 AND (obs_datetime BETWEEN '2100-11-01 00:00:00' AND '9999-12-31 23:59:59' OR (obs_datetime IS NULL AND stop_reason IS NULL))
af2418efda8240fde827a469,What are the top five most common specimens being tested for patients who were diagnosed with unspecified viral hepatitis c with hepatic coma in the same month since 2100?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c with hepatic coma' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 SPECIMEN_TYPE, COUNT(*) AS SPECIMEN_COUNT FROM LAB_RESULTS WHERE PATIENT_ID IN (SELECT PATIENT_ID FROM DIAGNOSIS WHERE DIAGNOSIS_CODE = 'Unspecified viral hepatitis c with hepatic coma' AND EXAM_DATE >= '2100-01-01') AND EXAM_DATE BETWEEN DIAGNOSIS_DATE AND DATEADD(month, 1, DIAGNOSIS_DATE) GROUP BY SPECIMEN_TYPE ORDER BY SPECIMEN_COUNT DESC"
dd2f29754291be893cdcffa8,How many hours have passed since patient 10004733's last specific gravity laboratory test on their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MAX(lab_datetime), NOW()) AS hours_since_last_test FROM laboratory_events WHERE person_id = 10004733 AND labtest_name = 'Urinalysis, by dipstick or tablet reagent for bilirubin, glucose, hemoglobin, ketones, leukocytes, nitrite, pH, protein, specific gravity, urobilinogen, any number of these constituents; qualitative' AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visits WHERE person_id = 10004733 AND visit_start_date = (SELECT MAX(visit_start_date) FROM visits WHERE person_id = 10004733))"
81b76631822bb19d0aaa0811,Has patient 10000032 undergone the percutaneous abdominal drainage procedure in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,SELECT COUNT(*) FROM medical_records WHERE patient_id = 10000032 AND procedure_name = 'percutaneous abdominal drainage' AND YEAR(procedure_date) = 2100;
0179af361778345171c9542a,Is the creatinine value last measured on the first hospital visit in patient 10018501 less than the value from the second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT CASE WHEN a.creatinine < b.creatinine THEN 'Yes' ELSE 'No' END AS Creatinine_Comparison FROM (SELECT creatinine FROM patient_observations WHERE patient_id = 10018501 AND hospital_visit_number = 1 ORDER BY measurement_date DESC LIMIT 1) a, (SELECT creatinine FROM patient_observations WHERE patient_id = 10018501 AND hospital_visit_number = 1 ORDER BY measurement_date DESC LIMIT 1,1) b"
ca6018236b179b413a64059e,What was the last time patient 10020187 input time on 02/04/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-02-04' ORDER BY inputevents.starttime DESC LIMIT 1",[],select max(input_time) from chartnote where patient_id = 10020187 and input_time::date = '2100-02-04' and note_type = 'Nurse Note' and (chart_id = '101' or chart_id = '102')
86c494ae04729b5345b49a12,"For patients diagnosed with epilepsy, unspecified, without mention of intractable epilepsy since 1 year ago, what are the top three most recurrent treatments during the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, without mention of intractable epilepsy' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT TOP 3 treatment_code, COUNT(*) AS treatment_count FROM patient_treatment_records WHERE diagnosis_code = 'Epilepsy, unspecified' AND intractable = 'No' AND treatment_date BETWEEN DATEADD(month, -1, GETDATE()) AND GETDATE() GROUP BY treatment_code ORDER BY treatment_count DESC"
14540374a9d0b9528a6d94fe,How many doses of rifaximin have been prescribed to patient 10038081 since 09/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'rifaximin' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT COUNT(*) AS total_doses FROM prescription WHERE drug_id = (SELECT id FROM drug WHERE name = 'rifaximin') AND patient_id = 10038081 AND prescription_date >= '2021-09-21'
3a6c107da55dce7df0c5c04c,Has there been any organism detected during the first stool microbiology test of patient 10020944 on the first hospital encounter?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'COUNT(*)>0': 0}],select distinct s.organism_name from stool_microbiology_test s join patient_visit p on s.visit_id = p.visit_id where s.visit_id = (select min(visit_id) from patient_visit where patient_id = 10020944 and sdt <= edt)
dc2a2b0ab8c3da8e52bdaa44,What's the maximum total cost of the hospital visits that involve a procedure called closed [percutaneous] [needle] biopsy of kidney?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT MAX(total_cost) FROM HospitalVisits WHERE procedure = 'closed [percutaneous
137099cf125111be9c3e94c3,Is there a method for disinfecting the quarantine room?,,,SELECT COUNT(*) FROM DisinfectionMethod WHERE RoomID = 'QuarantineRoom'
8f621fd97d1842a4a61410fa,Calculate the number of ICU visits for patient 10016742 during the last hospital visit.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT( DISTINCT icustays.stay_id )': 1}],select count(*) from icustays where patientunitstayid=(select stay_id from patientunitstay where patient_id=10016742 order by discharge_time desc limit 1)
ca2d821af5309a1a9e06bffa,How many patients were discharged from hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SQL Query Here
3721cd5bc8e32a4de1812101,Tell me the minimum total hospital cost that involves a procedure called unilateral simple mastectomy?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT MIN(total_hospital_cost) FROM claims WHERE procedure_description LIKE '%unilateral simple mastectomy%';
7c769198cdf2ef06b5f1dab3,Has patient 10038081 had a lab test for glucose?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ),[{'COUNT(*)>0': 0}],SELECT DISTINCT lab_test_name FROM lab_tests WHERE patient_id = 10038081 AND lab_test_name LIKE '%glucose%';
acef00fb099d89d41958c435,Does patient 49176 have experience travelling abroad?,,,SELECT COUNT(*) FROM patient_travel_history WHERE patient_id = 49176 AND country <> 'HomeCountry'
ee03c89cedfa0f30f24da326,What is the prescribed opioid dose for patient 739?,,,column_name
3dbc092974709a580db73d5d,What are the three most ordered lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT lab_tests.name AS lab_test_name, COUNT(*) AS order_count FROM lab_tests JOIN orders ON lab_tests.lab_test_id = orders.lab_test_id WHERE orders.order_date > DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY lab_tests.name ORDER BY order_count DESC LIMIT 3"
5a471bc5d991ced2d535cfb7,How many times irbesartan was ordered since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'irbesartan' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 656}],SELECT COUNT(*) FROM drug_orders WHERE drug_name = 'irbesartan' AND order_date >= '2100-01-01'
20a337b806f34bbcaf6383e9,Find out the number of medicines given to patient 10038933 in 2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],"SELECT count(*) as num_medicines FROM `physionet-data.mimic_iv.mimiciv_iv_medicationorders` WHERE SUBJECT_ID = 10038933 AND DATE_PART('year', DATETIME) = 2100"
4ead555e8bf055e8e8c7bc2f,How many patients left the hospital during the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS NumberOfPatientsLeft FROM patient_records WHERE discharge_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW()"
2a3c78cd78a7e5f8d977da20,When did patient 10021312 have his first microbiology test in 09/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-09' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],
a0ebb505e3207ec9be553166,What kind of diagnosis did patient 10036156 receive last throughout this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,SELECT diagnosis FROM patient_records WHERE patient_id = '10036156' AND YEAR(diagnosis_date) = YEAR(CURRENT_DATE) ORDER BY diagnosis_date DESC LIMIT 1
a6965f79793a92b7e6553d61,Can you tell me which were the top five most frequent specimens tested since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]",Your SQL query here
4711376d06c7dea356e7adee,Was patient 10000032 bicarbonate tested on the first hospital stay?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],select has_bicarbonate from lab_events where patient_id='10000032' and stay_id=(select min(id) from stays where patient_id='10000032')
f67d746e41ace34ddad71fba,What is the protocol of anti-cancer drugs?,,,SELECT DISTINCT protocol FROM anti_cancer_drugs
42d77c1fd11fc0abbd3449b8,How much simethicone was prescribed to patient 10022017 last on their first hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'simethicone' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT SUM(quantity) FROM prescriptions WHERE drug_name = 'simethicone' AND patient_id = 10022017 AND visit_date = (SELECT MIN(visit_date) FROM visits WHERE patient_id = 10022017)
ab6c84f4aad1e16e5caea9b6,Count the number of patients who stayed throughout this year at transplant.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'transplant' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patients WHERE stay_duration >= 365 AND stay_duration < 366
808756e7c648673865499708,Show us the top three most common microbiology tests throughout this year.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3",[],"SELECT TOP 3 test_name, COUNT(*) as test_count FROM microbiology_tests WHERE YEAR(test_date) = YEAR(GETDATE()) GROUP BY test_name ORDER BY test_count DESC;"
c6e39eac55b1a26adabaa844,Could you list the three most frequently prescribed medicines in the same month after a diagnosis of coronary atherosclerosis of native coronary artery was made since 1 year ago?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of native coronary artery' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 medication_name, COUNT(*) AS prescription_count FROM prescriptions WHERE diagnosis = 'coronary atherosclerosis of native coronary artery' AND prescription_date >= DATEADD(year, -1, GETDATE()) AND MONTH(prescription_date) = MONTH(DATEADD(month, -1, GETDATE())) GROUP BY medication_name ORDER BY prescription_count DESC"
2c618c0f46c3debf9a6fcad3,Get me patient 10020786's total po intake input amount on 07/01/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-01'",[{'SUM(inputevents.totalamount)': None}],"SELECT SUM(PoInputAmount) AS TotalPoInputAmount FROM PatientPoIntake WHERE PatientId = '10020786' AND DATE(PoIntakeDate) = DATE_FORMAT(NOW() ,'%Y-07-01');"
09469e7ae520d7c2a28ad15f,"What was the first dose of heparin flush (10 units/ml) during the last hospital encounter, prescribed to patient 10009628?",SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'heparin flush (10 units/ml)' ORDER BY prescriptions.starttime ASC LIMIT 1,[],[SELECT MIN(encounter_id) AS FirstHeparinFlushEncounter
e0699671e9dc302a776e8354,"Since 1 year ago, has patient 10021938 visited an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 0}],SELECT * FROM (SELECT * FROM visit_occurrence WHERE person_id=10021938 AND visit_concept_id IN (SELECT concept_id FROM concept WHERE concept_class_id='Visit Class' AND concept_code LIKE 'EMG%')) AS emergency_visits WHERE visit_start_datetime >= CURRENT_DATE - INTERVAL '1 year';
71319107f961de47a8a7b439,What percentile is the mchc value of 34.6 among patients of the same age as patient 10026354 during their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 34.6",,SELECT PERCENT_RANK() OVER (ORDER BY mchc) AS percentile FROM lab_results WHERE patient_id = 10026354 AND visit_date = (SELECT MAX(visit_date) FROM lab_results WHERE patient_id = 10026354) AND mchc = 34.6 AND age = (SELECT age FROM lab_results WHERE patient_id = 10026354 AND visit_date = (SELECT MAX(visit_date) FROM lab_results WHERE patient_id = 10026354))
1e5faf727375a9ada1941625,What is the average total hospital cost for a procedure involving total esophagectomy?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ) ) GROUP BY cost.hadm_id ) AS T1,,Your SQL query here
aba66c29e51149f140d80325,What is the yearly maximum lr input for patient 10004733 since 113 days ago?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-113 day') GROUP BY strftime('%Y',inputevents.starttime)",[],SELECT MAX(lr_input) AS yearly_max_lr_input FROM patient_data WHERE patient_id = 10004733 AND entry_date >= CURRENT_DATE - INTERVAL '113 days' AND entry_date < CURRENT_DATE - INTERVAL '365 days'
bcbe7556b4dbff73f99a68a6,Count up how many times patient 10018845 was admitted to the ICU since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}],"SELECT COUNT(*) AS icu_admissions_count FROM admissions WHERE patient_id = 10018845 AND unit_type = 'ICU' AND admission_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
1117a3336b3c103b088eb297,"For patients previously diagnosed with compression of vein in 2100, what were the four most frequent specimens tested during the same hospital visit afterward?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'compression of vein' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,SQL Query Here
91f98b68f8351708b09a3b5f,When was the time of patient 10018328's first hospital discharge?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018328 ORDER BY admissions.dischtime ASC LIMIT 1,[{'dischtime': '2154-02-09 15:15:00'}],SELECT min(discharge_time) FROM hospital_stays WHERE patient_id = '10018328' AND discharge_time IS NOT NULL
275184cf2bd75d7ada2cab2a,What is the total number of patients discharged from the hospital this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS total_discharged_patients FROM admissions WHERE discharge_date BETWEEN '2023-01-01' AND '2023-12-31' AND discharge_date IS NOT NULL;
f6a020353c429522bafc3321,Has patient 13528 had any ill effects during a blood transfusion?,,,SELECT * FROM transfusion_events WHERE patient_id = 13528 AND ill_effects = 'Yes'
a12e0ce3ce5a8ad2bd8f3a5d,"What's the cost for drainage of right pleural cavity with drainage device, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )",,"SELECT AVG(Cost) FROM ProcedureCosts WHERE ProcedureDescription = 'drainage of right pleural cavity with drainage device, percutaneous approach';"
ea31ed3fce1a143af74ceab2,Tell me the minimum overall hospital cost that includes vitamin e?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vitamin e' ) GROUP BY cost.hadm_id ) AS T1,,SELECT MIN(overall_hospital_cost) FROM dataset WHERE vitamin_e = 'Yes'
1603ed597a3810e80a4e2f15,"In the last hospital encounter, what was the insurance of patient 10006580?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicaid'}],SQL Query
888957dc10f4451e27bb31eb,"On the first hospital visit, was patient 10002495 diagnosed with any illness?",SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT IllnessName FROM PatientIllness WHERE PatientID = '10002495' AND VisitNumber = 1
8c8b5170a56e94b0724e4b97,"For patients who were previously diagnosed with backache, unspecified, what are the top four most frequent treatments within 2 months since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'backache, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"[SELECT TOP 4 Treatment, COUNT(*) AS Frequency"
5a5f7cbc98a80e1a4f6e3b31,What total amount of ursodiol was prescribed to patient 10004235 in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = 'ursodiol' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(`Dosage`) FROM `PatientPrescriptions` WHERE `PatientID` = 10004235 AND `PrescriptionDate` >= '2023-07-01' AND `PrescriptionDate` <= '2023-07-31' AND `Medication` = 'Ursodiol'
53c9148b613c58bca3b23674,"Throughout this year, how many patients were prescribed dexamethasone?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dexamethasone' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE drug_name = 'dexamethasone' AND order_date BETWEEN '2023-01-01' AND '2023-12-31'
88feed4e79da04e646ebc129,What was the name of the medication that patient 10027602 was last prescribed since 03/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Sodium Chloride 0.9%  Flush'}],select top 1 m.medicare_name from medicare m where m.patient_id = '10027602' and m.prescription_date >= '2100-03-01' order by m.prescription_date desc;
6ed7efd8318499e011227c1c,When was the first time patient 10004457 had been prescribed medication through the po route since 09/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1",[],select min(medication_date) from prescriptions where patient_id = 10004457 and route = 'po' and medication_date >= '09/2100'
8410ba33ca60f450bef1f5d8,How is olanzapine (disintegrating tablet) typically consumed?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'olanzapine (disintegrating tablet)',[],SELECT consumption_method FROM drug_usage WHERE drug_name = 'olanzapine (disintegrating tablet)'
00c6c90e6841d1dfe2515346,What are the top four most common diagnoses that patients were diagnosed with within the same month after receiving hemodialysis's in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"select top 4 diagnosis, count(*) as frequency from diagnoses d join dates dt on d.id=dt.diagnosis_id join hemodialysis hd on hd.date=dt.date where hd.date between '2100-01-01' and '2100-12-31' and d.date between dateadd(month, 1, hd.date) and dateadd(month, 1, hd.date) group by diagnosis order by frequency desc"
28a2d17f20583959defd0234,What is the monthly maximum value of patient 10027445's weight since 14 months ago?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT MAX(weight) AS max_weight FROM patient_data WHERE patient_id = 10027445 AND record_date >= DATE_SUB(CURDATE(), INTERVAL 14 MONTH) GROUP BY YEAR(record_date), MONTH(record_date)"
94ea79f626ba94bd76d643b1,What percentile of the lactate value is 2.7 among patients of the same age as patient 10005866 in their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.7",,SELECT PERCENT_RANK() WITHIN GROUP (ORDER BY Lactate) OVER (PARTITION BY Age) FROM lab_events JOIN patients ON lab_events.patient_id = patients.patient_id WHERE Age = (SELECT Age FROM patients WHERE patient_id = 10005866) AND patient_id = 10005866 AND encounter_id = (SELECT MIN(encounter_id) FROM lab_events WHERE patient_id = 10005866)
d8ee53098c33deb8fdb3b50b,What is the type of blood patient 97330 has.,,,SELECT Blood_Type FROM Patients WHERE Patient_ID = '97330';
368476b74ef69f3552e2cb3d,Describe all prescriptions that patient 54894 received in the other department.,,,SELECT * FROM prescriptions WHERE patient_id = 54894 AND department <> 'primary_department';
29529a65ec54c70785eb5133,Count the number of hospital visits that patient 10029484 had since 1 year ago.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10029484 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],"SELECT COUNT(*) FROM visits WHERE patient_id = 10029484 AND visit_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR);"
a11042428c7092cce5896974,Is the o2 saturation pulseoxymetry level of patient 10020187 second measured on the first ICU visit greater than the first measurement on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN MAX(`ICU`.\`O2 Saturation Pulseoxymetry Level`\`Value`\`value`) > MIN(`ICU`.\`O2 Saturation Pulseoxymetry Level`\`Value`\`value`) THEN 'Yes' ELSE 'No' END AS Is_Second_Greater FROM `ICU` WHERE `ICU`.`Patient ID` = '10020187' AND `ICU`.\`O2 Saturation Pulseoxymetry Level`\`Visit ID`\`value` = 1 GROUP BY `ICU`.`Patient ID`
51ab705e6d5e1025e101e735,What was patient 10015931's weight the last time it was measured since 8 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-8 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT weight FROM patient_measurements WHERE patient_id = 10015931 AND measurement_date > DATE_SUB(CURDATE(), INTERVAL 8 MONTH) ORDER BY measurement_date DESC LIMIT 1"
b352e9e544d9e4edbcabcb01,"Among patients diagnosed with unspecified essential hypertension since 2100, what are the top four medications prescribed within 2 months to patients in their 50s?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT medication, COUNT(*) AS prescription_count FROM patient_records WHERE diagnosis = 'unspecified essential hypertension' AND age BETWEEN 50 AND 59 AND diagnosis_date >= '2100-01-01' GROUP BY medication ORDER BY prescription_count DESC LIMIT 4"
c4b9d1ad637c92074a327167,Show me patient 10012552's total amount of dextrose 5% input on 04/05/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-04-05'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(inputAmount) FROM intravenousFluid WHERE patientId = 10012552 AND fluidName = 'dextrose 5%' AND inputDate = '04/05/2100'
32add9759f1cb2aad3668ce7,List the top four most common events that happened.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]","SELECT event, COUNT(*) AS event_count FROM events GROUP BY event ORDER BY event_count DESC LIMIT 4"
9b4d962443aad38251f870a8,When did patient 10039831 have the maximum value of mean blood pressure for the last time on their current ICU encounter?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],SELECT MAX(encounter_end) AS Last_Max_BP_Encounter FROM patient_encounter_data WHERE patient_id = '10039831' AND blood_pressure_mean = (SELECT MAX(blood_pressure_mean) FROM patient_encounter_data WHERE patient_id = '10039831' AND encounter_end <= (SELECT MAX(encounter_end) FROM patient_encounter_data WHERE patient_id = '10039831')) GROUP BY patient_id
8de008a99045692b6c9079bb,What were the top five most often performed treatments for patients in their 30s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT treatment, COUNT(*) AS treatment_count FROM patient_records WHERE age BETWEEN 30 AND 39 AND treatment_date > CURRENT_DATE - INTERVAL '1 year' GROUP BY treatment ORDER BY treatment_count DESC LIMIT 5"
cd94bbb9784884dac45123cd,What are the top three most common microbiology tests that patients had after the diagnosis of malignant neoplasm of lower third of esophagus within the same hospital visit?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower third of esophagus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3",,"SELECT TestName, COUNT(*) AS TestCount FROM PatientTests WHERE Diagnosis = 'Malignant neoplasm of lower third of esophagus' GROUP BY TestName ORDER BY TestCount DESC LIMIT 3"
222d8247ed139a5d5cd17c02,What was the name of the drug patient 10027602 was prescribed within 2 days after having received a percutaneous [endoscopic] gastrostomy [peg] procedure since 12/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"select p.drug_name from patient p join procedure proc on p.patient_id = proc.patient_id where p.patient_id = 10027602 and proc.name = 'percutaneous endoscopic gastrostomy' and DATEDIFF(p.date_drug_prescribed, proc.date_performed) <= 2"
b462e1aa1b901782d9358530,"Has patient 10038999 got a potassium, whole blood laboratory test?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 )",[{'COUNT(*)>0': 0}],SELECT ... FROM ... WHERE ...
78bac4549cb2e3ad9fa2a04f,When was patient 10005817 discharged from the hospital for the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005817 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2135-01-19 18:36:00'}],SELECT MAX(DISCHARGE_DATE) FROM ADMISSIONS WHERE PATIENT_ID = 10005817
3c7a16e5114441d4d413d8fd,Could you list patient 10011398's daily minimum weight on their first hospital encounter?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT encounter_id, visit_start_date, MIN(weight) FROM ACHS_VitalSign WHERE patient_id = '10011398' AND visit_id IN (SELECT MIN(visit_id) FROM ACHS_VitalSign WHERE patient_id = '10011398') GROUP BY encounter_id, visit_start_date"
02b3b650c8a76d49c5223798,Is patient 3277 subject to covid-19 testing?,,,"select * from (select patient_id, case when covid_test_date is not null then 'Yes' else 'No' end as covid_testing from patient_details) as test_status where patient_id = 3277"
c873185bf7745af0b9d816fe,When was the last time patient 10025612 had a respiratory rate that was less than 16.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 16.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],select max(encounter_datetime) as last_time from t1 where patient_id = '10025612' and respiratory_rate < 16.0
42ab873a23dd37a3c747c4a1,Give me the total amount of nepro (full) given to patient 10018081.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nepro (full)' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],select sum(amount) from invoice_line where invoice_line.invoice_number in (select invoice_number from invoice where invoice.patient_id = 10018081) and product_code = 'NPRO-3000'
25956b8c121a3452cf6a13da,When did the first input for patient 10004720 occur since 10/03/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-03' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2186-11-12 20:00:00'}],SELECT TOP 1 [date
848a65292fc28285ffa82551,Please calculate the total output for patient 10022017 since 06/06/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-06'",[{'SUM(outputevents.value)': 14835.0}],SELECT SUM(output) FROM patient_output WHERE patient_id = '10022017' AND date >= '2100-06-06'
b09c1296a97d4f7a4488f11f,How many hours have passed since the first time that patient 10039831 stayed in careunit discharge lounge in the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime ASC LIMIT 1",[],SELECT EXTRACT(EPOCH FROM (NOW() - MIN(adm.admittime))) / 3600 AS hours_since_first_discharge FROM admission adm JOIN stays s ON adm.hadm_id = s.hadm_id WHERE adm.subject_id = 10039831 AND s.careunit = 'discharge lounge' AND adm.hadm_id = (SELECT hadm_id FROM admission WHERE subject_id = 10039831 AND hadm_id = (SELECT MAX(hadm_id) FROM admission WHERE subject_id = 10039831));
dcbeaf8a50d187f685e536c8,What was the name of patient 10039708's insurance during their last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Other'}],SELECT * FROM patient_insurance WHERE patient_id = '10039708' ORDER BY visit_date DESC LIMIT 1;
9bcb25bfb75bf11f00162db1,What was the dose of lactated ringers that last month patient 10006053 was last prescribed?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND prescriptions.drug = 'lactated ringers' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime DESC LIMIT 1",[],SQL Query
1d5c343c436c4699ca75db67,Patient 10013049's glucose second measured on the last hospital visit is greater than the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","select count(distinct m.mrn) from meas m inner join visits v on m.mrn=v.mrn and m.visit=v.visit where v.mrn=10013049 and v.visit=(select max(v1.visit) from visits v1 where v1.mrn=v.mrn) and m.meastype in ('glucose','glucose 2') and m.value is not null and exists (select null from meas m1 where m1.mrn=m.mrn and m1.visit=m.visit and m1.meastype='glucose' and m1.value is not null) and exists (select null from meas m2 where m2.mrn=m.mrn and m2.visit=m.visit and m2.meastype='glucose 2' and m2.value is not null) and m.meastype='glucose 2' and m.value>(select m3.value from meas m3 where m3.mrn=m.mrn and m3.visit=m.visit and m3.meastype='glucose' and m3.value is not null) order by m.mrn"
adcd9306676f578f4acf1d8a,Get me the top five most frequent events since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT event, COUNT(*) AS frequency FROM events WHERE year >= 2100 GROUP BY event ORDER BY frequency DESC LIMIT 5;"
2872894a2d6be289cc0751d3,Has patient 10005817 undergone a (aorto)coronary bypass of two coronary arteries?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of two coronary arteries' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ),[{'COUNT(*)>0': 0}],SELECT `Patient ID` FROM `Surgeries` WHERE `Patient ID` = '10005817' AND `Surgery Type` = 'aorto)coronary bypass' AND `Coronary Arteries` = 2;
4b5563f6063f368aaf4d032b,When is the earliest hospital visit for patient 92721?.,,,SELECT MIN(visit_date) FROM hospital_visits WHERE patient_id = '92721';
e5f98987539902de04cf8a9e,Could you tell me how many patients stayed in the med/surg careunit during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from patient_records where care_unit = 'med/surg' and admission_date >= '2023-01-01' and discharge_date <= '2023-12-31'
fab4f3241b1a4140593a2196,How many days has it been since the last stay of patient 10018081 in the careunit emergency department in the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1",[],"SELECT DATEDIFF(CURDATE(), MAX(admitdate)) AS days_since_last_stay FROM admissions WHERE patientid = 10018081 AND careunit = 'emergency' AND hospital = 'current'"
89383745e9cd66ac4837c91f,What was the drug name that patient 10024043 was last prescribed through the oral route on the last hospital stay?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT medication_name FROM prescriptions WHERE patient_id = 10024043 AND administration_route = 'oral' AND discharge_date = (SELECT MAX(discharge_date) FROM stays WHERE patient_id = 10024043) ORDER BY administration_date DESC LIMIT 1
671549860b2c1a2b4f5752a3,Could you unfold the five most frequent outputs since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT output, COUNT(*) AS frequency FROM table_name WHERE timestamp >= NOW() - INTERVAL '1 year' GROUP BY output ORDER BY frequency DESC LIMIT 5"
65ed4479d7d3a2021cd1f024,"Since 1 year ago, what was the diagnosis for patient 10004733 the last time?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,SELECT diagnosis FROM patient_records WHERE patient_id = 10004733 AND visit_date > CURRENT_DATE - INTERVAL '1 year' ORDER BY visit_date DESC LIMIT 1
44760a38638babf2a64cc994,Provide the length in days of the last visit for patient 10009035 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.186168982181698}]",select max(end_time) - min(start_time) as visit_length_days from visits where patient_id = 10009035 and location = 'ICU' group by patient_id;
4883a2a4fe195a7f18fa9e6e,How many current patients are there in the 50s age group?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,,SELECT COUNT(*) FROM patients WHERE age BETWEEN 50 AND 59 AND current_status = 'active'
9c4faa51bc29012ddcee7e11,What is the ward id that patient 19175 may be admitted?,,,SELECT ward_id FROM admissions WHERE patient_id = 19175
73482639c89e793869246809,What was the drug that was first prescribed to patient 10029291 via the im route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT drug FROM prescriptions WHERE patient_id = 10029291 AND route = 'im' ORDER BY prescription_date ASC LIMIT 1
ecfdce415b13a6552ae21b5a,What is patient 10004235's average metamyelocytes value in 03/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",[{'AVG(labevents.valuenum)': None}],SELECT AVG(metamyelocytes) FROM lab_results WHERE patient_id = '10004235' AND result_date BETWEEN '2003-01-01' AND '2003-12-31' AND result_type = 'metamyelocytes';
5b3ff38fc5977d41f2919e7f,Show me the top four most commonly prescribed drugs since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]","SELECT TOP 4 drug_name, COUNT(*) AS prescription_count FROM prescriptions WHERE prescription_date >= '2100-01-01' GROUP BY drug_name ORDER BY prescription_count DESC"
68a6646ad90adaa44fe6ddbb,"Has there been any calcium carbonate, bisacodyl, or nephrocaps ordered for patient 10021938 in 04/last year?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND prescriptions.drug IN ( 'calcium carbonate', 'bisacodyl', 'nephrocaps' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)>0': 0}],SELECT * FROM orders WHERE patient_id = 10021938 AND order_date >= '2022-04-01' AND order_date <= '2022-04-30' AND (drug_name = 'calcium carbonate' OR drug_name = 'bisacodyl' OR drug_name = 'nephrocaps')
fded99b20da76568aee99315,Tell me the number of patients discharged from the hospital in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) as num_discharged FROM patients WHERE YEAR(discharge_date) = 2100
6cdbe56001fefce8414c07e1,Has patient 10001217 visited an emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room',[{'COUNT(*)>0': 0}],select count(*) from visits where patient_id = 10001217 and visit_type = 'emergency'
4127d2f4d3dde8b9a50cddeb,Can you tell me the five most frequent diagnoses throughout this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(diagnosis) AS diagnosis_count FROM diagnoses WHERE diagnosis_date >= '2023-01-01' AND diagnosis_date < '2024-01-01' GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 5"
250459eeaf1e43b5affdfa0e,How many hours has it been since patient 10018081's last phosphate lab test on their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT EXTRACT(HOURS FROM current_timestamp - MAX(last_phosphate_test_time)) AS hours_since_last_test FROM lab_tests WHERE patient_id = '10018081' AND hospital_visit_id = (SELECT hospital_visit_id FROM patient_visits WHERE patient_id = '10018081' AND current_visit = TRUE)
e5de01d16191eb56d2a17817,Has patient 10037861 been given a diagnosis in 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'",,SELECT COUNT(*) FROM diagnoses WHERE patient_id = 10037861 AND year = 2100
b81ed5d5887f1e702281cc7c,What kind of medicine does patient 50480 take when they get a prescription from another hospital?,,,
931a6cae10afc8a4e19e7a2b,"What were the four most frequently diagnosed microbiology tests for patients who were diagnosed with encounter for palliative care before within the same hospital visit, since 1 year ago?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for palliative care' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"SELECT microbiology_test, COUNT(*) as frequency FROM patient_records WHERE diagnosis = 'encounter for palliative care' AND hospital_visit_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE() GROUP BY microbiology_test ORDER BY frequency DESC LIMIT 4"
572e3be6f4447f2f3dd8a46e,What is the price for the drug ferrous sulfate (liquid)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)' ),,SELECT price FROM drugs WHERE name='ferrous sulfate' AND form='liquid'
4c0ba2326075b47121880872,Give me patient 10035185's total amount of nacl 0.9% input.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],
35b706cc431e421ccc4d295f,What's the rank of the top four most common output events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]",Your SQL Query Here
a7ffd50743215e43ab4b4249,Calculate the number of lidocaine jelly 2% (urojet) prescriptions last year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescriptions WHERE drug_name = 'lidocaine jelly 2%' AND drug_code = 'urojet' AND prescription_date BETWEEN '2022-01-01' AND '2022-12-31'
5cce095f827f40e0736c9405,Count the number of drugs prescribed since 03/2100 for patient 10037861.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",[{'COUNT(*)': 265}],SELECT COUNT(*) AS total_prescriptions FROM prescriptions WHERE patient_id = 10037861 AND date_prescribed >= '03-21-00'
ec92f2209fc00778cd5a3157,How much does patient 10020944 weigh based on the last measurement since 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT weight FROM patient_data WHERE patient_id = '10020944' AND measurement_date >= '03/2100' ORDER BY measurement_date DESC LIMIT 1
d9f612942f090356e944ba24,"What is the average total hospital cost for a patient diagnosed with hemiplegia, unspecified affecting left nondominant side since 1 year ago?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified affecting left nondominant side' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,select avg(total_hospital_cost) from [ICD_Codes
010b98b4248d540f98a42319,What was the overall amount of input for patient 10021666 since 01/16/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-16'",[{'SUM(inputevents.totalamount)': 6140.0}],SELECT SUM(input) FROM medical_records WHERE patient_id = '10021666' AND date >= '2100-01-16'
bf8943fddda84358c2b49e35,What is the average expense for other endoscopy of small intestine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) ),,SQL Query here
ceb8581ad32d0000864d6c0b,What was the first value of patient 10019172's lab test for oxygen saturation in 11/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen saturation' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '11' ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT `value` FROM lab_events WHERE person_id = 10019172 AND test_name = ""Oxygen Saturation"" AND YEAR(date) = YEAR(CURDATE()) AND MONTH(date) = 11 ORDER BY date ASC LIMIT 1;"
86831d5ce56c04ce7f23fd47,How many patients left the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS 'Number of Patients Discharged' FROM patient_records WHERE discharge_date BETWEEN '2022-01-01' AND '2022-12-31' AND discharge_date IS NOT NULL
8fd77ab450ceaf3df06b0177,How many hyposmolality and/or hyponatremia patients were diagnosed within 2 months after being diagnosed with cachexia?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cachexia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyposmolality and/or hyponatremia' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT COUNT(DISTINCT p.patient_id) FROM patient p INNER JOIN diagnosis d ON p.patient_id = d.patient_id WHERE p.patient_id IN (SELECT patient_id FROM patient WHERE diagnosis_code = 'cachexia') AND d.diagnosis_code IN ('hyposmolality', 'hyponatremia') AND d.diagnosis_date BETWEEN d.diagnosis_date + INTERVAL '2 months' AND d.diagnosis_date - INTERVAL '2 months'"
1a2803a90ebc58ce4b381cce,Tally up the number of patients who received a granular casts lab test in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'granular casts' ) AND strftime('%Y',labevents.charttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patient_id) from lab_tests where test_name = 'Granular Casts' and year = 2100
3e872f05856966755e671a77,What was the last time that patient 10012853 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012853 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(DischargeTime) AS LastDischargeTime FROM PatientRecords WHERE PatientID = 10012853
f4a479361b2f03676b79359d,What was the total albumin 25% amount given for patient 10018081 since 12/07/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-07'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(AMOUNT) AS total_albumin_25g FROM orders WHERE order_type_id = 2 AND patient_id = 10018081 AND order_date >= '2100-12-07'
c85dcc855c873d1ffc99f027,What is today's outpatient schedule for dr. cannon?,,,select * from schedule where date=current_date and type='outpatient' and doctor='dr. cannon'
f7e72869cfd4d186d37a8a6d,"Has patient 10026354 undergone reposition left mandible with external fixation device, percutaneous approach?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 )",[{'COUNT(*)>0': 0}],"select distinct epl.patient_id, epl.visit_id, epl.encounter_id, epl.reposition_left_mandible_with_external_fixation_device_percutaneous_approach from (select patient_id, visit_id, encounter_id, max(chartdate) as chartdate from (select patient_id, visit_id, encounter_id, chartdate from epl) x group by patient_id, visit_id, encounter_id) y left join epl on y.patient_id = epl.patient_id and y.visit_id = epl.visit_id and y.encounter_id = epl.encounter_id and y.chartdate = epl.chartdate where epl.patient_id = 10026354 and epl.reposition_left_mandible_with_external_fixation_device_percutaneous_approach is not null"
77caf8ab10948c4b56ca183d,What are the five most ordered lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]",SQL Query Here
87ea2c2233393dc64798684e,What were the five most frequent lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","select lab_test_name, count(*) as test_count from (select * from lab_tests where lab_tests.test_date > current_date - interval '1 year') as recent_lab_tests group by lab_test_name order by test_count desc limit 5"
2d9caef46a791339e4a2731b,Which procedure was performed on patient 10016742 two times since 03/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,SELECT procedure_name FROM procedures WHERE patient_id = 10016742 AND procedure_date >= '03/21' GROUP BY procedure_name HAVING COUNT(procedure_name) = 2;
a3481de61e2fdd7ec5b2daad,"Number of patients who received a introduction of other therapeutic substance into heart, open approach procedure in 2100.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )",,"select count(distinct record_id) from  (select * from ADE_Lab where (procedure_drug='introduction of other therapeutic substance into heart, open approach') and date_of_service like '2100%')"
7183861df46553ab538458ae,Whats the protocol for the anticancer drugs?,,,SELECT Protocol FROM AnticancerDrugs;
b0ef9ac5dcce6d06f4eb450d,Tell me the top three most commonly prescribed drugs in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3",[],"SELECT TOP 3 medication, COUNT(*) as prescription_count FROM prescriptions WHERE year_prescribed = 2100 GROUP BY medication ORDER BY prescription_count DESC;"
55fe6d305b76e501677eed35,What was the name of the specimen that patient 10001725 received for the last time?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'spec_type_desc': 'URINE'}],SELECT name FROM Specimen WHERE patient_id = 10001725 ORDER BY date_administered DESC LIMIT 1
79c093726d46e6acd2287106,"What was the name of the drug that patient 10018081 was prescribed with in the same hospital encounter after undergoing ileostomy, not otherwise specified during this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,SQL Query here
3fa947a7c4c696baf058e932,Is the value of hemoglobin of patient 10006580 last measured on the last hospital visit less than the value second to last measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT CASE WHEN MAX(hb_value) < (SELECT MAX(hb_value) FROM patient_measurement WHERE patient_id = '10006580' AND visit_date < (SELECT MAX(visit_date) FROM patient_visit WHERE patient_id = '10006580')) THEN 'Yes' ELSE 'No' END AS result FROM patient_measurement WHERE patient_id = '10006580' AND visit_date = (SELECT MAX(visit_date) FROM patient_visit WHERE patient_id = '10006580')
23bba64a79ae703a2b84c6e6,What was the last time patient 10007818 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007818 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(discharge_date) FROM hospital_stays WHERE patient_id = 10007818;
d17c786dec93d192f68c22dd,When was the last time patient 10027602 had input on 12/03/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-03' ORDER BY inputevents.starttime DESC LIMIT 1",[],SELECT MAX(eventdatetime) FROM `physionet-data.mimiciii_clinical.inputevents_mv` WHERE subject_id=10027602 AND eventdate='2017-03-12' AND category='Input'
f46885deabda4129f8960805,Has patient 10037861 gone through any lab test since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'",[{'COUNT(*)>0': 1}],SELECT * FROM LabTests WHERE PatientID = 10037861 AND TestDate > '2100-04-01'
366d08a0b63e3cc04f1a4df1,What are the prices of the drug albumin 25% (12.5g / 50ml)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'albumin 25% (12.5g / 50ml)' ),,SELECT price FROM drugs WHERE name='albumin 25%' AND concentration='12.5g / 50ml'
fa77bf576a4300f065e04807,What was the output that patient 10018845 first had since 04/09/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-09' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Void'}],"SELECT TOP 1 output, event_date FROM `labevents` WHERE subject_id = 10018845 AND event_date >= '04/09/2100' ORDER BY event_date ASC"
c70358d01148240eb97f8568,What was the maximum value of creatinine in patient 10031404's body since 05/2100?,"SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-05'",[{'MAX(labevents.valuenum)': None}],SELECT MAX(creatinine) FROM lab_tests WHERE patient_id = '10031404' AND test_date >= '05/2100'
16a44e61297946c6928ab617,What was the name of the specimen test that patient 10026406 had for the first time in 01/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '01' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT DISTINCT test_name FROM tests WHERE patient_id = 10026406 AND test_date >= 'YYYY-01-01' ORDER BY test_date ASC LIMIT 1
c4583562855d6e407a1c88ed,What is the minimum yearly number of patients who suffer from history of falling?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'history of falling' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,SELECT MIN(YearlyPatients) FROM Patients WHERE Condition = 'History of Falling';
6b42551afc7b875d354f4b01,When are the dr. gutknecht's rounds and procedures?,,,SELECT DISTINCT rounds.rnd_date FROM rounds INNER JOIN dr ON rounds.rnd_id = dr.rnd_id WHERE dr.last_name = 'Gutknecht' OR dr.first_name = 'Gutknecht' UNION SELECT DISTINCT procedures.proc_date FROM procedures INNER JOIN dr ON procedures.proc_id = dr.proc_id WHERE dr.last_name = 'Gutknecht' OR dr.first_name = 'Gutknecht' ORDER BY proc_date
586ca890e966f98f077187c9,What was the average value of lipase in patient 10021487's body in 12/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12'",[{'AVG(labevents.valuenum)': None}],select avg(chem_value) from patient_observations where patient_id=10021487 and observation_date >= '2023-12-01' and observation_date <= '2023-12-31' and chem_name='lipase' and specimen_type='serum'
25c1ae6ee1303d4325b02e56,When was the last time the heart rate of patient 10018081 registered greater than 73.0 yesterday?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 73.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT MAX(time) FROM heart_rate WHERE person_id = 10018081 AND value > 73.0 AND time BETWEEN '2023-07-11 00:00:00' AND '2023-07-11 23:59:59'
8131eb8d99a9ae08b543fab4,Has patient 10026255 been tested in the hemoglobin lab in 10/this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM LabResults WHERE patient_id = 10026255 AND lab_name = 'hemoglobin' AND EXTRACT(YEAR FROM test_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND EXTRACT(MONTH FROM test_date) = 10
9e7aa17566ee6e70df48c838,How many insertion of drug-eluting coronary artery stent(s) treatments were executed?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of drug-eluting coronary artery stent(s)' ),[{'COUNT(*)': 0}],SELECT COUNT(*) AS NumberOfStentInsertions FROM treatments WHERE procedure_description LIKE '%drug-eluting coronary artery stent%';
b555ee213c4e95edc4e8b7e9,How many hours has it been since the first time that patient 10021487 was diagnosed with acute and subacute necrosis of liver in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,select (unix_timestamp()-unix_timestamp(min(date))) as hours from `conditionOccurrence` where person_id='10021487' and condition_concept_id=(select concept_id from concept where concept_code='C0030622' and concept_class_id='Condition or Problem' and vocabulary_id='SNOMED')
612076c066409c1c13b808e5,What is the common method for taking lidocaine 0.5%?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'lidocaine 0.5%',[],SELECT method FROM medication_administration WHERE medication_name = 'Lidocaine 0.5%'
99ce32579f34baf63f28f671,"On the current hospital visit, how many hours passed since the first physical restraints status diagnosis of patient 10004733?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'physical restraints status' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT TIMESTAMPDIFF(HOUR, MIN(diagnosis_time), CURRENT_TIMESTAMP()) AS hours_passed FROM Diagnosis WHERE patient_id = 10004733 AND diagnosis_category = 'Physical Restraints Status' AND visit_id = (SELECT visit_id FROM HospitalVisit WHERE patient_id = 10004733 AND visit_date = CURRENT_DATE())"
2142e73a54b9782926053e6a,Count the number of hospital visits patient 10021118 had since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10021118 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],SELECT COUNT(*) AS num_visits FROM `bigquery-public-data.hospital_affiliation.hospital_visit` WHERE patient_id = '10021118' AND visit_date >= '2100-01-01'
53fbf62aeeffb338f67df6cc,Tell me the price of trimethoprim.,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'trimethoprim' ),,SELECT price FROM drugs WHERE name = 'trimethoprim'
04c847911489606e9cc2a6d2,Was any medication prescribed to patient 10031404 on the last hospital visit?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],select * from prescriptions where patient_id = 10031404 and visit_date = (select max(visit_date) from prescriptions where patient_id = 10031404)
d72f15251b85ed2e1b191e0f,List the drugs that should not be administered during procedure-one vessel?,,,SELECT drug_name FROM Drug_Administration WHERE procedure_name='one vessel' AND should_administer='No'
d838d9dd02777dbf09b9e81b,How many times acetaminophen-caff-butalbital was ordered in the last year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'acetaminophen-caff-butalbital' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)': 0}],"SELECT COUNT(*) FROM orders WHERE drug_name = 'acetaminophen-caff-butalbital' AND order_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
af8069263b44e7b3d7b8dee2,What was the admission type for patient 10024043's first entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10024043 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1",[{'admission_type': 'EU OBSERVATION'}],select top 1 admission_type from ADMISSIONS where patient_id = '10024043' order by admission_date asc
2b35fcda321bd6bbe4114dd2,Is patient 10018423's respiratory rate second measured on the last ICU visit greater than the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN MAX(case when measurement_order = 2 then value else NULL end) > MAX(case when measurement_order = 1 then value else NULL end) THEN 'Yes' ELSE 'No' END as Is_Greater FROM (SELECT value, measurement_order FROM measurements WHERE person_id = 10018423 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visits WHERE person_id = 10018423 AND visit_concept_id = 9203) AND measurement_concept_id = 5092003) as subquery"
dc27aa9c5779993d3b2034ed,What are the four most frequently tested specimens for patients that received arteriography of other intra-abdominal arteries previously within 2 months since 2100?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 specimen_name, COUNT(specimen_name) AS frequency FROM LabTestResults INNER JOIN PatientVisits ON LabTestResults.patient_id = PatientVisits.patient_id INNER JOIN ImagingTests ON PatientVisits.patient_id = ImagingTests.patient_id WHERE ImagingTests.procedure_name = 'arteriography of other intra-abdominal arteries' AND ImagingTests.test_date > DATEADD(month, -2, '2100-01-01') GROUP BY specimen_name ORDER BY frequency DESC"
e2ae9a4a36ba36236e991b0e,How many patients underwent arteriography of other specified sites in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other specified sites' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )",,SELECT count(*) AS total_patients FROM inpatient WHERE inpatient.DIAGNOSIS_CD like 'V462%' AND inpatient.YEAR = '2100' AND inpatient.EDUCATION = 'College' AND inpatient.AGE > 50
7c43cec9b8ce603b7b6a81b1,"Since 07/06/2100, when did patient 10036156 receive an input for the first time?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-06' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2157-07-01 05:00:00'}],select MIN(date) as first_input_date from (select * from chartevents where itemid=227766 and charttime > '2100-06-07' and isinput = 1 and patientunitstayid in (select patientunitstayid from chartevents where itemid=227766 and isinput = 1 and patientunitstayid in (select patientunitstayid from admissions where hadm_id in (select hadm_id from patients where subject_id = 10036156)) and charttime > '2100-06-07'))
ed6f8d67b33854602df8651f,How much is the drug named cepacol (menthol)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'cepacol (menthol)' ),,SELECT price FROM products WHERE name = 'cepacol (menthol)';
da7b960f34b7f3185ea6d045,What was the name of the medication that was first prescribed to patient 10029484 on their first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Bisacodyl'}],SELECT medication_name FROM prescriptions WHERE patient_id = 10029484 ORDER BY visit_date ASC LIMIT 1
ac30cc56e20308d54af2b8cd,When was the last time that patient 10022281 had a maximum SaO2 in the first ICU visit?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(""SaO2""), ""First ICU stay"" FROM ""Vital Signs"" WHERE ""Patient ID"" = 10022281 AND ""ICU Visit"" = 1"
cb5360f692863a0eab68182e,What is the change in the medication of patient 10004733 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"SELECT p.patient_id, p.medication AS today_medication, pm.medication AS yesterday_medication, (p.medication <> pm.medication) AS medication_changed FROM PatientPrescription p LEFT JOIN PatientPrescription pm ON p.patient_id = pm.patient_id AND pm.prescription_date = DATE_SUB(CURDATE(), INTERVAL 1 DAY) WHERE p.patient_id = '10004733' AND p.prescription_date = CURDATE()"
eba7513c50f91f2da09549f4,When was patient 10019172 prescribed aspirin and aspirin ec at the same time for the first time since 04/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10019172 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin ec' AND admissions.subject_id = 10019172 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT MIN(start_date) FROM prescriptions WHERE patient_id = 10019172 AND (drug_name = 'aspirin' OR drug_name = 'aspirin ec') GROUP BY patient_id HAVING COUNT(DISTINCT drug_name) = 2 AND start_date >= '04/21/2000'
f7dd12718e496d0937b3d1be,What is the percentile of 1.9 in a phosphate lab test conducted at the same age as patient 10007928 on their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 1.9",,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY phos) OVER (PARTITION BY hpoa) FROM labevents WHERE subject_id = (SELECT subject_id FROM labevents WHERE hadm_id = (SELECT MAX(hadm_id) FROM labevents WHERE subject_id = 10007928) AND itemid = 50868) AND itemid = 50868 AND hpoa = (SELECT hpoa FROM labevents WHERE hadm_id = (SELECT MAX(hadm_id) FROM labevents WHERE subject_id = 10007928) AND itemid = 50868);
67b61395fd1f2d6c03d0af1e,"Among patients aged 30s since 2100, what are the top three most common diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as count FROM patient_diagnoses WHERE patient_age BETWEEN 30 AND 39 AND admission_date >= '2100-01-01' GROUP BY diagnosis ORDER BY count DESC LIMIT 3"
399156b9ba93c105aec739fd,What was the name of the organism found in patient 10021487's last bronchoalveolar lavage microbiology test since 08/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT name FROM bronchoalveolar_lavage_results WHERE patient_id = 10021487 AND collection_date = (SELECT MAX(collection_date) FROM bronchoalveolar_lavage_results WHERE patient_id = 10021487 AND collection_date > '08/2100')
e4e425cc7d58d5e7949bf727,"Since 1 year ago, has patient 10019917 received a diagnosis?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')",,select count(*) as diagnosis_count from diagnosis_records where patient_id = 10019917 and diagnosis_date > current_date - interval '1 year' and diagnosis is not null
dba29179e51c6b419b68143d,Can you tell me which were the top three most frequently tested specimens?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT specimen_name, COUNT(*) AS test_count FROM LaboratoryRecords GROUP BY specimen_name ORDER BY test_count DESC LIMIT 3;"
f081cc4e63e6199eb7122b0c,Existe-t-il a genetic test that is recieved by patient 54700?,,,SELECT COUNT(*) FROM genetic_tests WHERE patient_id = 54700
20ff0d8a96d5878700a5ea94,"Patient 10036156, when was your last mrsa screen microbiology test on the last hospital visit?",SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT TOP 1 TestDate FROM PatientTests WHERE PatientID = '10036156' AND TestType = 'mrsa' AND TestResult = 'positive' ORDER BY TestDate DESC
0b19e40d278a97e915037e52,"Compared to yesterday, what were the new prescriptions for patient 10039831 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],select count(*) from prescription where patient_id = 10039831 and prescription_date = current_date - interval '1 day' and drug_id not in (select drug_id from prescription where patient_id = 10039831 and prescription_date = current_date - interval '2 day')
3f228b2d28b47133dbf76724,"For the patients with age 30s, what are the top four most frequent diagnoses since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"select diagnosis, count(*) as diagnosis_count from diagnoses where patient_age between 30 and 39 and visit_date >= '2100-01-01' group by diagnosis order by diagnosis_count desc limit 4"
24f447b683e61e944f998093,"For the last time, what was the medication that patient 10015860 was prescribed in 10/this year via the pr route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.route = 'pr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT medication FROM prescriptions WHERE patient_id = '10015860' AND route = 'pr' AND year(date_prescribed) = year(CURRENT_DATE) AND month(date_prescribed) = 10 ORDER BY date_prescribed DESC LIMIT 1
f32d842f0e3bf602efb3e22f,Calculate how many patients were in medical/surgical intensive care unit (micu/sicu) in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"select count(*) from patients where unit in ('micu', 'sicu') and year = 2100"
faa2fbd6a8db7bed5790ed25,Tell me the duration in days of patient 10022017's last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.4736574068665504}]",
75ad30a366fbe3a6f2ed6f8a,Tell me the top three most common diagnoses for patients aged 30s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as diagnosis_count FROM patients WHERE age BETWEEN 30 AND 39 GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 3;"
87539c9734c671cc091d67fc,When last did patient 10018081 have the minimum diastolic blood pressure since 10/04/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-10-04' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],SELECT MAX(measurement_date) FROM blood_pressure_measurements WHERE patient_id = 10018081 AND diastolic_pressure = (SELECT MIN(diastolic_pressure) FROM blood_pressure_measurements WHERE patient_id = 10018081 AND measurement_date >= '2100-10-04')
62ccca10373d7fea84d98e31,What were the three most frequent events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT event, count(*) as num FROM eventlog GROUP BY event ORDER BY num DESC LIMIT 3"
7a476916387b8ccd604b7f3e,Could you tell me the top four most common procedures for patients aged 50s since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT procedure, COUNT(*) as patient_count FROM encounters WHERE (year_of_birth BETWEEN 1950 AND 1959) AND (date_of_service > '2100-01-01') GROUP BY procedure ORDER BY patient_count DESC LIMIT 4"
f8739799c8cf7c00eb97451a,"During this year, has patient 10011398 received a diagnosis?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,"select count(distinct a.diagnosis_id) from encounters e inner join encounters_diagnosis a on e.encounter_id=a.encounter_id where patient_id=10011398 and date(e.encounter_datetime) >= date(date_trunc('year',now()))"
a34a60cc88fbeb47c1d1c41d,What is the daily maximum value of weight for patient 10019385 in 03/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-03' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],SQL Query Here
37192bb658b60d3559cff295,"What are the five most commonly ordered procedures for patients who were previously diagnosed with noncompliance with renal dialysis, which occurred in the same hospital encounter since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,SELECT TOP 5 procedure FROM encounter JOIN procedure_encounter ON encounter.encounter_id=procedure_encounter.encounter_id JOIN procedure ON procedure_encounter.procedure_id=procedure.procedure_id WHERE encounter.diagnoses LIKE '%noncompliance with renal dialysis%' AND encounter.encounter_type='Outpatient' AND encounter.encounter_date > '2100-01-01' AND encounter.admitting_diagnosis_id = procedure_encounter.procedure_id GROUP BY procedure ORDER BY COUNT(procedure) DESC
9a96aaa745308385eb906bb2,What was the name of the drug that patient 10012552 was prescribed in the same hospital visit after having received a single internal mammary-coronary artery bypass procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,select distinct drg.name from drug_refill dr join drug_group_refill dgr on dr.id = dgr.drug_refill_id join drug_group drg on dgr.drug_group_id = drg.id join encounter e on dr.encounter_id = e.id join procedure p on e.id = p.encounter_id join patient pat on e.patient_id = pat.id where pat.id = 10012552 and p.name = 'Internal mammary-coronary artery bypass' and e.visit_id = (select min(e1.visit_id) from encounter e1 join procedure p1 on e1.id = p1.encounter_id where p1.name = 'Internal mammary-coronary artery bypass' and e1.patient_id = pat.id and e1.visit_id > (select e2.visit_id from encounter e2 join procedure p2 on e2.id = p2.encounter_id where p2.name = 'Internal mammary-coronary artery bypass' and e2.patient_id = pat.id and e2.visit_id < e1.visit_id))
b3f5a532355044ec8ff3ee49,When did patient 10015860 receive the last bisacodyl and ondansetron prescription at the same time in 10/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bisacodyl' AND admissions.subject_id = 10015860 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10015860 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"SELECT MAX(prescription_date) AS last_prescription_date FROM prescriptions WHERE patient_id = '10015860' AND drug_name IN ('bisacodyl', 'ondansetron') AND YEAR(prescription_date) = 2023 AND MONTH(prescription_date) = 10 AND prescription_date IN (SELECT prescription_date FROM prescriptions WHERE patient_id = '10015860' AND drug_name = 'bisacodyl') AND prescription_date IN (SELECT prescription_date FROM prescriptions WHERE patient_id = '10015860' AND drug_name = 'ondansetron') GROUP BY prescription_date HAVING COUNT(DISTINCT drug_name) = 2"
42b0089e4e28f35c3bd7f8e5,"On this month/30, what was the first arterial blood pressure systolic reading for patient 10018081?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '30' ORDER BY chartevents.charttime ASC LIMIT 1",[],select first_value(bp_systolic) over (partition by patient_id order by test_time asc) as first_bp_systolic from blood_pressure_readings where patient_id = 10018081 and test_time <= '2023-04-30'
c8f9a04c499ddf84d314c397,What was the first thing patient 10018328 had as output on 05/09/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-05-09' ORDER BY outputevents.charttime ASC LIMIT 1 )",[],SELECT MIN(output) FROM medical_records WHERE patient_id = 10018328 AND date = '05/09/2100' ORDER BY time ASC LIMIT 1
a7957c2fffd3930db882e4cc,Count the number of patients who underwent a rbc lab test since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM patient_lab_tests WHERE lab_test_type = 'rbc' AND test_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
5bd9ccae8a4d90eca4b4002c,What was the total po intake amount given for patient 10004235 on 03/24/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-24'",[{'SUM(inputevents.totalamount)': None}],select total_po_intake from patient_intake_records where patient_id = '10004235' and intake_date = '03/24/2100'
b92c083ece2259339c38b5c1,"During the first hospital visit, was patient 10039708 admitted to an emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'COUNT(*)>0': 0}],"SELECT * FROM ""Visit"" WHERE ""Patient ID"" = 10039708 AND ""Visit ID"" = '1' AND ""Admitted"" = 'EMERGENCY'"
d062f51ae3bd2b4a5b501051,Give me the five most common treatments since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,SQL query here
74cb952e6290049d94447a5f,Tell me the last output of patient 10005909 since 269 days ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-269 day') ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Void'}],"SELECT TOP 1 output FROM patient_records WHERE patient_id = '10005909' AND record_date >= DATEADD(day, -269, GETDATE()) ORDER BY record_date DESC;"
f8fd30d0d0f870b4bd2f4abe,What was the last time patient 10038999 had a blood culture microbiology test in 05/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT * FROM (SELECT * FROM microbiology_test_results WHERE patient_id = 10038999 AND test_type = 'Blood Culture' AND date BETWEEN '2100-05-01' AND '2100-05-31' ORDER BY date DESC LIMIT 1) AS last_test
b440a7a78eb175aad7326406,Please retrieve the daily minimum amount of patient 10005817's albumin 5% input on the last hospital visit.,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],""""""""
ea99947eb86635891276c5de,Does patient 76494 have a family history of ac/chr syst/dia hrt fail,,,select count(*) from patient_history where patient_id = 76494 and condition = 'ac/chr syst/dia hrt fail'
a6fc04dbbe1e0ba75ba30f18,What was the organism found in the first bronchoalveolar lavage test of patient 10021487 since 10/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT Organism FROM Bronchoalveolar_Lavage WHERE Patient_ID = 10021487 AND Date >= '10/2100' ORDER BY Date ASC LIMIT 1
9011b8d82bdbbf46bb8ecbb9,Show me the four most common microbiology tests performed this year.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4",[],"select test_name, count(*) as test_count from microbiology_tests where test_date >= '2023-01-01' group by test_name order by test_count desc limit 4"
15e2ea64a2fe87620f2135f7,When was patient 10005348 last blood culture microbiologic test since 07/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT TOP 1 test_date FROM microbiologic_tests WHERE patient_id = '10005348' AND test_type = 'blood culture' AND test_date >= '2100-07-01' ORDER BY test_date DESC
d2d6e834bd7830831783fa05,What is the total number of days that have passed since patient 10021487's first asparate aminotransferase (ast) lab test in the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"select datediff(current_date(), min(date_drawn)) from lab_events where patient_id = '10021487' and lab_id = 'asparate aminotransferase (ast)' and visit_id = (select max(visit_id) from lab_events where patient_id = '10021487')"
904c2c0c49be0f63d95d5358,Tell me the maximum total hospital cost that involves accidental poisoning from other specified plants in 2100.,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental poisoning from other specified plants' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,select max(total_hospital_cost) as Max_Total_Hospital_Cost from drug_exposure_2100 where poisoning_type='Other Specified Plants' and cause_of_hospitalization='Accidental Poisoning'
25d2b1ca042e80e4dec9ba6c,Has there been any pacu crystalloid intake given to patient 10008287 in 10/this year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pacu crystalloid intake' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',inputevents.starttime) = '10'",[{'COUNT(*)>0': 0}],SELECT * FROM intake_records WHERE patient_id = '10008287' AND intake_type = 'crystalloid' AND substance = 'pacu' AND intake_date BETWEEN '2023-10-01' AND '2023-10-31'
d53c2b6d7e4bf45b77a8dd12,What kind of blood patient 85700 has.,,,SELECT blood_type FROM patients WHERE patient_id = 85700
f3ae841b553febe658abd103,What is the difference between respiratory rate on patient 10031404 last measured on the last ICU visit compared to the value first measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT `last_icu_vist`.patient_id, (MAX(`last_icu_vist`.resp_rate) - MIN(`last_icu_vist`.resp_rate)) AS resp_rate_diff FROM `last_icu_vist` WHERE `last_icu_vist`.patient_id = 10031404 AND `last_icu_vist`.icustay_id = (SELECT `icu_stay`.icustay_id FROM `icu_stay` WHERE `icu_stay`.patient_id = 10031404 ORDER BY `icu_stay`.discharge_date DESC LIMIT 1) GROUP BY `last_icu_vist`.patient_id"
f60d7cbfd76dabfff55dc3fa,Help me tell the name of the diagnosis patient 92846 received in the other department.,,,select diagnosis from other_department where patient_id = 92846
928843eaa6be302dc4f25820,What's the minimum total hospital cost involving a drug named ibuprofen suspension in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ibuprofen suspension' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,select min(total_hospital_cost) as min_total_hospital_cost from cost where drug_name like 'ibuprofen suspension%' and year = 2100;
15e5163ccc3e3c1f766d7f6a,Is the red blood cells level of patient 10021312 last measured on the first hospital visit greater than the second to last level measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",[SELECT CASE WHEN MAX(CASE WHEN visit_rank = 1 THEN hpo.value ELSE NULL END) > MAX(CASE WHEN visit_rank = 2 THEN hpo.value ELSE NULL END) THEN 'Yes' ELSE 'No' END AS IsGreater
c74358b1e7b5bc977788edc9,"What are the three frequently prescribed medications in the same month to the patients aged 60 or above after diagnosed with hypotension, unspecified in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypotension, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT medication, COUNT(*) AS prescription_count FROM prescriptions WHERE diagnosis = 'Hypotension, unspecified' AND YEAR(diagnosis_date) = 2100 AND MONTH(diagnosis_date) = 1 AND patient_age >= 60 GROUP BY medication ORDER BY prescription_count DESC LIMIT 3;"
5fdedc40e18f8009f6111be2,Was nacl 0.9% administrated to patient 10015272 on their last ICU stay?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],SELECT EXISTS(SELECT 1 FROM prescriptions WHERE patient_id = 10015272 AND medication = 'nacl 0.9%' AND stay_id = (SELECT MAX(stay_id) FROM icu_stays WHERE patient_id = 10015272))
361dee11faf11169d073ea66,Number of patients who received a mediastinoscopy procedure in the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'mediastinoscopy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,"SELECT COUNT(*) AS NumberOfMediastinoscopyPatients FROM PatientRecords WHERE Procedure = 'mediastinoscopy' AND ProcedureDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE();"
8444ba22b9c952cf50e50901,Can you confirm what was the first temperature celsius for patient 10021487 in their first ICU visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT MIN(temperature_celsius) as first_temperature_celsius FROM patient_vitals WHERE patient_id = 10021487 AND icu_visit = 1
15f5e817e7a5d3115e1563e0,Get me patient 10005817's total output volume since 03/12/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-12'",[{'SUM(outputevents.value)': 41303.0}],SELECT SUM(output_volume) AS total_output_volume FROM patient_output WHERE patient_id = 10005817 AND date >= '03/12/2100'
5df781cee8420b4e67b5b670,Could you show me the top three most common microbiology tests since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]","SELECT test_name, COUNT(test_id) AS test_count FROM microbiology_tests WHERE test_date >= '2100-01-01' GROUP BY test_name ORDER BY test_count DESC LIMIT 3"
2ddc5aa70252d046606081e2,What organism was found in patient 10004733's first sputum test since 08/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT Organism FROM SputumTests WHERE PatientID = 10004733 AND TestDate = (SELECT MIN(TestDate) FROM SputumTests WHERE PatientID = 10004733 AND TestDate > '08/2100')
693d2161daa94f0ac19a5ff2,What did patient 10006053 have first as the output on 11/17/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-11-17' ORDER BY outputevents.charttime ASC LIMIT 1 )",[],SELECT output_description FROM patient_outputs WHERE patient_id = 10006053 AND output_datetime = '2100-11-17' ORDER BY output_datetime ASC LIMIT 1
3c573f4b3f5561f9da5c2ca0,Count the number of patients who stayed in the previous year at trauma sicu (tsicu).,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'trauma sicu (tsicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],patient_id
2ddc53c4a796889b9c40ca78,What was the first medication that patient 10007058 was prescribed since 10/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': '5% Dextrose'}],SELECT * FROM medication_prescriptions WHERE patient_id = '10007058' AND date >= '10/21/00' ORDER BY date ASC LIMIT 1
84c70bbe9310c79050cef5e6,"What was prescribed to patient 10018423 within 2 days following their measurement of cardiac sampling and pressure, left heart, percutaneous approach?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT DISTINCT p.drug FROM Procedure p WHERE p.patient_id = 10018423 AND p.code = 'CIED Insertion' AND p.date BETWEEN (SELECT d.date FROM Diagnosis d WHERE d.patient_id = 10018423 AND d.code = 'cardiac sampling and pressure, left heart, percutaneous approach') AND (SELECT d.date FROM Diagnosis d WHERE d.patient_id = 10018423 AND d.code = 'cardiac sampling and pressure, left heart, percutaneous approach') + INTERVAL '2' DAY"
56950cbe39154cd6825d8851,What are the four most frequently tested specimens for patients that received parenteral infusion of concentrated nutritional substances previously in the same month in this year?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"[SELECT specimen_name, COUNT(*) as frequency FROM Specimen"
214a7cc494b5ad3fd78e9765,"So, when is the earliest patient 28343 is going to come in the hospital?",,,SELECT MIN(date) FROM patient_admissions WHERE patient_id = 28343 AND status = 'admitted';
ae5fdb3772ef4280f5cbd7d8,When was the first time that patient 10027602 on last month/29 had a heart rate that was less than 105.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 105.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.charttime ASC LIMIT 1",[],select min(date) as first_time_heart_rate_less_than_105 from [ehr_vitals
7d02af05751b72aaed0916cd,What exactly was the last drug that patient 10001217 was prescribed in 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 medication_name FROM prescriptions WHERE patient_id = '10001217' AND prescription_date >= '12/2100' ORDER BY prescription_date DESC
9e244cb537e766b890782d9a,What is the total volume of patient 10009628's input since 07/04/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04'",[{'SUM(inputevents.totalamount)': 22950.0}],SELECT SUM(volume) AS total_volume FROM input WHERE patientid = 10009628 AND date >= '07/04/2100'
a49ff217e1eaf845efa42727,"Since the first diagnosis of patient 10018081 with pure hypercholesterolemia on their current hospital encounter, how many days have passed?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pure hypercholesterolemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT DATEDIFF(CURDATE(), MIN(encounter_date)) FROM diagnosis_records WHERE patient_id = 10018081 AND diagnosis = 'pure hypercholesterolemia' AND encounter_type = 'current'"
46c7a622bf32b53e152dc112,When patient 10027445 was prescribed for the first time in 08/this year glucagon and insulin at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"SELECT MIN(prescription_date) AS first_prescription_date FROM prescriptions WHERE patient_id = 10027445 AND (drug_name = 'glucagon' OR drug_name = 'insulin') AND DATE_FORMAT(prescription_date, '%m') = '08' GROUP BY patient_id HAVING COUNT(DISTINCT drug_name) = 2"
c630812541cf6dfbf08a52c9,List the top four most frequently tested specimens in this year.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",[],"SELECT specimen, COUNT(specimen) AS frequency FROM clinical_tests WHERE EXTRACT(YEAR FROM test_date) = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY specimen ORDER BY frequency DESC LIMIT 4;"
a301cbb555555b4a30c9dfbe,What is a checklist before lumb/lmbosac fus ant/ant?,,,SELECT DISTINCT preop_checklist FROM surgical_procedures WHERE procedure_name = 'lumb/lmbosac fus ant/ant' AND status = 'completed'
b56a14e89ad09be086852b0f,"Has patient 10013049 got a hematocrit, calculated lab test in 2100?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND strftime('%Y',labevents.charttime) = '2100'",[{'COUNT(*)>0': 0}],select distinct lab_test_name from lab_tests where patient_id = '10013049' and lab_test_name = 'Hematocrit' and test_date = '2100-01-01' and test_type = 'Calculated'
484f6763a7263dfc6dd3843b,What's the platelet count change of patient 10021487 last measured on the current hospital visit compared to the second to last value measured on the current hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","[SELECT `patient_id`, `visit_id`, `measurement_date`, `platelet_count`, `measurement_order`,"
9c9100431bbeace3679922e0,How much does it cost to purchase phenobarbital?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenobarbital' ),,select `cost` from `drugs` where `name` = 'phenobarbital'
c6e0a3d4dc4ef5f0f7b05662,What were the top three diagnoses that had the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",,"SELECT TOP 3 diagnosis, MAX(mortality_rate_6month) FROM PatientDiagnoses GROUP BY diagnosis ORDER BY MAX(mortality_rate_6month) DESC;"
1e04b4d24fdf02742f3ee567,Has there been any organism present in patient 10037861's last blood culture microbiology test since 07/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],select distinct organism from bloodculturemicrobiology where patientid='10037861' and (testdate > '07/2100')
7963b2f32402222a44a74bc2,Was patient 10002428 to the er during their last hospital visit?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'COUNT(*)>0': 0}],"SELECT last_visit_id, patient_id, visit_type FROM er_visits WHERE patient_id = '10002428' ORDER BY visit_date DESC LIMIT 1"
ad9224e407b2a53c4120193b,Count the number of patients who took oxycodone sr (oxycontin) this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'oxycodone sr (oxycontin)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from patient_medications where medication_name = 'oxycodone sr' and YEAR(prescription_date) = YEAR(CURRENT_DATE)
acabae620677b5ffeff62317,Which are the four most common specimens tested since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]",Your Answer Here
0f42767e5be8f1f3825dbebf,What was the total jackson pratt #1 output of patient 10020740 since 02/04/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'jackson pratt #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-04'",[{'SUM(outputevents.value)': None}],SELECT SUM(output) AS TotalOutput FROM jackson_pratt_records WHERE patient_id = '10020740' AND device_number = 1 AND date >= '02/04/2100'
f26956b68a52957757b13e45,What was the last time that patient 10015272 had the maximum value of white blood cells?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],"SELECT MAX(white_blood_cell_count) AS max_wbc, date_time FROM patient_data WHERE patient_id = 10015272 GROUP BY date_time ORDER BY date_time DESC LIMIT 1"
0032247aa14645cbf758a680,Tell me the top four most commonly prescribed medications during the same hospital encounter to patients in their 50s who were diagnosed with other and unspecified hyperlipidemia.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,
970112eab9858a27e20a091f,Can you please tell me the name of the diagnosis that patient 73693 received from the other department?,,,select diagnosis from diagnoses where patient_id = 73693 and department != current_department
e5feed6651e93e164fbd7c11,What was patient 10036156's total input amount of po intake during the last ICU visit?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],select sum(t.intake_quantity) from t_patient p inner join t_intake t on p.patient_id = t.patient_id where p.patient_id = '10036156' and t.intake_route = 'PO' and t.intake_type = 'input' and t.visit_id = (select max(v.visit_id) from t_visit v where v.patient_id = p.patient_id and v.visit_location = 'ICU')
653ee6598cd92b3382f04431,"Has octreotide acetate, furosemide, or trazodone been prescribed since 20 months ago to patient 10019777?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND prescriptions.drug IN ( 'octreotide acetate', 'furosemide', 'trazodone' ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-20 month')",[{'COUNT(*)>0': 0}],"SELECT DISTINCT m.medicine_name FROM medicine m, medical_record mr, medical_record_medicine rm WHERE m.medicine_id=rm.medicine_id AND rm.medical_record_id=mr.medical_record_id AND mr.patient_id=10019777 AND mr.creation_date >= DATE_SUB(CURDATE(), INTERVAL 20 MONTH) AND (m.medicine_name='octreotide acetate' OR m.medicine_name='furosemide' OR m.medicine_name='trazodone')"
5b078faf4cef1188372987db,Has patient 10001217 been administered any nacl 0.9% in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'",[{'COUNT(*)>0': 0}],SELECT DISTINCT i.patient_id FROM ihan.order o JOIN ihan.item i ON o.itemid = i.itemid WHERE o.patient_id = 10001217 AND o.starttime BETWEEN '2022-11-01' AND '2022-12-31' AND i.itemid IN (SELECT itemid FROM ihan.item WHERE name LIKE '%nacl 0.9%')
56fd4c77a08d2c69466f3daf,How is readi-cat 2 (barium sulfate 2% suspension) typically consumed?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'readi-cat 2 (barium sulfate 2% suspension)',[],select distinct how_to_take from medication_usage where medication_name = 'readi-cat 2 (barium sulfate 2% suspension)'
cc8811490b346c0fe68bf66b,How much does patient 10027602's weight differ from the second value measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT ABS(first_measurement.weight - second_measurement.weight) AS weight_difference FROM (SELECT weight FROM weight_measurements WHERE patient_id = 10027602 ORDER BY visit_date DESC, measurement_time ASC LIMIT 1) AS first_measurement, (SELECT weight FROM weight_measurements WHERE patient_id = 10027602 ORDER BY visit_date DESC, measurement_time ASC LIMIT 1 OFFSET 1) AS second_measurement"
f3ecb8116711437750ac3fb5,What was the last time patient 10020740 was prescribed medications via the po/ng route on their first hospital visit?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT MAX(DATE) AS last_prescription_date FROM prescriptions WHERE patient_id = 10020740 AND route = 'po/ng' AND visit_number = 1
eedf0ba9662962adc4283987,"The last time , when was patient 10002495 prescribed insulin and atorvastatin at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'insulin' AND admissions.subject_id = 10002495 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'atorvastatin' AND admissions.subject_id = 10002495 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = 10002495 AND (drug_name = 'insulin' OR drug_name = 'atorvastatin') GROUP BY prescription_date HAVING COUNT(DISTINCT drug_name) = 2
c919552da540025ef269dfef,Tell me all of the prescriptions patient 2518 was given in the other department,,,SELECT prescription FROM prescriptions WHERE patient_id = 2518 AND department != 'current_department'
792f2622a77b8638438de22f,"For patients diagnosed with other specified retention of urine before, what are the top five most common treatments in the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified retention of urine' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,
00ab16773d5c5cbe1e63f28b,Which are the top three most frequent procedures patients had within 2 months after being diagnosed with other opiates and related narcotics causing adverse effects in therapeutic use?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other opiates and related narcotics causing adverse effects in therapeutic use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"select procedure_name, count(*) as frequency from procedures p join diagnosis d on p.patient_id = d.patient_id where d.condition = 'other opiates and related narcotics causing adverse effects in therapeutic use' and p.date between d.date and date_add(d.date, interval 2 month) group by procedure_name order by frequency desc limit 3"
5df1cd4b427c7adcfb315ff9,"During the last hospital encounter, what was the insurance plan of patient 10007795?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicare'}],SELECT InsurancePlan FROM PatientEncounters WHERE PatientID = '10007795' AND EncounterDate = (SELECT MAX(EncounterDate) FROM PatientEncounters WHERE PatientID = '10007795')
197b621f36437cbb2e24f71e,Tell me the minimum SaO2 of patient 10010471 since 66 days ago.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-66 day')",[{'MIN(chartevents.valuenum)': None}],"SELECT MIN(SaO2) FROM patient_readings WHERE patient_id = 10010471 AND reading_date >= DATE_SUB(CURRENT_DATE, INTERVAL 66 DAY)"
f517e3cce89ac464b8a1e6e1,What is the monthly average value of weight for patient 10007818?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)",[],SELECT AVG(weight) FROM patient_data WHERE patient_id = 10007818 GROUP BY MONTH(date_recorded)
57bfa65e25858649a7b7fdb1,Did patient 10039831 get a diagnosis in the last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"SELECT COUNT(*) FROM patient_diagnoses WHERE patient_id = 10039831 AND diagnosis_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
8aff2d41878a4fe47a7284aa,Show me the length of stay in days of patient 10015860 from the last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.6421874999068677}]","SELECT DATEDIFF(day, Admitted, Discharged) AS LengthOfStay FROM ICUStays WHERE PatientID = 10015860 ORDER BY Admitted DESC LIMIT 1"
866f0e3f587b1c8992a48c02,What time was the first time the respiratory rate of patient 10020740 was less than 24.0 on 04/14/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 24.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-04-14' ORDER BY chartevents.charttime ASC LIMIT 1",[],select min(datetime) from emr_records where patient_id = 10020740 and datetime::date = '2100-04-14' and respiratory_rate < 24.0
620fed67edcc618c82c9bb68,How many hours is it since patient 10004733 last received the magnesium lab test on their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(hour, MAX(Magnesium.lab_date), GETDATE()) FROM lab_results WHERE Patient_ID = 10004733 AND encounter_id = (SELECT encounter_id FROM encounters WHERE encounter_end_date IS NULL AND encounter_id = (SELECT MAX(encounter_id) FROM encounters WHERE Patient_ID = 10004733)) AND test_name = 'magnesium'"
9ef4ff1a80eff792fae7eaf6,Calculate the number of patients diagnosed with other and unspecified escherichia coli [e. coli] in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified escherichia coli [e. coli]' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )",,SELECT COUNT(*) FROM PatientDiagnoses WHERE diagnosis = 'other and unspecified e. coli' AND YEAR(diagnosis_date) = 2100;
2ace025c677add406539f6bd,Is there any medication that patient 10039708 has received since 11/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'",[{'COUNT(*)>0': 1}],SELECT * FROM Medications WHERE patient_id = 10039708 AND date >= '11/2100'
8e706a5e5f4902a5d9824238,Has patient 10037975 undergone any procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ),[{'COUNT(*)>0': 1}],SELECT DISTINCT procedure_name FROM patient_records WHERE patient_id = 10037975 AND procedure_date IS NOT NULL
fdf5c1e275419554ef051eb7,"In 2100, what were the top four most commonly tested specimens?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",[],"select specimen_type, count(specimen_type) as count from specimen_tests where test_date between '2100-01-01' and '2100-12-31' group by specimen_type order by count desc limit 4"
188357b19ef7a1e1306dde6a,What is the average daily number of patients suffering from malignant neoplasm of unspecified part of unspecified bronchus or lung?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,SELECT AVG(DailyPatientCount) AS AverageDailyPatients FROM (SELECT COUNT(*) AS DailyPatientCount FROM PatientRecords WHERE ICD10Code='C78.9' AND Date BETWEEN '2023-01-01' AND '2023-01-31' GROUP BY Date) AS DailyCounts
ec87b2a66e1ee117d0c97694,What was the total of 0.9% sodium chloride that patient 10018423 had been prescribed in 05/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND prescriptions.drug = '0.9% sodium chloride' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'",[{'SUM(prescriptions.dose_val_rx)': None}],select sum(amount) from prescriptions where patient_id = '10018423' and medication = '0.9% sodium chloride' and date_prescribed between '05/01/2100' and '05/31/2100'
cc8133f15a89f38b3c28c9e9,What was the name of the organism found in the first mini-bal microbiology test of patient 10027602 in 12/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT organism_name FROM microbiology_results WHERE patient_id = 10027602 AND test_type = 'mini-bal' AND test_date = '2100-12-01' ORDER BY test_date ASC LIMIT 1
ab7b619c104c7acdd3b347a6,"Number of patients who were given a drainage of left pleural cavity, percutaneous approach procedure since 1 year ago.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') )",,select count(distinct patient_id) from procedure_events where procedure_type = 'drainage of left pleural cavity' and approach = 'percutaneous' and date >= current_date - interval '1 year'
a00135dbda426f37103c4031,Calculate the total volume of input by patient 10018081 on this month/29.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '29'",[{'SUM(inputevents.totalamount)': None}],"SELECT SUM(`inputVolume`) FROM `patientMeasurements` WHERE `patientId` = '10018081' AND `date` >= DATE_FORMAT(NOW() ,'%Y-%m-01') AND `date` <= LAST_DAY(NOW());"
79435a6fda1d423ee215c027,Is there any genetic test that patient 14035 received?,,,SELECT DISTINCT test FROM genetics WHERE patient_id = 14035
ae62f6afd4c306068c936631,Reveal the five most frequently prescribed medications in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5",[],"SELECT medication_name, COUNT(*) AS prescription_count FROM prescriptions WHERE YEAR(prescription_date) = 2100 GROUP BY medication_name ORDER BY prescription_count DESC LIMIT 5"
a2f8e369e61f50385ba06afd,Has patient 10016150 been given any diagnosis?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ),[{'COUNT(*)>0': 1}],SELECT DISTINCT diagnosis_code FROM medical_records WHERE patient_id = '10016150' AND diagnosis_code IS NOT NULL;
395e9529519397ab2b92b3bf,When was the last input time since 05/14/2100 for patient 10027602?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-14' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2201-12-13 16:51:00'}],SELECT MAX(INPUT_TIME) FROM [TABLE_ID
35727539614c8de00c1936fa,Has a procedure been performed on patient 10013049?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ),[{'COUNT(*)>0': 1}],SELECT * FROM procedures WHERE patient_id = '10013049'
c06489b1989596c5c396021d,What code is associated with icd-11 for aphasia in icd-10?,,,[SELECT i11.code
3355ff6ec63f5859b0030ed5,List the four most frequent specimens that were tested since 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]","SELECT specimen, COUNT(specimen) AS frequency FROM laboratory_data WHERE year >= 2100 GROUP BY specimen ORDER BY frequency DESC LIMIT 4;"
3b1ed5c49626132195b70ec8,What was the name of the organism in the last abscess microbiology test of patient 10001217 since 10/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT TOP 1 organism_name FROM microbiology_tests WHERE test_type = 'abscess' AND patient_id = '10001217' AND test_date > '10/2100' ORDER BY test_date DESC;
e51c2dd489fa0ebf1c2b7700,What is the protocol used for the anticancer drugs?,,,select protocol from DrugProtocols where drugType='anticancer'
94f9e6d642b39e6a9d1a0559,What is the maximum total cost for a hospital visit that involved a macrophage lab test?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'macrophage' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT MAX(total_cost) FROM hospital_visits WHERE lab_tests LIKE '%macrophage%'
79cd6dad6ad9f5ff2c2684e6,What was the name of that first specimen test patient 10029484 got since 11/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'MRSA SCREEN'}],SELECT name FROM specimen_tests WHERE patient_id = '10029484' AND test_date > '11/2100' ORDER BY test_date ASC LIMIT 1
917adcbd5e526c5a6f592092,What was the first time patient 10029291 input time on 02/25/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-02-25' ORDER BY inputevents.starttime ASC LIMIT 1",[],SELECT MIN(input_time) AS first_input_time FROM patient_data WHERE patient_id = '10029291' AND input_date = '02/25/2100';
db9a6d17c2bdc3d58e519267,When was the first time that patient 10021487 had the minimum value of heart rate on 12/10/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-10' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(heart_rate), visit_date FROM vitals WHERE patient_id = 10021487 AND visit_date = '2023-12-10';"
5ec73b90a9326c7868163c73,When was the first time patient 10018081 was prescribed drugs via oral since 08/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.route = 'oral' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"select min(effective_date) from (select distinct e2.effective_date from encounter e1 join encounter e2 on e1.encounter_id=e2.encounter_id and e2.effective_date>='08/21/00' join orders o on e1.encounter_id=o.encounter_id and e2.visit_id=o.visit_id join concept_name cn on o.concept_id=cn.concept_id and cn.name like '%oral%' and cn.concept_class='CIEL:1077' and cn.voided=0 join drug_order d on o.order_id=d.order_id join concept_name dc on d.drug_concept_id=dc.concept_id and dc.voided=0 and dc.name not like '%oral%' and dc.concept_class='CIEL:1076' where e1.patient_id=10018081 and e1.voided=0 and e1.encounter_type in (1,2) and e1.encounter_datetime<'08/21/00') e"
e60031fe0c3c45aa32032148,Could you list the top five most common lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT lab_test_name, COUNT(*) as frequency FROM lab_tests GROUP BY lab_test_name ORDER BY frequency DESC LIMIT 5"
dc414e02268ef72244d435fd,Is the value of bicarbonate last measured on the last hospital visit of patient 10019172 greater than its value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",[SELECT CASE WHEN last_value > first_value THEN 'Yes' ELSE 'No' END AS Is_Bicarbonate_Increasing
d28d6593912738578589157f,What is the percentile of 80.0 in the ferritin lab test with the same age as patient 10002428 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 80.0",,[SELECT PERCENT_RANK() OVER (ORDER BY ferritin_lab_test_value) AS percentile
924d74602015e6d3739732e2,What were the four most frequent microbiology tests that occurred in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4",[],"SELECT microbiology_test, COUNT(*) AS frequency FROM microbiology_tests WHERE test_date BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY microbiology_test ORDER BY frequency DESC LIMIT 4;"
6f420047cefd3ec90873fd93,What are the new prescriptions for patient 10018081 today compared to those received yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],select prescriptions from medical_records where patient_id=10018081 and date=current_date; select prescriptions from medical_records where patient_id=10018081 and date=current_date - 1;
098b1301820b7d581a339d0f,What was the first time patient 10018081 was prescribed a medication using the iv drip route in 12/this year?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND prescriptions.route = 'iv drip' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(date) AS first_iv_drip_prescription_date FROM prescriptions WHERE patient_id = 10018081 AND route = 'iv' AND YEAR(date) = YEAR(CURDATE()) AND MONTH(date) = 12
1d4b0f83e48e3a972b624537,Work out the total amount of input patient 10016742 received on 08/04/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '08-04'",[{'SUM(inputevents.totalamount)': None}],"SELECT SUM(amount) FROM input WHERE patient_id = 10016742 AND input_date = DATE_FORMAT(NOW(),'%Y-04-08')"
7cbf3d09dcab163910469c88,What was the organism detected during the first urine microbiology test of patient 10037861 since 08/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT Organism FROM urine_microbiology WHERE PatientID = 10037861 AND TestDate >= '08/2100' ORDER BY TestDate ASC LIMIT 1
11a1a3c59f2b62a99f566f9f,Which are the top three most frequent output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT `output`, COUNT(*) AS frequency FROM `events` WHERE `timestamp` >= '2100-01-01' GROUP BY `output` ORDER BY frequency DESC LIMIT 3"
89130abd0de50ce13b9c3566,What was the five most common lab test that was given during this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],"SELECT test_name, COUNT(*) AS test_count FROM lab_tests WHERE YEAR(test_date) = YEAR(CURRENT_DATE) GROUP BY test_name ORDER BY test_count DESC LIMIT 5"
94d863c5097e63e95a31ebf4,"What is the minimum total cost of the hospital visits that involve a procedure named occlusion of right vertebral artery with intraluminal device, percutaneous approach since 1 year ago?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT MIN(total_cost) FROM HospitalVisits WHERE procedure_description = 'occlusion of right vertebral artery with intraluminal device, percutaneous approach' AND visit_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
fec026b891afb9bccb1664e9,"Count the number of patients who received dilation of left external iliac vein with intraluminal device, percutaneous approach within 2 months after being diagnosed with operating room of hospital as the place of occurrence of the external cause in the last year.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'operating room of hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,
bb12c577d54cdbb658f77087,"Since 12/2100, when did patient 10021118 receive their last medication via the po route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(dispense_date) AS last_po_meds_date FROM dispense WHERE patient_id = '10021118' AND dispense_date > '2012-12-21' AND route = 'po'
6b992edeff1d490c7c58f9d0,Could you tell me the sex of patient 10019172?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10019172,[{'gender': 'F'}],SELECT sex FROM patient_data WHERE patient_id = 10019172
546a49550415320fbb9316ad,What was the last time in 05/this year patient 10018328 was prescribed a medication via the iv route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],select max(date) from medication_administration where patient_id = '10018328' and route = 'IV' and date between '05-01-2023' and '05-31-2023'
efd16ed6fcf1c6e667f9bca7,Calculate the number of people who had arteriography of cerebral arteries last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,SQL Query Here
e23231367907b1d48afece71,Give me patient 10026406's length of stay in days for the first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 0.48175925901159644}]",select extract(day from (min(discharge_timestamp) - min(enter_timestamp))) as first_icu_stay_days from labevents where subject_id = 10026406 and hadm_id = (select min(hadm_id) from labevents where subject_id = 10026406)
8e476e63901b7be2cdb602f9,Can you tell me what patient 10027602's first arterial blood pressure diastolic was since 08/13/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-13' ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT patient_id, MIN(diastolic) AS first_diastolic FROM arterial_blood_pressure WHERE patient_id = 10027602 AND date >= '08/13/2100' ORDER BY date ASC LIMIT 1"
ec4b556e4ac98f7c6485240b,Tell me the icd-11 code for candidias urogenital nec in icd-10?,,,SELECT icd_11_code FROM icd_11_codes WHERE icd_10_code = 'B37.3'
45ea928adb31250e23c1e7d7,What's the maximum total cost of a hospital that involves suicidal ideation?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) ) GROUP BY cost.hadm_id ) AS T1,,SQL query
130ed6628164c3afe9589f2d,"What were the three most commonly ordered lab tests for patients who were previously diagnosed with hemorrhage of rectum and anus during the same hospital visit, since 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage of rectum and anus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,
a59aa4e1124cf98b542230d0,Tell me the total number of patients who were discharged from the hospital since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) AS total_patients_discharged FROM admissions WHERE discharge_date > CURRENT_DATE - INTERVAL '1 year';
774183417c33e5ca1129707b,Tell me the average total hospital cost that involves methylnaltrexone in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylnaltrexone' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_cost) FROM hospital_stay WHERE medication_name = 'methylnaltrexone' AND YEAR(admission_date) = 2100
336b4ae66fafe9409bbf3780,Tell me the maximum SaO2 in patient 10007058 since 11/25/2100.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-11-25'",[{'MAX(chartevents.valuenum)': None}],SELECT MAX(O2_SAT) FROM oxygentherapy WHERE ptid = '10007058' AND charttime > '2111-25' AND O2_SAT IS NOT NULL
5a702ecafc152197b73cc54c,"In 2100, how many patients were prescribed prasugrel?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prasugrel' AND strftime('%Y',prescriptions.starttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE drug_name = 'prasugrel' AND YEAR(prescription_date) = 2100
d84033aab28898c9a733e209,Can you tell me how old patient 10039708 was in their last hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,"SELECT DATEDIFF(year, p.birthday, v.visit_date) AS age FROM patients AS p INNER JOIN visits AS v ON p.id = v.patient_id WHERE p.id = 10039708 ORDER BY v.visit_date DESC LIMIT 1"
2599f881605016f342ed4ad8,What was the first value of o2 saturation pulseoxymetry patient 10001217 had on 12/04/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-04' ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(o2_saturation) AS ""First Value"" FROM patient_data WHERE patient_id = 10001217 AND measurement_date = '2023-04-12' AND measurement_type = 'pulseoxymetry'"
f85c9633e450cf4188a98ce3,Get me the top three most common diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]","SELECT diagnosis, COUNT(*) AS diagnosis_count FROM [TABLE_ID"
187e5274711fbc5acb26d92f,When did patient 10004733 first have a maximum heart rate yesterday?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(date) FROM (SELECT date, MAX(heart_rate) AS max_heart_rate FROM patient_data WHERE patient_id = 10004733 AND date = CURRENT_DATE - INTERVAL '1 day' GROUP BY date) AS subquery WHERE max_heart_rate = (SELECT MAX(heart_rate) FROM patient_data WHERE patient_id = 10004733 AND date = CURRENT_DATE - INTERVAL '1 day')"
d59d0db4be4aa6b37d49b1ef,Has any organism been found in patient 10005817's last stool test conducted?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM `observations` WHERE patient_id = 10005817 AND `date` = (SELECT MAX(`date`) FROM `observations` WHERE patient_id = 10005817) AND `type` = 'stool test' AND `observation` LIKE '%organism%'
a5d91ebb2b0d935b9c493f9f,"In 2100, has patient 10019172 been diagnosed with any illness?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'",,SELECT `Diagnosed` FROM `Patient` WHERE `PatientID` = '10019172' AND `DiagnosedDate` >= '2100-01-01'
273f6bc57bc0f792177dfd04,Has patient 10004733 received a enteral infusion of concentrated nutritional substances treatment since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,"SELECT patient_id, treatment_type, treatment_date, treatment_time, infusion_volume, infusion_time FROM patient_treatments WHERE patient_id = 10004733 AND treatment_type = 'enteral infusion of concentrated nutritional substances' AND treatment_date >= '2100-01-01' AND infusion_volume > 0 AND infusion_time > 0"
02784e491e61842ddb4de275,Has patient 10004235 undergone a laparoscopic robotic assisted procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic robotic assisted procedure' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT EXISTS(SELECT 1 FROM procedure_events WHERE person_id = 10004235 AND (procedure_type = 'Laparoscopic' OR procedure_type = 'Robotic assisted') AND procedure_date >= '2100-01-01') AS has_undergone_procedure_since_2100
177361783d0e88008a827338,Ya do you know if there was a genetic test patient 97330 received?,,,SELECT * FROM genetic_tests WHERE patient_id = 97330
304ffa7e26d4e39086d0933b,What was patient 10001725's minimum value of basophils in 04/2100?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND strftime('%Y-%m',labevents.charttime) = '2100-04'",[{'MIN(labevents.valuenum)': None}],SELECT MIN(basophils) FROM LabResults WHERE patient_id = '10001725' AND lab_date LIKE '04/2100%'
757779a8ac74dd38488f923f,Retrieve the top four most frequent procedures that were delivered to patients within the same hospital visit after they received other endovascular procedures on other vessels.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,Your SQL query here
f8a06b403db41f5348bf90f8,What was the name of the organism found in patient 10021487's first bronchoalveolar lavage microbiological test since 03/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT Microorganisms.name FROM Microorganisms INNER JOIN Bronchoalveolar_lavage ON Microorganisms.id = Bronchoalveolar_lavage.microorganism_id WHERE Bronchoalveolar_lavage.patient_id = 10021487 ORDER BY Bronchoalveolar_lavage.test_date ASC LIMIT 1;
69662f679dde3d8d7bc6490c,Tell me the difference in the respiratory rate value for patient 10007058 second measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","[SELECT MIN(t2.respiratory_rate) - MIN(t1.respiratory_rate) AS ""Difference in respiratory rate"""
6b473d162048ac1a1c32fab8,Could you retrieve the top four diagnoses that have the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT TOP 4 diagnosis, AVG(6_month_mortality_rate) AS average_mortality_rate FROM patient_outcomes GROUP BY diagnosis ORDER BY average_mortality_rate DESC"
b1ea33dff472a7dc8ff3b3ca,Has any organism been found in the last sputum microbiological test of patient 10026255?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM MicrobiologicalTest WHERE PatientID = 10026255 AND TestType = 'Sputum' AND ResultDate = (SELECT MAX(ResultDate) FROM MicrobiologicalTest WHERE PatientID = 10026255 AND TestType = 'Sputum') AND OrganismFound = 'Yes'
486be4b5d2429d76a159f7bb,Can you please elaborate on a ward identification that you can use to admit patient 64292?,,,SELECT ward_name FROM patient_admissions WHERE patient_id = 64292
f907fb44dd458e21bcac102c,"What are the top five most common diagnoses that patients were diagnosed with during the same month after receiving bypass coronary artery, one artery from left internal mammary, open approach's this year?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT diagnosis_code, diagnosis_description, COUNT(*) AS frequency FROM patient_records WHERE procedure_code = 'bypass coronary artery, one artery from left internal mammary, open approach' AND diagnosis_date BETWEEN DATE_FORMAT(NOW(), '%Y-%m-01') AND LAST_DAY(NOW()) GROUP BY diagnosis_code, diagnosis_description ORDER BY frequency DESC LIMIT 5;"
99dc14e34af5f8b1b714560f,"Since 2100, how many patients received arteriography of femoral and other lower extremity arteries within 2 months after being diagnosed with other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,SELECT COUNT(*) FROM medical_records WHERE diagnosis_date >= '2100-01-01' AND procedure_type = 'arteriography' AND body_part = 'femoral and other lower extremity arteries' AND procedure_date <= diagnosis_date + INTERVAL '2 months' AND cause_of_abnormal_reaction = 'other specified procedures' AND misadventure_not_mentioned = TRUE;
32f8fa73cf7949fc25194b91,What was the last input time of patient 10018328 since 03/08/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-08' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2154-05-02 11:12:00'}],SELECT MAX(input_time) AS last_input_time FROM inputevents_mv WHERE subject_id = 10018328 AND input_time >= '03-08-2100'
cbb2aecba43342d92debc795,What is the dosage of an opioid given to patient 21110?,,,"SELECT opioid, dosage FROM Patient_Medications WHERE patient_id = 21110 AND opioid_class = 'opioid'"
b789cd80cfb8838ab901d4a4,Has patient 10007795 been given any sort of diagnosis?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ),[{'COUNT(*)>0': 1}],select distinct(patientID) from diagnosis where patientID = '10007795'
416848aeaf8b172ffb8fe4fb,What are the four most frequently performed treatments for patients in their 30s throughout this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT TreatmentName, COUNT(*) as Frequency FROM patient_records WHERE Age BETWEEN 30 AND 39 AND YEAR(TreatmentDate) = YEAR(CURDATE()) GROUP BY TreatmentName ORDER BY Frequency DESC LIMIT 4"
5190a9c7556f440558510c86,What new medications were added in the prescription of patient 10039831 today versus those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL Query Here
fb3d9d6acc0abd876c53799f,What was the minimum value of phosphate for patient 10020740 in 06/this year?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06'",[{'MIN(labevents.valuenum)': None}],"SELECT MIN(phosphate) FROM lab_results WHERE patient_id = '10020740' AND date_part('month', test_date) = 6 AND date_part('year', test_date) = date_part('year', CURRENT_DATE);"
59db7aeb6bea824b6c800d5e,"When was the first time patient 10004733, on this month/25, had the minimum heart rate?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '25' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",[],"select * from data where patient_id=10004733 and date=""this month/25"" order by heart_rate limit 1;"
99266f3b67eb6112916a4b55,Tell me the total volume of input that patient 10021487 was given since 12/14/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-14'",[{'SUM(inputevents.totalamount)': 169730.0}],SELECT SUM(input_volume) FROM patient_inputs WHERE patient_id = 10021487 AND input_date >= '12/14/2100'
c32cd76c5b0aa08c81251752,How many mupirocin nasal ointment 2% prescriptions took place in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'mupirocin nasal ointment 2%' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) AS PrescriptionCount FROM prescriptions WHERE product_name = 'mupirocin nasal ointment 2%' AND prescription_date BETWEEN '2100-01-01' AND '2100-12-31'
27672ae2ddb12a394c90cad6,Get me the top three most frequent medications that patients were prescribed with within the same month after being diagnosed with traumatic shock since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic shock' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"[SELECT MEDICATION_NAME, COUNT(*) AS COUNT, MONTH(STARTDATE) AS MONTH, YEAR(STARTDATE) AS YEAR FROM TREATMENT"
283bf444d3fe0d8412a24dc1,What was the name of the drug that was last prescribed for patient 10026255 since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Lorazepam'}],SELECT Name FROM Prescription WHERE PatientID=10026255 AND Date=(SELECT MAX(Date) FROM Prescription WHERE PatientID=10026255 AND Date>='05/2100')
aa3736eecab5271da4440d63,Calculate the number of patients discharged from the hospital in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) as Number_of_Patients_Discharged from hospital_records where discharge_date like '2100%';
5272430cbc48927e9597669b,"On 07/26/this year, when did patient 10016742 receive an input for the first time?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-26' ORDER BY inputevents.starttime ASC LIMIT 1",[],select min(date) from inputevents_mv where itemid=221 and patientid=10016742 and chartdate='07/26/2019'
11c93be39a2819fec36e2a6b,Does patient 65759 have a record of hypotension nec in his / her family?,,,SELECT EXISTS (SELECT 1 FROM family_medical_history WHERE patient_id = 65759 AND condition = 'hypotension nec') AS has_hypotension_nec
3a3ab651adc4530ed40be652,"What is the average total cost of the hospital, which includes medicines called dronabinol?",SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dronabinol' ) GROUP BY cost.hadm_id ) AS T1,,select avg(total_cost) from hospital where medicines like '%dronabinol%'
5d83b1d1c458bcc64023c23e,Can you provide the maximum monthly number of patients diagnosed with gas pain?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gas pain' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,SELECT MAX(NumberOfPatients) FROM MonthlyDiagnoses WHERE DiagnosisCode = 'GP' GROUP BY Month ORDER BY Month
4f40841ba5cc7ce273305a27,What was the total metoprolol succinate xl dose prescribed for patient 10039997 in 09/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND prescriptions.drug = 'metoprolol succinate xl' AND strftime('%Y-%m',prescriptions.starttime) = '2100-09'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(metoprolol_succinate_xl_dose) AS total_dose FROM prescription_records WHERE patient_id = 10039997 AND date_prescribed BETWEEN '2100-09-01' AND '2100-09-30';
6c5ae1376c35e10f1ed23a4e,What were some of the five common specimen tests given since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]",SELECT SpecimenTestName FROM SpecimenTests WHERE Year >= 2100 GROUP BY SpecimenTestName ORDER BY COUNT(*) DESC LIMIT 5
bd35ad803e2438c6ada8a6b8,Calculate the length of patient 10025612's first stay in the ICU in days.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 5.229965277016163}]","SELECT DATEDIFF(day, MIN(ADMITTIME), MIN(DISCHTIME)) as LengthOfStay FROM icustays WHERE SUBJECT_ID = '10025612' AND ICU_STAY_ID = (SELECT MIN(ICUSTAY_ID) FROM icustays WHERE SUBJECT_ID = '10025612')"
6d461d83bedc6045d8cf7019,Retrieve the top three most frequent diagnoses of patients with age in their 30s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT Diagnosis, COUNT(Diagnosis) as Frequency FROM patient_records WHERE YEAR(AgeAtDiagnosis) BETWEEN 2030 AND 2039 GROUP BY Diagnosis ORDER BY Frequency DESC LIMIT 3;"
ee666395a082d03bb08f340b,What number of patients stayed in coronary care unit (ccu) in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'coronary care unit (ccu)' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(*) FROM admissions WHERE ccu_admission = 1 AND YEAR(admission_date) = 2100
5767b253bcb5c54fa1aaaadc,Tell me the top five most commonly prescribed medications.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]","SELECT TOP 5 medication_name, COUNT(*) AS prescription_count FROM prescriptions GROUP BY medication_name ORDER BY prescription_count DESC"
2eb0abd516a6a45b4329852b,Has patient 10005909 been diagnosed with any diseases since 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'",,SELECT disease FROM diagnoses WHERE patient_id = '10005909' AND diagnosis_date > '2100-01-01'
f42f69255942463a3df596bb,What was the name of the output that patient 10038999 had last since 05/19/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-19' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],select top 1 name from output join encounter on output.encounter_id = encounter.encounter_id where encounter.patient_id = '10038999' and output_date > '05/19/2100' order by output_date desc
871e1ec7efc82f4a5c9d293c,"Are patient 10018081's sodium, urine levels second measured on the current hospital visit less than the levels first measured on the current hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, urine' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN (SELECT Sodium_Level FROM Patient_Visit_Tests WHERE Patient_ID='10018081' AND Test_Type='Urine' AND Measurement_Sequence=2 ORDER BY Test_Date DESC LIMIT 1) < (SELECT Sodium_Level FROM Patient_Visit_Tests WHERE Patient_ID='10018081' AND Test_Type='Urine' AND Measurement_Sequence=1 ORDER BY Test_Date DESC LIMIT 1) THEN 'Yes' ELSE 'No' END AS Sodium_Level_Change;
ab607c4930656aed65054027,Has magnesium sulfate (bolus) been administrated to patient 10005909 since 03/02/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-02'",[{'COUNT(*)>0': 0}],select * from bolus where drug_name = 'magnesium sulfate' and patient_id = '10005909' and administration_date >= '03/02/2100'
58c7b81fff91803d70fcd674,What should i do following the coronar arteriogr-2 cath procedure?,,,SELECT instructions FROM post_procedure_guidelines WHERE procedure_name = 'coronar arteriogr-2 cath'
c9981e6cc2c40b04592f3206,Which medication was patient 10009035 prescribed within 2 days following the extracorporeal circulation auxiliary to open heart surgery procedure in 05/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,SELECT medication FROM prescriptions WHERE patient_id = '10009035' AND prescription_date BETWEEN (SELECT procedure_date FROM surgeries WHERE patient_id = '10009035' AND procedure_type = 'extracorporeal circulation auxiliary to open heart surgery' AND YEAR(procedure_date) = YEAR(CURRENT_DATE()) AND MONTH(procedure_date) = 5) + INTERVAL 1 DAY AND (SELECT procedure_date FROM surgeries WHERE patient_id = '10009035' AND procedure_type = 'extracorporeal circulation auxiliary to open heart surgery' AND YEAR(procedure_date) = YEAR(CURRENT_DATE()) AND MONTH(procedure_date) = 5) + INTERVAL 2 DAY
669a0b2733d0accec1a73720,What is the recorded sex of patient 10015931?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10015931,[{'gender': 'M'}],SELECT Sex FROM patient WHERE PatientID = 10015931;
34f825ce946e62cf44c7f3f5,"How many days have passed since patient 10004733 had the last cholesterol, total lab test on their current hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"select datediff(day, max(chem_lab_result.collected), current_date) from chart_visit, chem_lab_result where chart_visit.id=10004733 and chart_visit.id = chem_lab_result.chart_id and chem_lab_result.lab_name = 'Cholesterol, total' and chem_lab_result.lab_result_status = 'Final' and chem_lab_result.result_date between chart_visit.start_date and chart_visit.end_date and chem_lab_result.value is not null and chem_lab_result.unit = 'mg/dL' and chart_visit.end_date is null"
1efc0b4233b41debd5e85794,What is the number of ICU visits for patient 10031404 since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}],SELECT COUNT(*) AS icu_visits FROM icu_admissions WHERE patient_id = 10031404 AND admission_date >= NOW() - INTERVAL '1 year';
bfa8588d08b6cab7568a7c34,When did patient 10021118 first take the microbiology test since 11/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-11' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2161-11-15 21:45:00'}],SELECT MIN(date) FROM microbiology WHERE patientid='10021118' AND date>'11/2100'
a6e9aa314afc2689dfc084db,Tell me the three most frequent medical diagnoses throughout this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as frequency FROM medical_records WHERE YEAR(record_date) = YEAR(CURDATE()) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3"
87278f47491e99c15504a52a,"How many times was a insertion of infusion device into superior vena cava, percutaneous approach procedure conducted since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into superior vena cava, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,"select count(*) as NumberOfTimes from procedureevent where procedurecode in (select procedurecode from procedurecode where procedurename like 'Insertion of infusion device into superior vena cava, percutaneous approach%') and startts >= '2100-01-01 00:00:00' and endts < '2101-01-01 00:00:00'"
1938082694abfabf0da88e32,What is the reimbursement standard for the genetic and chromosome tests?,,,SELECT reimbursement_standard FROM healthcare_financing WHERE test_category='genetic and chromosome tests'
44962ace42f808407fa6647a,What was the first lipase lab value for patient 10019172 in 10/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT MIN(lab_value) AS first_lipase_value FROM LabResults WHERE patient_id = '10019172' AND test_name = 'lipase' AND YEAR(test_date) = YEAR(CURDATE()) AND MONTH(test_date) = 10 ORDER BY test_date ASC LIMIT 1;
5869a0526721f0fc5641901e,What is the name of a procedure patient 10007795 underwent two or more times since 14 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-14 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,SQL query here
519ec63fd6ee4ba4f86c8048,Can you tell me when patient 10007928 had their first blood culture microbiology test in 04/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],select date from microbiology_blood_culture where patient_id = 10007928 and test_date between '04/01/2100' and '04/30/2100' order by date asc limit 1
f6014eac249a07ee280d9634,What was the name of the specimen test which patient 10019777 has last received in their last hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'spec_type_desc': 'STOOL'}],SELECT DISTINCT test_name FROM specimen_test WHERE patient_id = 10019777 ORDER BY date DESC LIMIT 1
f3e47e3f679e8381a5c4a2b6,Tell me all the prescriptions that patient 10539 received in the other department.,,,SELECT * FROM Prescriptions WHERE patient_id = 10539 AND department != 'current_department'
74be377366123df29a790c8c,How many patients received esophagogastroduodenoscopy [egd] with closed biopsy treatment within 2 months after being diagnosed with acute posthemorrhagic anemia in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute posthemorrhagic anemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'esophagogastroduodenoscopy [egd] with closed biopsy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,<|endofstatement|>
df2081f769425d13a4ff054f,Count the number of current patients whose ages fall within the 40s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,,SELECT COUNT(*) FROM patients WHERE age >= 40 AND age < 50 AND status = 'current'
d199f2338fccc1376de62441,How much will it cost me to get other repair of vessel done?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair of vessel' ) ),,SELECT SUM(cost) FROM repair WHERE type='other' AND vessel='vessel_name'
7e0d52249e45d956b457e7f7,Can you report the last arterial blood pressure mean for patient 10031757 during the first ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],"SELECT MAX(mean_bp) AS last_mean_bp FROM arterial_bp WHERE patient_id = 10031757 AND stay_id IN (SELECT MIN(stay_id) FROM icu_stays WHERE patient_id = 10031757) ORDER BY date DESC, time DESC LIMIT 1"
60fa5859e5561740ec7d024d,What is dr. turner's outpatient schedule today?,,,SELECT appointment_time FROM schedules WHERE doctor_id = (SELECT id FROM doctors WHERE name = 'Dr. Turner') AND appointment_date = CURRENT_DATE AND appointment_type = 'Outpatient'
2f795d71a3f4c1f8e411ce55,Is the anion gap level of patient 10008454 second measured on the first hospital visit greater than the first level measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",select count(*) from lab_results where patient_id = '10008454' and visit_number = 1 and result_type = 'anion_gap' and (result_value > (select result_value from lab_results where patient_id = '10008454' and visit_number = 1 and result_type = 'anion_gap' and result_order = 1) and result_order = 2)
a76ac4f3407058b120923fca,What was the first drug that was prescribed to patient 10021938 via the pr route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime ASC LIMIT 1,[],"SELECT `Drug`, `Date of Order` FROM `drug_orders` WHERE `Patient ID` = '10021938' AND `Route` = 'pr' ORDER BY `Date of Order` ASC LIMIT 1"
fc4da0d8a328e76fa47d035f,What percentile is the value of 32.0 in asparate aminotransferase (ast) among patients of the same age as patient 10039997 on the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 32.0",,SELECT PERCENT_RANK() OVER (ORDER BY ast) AS percentile_rank FROM patient_data WHERE visit_id = (SELECT visit_id FROM patient_data WHERE patient_id = 10039997 ORDER BY visit_date ASC LIMIT 1) AND age = (SELECT age FROM patient_data WHERE patient_id = 10039997 AND visit_id = (SELECT visit_id FROM patient_data WHERE patient_id = 10039997 ORDER BY visit_date ASC LIMIT 1)) AND ast < 32.0 LIMIT 1
cc2d4eae2f2d008d9c2c9518,How many patients from the 40s age group are currently admitted?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,,SELECT COUNT(*) FROM patient WHERE age BETWEEN 40 AND 49 AND admission_status = 'admitted'
358fa6004175aca2698df8bb,How many operating rooms are currently available?,,,SELECT COUNT(*) AS AvailableOperatingRooms FROM rooms WHERE status = 'available'
2bc23738094540fb7b4e565e,Can you provide me the monthly maximum amount of dextrose 50% that patient 10020944 received during the first hospital visit?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 50%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",[],SELECT MAX(dosage_amount) AS max_dextrose_amount FROM [physionet-data.mimiciii_clinical.icustay_detail
0831dece04ef846871b1b934,What was the diagnosis for patient 10003046 the first time in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",,select top 1 diagnosis from t_diagnosis where patient_id=10003046 and diagnosis_date between '2100-01-01' and '2100-12-31' order by diagnosis_date
0bc993a64b3b18610af5e89f,Has patient 10027445 visited the hospital throughout this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10027445 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SQL Query Here
95475af06738ffe0fb4f1c65,What was the first measurement of heart rate in patient 10031757's body on their last ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],"SELECT TOP 1 measurement_date, value AS heart_rate FROM measurement WHERE patient_id = '10031757' AND measurement_type = 'HeartRate' AND stay_id = (SELECT MAX(stay_id) FROM stay WHERE patient_id = '10031757') ORDER BY measurement_date ASC"
d064155c1b69cfe53b508d1e,Is the value of o2 flow last measured on the last hospital visit of patient 10015931 less than its value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 flow' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 flow' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 flow' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'o2 flow' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN MIN(o2flow) > MAX(o2flow) THEN 'Yes' ELSE 'No' END AS is_o2flow_decreased FROM (SELECT o2flow FROM icustays WHERE subject_id = 10015931 AND hadm_id = (SELECT hadm_id FROM icustays WHERE subject_id = 10015931 ORDER BY stay_endtime DESC LIMIT 1) ORDER BY charttime) AS last_visit_o2flow
b8e9f61b8a98b3f23dc93f99,When was patient 10024043's first discharge from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10024043 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2117-02-04 11:53:00'}],SELECT MIN(DischargeDate) AS FirstDischargeDate FROM hospital_records WHERE PatientID = 10024043
473b5484bdbc4e254b426c4c,"For patients diagnosed with hemorrhage of rectum and anus throughout this year, what are the top five most recurrent treatments within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage of rectum and anus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 Treatment, COUNT(*) AS TreatmentFrequency FROM PatientRecords WHERE Diagnosis = 'hemorrhage of rectum and anus' AND AdmissionDate BETWEEN DATEADD(year, DATEDIFF(year, 0, GETDATE()), 0) AND GETDATE() AND DischargeDate <= DATEADD(month, 2, AdmissionDate) GROUP BY Treatment ORDER BY TreatmentFrequency DESC"
6c8ad401188a69f144f026f6,What was the total number of patients on pacu since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL query to retrieve the total number of patients on pacu since 1 year ago
de050e3cfdd8c8ef07cdf7bc,What are the five most common diagnoses of patients in their 60 or above since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(diagnosis) AS count FROM PatientRecords WHERE age >= 60 AND YEAR(admission_date) >= 2100 GROUP BY diagnosis ORDER BY count DESC LIMIT 5"
b4cddff0a459aeb457378e32,Gather the total number of times patient 10007795 visited the hospital.,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10007795,[{'COUNT( DISTINCT admissions.hadm_id )': 5}],SELECT COUNT(*) AS total_visits FROM hospital_visits WHERE patient_id = 10007795;
826d5f58864744f66f50a9f1,Is patient 44848 subject to a test for covid-19?,,,SELECT * FROM patient_tests WHERE patient_id = 44848 AND test_name = 'COVID-19';
1ec2b4e6ddcdc9a62d1209df,What was the total volume of drainage bag that patient 10021487 had on this month/16?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'drainage bag' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '16'",[{'SUM(outputevents.value)': None}],SELECT SUM(drainage_volume) FROM patient_data WHERE patient_id = 10021487 AND date BETWEEN '2023-09-01' AND '2023-09-16'
cbcc848bf46b8605d7a0735d,What is patient 10027445's sex?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10027445,[{'gender': 'F'}],SELECT sex FROM patient WHERE patient_id = 10027445
e54938671b05e5c6ac687af2,What were the top three most often performed treatments for patients in their 30s during this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"[SELECT treatment_name, COUNT(*) AS treatment_count"
0e38c574dc705f0c26a2aa69,"On the first hospital encounter, what amount of bisacodyl was prescribed to patient 10025463?",SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'bisacodyl',[{'SUM(prescriptions.dose_val_rx)': None}],select prescription_amount from prescriptions where patient_id = '10025463' and drug_name = 'bisacodyl' and encounter_number = 1;
333d0beec3e1c8b7b38dc15e,"Has patient 10021487 been given a test on bilirubin, total, body fluid in 2100?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, body fluid' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',labevents.charttime) = '2100'",[{'COUNT(*)>0': 0}],"SELECT * FROM lab_results WHERE patient_id = '10021487' AND test_name = 'bilirubin, total, body fluid' AND test_year = 2100"
c07d03f18cb3b7eb6a97c463,Tell me the amount of foley patient 10039831 had since 266 days ago.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-266 day')",[{'SUM(outputevents.value)': None}],"SELECT SUM(amount) AS total_amount FROM foley WHERE patient_id = 10039831 AND date >= DATE_SUB(CURDATE(), INTERVAL 266 DAY);"
6e294cbd69afc45c3375e07d,Has patient 10005909 had any diagnoses?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ),[{'COUNT(*)>0': 1}],SELECT COUNT(DISTINCT DiagnosisID) FROM Diagnosis WHERE PatientID = 10005909
95a2c61973863427b73ef937,What is the price for the drug levetiracetam?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'levetiracetam' ),,SELECT price FROM drugs WHERE name = 'levetiracetam'
5330e3cf45faedb3477005e6,Can you provide the total number of outputs patient 10027445 had since 08/13/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-08-13'",[{'SUM(outputevents.value)': 13561.0}],SELECT COUNT(*) AS TotalOutputs FROM patient_output_records WHERE patient_id = 10027445 AND output_date >= '2100-08-13'
189fc63254a11c6dfeb8fba5,Calculate the number of patients diagnosed with alkalosis.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alkalosis' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM diagnosis WHERE condition = 'alkalosis'
a39e1668093aab21fc2f126e,Show me patient 10029484's total volume of output since 10/23/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-23'",[{'SUM(outputevents.value)': 725.0}],SELECT SUM(volume) AS total_volume FROM patient_output WHERE patient_id = 10029484 AND output_date >= '2100-10-23'
d7c14bbe3a56d6a3b48cc26d,When did patient 94757 last have medication that should be taken regularly?,,,AND `Date` <= CURRENT_DATE
0f2f3ef0fa1e36d951c5a42f,What was patient 10007818's weight the last time it was measured since 8 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-8 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT weight FROM measurements WHERE patient_id = 10007818 AND measurement_date > (CURRENT_DATE - INTERVAL '8 months') ORDER BY measurement_date DESC LIMIT 1
bef2c1e139eac11ba6f699ee,Do you know the minimum albumin value of patient 10002495 on the first hospital encounter?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin' ),[{'MIN(labevents.valuenum)': None}],SELECT MIN(Albumin) AS MinimumAlbuminValue FROM lab_results WHERE PatientID = '10002495' AND EncounterNumber = 1
f14d33079f86bdf9032e4b84,What is the recently prescribed medication for patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL Query
05bb819666668fc43bad2666,When did the last discharge from the hospital happen for patient 10023239?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10023239 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(discharge_date) FROM patient_records WHERE patient_id = 10023239
d5ae1b4f859d19123f8193a4,Get me the top five most frequent diagnoses for patients of age 30s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,
74d3878c8b5bd8025d7a304d,When was the last time that patient 10018081 had the minimum value of diastolic blood pressure on 12/29/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],SELECT MAX(Measurement_Date) AS Last_Min_Diastolic_BP FROM Lab WHERE Subject_ID = 10018081 AND Measurement_Date LIKE '2023-12-29%' AND Diastolic_BP = (SELECT MIN(Diastolic_BP) FROM Lab WHERE Subject_ID = 10018081 AND Measurement_Date LIKE '2023-12-29%')
c2498660106f0841540500d3,"Give me the top four most frequent procedures that patients were given in the same hospital encounter after receiving reposition left mandible with external fixation device, percutaneous approach.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 Procedure1, COUNT(*) AS Frequency FROM Encounters JOIN Procedures ON Encounters.EncounterID = Procedures.EncounterID WHERE Encounters.PreviousProcedure = 'Reposition left mandible with external fixation device, percutaneous approach' GROUP BY Procedure1 ORDER BY Frequency DESC"
17940d37a58d13908074e9d2,How often did patient 10007795 go to the ICU in 2100?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y',icustays.intime) = '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 0}],SELECT COUNT(*) FROM icu_stays WHERE patient_id = 10007795 AND admission_year = 2100;
6316365253c771062657103d,"Show the number of patients who underwent introduction of other therapeutic substance into heart, open approach.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],Number of Patients
2ed30506921aece493589863,How much does a procedure known as partial hepatectomy cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) ),,SELECT AVG(cost) AS average_cost FROM medical_procedures WHERE procedure_name = 'partial hepatectomy'
c625c297bb0d8ff6dc0c20fa,"What was the drug that patient 10022017 prescribed for within 2 days after the procedure of excision of left saphenous vein, percutaneous endoscopic approach on their last hospital encounter?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT medication_name FROM prescriptions WHERE patient_id = '10022017' AND prescription_date BETWEEN (SELECT MAX(encounter_date) - INTERVAL '2 days' FROM encounters WHERE patient_id = '10022017' AND procedure_code = 'Excision of left saphenous vein, percutaneous endoscopic') AND (SELECT MAX(encounter_date) FROM encounters WHERE patient_id = '10022017' AND procedure_code = 'Excision of left saphenous vein, percutaneous endoscopic')"
ec028c849e3b43c508834d3c,When was patient 10027445 discharged from the hospital for the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],select max(date_of_discharge) from discharge_records where patient_id = '10027445';
ef2cdb36472c00261392f95a,"What is the average total hospital cost which involves exposure to other specified factors, initial encounter since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'exposure to other specified factors, initial encounter' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_hospital_cost) FROM inpatient WHERE DRGDefinition LIKE '%Exposure to other specified factors%' AND encounter_type='initial' AND date_of_admission >= '2100-01-01'
3fad6d968be4660d18e4a33a,"During their last ICU visit, what was patient 10007928's last heart rate?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],SQL Query
a4b29cbfbb96679f14e6eac0,How many patients were diagnosed with unspecified essential hypertension during the same hospital visit after the previous diagnosis with aortic valve disorders?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'aortic valve disorders' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,SELECT COUNT(DISTINCT p.patient_id) FROM patients p INNER JOIN diagnoses d1 ON p.patient_id = d1.patient_id AND d1.condition = 'aortic valve disorders' INNER JOIN diagnoses d2 ON p.patient_id = d2.patient_id AND d2.condition = 'unspecified essential hypertension' AND d2.visit_date = d1.visit_date
87d7d4cf52e2d839fed96143,Can you tell me which were the top three most frequently tested specimens since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT specimen_name, COUNT(*) as test_count FROM laboratory_tests WHERE test_date >= '2100-01-01' GROUP BY specimen_name ORDER BY test_count DESC LIMIT 3"
6277e9a8851e3c1a4ad9cd6e,Please list out the monthly maximum weight of patient 10004235 since 1 year ago.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"select month, year, max(weight) from patient_records where patient_id = '10004235' and date >= date_sub(curdate(), interval 1 year) group by month, year order by year, month"
5eed4e1b791b78ba28273ed6,"How many days have elapsed since the first time in the current hospital visit that patient 10021487 was diagnosed with closed dislocation, multiple cervical vertebrae?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed dislocation, multiple cervical vertebrae' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,SQL query here
81aaa658176632cb934fc8b2,Has patient 10012853 been given a diagnosis?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ),[{'COUNT(*)>0': 1}],Select 1 from diagnosis where person_id=10012853 limit 1
cb4e4e55e551ad021bb55fc0,When was the last time that patient 10015931 has had the minimum SaO2 on this month/08?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '08' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],[SELECT MAX(VisitDate) AS LastMinimumSaO2Date FROM (
3f525ce33fe40722b1b64deb,How many lidocaine jelly 2% (urojet) prescriptions took place in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT count(*) FROM prescriptions WHERE drug_name = 'Lidocaine jelly 2%' AND drug_brand = 'Urojet' AND year(prescription_date) = 2100
f4cfc4a663fd49aeace78486,Are there any changes in the prescribed drugs of patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"[SELECT pd.patientid, pd.drugid, pd.dosage, pd.adddate"
f5024826f56df8252bfc76ad,Tally up the number of patients who received a ck-mb index lab test since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ck-mb index' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) AS patient_count FROM lab_tests WHERE test_name = 'ck-mb index' AND test_date > (CURRENT_DATE - INTERVAL '1 year')
d559f760db83349c7ce1a73b,"What were the five most frequently ordered procedures for patients who had also received extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic within the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 ProcedureDescription, COUNT(*) AS OrderCount FROM Procedures p1 WHERE EXISTS (SELECT 1 FROM Procedures p2 WHERE p2.PatientID = p1.PatientID AND p2.ProcedureCode = 'EXTIRPATION_LEFT_LOBE_BRONCHUS' AND p2.VisitDate = p1.VisitDate) AND p1.VisitDate BETWEEN '2021-01-01' AND '2021-12-31' AND p1.ProcedureCode LIKE 'ENDOSCOPIC%' GROUP BY p1.ProcedureDescription ORDER BY OrderCount DESC"
4dffe3f7f7770e47d3e5fdc8,Tell me patient 10029291's maximum value of mean blood pressure on the last ICU visit.,SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ),[{'MAX(chartevents.valuenum)': None}],SQL Query
8f20718e8f7720e51c34a9b9,What are the four diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,SQL Query Here
535fa7171aca46e1fa19b72d,What was the name of the medication that was first prescribed to patient 10003046?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Iso-Osmotic Dextrose'}],SELECT name FROM medications WHERE patient_id = 10003046 ORDER BY prescription_date ASC LIMIT 1;
f0ed8bc2f755ef37eb17af6e,Did patient 10021938 receive any surgery on their last hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],[SELECT encounter_id
c4342f86b05d451aef82a90f,When and where are the rounds and procedures of dr. sullivan?,,,"SELECT round, procedure, date, time, location FROM dr_sullivan_appointments WHERE doctor = 'dr. sullivan'"
6fc2d38e2e0de21eec21ab72,Count the number of patients that were discharged in the last year from the hospital.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM discharges WHERE discharge_date >= DATE_SUB(NOW(), INTERVAL 1 YEAR)"
b669eb9d598ff80ab9e5f8e6,Has patient 10002495 had any surgeries in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,SELECT EXISTS (SELECT 1 FROM surgeries WHERE patient_id = 10002495 AND year = 2100)
5d54f26da17bc7fdbfc404d3,What are the five frequently prescribed medications for patients diagnosed with unspecified condition of brain previously within the same month?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified condition of brain' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,SQL Query Here
474e88f3f2489ae5e866536c,What was the last weight of patient 10039831 since 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT weight FROM patient_measurements WHERE patient_id = 10039831 AND date > '03-2100' ORDER BY date DESC LIMIT 1
1591c0dee928de6151cbaf4a,When was the first time the systolic blood pressure of patient 10018081 was measured since 11/27/2100 at less than 113.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 113.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-11-27' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(measurement_date) FROM blood_pressure_measurements WHERE patient_id = '10018081' AND measurement_date > '2100-11-27' AND systolic < 113.0;
3f5ac405fb5c105f76ea0b91,What was the output that patient 10004235 first had during the first ICU stay?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 ),[{'label': 'Foley'}],"SELECT TOP 1 Output FROM ICU_Output WHERE PatientID = 10004235 ORDER BY AdmissionDate, TimeOfOutput"
09315d12007c47ae3fb400b6,What drug was prescribed to patient 10005817 for the last time since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'HYDROmorphone (Dilaudid)'}],SELECT drug_name FROM prescriptions WHERE patient_id = 10005817 AND prescription_date = (SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = 10005817 AND prescription_date >= '2100-12-01')
588567d3a7f9d7e575cf5435,What was the last arterial blood pressure mean value that patient 10022017 had on 10/03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-03' ORDER BY chartevents.charttime DESC LIMIT 1",[],"select top 1 a.pmean as arterial_bp_mean from hpoa_arterial_blood_pressure a join hpoa_admission b on a.hospital_no = b.hospital_no and a.admission_no = b.admission_no where a.hospital_no = '10022017' and a.entry_date = '10/03/2100' order by a.entry_date desc, a.entry_time desc"
18b181c1e5e0cb0999cf255c,"In total, what was the input amount of gt flush that patient 10038933 received in their last ICU stay?",SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],select sum(gtflush_amt) as total_gtflush_amount from icustay_detail where icustay_detail.subject_id=10038933 order by icustay_detail.intime desc limit 1
cb2de03e599b89ef00694c72,What was the name of the specimen that patient 10016150 received for the last time since 01/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'URINE'}],SELECT specimen_name FROM patient_specimen_records WHERE patient_id = 10016150 AND date_received >= '01/2100' ORDER BY date_received DESC LIMIT 1
f8d0aedd069c1450d7d6264f,What was the name of the drug that was prescribed last to patient 10019385 since 19 months ago?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-19 month') ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Nitroglycerin SL'}],"SELECT TOP 1 drug_name FROM prescriptions WHERE patient_id = 10019385 AND prescription_date >= DATEADD(MONTH, -19, GETDATE()) ORDER BY prescription_date DESC"
3fc571e83a604003d6461674,Calculate the number of patients who underwent a laboratory test for hematocrit since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patients.id) FROM laboratory_tests JOIN patients ON laboratory_tests.patient_id = patients.id WHERE laboratory_tests.test_name = 'hematocrit' AND laboratory_tests.test_date >= CURRENT_DATE - INTERVAL '1 year' AND laboratory_tests.status = 'completed';
09f8601bdd6e63b61b06c516,Calculate the length in days of patient 10016810's first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.488912038039416}]","[select max(length_of_stay_in_days) from (select case when hosp_adm_dt < first_icu_adm_dt then first_icu_adm_dt else hosp_adm_dt end as start_date, hosp_disch_dt as end_date, extract(epoch from (hosp_disch_dt - (case when hosp_adm_dt < first_icu_adm_dt then first_icu_adm_dt else hosp_adm_dt end))) / 86400 as length_of_stay_in_days from (select patient_num, hosp_adm_dt, first_icu_adm_dt, hosp_disch_dt from (select patient_num, min(hosp_adm_dt) as hosp_adm_dt from icu_data where patient_num = 10016810 group by patient_num) a join (select patient_num, min(icu_adm_dt) as first_icu_adm_dt from icu_data where patient_num = 10016810 group by patient_num) b on a.patient_num = b.patient_num join (select patient_num, hosp_disch_dt from icu_data where patient_num = 10016810) c on a.patient_num = c.patient_num) t where (hosp_disch_dt - (case when hosp_adm_dt < first_ic"
09b1b086d491d385b6744dd6,Give me the total amount of output since 12/25/2100 for patient 10004733.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-25'",[{'SUM(outputevents.value)': 17410.0}],SELECT SUM(amount) AS total_output FROM patient_output WHERE patient_id = '10004733' AND output_date >= '12/25/2100'
33bb875daecee7aae0a79d8a,Can you tell me the top four most common treatments for patients in their 40s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT treatment, COUNT(*) AS frequency FROM PatientRecords WHERE year = 2100 AND age BETWEEN 40 AND 49 GROUP BY treatment ORDER BY frequency DESC LIMIT 4;"
61f764dd9a145b1cc50e9c25,What was the first dose of glucagon that patient 10023239 was prescribed on the first hospital stay?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'glucagon' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT TOP 1 [First Dose Prescribed
0821be3636ee8eab640a750b,"Show me the top four most frequent diagnoses that patients were diagnosed with within 2 months after receiving extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic in 2100.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"select diagnosis, count(*) as c from inpatientDisease where primaryProcedureCode = '0VJD04Z' and primaryProcedureDate between primaryDiagnosisDate - interval 2 month and primaryDiagnosisDate and primaryDiagnosisDate >= '21000101' and primaryDiagnosisDate < '21010101' group by diagnosis order by c desc limit 4"
62ce1e3f90c3aa7b3c7ffd03,Can you provide the total number of outputs patient 10011398 had since 12/26/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-26'",[{'SUM(outputevents.value)': 4314.0}],select count(*) from output where patient_id = 10011398 and order_date >= '12/26/2100'
398270a5b400092bfc10afcb,When did patient 10018081 first have the minimum amount of base excess in the current hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],select date from lab where person_id = 10018081 and hospital_visit_id in (select distinct hospital_visit_id from lab where person_id = 10018081 and currentvisit=1) and base_excess = (select min(base_excess) from lab where person_id = 10018081 and hospital_visit_id in (select distinct hospital_visit_id from lab where person_id = 10018081 and currentvisit=1)) order by date asc limit 1;
8b39463fdf4a8b3980e64af0,What is the ward identification of patient 7375 able to be admitted to?,,,SELECT ward_id FROM admissions WHERE patient_id = 7375
821e3fe48e8557a30caa67cf,What is the checklist you should prepare prior to having destruct chest wall les?,,,SELECT Checklist FROM PreProcedure WHERE ProcedureName = 'Destruct Chest Wall Lesions'
13d656d846a740eeb1467267,Give me the top three most common lab tests.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","select lab_test_name, count(*) as test_count from lab_tests group by lab_test_name order by test_count desc limit 3"
8b02463508e571bad82c1b76,What was the first iron value during the first hospital visit for patient 10039708?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'iron' ) ORDER BY labevents.charttime ASC LIMIT 1,[],SELECT first_value(IronValue) FROM (SELECT IronValue FROM LabResults WHERE PatientID = 10039708 AND HospitalVisitID = (SELECT MIN(HospitalVisitID) FROM HospitalVisits WHERE PatientID = 10039708) ORDER BY TestDate ASC) AS FirstVisitIron
c010215bbebd2aff0b853669,Calculate how many patients were in psychiatry in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'psychiatry' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL Query Here
c49e0c36f1c60e8aa2266956,Provide the length in days of the first visit for patient 10021118 in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.4872453697025776}]","SELECT DATEDIFF(MAX(date), MIN(date)) FROM visit_10021118 WHERE visit_10021118.type = 'ICU' GROUP BY visit_10021118.id"
8f9580ef1cb64c4525680b2f,Tell me the length of time in days for patient 10027445's first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.8090046290308237}]",
2fa8b86ac44e632ee829dec6,What total amount of gabapentin was prescribed to patient 10002495?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND prescriptions.drug = 'gabapentin',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(drug_qty) FROM prescriptions WHERE patient_id = 10002495 AND drug_name = 'gabapentin'
67aeef950338b9e353377442,"How many hours has it been since patient 10018081's first urinary tract infection, site not specified diagnosis in their current hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT TIMESTAMPDIFF(HOUR, MIN(EDIPDIAGS.EVNT_DT_TM), CURRENT_TIMESTAMP()) FROM EDIPDIAGS WHERE PAT_ID = '10018081' AND EDIPDIAGS.DIAG_CD = '788.4' AND EDIPDIAGS.ENCNTR_ID = (SELECT DISTINCT(EDIPDIAGS.ENCNTR_ID) FROM EDIPDIAGS WHERE EDIPDIAGS.PAT_ID = '10018081') GROUP BY EDIPDIAGS.ENCNTR_ID"
fb87e4c3918b28e10f458a76,What was patient 10027602's first csf;spinal fluid's microbiology test time during the previous month?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'csf;spinal fluid' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SQL Query
9a022decba9cb56ac65b6689,Has patient 10021487 been given any procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,"select patient_id, procedure_id from procedure where patient_id = '10021487' and start_date >= '2100-01-01' and procedure_id is not null;"
97197e658fa88a996aa97c83,When was the last input of patient 10014729 on 03/06/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-06' ORDER BY inputevents.starttime DESC LIMIT 1",[],SQL Query Here
d1fc20ee02b9ce89df2bb4e6,What was the total dosage of vitamin e prescribed to patient 10020944?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'vitamin e',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(dosage) FROM prescription WHERE drug_name = 'vitamin e' AND patient_id = '10020944';
1914be2bfb5f57050076ba8f,Was patient 10020187 admitted into the emergency room in the previous year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],SELECT AdmissionDate FROM Admissions WHERE PatientID = 10020187 AND AdmissionType = 'Emergency' AND YEAR(AdmissionDate) = YEAR(CURDATE()) - 1
0266d6e5d007484e57bf12d6,What was the name of the drug that was first prescribed to patient 10020944 through the iv drip route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1,[],select distinct medication_name from prescriptions where patient_id = '10020944' and route = 'iv drip' order by prescription_date asc limit 1
7e84feafb736e70b619b4009,Calculate the total volume of input for patient 10029484 since 04/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-12'",[{'SUM(inputevents.totalamount)': 2540.0}],select sum(volume) from inputevents_mv where subject_id=10029484 and date>='04/12/2100'
b57f674a925a484550b4afa9,When did patient 10004422 have the first diastolic blood pressure to be less than 64.0 in the first ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 64.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],SQL Query
346ee07f02d16abcf7f62e9e,What is the white blood cells percentile of 12.1 among patients of the same age as patient 10001217 on their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 12.1",,SELECT `percentile` FROM `lab_results` WHERE `test_name` = 'WHITE BLOOD CELLS' AND `value` = 12.1 AND `patient_id` IN (SELECT `patient_id` FROM `hospital_visits` WHERE `patient_id` = 10001217 AND `visit_date` = (SELECT MAX(`visit_date`) FROM `hospital_visits` WHERE `patient_id` = 10001217)) AND `visit_date` IN (SELECT MAX(`visit_date`) FROM `hospital_visits` WHERE `patient_id` = `lab_results`.`patient_id` AND `test_name` = 'WHITE BLOOD CELLS') AND `patient_age` = (SELECT `age` FROM `hospital_visits` WHERE `patient_id` = 10001217 AND `visit_date` = (SELECT MAX(`visit_date`) FROM `hospital_visits` WHERE `patient_id` = 10001217))
695b3083856ab31c0cd2853e,"How much does a procedure known as occlusion of right femoral artery with intraluminal device, percutaneous approach cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right femoral artery with intraluminal device, percutaneous approach' ) )",,SELECT AVG(Charges) FROM claims WHERE line_item_description LIKE '%occlusion of right femoral artery with intraluminal device%' AND line_item_modifier = 'PERC' AND line_item_code = 'I70.2133'
a3355859e69721c3baf952d0,What percentile is the hematocrit value of 35.4 in the same age group as patient 10008454 on the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 35.4",,SELECT PERCENT_RANK() OVER (ORDER BY hematocrit) AS percentile FROM hospital_visits WHERE patient_id = 10008454 AND age_group = (SELECT age_group FROM hospital_visits WHERE patient_id = 10008454 ORDER BY visit_date DESC LIMIT 1) AND hematocrit <= 35.4
421b9af53a232e69883ca462,How many patients from the 50s age group are currently admitted?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,,SQLQuery
af972afb21a4db1766988356,Total number of patients who had arteriography of other intra-abdominal arteries in the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,"SELECT COUNT(*) AS Total_Patients FROM patient_records WHERE procedure_code = 'arteriography_other_intra_abdominal' AND procedure_date BETWEEN DATEADD(year, -1, GETDATE()) AND GETDATE();"
4fd2779af0fb5ce25434c775,Could you list the top five most common lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","select test_name, count(*) as test_count from lab_results where date >= DATEADD(year, -1, GETDATE()) group by test_name order by test_count desc limit 5"
771257ca5b02630533cafe73,Calculate how many patients were in discharge lounge since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'discharge lounge' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(patient_id) FROM discharge_lounge WHERE timestamp > '22:00:00';
7101ce2540d2798377dc1ae1,When since 07/2100 did patient 10018081 get the last microbiology test?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2134-09-17 06:24:00'}],
6cc10dddb478d438f52a9dfb,What was the specimen test ranked at three that was done most commonly in 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",[],"SELECT TOP 1 test_name FROM (SELECT test_name, COUNT(*) AS frequency FROM specimen_tests WHERE year=2100 GROUP BY test_name ORDER BY frequency DESC, test_name ASC LIMIT 1 OFFSET 2) AS subquery"
e152d27a95ebcc62820b1622,"How many days have passed since the first time patient 10018081 received a lab test of chloride, urine on their current hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"select datediff(current_date(), max(date)) from labevents where itemid in (select itemid from d_labitems where label='Chloride, urine') and subject_id=10018081 and hadm_id= (select max(hadm_id) from admissions where subject_id=10018081)"
5b981e188f8028d8f045d245,"What's the cost of a procedure named repair upper artery, open approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair upper artery, open approach' ) )",,"SELECT cost FROM procedure_costs WHERE procedure_name = 'repair upper artery, open approach' AND approach = 'open'"
1f02c929b05a2d1eae19aa43,What was the last time on 03/31/2100 patient 10021666 had a minimum heart rate?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-31' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],"select max(hr_time) from chartevents where hr_time <= '03/31/2100' and itemid in (211,220277) and hr_time is not null and value > 0 and value != 'Abnormal' and value != 'Chaos' and value != 'Flat' and value != 'NaN' and value != 'Tachycardia' and value != 'Bradycardia' and value != 'Low' and value != 'High' and value != 'Missing' and value != 'Pending' and value != 'NA' and value is not null and patientunitstayid = 10021666"
3b0e6898490e151ff0c9d63d,Calculate the number of patients with other ventral hernia without mention of obstruction or gangrene who were diagnosed.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ventral hernia without mention of obstruction or gangrene' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patient_records WHERE diagnosis LIKE '%other ventral hernia%' AND diagnosis NOT LIKE '%obstruction%' AND diagnosis NOT LIKE '%gangrene%';
df7a774b0aacbddb0a1facfe,In what ways can ciprofloxacin 0.3% ophth soln be ingested?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin 0.3% ophth soln',[],SELECT DISTINCT IngestionRoute FROM (SELECT DISTINCT 'IngestionRoute' FROM ProductIngredients WHERE ProductName = 'Ciprofloxacin 0.3% Ophth Soln' AND IngestionRoute IS NOT NULL) AS Subquery
fdd1695a1c8a50679d56e863,What was the name of the drug that patient 10022017 was first prescribed?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Sodium Chloride 0.9%  Flush'}],"select top 1 d.name from drug d join (select top 1 p.drugid, p.patientid from prescription p where p.patientid = 10022017 order by p.prescriptiondate asc) as pd on d.drugid = pd.drugid"
014255e2a1eb9d957a380379,Have any procedures been carried out on patient 10035185 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,"SELECT procedure_name, procedure_date FROM procedures WHERE patient_id = 10035185 AND procedure_date > '2100-01-01'"
8f125e3b053c0f80a6182cc5,What is the recently prescribed medication for patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"SELECT prescription_name, DATE(prescribed_date) FROM patient_prescriptions WHERE patient_id = 10039831 AND prescribed_date BETWEEN CURRENT_DATE - INTERVAL '2 days' AND CURRENT_DATE ORDER BY prescribed_date DESC LIMIT 1;"
eb1d1c55d70459e5c91b366d,What is the average total cost of the hospital that includes a medicine named trimethoprim since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'trimethoprim' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(totcost) FROM Treatments AS t JOIN Hospitals AS h ON t.hospid = h.hospid WHERE EXISTS (SELECT 1 FROM Prescriptions AS p WHERE p.presid = t.presid AND p.medicine = 'trimethoprim' AND p.year >= 2100)
adfd9a5399c408d1e11a4aa2,What is the reimbursement standard for gene and chromosome testing?,,,SELECT reimbursement_standard FROM testing_standards WHERE test_type = 'gene and chromosome testing';
aee372f28e8cc6e1deeb4d36,What are patient 10021487's changes in mean blood pressure last measured on the last ICU visit compared to the second to last value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT change_in_bp FROM patient_bp_records WHERE patient_id = 10021487 AND visit_number = (SELECT MAX(visit_number) FROM patient_bp_records WHERE patient_id = 10021487) AND record_type = 'last_mean_bp' - (SELECT bp_value FROM patient_bp_records WHERE patient_id = 10021487 AND visit_number = (SELECT MAX(visit_number) FROM patient_bp_records WHERE patient_id = 10021487) AND record_type = 'second_to_last_mean_bp') AS change_in_bp
99768e192fa0360d8a7cae90,How many doses of lidocaine jelly 2% (urojet) have been prescribed to patient 10038081 since 07/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'lidocaine jelly 2% (urojet)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT COUNT(*) FROM prescriptions WHERE drug_name = 'lidocaine jelly 2%' AND patient_id = 10038081 AND date_prescribed >= '07/21/2000'
e447bf35d8f5b5f515e7b40e,What is the minimum daily number of patients diagnosed with closed fracture of dorsal [thoracic] vertebra without mention of spinal cord injury since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of dorsal [thoracic] vertebra without mention of spinal cord injury' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,"select min(patient_count) from (select date, count(distinct patient_id) as patient_count from patient_records where icd_code = 'S22.0' and record_date >= '2100-01-01' group by date) as daily_counts"
e0581975db0c811fc20544d6,Tell me patient 10038933's total multivitamins input amount in their last ICU visit.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'multivitamins' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],
a69b592f91b063a29a0fb688,Did patient 10012853 receive a laboratory test on their first hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) AS lab_test_count FROM laboratory_events WHERE patient_id = 10012853 AND admission_id = (SELECT MIN(admission_id) FROM admission_events WHERE patient_id = 10012853) AND lab_test_result IS NOT NULL
a903f7427fcbfe8c1598e7c7,What was the name of the last specimen test which patient 10027602 has received since 02/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'URINE'}],SELECT specimen_test_name FROM specimen_tests WHERE patient_id = 10027602 AND specimen_test_date >= '02/2100' ORDER BY specimen_test_date DESC LIMIT 1
e328aff459ba450aa7b31950,Provide the total input volume for patient 10029291 since 03/01/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-01'",[{'SUM(inputevents.totalamount)': 76005.0}],SELECT SUM(inputVolume) FROM patientData WHERE patientID = '10029291' AND date >= '03/01/2100';
2a882b413da76b5d3b4d828a,What was the name of the organism discovered in the first abscess test of patient 10007795 in 04/this year?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT organism_name FROM abscess_tests WHERE patient_id = '10007795' AND test_date = (SELECT MAX(test_date) FROM abscess_tests WHERE test_date LIKE '04/%' AND patient_id = '10007795')
57280c52999208a8f3104301,"Since 06/30/2100, what was the yearly maximum dose of dextrose 5% for patient 10026354?","SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-30' GROUP BY strftime('%Y',inputevents.starttime)",[],SELECT MAX(dose) FROM Dose WHERE patient_id = 10026354 AND dose_type = 'dextrose 5%' AND date >= '06/30/2100' GROUP BY YEAR(date) ORDER BY YEAR(date)
92847b18dd8be297f01979a1,How many days have passed since patient 10018081 got his last diagnosis of candidiasis of mouth in this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidiasis of mouth' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,
51f451ef32c9bcc8c27f43e9,How much does patient 10027602 change in weight second measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT p1.`Second measured weight (kg)` - p1.`First measured weight (kg)` AS `Weight change` FROM `patient` p1 WHERE p1.`Patient ID` = '10027602' AND p1.`Hospital visit sequence number` = 1
c3138909fa5b171f0d57fabd,What's the minimum daily number of patients who had hypovolemic shock in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypovolemic shock' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,SELECT MIN(daily_count) FROM patient_data WHERE condition = 'hypovolemic shock' AND year = 2100;
878106bea4b63d355fcf0ef6,Count the number of patients that were discharged from the hospital.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) AS discharged_patient_count FROM patient_records WHERE discharge_date IS NOT NULL;
cdd93c0461e3923a22aa155f,Show me the top three most frequent events that took place since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT event_name, COUNT(*) as event_count FROM events WHERE event_date > NOW() - INTERVAL 1 YEAR GROUP BY event_name ORDER BY event_count DESC LIMIT 3"
94ebd65b4f618bfded23ea2d,"Give me the count of drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic procedures that occurred in the last year.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,[SELECT COUNT(*) AS ProcedureCount
cf5d62cfdfa23393641e93c8,How many days was patient 10038999 in the intensive care unit during their first visit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 8.836469906847924}]","SELECT SUM(DATEDIFF(discharge_date, admission_date) + 1) FROM patient_admissions WHERE patient_id = 10038999 AND admission_type = 'first visit' AND unit_type = 'intensive care unit';"
dc77bd8543dca1e8f57847aa,Inform me about the total amount of patient 10004235's input since 03/21/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-21'",[{'SUM(inputevents.totalamount)': 122382.0}],SELECT SUM(amount) FROM patient_input WHERE patient_id = 10004235 AND input_date >= '03-21-2100'
e27430eb77cfd3fc0183209f,What was the name of the organism found in the last microbiological examination of patient 10001725's urine in their last hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],?
3f384b70bd3be24de7ec5ac2,What was the admission type for patient 10001725 during their last hospital admission?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10001725 ORDER BY admissions.admittime DESC LIMIT 1,[{'admission_type': 'EW EMER.'}],SELECT admission_type FROM admissions WHERE patient_id = 10001725 ORDER BY admission_date DESC LIMIT 1
9f637b49dd6bf5b92a192d46,"What are the three most commonly ordered procedures for patients who were previously diagnosed with intestinal infection due to other organism, not elsewhere classified, which occurred during the same hospital visit since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to other organism, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT TOP 3 procedure, count(procedure) as procedure_count FROM procedures WHERE diagnosis_code = 'intestinal_infection_not_elsewhere_classified' AND admission_date >= '2100-01-01' GROUP BY procedure ORDER BY procedure_count DESC;"
f97301033f6fab945614f220,Has any organism been found in the first mrsa screen microbiological test of patient 10029484 since 05/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)>0': 0}],SELECT DISTINCT organism FROM microbiology_tests WHERE test_type = 'mrsa_screen' AND test_result = 'positive' AND patient_id = '10029484' AND test_date >= '05/2100' AND test_number = 1 AND test_result = 'positive'
36fa0c204674ed02e032e699,When is the earliest of patient 7400's next visit to other departments?,,,SELECT MIN(visit_date) FROM patient_visits WHERE patient_id = 7400 AND department_id != current_department_id AND visit_date > CURRENT_DATE;
3658db3e1651d577b0730f29,Show me the top five most frequent output instances.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT output_instance, COUNT(*) as frequency FROM output_data GROUP BY output_instance ORDER BY frequency DESC LIMIT 5"
3a2f38d0445a8f3784327832,What was the other myectomy time for patient 4718?,,,SELECT `other_myectomy_time` FROM `myectomy_times` WHERE `patient_id` = 4718
d92a728db326dded231e11ba,When was the first time of input for patient 10004733 on 12/28/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-28' ORDER BY inputevents.starttime ASC LIMIT 1",[],SELECT MIN(time_of_input) FROM medical_records WHERE patient_id = 10004733 AND input_date = '2023-12-28'
e72bc975b9c19bf0df3b5f9f,When was the first time during their first hospital encounter when patient 10031404 had the maximum value of lactate dehydrogenase (ld)?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],select max(ld_value) from lab_results where patient_id = 10031404 and admission_date = (select min(admission_date) from admissions where patient_id = 10031404);
95e4cfa052e3d03fe0ffacbd,How many hours has it been since the first diagnosis of anemia in chronic kidney disease in patient 10004733 on this hospital stay?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia in chronic kidney disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"select datediff(hour, min(admitted_datetime), max(discharge_datetime)) from diagnosis where hpid = 10004733 and (icd9_code='250.00-250.93' or icd9_code='276.0') and diagnosis_type = 'PRINCIPAL' and admitted_datetime <= discharge_datetime and discharged = 1"
11f17f3d6fad511b3db76b80,What is the cost of a diagnosis of automatic implantable cardiac defibrillator in situ?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'automatic implantable cardiac defibrillator in situ' ) ),,SQL Query here
9c3f5b2ff13b604dcdc88353,Tell me patient 10009628's total volume of output since 03/03/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-03'",[{'SUM(outputevents.value)': 6293.0}],SELECT SUM(volume) AS total_volume FROM output WHERE patient_id = 10009628 AND date >= '2100-03-03'
ad7bed12453ee529baf37784,Has patient 10004457 received any lab tests since 22 months ago?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ) AND datetime(labevents.charttime) >= datetime(current_time,'-22 month')",[{'COUNT(*)>0': 1}],"select distinct test_name from lab_test where patient_id = 10004457 and test_date >= DATE_SUB(CURDATE(), INTERVAL 22 MONTH)"
e4c9451763f7e1edfdb8a185,What were the four frequent output events that occurred in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],SQL Query here
caa992eaae720918e04f0b4d,Which are the five most common specimens tested throughout this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],"select specimen, count(*) as freq from specimen_tested where test_date >= '2023-01-01' and test_date <= '2023-12-31' group by specimen order by freq desc limit 5"
4db20b840c3b030a56108b21,What was the last time of patient 10027602 mini-bal microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(test_datetime) AS last_test_time FROM microbiology_tests WHERE patient_id = 10027602 AND test_datetime >= '2100-03-01T00:00:00' AND test_description = 'mini-bal'
e8441aac72dc1ce7428bd942,Show me patient 10021487's total oral gastric output amount on this month/16.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'oral gastric' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '16'",[{'SUM(outputevents.value)': None}],
1b56d7ab012fcdd2c4eec4c3,"What would the maximum yearly number of patients diagnosed with catatonic type schizophrenia, unspecified be since 2100?","SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'catatonic type schizophrenia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,SELECT MAX(yearly_count) AS max_yearly_patients FROM `healthcare_dataset.patients_diagnosed_with_schizophrenia` WHERE diagnosis_code = 'catatonic_type_unspecified' AND year >= 2100
2202303447142eaeb02bfd69,What is the minimum value of phosphate on patient 10021666 in 03/2100?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",[{'MIN(labevents.valuenum)': None}],SELECT MIN(Phosphate) FROM lab_tests WHERE PatientID = 10021666 AND TestDate = '03/2100'
2e016fdfd5dd7f3e7f3be7cd,List the five most frequent diagnoses a patient was diagnosed with within 2 months after receiving percutaneous abdominal drainage in this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"[SELECT diagnosis, COUNT(*) AS frequency"
1b34ed1fb8e15ce853b7f472,"First time, what drug was prescribed for patient 10007818 in 07/this year?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT TOP 1 drug_name FROM prescriptions WHERE patient_id = '10007818' AND date_prescribed >= 'YYYY-07-01' AND date_prescribed < 'YYYY-08-01' AND first_prescription = TRUE ORDER BY date_prescribed ASC
7597553ab7e09923b877dd3e,What was the first specimen test given to patient 10018328 in 02/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],"SELECT MIN(test_date) AS first_test_date, test_name FROM specimen_tests WHERE patient_id = 10018328 AND test_date >= '2023-02-01' AND test_date <= LAST_DAY('2023-02-29') GROUP BY test_name ORDER BY first_test_date LIMIT 1;"
94c43966b63036608d8e4089,What was the drug that patient 10018501 prescribed for within 2 days after the procedure of alcohol detoxification in 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,[SELECT DrugName
02aa04b3e6868db7eb1fed99,What are the three frequently prescribed medications in the same month to the patients aged 40s after diagnosed with coronary atherosclerosis of native coronary artery throughout this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of native coronary artery' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT MEDICATION, COUNT(*) AS COUNT FROM PATIENT_MEDICATIONS WHERE MONTH(DIAGNOSIS_DATE) = MONTH(CURDATE()) AND YEAR(DIAGNOSIS_DATE) = YEAR(CURDATE()) AND PATIENT_AGE BETWEEN 40 AND 49 AND DIAGNOSIS = 'Coronary Atherosclerosis of Native Coronary Artery' GROUP BY MEDICATION ORDER BY COUNT DESC LIMIT 3;"
66a7bb5b8a5d8c05eb6fe97c,Get me the top three most frequent medications that patients were prescribed with in the same month after being diagnosed with unspecified infectious and parasitic diseases.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified infectious and parasitic diseases' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"[SELECT `medication`, COUNT(*) AS `frequency`"
fef989a873a0244ffbcecf45,"On 05/21/2100, when was the last input time of patient 10018423?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-05-21' ORDER BY inputevents.starttime DESC LIMIT 1",[],SELECT last_input_time FROM patient_records WHERE patient_id = '10018423' AND record_date = '2100-05-21' ORDER BY last_input_time DESC LIMIT 1
88903941545e70b4a021e3b2,"In the last year, how many (aorto)coronary bypass of four or more coronary arteries procedures were conducted?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of four or more coronary arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"select count(*) from procedures where procedure_type = 'aorto)coronary bypass' and num_of_coronary_arteries >= 4 and procedure_date >= DATEADD(year, -1, GETDATE())"
80d49c51633413262b935409,When was the last staph aureus swab microbiology test of patient 10004422's performed on their last hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'staph aureus swab' ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],
1f4cec0d64925a794dace1cd,What was prescribed to patient 10027602 within 2 days following their percutaneous [endoscopic] gastrostomy [peg] in 12/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT * FROM procedures WHERE patient_id = 10027602 AND procedure_date BETWEEN (SELECT procedure_date FROM procedures WHERE patient_id = 10027602 AND procedure_name = 'percutaneous endoscopic gastrostomy') AND DATE_ADD((SELECT procedure_date FROM procedures WHERE patient_id = 10027602 AND procedure_name = 'percutaneous endoscopic gastrostomy'), INTERVAL 2 DAY) ORDER BY procedure_date;"
1cd31dccc70c46d3c3d8d825,Can you show me the drug that patient 10016150 was last prescribed in their last hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[{'drug': 'Aspirin'}],SELECT TOP 1 drug_name FROM prescriptions WHERE patient_id = '10016150' AND hospital_visit_id IN (SELECT hospital_visit_id FROM hospital_visits WHERE patient_id = '10016150' ORDER BY visit_date DESC) ORDER BY prescription_date DESC LIMIT 1
3ae2168575144fa7bff0773b,Is patient 4758 subject to the test covid-19?,,,SELECT * FROM [PATIENTS
733c21a9f57a3bc179010c01,How many hours have elapsed since the first time on their current hospital encounter patient 10004733 got a epithelial cells lab test?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT DATEDIFF(hour, MIN(lab_test_time), CURRENT_TIMESTAMP) AS hours_elapsed FROM patient_lab_tests WHERE patient_id = 10004733 AND lab_test_type = 'epithelial cells' AND hospital_encounter_id = (SELECT hospital_encounter_id FROM patient_encounters WHERE patient_id = 10004733 ORDER BY start_time ASC LIMIT 1)"
2f8dde64c76d63b846def4a0,What is the maximum total cost of the hospital visits that included a procedure called other operations on intestines since 1 year ago?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other operations on intestines' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(totalcost) FROM (SELECT SUM(totalcharges) AS totalcost FROM inpatient WHERE upc IN (SELECT upc FROM procedure_icd WHERE icd9_cm LIKE '%other operations on intestines%') AND (dischyear >= 2018 AND dischyear <= 2019))
57db051f5e8f25c8927f61ad,How many times patient 10012552 came to the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10012552 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],SELECT COUNT(*) FROM hospital_visits WHERE patient_id = '10012552' AND visit_date >= NOW() - INTERVAL '1 year'
d3085358f26b085a3251d71d,Count the number of patients who were given the indomethacin since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'indomethacin' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 4}],SELECT COUNT(DISTINCT PatientID) FROM patient_treatment_records WHERE Treatment = 'Indomethacin' AND TreatmentDate >= CURDATE() - INTERVAL 1 YEAR;
dac65a4d9eca6e3f5529ae4b,What should i do in advance of bile duct incision nec,,,SELECT * FROM medical_procedure_prep WHERE procedure_name = 'bile duct incision' AND condition = 'nec' ORDER BY step_sequence ASC
37919d0f8db2140219307c6f,Have patient 14990 an appointment in another department?,,,SELECT COUNT(*) FROM appointments WHERE patient_id = 14990 AND department_id != (SELECT department_id FROM patients WHERE patient_id = 14990)
82d8a7640bee5ba7059a425f,When was the last hospital discharge time for patient 10014354?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10014354 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(discharge_time) FROM hospital_discharges WHERE patient_id = '10014354';
f710a9e23d2b119bb3cbd7d6,"During the last year, how many extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic procedures were conducted?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,select count(*) from procedure_occurrence where concept_id = 3084801 and year_of_service >= (select max(year_of_service)-1 from procedure_occurrence)
fb1c9ab851ce79aecda9c32e,Tell me the total number of patients who were discharged from the hospital in the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS total_discharges FROM hospital_records WHERE discharge_date BETWEEN '2022-01-01' AND '2022-12-31'
b6b5cdff0364757e59ebb7a4,What was the amount of or ebl output patient 10008287 had?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ),[{'SUM(outputevents.value)': None}],SELECT or_ebl_output FROM patient_data WHERE patient_id = 10008287
004aab9ab72eb76ab6d10d57,What is the total number of patients who stayed in careunit medical/surgical intensive care unit (micu/sicu) during the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) AS total_patients FROM admissions WHERE careunit IN ('Medical/Surgical Intensive Care Unit (MICU)', 'Surgical Intensive Care Unit (SICU)') AND admission_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
10a09034b24ebc5ea1fcd470,Is the lymphocytes level of patient 10037928 last measured on the last hospital visit less than the first level measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",[SELECT CASE WHEN last.visit_lymphocytes < first.visit_lymphocytes THEN 'Yes' ELSE 'No' END AS Is_Lower
24c0ef475388f60e725ccbc1,Did patient 10037861 receive the procedure of a right heart cardiac catheterization in the first hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],SELECT DISTINCT hc.hospital_visit_id FROM hospital_visits hv JOIN heart_catheterizations hc ON hv.hospital_visit_id = hc.hospital_visit_id WHERE hv.patient_id = 10037861 AND hc.procedure_type = 'right heart cardiac catheterization' AND hv.visit_number = 1
92de51735371a46e81acc845,When did patient 10022281 depart hospital for the first time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022281 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",[],SELECT MIN(DepartDateTime) FROM hospital_stays WHERE PatientID = 10022281 AND DepartDateTime IS NOT NULL
617b9e75f3c58dee20062f3c,Can you tell me the last time patient 10021312 had a maximum heart rate?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(heart_rate) AS last_max_heart_rate, MAX(date) AS last_recorded_date FROM health_data WHERE patient_id = 10021312"
59612d635a641261872944e4,What's the cost of a procedure called extracorporeal circulation auxiliary to open heart surgery?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) ),,select sum(cost) from ProcedureCosts where ProcedureDescription like '%extracorporeal circulation%' and ProcedureDescription like '%open heart surgery%'
cdba77ccb92d5b91ada3a6dc,When will patient 31854 be next seen by the hospital?,,,SELECT next_appointment_date FROM patient_appointments WHERE patient_id = 31854;
99282beda9432fdc84953229,Has patient 27146 ever had any side effects while he/she is receiving a blood transfusion?,,,"SELECT DISTINCT t1.patientid, t1.date, t1.sideeffects FROM bloodtransfusion AS t1 WHERE t1.patientid = 27146 AND t1.sideeffects IS NOT NULL ORDER BY t1.date"
f5f0f6336f05d930f6059ee3,What percentile of the mcv value is 85.0 among patients of the same age as patient 10004733 on this hospital stay?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 85.0",,[SELECT PERCENTILE_CONT(0.85) WITHIN GROUP (ORDER BY mcv)
327a6b8b85b9df578f97d124,"What's the average monthly number of patients who were diagnosed with chronic or unspecified gastric ulcer with hemorrhage, without mention of obstruction?","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic or unspecified gastric ulcer with hemorrhage, without mention of obstruction' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,"SELECT AVG(monthly_patients) FROM (SELECT COUNT(*) AS monthly_patients FROM admissions WHERE diagnosis_code LIKE '%K250%' AND admission_date BETWEEN '2017-01-01' AND '2018-12-31' GROUP BY YEAR(admission_date), MONTH(admission_date)) AS monthly_counts"
133bfd224364a0a162d9e323,Does patient 57050 have some overseas travel history.,,,SELECT COUNT(*) > 0 AS HasOverseasTravel FROM `Patient_Summary` WHERE `PatientID` = '57050' AND `OverseasTravel` = TRUE;
b727c4a8aaf41e038a4aabf6,What is the average yearly number of patients who suffer from coronary atherosclerosis of autologous vein bypass graft?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,SELECT AVG(yearly_patient_count) AS average_yearly_patients FROM patient_records WHERE diagnosis = 'coronary atherosclerosis of autologous vein bypass graft' GROUP BY year;
04aa90b4226c2ae74327b579,What was the name of the output which patient 10004733 had last had since 03/07/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-07' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],SELECT Output.Name FROM Output WHERE Output.PatientID = 10004733 AND Output.Date >= '03/07/2100' ORDER BY Output.Date DESC LIMIT 1
4433eb04729dc3101c0b6e05,Is the white blood cells value of patient 10005817 last measured on the first hospital visit greater than the value from the second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",[SELECT CASE WHEN last_measurement.whc >= second_to_last_measurement.whc THEN 'Yes' ELSE 'No' END AS ComparisonResult
c79aa16d36ce764a13078e7b,How can i disinfect the room in which there is a quarantine?,,,SELECT room_number FROM rooms WHERE status='quarantine' AND disinfection_date IS NOT NULL
aa5ad9ebeb0fafd7b1afae6f,What was the name of the organism at the last sputum test of patient 10038081?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT organism_name FROM lab_tests WHERE test_type='sputum' AND patient_id='10038081' ORDER BY test_date DESC LIMIT 1;
e94967759cb45a5c074573d6,Has patient 10024043 been given any sort of diagnosis during this year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,SELECT DISTINCT diagnosis FROM medical_records WHERE patient_id = 10024043 AND YEAR(visit_date) = YEAR(CURDATE())
0221f690fdea162c568ad8dc,What was the admission type when patient 10004422 first entered the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10004422 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1",[{'admission_type': 'EW EMER.'}],select ... from ... where ... order by ... limit ...
22e0dcfd0402820cca140ef2,What was the last drug that was prescribed to patient 10038081 via the pr route in their last hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"select max(drug_name) as last_drug_name, max(encounter_date) as last_encounter_date from (select d.drug_name, h.encounter_date from drugs d inner join encounters e on d.drug_id = e.drug_id inner join patients p on e.patient_id = p.patient_id inner join hospitals h on e.hospital_id = h.hospital_id where p.patient_id = 10038081 and e.route = 'pr' and h.encounter_date = (select max(encounter_date) from encounters e2 inner join patients p2 on e2.patient_id = p2.patient_id where p2.patient_id = 10038081) and h.encounter_date = (select max(encounter_date) from hospitals h2 inner join encounters e3 on h2.hospital_id = e3.hospital_id where e3.route = 'pr' and e3.patient_id = 10038081) group by d.drug_name, h.encounter_date) as subquery"
d2664490e75476fb8fcc2c63,What amount of syringe (iso-osmotic dextrose) has been prescribed to patient 10022017 for the last time in 10/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND prescriptions.drug = 'syringe (iso-osmotic dextrose)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 amount FROM prescription WHERE patient_id = '10022017' AND medicine = 'syringe (iso-osmotic dextrose)' AND date >= '10/2100' ORDER BY date DESC
6232ae4db195276a3e324143,Was patient 10000032 tested on pt in 08/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08'",[{'COUNT(*)>0': 0}],select * from test_results where patient_id='10000032' and test_date='08/2100' and test_type='pt'
946656a7c18d9898d7d2613c,Can you provide the minimum daily number of patients diagnosed with long term (current) use of insulin?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of insulin' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,"SELECT MIN(""Number of Patients"") AS min_patients FROM ""Condition Occurrence"" WHERE ""Condition Type"" = 'Long Term (Current) Use' AND ""Condition Concept Name"" = 'Insulin' GROUP BY ""Calendar Year"", ""Calendar Month"""
a81a9ceee607e440b6b6e0ef,Count the total patients who were prescribed desmopressin acetate since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'desmopressin acetate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) AS total_patients_prescribed_desmopressin FROM prescription_records WHERE drug_name = 'desmopressin acetate' AND prescription_date >= NOW() - INTERVAL 1 YEAR
37f2202c7041980e8e71b098,What are the top three most frequent microbiology tests that patients were diagnosed with malignant neoplasm of lower third of esophagus within 2 months since 2100?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower third of esophagus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 test_name, COUNT(*) AS frequency FROM microbiology_tests INNER JOIN diagnoses ON microbiology_tests.patient_id = diagnoses.patient_id WHERE diagnoses.disease_name = 'Malignant neoplasm of lower third of esophagus' AND DATEDIFF(month, diagnoses.diagnosis_date, microbiology_tests.test_date) <= 2 AND diagnoses.diagnosis_date >= '2100-01-01' GROUP BY test_name ORDER BY frequency DESC"
811775f5b19375275b6b4825,Show me the total amount of patient 10007928's output since 04/07/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07'",[{'SUM(outputevents.value)': 6660.0}],SELECT SUM(quantity) FROM output WHERE patientid = 10007928 AND datetime >= '2100-04-07'
6033e2bfc3a0657f188b7149,What was the name of the last specimen test which patient 10019385 has received in 03/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT specimen_test_name FROM specimen_tests WHERE patient_id = '10019385' AND test_date LIKE '2100-03%' ORDER BY test_date DESC LIMIT 1;
8890920db6fabe97648a1d64,Has patient 10007795 had any surgeries in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,SELECT * FROM surgeries WHERE patient_id = '10007795' AND YEAR(surgery_date) = 2100
82de427493ba0005e55da2e9,Can you tell me the top five diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT diagnosis, mortality_rate FROM diagnoses ORDER BY mortality_rate DESC LIMIT 5"
74d605424dff525f198b0afe,Has patient 10016810 received a medication prescription since 1 year ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 1}],select count(*) from patient_meds where patient_id = 10016810 and date_prescribed > current_date - interval '1 year'
e6ffbc5a3950db37fba4014e,When did patient 10037861 have his last microbiology test in 10/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],select top 1 date from microbiology_tests where patient_id = 10037861 and date < '10/01/2100' order by date desc
8d5bb2ecca85dfad41515eb5,Has patient 10010471 been admitted to the emergency room since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 0}],"SELECT * FROM emergency_room_admissions WHERE patient_id = 10010471 AND admission_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
cf07a721765b700935e376f5,How much is the difference of basophils of patient 10038992 last measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT MAX(""lab_basophils"") - MIN(""lab_basophils"") AS ""basophil_difference"" FROM ""lab_events"" WHERE ""subject_id"" = 10038992 AND ""hospital_visit_id"" = 1"
43d295b14df7663a4b921316,What is the cost for a drug named nicotine patch?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nicotine patch' ),,SELECT price FROM drug_prices WHERE drug_name='nicotine patch'
1f207d94f4dd9613e4d69a5d,"In 2100, how often was introduction of other therapeutic substance into peripheral artery, percutaneous approach done?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,"SELECT COUNT(*) FROM medical_procedures WHERE procedure_code = 'Introduction of other therapeutic substance into peripheral artery, percutaneous approach' AND year = '2100';"
7793a26811956045c0aad41d,"For patients who were diagnosed with acute venous embolism and thrombosis of subclavian veins , what are the top four most common medications that followed afterward during the same hospital visit?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute venous embolism and thrombosis of subclavian veins' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"[SELECT med, COUNT(med) AS freq"
7e458af0dc3da0d261bc5436,When was the last time when patient 10021312 was prescribed vancomycin and 0.9% sodium chloride at the same time in 09/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vancomycin' AND admissions.subject_id = 10021312 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10021312 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"select max(t1.date_prescribed) from prescriptions t1, prescriptions t2 where t1.patient_id=10021312 and t2.patient_id=10021312 and t1.drug_name='vancomycin' and t2.drug_name='0.9% sodium chloride' and t1.date_prescribed=t2.date_prescribed and t1.date_prescribed>=date('now', 'start of month', '-1 month')"
df6d9f1646fc387c7952ce10,"Is the value of patient 10009628's hemoglobin, second measured on the first hospital visit, less than the first value measured on the first hospital visit?",SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN h1.hemoglobin < h2.hemoglobin THEN 'Yes' ELSE 'No' END AS result FROM (SELECT hemoglobin FROM medical_records WHERE patient_id = 10009628 AND visit_number = 1 AND measurement_sequence = 1) AS h1, (SELECT hemoglobin FROM medical_records WHERE patient_id = 10009628 AND visit_number = 1 AND measurement_sequence = 2) AS h2;"
a2dcdcf12890887cb1bf85a7,What is the minimum monthly number of cases for unspecified atrial flutter?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified atrial flutter' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,select min(monthly_cases) from atrial_fibrillation where diagnosis='unspecified atrial flutter'
b58e546890ee6007f8e2974b,"Last year, how many patients were diagnosed with hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,"SELECT COUNT(DISTINCT patient_id) AS total_patients FROM diagnoses WHERE diagnosis_date BETWEEN '2022-01-01' AND '2022-12-31' AND ICD_code IN ('I12.9', 'N18.1', 'N18.2', 'N18.3', 'N18.4', 'N18.9')"
d365fe598240a0df514f9daa,Count how many current patients are aged 60 or above.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,,SELECT COUNT(*) AS count FROM Patient WHERE current = 1 AND age >= 60
b7b00a485da3ac7c2a9f4f8e,What was the admission type for patient 10026354 during their first hospital admission?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10026354 ORDER BY admissions.admittime ASC LIMIT 1,[{'admission_type': 'URGENT'}],SELECT admission_type_id FROM ADMISSIONS WHERE HADM_ID = (SELECT MIN(HADM_ID) FROM ADMISSIONS WHERE SUBJECT_ID = 10026354)
855969a5637352d329e6b650,Which are the five top specimens that were tested in 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],"SELECT * FROM specimens ORDER BY test_year DESC, specimen_id DESC LIMIT 5"
6a7c1eb2cf2a97c8f56e8695,What specimen test was given in 12/2100 to patient 10008454 for the last time?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT DISTINCT t.specimen_test_code FROM specimen_test t WHERE t.specimen_test_date = (SELECT MAX(t1.specimen_test_date) FROM specimen_test t1 WHERE t1.patient_id = 10008454 AND t.specimen_test_code = t1.specimen_test_code AND t1.specimen_test_date <= '12/31/2100') AND t.patient_id = 10008454
017d9aef746962d1c3d9d52e,When did patient 10027445 last receive a mrsa screen microbiology test since 08/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(date_time) FROM microbiology WHERE person_id = 10027445 AND test_name = 'mrsa screen' AND date_time >= '08/2100'
eeb43c515ff535d263e55711,"What is the minimum total cost of hospitalization that includes the reticulocyte count, absolute laboratory test since 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'reticulocyte count, absolute' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_cost) FROM hospitalization h JOIN lab_tests l ON h.lab_test_id = l.id WHERE l.result = 'Reticulocyte Count' AND l.test_date >= '2100-01-01' AND l.type = 'Absolute';
1af0e5232d922453e5d2e3ae,How many patients received unilateral simple mastectomy treatment in the same month after having been diagnosed with acquired absence of breast and nipple in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of breast and nipple' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,SELECT count(*) AS patient_count FROM Patients WHERE diagnosis_code = 'Acquired Absence of Breast and Nipple' AND treatment_code = 'Unilateral Simple Mastectomy' AND MONTH(diagnosis_date) = MONTH(treatment_date) AND YEAR(diagnosis_date) = 2100
8a1b6e9c62cf3eae76e1d86d,How many current patients are there in the 60 or above age group?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,,select count(*) from Patients where age >= 60 and isCurrentPatient = true
88a6c24100e056a0cd5afdeb,"What is the number of extirpation of matter from coronary artery, one artery, percutaneous approach procedures carried out?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from coronary artery, one artery, percutaneous approach' )",[{'COUNT(*)': 0}],"SELECT COUNT(*) AS procedure_count FROM procedures WHERE procedure_name = 'Extirpation of Matter from Coronary Artery, One Artery, Percutaneous Approach'"
423eabf79f7a6b056f9dea1e,What is the minimum monthly number of patients diagnosed with personal history of traumatic brain injury since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of traumatic brain injury' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,SELECT MIN(`Monthly Patients`) FROM `Patient Records` WHERE `Diagnosis` = 'Personal history of traumatic brain injury' AND `Year` > 2100
2ada7dac8b465ec817534276,What was the amount of neutra-phos that was prescribed to patient 10036156 for the first time in 07/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.drug = 'neutra-phos' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"SELECT min(prescription_date) AS FirstPrescriptionDate, prescription_amount FROM prescriptions WHERE patient_id = '10036156' AND drug_name = 'neutra-phos' AND date_part('month', prescription_date) = 7 AND date_part('year', prescription_date) = date_part('year', CURRENT_DATE) GROUP BY patient_id, prescription_amount HAVING min(prescription_date) = (SELECT min(prescription_date) FROM prescriptions WHERE patient_id = '10036156' AND drug_name = 'neutra-phos' AND date_part('month', prescription_date) = 7 AND date_part('year', prescription_date) = date_part('year', CURRENT_DATE))"
562f824477376311916b88db,Patient 10008287 was diagnosed during their first hospital visit for the last time with what?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,SELECT diagnosis FROM patient_records WHERE patient_id = '10008287' AND visit_number = 1 ORDER BY visit_date DESC LIMIT 1
47d86d0e205097ff162381f7,When did patient 10027602 last have a minimum value of diastolic blood pressure on last month/29?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],SELECT MAX(date) AS last_date FROM patient_data WHERE patient_id = 10027602 AND diastolic_bp = (SELECT MIN(diastolic_bp) FROM patient_data WHERE patient_id = 10027602 AND date BETWEEN '2023-02-01' AND '2023-02-29') AND date BETWEEN '2023-02-01' AND '2023-02-29';
392945487423b16d5daec3fe,"For patient 10039831, what was the first hematocrit, calculated reading in their current hospital encounter?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit, calculated' ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT MIN(date_time) as FirstHematocritDateTime, result_value as HematocritValue FROM lab_results WHERE patient_id = 10039831 AND result_type = 'Hematocrit' AND current_hospital_encounter_flag = true ORDER BY date_time ASC LIMIT 1"
ca8aadc66b1fcaf0dbac962e,"How many patients had a glucose, pleural lab test?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, pleural' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM lab_tests WHERE test_name = 'glucose, pleural'"
c6db806375506c37524257d8,Has patient 10027602 received any diagnoses since 1 year ago?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year')",,SELECT COUNT(*) AS DiagnosisCount FROM diagnosis WHERE patientid = 10027602 AND dateentered > (CURRENT_DATE - INTERVAL '1 year')
408218a9af14aa7ec6f3f966,How much does it cost for ondansetron?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ondansetron' ),,select avg(price) from drugs where name='ondansetron'
c1e6eda2955990fe92f24709,What are the five frequently ordered drugs for patients diagnosed with unspecified condition of brain previously in the same month?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified condition of brain' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,
c84349e69cbe2cf09f686cd5,Retrieve the top five most frequent medications that patients were prescribed within 2 months after being diagnosed with unspecified vascular insufficiency of intestine since 1 year ago.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified vascular insufficiency of intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 Medication_Name, COUNT(*) AS Prescription_Count FROM Prescriptions WHERE Diagnosis = 'Unspecified Vascular Insufficiency of Intestine' AND Prescription_Date >= DATEADD(MONTH, -2, Diagnosis_Date) AND Diagnosis_Date >= DATEADD(YEAR, -1, GETDATE()) GROUP BY Medication_Name ORDER BY Prescription_Count DESC"
94c68a26042492f18d7f5c60,What was the duration in days of patient 10014354's last stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.2415625010617077}]","SELECT DATEDIFF(day, MIN(AdmitDateTime), MAX(DischargeDateTime)) AS DurationInICU FROM PatientRecords WHERE PatientID = 10014354 AND Unit = 'ICU' GROUP BY PatientID"
c916df49979cb247be8c50a6,Give me the total volume of output for patient 10039831 since 01/19/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19'",[{'SUM(outputevents.value)': 6680.0}],
5572350469c75b9bc5b406cd,"What are the five most frequently given diagnoses for patients who had previously had extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic in the same month, since 1 year ago?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 DIAGNOSIS, COUNT(*) AS DIAGNOSIS_COUNT FROM PATIENT_ENCOUNTERS WHERE PROCEDURE_NAME = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' AND ENCOUNTER_DATE BETWEEN DATEADD(year, -1, GETDATE()) AND GETDATE() GROUP BY DIAGNOSIS ORDER BY DIAGNOSIS_COUNT DESC"
3189eb16865c13742abd3f7a,Is patient 12726 scheduled to have an appointment in another department?,,,select count(*) from appointment where patient_id='12726' and dept_id !='dept_1'
2be33c796f39654a64acc2af,"What are the five most commonly tested specimens for patients who were diagnosed with chronic osteomyelitis, site unspecified previously within the same month, throughout this year?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic osteomyelitis, site unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 Specimen, COUNT(Specimen) AS Frequency FROM lab_tests WHERE Diagnosis = 'Chronic Osteomyelitis' AND PreviousDiagnosisDate BETWEEN DATEADD(year, DATEDIFF(year, 0, GETDATE()), 0) AND GETDATE() AND PreviousDiagnosisDate = CurrentDiagnosisDate AND Month(CurrentDiagnosisDate) = Month(PreviousDiagnosisDate) GROUP BY Specimen ORDER BY Frequency DESC"
8946a6077d0e165e482e261f,What are the four most frequent microbiology tests in this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4",[],"SELECT test, COUNT(*) AS frequency FROM microbiology_tests WHERE YEAR(test_date) = YEAR(CURDATE()) GROUP BY test ORDER BY frequency DESC LIMIT 4;"
8ffeebf80d9e33afb70ec3ec,Please list out the monthly average weight of patient 10004422 in 2100.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT date_trunc('month', record_date) AS month, avg(weight) AS average_weight FROM patient_records WHERE patient_id = 10004422 AND extract(year from record_date) = 2100 GROUP BY month ORDER BY month ASC"
cb462d0dd320361bdac44dad,What are the five diagnoses with the lowest 3-month survival rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT diagnosis, AVG(survival_3_months) AS average_survival_rate FROM patient_records GROUP BY diagnosis ORDER BY average_survival_rate ASC LIMIT 5"
21ee43d3aa608dce16db8951,How much calcium carbonate was prescribed the last time on the first hospital stay to patient 10021938?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'calcium carbonate' ORDER BY prescriptions.starttime DESC LIMIT 1,[],select * from patient_records where patient_id = 10021938 and hospital_stay = 1 order by prescription_date desc limit 1
04f7c8bdde444d9384216f93,Calculate the number of ICU visits of patient 10020786.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ),[{'COUNT( DISTINCT icustays.stay_id )': 1}],"SELECT COUNT(*) AS ""Number of ICU Visits"" FROM ICU WHERE Patient_ID = 10020786;"
15a45174676987c6a3c0c4af,What percentile does a urea nitrogen value of 15.0 for patient 10001725 place in today on the first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 15.0",,"SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY urea_nitrogen_value) OVER (PARTITION BY patient_id, hospital_encounter) FROM lab_results WHERE urea_nitrogen_value >= 15.0 AND patient_id = '10001725' AND hospital_encounter = 'first' AND result_date = CURRENT_DATE"
bebd7cec45abb76dc9e4534c,What was a drug that patient 10001217 was prescribed for within the same hospital visit after receiving central venous catheter placement with guidance in this month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,select ... from ... where ... limit 1
4a1dbfdbd15e295406eef0bf,Has patient 10020306 been treated with a unilateral simple mastectomy procedure since 1 year ago?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'unilateral simple mastectomy' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,select count(*) as procedure_count from procedure_occurrence where person_id=10020306 and procedure_concept_id=38000260 and procedure_date > (CURRENT_DATE - INTERVAL '1 year')
5f14e8eaef40b6633ce2e6dc,How was patient 10020944 admitted to the hospital in terms of admission type for the first time?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10020944 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1",[],SELECT `AdmissionType` FROM `PatientAdmissions` WHERE `PatientID` = '10020944' AND `AdmissionNumber` = 1;
848f58c164e2f0878c1c9ce1,Has patient 10004235 been oxygen saturation tested in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen saturation' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',labevents.charttime) = '2100'",[{'COUNT(*)>0': 0}],SELECT * FROM medical_tests WHERE patient_id = 10004235 AND test_name = 'oxygen_saturation' AND test_date >= '2021-01-01' AND test_date < '2022-01-01'
fc8ee142c3b432f169fa7cdc,What are the five frequently ordered medications for patients diagnosed with esophageal reflux previously during the same hospital visit?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,SELECT TOP 5 medication FROM patient_medications JOIN patient_diagnoses ON patient_medications.patient_id = patient_diagnoses.patient_id WHERE patient_diagnoses.diagnosis = 'esophageal reflux' AND patient_medications.visit_id = patient_diagnoses.visit_id GROUP BY medication ORDER BY COUNT(*) DESC
53ff8403c661d26f398402c6,What is the average yearly number of patients who suffer from unspecified sinusitis (chronic)?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sinusitis (chronic)' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,"SELECT YEAR(visit_date) as year, AVG(patient_count) as avg_patients FROM (SELECT visit_date, COUNT(DISTINCT patient_id) as patient_count FROM patient_records WHERE diagnosis = 'unspecified sinusitis (chronic)' GROUP BY visit_date) GROUP BY YEAR(visit_date)"
f094acde3e855985c85bc122,What were the top five diagnoses most frequently diagnosed since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) as frequency FROM diagnoses WHERE year >= 2100 GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
c8d18210963921f83f907052,What are the top three most commonly diagnosed conditions since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT TOP 3 condition, COUNT(*) as diagnosis_count FROM diagnoses WHERE diagnosis_date > DATEADD(YEAR, -1, GETDATE()) GROUP BY condition ORDER BY diagnosis_count DESC"
ebde9f1b9d393f71e485fb70,Is patient 18677 having a history of suppurat peritonitis nec in his/her family?,,,SELECT * FROM Patient WHERE patient_id=18677 AND family_history LIKE '%suppurat peritonitis nec%'
061afbb7908a8ff0d6a68a50,Has patient 10005866 been admitted into an emergency room since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 0}],[SELECT COUNT(*) AS NumberOfAdmissions
46a12514c3bab25439a23710,Show me the length of time in days patient 10014729 was in the ICU during the last visit.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.471168980933726}]","SELECT DATEDIFF(day, ICUAdmitDate, ICULeaveDate) AS LengthOfStayInICU FROM PatientVisits WHERE PatientID = '10014729' AND VisitID = (SELECT MAX(VisitID) FROM PatientVisits WHERE PatientID = '10014729')"
c26556c5555cff100d6a8a02,What are the prices for the drug called aspirin (buffered)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'aspirin (buffered)' ),,SELECT price FROM Drugs WHERE name = 'aspirin (buffered)'
7b04b1222708b5e1f1411219,"What was the maximum value of creatinine, urine for patient 10038992 during the last hospital visit?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine, urine' )",[{'MAX(labevents.valuenum)': None}],select max(creatinine_urine_value) from lab_results where patient_id = 10038992 and visit_date = (select max(visit_date) from lab_results where patient_id = 10038992)
42cb30e92eb50866f96a3d15,Calculate the sum of patient 10004235's input since 01/20/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-20'",[{'SUM(inputevents.totalamount)': 122382.0}],SQL Query Here
87a08ba4fb163b2b667c4c13,When was the last time patient 10021487 was measured with a SaO2 greater than 97.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 97.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT MAX(MEASUREMENT_DATETIME) FROM HEALTH_DATA WHERE PATIENT_ID = 10021487 AND SaO2 > 97.0
9a574ab97db06ee700de7520,How many hours have passed since the first time patient 10039831 has received a calculated total co2-lab test in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],select sum(extract(epoch from (end_time - start_time))/3600) from result r join lab l on r.lab_id = l.lab_id join patient p on r.patient_id = p.patient_id where p.patient_id = 10039831 and l.lab_name = 'Calculated Total CO2' and r.visit_id = p.current_visit_id
28bdbd0cf00eb27eaead2cf5,When was the last time that patient 10007818's respiratory rate was measured at greater than 18.0 on 07/20/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 18.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '07-20' ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT max(measurement_date) as last_measurement_date FROM `physionet-data.mimiciii_clinical.measurement` WHERE subject_id = 10007818 AND measurement_date >= '2023-07-20' AND measurement_date <= '2023-07-21' AND value > 18.0 AND itemid IN (211, 220045)"
6b5916a645e1dcf8aaef7a8d,What is the name of the drug that shouldn't be administered during lt heart angiocardiogram?,,,SELECT drug_name FROM drug_administration WHERE procedure_name = 'lt heart angiocardiogram' AND contraindicated = TRUE
2ea0eb184438ab7110b6c335,"Fetch the top five most frequent procedures that were administered to patients within 2 months after they had drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT procedure, COUNT(*) as frequency FROM medical_records WHERE procedure IN (SELECT procedure FROM medical_records WHERE date BETWEEN (SELECT date FROM medical_records WHERE procedure = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic') AND (SELECT date FROM medical_records WHERE procedure = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic') + INTERVAL '2 MONTH') GROUP BY procedure ORDER BY frequency DESC LIMIT 5;"
7cfc885a581b81aedac1d706,What are the top five most commonly diagnosed conditions this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM patient_records WHERE diagnosis_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
6388862788004bf9b1e4345a,Can you tell me when patient 10004733's last microbiology test was since 05/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2174-12-13 12:35:00'}],SELECT TOP 1 test_date FROM lab_tests WHERE patient_id = 10004733 AND test_type = 'Microbiology' AND test_date > '2100-05-01' ORDER BY test_date DESC
bf6f9f9621257cc2c12df1dc,When did patient 10038999 have the mesothelial cells lab test for the first time in 06/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT MIN(test_date) FROM lab_tests WHERE patient_id = '10038999' AND test_name = 'mesothelial cells' AND test_date LIKE '06/21%'
6e592987e710b1b2fcd180e0,What's the red blood cells change of patient 10009628 last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT rbc_change FROM lab_results WHERE patient_id = 10009628 ORDER BY visit_date DESC LIMIT 1
112f416ddb62edda1db7a561,How much is the maximum total hospital bill for a visit that involves a mcv test throughout this year?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_bill) FROM bills WHERE visit_date >= '2023-01-01' AND mcv_test = TRUE AND visit_date <= '2023-12-31';
a54cc5aec8ac14dc7dd2bdbe,What medicine does patient 84476 take after being prescribed by our hospital's other department?,,,select medication.medication_name from medication_prescribed as mp join medication on mp.medication_id = medication.medication_id where mp.patient_id = 84476 and mp.prescribing_department != 'Our Hospital Department';
8121c662bf6e3f319ab5b9f9,List the top three most frequent events occurring.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","select event_name, count(event_name) as event_count from events group by event_name order by event_count desc limit 3"
733f66f03dc1de20e998d218,How much glucagon was prescribed since 05/2100 for the last time to patient 10020306?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND prescriptions.drug = 'glucagon' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],"SELECT MAX(order_date), SUM(quantity) AS total_glucagon_prescribed FROM prescriptions WHERE item_name = 'Glucagon' AND patient_id = '10020306' AND order_date >= '05/2100' GROUP BY patient_id"
08996b07e2ed8aa176fe423e,Could you tell me the five most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]",SQL Query
7e3ec87fbaccb0f0ab6de255,When did patient 10018845 get input for the first time?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) ORDER BY inputevents.starttime ASC LIMIT 1,[{'starttime': '2184-10-08 05:03:00'}],SELECT MIN(admit_date) AS first_input_date FROM admissions WHERE patient_id = '10018845'
8dc67c242df7f0e88cce307e,What was the first drug that patient 10007818 had been prescribed via the pr route since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'pr' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT TOP 1 drug_name FROM prescriptions WHERE patient_id = 10007818 AND route = 'pr' AND prescription_date >= '05/2100' ORDER BY prescription_date ASC
a1c948ed4a09091c1d92be84,Whats the code that works with icd-11 mal neo lower 3rd esoph in icd-10?,,,"select icd10_code from ICD_11_to_ICD_10 where icd11_code in (select icd11_code from ICD_11 where lower_desc like ""%mal neo lower 3rd esoph%"")"
c247847fea9d213094a3045f,What are the five most frequently administered procedures for patients aged 40s since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,Your SQL query here
9564984f5e6bba259c9cbe18,"What are the five most commonly diagnosed diagnoses for patients who had previously received extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic within the same month since 1 year ago?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 Diagnosis.Description, COUNT(Diagnosis.DiagnosisID) AS Frequency FROM Diagnosis INNER JOIN PatientDiagnosis ON Diagnosis.DiagnosisID = PatientDiagnosis.DiagnosisID INNER JOIN PatientProcedures ON PatientDiagnosis.PatientID = PatientProcedures.PatientID WHERE PatientProcedures.ProcedureDescription = 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' AND PatientProcedures.ProcedureDate BETWEEN DATEADD(MONTH, -12, GETDATE()) AND GETDATE() GROUP BY Diagnosis.Description ORDER BY Frequency DESC"
e456aafa65dbfb805ba11016,When was patient 10020740's respiratory rate first measured less than 20.0 in their first ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 20.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],"SELECT MIN(admittime) AS first_measurement_time FROM chartevents WHERE SUBJECT_ID = 10020740 AND CATEGORY = 'Respiratory' AND ITEMID = 223835 AND VALUE < 20.0 AND ICU_STAY_ID IN (SELECT MIN(ROW_ID) AS first_icu_stay FROM chartevents WHERE SUBJECT_ID = 10020740 GROUP BY SUBJECT_ID, HADM_ID)"
27c5230565a9e53ebebd7913,Show me patient 10004733's total volume of output since 05/19/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-19'",[{'SUM(outputevents.value)': 17410.0}],SELECT SUM(volumes) AS total_volume FROM icu WHERE icustay_id = 10004733 AND charttime > '05/19/2100' AND itemid IN (SELECT itemid FROM item_lookup WHERE category = 'urine_output');
ee08d24fe58b44292d96dfdc,"How much is introduction of nutritional substance into upper gi, via natural or artificial opening?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) )",,"select SUM(cost) from medical_procedures where procedure_name like '%nutritional substance%' and body_part like '%upper gi%' and method in ('natural opening', 'artificial opening')"
86a5036ec7d536605431efaf,Tell me the name of the diagnosis that patient 10039831 received the first time in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",,SELECT diagnosis_description FROM diagnosis WHERE person_id = 10039831 AND year(diagnosis_date) = 2100 ORDER BY diagnosis_date ASC LIMIT 1
00854efb1da3fe176150292d,What new drugs are prescribed for patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],
72a2d6a35e2ba5c873f1a881,Has patient 10027445 had any medication prescribed since 07/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'",[{'COUNT(*)>0': 1}],SELECT * FROM MedicationPrescriptions WHERE PatientID = 10027445 AND PrescriptionDate >= '07/21/2000'
92968aac60b31a25b1b7a9e2,Get me the top four most frequent drugs that patients were prescribed in the same month after being diagnosed with other place in hospital as the place of occurrence of the external cause throughout this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other place in hospital as the place of occurrence of the external cause' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"select drug_name, count(*) as drug_count from drug_prescriptions join diagnoses on drug_prescriptions.patient_id = diagnoses.patient_id join admission_details on drug_prescriptions.patient_id = admission_details.patient_id where diagnoses.condition = 'other place in hospital' and admission_details.place_of_occurrence = 'external cause' and admission_details.admission_date between '2023-01-01' and '2023-12-31' and strftime('%m', drug_prescriptions.prescription_date) = strftime('%m', diagnoses.diagnosis_date) group by drug_name order by drug_count desc limit 4"
cb9ca5309bb33b28efa1b130,Calculate the number of patients who were discharged from the hospital during this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM PatientRecords WHERE DischargeDate BETWEEN '2023-01-01' AND '2023-12-31' AND DischargeDate IS NOT NULL
137633ed86ab2d0d0059f5c2,"How many hours have elapsed since the first time in the current hospital visit patient 10021487 received a lab test for bilirubin, total, ascites?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, ascites' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT DATEDIFF(hour, MIN(test_datetime), GETDATE()) FROM lab_tests WHERE patient_id = 10021487 AND current_hospital_visits_id = (SELECT id FROM current_hospital_visits WHERE patient_id = 10021487) AND test_name = 'Bilirubin, total' AND test_result IN ('ascites', 'ascites with bilirubin')"
b6dc114c7f1dd675d8ee88a1,Did patient 10018081 have any medication prescribed on their last hospital encounter?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT DISTINCT m.medication_name FROM encounters e INNER JOIN medications m ON e.encounter_id = m.encounter_id WHERE e.patient_id = '10018081' AND e.encounter_date = (SELECT MAX(encounter_date) FROM encounters WHERE patient_id = '10018081')
cdc697ea9fbefe7b34b817f1,What drug was first prescribed to patient 10009035 since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Aspirin'}],SELECT medication_name FROM prescriptions WHERE patient_id = 10009035 AND prescription_date >= '05/2100' ORDER BY prescription_date ASC LIMIT 1
91db324bae8dcd9a03f5f6ba,What was the name of the diagnosis that patient 10018081 received for the last time since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,SELECT TOP 1 diagnosis FROM patient_diagnoses WHERE patient_id = '10018081' AND diagnosis_date >= '2100-01-01' ORDER BY diagnosis_date DESC
2dc6aa9a4ecdf77dc85c452e,Retrieve patient 10018423's monthly minimum weight since 03/2100.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-03' GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT MIN(weight) as min_weight, DATE_FORMAT(date, '%Y-%m') as month FROM patient_records WHERE patient_id = 10018423 AND date >= '0300-01-01' GROUP BY DATE_FORMAT(date, '%Y-%m') ORDER BY month;"
62e57b2d710776dc9693105a,What was the total of calcium acetate that patient 10021938 had been prescribed on the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'calcium acetate',[{'SUM(prescriptions.dose_val_rx)': None}],SQL Query
adac729f5e8b6d9ceaf2e454,Tell me the length of time in days for patient 10010471's first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.907152778003365}]","SELECT DATEDIFF(MAX(DischargeTime), MIN(AdmissionTime)) as LengthOfStay FROM PatientData WHERE PatientID = 10010471 AND UnitType = 'ICU' GROUP BY PatientID"
8ce0acf858783aaaafbc6c86,When was the last time patient 10012552 was measured heart rate greater than 78.0 in the first ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 78.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT MAX(Date) FROM Measurements WHERE PatientID = '10012552' AND Type = 'Heart Rate' AND Value > 78.0 AND VisitNumber = 1 AND Unit = 'bpm';
7d276bb7858da3e756c5b278,Give me patient 10025612's total amount of or crystalloid intake input.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],SELECT SUM(IU) AS Total_Intake FROM intake_input WHERE Patient_ID = 10025612 AND (Item = 'or' OR Item = 'crystalloid')
7e323066fd515e38f24d8cbe,"What are the five frequently tested specimens for patients that received insertion of intraluminal device into inferior vena cava, percutaneous approach previously within the same hospital visit since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of intraluminal device into inferior vena cava, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"SELECT DISTINCT TOP 5 specimen, COUNT(specimen) AS specimen_count FROM lab_tests WHERE procedure_description = 'Insertion of intraluminal device into inferior vena cava, percutaneous approach' AND visit_id IN (SELECT visit_id FROM lab_tests WHERE procedure_description = 'Insertion of intraluminal device into inferior vena cava, percutaneous approach') AND test_time >= '21:00' GROUP BY specimen ORDER BY specimen_count DESC"
b184bcbbaadeb5289f8fd10a,What are the four most frequently ordered medications that patients in their 20s were prescribed in the same month after they were diagnosed with tobacco use disorder?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 20 AND 29 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 medication_name, COUNT(*) as prescription_count FROM prescriptions WHERE patient_age BETWEEN 20 AND 29 AND diagnosis = 'Tobacco Use Disorder' AND MONTH(prescription_date) = MONTH(diagnosis_date) GROUP BY medication_name ORDER BY prescription_count DESC;"
311010fa82081b7438a008c0,"How much is the cost of the family history of malignant neoplasm of trachea, bronchus, and lung diagnosing?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of trachea, bronchus, and lung' ) )",,"SELECT SUM(ProcCost) FROM lineitem WHERE DrgCode IN (SELECT DrgCode FROM dsh WHERE DrgDesc LIKE '%malignant neoplasm of trachea, bronchus, and lung%') AND DrgType = 'FAMILY HISTORY'"
102866b5841e8a98e3f1d51b,Can you list patient 10031404's monthly average weight?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT DATE_FORMAT(measurement_date, '%Y-%m') AS Month, AVG(weight) AS AvgWeight FROM patient_measurements WHERE patient_id = '10031404' GROUP BY Month ORDER BY Month"
7809b76d2d7b213240cd949c,How many hours have passed since the first time that patient 10004733 stayed in careunit medicine on this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1",[],"select sum((date_part('epoch',disch_time) - date_part('epoch',admit_time))/3600) from careunit_stays where patient_id = 10004733 and careunit_name = 'medicine' and encounter_id = 10004733"
e4c2baa72dfc40ca402c8ebc,Is patient 10018081's heart rate last measured on the current ICU visit less than the second to last value measured on the current ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",[select count(*) from `physionet-data.mimiciii_clinical.icustays` i left join `physionet-data.mimiciii_clinical.chartevents` c on i.subject_id = c.subject_id and i.icustay_id = c.icustay_id and c.itemid = 211 and c.valueuom = 'Count/min' and c.value > 0 and c.value <= 500 where i.subject_id = 10018081 and i.hadm_id = (select hadm_id from `physionet-data.mimiciii_clinical.icustays` where subject_id = 10018081 order by intime desc limit 1) and c.charttime = (select charttime from `physionet-data.mimiciii_clinical.chartevents` where icustay_id = (select icustay_id from `physionet-data.mimiciii_clinical.icustays` where subject_id = 10018081 order by intime desc limit 1) and itemid = 211 and valueuom = 'Count/min' and value > 0 and value <= 500 order by charttime desc limit 1) and c.value < (select value from
81fecc104d9ef8ac42378b81,Show me the top five most common treatments for patients aged 20s since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT TreatmentName, COUNT(*) AS TreatmentCount FROM Treatments JOIN Patients ON Treatments.PatientId = Patients.PatientId WHERE Patients.Age BETWEEN 20 AND 29 AND Treatments.Date >= '2100-01-01' GROUP BY TreatmentName ORDER BY TreatmentCount DESC LIMIT 5;"
0bf3d99fa1e1eb8dd643a066,Was patient 10007818 on any solution in the first ICU stay?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM ICUStays WHERE patient_id = '10007818' AND stay_type = 'first' AND solution_administered IS NOT NULL
a370a79ac614fe8fa9d3408a,What output did patient 10021487 have for the first time since 12/15/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-15' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Foley'}],SELECT * FROM `lab_results` WHERE `patient_id` = '10021487' AND `sample_date` >= '2100-12-15' ORDER BY `sample_date` ASC LIMIT 1;
6560334262dd340b665256e1,List the top five most common events that happened throughout this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],"SELECT event, COUNT(*) as event_count FROM events WHERE YEAR(event_date) = YEAR(CURDATE()) GROUP BY event ORDER BY event_count DESC LIMIT 5"
f22796c3c0a1bd93d011883d,Has patient 10038999 experienced any surgeries?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ),[{'COUNT(*)>0': 1}],SELECT * FROM surgeries WHERE patient_id = 10038999;
9e60028a3774be29f175d420,Can you tell me about patient 10016150's age in the last hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,"SELECT last_visit_date, TIMESTAMPDIFF(YEAR, birth_date, last_visit_date) AS age_at_last_visit FROM patients WHERE patient_id = '10016150'"
304008138415ff886f9fa539,Show me the total amount of patient 10008454's output on this month/02.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '02'",[{'SUM(outputevents.value)': None}],SELECT SUM(output) FROM patient_data WHERE patient_id = 10008454 AND MONTH(date) = 02 AND YEAR(date) = YEAR(CURDATE())
0ebcf64e6e88ffe234e3a991,What was the total amount of input for patient 10026354 since 07/21/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-21'",[{'SUM(inputevents.totalamount)': 7100.0}],SELECT SUM(input) AS TotalInput FROM patient_data WHERE patient_id = '10026354' AND date >= '2100-07-21'
2d135d2b1bde82eddce53d88,What are the three most ordered lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",SQL Query here
63b6c9677e2f1cde57d31e73,How much does patient 10004422 change in weight last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT (last_weight - second_last_weight) as weight_change FROM (SELECT last.weight as last_weight, second_last.weight as second_last_weight FROM (SELECT weight, visit_date FROM patient_measurements WHERE patient_id = 10004422 ORDER BY visit_date DESC, measurement_time DESC LIMIT 1) as last, (SELECT weight, visit_date FROM patient_measurements WHERE patient_id = 10004422 AND visit_date < (SELECT visit_date FROM patient_measurements WHERE patient_id = 10004422 ORDER BY visit_date DESC, measurement_time DESC LIMIT 1) ORDER BY visit_date DESC, measurement_time DESC LIMIT 1) as second_last) as subquery"
fcf30c1dc6ce58162c86998c,What was the five most common microbiology test conducted in this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",[],SQL Query
f1cc5fc4c2d7e41e0b9536dd,Tell me the name of the specimen test that patient 10022281 last received in their first hospital encounter?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}],SELECT specimen_test FROM patient_records WHERE patient_id = 10022281 AND encounter_number = 1 ORDER BY date_of_test DESC LIMIT 1
3831c2c777259f2c220dcceb,Tell me the type of blood of patient 13440?,,,SELECT blood_type FROM patients WHERE patient_id = 13440
fc73eadf00468623cbf19884,Tell me what the top five most commonly prescribed drugs are since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]",SQL Query Here
389610e48fedce18d3b1ef8d,"What are the four frequently ordered drugs for patients diagnosed with other and unspecified alcohol dependence, continuous previously in the same hospital visit, since 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, continuous' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,SELECT ... FROM ... WHERE ...
6b59462d8c8e0692f930ee62,What did patient 10020740 first have as output on 03/30/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-30' ORDER BY outputevents.charttime ASC LIMIT 1 )",[],"select o.output_name as first_output from (select output_name, visit_occurrence_id from procedure_occurrence po join procedure_output o on po.procedure_occurrence_id = o.procedure_occurrence_id where po.person_id = 10020740 and po.visit_start_date = '03/30/2100') as patient_output order by visit_occurrence_id, output_id limit 1"
9dea9102653c7bfb36386393,"How many days have passed since patient 10004733 got her first diagnosis of cerebral artery occlusion, unspecified with cerebral infarction on their current hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral artery occlusion, unspecified with cerebral infarction' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT DATEDIFF(CURDATE(), MIN(d.DTSTART)) AS days_since_first_diagnosis FROM DIAGNOSIS d JOIN VISIT v ON d.VISIT_ID = v.VISIT_ID WHERE d.DXCODE IN (SELECT DXCODE FROM DIAGNOSIS WHERE HADM_ID = (SELECT HADM_ID FROM VISIT WHERE PATIENT_ID = 10004733 AND ROW_ID = (SELECT MIN(ROW_ID) FROM DIAGNOSIS d2 JOIN VISIT v2 ON d2.VISIT_ID = v2.VISIT_ID WHERE d2.PATIENT_ID = 10004733 AND d2.DXCODE = '997.1' AND v2.HADM_ID = (SELECT HADM_ID FROM VISIT WHERE PATIENT_ID = 10004733 AND ROW_ID = (SELECT MAX(ROW_ID) FROM VISIT WHERE PATIENT_ID = 10004733)))) AND d.PATIENT_ID = 10004733 AND v.HADM_ID = (SELECT HADM_ID FROM VISIT WHERE PATIENT_ID = 10004733 AND ROW_ID = (SELECT MAX(ROW_ID) FROM VISIT WHERE PATIENT_ID = 10004733))) GROUP BY d.PATIENT_ID"
770ad5d0ecd285dc97b984b2,Is that patient 5849 has an appointment in another department?,,,SELECT COUNT(*) FROM patient_appointments WHERE patient_id = 5849 AND department_id != (SELECT department_id FROM patient_appointments WHERE patient_id = 5849 LIMIT 1)
d4bd03642b6b6c5ff9cd88ac,Tell me the average heart rate for patient 10006580's body since 08/13/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-13'",[{'AVG(chartevents.valuenum)': None}],SELECT AVG(heart_rate) FROM health_metrics WHERE patient_id = 10006580 AND timestamp > '2100-08-13 00:00:00' AND sensor_type = 'heart_rate' AND body_part = 'body';
96055c134a9e795b09937032,Are you letting me know if patient 14397 is subject to covid-19 testing?,,,"SELECT patient_id, covid_test_status FROM patient_records WHERE patient_id = 14397;"
cfb014c016bea7b3e220c08f,How many patients were present in the surgical intensive care unit (sicu) since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'surgical intensive care unit (sicu)' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT count(*) FROM `physionet-data.mimiciii_clinical.icustays` WHERE intime >= ""2100-01-01 21:00:00"";"
ea52341a69ca686cb059fc2c,Has there been any diagnosis that patient 10004733 has received in 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'",,SELECT DISTINCT diagnosis FROM diagnoses WHERE patient_id = '10004733' AND diagnosis_date >= '2100-01-01' AND diagnosis_date <= '2100-12-31'
5487ee77cca76c582ae0fd80,What was the first measurement of o2 saturation pulseoxymetry that patient 10022017 had on the first ICU stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],"select max(oximetry_datetime) as date, first_value(oximetry_value) over (order by oximetry_datetime) as o2_saturation from t_icu_patient_stay_oximetry where patient_id = '10022017' and icu_stay_id = '1'"
fccae88f01f7fd8906029a4f,What's the ward id patient 90165 can go to?,,,SELECT ward_id FROM patients_wards WHERE patient_id = 90165;
37fa4b05690e4fda0cc395bf,When was the first time patient 10038933 had a medication prescribed via the td route since 28 months ago?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'td' AND datetime(prescriptions.starttime) >= datetime(current_time,'-28 month') ORDER BY prescriptions.starttime ASC LIMIT 1",[],"SELECT MIN(START_DATE) FROM MEDICATION_ORDERS WHERE PATIENT_ID = 10038933 AND ROUTE = 'TD' AND START_DATE >= DATE_SUB(CURRENT_DATE, INTERVAL 28 MONTH)"
6bade51b85498f959d6a659c,How much did patient 10004235 weigh the first time it was measured in 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-03' ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(date) AS first_measurement_date, weight FROM patient_measurements WHERE patient_id = '10004235' AND date LIKE '03/21%' GROUP BY patient_id"
95a56ae5ea17a6e60f36afb6,Can you provide me with an example of how many operating rooms are available now?,,,SELECT COUNT(*) AS AvailableOperatingRooms FROM OperatingRoom WHERE Status = 'Available';
23b4c91212b33b3feec1624d,Calculate the number of patients who underwent a laboratory test for % hemoglobin a1c since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) AND strftime('%Y',labevents.charttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM laboratory_tests WHERE test_name = 'hemoglobin a1c' AND test_date >= '2100-01-01'
18134bb405cad581e0aaef9f,What is the cost of unspecified protein-calorie malnutrition diagnostic?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified protein-calorie malnutrition' ) ),,SELECT Cost FROM NutritionDiagnostics WHERE Condition = 'Unspecified Protein-Calorie Malnutrition' AND ServiceType = 'Diagnostic'
d18670a4c314b569054a32a3,"During the first hospital encounter, what was the monthly maximum dose of dextrose 5% for patient 10005909?","SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",[],select max(dosevalue) from medication_doses where patient_id=10005909 and drug_name='dextrose 5%' and start_date between date of first encounter and end date of first encounter
f111218b574bd10dcf361deb,What are the four most frequent procedures for patients who are in their 60 or above in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT Procedure, COUNT(*) AS Frequency FROM PatientRecords WHERE Age >= 60 AND Year = 2100 GROUP BY Procedure ORDER BY Frequency DESC LIMIT 4;"
de4256f2df1bf1aaa0eb15bb,"Give me the top three most commonly prescribed medications during the same hospital encounter to patients aged 50s after they were diagnosed with congestive heart failure, unspecified during this year.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT medication_name, COUNT(*) AS medication_count FROM prescriptions WHERE encounter_id IN (SELECT encounter_id FROM diagnoses WHERE diagnosis_code = 'ICD-10-Code-For-CHF-Unspecified' AND patient_age BETWEEN 50 AND 59 AND YEAR(diagnosis_date) = YEAR(CURDATE())) GROUP BY medication_name ORDER BY medication_count DESC LIMIT 3"
287474d13b646c19858f98f7,What was the name of the specimen that patient 10026255 received for the first time since 04/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'SPUTUM'}],"SELECT DISTINCT `t1`.`specimen` FROM `specimen_administration` AS `t1` INNER JOIN (SELECT `patient_id`, MAX(`start_time`) AS `Max` FROM `specimen_administration` WHERE `patient_id` = 10026255 GROUP BY `patient_id`) AS `t2` ON `t1`.`patient_id` = `t2`.`patient_id` AND `t1`.`start_time` = `t2`.`Max` WHERE `t1`.`patient_id` = 10026255 AND `t1`.`start_time` >= '04/2100'"
a3f40dc2c562eaeeb1b1acb1,What is the average total hospital cost for a patient diagnosed with family history of other specified malignant neoplasm?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of other specified malignant neoplasm' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT AVG(total_hospital_cost) FROM hospital_data WHERE diagnosis = 'Family history of other specified malignant neoplasm'
8527b64a6629ebc78cca2a01,"What are the three most commonly taken specimens for patients that received introduction of other thrombolytic into peripheral vein, percutaneous approach previously within 2 months in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into peripheral vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"select specimen_name, count(*) from (select specimen_name from LAB_EVENTS l where l.EVENT_TYPE in ('specimen taken') and l.EVENT_NAME in (select distinct m.EVENT_NAME from LAB_EVENTS m where m.EVENT_TYPE in ('medication given') and m.EVENT_NAME like '%thrombolytic%' and m.LOCATION in ('peripheral vein') and m.EVENT_DESCRIPTION like '%introduction%') and l.PATIENT_ID in (select distinct n.PATIENT_ID from LAB_EVENTS n where n.EVENT_TYPE in ('medication given') and n.EVENT_NAME like '%thrombolytic%' and n.LOCATION in ('peripheral vein') and n.EVENT_DESCRIPTION like '%introduction%' and n.EVENT_DATETIME between date_sub('2100-01-01', interval 2 month) and '2100-01-01')) as subquery group by specimen_name order by count(*) desc limit 3"
1fae11bc2be174f27630c683,Was patient 10026255 to the emergency room in the last year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM patient_visits WHERE patient_id = 10026255 AND visit_type = 'emergency' AND visit_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
b89ae914fde1da12628b1901,What are the four most common diagnoses of patients in their 40s?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patients WHERE age BETWEEN 40 AND 49 GROUP BY diagnosis ORDER BY frequency DESC LIMIT 4"
1f76d064d52e32276438fbaf,What are the various ways to consume cinacalcet?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'cinacalcet',[{'route': 'ORAL'}],SELECT DISTINCT FORM_OF_ADMINISTRATION FROM DRUG_ADMINISTRATION_METHODS WHERE MEDICATION_NAME = 'cinacalcet'
bf14cf17da2349955ab8ea66,"Since 16 months ago, what was the first recorded weight for patient 10038999?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-16 month') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT TOP 1 recorded_weight FROM patient_records WHERE patient_id = 10038999 AND record_date >= DATEADD(MONTH, -16, GETDATE()) ORDER BY record_date ASC"
920ad0d7946eb3abca368599,What were the most frequent diagnoses among the top three this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM diagnoses WHERE year = 2023 GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3"
81f790401d1b25c6eebdd607,What was the total of pantoprazole patient 10020944 had been prescribed in 03/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'pantoprazole' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03'",[{'SUM(prescriptions.dose_val_rx)': None}],brackets
b0e746871a7c5eea41ef06b4,Inform me about the total amount of patient 10006580's input since 05/02/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-02'",[{'SUM(inputevents.totalamount)': 5149.0}],SELECT SUM(amount) FROM medical_billing WHERE patient_id = '10006580' AND date >= '2100-05-02'
68d2cf8d2fa30727fc51e480,Tell me the five most frequent medical diagnoses throughout this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM patient_records WHERE date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
00144320e5ae44ed871c5db7,Show me the top three most frequent events that took place.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT event_name, COUNT(*) AS event_count FROM events GROUP BY event_name ORDER BY event_count DESC LIMIT 3;"
77b6bd619a1302c0e9f16e66,What was the drug that was last prescribed to patient 10039708 via the ih route since 08/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND prescriptions.route = 'ih' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1",[],select ...
8511198e010ebb4b33fcc4e3,What was the aggregate input volume for patient 10007058 since 38 days ago?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND datetime(inputevents.starttime) >= datetime(current_time,'-38 day')",[{'SUM(inputevents.totalamount)': 10975.0}],select sum(input) from records where patientid = 10007058 and inputdate >= current_date - interval '38 days' group by patientid
d83e90e0fe19b6017850565d,What is the recorded sex of patient 10020306?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020306,[{'gender': 'F'}],SELECT * FROM patients WHERE patient_id = 10020306
4637ee6f3a563e19535756a3,What were the four most frequently given diagnoses for patients who received partial hepatectomy previously within 2 months this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,
d1177dfd4cf0c6b2da2111a1,Give me the total amount of nacl 0.9% given to patient 10039831 since 03/03/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-03'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(quantity) FROM administrations WHERE patient_id = 10039831 AND substance = 'NaCl 0.9%' AND date >= '2100-03-03'
7d3ded586776af8013c94a0f,"For patient 10018081, how many days have passed since the last diagnosis with urinary tract infection, site not specified on this hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"[SELECT DATEDIFF(day, MAX(DiagnosisDate), GETDATE()) AS DaysSinceLastUTI"
6975f69a4cfb65e6179fba81,When did patient 10007795 receive the last mrsa screen microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(date) as last_mrsa_screen_date FROM microbiology_tests WHERE patient_id = 10007795 AND test_type = 'mrsa screen' AND date > '2100-03-01'
896c8f2f1440f307d4f71409,How many patients were administered ipratropium bromide neb?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ipratropium bromide neb' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT PatientID) FROM PatientRecords WHERE Medication = 'ipratropium bromide neb'
e17c8e6fc29a5b5e084734c4,What is the change in the medication of patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"SELECT `patient_id`, `medication`, `date`, `dosage`, `change` FROM `patient_medication_history` WHERE `patient_id` = 10018081 AND `date` IN (CURDATE(), CURDATE() - INTERVAL 1 DAY) ORDER BY `date` DESC LIMIT 2;"
d84b738e8882f159cbf1debf,"Among patients who were diagnosed with postinflammatory pulmonary fibrosis, what were the top four most common microbiology tests conducted during the same month in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 test_type, COUNT(test_type) as frequency FROM microbiology_tests WHERE patient_id IN (SELECT patient_id FROM diagnoses WHERE condition = 'postinflammatory pulmonary fibrosis' AND diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31') GROUP BY test_type ORDER BY frequency DESC"
afce68a2f7090e5fa3220930,What was the insurance for patient 10040025 during the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],SELECT ... FROM ... WHERE ... LIMIT ...
1cfbdedba5f3d901870e5290,What's the percentile of 18.1 in a white blood cells lab test at the same age as patient 10026354 during the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 18.1",,select percentile_cont(0.5) within group (order by lab_result) from lab_tests where lab_name='white blood cells' and patient_id=10026354 and visit_number=1 and age= (select age from patients where patient_id=10026354 and visit_number=1)
dc9b3236056266b458fff17f,How many hours has it been since patient 10004733 stayed in the careunit medical/surgical intensive care unit (micu/sicu) during this hospital visit for the first time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1",[],"[select timestampdiff(hour, first_stay_in_careunit_date_time, current_timestamp()) as hours_since_first_stay_in_careunit from"
095a491640c35f9a56195a9d,"Among patients who took central venous catheter placement with guidance since 1 year ago, what are the top three most frequent diagnoses that followed within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patient_diagnoses INNER JOIN procedures ON patient_diagnoses.patient_id = procedures.patient_id WHERE procedures.type = 'central venous catheter placement with guidance' AND procedures.date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND patient_diagnoses.date BETWEEN procedures.date AND DATE_ADD(procedures.date, INTERVAL 2 MONTH) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3;"
d8faa21afb298080c233542b,How many gemfibrozil prescriptions were administered?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil',[{'COUNT(*)': 0}],select count(*) from prescriptions where drug_name = 'gemfibrozil'
3d5c60968afcd59588d2af3b,What was the name of the medication which patient 10025463 was prescribed within 2 days after receiving other electric countershock of heart since 11/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-11' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT medication_name FROM prescriptions WHERE patient_id = 10025463 AND medication_time > (SELECT procedure_time FROM procedures WHERE procedure_name = 'electric countershock of heart' AND procedure_time >= '11/2100') AND DATEDIFF(day, procedure_time, medication_time) <= 2"
6f3c178cf388c0f60f63cd4a,When did patient 10029484 receive a ptt lab test on the first occasion?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) ORDER BY labevents.charttime ASC LIMIT 1,[],SELECT MIN(test_date) FROM lab_tests WHERE patient_id = '10029484' AND test_name = 'PTT'
3f09bed66cb7c82a92b7dcb0,Could you retrieve the top three most common outputs?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT output, COUNT(*) as frequency FROM output_table GROUP BY output ORDER BY frequency DESC LIMIT 3;"
837051daccd7778c8114f640,What was the admission type when patient 10008287 last entered the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10008287 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1",[],SELECT admission_type FROM ADMISSIONS WHERE patient_id = '10008287' ORDER BY admission_date DESC LIMIT 1
be97d5c806f9525cdc91ee8c,What was the name of the medication that patient 10040025 was prescribed in the same hospital visit after receiving a arteriography of renal arteries procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of renal arteries' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,SELECT medication_name FROM prescriptions WHERE patient_id=10040025 AND visit_date > (SELECT visit_date FROM procedures WHERE patient_id=10040025 AND procedure_name='Arteriography of renal arteries') ORDER BY visit_date ASC LIMIT 1
5c31e3d97360a4d0dc136eba,What was the five most common microbiology test conducted in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",[],"SELECT TOP 5 TestName, COUNT(*) as TestCount FROM MicrobiologyTests WHERE Year = 2100 GROUP BY TestName ORDER BY TestCount DESC;"
6b87c27e7eaa3734d66015e0,How many medications were prescribed in 04/this year to patient 10012853?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)': 0}],"SELECT COUNT(DISTINCT medication) AS number_of_medications FROM prescriptions WHERE patient_id = 10012853 AND DATE_FORMAT(prescription_date, '%Y-%m') = '2023-04'"
ea58b388c8e0a4f382814580,When did patient 10007818 first have their maximum mean blood pressure on 07/07/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '07-07' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],SELECT MIN(date) AS First_Max_BP_Date FROM blood_pressure_readings WHERE patient_id = 10007818 AND date BETWEEN '2023-07-01' AND '2023-07-31' AND systolic_bp = (SELECT MAX(systolic_bp) FROM blood_pressure_readings WHERE patient_id = 10007818 AND date BETWEEN '2023-07-01' AND '2023-07-31');
bfff3b930069caa7a3444608,When was patient 10006053's respiratory rate last measured greater than 17.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 17.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT MAX(measurement_date) FROM patient_measurements WHERE patient_id = 10006053 AND respiratory_rate > 17.0
d768135cc45a97c5f9aa32bc,"Since 03/05/2100, when did patient 10008454 have their first input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-05' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2110-11-30 18:15:00'}],SELECT MIN(event_date) as first_input_date FROM patient_input_events WHERE patient_id = 10008454 AND event_date >= '03/05/2100'
e0cf2f53e348a811ec32082d,What was the insurance for patient 10016150 during their first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Medicare'}],SELECT insurance FROM encounters WHERE patient_id = 10016150 AND encounter_number = 1;
bc354ef513b2215446177f31,Count the number of hospital visits patient 10038933 had during the last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10038933 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],"SELECT COUNT(*) AS visit_count FROM visits WHERE patient_id = 10038933 AND visit_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW()"
03cc245c1d997582959cd48a,What is the average monthly number of cases for other specified coagulation defects since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified coagulation defects' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,"SELECT AVG(cases) AS average_monthly_cases FROM coagulation_defects WHERE defect_type = 'other specified coagulation defects' AND date_reported >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY YEAR(date_reported), MONTH(date_reported)"
1a52e19cc4c2bea04555d722,What was patient 10035185's yearly maximum weight?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y',chartevents.charttime)",[],"SELECT MAX(weight) FROM patient_records WHERE patient_id = '10035185' AND DATEPART(year, record_date) = '2020'"
bc7d9cca70c0c64f7dd707af,What was the total sertraline dose that patient 10016742 has been prescribed in 08/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug = 'sertraline' AND strftime('%Y-%m',prescriptions.starttime) = '2100-08'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(dosage) FROM prescriptions WHERE patient_id = '10016742' AND medication = 'sertraline' AND EXTRACT(MONTH FROM prescription_date) = 08 AND EXTRACT(YEAR FROM prescription_date) = 2100;
ab750c2c23f2234be8a906a3,"How many hours has it been since patient 10021487's first cardiac complications, not elsewhere classified diagnosis in the current hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac complications, not elsewhere classified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,
9f9170a12486ac9447866fbe,Could you show me the top five most common microbiology tests throughout this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",[],"SELECT test_name, COUNT(*) as frequency FROM microbiology_tests WHERE test_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY test_name ORDER BY frequency DESC LIMIT 5"
16e880e54314b4d23201e4d1,Retrieve the top three most common lab tests.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",SQL Query
3783e47702fc97ed7cdea710,Can you provide the maximum monthly number of patients diagnosed with attention deficit disorder with hyperactivity?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,SELECT MAX(PatientCount) FROM MonthlyDiagnoses WHERE Disorder = 'attention deficit disorder with hyperactivity'
f1e84b550c51a00e780daaa4,"What are the three most frequently administered laboratory tests for patients previously diagnosed with nontoxic uninodular goiter within the same hospital visit, in 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nontoxic uninodular goiter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT lab_test_name, COUNT(*) AS frequency FROM laboratory_tests WHERE visit_date BETWEEN '2100-01-01' AND '2100-12-31' AND patient_diagnosis = 'nontoxic uninodular goiter' GROUP BY lab_test_name ORDER BY frequency DESC LIMIT 3"
115e3caf13dbeb8dd223df9f,How many patients were discharged from hospitals in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) = '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(patient_id) FROM discharges WHERE discharge_year = 2100
a803b49ece53f378a4fcf0d6,What is the maximum total cost of a hospital stay involving closed fracture of four ribs in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of four ribs' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(TotalCost) AS MaximumTotalCost FROM HospitalStays WHERE DiagnosisCode = 'S22.42XA' AND YEAR(AdmissionDate) = 2100 AND DischargeDate IS NOT NULL;
c85d0450240f7e339aaec76c,Did patient 10021666 have lab testing in 03/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'",[{'COUNT(*)>0': 0}],SELECT * FROM lab_tests WHERE patient_id = '10021666' AND test_date LIKE '03/2100%'
7fd810ebd8c88d468eab802e,Has patient 10006053 received a laboratory test for mesothelial cell since 03/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cell' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'",[{'COUNT(*)>0': 0}],"SELECT DISTINCT TestName, TestResult, TestDate FROM PatientTests WHERE PatientID = 10006053 AND TestName LIKE '%mesothelial cell%' AND TestDate >= '2100-03-01'"
799e8f8735eda5e3dfa8855f,"What are the four most commonly prescribed medications for patients diagnosed with candidiasis of mouth previously within the same hospital visit, during this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'candidiasis of mouth' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 medication_name, COUNT(medication_name) as frequency FROM prescriptions WHERE diagnosis = 'candidiasis of mouth' AND visit_date BETWEEN DATEADD(year, -1, GETDATE()) AND GETDATE() GROUP BY medication_name ORDER BY frequency DESC"
c13460734de88497b6d17501,How many people were diagnosed with acute kidney failure with lesion of tubular necrosis since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute kidney failure with lesion of tubular necrosis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,SQL Query
5183db2bbd72b5cf7d8b5c0c,When were the drugs ketorolac and acetaminophen iv prescribed to patient 10021118 for the first time this month at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ketorolac' AND admissions.subject_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen iv' AND admissions.subject_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],
fe0907fe6e75c814af68b01f,Has any organism been found in patient 10038999's last microbiological immunology (cmv) test since 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'immunology (cmv)' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y',microbiologyevents.charttime) >= '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],select distinct organism from microbiological_immunology where patient_id=10038999 and test_name='cmv' and test_date > '2100-01-01' and organism is not null
5075b95436488f53e5f7976e,"Was patient 10007818 given a test on potassium, urine on the first hospital stay?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )",[{'COUNT(*)>0': 0}],SELECT * FROM `laboratoryevents` WHERE `patientunitstayid` = 10007818 AND `labtype` = 'potassium' AND `sample` = 'urine' AND `stay` = 1 AND `labresult` IS NOT NULL
cc2dcf3bb997c63533f8349f,"What was the drug that patient 10021118 prescribed for within 2 days after the procedure of bypass coronary artery, two arteries from coronary artery, open approach since 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"select drg from drg where patient_id = 10021118 and procedure = 'bypass coronary artery, two arteries from coronary artery, open approach' and date_diff('date', '03/2100', 'date') <= 2;"
e4b5f1fc800b0d54f32ed37b,Tell me the minimum total hospital cost that includes benign neoplasm of cerebral meninges in 2100.,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'benign neoplasm of cerebral meninges' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,select min(total_hospital_cost) from `physionet-data.mimiciii_hospitalcosts` where `icd9_code` = '193' and year_of_admission = '2100'
f8334a7c23e689cadd23c209,Was patient 10008454 administered any solution during the first hospital visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM visit v JOIN solution s ON v.visit_id = s.visit_id WHERE v.patient_id = '10008454' AND v.visit_number = 1
b3f9074de167c69e1b75d061,Has patient 10037928 in 11/this year been given a urea nitrogen lab test?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '11'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM lab_tests WHERE patient_id = 10037928 AND test_name = 'Urea Nitrogen' AND test_date BETWEEN '2023-11-01' AND '2023-11-30'
3310a57f349b527861680281,"What is the price of the drug, finasteride?",SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'finasteride' ),,SELECT price FROM drugs WHERE name = 'finasteride'
563951219388e9d8f1ba0f30,How many days have passed since last time that patient 10004733 stayed in careunit neurology in their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1",[],"SELECT DATEDIFF(CURRENT_DATE, MAX(admission_date)) FROM careunit_stays WHERE patient_id = '10004733' AND careunit = 'neurology' AND visit_id = (SELECT MAX(visit_id) FROM careunit_stays WHERE patient_id = '10004733')"
3ac2379c5a6246bfa08fe92d,What was the amount of void output patient 10001217 had on 12/04/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-04'",[{'SUM(outputevents.value)': None}],SELECT amount_of_void_output FROM patient_records WHERE patient_id = '10001217' AND void_output_date = '2023-04-12'
c6666ef9e4ba2cde6ec58824,Give me the count of diagnostic ultrasound of abdomen and retroperitoneum procedures that occurred.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of abdomen and retroperitoneum' ),[{'COUNT(*)': 0}],procedure_concept_id IN (SELECT concept_id FROM concept WHERE concept_code LIKE '3115-%') AND procedure_type_concept_id = 38000278
c7de791a9a6825a9859e12f1,Could you tell me the name of the drug prescribed to patient 10025463 within the same hospital visit after the cardiac mapping procedure since 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"select distinct P2.prescribed_drug_name from patient_visit PV, prescribed_drug P2 where PV.patient_id = 10025463 and PV.visit_id = P2.visit_id and PV.hospital_id = P2.hospital_id and PV.procedure_name = 'cardiac_mapping' and PV.visit_date > '08/2100' and PV.visit_id > (select visit_id from patient_visit where patient_id = 10025463 and procedure_name = 'cardiac_mapping' and visit_date > '08/2100') order by PV.visit_date, PV.visit_id;"
db408655e01275e4bcc8c7bc,Is the patient 10021666 a male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10021666,[{'gender': 'M'}],"SELECT patient_id, gender FROM patients WHERE patient_id = '10021666'"
0d68d613cbc5bfb69833795a,Please tell me the sex of patient 10026406.,SELECT patients.gender FROM patients WHERE patients.subject_id = 10026406,[{'gender': 'M'}],SELECT sex FROM patient WHERE patient_id = 10026406
013f12f8af555d68080086d8,When was the first input time for patient 10011398 since 11/23/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-23' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2146-12-15 12:30:00'}],SELECT MIN(input_time) FROM patient_records WHERE patient_id = '10011398' AND input_time > '11/23/2100'
a5e4283c5899fd833228b799,What are the five most common laboratory tests undertaken by patients within the same month following a diagnosis of alcohol withdrawal since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol withdrawal' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT lab_test_name, COUNT(*) AS test_count FROM laboratory_tests INNER JOIN patient_diagnoses ON laboratory_tests.patient_id = patient_diagnoses.patient_id WHERE patient_diagnoses.diagnosis = 'alcohol withdrawal' AND laboratory_tests.test_date BETWEEN patient_diagnoses.diagnosis_date AND DATE_ADD(patient_diagnoses.diagnosis_date, INTERVAL 1 MONTH) AND patient_diagnoses.diagnosis_date >= '2100-01-01' GROUP BY lab_test_name ORDER BY test_count DESC LIMIT 5"
498d2f4e14ef15f20bc02818,What is the cost for a drug named vancomycin?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' ),,SELECT cost FROM drugs WHERE name = 'vancomycin'
1b86b72d44dcdc58ba833804,What was the first time patient 10003400 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003400 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[],"SELECT MIN(EDOD) FROM MIMIC_EDW.CHARTEVENTS WHERE SUBJECT_ID = 10003400 AND ITEMID IN (211, 225, 226, 227) AND VALUE IS NOT NULL;"
ac5dd63a7a7e12dbdb8de9e2,Was patient 10005817 given any sort of diagnosis on the first hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],[SELECT 'Yes' AS DiagnosisGiven
8cbc6f9057443ffd3cb11a50,How much does humalog cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'humalog' ),,"SELECT ""Price"" FROM ""Insulin"" WHERE ""Type""='Humalog' LIMIT 1"
d1d3935b2877cebd687efc35,How much difference is there in phosphate levels among patient 10015931 second measured on the first hospital visit compared to the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT (second_measurement_phosphate - first_measurement_phosphate) AS phosphate_difference FROM patient_measurements WHERE patient_id = 10015931 AND measurement_order = 'second' AND visit_number = 1
cd5489d01e1749510fc86424,How much does the ph change in patient 10021666 last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","[SELECT visit_id, first.value as ""first value"", last.value as ""last value"", (last.value - first.value) as ""difference"" FROM"
93ee1ffd46ebada0f537dc47,Give me the top four most frequent lab tests that patients were given after being diagnosed with need for prophylactic vaccination and inoculation against influenza within the same hospital visit since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'need for prophylactic vaccination and inoculation against influenza' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT lab_test, COUNT(*) AS frequency FROM patient_records WHERE diagnosis_code = 'prophylactic vaccination and inoculation against influenza' AND visit_date > '2100-01-01' GROUP BY lab_test ORDER BY frequency DESC LIMIT 4"
86ab734fd86c4c14b393eecc,Tell me about the three most common specimens tested in 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",[],"SELECT specimen_id, COUNT(*) AS test_count FROM specimens_tested WHERE testing_year = 2100 GROUP BY specimen_id ORDER BY test_count DESC LIMIT 3"
85fc1e7aa9384773068ded3c,What is the percentile of 3.6 for a creatinine test given the same age as patient 10004733 in the current hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 3.6",,"SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY result_value) OVER (PARTITION BY age, lab_name) AS median_creatinine FROM lab_tests WHERE result_value = 3.6 AND lab_name = 'CREATININE' AND patient_id = (SELECT age FROM patients WHERE patient_id = 10004733)"
081ba7feccd490013f102984,What was the total ondansetron dose prescribed for patient 10001725 on their last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'ondansetron',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(dose) FROM medication_prescriptions WHERE patient_id = '10001725' AND medication_name = 'ondansetron' AND visit_date = (SELECT MAX(visit_date) FROM hospital_visits WHERE patient_id = '10001725')
fdd3a31fb9173995b776c5b2,Tell me the average SaO2 of patient 10021938 on last month/14.,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '14'",[{'AVG(chartevents.valuenum)': None}],"SELECT AVG(sao2) FROM patient_data WHERE patient_id = 10021938 AND date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND CURDATE();"
a4d744501a505ad53e491d0c,How much does a medication called ezetimibe cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ezetimibe' ),,SELECT cost FROM medications WHERE name = 'ezetimibe'
ea8b16320ebc9e5ee3d92c14,"Since 03/2100, what was the last drug that patient 10012853 was prescribed through the iv route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 drug FROM prescriptions WHERE patient_id = 10012853 AND route = 'IV' AND date_prescribed >= '03/21/2000' ORDER BY date_prescribed DESC
903e1faa90ee9926eebe6781,"Today compared to yesterday, what new medication does patient 10018081's prescription include?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],
d7fb401aec234c8c77430b13,"How much is the average total hospital bill for a visit that involves a cholesterol, pleural test since 1 year ago?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, pleural' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT AVG(total_bill) AS average_total_bill FROM hospital_visits WHERE test_type IN ('cholesterol', 'pleural') AND visit_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
031f4556ea1fe707a94f58bb,When did patient 10007818 receive a serology/blood microbiology test last?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'serology/blood' ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],"SELECT MAX(TestDate) FROM patient_tests WHERE PatientID = '10007818' AND TestType IN ('Serology', 'Blood Microbiology')"
dac5c6aaac6b57cdc328694e,What are the consumption methods of glipizide xl?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'glipizide xl',[],"SELECT ""consumption method"" FROM `meds` WHERE ""med_name"" = 'Glipizide XL'"
d468712401b6ab1b27a362ee,Can you tell me the cost of other electric countershock of heart?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) ),,SELECT cost FROM medical_procedures WHERE name = 'other electric countershock of heart'
ab4e1e2da052427fa2ed9d07,"What is the maximum total hospital cost, which includes vaginal enterocele, congenital or acquired since 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'vaginal enterocele, congenital or acquired' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_hospital_cost) FROM hospital_admissions WHERE procedure_code IN (SELECT procedure_code FROM procedures WHERE description LIKE '%vaginal enterocele%' AND (description LIKE '%congenital%' OR description LIKE '%acquired%')) AND admission_date >= '2100-01-01'
54b2b03726835ece7168728e,What was the first time patient 10021938 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10021938 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",[],SELECT MIN(ED_1.DischargeDateTime) FROM ED_1 WHERE ED_1.PatientID = 10021938
8da39f47f61d4bd9b47d1f6e,How many patients were prescribed the drug multivitamins w/minerals since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'multivitamins w/minerals' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patid) FROM drug_exposure WHERE drug_name = 'multivitamins w/minerals' AND start_date >= DATEADD(year, -1, GETDATE())"
3ac8f2ef698c9eee139d3ece,"What are the four most typically ordered procedures for patients previously diagnosed with calculus of kidney, which took place within the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'calculus of kidney' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT ProcedureType, COUNT(*) AS Frequency FROM Procedures WHERE Diagnosis = 'calculus of kidney' AND HospitalVisitID IN (SELECT HospitalVisitID FROM Procedures GROUP BY HospitalVisitID HAVING COUNT(DISTINCT ProcedureType) >= 2) GROUP BY ProcedureType ORDER BY Frequency DESC LIMIT 4"
eb6a1301664df928ab91d795,What were the first ptt values of patient 10039831?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) ORDER BY labevents.charttime ASC LIMIT 1,[],SELECT ptt FROM lab_tests WHERE patient_id = 10039831 ORDER BY test_date ASC LIMIT 1;
cd81a8fa98d2679535f3372d,How many times did patient 10023239 go to the hospital this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023239 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SQL Query
c1bb80af8e65bc3a342a8f5f,"Can you find the three most frequent drugs that were prescribed within 2 months after a swelling, mass, or lump in head and neck diagnosis was given since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'swelling, mass, or lump in head and neck' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,SQLQuery
d2963971f5b061724d770e2c,When did patient 10035185 have a last ptt laboratory test in the first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,[],
d6c396b04821fd366efe7a49,Show me the yearly minimum weight of patient 10027602 since 12/2100.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-12' GROUP BY strftime('%Y',chartevents.charttime)",[],"SELECT YEAR(date) AS Year, MIN(weight) AS MinWeight FROM patient_records WHERE patient_id = '10027602' AND date >= '12/2100' GROUP BY YEAR(date);"
055d52386664ba496c850da1,Can you tell me the cost for the procedure called fluoroscopy of multiple coronary arteries using other contrast?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) ),,SELECT ProcedureCost FROM Procedures WHERE ProcedureName = 'fluoroscopy of multiple coronary arteries using other contrast'
36c7455252fe5e86cee2f9ff,Could you count the number of times patient 10016810 visited the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10016810 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SQL Query Here
b4ebdda80c6329d3a8363c7e,Do you know of the drug that is not to be administered during the refus lmb/lmbsac pst/pst procedure?,,,"SELECT drug_name FROM drug_procedure WHERE procedure_name IN ('refus lmb', 'lmbsac pst', 'pst') AND is_administered = FALSE;"
4972d1004d8c1ef2af211806,"Tell me the minimum total cost of a hospital that involved dysphagia, unspecified since 2100.","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphagia, unspecified' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT MIN(total_cost) FROM hospital_discharge_summary WHERE diagnosis LIKE '%dysphagia, unspecified%' AND admission_date >= '2100-01-01'"
cb28a22dfa640e40700d6ace,What were the top five most common microbiology tests for patients who were previously diagnosed with encounter for attention to other artificial openings of digestive tract in the same hospital encounter?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for attention to other artificial openings of digestive tract' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"SELECT test, COUNT(*) AS frequency FROM microbiology_tests mt JOIN patient_records pr ON mt.patient_id = pr.patient_id WHERE pr.previous_diagnosis = 'encounter for attention to other artificial openings of digestive tract' AND mt.hospital_encounter_id = pr.hospital_encounter_id GROUP BY test ORDER BY frequency DESC LIMIT 5"
6f95b08ff006a4983b0050f6,What was the admission type for patient 10027445's last admission to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10027445 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1",[],SELECT `admission_type` FROM `admissions` WHERE `patient_id` = 10027445 ORDER BY `admission_date` DESC LIMIT 1
04da33946099754d422c8015,"Since 16 months ago, what was the monthly maximum dose of packed red blood cells for patient 10021487?","SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime) >= datetime(current_time,'-16 month') GROUP BY strftime('%Y-%m',inputevents.starttime)",[],"SELECT DATE_FORMAT(`admission_date`, '%Y-%m') AS `month`, MAX(`packed_red_blood_cells_dose`) AS `max_dose` FROM `patient_records` WHERE `patient_id` = 10021487 AND `admission_date` >= DATE_SUB(CURRENT_DATE, INTERVAL 16 MONTH) GROUP BY `month`;"
1459009171aa5baa3803a221,What's the monthly average weight of patient 10005817 during their first hospital visit?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT MONTH(first_admitted_hospital_datetime) as month, AVG(weight) as average_weight FROM patient_data WHERE patient_id = '10005817' GROUP BY month;"
ded63a32010e347a3a99d26d,Ist patient 5142 subject to covid-19 testing,,,select * from covid_19_testing where patient_id = 5142;
880554dbb2de7644801cbf6e,Can you tell me the four most frequent diagnoses since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patient_records WHERE date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 4"
56ed63e758861043fc857932,What was the first diagnosis for patient 10017492 since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",,"[SELECT MIN(diagnosis_date) AS first_diagnosis_date, diagnosis"
f2147dbedaab703750fcd937,Do you believe patient 97395 has received any additional fluid received in blood culture bottles test?,,,"[SELECT * FROM (SELECT patient_id, MAX(test_date) AS latest_test_date FROM blood_culture WHERE patient_id = 97395) AS latest_test"
2694b78056d19869dc331d60,What was the name of that output that patient 10021938 first had since 01/15/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-15' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Void'}],SELECT top 1 o.output_name FROM orders o WHERE o.patient_id = '10021938' AND o.output_date >= '2100-01-15' ORDER BY o.output_date ASC;
83d85a4fb249a66c71ea4700,Could you tell me the gender of patient 10004733?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10004733,[{'gender': 'M'}],SELECT sex FROM patient WHERE patient_id = '10004733'
8a498aa27f9b433e78ba0a00,What is the type of blood that patient 60136 has?,,,SELECT blood_type FROM patients WHERE patient_id = 60136;
2b9a9c55cdacdabc16a4f556,When last did patient 10008454 have the minimum systolic blood pressure since 38 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-38 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],SELECT MAX(visit_date) AS last_lowest_systolic_bp FROM blood_pressure WHERE patient_id = 10008454 AND visit_date >= NOW() - INTERVAL 38 DAY AND systolic_bp = (SELECT MIN(systolic_bp) FROM blood_pressure WHERE patient_id = 10008454 AND visit_date >= NOW() - INTERVAL 38 DAY);
efe02e55b9988af366a8030b,"For patients previously diagnosed with migraine with aura, without mention of intractable migraine without mention of status migrainosus , what were the three most frequent specimens tested within 2 months afterward?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'migraine with aura, without mention of intractable migraine without mention of status migrainosus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 specimen_type, COUNT(*) AS frequency FROM patient_tests"
5d890144fe08088c541a7324,What was the last prescription for patient 10003400 since 01/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'HYDROmorphone (Dilaudid)'}],SELECT TOP 1 * FROM prescriptions WHERE patient_id = '10003400' AND date_prescribed >= '01012000' ORDER BY date_prescribed DESC
e277a867e388255263046134,"Tell me the average total cost of a hospital visit involving a phosphate, urine lab test?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate, urine' ) ) GROUP BY cost.hadm_id ) AS T1",,"SELECT AVG(""Total Cost"") FROM hospital_visits WHERE ""Procedure"" = 'Urine Lab Test' AND ""Test"" = 'Phosphate'"
00beff4406c2ee10ac9621fe,"Did patient 10040025 get a prescription for clonidine patch 0.2 mg/24 hr, atorvastatin, or prasugrel in their first hospital visit?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'clonidine patch 0.2 mg/24 hr', 'atorvastatin', 'prasugrel' )",[{'COUNT(*)>0': 0}],"SELECT ... WHERE patient_id = '10040025' AND (medication IN ('clonidine patch 0.2 mg/24 hr', 'atorvastatin', 'prasugrel')) AND visit_number = 1"
ccf873476d02f981c461b5c0,Can you tell me the total amount of neutra-phos that patient 10004422 has been prescribed in 01/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND prescriptions.drug = 'neutra-phos' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '01'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(`medication`) AS `total_neutraphos` FROM `prescriptions` WHERE `patient_id` = '10004422' AND `medication` = 'neutra-phos' AND `date` >= '2023-01-01';
e280cc138d720a1fb7cde282,What was the last value of patient 10039831's lab test for platelet count in 12/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT lab_test_name, value, date FROM lab_tests WHERE patient_id = '10039831' AND lab_test_name = 'platelet count' AND YEAR(date) = YEAR(CURDATE()) AND MONTH(date) = 12 ORDER BY date DESC LIMIT 1"
898a1010e152158643c29ae2,Work out the total amount of input patient 10038999 received since 04/08/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-08'",[{'SUM(inputevents.totalamount)': 36935.0}],SELECT SUM(amount) as total_input FROM patient_input WHERE patient_id = '10038999' AND date >= '2100-04-08'
b0e33df4abb89b92c708cf89,Tell me the icd-11 code for fetal/neonatal jaund nos in icd-10?,,,SELECT code11 FROM translation WHERE code10 = 'P59.9'
9f59f271601c4130d2301520,What was the weight of patient 10016742 first since 14 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT * FROM (SELECT ROW_NUMBER() OVER (PARTITION BY subject_id ORDER BY study_date DESC) as rn, * FROM weight WHERE subject_id = 10016742 AND value_as_number IS NOT NULL) AS ranked_weights WHERE rn = 1 AND (study_date >= DATE_SUB(CURDATE(), INTERVAL 14 MONTH))"
754791666185be2763502622,When has patient 10016742 last had the epithelial cells maximum value in 07/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND strftime('%Y-%m',labevents.charttime) = '2100-07' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],"SELECT MAX(epithelial_cells_value) as MaxEpithelialCells, date FROM patient_records WHERE patient_id = '10016742' AND date LIKE '07/2100%' GROUP BY date ORDER BY date DESC LIMIT 1"
296dc134fad4a300a3e8605b,"What is the minimum total cost at a hospital including a glucose, ascites laboratory test in 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose, ascites' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_cost) AS minimum_cost FROM hospital WHERE date_of_visit = 2100 AND (glucose_lab_test IS NOT NULL OR ascites_lab_test IS NOT NULL)
d37cc2f82fab01c5b66069e1,What was the last time of input for patient 10039831 since 04/08/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-08' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2115-12-30 13:05:00'}],SELECT MAX(Time) AS LastInputTime FROM MedicalRecords WHERE PatientID = '10039831' AND Time >= '2100-08-04'
1c0fc6d294954a3775cc36df,Does patient 23436 have a appointment at another department?,,,SELECT EXISTS(SELECT 1 FROM patient_appointment WHERE patient_id = 23436 AND department_id <> (SELECT department_id FROM patient_department WHERE patient_id = 23436 LIMIT 1))
98d4523a1fa9d300734adcb5,How much did patient 10020944 weigh when measured for the last time since 28 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-28 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],select max(med_bmi) from med_bmi where patient_num = 10020944 and med_bmi_date >= (current_date - interval '28' month)
df2943ec147894b6e5bfbe4f,What is dr. caron's outpatient schedule today?,,,SELECT * FROM outpatient_schedule WHERE physician='dr. caron' AND appointment_date=CURRENT_DATE;
f5565e8dca592ac7658c9ee6,What was patient 10004720's daily average value of body weight in 2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],SELECT AVG(body_weight) AS daily_average_weight FROM patient_measurements WHERE patient_id = '10004720' AND measurement_date BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY measurement_date;
4d08394da0f7341675850575,When did patient 10007795 first leave the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10007795 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2136-05-02 16:35:00'}],SELECT MIN(DischargeDate) FROM HospitalRecords WHERE PatientID = '10007795' AND DischargeDate IS NOT NULL
4483be10999dcd201f1ef4fe,What was the first time patient 10036156 was prescribed a medication using the po/ng route in 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(prescribedDateTime) FROM prescriptions WHERE patientID='10036156' AND route='po/ng' AND MONTH(prescribedDateTime) = 7 AND YEAR(prescribedDateTime) = 2100
07ee97c7d111eb378921826a,What is the minimum total cost of the hospital visits which include the medicine named fluticasone propionate 110mcg in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fluticasone propionate 110mcg' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(Total_Cost) FROM (SELECT SUM(Total_Cost) as Total_Cost FROM Hospital_Visits WHERE Visit_Date BETWEEN '2000-01-01' AND '2100-12-31' GROUP BY Visit_ID) WHERE Visit_ID IN (SELECT DISTINCT Visit_ID FROM Medicine_Usage WHERE Medicine_Name = 'fluticasone propionate 110mcg')
cbe81158af8ca0c5186959f0,Tell me the five most common lab tests since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT lab_test, COUNT(*) as test_count FROM medical_records WHERE YEAR(test_date) >= 2100 GROUP BY lab_test ORDER BY test_count DESC LIMIT 5"
7f9f201c03d5f3b1e2d247ca,What's the count of patients who left the hospital in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patients WHERE discharge_date BETWEEN '2023-01-01' AND '2023-12-31'
e459f2e457c29b8387ed9964,"What are the three most frequently taken specimens for patients diagnosed with traumatic shock previously during the same hospital visit, since 1 year ago?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic shock' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,
612f8fa49f7f4fdc5d2bc4b6,Tell me the name of the diagnosis that patient 10039997 received last during their first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,SELECT diagnosis_name FROM diagnoses WHERE patient_id = 10039997 AND admission_date = (SELECT MIN(admission_date) FROM admissions WHERE patient_id = 10039997) ORDER BY diagnosis_date DESC LIMIT 1
3825f15fdd46e295e266d4e2,What was the specimen test ranked at five that was done most commonly since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]",SQL Query Here
3359b6d79281a1940ec5c65c,Could you list the daily average dextrose 5% input of patient 10039831 on this ICU visit?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],"select day, AVG(input) from icustays_inputevents_d where patientunitstayid in (select icustay_id from icustays where patientunitstayid in (select patientunitstayid from d_items where itemid in (select itemid from d_items where itemid=3340 and category='input')) and patientunitstayid in (select patientunitstayid from d_items where itemid in (select itemid from d_items where itemid=3340 and category='input') and value=10039831)) and itemid=3340 group by day"
21fe976dd2fd2be6db9c01b6,When are dr. davis's rounds and procedures?,,,"SELECT rounds.start_time, procedures.procedure_type FROM rounds INNER JOIN procedures ON rounds.round_id = procedures.round_id WHERE rounds.attending_doctor = 'Dr. Davis' ORDER BY rounds.start_time;"
6d8c0ea325ed343de1ad7c30,"Hey, what was patient 10016150's minimum triglycerides value since 02/2100?","SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycerides' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-02'",[{'MIN(labevents.valuenum)': None}],
55bae74b1c4dde44613794ce,What is the maximum total hospital cost which involves closed fracture of seven ribs since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of seven ribs' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,"select max(Total_Hospital_Cost) from Table where Condition_Description='Fracture of 7 ribs, closed' and Service_Start_Date>'2100-01-01'"
ac9b3f14d853d992c65f6faa,Did patient 10027602 have jevity 1.2 (full) given in their last ICU visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'jevity 1.2 (full)' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],SELECT * FROM patient_treatments WHERE patient_id = 10027602 AND treatment_name = 'jevity 1.2 (full)' AND visit_type = 'ICU' ORDER BY visit_date DESC LIMIT 1
95a628ad73ca8b9a1ccdf74a,Find out the number of drugs given to patient 10013049 in 06/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-06'",[{'COUNT(*)': 0}],select count(*) from (select distinct drug from t_drugexposure where person_id=10013049 and drug_exposure_start_date like '06%') t1
290b08ec95402e357dd162b0,Can you please tell me the name of the diagnosis that patient 54894 received in another department?,,,[SELECT diagnosis
01898f9cb797a1bb35415331,Could you please tell me the name of the diagnosis patient 23002 received at another department?,,,select diagnosis from patient_records where patient_id = '23002' and department <> (select department from patient_records where patient_id = '23002')
6f1c6d1e65b0d7b96f895ca2,What's the SaO2 difference of patient 10039997's body last measured on the first ICU visit compared to the value second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","[SELECT (MAX(CASE WHEN itemid IN (220277, 225310) THEN valuenum ELSE NULL END) -"
d800d11c3e81f4be09d09c2f,When was first time the heart rate of patient 10027602 was greater than 63.0 in their first ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 63.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT MIN(date) FROM heart_rate WHERE person_id = 10027602 AND value > 63.0 AND stay_id IN (SELECT MIN(stay_id) FROM heart_rate WHERE person_id = 10027602);
5c8ae752cc0cbe2cb6d28a89,Tell me patient 10021487's total volume of output on 12/09/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-09'",[{'SUM(outputevents.value)': None}],SELECT SUM(Volume) AS TotalVolume FROM patient_output WHERE PatientID = 10021487 AND OutputDate = '2100-09-12';
56ec103efc85ce4ed535ee32,"In this year, has patient 10021118 been diagnosed with anything?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,SELECT DISTINCT diagnosis FROM diagnoses WHERE patient_id = 10021118 AND diagnosis_date >= '2023-01-01' AND diagnosis_date <= '2023-12-31' AND diagnosis != 'None';
04d135a8d8db7bcb4130bb9b,Tell me the name of the diagnosis that patient 10027602 received first since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",,SELECT DISTINCT diagnosis.name FROM diagnosis JOIN medical_records ON diagnosis.id = medical_records.diagnosis_id WHERE medical_records.patient_id = 10027602 AND medical_records.date > '2100-01-01' ORDER BY medical_records.date ASC LIMIT 1
ffbd3d45d651d7e4ecf8aeaa,Could you fetch the top five most common specimens tested since 2100 for me?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]","SELECT TOP 5 specimen, COUNT(*) AS test_count FROM tests WHERE test_date >= '2100-01-01' GROUP BY specimen ORDER BY test_count DESC"
37949c207b150e40794621cb,"Compared to yesterday, what new drugs are present in the prescription of patient 10039831 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL query here
fe646e876da3a9452e4e05ea,"What's the number of patients who were laceration of intercostal blood vessels, left side, initial encounter diagnosed since 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'laceration of intercostal blood vessels, left side, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,"select count(*) from ICD10 where description like '%laceration of intercostal blood vessels, left side, initial encounter%' and code >= 'I9600' and code < 'I9700' and date >= '2100-01-01'"
42ed29ca7381139bed4af657,Show me patient 10011398's total or urine output since 01/19/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19'",[{'SUM(outputevents.value)': None}],SELECT SUM(output) AS total_output FROM patient_urine_output WHERE patient_id = 10011398 AND measurement_date >= '01/19/2100';
0a5e5b2f22a73ebf9ddd7a3a,When was the last hospital discharge of patient 10025463?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10025463 ORDER BY admissions.dischtime DESC LIMIT 1,[{'dischtime': '2137-10-09 15:30:00'}],SELECT MAX(discharge_date) FROM patient_discharges WHERE patient_id = 10025463
038c76dd2c59256fd7b9ae46,Tell me the average total hospital cost that includes ritonavir in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ritonavir' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_hospital_cost) FROM [claims_formulary_1
d6b45e0644198773e61b027c,How many patients since 2100 were diagnosed with suicidal ideation within the same month after the first diagnosis with panic disorder without agoraphobia?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'panic disorder without agoraphobia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,SELECT count(*) FROM patient WHERE diagnosis = 'suicidal ideation' AND date_diagnosis > '2100-01-01' AND (date_diagnosis - date_first_diagnosis) < interval '1 month' AND date_first_diagnosis IN (SELECT date_diagnosis FROM patient WHERE diagnosis = 'panic disorder without agoraphobia')
c56c95b8d5030cf37d0e4528,"What was the name of the medication that patient 10002495 was prescribed within the same day after receiving a assistance with cardiac output using balloon pump, continuous procedure in 06/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,"select distinct P.prescrip_1 as Medication from (select * from admissions A where A.patient_id=10002495 and A.admit_date = ""06/2100"") AS A join procedures P on (A.patient_id = P.patient_id and A.admit_date = P.procedure_date) where P.procedure_name = ""assistance with cardiac output using balloon pump, continuous"" and P.procedure_type = ""procedure"""
5e3559038c113cb814682141,What is the difference in patient 10007818's weights last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT `weight`, `date` FROM `measurements` WHERE `patient` = 10007818 ORDER BY `date` DESC LIMIT 2"
992e5ae1a94aabac75308495,When was the first time patient 10008454 had the minimum heart rate on 12/07/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-07' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",[],"[SELECT visit_start_date FROM (SELECT visit_start_date, MIN(heart_rate) as min_heart_rate FROM (SELECT * FROM (VALUES ('12/07/2100', 10008454, '09:00:00', 75), ('12/07/2100', 10008454, '10:00:00', 65), ('12/07/2100', 10008454, '11:00:00', 70), ('12/07/2100', 10008454, '12:00:00', 65), ('13/07/2100', 10008454, '09:00:00', 80), ('13/07/2100', 10008454, '10:00:00', 85)) AS T(visit_start_date, patient_id, time, heart_rate)) WHERE patient_id = 10008454 AND visit_start_date = '12/07/2100' GROUP BY visit_start_date) AS T1 WHERE min_heart_rate = (SELECT MIN(heart_rate) FROM (SELECT * FROM (VALUES ('12/07/2100', 10008454, '09:00:00', 75), ('"
64d3df17e06aa81f9ecdc580,"Has ampicillin-sulbactam, 0.9% sodium chloride (mini bag plus), or 0.9% sodium chloride been prescribed in their current hospital visit to patient 10039831?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'ampicillin-sulbactam', '0.9% sodium chloride (mini bag plus)', '0.9% sodium chloride' )",[{'COUNT(*)>0': 0}],[SELECT DISTINCT prescription.medication
9e64c0910dc58e2ef996f7c0,When was the last hospital discharge of patient 10003400?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003400 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2137-09-02 17:05:00'}],SELECT MAX(DischargeDate) FROM HospitalDischarges WHERE PatientID = '10003400'
d7533f37a1589e2a8f4df73e,What's the average total cost of a hospital that involves a procedure called fiber-optic bronchoscopy throughout this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fiber-optic bronchoscopy' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_cost) FROM hospital_costs WHERE procedure = 'fiber-optic bronchoscopy' AND year = 2023
7c2ab9c849f250ca7ae3054c,When was the first microbiological test of patient 10027445 since 04/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2142-07-31 06:07:00'}],SELECT MIN(TestDate) FROM microbiological_tests WHERE PatientID = '10027445' AND TestDate > '04/2100'
1a16b0cbd84a464357e6fb02,How many current patients are there that are 20s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 20 AND 29,,SELECT COUNT(*) FROM Patients WHERE age BETWEEN 20 AND 29 AND current_status = 'current'
3bd09b282f97fbf5a9f40eaf,Show the weight changes of patient 10027602 last measured on the last hospital visit compared to the value second to last measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",select ... from ... where ...
6f9909683d56ed89f9e559bc,Is patient 20589 a person with a family history of any health problems?,,,SELECT EXISTS (SELECT * FROM FamilyHistory WHERE PatientID = 20589 AND HealthProblem IS NOT NULL)
56cc6ac2512f4026f211bada,"How many patients had a diagnosis of pain in joint, shoulder region since 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in joint, shoulder region' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,"select count(*) from patient_records where diagnosis = 'pain in joint, shoulder region' and date_of_diagnosis > '2100-01-01'"
17b596080425a3e13fe4f66b,Can you show me the top four frequent output events throughout this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"[SELECT event_type, COUNT(*) AS frequency"
4d6effcf91960c4bd023a47c,Has any organism been found in patient 10038081's first blood (cmv ab) test conducted since 10/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood (cmv ab)' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)>0': 0}],select count(*) from lab_events where person_id=10038081 and order_id=(select order_id from lab_events where person_id=10038081 and event_id='first blood (cmv ab)' and date>='2010-10-01') and result is not null
89f0db596b270220fda6c25f,Which were the five most frequently ordered laboratory tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(order_id) AS frequency FROM laboratory_tests WHERE order_date > (CURRENT_DATE - INTERVAL '1 year') GROUP BY test_name ORDER BY frequency DESC LIMIT 5"
2f8b95322025bab1d2c8da4f,Has patient 10006053 been prescribed a specific drug since 11/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11'",[{'COUNT(*)>0': 1}],SELECT DISTINCT prescription_date FROM prescriptions WHERE patient_id = 10006053 AND prescription_date > '11/2100' AND drug_name = 'SpecificDrugName';
da971f3a5b73f3990bd5cb3f,When was the first time that patient 10038999 was prescribed soln and lactulose since 04/2100 at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactulose' AND admissions.subject_id = 10038999 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'soln' AND admissions.subject_id = 10038999 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT MIN(medication_start_time) FROM prescriptions WHERE patient_id = 10038999 AND (medication_name = 'soln' OR medication_name = 'lactulose') AND medication_start_time >= '04/2100';
b63dbd1722b760241e7465c7,When were the drugs pantoprazole and ondansetron prescribed to patient 10007928 for the first time in 04/this year at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10007928 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10007928 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT MIN(prescription_date) AS First_Prescription_Date FROM prescriptions WHERE patient_id = 10007928 AND ((drug_name = 'pantoprazole' OR drug_name = 'ondansetron') AND prescription_date >= '2023-04-01' AND prescription_date < '2023-05-01') AND EXISTS (SELECT 1 FROM prescriptions AS p2 WHERE p2.patient_id = prescriptions.patient_id AND p2.drug_name = 'pantoprazole' AND p2.prescription_date = prescriptions.prescription_date) AND EXISTS (SELECT 1 FROM prescriptions AS p3 WHERE p3.patient_id = prescriptions.patient_id AND p3.drug_name = 'ondansetron' AND p3.prescription_date = prescriptions.prescription_date)
ccb20fe5f0ec69b335b58f1c,What is the outpatient schedule today for dr. minutillo?,,,SQL Query here
e56a5abd1ccdf45d55cee224,When did patient 10005348 get a microbiology test for the last time since 02/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2130-10-27 17:02:00'}],SELECT * FROM microbiology_tests WHERE patient_id = 10005348 AND test_date > '02/21/2000' ORDER BY test_date DESC LIMIT 1
af7ad9cea92641ef8e97f7c1,What were the four most commonly performed lab tests throughout this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"SELECT TOP 4 LabTestName, COUNT(LabTestId) AS TestCount FROM LabTests WHERE TestDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY LabTestName ORDER BY TestCount DESC"
7170b2897858fa87237babee,"Can you tell me how many open reduction of fracture with internal fixation, humerus procedures were done in 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open reduction of fracture with internal fixation, humerus' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,"SELECT COUNT(*) AS TotalOpenReductionFractureHumerusProcedures FROM Procedures WHERE ProcedureName = 'Open reduction of fracture with internal fixation, humerus' AND Year = 2100 AND Status = 'Completed';"
e72e07c6e4ff2480d2708585,Could you list the four diagnoses that had the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT diagnosis, mortality_rate FROM patient_data WHERE time_frame = '6 months' ORDER BY mortality_rate DESC LIMIT 4"
4aaf4f3c76752b37f232e69b,Could you fetch the top three most common specimens tested in 2100 for me?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",[],"SELECT specimen, COUNT(*) as count FROM lab_data WHERE year = 2100 GROUP BY specimen ORDER BY count DESC LIMIT 3;"
78512e3b7c9ea984222bfee1,How many tramadol prescription instances took place since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tramadol' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 9}],SELECT COUNT(*) FROM prescriptions WHERE medication = 'tramadol' AND prescription_date >= '2100-01-01';
fe0a92b8a22e8c88cd9c413a,"In the first hospital visit, did patient 10018845 come to the ER?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'COUNT(*)>0': 0}],SELECT ... FROM ... WHERE ...
192595f3a72877272b046e55,How is potassium chl 20 meq / 1000 ml d5 1/2 ns taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5 1/2 ns',[],SELECT dosing_instructions FROM medications WHERE name = 'potassium chl 20 meq / 1000 ml d5 1/2 ns' AND dosage_form = 'IV infusion'
cac9008f4f2f7e8937a4e13a,What were the top four diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT diagnosis, MAX(`3-month mortality rate`) FROM `diagnosis` WHERE `3-month mortality rate` IS NOT NULL GROUP BY diagnosis ORDER BY `3-month mortality rate` DESC LIMIT 4"
c32224fbcb946a4db57012a7,What is the percentile ranking of a asparate aminotransferase (ast) test value of 33.0 for patients of the same age as patient 10007795 during their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 33.0",,SELECT PERCENT_RANK() OVER (PARTITION BY age ORDER BY ast_test_value ASC) AS percentile_rank FROM patients WHERE patient_id = '10007795' AND visit_number = 1
7363a00d1729eca1fc81049b,"How much is the minimum total hospital bill for a visit that involves a bicarbonate, urine test since 1 year ago?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate, urine' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT MIN(total_bill) FROM hospital_visits WHERE test_name = 'urine test - bicarbonate' AND visit_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
828e19c5d77504383bc65778,Give me the length of stay in days for patient 10018501 during their first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.9412152781151235}]","SELECT DATEDIFF(day, ADMISSION_DATE, DISCHARGE_DATE) AS length_of_stay FROM ICU_STAYS WHERE PATIENT_ID = '10018501' AND STAY_NUMBER = 1"
5c9e3563429336a3a6497c07,What are the top five most frequent drugs prescribed to patients in the same hospital encounter after the diagnosis of other pulmonary embolism without acute cor pulmonale?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other pulmonary embolism without acute cor pulmonale' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT drt.drug_name, COUNT(*) AS prescription_count FROM drug_refills drt JOIN diagnoses diag ON drt.encounter_id = diag.encounter_id AND drt.discharge_date = diag.discharge_date JOIN patients pat ON drt.patient_id = pat.patient_id WHERE diag.diagnosis_name = 'Other pulmonary embolism without acute cor pulmonale' AND drt.discharge_date = diag.discharge_date GROUP BY drt.drug_name ORDER BY prescription_count DESC LIMIT 5"
21dbea03500cf77a64577287,What is the name of the drug that is not to be given during packed cell transfusion?,,,SELECT name FROM drug WHERE NOT in_use_during_packed_cell_transfusion=1
f046a738ce962ca3221afcbd,"During this year, has patient 10007928 been in an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],select distinct encounter_id from patient_encounter where patient_id=10007928 and visit_type='ER' and encounter_date between '2023-01-01' and '2023-12-31'
ac9fc03c65beee9fae66c482,What is the cost of a diagnosis for suicidal ideation?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'suicidal ideation' ) ),,select cost from diagnoses where name = 'Suicidal ideation'
d3bf0e541f1e4e8cb0f4066a,How many patients were discharged from the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],"SELECT count(*) FROM patient_records WHERE discharge_date >= DATEADD(year, -1, GETDATE())"
bdb2fa4bcffae40f48f57a25,What was the name of the organism found in patient 10019172's last urine microbiological test?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT Organism_Name FROM MicrobiologicalTests WHERE Patient_ID = 10019172 AND Test_Date = (SELECT MAX(Test_Date) FROM MicrobiologicalTests WHERE Patient_ID = 10019172)
438eaca992b625cafb55b6db,Give me the four most frequent procedures performed.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Central venous catheter placement with guidance'}, {'long_title': 'Other nonoperative respiratory measurements'}]","SELECT procedure, COUNT(*) AS frequency FROM medical_procedures GROUP BY procedure ORDER BY frequency DESC LIMIT 4"
ebdf09b1cf8d52950fe299a1,When was the last time that patient 10020740 was prescribed a medication in 04/this year via po?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1",[],"SELECT MAX(visit_start_date) FROM (SELECT DISTINCT patient_id, visit_start_date FROM `mimic-iv.admissions` WHERE patient_id = 10020740) AS patients_with_admission LEFT JOIN (SELECT DISTINCT person_id, admission_id FROM `mimic-iv.patients` WHERE person_id = 10020740) AS patients_with_person_id ON patients_with_admission.hadm_id = patients_with_person_id.admission_id LEFT JOIN (SELECT DISTINCT hadm_id, drug_type, drug_name, route, DATE(CHAR(0 || EXTRACT(YEAR FROM CURRENT_DATE) || SUBSTR(CHAR(4 - EXTRACT(MONTH FROM chartdate)), 2, 2) || chartdate)) AS chartdate FROM `mimic-iv.inputevents_mv` WHERE charttime LIKE '04/%' AND route = 'PO') AS chartdate_for_po_drug ON patients_with_admission.hadm_id = chartdate_for_po_drug.hadm_id WHERE chartdate_for_po_drug.drug_type IS NOT NULL AND chartdate_for_po_drug.drug_name IS NOT NULL"
7aeb94856d35a70807387853,What was the total amount of polyethylene glycol prescribed to patient 10037861 since 08/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.drug = 'polyethylene glycol' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(amount) FROM prescriptions WHERE patient_id = 10037861 AND drug_name = 'polyethylene glycol' AND prescription_date >= '2100-08-01'
2616e051ac4579e504b2e48d,"During their first hospital encounter, what was the diagnosis for patient 10004720 the first time?",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,SELECT diagnosis FROM patient_encounters WHERE patient_id = 10004720 AND encounter_number = 1
4ad4465cd7b99c50bc48d1df,Count the number of current patients whose ages fall within the 50s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,,SELECT COUNT(*) AS patient_count FROM patients WHERE age >= 50 AND age < 60 AND active = TRUE;
86e5eb5831ba084a42761fa6,What was the first time patient 10017492 received vitamin b12 in a lab test on the first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,[],SELECT MIN(RESULT_DATE) FROM LAB_TESTS WHERE PATIENT_ID = '10017492' AND TEST_NAME = 'Vitamin B12' AND VISIT_ID = (SELECT MIN(VISIT_ID) FROM HOSPITAL_VISITS WHERE PATIENT_ID = '10017492')
e50c094ffc2b4008e3005839,What is the reimbursement standard for cerebrovascular mri,,,SELECT reimbursement_standard FROM medical_procedures WHERE procedure_name = 'cerebrovascular mri';
7cf79d6d78b98237ceed2c66,What is dr. robinson's outpatient schedule today?,,,select * from outpatient_schedule where doctor_name = 'Dr. Robinson' and date = current_date
6a368f5c49fd5add94776985,"So, the last mcv test result for the patient 10004720 in 12/this year was?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT TOP 1 Result FROM MCVTests WHERE PatientID = 10004720 AND TestDate >= '2023-12-01' ORDER BY TestDate DESC
c0fcaebf5fe4de9b0da7c35c,How much morphine sr (ms contin) had been prescribed to patient 10021312 in total in 08/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.drug = 'morphine sr (ms contin)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-08'",[{'SUM(prescriptions.dose_val_rx)': None}],select sum(prescribed_quantity) from prescription_records where medication_name = 'morphine sr (ms contin)' and patient_id = '10021312' and prescription_date between '08/01/2100' and '08/31/2100'
195a853f0ef04bb3011b271b,When did patient 10018081 have a first metamyelocytes laboratory test in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime ASC LIMIT 1",[],[SELECT date_collected
3d6be9c3bab36afdf6303321,When were patient 10007795 first prescribed for metronidazole (flagyl) and ns at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND admissions.subject_id = 10007795 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ns' AND admissions.subject_id = 10007795 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],
60bf7b753de50724e7fe0465,Quantify the number of patients who were tested for anticardiolipin antibody igm.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anticardiolipin antibody igm' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(*) FROM patient_tests WHERE test_name = 'anticardiolipin antibody igm'
55089d9089a6992078371da4,"What are the five most frequently ordered medications that patients in their 50s were prescribed within 2 months after they were diagnosed with other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified procedures as the cause of abnormal reaction of patient, or of later complication, without mention of misadventure at time of procedure' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 m.medication_name, COUNT(*) AS order_count FROM Medications m INNER JOIN PatientPrescriptions pp ON m.medication_id = pp.medication_id INNER JOIN Patients p ON pp.patient_id = p.patient_id INNER JOIN Diagnoses d ON p.patient_id = d.patient_id INNER JOIN Procedures pr ON d.procedure_id = pr.procedure_id WHERE d.diagnosis_code = 'O80' AND p.age BETWEEN 50 AND 59 AND pp.order_date BETWEEN d.diagnosis_date AND DATEADD(month, 2, d.diagnosis_date) AND pr.procedure_date >= DATEADD(year, -1, GETDATE()) GROUP BY m.medication_name ORDER BY order_count DESC"
34e916a3d87884c2b17eed2f,Can you tell me the five most frequent microbiology tests this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",[],"SELECT test_name, COUNT(test_id) AS test_frequency FROM microbiology_tests WHERE test_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY test_name ORDER BY test_frequency DESC LIMIT 5"
5bfa45301dea4f2fbecbb26b,"For patient 10016742, what were the last mch lab results in 07/2100?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y-%m',labevents.charttime) = '2100-07' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT TOP 1 * FROM lab_results WHERE patient_id = 10016742 AND test_name = 'mch' AND date_collected BETWEEN '2007-01-01' AND '2007-12-31' ORDER BY date_collected DESC
64417089c0eeb8c42da6c9c2,Count the number of patients who were given the phosphorus since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phosphorus' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS PatientCount FROM patients WHERE treatment = 'phosphorus' AND date >= '2100-01-01'
d594afe3713d185962186bc5,What was the organism's name of the first sputum microbiology test done on patient 10009049 in the last hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],select first_name from MICROBIOLOGY_TEST_RESULT where patient_id='10009049' and hospital_encounter_id=(select max(hospital_encounter_id) from MICROBIOLOGY_TEST_RESULT where patient_id='10009049') and test_type='Sputum' and test_result_id=(select min(test_result_id) from MICROBIOLOGY_TEST_RESULT where patient_id='10009049' and hospital_encounter_id=(select max(hospital_encounter_id) from MICROBIOLOGY_TEST_RESULT where patient_id='10009049') and test_type='Sputum')
e5b66a1b55593f1824235d1a,"Provide a list of the three most common diagnoses that patients were diagnosed with during the same month after undergoing the resection of vessel with replacement, thoracic vessels procedure in 2100.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'resection of vessel with replacement, thoracic vessels' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT Diagnosis, COUNT(Diagnosis) AS DiagnosisCount FROM `hospital-data-procedure-snapshot`.UnionEDW_Live.V_LivePCORI_Snapshot WHERE ProcedureCode = 'Resection of vessel with replacement, thoracic vessels' AND DiagnosisDate >= '2100-01-01' AND DiagnosisDate <= '2100-12-31' GROUP BY Diagnosis, MONTH(DiagnosisDate) ORDER BY DiagnosisCount DESC, MONTH(DiagnosisDate) LIMIT 3"
7b67c7a9bff55320d436972c,Has patient 10011398 undergone a white blood cells laboratory test since 11/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-11'",[{'COUNT(*)>0': 0}],SELECT count(*) as test_count FROM lab_results WHERE patient_id = 10011398 AND test_type = 'white blood cells' AND test_date > '2111-01-01'
9862dfab336a7e119e848d7f,What are the average daily number of patients diagnosed with acute alcoholic hepatitis in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic hepatitis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,select avg(daily_patients) from hospital_records where disease = 'acute_alcoholic_hepatitis' and year = 2100
5da9ae74c519002875122c59,What is the drug that isnt to be taken during opn/oth rep aortic valve??,,,SELECT drug_name FROM contraindications WHERE valve_type = 'opn/oth' AND procedure = 'revascularization aortic valve' AND action = 'not to be taken'
b6cdfe2edf6838e152af3c54,What the name of the diagnosis that patient 14467 received in the other department?,,,select name from diagnosis where patient_id=14467 and department='other'
5401b6a61d136580b9f69be2,If so is there a genetic test that patient 26218 gets?,,,SELECT test_type FROM patient_tests WHERE patient_id = '26218' AND result = 'positive' AND test_type LIKE '%genetic%';
9e5c20a2a5d9bd9a11019222,What was patient 10004733's monthly maximum value of body weight since 20 months ago?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-20 month') GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT MAX(weight) as max_weight FROM patient_data WHERE patient_id = 10004733 AND measurement_date > DATE_SUB(CURDATE(), INTERVAL 20 MONTH) GROUP BY YEAR(measurement_date), MONTH(measurement_date) ORDER BY measurement_date DESC;"
5a7a92c1e36cc66dc5a226ab,"So, what was the last respiratory rate of patient 10019777 on their last ICU visit?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],select max(value) from admissions a join measurements m on a.id=m.admission_id and m.unit_id=a.unit_id and m.itemid=272 and m.subject_id=10019777 and a.intime=(select max(intime) from admissions where subject_id=10019777 and itemid=272 and unit_id=(select unit_id from admissions where subject_id=10019777 and intime=(select max(intime) from admissions where subject_id=10019777 and itemid=272)))
d4183c39d460be6d47009fdd,"What was the first total protein, csf reading for patient 10014078?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) ORDER BY labevents.charttime ASC LIMIT 1",[],"select top 1 reading from patient_readings where patient_id = '10014078' and test_type = 'total protein, csf' order by test_date asc"
444002e65b58c6f479197866,Can you calculate how many patients were prescribed gemfibrozil?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE medication_name = 'gemfibrozil';
676f00b844b8685a14e6582b,What is today's outpatient schedule with dr. smith?,,,SELECT * FROM outpatient_schedule WHERE doctor_name = 'Dr. Smith' AND date = CURRENT_DATE;
53fca8bfc5f88cb4209eec38,Can you tell me how old patient 10035185 was on the first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,,"[SELECT TIMESTAMPDIFF(YEAR, p.dob, MIN(v.visit_date)) AS age_on_first_visit"
a8bfb5881309bbc205af6f0e,What is patient 10035185's minimum basophils value on the first hospital encounter?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ),[{'MIN(labevents.valuenum)': None}],SELECT MIN(basophils) FROM lab_results WHERE patient_id = 10035185 AND encounter_number = 1
5e4bfc749171bceb6b2332d1,When was patient 10014729 last given an input since 03/06/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-06' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2125-03-01 20:37:00'}],SELECT MAX(date) FROM events WHERE patient_id = '10014729' AND event_type = 'Input' AND date > '03/06/2100'
e71e7a24a4702232c71f8271,Can you tell me the first time patient 10021487 had a diastolic blood pressure that was greater than 63.0 since 21 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 63.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-21 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],"select min(systolic_sbp),min(systolic_dbp), min(systolic_datetime) from (select min(systolic_sbp) as systolic_sbp, min(systolic_dbp) as systolic_dbp, min(systolic_datetime) as systolic_datetime from (select min(systolic_sbp) as systolic_sbp, min(systolic_dbp) as systolic_dbp, min(systolic_datetime) as systolic_datetime from (select systolic_sbp,systolic_dbp, systolic_datetime from mde_systolic where systolic_id = '10021487' and systolic_dbp > '63.0' and systolic_datetime > current_timestamp - interval '21 days' group by systolic_sbp,systolic_dbp,systolic_datetime having min(systolic_datetime) > current_timestamp - interval '21 days' order by systolic_datetime limit 1) as t2) as t3) as t4"
131f8932f899a611506ecd2b,How many hours have it been since the first stay of patient 10021487 on this hospital stay in the careunit trauma sicu (tsicu)?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT DATEDIFF(hour, MIN(admitted_at), GETDATE()) AS hours_since_first_stay FROM patient_stay WHERE patient_id = 10021487 AND careunit = 'tsicu' AND is_current_stay = 1 GROUP BY patient_id, careunit"
2040aaebd3c0a403ffa1269c,What was the medication patient 10026354 was prescribed for the first time via iv drip?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT medication FROM prescriptions WHERE patient_id = 10026354 AND route = 'iv drip' ORDER BY date_prescribed ASC LIMIT 1
0fd2ccbe30809ad0253a004f,How many patients were in med/surg/trauma this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/trauma' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL Query
eb31ac4eb5e1f45dc5b80313,What was the name of the medicine that was given to patient 10038933 within 2 days post procedure of percutaneous [endoscopic] gastrostomy [peg]?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,SELECT med_name FROM medicine_administration JOIN procedure_dates ON medicine_administration.patient_id = procedure_dates.patient_id WHERE procedure_dates.patient_id = 10038933 AND procedure_dates.procedure_type = 'percutaneous endoscopic gastrostomy' AND procedure_dates.date BETWEEN procedure_dates.procedure_date AND procedure_dates.procedure_date + INTERVAL '2 days';
d518a22ef06007a9c93db34b,"Count the number of patients during the last year who received a introduction of other therapeutic substance into peripheral artery, percutaneous approach procedure.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,SQL query goes here
6b1ddc68db0377487658c10b,What is the recently prescribed medication for patient 10004733 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"SELECT m.medication_name, m.date_prescribed, (CASE WHEN m.date_prescribed = CURRENT_DATE THEN 'Today' ELSE 'Yesterday' END) AS prescription_day FROM medication_records m WHERE m.patient_id = 10004733 AND m.date_prescribed IN (CURRENT_DATE, CURRENT_DATE - INTERVAL '1 day') ORDER BY m.date_prescribed DESC;"
f90c169bc5f07a8ae6dacece,Get me the top four most common diagnoses since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) as frequency FROM diagnoses WHERE date > (CURRENT_DATE - INTERVAL '1 year') GROUP BY diagnosis ORDER BY frequency DESC LIMIT 4"
22f6471acc2d184e7cfeeb6f,Tell me the blood type of patient 58649?,,,SELECT blood_type FROM patients WHERE patient_id = 58649;
553e1ea6ccc3dcb9caf59f18,When was the first time of input for patient 10027602 on this month/05?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '05' ORDER BY inputevents.starttime ASC LIMIT 1",[],
6a3568128f729d82972746f2,When did patient 10038933 have a mchc lab test for the first time in 09/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y-%m',labevents.charttime) = '2100-09' ORDER BY labevents.charttime ASC LIMIT 1",[],select distinct date from lab_events where patient_id = 10038933 and lab_test_name = 'mchc' and date between '09/01/2100' and '09/30/2100' and date = (select min(date) from lab_events where patient_id = 10038933 and lab_test_name = 'mchc' and date between '09/01/2100' and '09/30/2100')
407f290d6f4319cdd21a777e,What was the last weight of patient 10005817 recorded since 14 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT weight FROM patient_measurements WHERE patient_id = '10005817' AND measurement_date >= DATE_SUB(CURDATE(), INTERVAL 14 MONTH) ORDER BY measurement_date DESC LIMIT 1"
5b31e1e9fd15d53ccceb7195,Has a procedure been performed on patient 10019172 in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,SELECT * FROM `ProcedureEvent` WHERE `subject_id`='10019172' AND `year_of_event`=2100
2eaf0a50018f2abf03e6f2da,What is the average cost of a hospital that involves neoplasm of unspecified nature of endocrine glands and other parts of nervous system?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'neoplasm of unspecified nature of endocrine glands and other parts of nervous system' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT AVG(cost) FROM hospitals WHERE 'neoplasm of unspecified nature of endocrine glands' IN diagnoses AND 'other parts of nervous system' IN diagnoses;
b5ebca4336ca90885d7d6381,Show me the top five most common diagnoses of patients aged 60 or above since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patient_records WHERE age >= 60 AND admission_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
430d5d3db66a6f64ebeb3879,Did patient 10021487 have any monos lab tests done during their first hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monos' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],select * from lab_tests where patient_id = 10021487 and encounter_id = (select min(encounter_id) from encounters where patient_id = 10021487) and test_name like '%monos%'
063d2d7c311c16f3cc0916a7,What were the top five most common specimen tests conducted throughout this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],"SELECT test_name, COUNT(*) AS test_count FROM SpecimenTests WHERE YEAR(test_date) = YEAR(CURDATE()) GROUP BY test_name ORDER BY test_count DESC LIMIT 5;"
2e16f3d29c3aeed69b6e3b78,What was the total volume of foley that patient 10004235 had on 03/21/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-21'",[{'SUM(outputevents.value)': None}],SELECT SUM(volume) FROM foley WHERE patient_id = '10004235' AND date = '2023-03-21'
38e7715444818223680cc90f,How many hours have passed since patient 10021487 last received a laboratory test of eosinophils during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT (UNIX_TIMESTAMP() - MAX(EXTRACT(EPOCH FROM lab_tests.test_datetime))) / 3600 AS hours_since_last_eosinophil_test FROM patients LEFT JOIN lab_tests ON patients.patient_id = lab_tests.patient_id WHERE patients.patient_id = '10021487' AND lab_tests.test_type = 'eosinophils' AND lab_tests.encounter_id = patients.encounter_id AND patients.encounter_id = 'current_encounter_id'
fa665d6909377d977664e7fd,"For the first time in 12/2100, when was patient 10008454 prescribed famotidine and metoprolol tartrate at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10008454 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metoprolol tartrate' AND admissions.subject_id = 10008454 AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"SELECT MIN(STARTTIME) FROM LABELEVENTS WHERE PATIENT_NUM = '10008454' AND (ITEMID IN (SELECT ITEMID FROM D_ITEMS WHERE SHORT_DESCRIPTION LIKE '%FAMOTRIDE%') OR ITEMID IN (SELECT ITEMID FROM D_ITEMS WHERE SHORT_DESCRIPTION LIKE '%METOPROLOL%')) AND STARTTIME BETWEEN '2017-12-01' AND '2017-12-31' GROUP BY PATIENT_NUM, STARTDATE, STARTTIME HAVING COUNT(DISTINCT ITEMID) = 2"
db037fde5163630eb1dacbe1,Does patient 6440 have a history of travelling overseas?,,,SELECT history FROM patient_records WHERE patient_id = '6440' AND history LIKE '%overseas travel%'
ebd3a49f285aab80f2f09b02,When did the last hospital discharge of patient 10020786 occur?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020786 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2189-06-13 17:20:00'}],SELECT MAX(discharge_date) as LastDischargeDate FROM hospital_discharges WHERE patient_id = '10020786'
f58bd3fca803b73088423ede,What does it cost to get automatic implantable cardiac defibrillator in situ diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'automatic implantable cardiac defibrillator in situ' ) ),,SELECT AVG(ProcedureCost) FROM MedicalProcedures WHERE ProcedureName = 'Automatic Implantable Cardiac Defibrillator Diagnosis'
3fbce8b880d773477b429d71,"How many hours has elapsed since the first time during their current hospital encounter patient 10021487 had received a albumin, pleural lab test?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, pleural' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"select count(*) from lab_events where patient_id = 10021487 and event_type = 'Albumin, Pleural' and event_time > (select min(event_time) from lab_events where patient_id = 10021487 and event_type = 'Albumin, Pleural')"
f18eb420cfdd900530bf3999,"For patients who were diagnosed with duodenitis, without mention of hemorrhage in 2100, what are the top three most common medications that followed afterward in the same month?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'duodenitis, without mention of hemorrhage' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT medication_name, COUNT(*) AS medication_count FROM patient_medication_records WHERE diagnosis = 'duodenitis' AND hemorrhage_mentioned = FALSE AND YEAR(diagnosis_date) = 2100 GROUP BY medication_name ORDER BY medication_count DESC LIMIT 3"
a6b419a3f82d564950633030,Could you tell me the gender of patient 10016742?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10016742,[{'gender': 'F'}],SELECT gender FROM patient WHERE patient_id = 10016742
ce45eba5e3053962a503afb0,Count the patients who are currently admitted.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS num_admitted_patients FROM patient_records WHERE admission_status = 'Admitted'
4ad13911a0c3cadf96e3052c,Fetch the top four most frequent procedures that were administered to patients within 2 months after they had continuous invasive mechanical ventilation for 96 consecutive hours or more since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for 96 consecutive hours or more' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 Procedure, COUNT(*) AS ProcedureFrequency FROM ProcedureTable WHERE DATEDIFF(month, AdmittanceDate, DischargeDate) <= 2 AND ContinuousVentilationDuration >= 96 AND DischargeDate >= '2100-01-01' GROUP BY Procedure ORDER BY ProcedureFrequency DESC"
4694f530b836736c5f4fd656,What are the top five common diagnoses since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT Diagnosis, COUNT(Diagnosis) AS DiagnosisCount FROM PatientRecords WHERE DateOfDiagnosis >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY Diagnosis ORDER BY DiagnosisCount DESC LIMIT 5"
caaf86100f832f6892b85b8f,What was the last heart rate value that patient 10001725 had during the first ICU visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT heart_rate FROM patient_data WHERE patient_id = 10001725 AND visit_number = 1 ORDER BY timestamp DESC LIMIT 1
cfd20a468254386f9a520dca,Did patient 10015931 come into the ER during the previous year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) AS ER_Visits FROM er_visits WHERE patient_id = 10015931 AND visit_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
654c90f267446af8ba8f70b5,What is the number of patients that received a bands test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bands' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patient_id) from test where test_name = 'bands' and test_date >= current_date - interval '1 year'
7afd7257fd278efbcb7b33ad,What's the cost of a drug known as miconazole nitrate vag cream 2%?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'miconazole nitrate vag cream 2%' ),,"select ""cost"" from ""drug"" where ""drug_name"" like 'miconazole nitrate vag cream 2%'"
1d69c2e9a177101cfd62efed,What was the last asparate aminotransferase (ast) value in 10/this year for patient 10019172?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT top 1 ast_value FROM lab_results WHERE patient_id='10019172' AND test_name='Asparate aminotransferase (AST)' AND date_of_result >= '2023-10-01' ORDER BY date_of_result DESC
5cbd34f92a55a8e7c2f987ce,What's the daily average weight of patient 10007058 during the last month?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT AVG(weight) as average_daily_weight FROM patient_records WHERE patient_id = '10007058' AND record_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND CURDATE() GROUP BY DAY(record_date);"
067ed21678e9244b701465c3,Was patient 10008287 given a bicarbonate lab test during the last hospital visit?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],SELECT * FROM lab_results WHERE patient_id = 10008287 AND test_name = 'Bicarbonate' AND visit_date = (SELECT MAX(visit_date) FROM lab_results WHERE patient_id = 10008287)
2de4e7fa2f4e70e798676fe5,What are the three most common output instances since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT output_instance, COUNT(*) as frequency FROM output_log WHERE date >= '2100-01-01' GROUP BY output_instance ORDER BY frequency DESC LIMIT 3;"
cb26755fc90d31c8a991b39a,What was the first thing patient 10014078 had as output on 09/08/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '09-08' ORDER BY outputevents.charttime ASC LIMIT 1 )",[],"SELECT TOP 1 item FROM patientoutput WHERE patientid = 10014078 AND DATEPART(year, timestamp) = YEAR(GETDATE()) AND DATEPART(month, timestamp) = 9 AND DATEPART(day, timestamp) = 8 ORDER BY timestamp ASC;"
b5b17c29fa86af65cfe72d48,Has patient 10018423 been to the E.R.?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.admission_location = 'emergency room',[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM er_visits WHERE patient_id = '10018423';
bfa5c2646e642966bfa98418,What is the percentile creatinine value of 1.6 among patients of the same age as patient 10007818 on their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 1.6",,"select percentile_cont(0.5) within group (order by creatinine) from (select creatinine from (select creatinine, age from admissions join labevents on admissions.hadm_id = labevents.hadm_id join patients on admissions.subject_id = patients.subject_id and admissions.icu_stay = patients.icu_stay where admissions.subject_id = (select subject_id from admissions where hadm_id = 10007818 limit 1)) as patient_10007818 where age = (select age from (select age from admissions join labevents on admissions.hadm_id = labevents.hadm_id join patients on admissions.subject_id = patients.subject_id and admissions.icu_stay = patients.icu_stay where admissions.subject_id = (select subject_id from admissions where hadm_id = 10007818 limit 1)) as patient_10007818 limit 1) and seq_id = (select min(seq_id) from labevents join admissions on labevents.hadm_id = admissions.hadm_id where admissions.subject_id = (select subject_id from admissions where hadm_id = 10007818 limit 1))) as first_visit_patients"
e93e1b76d0204d31a3174cc1,What is the total number of patients who were discharged from the hospital last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from hospital_discharges where discharge_date between '2022-01-01' and '2022-12-31'
6260379332c5d91d2221013d,What was the last dose of glyburide that during their first hospital encounter was prescribed to patient 10038933?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'glyburide' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"select top 1 encounter_id, encounter_datetime, medication, drug, dose, route, frequency, duration, start_date, end_date from (select encounter_id, encounter_datetime, medication, drug, max(dose) as dose, max(route) as route, max(frequency) as frequency, max(duration) as duration, max(start_date) as start_date, max(end_date) as end_date, rank() over (partition by patient_id order by encounter_datetime desc) as rank from (select e.patient_id, e.encounter_id, e.encounter_datetime, m.medication, m.drug, m.dose, m.route, m.frequency, m.duration, m.start_date, m.end_date from patient p join encounter e on p.patient_id = e.patient_id join medication m on e.encounter_id = m.encounter_id where m.drug = 'Glyburide' and p.patient_id = '10038933') as patient_encounters group by encounter_id, encounter_datetime, medication) as ranked_encounters where rank = 1"
b661bb18d48da0b0b3f54277,"Since 2100, how many patients required amitriptyline?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 3}],SELECT count(*) FROM prescriptions WHERE drug_name = 'amitriptyline' AND year >= 2100;
9e7913d9465b0471d710f65b,"What is the price of the drug, ciprofloxacin iv?",SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin iv' ),,SELECT price FROM Drugs WHERE name = 'ciprofloxacin iv'
0702bc77d929f78085010bb0,What was the name of the organism that was found during the last pleural fluid test of patient 10021487 during this hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT organism_name FROM pleural_fluid_test WHERE patient_id = 10021487 ORDER BY test_date DESC LIMIT 1;
96b8daf19be21be478a7950f,How many individuals are current patients in their 60 or above?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,,SELECT COUNT(*) FROM patient WHERE patient_status = 'current' AND age >= 60;
8e22c703d632798f42282434,"What was the last dose of nifedipine in 11/2100, prescribed to patient 10021938?","SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND prescriptions.drug = 'nifedipine' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1",[],select * from prescriptions where patient_id = 10021938 and medication_name = 'nifedipine' and date_prescribed = (select max(date_prescribed) from prescriptions where patient_id = 10021938 and medication_name = 'nifedipine' and date_prescribed <= '2100-11-30')
05a9aa5bb494b962444ac354,What was the dose of docusate sodium (liquid) that was last prescribed to patient 10016742 since 03/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug = 'docusate sodium (liquid)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 dose FROM prescriptions WHERE patient_id = 10016742 AND drug_name = 'docusate sodium (liquid)' AND prescription_date >= '03/2100' ORDER BY prescription_date DESC
c8359c96bf05ca8e01953b73,Has patient 10004457 undergone percutaneous transluminal coronary angioplasty [ptca]?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous transluminal coronary angioplasty [ptca]' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 ),[{'COUNT(*)>0': 0}],SELECT EXISTS(SELECT 1 FROM procedure WHERE patient_id = 10004457 AND procedure_name = 'ptca')
e406dc4e0b4d87d40b90a07f,When did patient 10038933 receive sputum microbiology test the first time since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(date) FROM microbiology_tests WHERE patient_id = '10038933' AND test_type = 'sputum' AND date > '03/2100';
303a07985f7ef56f4d234d7e,Has patient 10026255 acquired any medication since 10/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'",[{'COUNT(*)>0': 1}],SELECT ...
2dd263172f5bf1ae381c6af1,What was the insurance for patient 10031404 in the first hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],select insurance from patient_records where patient_id = '10031404' and visit_number = 1
bf7d668907b28a333bad876e,What were the four most common tests conducted on specimens since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]","SELECT test_name, COUNT(*) AS test_count FROM laboratory_tests WHERE test_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) GROUP BY test_name ORDER BY test_count DESC LIMIT 4"
0920f71c3325e1a9f1fa383b,Count the number of patients who took neutra-phos in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'neutra-phos' AND strftime('%Y',prescriptions.starttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS Number_of_Patients FROM (SELECT DISTINCT patient_id FROM drug_exposure WHERE drug_concept_id = (SELECT concept_id FROM concept WHERE concept_name = 'Neutra-Phos') AND drug_exposure_start_date >= '2100-01-01') AS Unique_Patients
bc8eaff8a367f984fb5ce7ab,What was the first medication that patient 10026406 was prescribed via iv route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1,[],"SELECT MIN(STARTDATE) AS FirstIVDate, MEDNAME AS Medication FROM LABEVENTS WHERE SUBJECT_ID = 10026406 AND ROUTE = 'iv' GROUP BY MEDNAME ORDER BY FirstIVDate LIMIT 1"
5ad0b756f0eced9a61f3f0e2,What is the difference between heart rate on patient 10011398 measured at 2100-12-27 10:00:00 compared to the value measured at 2100-12-27 09:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 10:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 09:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 10:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-27 09:00:00' )"": None}]",SELECT (t1.heart_rate - t2.heart_rate) AS heart_rate_difference FROM patient_measurements AS t1 INNER JOIN patient_measurements AS t2 ON t1.patient_id = t2.patient_id WHERE t1.patient_id = '10011398' AND t1.time = '2100-12-27 10:00:00' AND t2.time = '2100-12-27 09:00:00';
e123951f763462b9fe67c32c,What are the top three most frequently prescribed drugs throughout this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3",[],"SELECT drug, COUNT(*) as prescription_count FROM prescriptions WHERE year = YEAR(CURRENT_DATE) GROUP BY drug ORDER BY prescription_count DESC LIMIT 3"
a5828bf7dab24b1221372dc4,How many people had a test for h in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'h' ) AND strftime('%Y',labevents.charttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS number_of_people FROM tests WHERE test_year = 2100 AND test_type = 'h';
fe47357d4996af8b8acb6162,What is the name of the medication that was prescribed to patient 10004422 for the last time via the po route in 01/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ORDER BY prescriptions.starttime DESC LIMIT 1",[],"SELECT MAX(order_date) AS last_prescription_date, drug_name FROM prescriptions WHERE patient_id = 10004422 AND route = 'po' AND order_date LIKE '01/2100%' GROUP BY drug_name ORDER BY last_prescription_date DESC LIMIT 1"
e48fc73023f959a4fcf5c5c4,What is the cost of percutaneous [endoscopic] gastrostomy [peg]?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) ),,"SELECT ""Price"" FROM ""MedicalProcedures"" WHERE ""Procedure""='Percutaneous Endoscopic Gastrostomy' AND ""Procedure"" LIKE '%peg%';"
2a3d64117cc11a9362dcd9fd,List the five most frequent diagnoses a patient was diagnosed with within 2 months after receiving central venous catheter placement with guidance since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,SQL Query
412c53a53a3b1c06f1f68772,What was the time it took for patient 13528 to undergo c.a.t. scan of thorax?,,,"SELECT patient_id, modality, examination_date, time_in_minutes FROM Radiology_Exams WHERE patient_id = 13528 AND modality = 'c.a.t. scan' AND body_part = 'thorax' ORDER BY examination_date DESC LIMIT 1"
fa39db2734c74d5812a74112,When was the first time patient 10027602 had input since 11/26/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2201-10-30 12:08:00'}],[select max(date) from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select date from (select
bebeb2104d4c95aa591562d9,"In this year, what was the last diagnosis for patient 10015860?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,SELECT LastDiagnosis FROM PatientRecords WHERE PatientID = '10015860' AND Year = YEAR(CURRENT_DATE)
0c11df1e6368179cdb62d5ea,What were the top four most common procedures?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Central venous catheter placement with guidance'}, {'long_title': 'Other nonoperative respiratory measurements'}]","SELECT Procedure, COUNT(*) as ProcedureCount FROM Procedures GROUP BY Procedure ORDER BY ProcedureCount DESC LIMIT 4"
437ed2f1fe3f680053f1e3de,"Tell me the number of cases of inspection of tracheobronchial tree, via natural or artificial opening endoscopic that occurred since 1 year ago.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,"SELECT count(*) FROM `physician_orders` WHERE `encounter_class` = 'Inpatient' AND `encounter_priority` = 'STAT' AND `service` = 'Radiology' AND `specimen_source` = 'Tracheobronchial Tree' AND `procedure` = 'Inspection, Tracheobronchial Tree, Via Natural or Artificial Opening Endoscopic' AND `encounter_date` >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
652d19150532597e8cba1e58,Has patient 10020306 been given any diagnosis since 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100'",,SELECT * FROM diagnosis WHERE patient_id = 10020306 AND date >= '2021-01-01'
136857d990a96067b0872cae,Can you tell me the name of the output patient 10022281 had for the last time since 233 days ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-233 day') ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],
3753ef6947f42f1a4e5a6a63,Has patient 9474 ever experienced any side effects during a blood transfusion?,,,"SELECT DISTINCT BloodTransfusionDetails.SID AS PatientID, BloodTransfusionDetails.SIDE_EFFECTS AS SideEffects FROM BloodTransfusionDetails WHERE BloodTransfusionDetails.SID = 9474 AND BloodTransfusionDetails.SIDE_EFFECTS IS NOT NULL ORDER BY BloodTransfusionDetails.BT_DATE ASC"
7993e77f8701f72acc7a2d5b,How much 0.9% sodium chloride was prescribed the last time on the last hospital encounter to patient 10019568?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = '0.9% sodium chloride' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"SELECT total_amount FROM prescription WHERE patient_id = '10019568' AND medication = '0.9% sodium chloride' ORDER BY encounter_date DESC, prescription_date DESC LIMIT 1"
44b000c0c7e63ce369e8fcb0,Can you tell me if patient 10039997 is male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10039997,[{'gender': 'F'}],SELECT gender FROM patient WHERE patient_id = '10039997';
3ec7578f9e5421f0bb600bba,Calculate the length of stay in days for patient 10001217's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.118032407015562}]",SELECT (JULIANDAY('2021-05-10') - JULIANDAY('2021-04-21')) AS LengthOfStay FROM PatientAdmissions WHERE PatientID = '10001217' AND AdmissionType = 'ICU' ORDER BY AdmissionDate ASC LIMIT 1
0367956da12e06e2e598864f,How many patients received left heart cardiac catheterization within the same hospital visit after being diagnosed with phlebitis and thrombophlebitis of superficial veins of upper extremities?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'phlebitis and thrombophlebitis of superficial veins of upper extremities' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'left heart cardiac catheterization' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,SELECT COUNT(*) FROM procedure_occurrence WHERE procedure_concept_id = 312198 AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM procedure_occurrence WHERE procedure_concept_id IN (SELECT concept_id FROM concept WHERE concept_name LIKE 'phlebitis of superficial vein of upper limb%') AND visit_occurrence_id = (SELECT visit_occurrence_id FROM procedure_occurrence AS p2 WHERE p2.person_id = procedure_occurrence.person_id AND p2.procedure_concept_id IN (SELECT concept_id FROM concept WHERE concept_name LIKE 'thrombophlebitis of superficial vein of upper limb%') AND p2.visit_occurrence_id = procedure_occurrence.visit_occurrence_id))
28150962c7244064887e1cfd,What is the minimum daily number of cases for acute diastolic (congestive) heart failure in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute diastolic (congestive) heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,SELECT MIN(cases) AS MinCases FROM heart_failure WHERE year = 2100 AND condition = 'acute diastolic (congestive)'
6ee1790753b54f997c67b31c,"What are the five most frequently given lab tests for patients that were diagnosed with dislocation of jaw, initial encounter previously during the same hospital visit, since 1 year ago?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dislocation of jaw, initial encounter' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT test_name, COUNT(*) AS test_count FROM lab_tests JOIN patients ON lab_tests.patient_id = patients.patient_id WHERE patients.diagnosis = 'dislocation of jaw, initial encounter' AND lab_tests.date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY test_name ORDER BY test_count DESC LIMIT 5"
c205b51f6231b94810bd8849,"In 05/this year, when did patient 10018328 receive their last medication via the po/ng route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(date) AS last_medication_date FROM medication_administration WHERE patient_id = '10018328' AND administration_route LIKE '%po%' OR administration_route LIKE '%ng%' AND MONTH(date) = 5 AND YEAR(date) = YEAR(CURDATE())
6ea26188016a8e0dcae6f2ca,When are dr. shears's rounds and procedures?,,,"SELECT ""DateTime"", ""ActivityType"" FROM ""Schedule"" WHERE ""DoctorID"" = (SELECT ""DoctorID"" FROM ""Doctors"" WHERE ""Name"" = 'Dr. Shears')"
0c46bd9e9a1925278db28a40,Can you name the procedure/treatment that patient 10038081 was given two or more times in 10/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-10' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"[SELECT procedure, COUNT(*)"
8576dc17a71fd1f052b49898,Has patient 10018081 gone through any procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ),[{'COUNT(*)>0': 1}],select * from procedures where patient_id = 10018081
5ccd34698e938f99b49819c5,"What is the minimum monthly number of patients affected by cerebral aneurysm, nonruptured?","SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral aneurysm, nonruptured' ) GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,"SELECT MIN(MonthlyPatients) AS MinMonthlyPatients FROM patient_records WHERE Condition = 'Cerebral Aneurysm, Nonruptured' GROUP BY Year, Month"
3cd0a6cd42161066ac6ee01a,What were the three most often conducted microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]",SQL Query
240b36c04ba129e0ec06c297,Tell me the maximum total hospital cost that involves cellulitis and abscess of trunk since 2100.,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cellulitis and abscess of trunk' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,select max(total_hospital_cost) as max_total_hospital_cost from [TABLE_ID
0d0fa264d945b5ef90978c92,What was the last hospital discharge time for patient 10022017?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2189-09-16 15:00:00'}],SELECT MAX(discharge_time) AS last_discharge_time FROM hospital_stays WHERE patient_id = '10022017';
8794ed581e861d00471884fd,How many patients were discharged during the last year from hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS discharged_patients FROM Discharge WHERE discharge_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW()"
510cd856f97ccd8e1ae62400,How many prescriptions were prescribed during the previous year for milk of magnesia?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'milk of magnesia' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)': 0}],select count(*) from prescriptions where drug_name = 'milk of magnesia' and prescription_date between '2019-01-01' and '2019-12-31'
28df687aecadf8f1d696c1f6,When has patient 10018845 been given phosphate test for the last time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT MAX(TestDate) AS LastTestDate FROM PhosphateTests WHERE PatientID = '10018845'
3d09ada3209f58b132f11030,Show me the length of time in days patient 10031757 was in the ICU during the last visit.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 2.1996527779847383}]","[SELECT DATEDIFF(day, MIN(I.Intime), MAX(I.Outtime)) AS ICUStayLength"
cc8d52ea13df2c173004e53e,Has patient 10015272 undergone a mch test?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ),[{'COUNT(*)>0': 0}],SELECT * FROM `patient_tests` WHERE `patient_id` = 10015272 AND `test_type` = 'mch'
f14d881d1381c847c13301a6,Did patient 73713 have overseas travel history?,,,SELECT CASE WHEN EXISTS (SELECT 1 FROM patient_history WHERE patient_id = 73713 AND travel_type = 'Overseas') THEN 'Yes' ELSE 'No' END as TravelHistory
2e5708405e832d182494a66b,What was the amount of straight cath output patient 10020740 had since 03/06/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'straight cath' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-06'",[{'SUM(outputevents.value)': None}],SELECT SUM(StraightCathOutput) FROM PatientData WHERE PatientID = 10020740 AND DateTime >= '2100-03-06'
e96c71afca103a3a2ccb1ec7,"The first time since 09/2100, when was patient 10006053 prescribed 0.9% sodium chloride and midazolam at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10006053 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'midazolam' AND admissions.subject_id = 10006053 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"SELECT MIN(date), date FROM chartevents WHERE itemid IN (SELECT itemid FROM d_items WHERE genericname IN ('0.9% sodium chloride', 'midazolam')) AND SUBJECT_ID = '10006053' AND (SELECT COUNT(DISTINCT date) FROM chartevents WHERE itemid IN (SELECT itemid FROM d_items WHERE genericname IN ('0.9% sodium chloride', 'midazolam')) AND SUBJECT_ID = '10006053' GROUP BY date) > 1 GROUP BY date HAVING MIN(date) > '2100-09-00'"
72692c9fe3d361f082e66556,What was the drug that was prescribed to patient 10015860 for the last time on their last hospital visit via the po/ng route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"select drug_name from prescriptions where patient_id = 10015860 order by visit_date desc, prescription_date desc limit 1 where route = 'po/ng'"
f93e415636fa3dd73984e7dc,What's the percentile of 6.0 in a alanine aminotransferase (alt) lab test at the same age as patient 10029484 during their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 6.0",,select percentile_cont(0.5) within group (order by alt) over (partition by age) from lab_tests where patient_id = (select patient_id from patients where patient_number = '10029484') and test_name = 'alanine aminotransferase (alt)' and visit_date = (select max(visit_date) from visits where patient_id = (select patient_id from patients where patient_number = '10029484'))
880b5cd212d4e5ed720e455e,What was the total nacl 0.9% amount given for patient 10021666?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],SELECT SUM(amount) FROM `drug_exposure` WHERE patient_id='10021666' AND drug_concept_id=(SELECT concept_id FROM concept WHERE concept_name='nacl 0.9%')
bba4bfd7b72b61f4f0a2b01a,Has patient 10020740 been treated with a parenteral infusion of concentrated nutritional substances procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ),[{'COUNT(*)>0': 0}],SELECT EXISTS(SELECT 1 FROM patient_treatments WHERE patient_id = 10020740 AND treatment_type = 'parenteral infusion of concentrated nutritional substances') AS has_been_treated
a1d4a46462d0cd1e638cddc8,What was the count of patients who were tested for magnesium since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS PatientCount FROM patient_tests WHERE test_date >= DATEADD(year, -1, GETDATE()) AND test_name = 'magnesium'"
1e644096c1912f2f70a3c917,What was patient 10015860's insurance name during the first hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],SELECT TOP 1 InsuranceName FROM HospitalVisits WHERE PatientID = '10015860' ORDER BY VisitDate ASC
4b381a5f887c98f632753d0c,What is the protocol of the anticancer drugs?,,,SELECT protocol FROM cancer_treatments WHERE treatment_type = 'anticancer drugs'
f1189d2c589416c9c81ca80e,"Since the first time patient 10004733 was diagnosed with chronic kidney disease, unspecified in this hospital visit, how many days have passed?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic kidney disease, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT DATEDIFF(CURDATE(), (SELECT MIN(DATE) FROM HospitalVisits WHERE PatientID = 10004733 AND Diagnosis = 'Chronic kidney disease, unspecified')) AS DaysSinceFirstDiagnosis FROM HospitalVisits WHERE PatientID = 10004733 AND Diagnosis = 'Chronic kidney disease, unspecified' LIMIT 1"
fbeef7a4b32462cf2f85c7ab,And what was the first time patient 10038933 was prescribed medication using the td route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(prescription_date) FROM prescriptions WHERE patient_id = 10038933 AND route = 'td'
b463fec617a5b7561a49f7e8,"Get me the top four most frequent drugs that patients were prescribed in the same month after being diagnosed with accidental cut, puncture, perforation or hemorrhage during heart catheterization in 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental cut, puncture, perforation or hemorrhage during heart catheterization' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"select drug, count(*) as frequency from diagnosis_records dr, prescription_records pr where dr.patient_id = pr.patient_id and dr.diagnosis_code = 'accidental cut, puncture, perforation or hemorrhage during heart catheterization' and year(dr.diagnosis_date) = 2100 and month(dr.diagnosis_date) = month(pr.prescription_date) group by drug order by frequency desc limit 4"
e07cb0702bd8c962c980b344,Can you tell me patient 10002495's daily minimum weight since 19 months ago?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-19 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT ""day"", MIN(""weight"") as ""Daily_Minimum_Weight"" FROM ""weight"" WHERE ""patient_id"" = 10002495 AND ""day"" > (CURRENT_DATE - INTERVAL '19 months') GROUP BY ""day"" ORDER BY ""day"""
abc85f653325ca0da7e82fce,"What are the four most commonly tested specimens for patients who were diagnosed with other fluid overload previously within 2 months, since 1 year ago?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other fluid overload' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"[SELECT specimen_type, COUNT(*) AS count"
0f1f7818e92f4038e40e8fb5,"Show me the top five most commonly prescribed drugs during the same hospital encounter to the patients aged 40s after diagnosed with epilepsy, unspecified, not intractable, without status epilepticus.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, not intractable, without status epilepticus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"select top 5 drug_name, count(drug_name) as total from (select distinct drug_name, patient_id, visit_id from drug_exposure join patient on drug_exposure.patient_id = patient.id where drug_exposure.visit_id in (select visit_id from diagnosis where diagnosis_code = '345.90' and patient_age between 40 and 49)) as drug_list group by drug_name order by total desc;"
567c419acd4847f820befc6f,"How many people were diagnosed with depressive disorder, not elsewhere classified in 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'depressive disorder, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )",,"select count(*) from diagnosis where disorder_name='Depressive disorder, not elsewhere classified' and diagnosis_date='2100'"
69b677906abcc409eb49619a,Show me the top four most frequent diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Hyperlipidemia, unspecified'}, {'long_title': 'Essential (primary) hypertension'}]","select * from (select Diagnosis, count(*) as count from Diagnoses group by Diagnosis order by count desc limit 4) d"
88a7e76c42b80b33bdb68d60,Show me the top three diagnoses with the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",,"SELECT TOP 3 diagnosis, AVG(ThreeMonthMortalityRate) AS AverageMortalityRate FROM PatientRecords WHERE DischargeDate >= DATEADD(MONTH, -3, GETDATE()) GROUP BY diagnosis ORDER BY AverageMortalityRate DESC"
61dc7e082e6c06af309663c7,When did patient 10002495 have the last maximum mcv value in 06/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],"SELECT TOP 1 e.event_time FROM (SELECT t2.event_time, t2.mcv_value FROM event_measurement_value t2 WHERE t2.event_id IN (SELECT t1.event_id FROM event t1 WHERE t1.patient_id = 10002495 AND t1.event_time LIKE '06%')) e WHERE e.mcv_value = (SELECT MAX(mcv_value) FROM event_measurement_value WHERE event_id IN (SELECT t1.event_id FROM event t1 WHERE t1.patient_id = 10002495 AND t1.event_time LIKE '06%')) ORDER BY e.event_time DESC"
725f32d2feda840d1ff1d579,The last time patient 10021487 was prescribed sodium bicarbonate and 5% dextrose at the same time since 11/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(date) FROM prescriptions WHERE patient_id = 10021487 AND (drug_name = 'sodium bicarbonate' OR drug_name = '5% dextrose') GROUP BY date HAVING COUNT(DISTINCT drug_name) = 2 AND date > '11/2100'
66d3360a6cad5a5a584ea115,"What are the four most frequent diagnoses that patients were diagnosed within the same month after having received a extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic procedure since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT top 4 diagnosis, COUNT(diagnosis) AS frequency FROM bronchoscopy_records WHERE procedure_code = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' AND diagnosis_date >= '2100-01-01' AND diagnosis_date < DATEADD(month, 1, procedure_date) GROUP BY diagnosis ORDER BY frequency DESC"
4c376d728b885b57cae6d692,"How many people had a test for amylase, body fluid?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, body fluid' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM medical_tests WHERE test_name = 'amylase' AND sample_type = 'body fluid';
d9529dbe9af1c4a2f0911379,Has patient 10002495 been tested on phosphate in 06/this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06'",[{'COUNT(*)>0': 0}],SELECT * FROM blood_tests WHERE patient_id = 10002495 AND test_name = 'phosphate' AND test_date BETWEEN '2023-06-01' AND '2023-06-30';
ef514e32ea077744d1c08f2e,Could you retrieve the top four most conducted lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",Your SQL Query Here
986a2a3bde40fef4fc375ef2,What were the top three most frequent microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]",SQL Query
43a04bb201473909218db1f2,Has there been a epithelial cells lab test performed on patient 10018081 during this month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM lab_tests WHERE patient_id = 10018081 AND test_name = 'epithelial cells' AND test_date >= DATE_FORMAT(NOW() ,'%Y-%m-01') AND test_date < NOW()"
d999d5a343bd58aa54b40298,Could you retrieve the top five diagnoses that have the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT diagnosis, mortality_3mth FROM diagnoses ORDER BY mortality_3mth DESC LIMIT 5"
5dcb3867960ccfe76a673b5e,What were the top five most common diagnoses since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"[SELECT diagnosis, COUNT(*) as diagnosis_count"
9191a69ae68cf1a4e5e3ebba,When was the last time on the first ICU stay patient 10020944's SaO2 was greater than 99.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 99.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT MIN(MeasurementDateTime) AS LastTimeSaO2Above99 FROM Measurement WHERE SubjectID = '10020944' AND MeasurementType = 'SaO2' AND Value > 99.0 AND StaySequence = 1 AND RowID IN (SELECT MAX(RowID) FROM Measurement WHERE SubjectID = '10020944' AND StaySequence = 1 GROUP BY MeasurementDateTime)
13fab13d5c28d10640de8024,"In their first hospital encounter, how old was patient 10037861?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,,SELECT Age FROM Patients WHERE PatientID = 10037861 AND EncounterNumber = 1
615f5677e858fc4ef464a1a0,Tell me the daily average amount of patient 10021118's nacl 0.9% input in this month.,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],SELECT AVG(amount) AS daily_average_amount FROM inputevents_mv WHERE patient_id = '10021118' AND inputtype_cd = 'nacl 0.9%' AND inputdate >= '2023-10-01' AND inputdate < '2023-11-01' GROUP BY DATE(inputdate);
a5137665c5ab5a44b8006d8e,What is the minimum total hospital cost that includes a procedure called laparoscopic partial cholecystectomy?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic partial cholecystectomy' ) ) GROUP BY cost.hadm_id ) AS T1,,select min(total_hospital_cost) from `physionet-data.mimiciii_hospital.stay_detail` where procedure_description like '%laparoscopic partial cholecystectomy%';
9e9072f0ced4b6c391c00916,"For patients who undertook right heart cardiac catheterization during the same month, what are the top three most frequent specimens tested afterward in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 specimen_tested, COUNT(*) AS frequency FROM encounters WHERE procedure = 'right heart cardiac catheterization' AND YEAR(procedure_date) = 2100 GROUP BY specimen_tested ORDER BY frequency DESC"
2532d7b2500ba53d5b6005e9,When had patient 10009035 first been prescribed for metoprolol tartrate and senna at the same time in 05/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metoprolol tartrate' AND admissions.subject_id = 10009035 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'senna' AND admissions.subject_id = 10009035 AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],select min(encounter_date) from (select encounter_date from encounters where patient_id = 10009035 and medication = 'metoprolol tartrate' and encounter_date like '05/2100%' and encounter_type = 'prescription') as first_metoprolol join (select encounter_date from encounters where patient_id = 10009035 and medication = 'senna' and encounter_date like '05/2100%' and encounter_type = 'prescription') as first_senna on first_metoprolol.encounter_date = first_senna.encounter_date
3d734e7730e119eb7ecbb9e5,How many people got prescriptions for fish oil (omega 3) since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fish oil (omega 3)' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM prescriptions WHERE item_description LIKE '%fish oil%' AND item_description LIKE '%omega 3%' AND date_prescribed >= '2100-01-01'
f79c2af96dde359ecee262e9,Can you tell me which four diagnoses have the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT TOP 4 dx, ROUND((deaths/total)*100, 2) AS three_month_mortality_rate FROM (SELECT dx, SUM(deaths) AS deaths, SUM(total) AS total FROM (SELECT dx, deaths, total FROM diagnosis_icd LEFT OUTER JOIN mortality_stats ON diagnosis_icd.dx = mortality_stats.icd_code WHERE mortality_stats.time_period = '3 months') AS subquery GROUP BY dx) AS mortality_rates ORDER BY three_month_mortality_rate DESC"
bea830fb10c315727fb3899b,When did since 05/2100 patient 10018081 take the last microbiology test?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2134-09-17 06:24:00'}],SELECT MAX(Date) AS Last_Microbiology_Test_Date FROM microbiology_tests WHERE Patient_ID = 10018081 AND Date >= '2100-05-01'
4eaa02f29374fda17d73e7cc,What is the average total hospital cost for a procedure involving single internal mammary-coronary artery bypass since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_hospital_cost) FROM ProcedureCosts WHERE procedure_description LIKE '%single internal mammary-coronary artery bypass%' AND date_of_procedure >= '2100-01-01'
c7279aab21fca4862f9c138a,"On the last hospital visit, what was patient 10026406's insurance plan?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Other'}],SELECT insurance_plan FROM hospital_visits WHERE patient_id = 10026406 AND visit_date = (SELECT MAX(visit_date) FROM hospital_visits WHERE patient_id = 10026406)
4a6773499778d85e09dc660a,"Since 2100, how many patients had been diagnosed with dementia, unspecified, without behavioral disturbance?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dementia, unspecified, without behavioral disturbance' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,"SELECT COUNT(*) FROM patient_records WHERE diagnosis = 'dementia, unspecified' AND behavioral_disturbance = 'no' AND year_of_diagnosis >= 2100"
bb12c097d6c3840101205ef8,What was the five most common lab test that was given in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],"SELECT lab_test, COUNT(*) AS test_count FROM lab_results WHERE date = 2100 GROUP BY lab_test ORDER BY test_count DESC LIMIT 5"
cd733e64db1b7801954ac9ac,Where are the single rooms out there now?,,,"select room_number, room_type, floor, building from rooms where room_type='single' and is_available=true"
02bd66cb3a751f53d4accb0a,"What number of hours has it been since the last time patient 10004733 was diagnosed with dysphagia, oropharyngeal phase in their current hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphagia, oropharyngeal phase' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,select current_timestamp() - max(encounter.encounter_datetime) from encounter where patient_id = 10004733 and encounter_diagnosis_diagnosis_id = 1645 and encounter_type = 'hospital-encounter' group by patient_id
afe1bb1212af5b8def3b6bca,List the top four most frequent microbiology tests that were given to patients after they were diagnosed with acute embolism and thrombosis of deep veins of right upper extremity during the same hospital encounter.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute embolism and thrombosis of deep veins of right upper extremity' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 microbiology_test, COUNT(*) AS test_count FROM microbiology_tests WHERE patient_diagnosis = 'acute embolism and thrombosis of deep veins of right upper extremity' GROUP BY microbiology_test ORDER BY test_count DESC"
755568f5da1aa36f192dbdd8,Have any lab tests been performed on patient 10027445 in this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM LabTests WHERE PatientID = '10027445' AND TestDate >= '2023-01-01' AND TestDate <= '2023-12-31'
4f00325c6536b67bbcfa20b1,What was the number of patients that were given a mch test during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT PatientID) AS NumberOfPatients FROM LaboratoryTests WHERE TestType = 'MCH' AND TestDate BETWEEN '2022-01-01' AND '2022-12-31'
6a7324498e10c064190ceb7f,What are the three most frequently prescribed drugs since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]","SELECT TOP 3 drug_name, COUNT(*) AS prescription_count FROM prescriptions WHERE year >= 2100 GROUP BY drug_name ORDER BY prescription_count DESC"
c8c5c2ee11a8da094f25c3bc,What was the last dose of ondansetron that patient 10025612 was prescribed during the first hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'ondansetron' ORDER BY prescriptions.starttime DESC LIMIT 1,[],select max(ondansetron) from prescriptions where patient_id = 10025612 and visit_number = 1
0d0dfd8344c44ef1ba5abcc4,What was the name of patient 10014078's insurance in the last hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicaid'}],SELECT insurance_name FROM patient_visits WHERE patient_id = '10014078' ORDER BY visit_date DESC LIMIT 1
c060af6a8bb23ffdee50e730,What was the first input time of patient 10004733 since 10/30/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-30' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2174-12-04 12:34:00'}],SELECT MIN(InputTime) AS FirstInputTime FROM DialysisData WHERE PatientID = '10004733' AND InputTime >= '10/30/2100'
935352db3b3a1d247e88bdc4,How many days have passed since patient 10004733 had the last alanine aminotransferase (alt) lab test in the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(day, MAX(visit_lab.date), GETDATE()) AS days_since_last_alt_lab FROM (SELECT * FROM encounter WHERE patient_id = 10004733) AS visit_encounter INNER JOIN (SELECT * FROM lab WHERE test_name = 'ALT') AS visit_lab ON visit_encounter.encounter_id = visit_lab.encounter_id WHERE visit_encounter.hospital = 'Current Hospital';"
99abc2a37fa7ff26ae5a4483,Give me the three most common treatments.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Other nonoperative respiratory measurements'}]","[SELECT Treatment, COUNT(PatientID) AS PatientCount"
7ec0ab7e9f87fb5c34405276,What was the first time since 03/2100 patient 10029291 was prescribed a medication via the neb route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"SELECT TOP 1 ""MedicationDate"" FROM ""MedicationAdministration"" WHERE ""PatientID"" = 10029291 AND ""Route"" = 'Neb' AND ""MedicationDate"" > '2100-03-21' ORDER BY ""MedicationDate"" ASC"
b4c01b9c3a018f29ade4acf5,When was the last time that patient 10001725 has been prescribed medication via the po/ng route in their first hospital visit?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SQL query
8f3e188a5ef2fa6208206b5f,Patient 10014729 was diagnosed in their last hospital encounter for the first time with what?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,select distinct icd9 from lab_encounter where patid = 10014729 and icd9 not in (select icd9 from lab_encounter where patid = 10014729 and end_date < '2004-12-08') and end_date = '2004-12-08'
5a7361bff9784d49a8234e8a,What is the minimum total hospital cost that involved a procedure called other enterostomy since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other enterostomy' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_hospital_cost) AS minimum_cost FROM hospital_costs WHERE procedure_name = 'Other Enterostomy' AND year >= 2100;
32176427d268868d414b69a1,Has patient 10038933 been admitted into the emergency room since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) AS 'admission_count' FROM EmergencyRoomAdmissions WHERE patient_id = 10038933 AND admission_time >= '21:00:00';
7172db99077f820626236cfa,What is the total number of other fasciectomy procedures that took place since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other fasciectomy' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT COUNT(*) AS TotalOtherFasciectomyProcedures FROM `physician_notes` WHERE `procedure` LIKE '%fasciectomy%' AND `procedure` NOT LIKE '%open%' AND `procedure` NOT LIKE '%endoscopic%' AND `procedure` NOT LIKE '%surgical%' AND `procedure` NOT LIKE '%percutaneous%' AND `procedure` NOT LIKE '%endovascular%' AND `procedure` NOT LIKE '%minimally invasive%' AND `procedure` NOT LIKE '%robotic%' AND `procedure` NOT LIKE '%laparoscopic%' AND `procedure` NOT LIKE '%open%' AND `procedure` NOT LIKE '%endoscopic%' AND `procedure` NOT LIKE '%percutaneous%' AND `procedure` NOT LIKE '%endovascular%' AND `procedure` NOT LIKE '%laparoscopic%' AND `procedure` NOT LIKE '%open%' AND `procedure` NOT LIKE '%robotic%' AND `date` >= '2100-01-01';
e69db8778c92e5eec552f1eb,Has there been a hospital admission for patient 10005817 in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005817 AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT(*)>0': 0}],select * from admissions where patient_id = '10005817' and YEAR(admission_date) = '2100'
aca1e0e3be80e222d3b95be5,"How many hours has it been since the first time that patient 10021487 was diagnosed with cardiac complications, not elsewhere classified on this hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac complications, not elsewhere classified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"select datediff(hour, min(encounter_datetime), getdate()) from encounter where patient_id = '10021487' and diagnoses icd10 = 'I51.8' and encounter_datetime = (select min(encounter_datetime) from encounter where patient_id = '10021487' and diagnoses icd10 = 'I51.8')"
5f1dc42ba1c4cd7cad30e93d,What was the last time of input of patient 10027602 on last month/28?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',inputevents.starttime) = '28' ORDER BY inputevents.starttime DESC LIMIT 1",[],"SELECT MAX(input_time) AS last_time FROM patient_input_data WHERE patient_id = 10027602 AND DATE_FORMAT(input_time, '%Y-%m') = DATE_FORMAT(CURRENT_DATE - INTERVAL 1 MONTH, '%Y-%m') AND DAY(input_time) = 28;"
d50ac96f2f625bb2840762bf,What was the last dose of alteplase (catheter clearance) that on their last hospital visit was prescribed to patient 10019777?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'alteplase (catheter clearance)' ORDER BY prescriptions.starttime DESC LIMIT 1,[],select top 1 * from drug_exposure where person_id=10019777 and drug_concept_id=(select concept_id from concept where concept_name='ALTEPLASE') and drug_type_concept_id=(select concept_id from concept where concept_name='catheter clearance') order by drug_exposure_end_date desc
c7913f24b079937963ea9f4f,What was the total number of patients on vascular in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT SUM(patient_count) FROM admissions WHERE department = 'Vascular' AND YEAR(admission_date) = YEAR(CURDATE())
29af2e5e1ea84750efeb2ac2,When did patient 10013049 get discharged from the hospital for the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10013049 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(date) FROM patient_discharge WHERE patient_id = 10013049
b9ac1bb7e36dd0d95acbf39c,Can you tell the three most frequent lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","select test_type, count(*) as frequency from lab_tests where test_date > '2100-01-01' group by test_type order by frequency desc limit 3;"
0a8c46b684e72300d29c18aa,What drug was prescribed to patient 10010471 for the last time?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[{'drug': 'LORazepam'}],SELECT TOP 1 drug_name FROM prescriptions WHERE patient_id = '10010471' ORDER BY prescription_date DESC
fceaf877c094825a80b15f57,"What were the last potassium, whole blood results for patient 10018081 since 12/2100?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.charttime DESC LIMIT 1",[],"select top 1 result, result_date, normal_flag from lab_results where patient_id = 10018081 and test_name = 'Potassium, whole blood' and result_date > '12/2100' order by result_date desc"
b3c91b713aa0b269e1c13630,Calculate patient 10007818's total output since 06/07/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-07'",[{'SUM(outputevents.value)': 31939.0}],SELECT SUM(output) AS total_output FROM patient_measurements WHERE patient_id = 10007818 AND measurement_date >= '2100-06-07';
a0c63dd8ba51ee400d101df7,Could you tell me the name of the drug prescribed to patient 10027602 in the same day after the insertion or replacement of external ventricular drain [evd] procedure since 05/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,"SELECT mdr_drug_name FROM mde_drug_exposure WHERE person_id = 10027602 AND (drug_exposure_start_date BETWEEN (SELECT DATE_ADD( CAST(date AS DATE), INTERVAL 1 DAY) FROM mde_procedure_occurrence WHERE person_id = 10027602 AND procedure_concept_id = 4200030 AND date >= '05/2100') AND (SELECT DATE_ADD( CAST(date AS DATE), INTERVAL 1 DAY) FROM mde_procedure_occurrence WHERE person_id = 10027602 AND procedure_concept_id = 4200030 AND date >= '05/2100'))"
25036a06119f918d2956f2e6,Give me the total amount of output since 11/16/2100 for patient 10010471.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-16'",[{'SUM(outputevents.value)': 180.0}],"select sum(amount) from (select amount from (select amount, patient_id, date from (select sum(amount) as amount, patient_id, date from chartevents where itemid in (211, 1500, 3745, 4560, 4551, 3744, 223901, 678, 220739, 220051, 220050, 227242, 678, 675, 223900, 1502, 4552, 678) group by patient_id, date) chartevents where chartevents.patient_id = 10010471) chartevents where chartevents.date >= '11/16/2100') chartevents"
690cfb24a4808aace8c6a75a,How much does patient 10019777 change in weight second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT (MAX(measurement.value) - MIN(measurement.value)) AS weight_change FROM measurement JOIN patient ON measurement.patient_id = patient.id WHERE patient.id = 10019777 AND measurement.measurement_concept_id = 3024454 AND measurement.visit_occurrence_id IN (SELECT visit_occurrence_id FROM visit_occurrence WHERE patient_id = 10019777 ORDER BY visit_start_date DESC LIMIT 1)
dd91706df84d8357cdef457f,What are the immuno-cancer drugs that have been on for the last 5 years.,,,"SELECT DrugName FROM ImmunoCancerDrugs WHERE ApprovedDate >= DATE_SUB(CURRENT_DATE, INTERVAL 5 YEAR)"
d754a3e8d810070834fab3af,What is the average total hospital cost that involves other appendectomy procedure in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other appendectomy' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(TotalHospitalCost) AS AvgTotalHospitalCost FROM inpatient WHERE DRGDefinition = 'Other Appendectomy Procedures' AND Year = 2100
ae4b7b569f1122fb6951ca6f,Get me patient 10016810's total output volume in the last ICU stay.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ),[{'SUM(outputevents.value)': 5090.0}],select sum(output_volume) from icu_stays where patient_id='10016810' and stay_end_date = (select max(stay_end_date) from icu_stays where patient_id='10016810')
c616ccb02a7104766a7ca4e7,"What's the cost of a procedure called excision of left saphenous vein, percutaneous endoscopic approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left saphenous vein, percutaneous endoscopic approach' ) )",,"SELECT Total_Charge FROM Procedure_Charges WHERE Procedure_Code = (SELECT Procedure_Code FROM Procedures WHERE Description = 'Excision of left saphenous vein, percutaneous endoscopic approach')"
c9e6ec1ba862ca6788412403,"In 2100, what are the top three most frequent medications prescribed within the same hospital visit to the patients in their 60 or above after they were diagnosed with other ascites?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other ascites' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 medication_name, COUNT(*) AS frequency FROM prescriptions JOIN diagnoses ON prescriptions.patient_id = diagnoses.patient_id JOIN patients ON prescriptions.patient_id = patients.id WHERE diagnoses.year = 2100 AND diagnoses.condition = 'other ascites' AND patients.age >= 60 GROUP BY medication_name ORDER BY frequency DESC"
0bcf658b419c2cb56787d659,Tell me the insurance plan in place for patient 10005909 in the first hospital encounter.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],SELECT InsurancePlan FROM HospitalEncounters WHERE PatientID = '10005909' AND EncounterNumber = 1 LIMIT 1
b3ed67a0532299ba3cb949a9,Show me the five most common microbiology tests performed.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]","SELECT test_name, COUNT(*) as test_count FROM microbiology_tests GROUP BY test_name ORDER BY test_count DESC LIMIT 5"
7b673569df3b4b123b597c43,Is the arterial blood pressure diastolic reading for patient 10019172 second measured on the first ICU visit greater than the value first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN MAX(CASE WHEN VALUE_NUM IS NOT NULL THEN VALUE_NUM ELSE NULL END) > MIN(CASE WHEN VALUE_NUM IS NOT NULL THEN VALUE_NUM ELSE NULL END) THEN 'Yes' ELSE 'No' END AS Is_Diastolic_Second_Greater FROM EMAR WHERE SUBJECT_ID = '10019172' AND HADM_ID IN (SELECT HADM_ID FROM ADMISSIONS WHERE SUBJECT_ID = '10019172' AND ADMISSION_TYPE = 'EMERGENCY' AND ADMITTIME = (SELECT MIN(ADMITTIME) FROM ADMISSIONS WHERE SUBJECT_ID = '10019172' AND ADMISSION_TYPE = 'EMERGENCY')) AND ITEMID IN (SELECT ITEMID FROM D_ITEMS WHERE ITEMID IN (455, 456) AND VALUE_TYPE = 'VALUENUM') AND CATEGORY = 'VITALSIGN' AND VALUENUM IS NOT NULL GROUP BY SUBJECT_ID, HADM_ID"
109bdf00fc8e0bc665794600,Has patient 10022880 entered the hospital since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022880 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 1}],SQL Query
f3bebe99a5275c408f17b181,Has patient 10005909 undergone laboratory tests since 03/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03'",[{'COUNT(*)>0': 1}],select * from laboratory_tests where patient_id = 10005909 and test_date > '03/2100';
b43b8df345f082e968c0504d,When did patient 10038081 first get the mrsa screen's microbiology test since 01/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],select distinct microbiology_test_date from microbiology_tests where patient_id = 10038081 and test_type = 'mrsa screen' and microbiology_test_date >= '2100-01-01' order by microbiology_test_date limit 1
f0042425f5c80fc4ec492cf0,What are the top five most common medications prescribed within 2 months to the patients aged 60 or above after they were diagnosed with diplopia?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diplopia' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 Medication, COUNT(*) AS MedicationCount FROM Prescriptions WHERE Diagnosis = 'diplopia' AND PatientAge >= 60 AND PrescriptionDate BETWEEN DiagnosisDate AND DATEADD(MONTH, 2, DiagnosisDate) GROUP BY Medication ORDER BY MedicationCount DESC"
d41f44da71b3e6d40f476229,"Among patients diagnosed with impaired fasting glucose, what were the top three most common microbiology tests conducted within 2 months since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'impaired fasting glucose' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3",,"SELECT microbiology_test, COUNT(microbiology_test) AS test_count FROM microbiology_tests INNER JOIN admissions ON microbiology_tests.admission_id = admissions.admission_id WHERE admissions.diagnosis_code = 'impaired fasting glucose' AND admissions.admission_date >= '2100-01-01' AND admissions.discharge_date <= admissions.admission_date + INTERVAL '2 months' GROUP BY microbiology_test ORDER BY test_count DESC LIMIT 3"
1757227b484201499ac650b9,Has patient 10022041 received a laboratory test for vitamin b12?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ),[{'COUNT(*)>0': 0}],SELECT * FROM laboratory_tests WHERE patient_id = 10022041 AND test_name = 'Vitamin B12'
aaca78ea66f02f483ebdf478,What's the cost of a procedure called regional lymph node excision?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'regional lymph node excision' ) ),,SELECT cost FROM procedures WHERE procedure_name = 'regional lymph node excision';
5d27d425de44d1e9e60bb681,What was the count of patients who were tested for troponin t since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) AND strftime('%Y',labevents.charttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patients WHERE troponin_t_tested_after_2100 = TRUE
493ddb9a69efd787e0396f81,Has patient 10027602 received any laboratory testing in this year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT * FROM Laboratory_Test WHERE patient_id = 10027602 AND YEAR(test_date) = YEAR(CURDATE())
ed72f24083966a774f22b122,What was the name of the output that patient 10031757 got first since 06/05/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'OR EBL'}],SELECT TOP 1 result_name FROM patient_test_results WHERE patient_id = '10031757' AND test_date >= '2100-06-05' ORDER BY test_date ASC
e7db6c421273de71b7f9b8a7,What is the average cost to the hospital that involves personal history of other diseases of digestive system?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other diseases of digestive system' ) ) GROUP BY cost.hadm_id ) AS T1,,SQL query to answer the question
213a702cca16592f4d19705a,Was patient 10015931 given a magnesium lab test on the last hospital visit?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],SQL Query here
f8afb5281dcdfe12ea07f322,How much is the price for lenalidomide (revlimide)15mg?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lenalidomide (revlimide)15mg' ),,SELECT `Price` FROM `drug_prices` WHERE `Drug Name` = 'lenalidomide (revlimide)' AND `Strength` = '15mg'
5e947ca43ffbad49cde64c05,"I mean, what is the reimbursement standard for cerebrovascular mri?",,,select reimbursement_standard from medical_procedures where procedure_name = 'cerebrovascular MRI'
098602cc877f3e4c36bc908a,"Among the patients of age 60 or above in 2100, what are the top five most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS diagnosis_count FROM patient_records WHERE YEAR(date_of_birth) <= 2040 AND YEAR(date_of_diagnosis) = 2100 GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 5"
ed2e1e9eb814e9ee71358ddb,When was the first input of patient 10004733 since 05/10/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-10' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2174-12-04 12:34:00'}],SELECT MIN(input_date) AS FirstInputDate FROM patient_records WHERE patient_id = '10004733' AND input_date >= '2100-05-10';
ea237bbea67442bc6b962cce,How many patients were diagnosed with alkalosis after already being diagnosed with postinflammatory pulmonary fibrosis within 2 months?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postinflammatory pulmonary fibrosis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alkalosis' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT COUNT(DISTINCT patient_id) FROM patient_diagnoses WHERE diagnosis_code = 'alkalosis' AND patient_id IN (SELECT patient_id FROM patient_diagnoses WHERE diagnosis_code = 'postinflammatory pulmonary fibrosis' AND TIMESTAMPDIFF(MONTH, diagnosis_date, (SELECT MIN(diagnosis_date) FROM patient_diagnoses AS pd WHERE pd.patient_id = patient_diagnoses.patient_id AND diagnosis_code = 'alkalosis')) <= 2)"
af07d2b195d6add6909c4f64,When will patient 17953 next go to the hospital?,,,select min(date) from appointments where patient_id = 17953 and date >= now()
19bbba7c30b65e559cde2364,Tell me the top four most frequent lab tests that patients were given during the same hospital encounter after being diagnosed with dependence on respirator [ventilator] status in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on respirator [ventilator] status' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT lab_tests, COUNT(*) as frequency FROM hospital_encounter_records WHERE diagnosis = 'dependence on respirator status' AND year = 2100 GROUP BY lab_tests ORDER BY frequency DESC LIMIT 4"
70fb08c9ae39f471ccb4c81a,Can you show me the top five most common procedures conducted?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Central venous catheter placement with guidance'}, {'long_title': 'Coronary arteriography using two catheters'}, {'long_title': 'Other nonoperative respiratory measurements'}]","SELECT procedure, COUNT(*) AS procedure_count FROM lab_procedures GROUP BY procedure ORDER BY procedure_count DESC LIMIT 5"
d0bd21030a9fe3f066df09b3,Was patient 10022880 diagnosed with any type of disease in the last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,select * from diagnoses where patient_id='10022880' and diagnosis_date between '2022-01-01' and '2023-01-01'
06ba722e2ac0589ffacd1249,How many hours have elapsed since the last time on this hospital visit patient 10039831 received a lab test for creatinine?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],Your SQL Query Here
951e44d16291cab791c2b2dc,What was the drug that patient 10020740 was prescribed for within the same day after undergoing continuous invasive mechanical ventilation for less than 96 consecutive hours in 04/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-04' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,SELECT ...
8f1e4140fd54d60a4a21a46e,What drug was first prescribed to patient 10021938?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Senna'}],SELECT drug FROM prescriptions WHERE patient_id = 10021938 ORDER BY prescription_date ASC LIMIT 1
6ec318a2ef73df94df5bdcae,Has any organism been found in patient 10007058's last microbiological serology/blood test in 11/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND microbiologyevents.spec_type_desc = 'serology/blood' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],SELECT COUNT(*) AS organism_count FROM microbiological_serology_blood_tests WHERE patient_id = '10007058' AND test_date = '2100-11-01';
dd2c47d5a140368a2b1f07a1,When was patient 10006053's last input during their last ICU visit?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,[{'starttime': '2111-11-15 14:03:00'}],SELECT MAX(input_datetime) as last_input_date FROM chartevents WHERE patientnum = 10006053 AND itemid = 225641 AND SUBJECT_ID IN (SELECT SUBJECT_ID FROM icustays WHERE patientnum = 10006053 AND (INTIME < (SELECT MAX(INTIME) FROM icustays WHERE patientnum = 10006053) AND OUTTIME > (SELECT MAX(INTIME) FROM icustays WHERE patientnum = 10006053)))
f9f35588ccc8bc79535ff166,Give me the three most common treatments since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT treatment, COUNT(treatment) AS treatment_count FROM medical_records WHERE year >= 2100 GROUP BY treatment ORDER BY treatment_count DESC LIMIT 3"
956020fbb55b1050204ceebd,What's the name of the med that shouldn't be given during exc/dest hrt lesion open.,,,SELECT medication_name FROM medications WHERE contraindications LIKE '%excisional or destructive heart lesion open%'
05708c73dfad0a3f4781563a,Could you count the number of times patient 10010471 visited the hospital?,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10010471,[{'COUNT( DISTINCT admissions.hadm_id )': 2}],select count(*) from encounters where person_id = 10010471
1792bdbac4e9db2d02bb207a,Could you list the three diagnoses that had the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",,"SELECT Diagnosis, MAX(`3 Month Mortality`) AS Highest_Mortality FROM `ICD_3_Month_Mortality_Rates` GROUP BY Diagnosis ORDER BY Highest_Mortality DESC LIMIT 3"
19aa80f1a14f42697fdcba60,What was the total ostomy (output) volume that patient 10018081 had since 11/30/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ostomy (output)' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-30'",[{'SUM(outputevents.value)': None}],SELECT SUM(volume) AS TotalOstomyVolume FROM ostomy_output WHERE patient_id = '10018081' AND date >= '11/30/2100'
3e4e9c6556f0bae69a76633d,When did patient 10027602 last receive a blood culture microbiology test since 07/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(test_date) FROM blood_culture_microbiology WHERE patient_id = 10027602 AND test_date > '07-2100';
9e13de1d202dab1dcf105976,"In the last hospital visit, what age was patient 10025463?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,SELECT age FROM PatientRecords WHERE patient_id = '10025463' AND visit_date = (SELECT MAX(visit_date) FROM PatientRecords WHERE patient_id = '10025463')
ab4e7468a6d2dfc3bdbc9ff6,Is patient 15821 having an appointment in another department?,,,SELECT COUNT(*) FROM appointment WHERE patient_id = 15821 AND department_id != (SELECT department_id FROM patient WHERE patient_id = 15821) AND status = 'scheduled'
783bda443eb8e764428abb4d,"When has patient 10001217 last had the total protein, csf minimum value since 12/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],"SELECT MAX(test_date) FROM lab_results WHERE patient_id = '10001217' AND test_name = 'total protein, csf minimum' AND test_date >= '2012-01-01'"
a2c56aa731442cc35b8f88dc,When has patient 10002495 been prescribed medication for the first time on the first hospital encounter via the iv route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'iv' ORDER BY prescriptions.starttime ASC LIMIT 1,[],"select min(e.encounter_id), e.encounter_id, m.medication_id, m.medication from encounter e join prescription pr on e.encounter_id = pr.encounter_id join medication m on pr.medication_id = m.medication_id join administration a on pr.prescription_id = a.prescription_id where e.patient_id = 10002495 and e.encounter_id = (select min(encounter_id) from encounter where patient_id = 10002495) and m.route = 'iv' and a.route = 'iv' group by m.medication_id limit 1"
9235d1bea2de86e8bfe34a29,Do you know the method of disinfection in the quarantine room?,,,select method from disinfection where location = 'quarantine room'
708d239b2f7785ac668db27a,What drug was the first drug prescribed for patient 10027445 since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Ipratropium Bromide MDI'}],SELECT drug FROM prescriptions WHERE patient_id = 10027445 AND date >= '05/2100' ORDER BY date ASC LIMIT 1
48990ab07c7867ac45c57394,Tell me the top three most frequently tested specimens since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT specimen, COUNT(*) AS test_count FROM (SELECT specimen FROM Test WHERE test_date >= CURRENT_DATE - INTERVAL '1 year') AS Subquery GROUP BY specimen ORDER BY test_count DESC LIMIT 3"
b3b289b80bbadf3f9be2ebc4,What was the time it took for patient 14467 to undergo cv cath plcmt w guidance?,,,Select procedure_time from procedures where patient_id = 14467 and procedure_name = 'cv cath plcmt w guidance' order by procedure_date desc limit 1
c62c1e4f5598bb12f5d680d7,What was the last specimen test that was given to patient 10010471?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'spec_type_desc': 'BLOOD CULTURE'}],SELECT specimen_test FROM specimen WHERE patient_id = 10010471 ORDER BY test_date DESC LIMIT 1
055c46f26772f5e92ff54ba1,What are the top four most frequent microbiology tests that patients were diagnosed with rheumatic disorders of both mitral and aortic valves in the same hospital encounter in 2100?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"SELECT MicrobiologyTest, COUNT(*) AS Frequency FROM HospitalEncounters WHERE Diagnosis IN (SELECT Diagnosis FROM RheumaticDisorders WHERE ValveType IN ('Mitral', 'Aortic')) AND Year = 2100 GROUP BY MicrobiologyTest ORDER BY Frequency DESC LIMIT 4"
ce7b67d7433c0b9c16be0a5f,Is the urea nitrogen value of patient 10002428 last measured on the first hospital visit less than the value from the first measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",[SELECT CASE WHEN MAX(um.m_value::numeric) < (
ab3ab99eb3d4c75a7da40497,When was the first time patient 10038081 had the minimum SaO2 on 10/13/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-13' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(O2_Sat), Encounter_Date FROM labevents WHERE HADM_ID=10038081 AND itemid=50802 AND ChartDate='2010-10-13' GROUP BY Encounter_Date"
c35d03883eff2c60ecc563cf,How many patients in 2100 were prescribed bupivacaine 0.1%?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupivacaine 0.1%' AND strftime('%Y',prescriptions.starttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM prescriptions WHERE drug_name = 'bupivacaine 0.1%' AND year = 2100
d0d4ddd524dec4c4fd73c769,What is the patient count for midazolam prescription since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patient_id) from prescriptions where drug_name = 'midazolam' and prescription_date >= '2100-01-01'
e48106054f3e117d2fac314f,"Has albuterol 0.083% neb soln, sulfameth/trimethoprim ds, or furosemide been prescribed to patient 10000032 since 04/2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND prescriptions.drug IN ( 'albuterol 0.083% neb soln', 'sulfameth/trimethoprim ds', 'furosemide' ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'",[{'COUNT(*)>0': 0}],select * from prescriptions where patient_id = 10000032 and (medication = 'albuterol 0.083% neb soln' or medication = 'sulfameth/trimethoprim ds' or medication = 'furosemide') and prescription_date >= '04/2100'
e365380a427eb3377fda91fe,When was first time the heart rate of patient 10027602 was greater than 63.0 during their first ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 63.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],select min(date_time) as first_time from heart_rate_events where patient_id=10027602 and rate>63 and visit_id in (select min(visit_id) from heart_rate_events where patient_id=10027602 group by patient_id) order by date_time limit 1
f9926355acee735005a5866f,What are the five most frequent procedures for patients aged 60 or above since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,SQL Query
a280ab4c51d6d7b334f1d575,Is the arterial blood pressure systolic level of patient 10018081 second measured on the current ICU visit less than first measured on the current ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",[SELECT CASE WHEN (SELECT value FROM chartevents WHERE subject_id = '10018081' AND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = '10018081' AND icustay_id = (SELECT icustay_id FROM icustays WHERE subject_id = '10018081' ORDER BY intime DESC LIMIT 1)) AND itemid = (SELECT itemid FROM d_items WHERE label LIKE '%systolic%' AND (category LIKE '%vital%' OR category LIKE '%vital sign%')) AND charttime = (SELECT MIN(charttime) FROM chartevents WHERE subject_id = '10018081' AND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = '10018081' AND icustay_id = (SELECT icustay_id FROM icustays WHERE subject_id = '10018081' ORDER BY intime DESC LIMIT 1)) AND itemid = (SELECT itemid FROM d_items WHERE label LIKE '%systolic%' AND (category LIKE '%vital%' OR category LIKE '%vital sign%')))) > (SELECT value FROM chartevents WHERE subject_id = '10018081' AND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id =
cea6be007be41bfc9fde406e,Could you fetch the top five most common specimens tested during this year for me?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],"SELECT specimen_name, COUNT(*) AS count FROM (SELECT specimen_name, sample_date, test_date FROM tests JOIN specimens ON tests.sample_id = specimens.sample_id) WHERE YEAR(sample_date) = YEAR(CURRENT_DATE()) GROUP BY specimen_name ORDER BY count DESC LIMIT 5"
6a91b9dd415016e5b1793284,Can you tell which medicine was first prescribed to patient 10037861 via the neb method in their first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'neb' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SQL query to answer the above question
a9d61cc491cc934c6edf1a8c,"Compared to yesterday, what are the new prescriptions for patient 10018081 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL query to retrieve the data
9d3038ee311cade2b5621bce,What are the methods for taking metformin xr (glucophage xr)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'metformin xr (glucophage xr)',[],select distinct method from medications where medication_name='metformin xr (glucophage xr)'
4c5c196bc7d2b79d1ed73ecf,Has any medication been prescribed to patient 10020786 since 07/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'",[{'COUNT(*)>0': 1}],SELECT DISTINCT MedicationName FROM Prescriptions WHERE PatientID = 10020786 AND PrescribedDate > '2100-07-01'
8ad9e925a3bc2f9da4940ed1,"How many times was a excision of left main bronchus, via natural or artificial opening endoscopic procedure done during the last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of left main bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"SELECT COUNT(*) FROM procedures WHERE procedure_name = 'Excision of left main bronchus, via natural or artificial opening endoscopic' AND procedure_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
764bf48effd7c27c0d7ddc70,Provide the sum total of inputs for patient 10011398 since 03/22/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-22'",[{'SUM(inputevents.totalamount)': 12080.0}],SELECT SUM(input) FROM patient_data WHERE patient_id = 10011398 AND date >= '03/22/2100'
4ae4d8179801e38d38744603,What are the three most frequent procedures for patients who are in their 50s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT procedure, COUNT(procedure) as frequency FROM patient_data WHERE age BETWEEN 50 AND 59 AND procedure_date > CURRENT_DATE - INTERVAL '1 year' GROUP BY procedure ORDER BY frequency DESC LIMIT 3"
02cf1de606c045cf18e72370,What does it cost to get esophageal obstruction diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal obstruction' ) ),,SELECT SUM(cost) FROM medical_services WHERE diagnosis = 'esophageal obstruction'
1dea4d1c505f3a5797f16236,When did patient 10038999 have the last SaO2 to be less than 99.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 99.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],Date
5e33fcec4342525311fca4cc,"When was the last time the respiratory rate of patient 10018081 was greater than 21.0, on this ICU visit?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 21.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],"select max(date) from chartevents where itemid in (211, 220051) and subject_id = 10018081 and value > 21.0 and (value IS NOT NULL AND value <> '') and (valueuom = 'breaths/min' or valueuom = 'Breaths/min')"
926dd0924833df1c1df58531,What is the minimum hospital cost to include a drug called nicotine polacrilex since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nicotine polacrilex' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,select min(hospital_cost) from (select hospital_cost from drug_exposure de inner join condition_occurrence co on de.person_id=co.person_id inner join visit_occurrence vo on de.person_id=vo.person_id inner join cost c on co.person_id=c.person_id and vo.visit_occurrence_id=c.visit_occurrence_id where de.drug_concept_id in (select concept_id from concept where concept_name='nicotine polacrilex') and co.condition_start_date >= '2100-01-01')
8ad38d6021157f461e8be73d,What is the list of things to do before you go through the incision of mediastinum procedure?,,,SELECT task FROM preoperative_instructions WHERE procedure_name = 'incision of mediastinum' ORDER BY task_sequence ASC;
d78eee745ce372a0b010f81a,When did patient 10038999 first have a swab microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'swab' ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],SQL query here
8ab3e1bbd488c2eaae721412,Show me the top five most common treatments for patients aged 50s since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT TOP 5 treatment, COUNT(*) as frequency FROM medical_records WHERE age BETWEEN 50 AND 59 AND treatment_date >= DATEADD(year, -1, GETDATE()) GROUP BY treatment ORDER BY frequency DESC"
617a17c6fecd772da2fb9fb1,When did the first discharge from the hospital happen for patient 10012853?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012853 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2175-04-10 16:55:00'}],SELECT MIN(discharge_date) AS first_discharge_date FROM admissions WHERE patient_id = 10012853
19971ad86aeae49201fc7a93,"What are the four most commonly prescribed medications for patients diagnosed with monoclonal gammopathy previously within the same month, throughout this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'monoclonal gammopathy' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,SQL Query Here
cece63fb84d3cf5a6e97cb83,What is the name of the treatment given to patient 10007795 two times on the first hospital stay?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,SELECT name FROM treatment WHERE patient_id = 10007795 AND visit_occurrence_id = (SELECT visit_occurrence_id FROM visit_occurrence WHERE person_id = 10007795 AND visit_start_date <= (SELECT MIN(visit_start_date) FROM visit_occurrence WHERE person_id = 10007795) AND visit_end_date >= (SELECT MIN(visit_start_date) FROM visit_occurrence WHERE person_id = 10007795) ORDER BY visit_start_date LIMIT 1) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM treatment WHERE patient_id = 10007795 GROUP BY visit_occurrence_id HAVING COUNT(*) >= 2)
7c37ccb48483a3d417233092,Is patient 10018501's mcv last measured on the first hospital visit greater than the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN (SELECT mcv FROM lab_tests WHERE patient_id = 10018501 ORDER BY visit_date ASC, test_date ASC LIMIT 1) > (SELECT mcv FROM lab_tests WHERE patient_id = 10018501 AND visit_number = 1 ORDER BY test_date ASC LIMIT 1) THEN 'Yes' ELSE 'No' END AS is_mcv_last_greater_than_first_on_first_visit"
9e4d892692bac7261d1c86af,"What is the code which is assigned to icd-11, to referring to legal blindness-usa def that occurs in icd-10?",,,SELECT icd11_code FROM ICD10_to_ICD11_mapping WHERE description = 'Legal blindness - USA definition' AND icd10_code IN (SELECT code FROM ICD10 WHERE description LIKE '%legal blindness%')
b83e75dcbb1f8cc1a0718f8a,"What are the five most frequently administered laboratory tests for patients previously diagnosed with methicillin susceptible staphylococcus aureus infection as the cause of diseases classified elsewhere in the same month, in 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible staphylococcus aureus infection as the cause of diseases classified elsewhere' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,SELECT TOP 5 TestName FROM LaboratoryTests WHERE PatientDiagnosis = 'Methicillin Susceptible Staphylococcus Aureus' AND DiagnosisDate = '2100-MM' AND DiseaseClassification = 'Classified Elsewhere' GROUP BY TestName ORDER BY COUNT(TestName) DESC;
d2f1256d39dcc2e6a1fea9cc,When was the first time the respiratory rate of patient 10020187 registered less than 20.0 on 02/03/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 20.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-02-03' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(measurement_date) AS first_time_low_respiratory_rate FROM medical_records WHERE patient_id = 10020187 AND measurement_date <= '2100-02-03' AND respiratory_rate < 20.0;
ff7b7029d2eb43d96f2ee688,What drug was the first drug prescribed for patient 10019172 in 11/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT drug_name FROM prescriptions WHERE patient_id = 10019172 AND prescription_date = (SELECT MIN(prescription_date) FROM prescriptions WHERE patient_id = 10019172 AND prescription_date LIKE '11/2100%')
6daaebd1833641ba81afc130,Get me patient 10004733's total gt flush input amount since 09/09/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gt flush' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-09'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(gt_flush_input_amount) AS total_gt_flush_input FROM patient_data WHERE patient_id = '10004733' AND date >= '2100-09-09'
a14cb4f846f35ff7611f1dbc,List the top three most frequent lab tests since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",Your SQL query here
a00e9493a4dac3d8a11100c3,When was the last blood culture microbiology test performed during the previous month for patient 10027602?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],
408a90b2c2390990c83c0be0,When was the last time patient 32592 had a medication which should be regularly taken?,,,SELECT MAX(dose_date) FROM patient_medication WHERE patient_id = 32592 AND dose_status = 'regular'
f5b7b1f39d3f36c2baf21b63,Can you tell me the last recorded weight for patient 10010471 since 27 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-27 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],
e7626ed5099c3df4e2766996,"Since 29 months ago, what was the last recorded weight for patient 10013049?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-29 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"[SELECT MAX(measurement_date) as Last_Recorded_Date, weight"
6496ef7a5d347a3e46d2bec0,Could you list the five most frequently prescribed medicines within the same hospital visit after a diagnosis of unspecified acquired hypothyroidism was made in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified acquired hypothyroidism' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT prescription_medication, COUNT(prescription_medication) as frequency FROM patient_records WHERE diagnosis_code = 'E03.9' AND visit_date BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY prescription_medication ORDER BY frequency DESC LIMIT 5"
131676838dec830d875d80ad,Retrieve the top five most common diagnoses for patients with age 30s this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(diagnosis) AS frequency FROM patient_records WHERE age BETWEEN 30 AND 39 AND YEAR(date) = YEAR(CURDATE()) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
b2506d21f50185686a959e38,Count the number of times that other incision of brain was performed.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of brain' ),[{'COUNT(*)': 0}],SELECT COUNT(*) AS Number_of_Other_Incision FROM procedure WHERE code = 'OTB';
b587cd8c1c145a6a99b52e8e,What precautions should be taken after a rt heart angiocardiogram procedure?,,,SELECT precautions FROM medical_procedures WHERE procedure_name = 'rt heart angiocardiogram' AND timing = 'after'
f301f472f3dfd88f91cb2316,How many hospitalized patients do we currently have?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(*) FROM patient WHERE admission_status='hospitalized'
39881273c6b26ba01d54e3ee,"For the first time since 07/2100, what specimen test did patient 10038992 get?","SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'BLOOD CULTURE'}],SELECT test_name FROM specimen_tests WHERE patient_id = 10038992 AND test_date >= '2100-07-01' ORDER BY test_date ASC LIMIT 1
79fe38dca4831802e82026a6,Has patient 10025612 taken a packed red blood cells drug in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM prescriptions WHERE patient_id = 10025612 AND drug_name = 'Packed Red Blood Cells' AND prescription_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) AND CURRENT_DATE;"
6b2bc626482c4ebd317ba6ea,"Since 2100, what was patient 10012552 diagnosed with for the last time?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,select top 1 diagnosis from diagnoses where patient_id = '10012552' and date > '2100-01-01' order by date desc
f5ddb5194586e227ab8610fc,I would like to know what dr. reeves's on today's outpatient schedule.,,,SELECT * FROM outpatient_schedule WHERE doctor_id = (SELECT id FROM doctors WHERE name = 'Dr. Reeves') AND appointment_date = CURDATE()
a790bd7026f83ac5ff0e68c1,What would the minimum monthly number of patients diagnosed with resistance to other specified antimicrobial drug be in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'resistance to other specified antimicrobial drug' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,[SELECT MIN(monthly_count) FROM (
5f2be37c9bd6389d80599c5f,"How many patients were diagnosed with other diseases of bronchus, not elsewhere classified in 2100 after already being diagnosed with unspecified convulsions during the same month?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified convulsions' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of bronchus, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT count(*) AS num_patients FROM patient_diagnoses pd1 JOIN patient_diagnoses pd2 ON pd1.patient_id = pd2.patient_id WHERE pd1.diagnosis_code = 'unspecified convulsions' AND pd2.diagnosis_code = 'other diseases of bronchus, not elsewhere classified' AND DATE_PART('year', pd1.diagnosis_date) = 2100 AND DATE_PART('year', pd2.diagnosis_date) = 2100 AND DATE_PART('month', pd1.diagnosis_date) = DATE_PART('month', pd2.diagnosis_date)"
425004d751172cad53c3ad6b,Do you know what type of blood patient 1903 has?,,,SELECT blood_type FROM Patients WHERE patient_id = 1903
ddcee3c0f498777f0ac3fe7c,Calculate the total volume of patient 10026354's input since 03/22/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-22'",[{'SUM(inputevents.totalamount)': 7100.0}],SELECT SUM(input) AS total_input_volume FROM input_output WHERE patient_id = 10026354 AND timestamp >= '03/22/2100' GROUP BY patient_id;
b947843285099f2f901cf7de,How many hours has it been since patient 10018081's last chloride lab test during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"select datediff(hour, max(labresultcalculatedresultdate), getdate()) from labresult where patientid = 10018081 and labresultid = 13 and labresultcalculatedresult is not null and labresultcalculatedresult > 0 and labresultinterpretation between 'Normal' and 'High' and labresultvisitid in (select visitid from visit where patientid = 10018081 and visitlinkage = 'Current Visit')"
c905e6677e0cbf329230ebf2,Is patient 14054 subject to tests to determine if he has covid-19.,,,"select distinct id from patient natural join subject where id=""14054"" and type=""covid-19"" and value=""true"""
bcc21d5d3111f89ef9a098f9,What were the top four diagnoses that had the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,SQL QUERY HERE
76898a2087c25f36caa4339c,What was the last output since 06/24/2100 for patient 10016742?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-24' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],SELECT * FROM `mimiciv_1_4.pitevents` WHERE `subject_id`=10016742 AND `charttime` > '2100-06-24' ORDER BY `charttime` DESC LIMIT 1
b64c62eb05aaad4071af83a7,What is the common method for taking lorazepam?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'lorazepam',"[{'route': 'PO/NG'}, {'route': 'PO'}, {'route': 'TP'}, {'route': 'ORAL'}]",SELECT method FROM medication_methods WHERE drug_name = 'lorazepam' GROUP BY method ORDER BY COUNT(*) DESC LIMIT 1
274367d1fab86c9296ee0ceb,How much is the average total hospital bill when it includes a tobramycin lab test since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tobramycin' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_bill) FROM hospital_bills WHERE tobramycin_lab_test = TRUE AND date >= '2100-01-01'
3f49eeea52db301754082dc6,What were the first troponin t results for patient 10007818 in their last hospital encounter?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime ASC LIMIT 1,[],"SELECT TOP 1 * FROM lab_results WHERE patient_id = '10007818' AND test_name = 'troponin t' ORDER BY encounter_date DESC, result_date DESC"
73d71dd48759ebd3e31a1e91,How many patients had been diagnosed with unspecified place in hospital as the place of occurrence of the external cause?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified place in hospital as the place of occurrence of the external cause' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SNOMEDCT_US.DRUG_EXPOSURE
fba8a54ba42e25b3a395f35b,"Did patient 10002495 have a irrigation of genitourinary tract using irrigating substance, via natural or artificial opening procedure on the first hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'irrigation of genitourinary tract using irrigating substance, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )",[{'COUNT(*)>0': 0}],"select case_id from mde_codedspr where case_id = 10002495 and mde_codedspr.nlp_date = (select min(mde_codedspr.nlp_date) from mde_codedspr where case_id = 10002495) and mde_codedspr.source_concept_id in (select concept_id from concept where concept.class in ('SCT', 'NCI') and concept.code in ('300093004','301010002','301011008','301014009','301015008','301016007','301017001','301018009','301019007','301020007','301021003','301022008','301023004','301024009','301025006','301026005'))"
ad18efa8d9a3881fbc51b4ea,What was the name of the organism found in the first microbiology test conducted on patient 10021487's bronchoalveolar lavage since 05/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT TOP 1 organism FROM microbiology_test WHERE patient_id = '10021487' AND specimen = 'bronchoalveolar lavage' ORDER BY test_date ASC
8c021f1784d97cc1eb00efeb,What did patient 10038081 first have as output since 10/04/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Oral Gastric'}],"SELECT MIN(visit_date), output_name FROM patient_output WHERE patient_id = 10038081 AND visit_date >= '10/04/2100' ORDER BY visit_date ASC LIMIT 1"
9f63970e733b63fae113c2a8,"What are the three commonly given procedures for patients that also received ultrasonography of superior vena cava, guidance previously in the same hospital encounter, this year?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ultrasonography of superior vena cava, guidance' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,SELECT TOP 3 Procedures FROM Hospital_Encounters WHERE Ultrasonography = 'Superior Vena Cava' AND Guidance = 'Same Encounter' AND Year = YEAR(CURRENT_DATE) GROUP BY Procedures ORDER BY COUNT(Procedures) DESC
963d648d770fcb43743e09b4,What are the three most common treatments for patients who are 30s since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT treatment, COUNT(*) AS frequency FROM (SELECT DISTINCT patient_id, treatment FROM patient_treatment WHERE YEAR(visit_date) >= 2100 AND TIMESTAMPDIFF(YEAR, birth_date, visit_date) BETWEEN 30 AND 39) AS age_filtered GROUP BY treatment ORDER BY frequency DESC LIMIT 3"
c89cf055a5d102b539366869,How many hours has it been since the last time patient 10021487 stayed during this hospital encounter in the careunit emergency department?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1",[],"select datediff(hour, max(admit_time), getdate()) from encounter where patient_id = 10021487 and careunit = 'emergency department'"
b9bcd099d5f42ea75aca129e,How is readi-cat 2 (barium sulfate 2% suspension) typically taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'readi-cat 2 (barium sulfate 2% suspension)',[],SELECT `Dosage` FROM `Medication` WHERE `Medication_Name` = 'readi-cat 2' AND `Ingredient` = 'barium sulfate 2% suspension'
623f6b6f64fea20e0be94ac5,What was the time of patient 10006053's first peritoneal fluid microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],"SELECT TOP 1 Test_Time FROM microbiology_tests WHERE Patient_ID = '10006053' AND Sample_Type = 'Peritoneal Fluid' AND Test_Date >= '03/2100' ORDER BY Test_Date ASC, Test_Time ASC"
0f5988ac990c3b052bc99527,Is there any new medication in the prescription of patient 10039831 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT COUNT(DISTINCT medication) FROM prescriptions WHERE patient_id = 10039831 AND date = CURDATE() AND medication NOT IN (SELECT DISTINCT medication FROM prescriptions WHERE patient_id = 10039831 AND date = CURDATE() - INTERVAL 1 DAY)
a437096bd6ca61f03b95d62a,What was the name of the medicine that was given to patient 10005817 in the same hospital encounter post procedure of extracorporeal circulation auxiliary to open heart surgery since 29 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-29 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-29 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT medication_name FROM patient_medicine_records WHERE patient_id = '10005817' AND procedure_name = 'extracorporeal circulation auxiliary to open heart surgery' AND encounter_date >= DATE_SUB(CURDATE(), INTERVAL 29 MONTH) AND encounter_hospital_id = (SELECT hospital_id FROM patient_encounters WHERE patient_id = '10005817' AND encounter_date = (SELECT MAX(encounter_date) FROM patient_encounters WHERE patient_id = '10005817' AND procedure_name = 'extracorporeal circulation auxiliary to open heart surgery')) LIMIT 1;"
97d26f029a5f2f8e475529e6,What is patient 10026354's difference in respiratory rate from the last value measured on the last ICU visit compared to the second to last value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT patient_id, visit_id, (MAX(respiratory_rate) - MIN(respiratory_rate)) AS rate_difference FROM patient_data WHERE patient_id = 10026354 AND visit_type = 'ICU' GROUP BY patient_id, visit_id ORDER BY visit_date DESC LIMIT 1"
253143bdf2322f6137ab6d66,Can you confirm what was the first arterial blood pressure mean for patient 10039831 since 01/16/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-01-16' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(mean) AS first_mean FROM arterial_blood_pressure WHERE person_id = '10039831' AND EXTRACT(YEAR FROM measurement_date) = 2100 AND EXTRACT(MONTH FROM measurement_date) = 1 AND EXTRACT(DAY FROM measurement_date) >= 16 ORDER BY measurement_date ASC LIMIT 1
e52d7f0f71c5a96d3ad444d8,How long did it take to get venous cath nec for patient 31854?,,,"SELECT ""duration"" FROM ""patient_procedures"" WHERE ""patient_id"" = 31854 AND ""procedure_name"" = 'venous cath nec'"
521083ecdc8d7be6649f758c,"What is the hospital's average total cost that involves a procedure called implantation or replacement of carotid sinus stimulation device, total system since 1 year ago?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"select avg(t.total_cost) from cost_summary as t where t.procedure_description like '%implantation%' or t.procedure_description like '%replacement%' and t.procedure_description like '%carotid sinus stimulation device%' and t.procedure_description like '%total system%' and t.admit_date > date_add(curdate(), interval -365 day)"
e12e998b1f9c18fea1f85d8f,How much does it cost to purchase syringe (0.9% sodium chloride)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'syringe (0.9% sodium chloride)' ),,SQL Query
19d8f43d4364b3abf853cd5a,When was the last time patient 10023117 had an minimum bicarbonate in the first hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],select max(date) from chartevents where itemid in (50971) and SUBJECT_ID = 10023117 group by SUBJECT_ID having HADM_ID in (select hadm_id from d_items where charttime = min(charttime))
231d73add777a1a3ca6f2873,How many patients were given methocarbamol since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methocarbamol' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS NumberOfPatients FROM prescription_records WHERE medication_name = 'methocarbamol' AND date_prescribed >= '2100-01-01'
ff6ae54dadd27c88cff99254,What are the top four most frequent procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,SQL Query Here
1e9722d883ec34d867a344f9,How much was the difference in respiratory rate of patient 10004422 measured at 2100-01-25 18:00:00 compared to the value measured at 2100-01-25 17:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 18:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 17:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 18:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-01-25 17:00:00' )"": None}]",SELECT (MAX(rr) - MIN(rr)) AS respiratory_rate_difference FROM respiratory WHERE pid = 10004422 AND date_time BETWEEN '2100-01-25 17:00:00' AND '2100-01-25 18:00:00'
1d5c66901760c1bfc6eb5361,"Today compared to yesterday, what new drugs are being prescribed to patient 10039831?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT DISTINCT prescription_drug FROM patient_prescriptions WHERE patient_id = 10039831 AND prescription_date = CURRENT_DATE AND prescription_drug NOT IN (SELECT DISTINCT prescription_drug FROM patient_prescriptions WHERE patient_id = 10039831 AND prescription_date = CURRENT_DATE - INTERVAL '1 day')
77f1caca4c8a38d1fe942703,The value of metamyelocytes of patient 10002495 was last measured on the last hospital visit greater than second to last measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT * FROM blood_tests WHERE patient_id = '10002495' AND test_type = 'metamyelocytes' ORDER BY visit_date DESC LIMIT 2
66e4509cc3f44d918845b252,"On the last ICU visit, did patient 10016742 have any input of gastric meds?",SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],select count(distinct icustay_id) from mimiciii.inputevents_cv where subject_id=10016742 and hadm_id in (select hadm_id from mimiciii.icustays where subject_id=10016742 order by intime desc limit 1) and itemid in (select itemid from mimiciii.d_icd_items where icdcode like 'A16%' or icdcode like 'A18%' or icdcode like 'A09%') and (charttime between intime and outtime)
fd369ed514a6f2c485af417b,"When was the last time that patient 10018081 had the calcium, total minimum value during this hospital encounter?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],"SELECT MAX(medical_test.date) AS last_calcium_test_date FROM medical_test WHERE medical_test.patient_id = 10018081 AND medical_test.type = 'Calcium, total' AND medical_test.min_value IS NOT NULL AND medical_test.encounter_id = (SELECT encounter.id FROM encounter WHERE encounter.patient_id = 10018081 ORDER BY encounter.admission_date DESC LIMIT 1)"
d5e0cf8341d186a59aa14536,"Tell me the minimum total cost of a hospital that involved chronic ischemic heart disease, unspecified since 2100.","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic ischemic heart disease, unspecified' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(TotalCost) FROM hospital_stays WHERE DiagnosisCode = 'I25.9' AND AdmissionDate > '2100-01-01'
15a0bb3f4f2f12a28f041dd2,Tell me patient 10027602's total gastric meds input amount.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input_amount) AS total_gastric_meds_input FROM intake WHERE patient_id = '10027602' AND med_category = 'gastric'
0814561e80d18ee7b5e8e214,"In 04/2100, when was the last time that patient 10007795 was prescribed medication via the po/ng route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1",[],select max(presc_date) from prescriptions where patient_id = 10007795 and route = 'po/ng' and presc_date < '2100-04-01'
af2c16c562788b5087cb46cf,When was the first time that patient 10016150 has been prescribed acetaminophen and glucagon at the same time in 05/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10016150 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],
6897e02993c3a8b24377556b,Has patient 9241 ever had any complication when undergoing a blood transfusion?,,,"select distinct rsn.case_number, rsn.comorbidity from report_section_notes rsn where rsn.case_number='9241' and rsn.comorbidity like '%blood transfusion%' and rsn.comorbidity like '%complication%'"
e9de88c1ca4e544ff64bd3f9,"What is the total number of days that have passed since patient 10021487's first bilirubin, total, body fluid lab test during this hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, body fluid' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT DATEDIFF(MAX(TestDate), MIN(TestDate)) + 1 FROM LabTestResults WHERE PatientID = 10021487 AND TestType = 'bilirubin, total, body fluid' AND HospitalVisitID = [HospitalVisitID"
fb62db48ad7712c787e1d173,Tell me the dose of the prescribed opioid for patient 90019?,,,"SELECT opioid, dose FROM prescriptions WHERE patient_id = '90019' AND medication_category = 'opioid'"
14e43b77aa10ac246694f9f5,What was the last hospital discharge time for patient 10029484?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10029484 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",[],select max(discharge_time) from hospital_discharges where patient_id = 10029484
cd6cb8495bf452c344f61955,When was the first time that on their first hospital visit patient 10026255 had the maximum of platelet count?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],select min(visit_date) from lab_results where patient_id = 10026255 and lab_test = 'platelet_count' and result = (select max(result) from lab_results where patient_id = 10026255 and lab_test = 'platelet_count')
b6d5c0f90ce664eba9acb6bf,"Among patients diagnosed with unspecified viral hepatitis c without hepatic coma, what are the top three most common lab tests conducted in the same month in this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c without hepatic coma' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT LabTests.TestName, COUNT(*) AS TestCount FROM LabTests INNER JOIN Patients ON LabTests.PatientID = Patients.PatientID INNER JOIN Diagnoses ON Patients.PatientID = Diagnoses.PatientID WHERE Diagnoses.DiagnosisCode = 'Unspecified viral hepatitis C' AND Diagnoses.HepaticComa = 'No' AND YEAR(LabTests.TestDate) = YEAR(CURDATE()) AND MONTH(LabTests.TestDate) = MONTH(CURDATE()) GROUP BY LabTests.TestName ORDER BY TestCount DESC LIMIT 3"
f9c16377338fec42f126a765,What is patient 10019568's maximum value of magnesium during the first hospital encounter?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ),[{'MAX(labevents.valuenum)': None}],SELECT MAX(magnesium) FROM lab_results WHERE patient_id = 10019568 AND encounter_id = (SELECT MIN(encounter_id) FROM encounters WHERE patient_id = 10019568)
db710bbbad258467ce5d73b8,What was the name of the specimen given to patient 10011398 for the first time in the last hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}],SELECT specimen_name FROM patient_visits JOIN specimen_records ON patient_visits.visit_id = specimen_records.visit_id WHERE patient_visits.patient_id = '10011398' AND specimen_records.first_given = TRUE ORDER BY visit_date DESC LIMIT 1
af98aa24749ee692f69ef110,"Since 1 month ago, what was patient 10021118's last weight measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-1 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"select top 1 * from (select *,datediff(day,measurement_date,GETDATE()) as datediff from Measurement where patient_id='10021118' and measurement_type='weight' and measurement_date<getdate() order by measurement_date desc) as t1 where datediff < 30 order by measurement_date desc"
1b93bd516c9f2988ad2965d8,"In total, what was the input amount of packed red blood cells that patient 10008454 received on 12/04/this year?","SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-04'",[{'SUM(inputevents.totalamount)': None}],select sum(rbc.input_amt) from lab_results rbc where rbc.test_name = 'Packed Red Blood Cells' and rbc.patient_num = '10008454' and rbc.observation_date = '12/04/this year'
0f0a1891025fdcedc7e8ea0d,Tell me the name of the specimen test that patient 10000032 first received since 07/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'URINE'}],select * from (select * from specimen_test where patient_id='10000032' and test_date>='07/2100' order by test_date asc) as a where rownum=1
b46dbc1a0b8589b45641e9db,What was the first time that patient 10008287 had the maximum value of calculated total co2 since 01/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],"SELECT MIN(visit_start_date) AS first_date_of_max_co2 FROM (SELECT visit_start_date, visit_occurrence_id, calculated_total_co2 FROM visits WHERE person_id = 10008287 AND visit_start_date >= '2100-01-01' AND calculated_total_co2 IS NOT NULL) AS subquery GROUP BY calculated_total_co2 ORDER BY calculated_total_co2 DESC LIMIT 1"
f782fdf63ed4c6c75950ea24,What was the name of the drug that was last prescribed to patient 10007818 through the iv bolus route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'iv bolus' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"select last_name, drug from (select last_name, drug, route, rank() over (partition by patient_id order by visit_date desc) as rank from prescriptions) as ranked_prescriptions where patient_id = 10007818 and route = 'IV bolus' and rank = 1"
aaa971c7a88d9bf7858d0200,So how many days have passed since patient 10004733's last bacteremia diagnosis in the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bacteremia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT DATEDIFF(day, MAX(diagnosis_date), GETDATE()) AS days_since_last_bacteremia FROM diagnosis_records WHERE patient_id = 10004733 AND diagnosis = 'bacteremia' AND hospital_visit_id = (SELECT MAX(hospital_visit_id) FROM hospital_visits WHERE patient_id = 10004733)"
612351f75cf9c16873706c46,Show me the total amount of patient 10039831's output since 05/30/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-30'",[{'SUM(outputevents.value)': 6680.0}],SELECT SUM(amount) AS total_output FROM patient_output WHERE patient_id = 10039831 AND date >= '2100-05-30';
62d9af32c3698f6545567c3e,"During the last year, was patient 10025612 diagnosed with any disease?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"select disease from diagnosis where patient_id = 10025612 and diagnosis_date > date('now', '-1 year')"
cb7b80bbdfdc960e82ea8bf3,What precautions should i take after a pros repair atria def-cl procedure?,,,SELECT precautions FROM atria_def_cl_procedure WHERE procedure_type='pros repair' AND procedure_name='atria def-cl'
c6af3f026c0e32b6e92878fe,When did patient 10007928 first receive a lab test for urea nitrogen on their first hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,[],SELECT MIN(result_date) FROM lab_results WHERE patient_id = 10007928 AND test_name = 'Urea Nitrogen' AND encounter_id = (SELECT MIN(encounter_id) FROM encounters WHERE patient_id = 10007928)
ecbc2ee919ccc6a0dea03692,"What are the top four most frequent medications prescribed within 2 months to the patients in their 60 or above after they were diagnosed with alcohol abuse, unspecified?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"select medication_name from medication_prescriptions where diagnosis_code = 'alcohol abuse, unspecified' and age >= 60 and prescription_date <= (diagnosis_date + interval '2 month') group by medication_name order by count(*) desc limit 4"
f719a14ae6e71d9f9de23e63,When was the first time that patient 10021487 was tested for red blood cells in 12/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',labevents.charttime) = '2100-12' ORDER BY labevents.charttime ASC LIMIT 1",[],from blood_test_records WHERE patient_id = '10021487' AND test_type = 'red blood cells' AND test_date LIKE '12/2100%'
4cb5de3e5bd12beac4b15b14,Tell me the total output since 04/03/2100 for patient 10012552.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-03'",[{'SUM(outputevents.value)': 8408.0}],SELECT SUM(output) AS total_output FROM output_data WHERE patient_id = '10012552' AND output_date >= '2100-04-03'
4e6dcd007988152470193f41,What was the total number of patients staying in med/surg in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT SUM(NumberOfPatients) FROM PatientData WHERE StayType = 'Med/Surg' AND Year = 2100
085c8ca9cb97ef04b07e9465,Was there a genetic test that patient 76494 received?,,,select exists (select 1 from genetic_test where patient_id = 76494)
53b8eec71a9ed17879d3e723,When was the last time that during their last hospital encounter patient 10037928 had the maximum of eosinophils?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],select max(eosinophils) from hospital_encounters where patient_id = '10037928' and encounter_date = (select max(encounter_date) from hospital_encounters where patient_id = '10037928')
dc198d4ae3abb990cb9902e1,Name the three most frequently prescribed drugs during the same hospital encounter following a diagnosis of acute and subacute necrosis of liver during this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 drug_name, COUNT(*) AS prescription_count FROM prescriptions WHERE encounter_date BETWEEN '2023-01-01' AND '2023-12-31' AND diagnosis = 'acute and subacute necrosis of liver' GROUP BY drug_name ORDER BY prescription_count DESC"
07c2cabe27d018ef8bc90ed3,How many people got prescriptions for adde since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'adde' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 1}],SELECT COUNT(*) AS num_prescriptions FROM prescriptions WHERE drug_name = 'adde' AND date_prescribed >= '2100-01-01'
f9006233824c9919f64e41e9,When was patient 10001217's first maximum l value during their last hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'l' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],"SELECT MIN(visit_date) AS first_max_l_visit_date FROM (SELECT visit_date, l_value, ROW_NUMBER() OVER (PARTITION BY visit_date ORDER BY l_value DESC) AS rn FROM visits WHERE patient_id = 10001217 ORDER BY visit_date DESC) AS ranked_visits WHERE rn = 1 LIMIT 1"
28bf2891ea69cdd52915b657,"Among patients who took respiratory ventilation, greater than 96 consecutive hours in 2100, what are the top three most frequent diagnoses that followed within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,SQL Query Here
11cc0c3c5ddde55f2933b0a4,Calculate patient 10020740's total amount of foley output on their last ICU stay.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ),[{'SUM(outputevents.value)': None}],SELECT SUM(output) FROM foley_records WHERE patient_id = 10020740 AND admission_date = (SELECT MAX(admission_date) FROM icu_stays WHERE patient_id = 10020740)
6e78d418898692d8783374c7,Have any lab tests been performed on patient 10026406?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ),[{'COUNT(*)>0': 1}],SELECT * FROM lab_results WHERE patient_id = 10026406
5d8d3d9c0e88b7b656bc2f3e,List the top five most common diagnoses in this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM admissions WHERE year = 2023 GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
2ac19b54bada84606ebec21c,How many patients in 2100 were prescribed docusate?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'docusate' AND strftime('%Y',prescriptions.starttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patid) from drug_events where drug_name = 'docusate' and year = 2100
f08251f8b3dd5a479060e87b,"Since 12/2100, how much did patient 10015931 weigh during the first measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-12' ORDER BY chartevents.charttime ASC LIMIT 1",[],select weight from measurement where person_id = 10015931 and measurement_id = 1 and measurement_datetime >= '12/21/2000'
de873dcbb588ef6ce9ad305d,What was the name of the insurance used for patient 10000032 in their first hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],SELECT TOP 1 insurance_name FROM patient_visits WHERE patient_id = '10000032' ORDER BY visit_date ASC
a4ca81eaa8eb676b5fdfee3b,When did patient 10021487 first have a maximum mean blood pressure on this month/22?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '22' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],SELECT MIN(date) FROM blood_pressure_readings WHERE patient_id = 10021487 AND date >= '2023-09-01' AND date <= '2023-09-22' AND systolic_bp = (SELECT MAX(systolic_bp) FROM blood_pressure_readings WHERE patient_id = 10021487 AND date >= '2023-09-01' AND date <= '2023-09-22')
11e5506de71d3706a53ac1ab,What was the organism found in the first blood culture test of patient 10038999?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],select organism from bloodculture where patient_id=10038999 order by date_taken asc limit 1
b472d5763672be20763ee562,"During the previous year, was patient 10020187 to an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],SELECT * FROM ADMISSIONS WHERE patient_id = '10020187' AND admission_date BETWEEN '2021-01-01' AND '2021-12-31' AND admission_type = 'emergency'
4c475fcaf3bf16551e866c3c,"What were the top five most frequent diagnoses since 1 year ago with which patients were diagnosed after receiving extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic during the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 Diagnosis, COUNT(Diagnosis) as Frequency FROM PatientRecords WHERE Procedure = 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' AND DiagnosisDate >= DATEADD(year, -1, GETDATE()) AND AdmissionDate BETWEEN DiagnosisDate AND DATEADD(month, 1, DiagnosisDate) GROUP BY Diagnosis ORDER BY Frequency DESC"
e50069b13140ebddc5f39a48,What's the monthly average weight of patient 10011398 since 01/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT date_trunc('month', measurement_date) AS month, AVG(weight) AS average_weight FROM weight_measurements WHERE patient_id = 10011398 AND measurement_date >= '2100-01-01' GROUP BY month ORDER BY month"
48bc5f792f4ed6f03d3cb9e5,How much sevelamer carbonate was given to patient 10007818 for the first time in 06/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.drug = 'sevelamer carbonate' AND strftime('%Y-%m',prescriptions.starttime) = '2100-06' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT amount FROM medication_records WHERE patient_id = '10007818' AND medication_name = 'sevelamer carbonate' AND date = (SELECT MIN(date) FROM medication_records WHERE patient_id = '10007818' AND medication_name = 'sevelamer carbonate' AND date LIKE '06/2100%')
d1bf30f1b6904076c39146bb,What's the maximum daily number of patients who were diagnosed with other opiates and related narcotics causing adverse effects in therapeutic use since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other opiates and related narcotics causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,SELECT MAX(DailyCount) FROM AdverseEvent WHERE DrugCategory = 'Other opiates and related narcotics' AND EventDescription = 'Causing adverse effects in therapeutic use' AND ReportDate >= '2100-01-01';
dc9b13fe2202c498d8511fe7,"Among patients in their 50s since 2100, what were the top five most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM diagnoses WHERE birth_year BETWEEN 2050 AND 2060 AND diagnosis_date >= '2100-01-01' GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
3744204f6970ebf11f57c0ba,What was the last time when patient 10019568 received a platelet count lab test during their first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT TOP 1 lab_tests.test_date as last_platelet_count_date FROM lab_tests JOIN visits ON lab_tests.visit_id = visits.visit_id WHERE lab_tests.patient_id = 10019568 AND lab_tests.test_name = 'platelet count' AND visits.visit_number = 1 ORDER BY lab_tests.test_date DESC
4daceca1922e2f7b36597c87,Expose the top three most frequent output events in 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],select top 3 * from Events where event_year = '2100' group by event_type order by count(event_type) desc
207eceda0156cdc649f4b078,When was the first time patient 10018081's respiratory rate was less than 22.0 in this ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 22.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],select min(measurementtime) from admissions inner join measurements on admissions.patientid=measurements.patientid where measurements.measurementtype='respiratory_rate' and measurements.value<22.0 and admissions.patientid='10018081';
c67d548b3887ca38058fde7e,Has patient 10012853 been admitted to the emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.admission_location = 'emergency room',[{'COUNT(*)>0': 0}],SELECT CASE WHEN EXISTS (SELECT * FROM emergency_admissions WHERE patient_id = '10012853') THEN 'Yes' ELSE 'No' END AS admission_status
3f82eece23e0481c1ab26586,Tell me the sum of the input volume for patient 10007928 since 03/04/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-04'",[{'SUM(inputevents.totalamount)': 22955.0}],SELECT SUM(input_volume) FROM chart_events WHERE patient_num = 10007928 AND charttime >= '03/04/2100';
3611ae2dcaeae9a7d87cdf93,What is the ward id where patient 5828 can be admitted?,,,SELECT ward_id FROM patient_admissions WHERE patient_id = 5828
531895a8f6c3cd6a5748843b,How many days have elapsed since patient 10004733 had received a mch lab test for the last time in their current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"[select datediff(current_date(), max(mch.lab_datetime)) as elapsed_days"
05ae0033f4e813609ca5d462,"What is the maximum total cost of the hospital, which includes the palmar fascial fibromatosis [dupuytren]?",SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'palmar fascial fibromatosis [dupuytren]' ) ) GROUP BY cost.hadm_id ) AS T1,,"SELECT hospital_name, MAX(total_cost) as MaxTotalCost FROM medical_records WHERE condition_name = 'palmar fascial fibromatosis' GROUP BY hospital_name;"
23652e6ecf5fc87dd7d50a98,"How many patients were diagnosed with nicotine dependence, cigarettes, uncomplicated during the same month after they were first diagnosed with long term (current) use of antithrombotics/antiplatelets in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of antithrombotics/antiplatelets' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nicotine dependence, cigarettes, uncomplicated' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT COUNT(*) FROM `EDW_LIVE`.`CDM_SOURCE_VOCAB_MAP` AS `src_map` INNER JOIN `EDW_LIVE`.`CDM_SOURCE` AS `src` ON `src_map`.`SRC_CD` = `src`.`SRC_CD` AND `src_map`.`SRC_CONCEPT_CD` = `src`.`SRC_CONCEPT_CD` INNER JOIN `EDW_LIVE`.`CDM_CONCEPT` AS `con` ON `src_map`.`CONCEPT_CD` = `con`.`CONCEPT_CD` WHERE `con`.`CONCEPT_PATH` LIKE '%/Observation/Social History/Nicotine Dependence/Cigarettes/Uncomplicated/Yes%' AND `src`.`SRC_EXTRACT_LOAD_ID` IN (SELECT `ex_id` FROM `EDW_LIVE`.`CDM_EXTRACT` AS `ex` WHERE `ex`.`EXTRACT_DATE` >= '2011-01-01' AND `ex`.`EXTRACT_DATE` <= '2011-12-31') AND `src_map`.`MAP_TYPE_CD` IN ('SourceToStandard', 'SourceToCustom')"
8970ce40dfe4e0498bf2959e,Show me the top four diagnoses with the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"""""""<|end_of_instruction|>"
5a89407a39c4cd1be3abc4f2,"On this month/23, what was the maximum value of the respiratory rate for patient 10004733?","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '23'",[{'MAX(chartevents.valuenum)': None}],SELECT MAX(respiratory_rate) FROM patient_data WHERE patient_id = '10004733' AND observation_date BETWEEN '2023-03-01' AND '2023-03-23';
8f0afd39792dda81827e4464,What is patient 10008454's difference in SaO2 from the value measured at 2100-12-07 16:00:00 compared to the value measured at 2100-12-07 15:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 16:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 15:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 16:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 15:00:00' )"": None}]",SELECT (SaO2_value_16:00 - SaO2_value_15:00) AS SaO2_difference FROM patient_measurements WHERE patient_id = 10008454 AND ((measurement_time = '2100-12-07 16:00:00') OR (measurement_time = '2100-12-07 15:00:00')) GROUP BY patient_id
ce3af199fd7438f9504a0ed5,What was the name of the medication that was first prescribed to patient 10010471 since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Rosuvastatin Calcium'}],SELECT TOP 1 MedicationName FROM PrescriptionHistory WHERE PatientID = '10010471' AND PrescriptionDate >= '12-2100' ORDER BY PrescriptionDate ASC
b6cca58570a4d4174cb71b3e,I want to know the reimbursement standard for cerebrovascular mri.,,,"select distinct r.reimbursement_standard from reimbursement r, medical_service ms where ms.service_name='cerebrovascular mri' and r.reimbursement_code=ms.reimbursement_code order by r.reimbursement_standard asc"
97da967a6eec6c3d02e10772,"In 2100, how many dilation of left external iliac vein with intraluminal device, percutaneous approach procedures were there?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,select count(*) from procedure_events where cpt_code like '38327' and year = '2100'
10ed8799a239ae7d1d0f79c9,What is the correct dosage of the prescribed opioid to patient 42829?,,,SELECT opioid_dosage FROM patient_medications WHERE patient_id = 42829 AND medication_type = 'opioid'
cb29881e7d27f8f23e3a8502,Give a count of the number of ICU visits of patient 10004720 during their last hospital visit.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT( DISTINCT icustays.stay_id )': 1}],SELECT COUNT(*) FROM icu_visits WHERE patient_id = 10004720 AND hospital_visit_id IN (SELECT hospital_visit_id FROM hospital_visits WHERE patient_id = 10004720 ORDER BY visit_date DESC LIMIT 1)
6138410041007bba41d241af,When did patient 10005817 get the glucose lab test in their last hospital encounter for the first time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,[],SELECT MIN(glucose_test_date) AS FirstGlucoseTestDate FROM LabTests WHERE patient_id = '10005817' AND test_type = 'glucose' AND encounter_type = 'hospital' AND status = 'completed' GROUP BY patient_id
cc583d453844985f8c75964d,Can you tell me how much hydrocodone-acetaminophen (5mg-500mg) costs?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'hydrocodone-acetaminophen (5mg-500mg)' ),,SELECT AVG(cost) AS average_cost FROM prescriptions WHERE medication = 'hydrocodone-acetaminophen' AND strength = '5mg-500mg'
f617b7296ab248a05c6041c0,What precautions should i take after a closed uterine biopsy procedure?,,,SELECT precautions FROM medical_procedures WHERE procedure_name = 'closed uterine biopsy'
fa4dfaaf2645d182bd7337d2,What was the minimum value of mean blood pressure for patient 10008454 on 12/02/2100?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-02'",[{'MIN(chartevents.valuenum)': None}],SELECT MIN(mean_blood_pressure) FROM patient_data WHERE patient_id = '10008454' AND date_of_measurement = '12/02/2100'
5a0f11cd2d321ee0bbab6b6c,What was the number of coronary arteriography using two catheters procedures performed since 1 year ago?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,"select count(*) from procedures where procedure_type = 'coronary arteriography with two catheters' and date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR)"
a5de915902ae68f1b9298fce,When was the last time patient 46528 had a medication which should be taken daily?,,,select max(date) as last_daily_medication_date from drugevents where person_id=46528 and days_supply=30
fe9f0b6e8813418d172e1e1c,How many 5% dextrose prescriptions were administered?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = '5% dextrose',[{'COUNT(*)': 0}],SELECT COUNT(*) AS NumberOfPrescriptions FROM Prescription WHERE DextroseConcentration = '5%'
f0d3b6aed52a69df797206eb,What were the five most frequent events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT Event, COUNT(*) as Frequency FROM events WHERE EventDate >= DATEADD(year, -1, GETDATE()) GROUP BY Event ORDER BY Frequency DESC LIMIT 5"
52e1920bba1dc62e51feb58b,Count the number of medicines that have been prescribed to patient 10021487 in 2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT COUNT(medicine) FROM prescriptions WHERE patient_id = 10021487 AND year(prescription_date) = 2100
b6207dcfe0579ae33b721201,What was the last time that patient 10040025 had the maximum value of hematocrit in 03/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],select max(hct) from lab_result where patient_id='10040025' and lab_date>='2023-03-01' and lab_date<'2023-04-01' and lab_result_id='HCT'
cbe87d3055a29ed5e694a4df,"Compared to yesterday, what new prescriptions were given to patient 10018081 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT prescription_id FROM prescriptions WHERE patient_id = 10018081 AND date = CURRENT_DATE AND prescription_id NOT IN (SELECT prescription_id FROM prescriptions WHERE patient_id = 10018081 AND date = CURRENT_DATE - INTERVAL '1 day')
0825d95545721aa700cc7fd0,What were the top five most common diagnoses during this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,select top 5 diagnoses from patient_records where year = 2022 order by count(diagnoses) desc
03d470fc8e41f5dd8568f771,What was the first medication that patient 10019385 was prescribed on their first hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Acetaminophen'}],"SELECT MIN(DATE) AS FirstPrescriptionDate, MEDICATION FROM EPISODE_DRUG WHERE EPISODE_ID = (SELECT EPISODE_ID FROM EPISODE WHERE PATIENT_ID = '10019385' AND ROWID = (SELECT MIN(ROWID) FROM EPISODE WHERE PATIENT_ID = '10019385')) GROUP BY MEDICATION ORDER BY FirstPrescriptionDate LIMIT 1;"
c559da124dcc274c8d5b1e61,How many patients were given insulin human regular prescriptions since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'insulin human regular' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"select count(distinct patid) from prescription where drugname = ""insulin human regular"" and date >= ""2100-01-01"""
1653c4779514ff5b7d86cad6,"How many patients in 2100 were diagnosed with cyst and pseudocyst of pancreas during the same month after the first diagnosis with other and unspecified alcohol dependence, in remission?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, in remission' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cyst and pseudocyst of pancreas' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,patients
db2ec5a725e4b2775b055f88,What are the five commonly ordered medications that patients aged 50s were prescribed within 2 months after diagnosed with long-term (current) use of insulin?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of insulin' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"select med_name, count(med_name) as cnt from (select distinct m.med_name, o.patient_id from prescriptions p join medications m on p.med_id = m.med_id join orders o on p.order_id = o.order_id join diagnoses d on p.diag_id = d.diag_id where d.condition = 'long-term use of insulin' and o.age_group = '50s' and o.order_date between d.diag_date and d.diag_date + interval 2 month) t group by med_name order by cnt desc limit 5"
b678b8112793dc9ca55c90b3,Calculate the number of patients discharged from the hospital this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS ""Number of Discharges"" FROM PatientRecords WHERE DischargeDate >= '2023-01-01' AND DischargeDate <= CURRENT_DATE"
41bdccec26b0e33321c1ec3f,"What is the diagnosis cost of hemiplegia, unspecified affecting left nondominant side?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemiplegia, unspecified affecting left nondominant side' ) )",,"SELECT SUM(cost) FROM medical_records WHERE diagnosis = 'hemiplegia, unspecified affecting left nondominant side'"
c395fa8a146f1042784e0d46,How much does patient 10006580's systolic blood pressure differ from the last value measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SQL Query
a711973109553fda82475f0b,Tell me the name of the drug which patient 10017492 was prescribed within 2 days after having had a spinal tap procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'spinal tap' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,SELECT drug_name FROM prescriptions WHERE patient_id = '10017492' AND prescription_date BETWEEN (SELECT procedure_date FROM procedures WHERE patient_id = '10017492' AND procedure_type = 'spinal tap') AND (SELECT procedure_date FROM procedures WHERE patient_id = '10017492' AND procedure_type = 'spinal tap') + INTERVAL '2 days'
2559181f4a14ba86cf190ad5,I would like to know the top three diagnoses that have the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",,"SELECT Diagnosis, AVG(1.0 * Mortality_6months / (1.0 * Total)) AS MortalityRate FROM (SELECT Diagnosis, COUNT(DISTINCT PatientID) AS Total, SUM(CASE WHEN Mortality_6months = 1 THEN 1 ELSE 0 END) AS Mortality_6months FROM PatientRecords GROUP BY Diagnosis) AS DiagnosisStats GROUP BY Diagnosis ORDER BY MortalityRate DESC LIMIT 3;"
e2cf012f4e5832fab8f5409b,What was the name of the drug that was prescribed to patient 10039831 first time through the im route since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT DISTINCT drug_name FROM prescriptions WHERE patient_id = 10039831 AND route = 'im' AND prescription_date >= '2100-07-21' ORDER BY prescription_date ASC LIMIT 1
41d43a2f58e87c8f4d88b801,What are the top four common microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]","select distinct * from (select test_name, count(*) as cnt, date_format(created_at, '%Y-%m') as dt from test t join test_result tr on t.id = tr.test_id where t.type = ""microbiology"" and created_at > now() - interval 1 year group by test_name, dt order by cnt desc) x order by dt desc limit 4"
023f3f0db56f39d9b838b1c0,What is the difference between diastolic blood pressure last measured on the first ICU visit compared to the second to last value measured on the first ICU visit for patient 10012552?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","[SELECT first.icu_id, (second.diasbp - first.diasbp) AS 'diastolic_pressure_difference'"
c90f896b24cab48d06c88f3d,Tell me the total input for patient 10007818 since 01/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-12'",[{'SUM(inputevents.totalamount)': 162565.80000305176}],"select sum(input) as total_input from (select input from chartevents where itemid in (211, 3420) and (valuenum>0 and valuenum<1000)) where icustay_id in (select icustay_id from icustays where subject_id=10007818 and intime >= '2100-12-01')"
f0782e76ee1d6e988ec5bb08,What is the cost of the drug named divalproex (extended release)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'divalproex (extended release)' ),,SELECT * FROM drug_cost WHERE name = 'divalproex (extended release)'
2ecf6ed7b588701c5b61916c,What was the total volume of or urine patient 10035185 had on their first ICU visit?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ),[{'SUM(outputevents.value)': None}],SELECT SUM(volume) FROM urine_records WHERE patient_id = 10035185 AND icu_visit_number = 1
eae3d736ea15573510314df8,Please tell me the name of the diagnosis patient 30267 received at the other department.,,,[SELECT d.name
733e2d8ccc688ba33154a9ab,What's the minimum total hospital cost that includes a protein lab test?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ) GROUP BY cost.hadm_id ) AS T1,,SQL Query
4c7e73d8e877dda69f26211c,When was the first time that patient 10038081 had the minimum value of immunoglobulin g?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin g' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],select min(immunoglobulin_g) as min_immunoglobulin_g from lab_tests where patient_id = 10038081
5780c98a714da7aa7512b363,Was patient 10021666 urea nitrogen tested in their first hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],SELECT * FROM lab_results WHERE patient_id = '10021666' AND test_name = 'Urea Nitrogen' AND encounter_number = 1
76b2409a30b5bbbeab3d334b,Has patient 7112 had a family history of a disease?,,,SELECT DISTINCT family_history.disease FROM patients JOIN family_history ON patients.id = family_history.patient_id WHERE patients.id = 7112 AND family_history.disease IS NOT NULL
9556f5bb39ef85f316ec69f4,I would like to know what dr. dunlow's on today's outpatient schedule.,,,"select distinct patient.last_name, patient.first_name, patient.middle_name, patient.mrn, patient.date_of_birth, patient.address, patient.city, patient.state, patient.zip_code, patient.phone, patient.email, patient.phone2, patient.email2, patient.marital_status, patient.race, patient.ethnicity, patient.language, patient.allergies, patient.immunizations, patient.insurance, patient.insurance2, patient.insurance3, appointment.provider_id, appointment.status, appointment.scheduled_date, appointment.scheduled_time, appointment.date_of_service, appointment.type, appointment.reason, appointment.patient_id, appointment.comments from patient left join appointment on patient.mrn = appointment.patient_id where appointment.scheduled_date = current_date and appointment.provider_id = (select provider_id from provider where last_name = 'dunlow' and first_name = 'joel' and middle_name = 'g') and appointment.type = 'OUTPATIENT' and appointment.status = 'SCHEDULED' order by appointment.scheduled_time"
167d39516102c791d110d62b,Which are the five most commonly taken lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]",SQL Query here
b5aedd087997ec2e10bb6736,Is the glucose value last measured on the first hospital visit in patient 10004235 less than the value from the second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT CASE WHEN MIN(glucose) < (SELECT glucose FROM patient_measurements WHERE patient_id = 10004235 AND visit_order = 1 ORDER BY measurement_time DESC LIMIT 1 OFFSET 1) THEN 'Yes' ELSE 'No' END AS IsLessThan FROM patient_measurements WHERE patient_id = 10004235 AND visit_order = 1;
33d0ec324183f0e65eb1f466,When was the first time patient 10020740 was prescribed drugs via po in 07/this year?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"SELECT MIN(DATE_FORMAT(DATE, ""%Y-%m-%d"")) AS FirstPrescriptionDate FROM (SELECT DISTINCT DATE_FORMAT(adm.DATETIME, ""%Y-%m-%d %H"") AS DATE FROM admission adm JOIN patient pat ON adm.PATIENT_ID = pat.PATIENT_ID JOIN admission_drug adm_drug ON adm.DATETIME = adm_drug.DATETIME JOIN drug ON adm_drug.DRUG_ID = drug.DRUG_ID WHERE pat.PATIENT_ID = '10020740' AND adm.CATEGORY = 'inpatient' AND adm.DATETIME BETWEEN '2023-07-01 00:00:00' AND LAST_DAY('2023-07-01') + INTERVAL 1 DAY - INTERVAL 1 SECOND AND adm_drug.ROUTE = 'po') AS UniqueDates"
7ea5b7b4bc12cad8a4e74fdc,What was the total dose of insulin human regular prescribed to patient 10019172 during the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'insulin human regular',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(insulin_dose) FROM medical_records WHERE patient_id = 10019172 AND visit_type = 'last' AND medication = 'insulin human regular'
ab86f0ba83c400b1a9f9b6c3,Did patient 10003046 have an input of free water on 12/24/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'free water' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'",[{'COUNT(*)>0': 0}],SELECT EXISTS (SELECT * FROM chartedevents WHERE patientunitstayid=10003046 AND itemid=227508 AND charttime BETWEEN 'last year-12-24 00:00:00' AND 'last year-12-24 23:59:59')
3c053c9b8b903c510ca0c818,What was patient 10008454's first tested specimen in 12/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],select top 1 specimen_name from lab_results where patient_id='10008454' and test_date >= '12/2100' order by test_date asc
499e4f8e7f92658595f68d33,"Has ondansetron, oxycodone liquid, or sodium chloride 0.9% been prescribed to patient 10020740?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug IN ( 'ondansetron', 'oxycodone liquid', 'sodium chloride 0.9%' )",[{'COUNT(*)>0': 0}],"SELECT DISTINCT medication_name FROM prescriptions WHERE patient_id = '10020740' AND medication_name IN ('ondansetron', 'oxycodone liquid', 'sodium chloride 0.9%')"
0f1253fab8016b9da9f6e223,When was the first time that patient 10015272 in 06/this year was given a asparate aminotransferase (ast) lab test?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1",[],SQLQuery
efa49770d1b09991933af299,Has patient 10019777 gone to an emergency room throughout this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)>0': 0}],SELECT * FROM admissions WHERE patient_id = 10019777 AND department = 'Emergency' AND date BETWEEN '2023-01-01' AND '2023-12-31';
b02107c6fe9f4494cc14728e,When was the first time of input time of patient 10018081 on this month/29?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '29' ORDER BY inputevents.starttime ASC LIMIT 1",[],"SELECT MIN(input_time) FROM patient_data WHERE patient_id = '10018081' AND DATE_FORMAT(input_time, '%Y-%m') = DATE_FORMAT(CURDATE(), '%Y-%m')"
88a7f40a049ecb037fdb2016,What was in 03/this year patient 10004235's minimum alveolar-arterial gradient value?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alveolar-arterial gradient' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'",[{'MIN(labevents.valuenum)': None}],"select min(p.alveolar_arterial_gradient) as ""Minimum A-A Gradient"" from (select * from patient_records as p where p.patient_id = '10004235' and p.visit_date between '2023-03-01' and '2023-03-31') as MarchVisits"
034ccc062d441cb484ca8a57,Has patient 10020944 come to the ER since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 0}],"select visit_id, patient_id, visit_start from ER_visits where patient_id = 10020944 and visit_start >= '2018-07-24'"
a811c24da8966874201c1f03,What was the last time of input of patient 10021487 since 03/20/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-20' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2117-03-09 14:20:00'}],SELECT MAX(input_time) AS last_input_time FROM patient_inputs WHERE patient_id = 10021487 AND input_time >= '03/20/2100'
48805e4216bd012669a77b8c,What are the top four commonly ordered treatments for patients in their 20s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,your SQL query here
bc55adec6e2f148eae8ab156,What was the name of the organism found in patient 10021487's first bronchoalveolar lavage microbiological test since 09/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],"[SELECT specimen_type, organism_name, date_collected"
2ea2811b8f3a6ed89aa46618,"When did last patient 10014729 have the minimum value of albumin, pleural in 03/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, pleural' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],"SELECT MIN(date) FROM patient_records WHERE patient_id = 10014729 AND test_type = 'albumin, pleural' AND date >= '03/01/2100' AND date <= '03/31/2100'"
07f02f8bb9cf48ec09ba120e,"In 10/2100, when was patient 10018845's last microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(test_date) FROM microbiology_tests WHERE patient_id = '10018845' AND test_date <= '2100-10-31'
6088d9d109938b6b36160f41,What was the last value of a asparate aminotransferase (ast) lab test of patient 10021938 last month?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT ast FROM lab_tests WHERE patient_id = 10021938 AND test_date BETWEEN DATE_SUB(LAST_DAY(NOW() - INTERVAL 1 MONTH), INTERVAL DAY(LAST_DAY(NOW() - INTERVAL 1 MONTH))-1 DAY) AND LAST_DAY(NOW() - INTERVAL 1 MONTH) ORDER BY test_date DESC LIMIT 1"
4d0bc94cd3038c80ab777027,What was the last drug prescribed in 02/this year to patient 10020187?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 * FROM prescriptions WHERE patient_id = '10020187' AND date_prescribed >= '2023-02-01' AND date_prescribed < '2023-03-01' ORDER BY date_prescribed DESC
e83b5e034fb29dbffbbeed14,"What are the charges for a procedure called bypass coronary artery, one artery from right internal mammary with autologous arterial tissue, open approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from right internal mammary with autologous arterial tissue, open approach' ) )",,SQL Query
5fac6ea9a02d544397cb54fe,Has patient 10018845 been given any medication?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ),[{'COUNT(*)>0': 1}],SELECT * FROM Medication WHERE patient_id = '10018845'
aedb02499fd35b17dcda7ada,What percentile is the creatinine value of 0.6 among patients of the same age as patient 10008454 on their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 0.6",,"select percentile_cont(0.5) within group (order by c_creatinine) over (partition by a_age) as median_creatinine from (select a_age, c_creatinine from patients p inner join encounters e on p.patient_id = e.patient_id inner join labs l on e.encounter_id = l.encounter_id where p.patient_id = 10008454 order by e.encounter_id desc limit 1) as patient_last_encounter join (select a_age, c_creatinine from labs l inner join encounters e on l.encounter_id = e.encounter_id inner join patients p on e.patient_id = p.patient_id) as all_patients on patient_last_encounter.a_age = all_patients.a_age where c_creatinine = 0.6"
232c1cf9aed1b4611fb6d99a,"Since 2100, what are the top five most frequent drugs prescribed to patients within 2 months after the diagnosis of atrial flutter?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial flutter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"[SELECT drug_name, COUNT(*) AS frequency"
d6ed2ef486b7d554f4160ba6,What was the name of the output that patient 10027445 had last since 06/02/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-02' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],"select * from (select o.name, o.output_date from outputs o join patients p on p.id = o.patient_id where p.id = 10027445 and o.output_date >= '06/02/2100' and o.output_date < CURRENT_TIMESTAMP) as recent_outputs order by output_date desc limit 1"
d4729c0ab6ae0748e9626cab,"In relation to others of the same age, where does a ph value of 7.34 for patient 10026255 rank in percentiles in their first hospital visit?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 7.34",,SELECT PERCENT_RANK() OVER (PARTITION BY age ORDER BY ph) AS ph_percentile FROM patient_health_data WHERE patient_id = '10026255' AND visit_number = 1
4afe78a50dbf480375c2d614,What was the name of the organism found in the first bronchoalveolar lavage microbiology test of patient 10021487 in 12/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'bronchoalveolar lavage' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT NAME FROM bronchoalveolar_lavage_microbiology_tests WHERE PATIENT_ID = 10021487 AND TEST_DATE = (SELECT MIN(TEST_DATE) FROM bronchoalveolar_lavage_microbiology_tests WHERE PATIENT_ID = 10021487 AND TEST_DATE LIKE '12/2100%')
c3fd367fdc390db8d0461dff,When was patient 10007818's mean blood pressure first measured less than 75.0 since 241 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 75.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-241 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT * FROM (SELECT MIN(DATE(time_stamp)) AS FirstDateBelow75 FROM blood_pressure WHERE patient_id = 10007818 AND value < 75.0 AND DATE(time_stamp) >= DATE_SUB(CURDATE(), INTERVAL 241 DAY)) AS FirstMeasurementBelow75"
59a23b41fa280018e0e17257,Calculate the number of enalapril maleate prescriptions.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'enalapril maleate',[{'COUNT(*)': 7}],SELECT COUNT(*) FROM prescriptions WHERE drug_name = 'Enalapril Maleate';
c550bac1aacd2bc72e7e12ab,What was the admission type for patient 10009049's last visit to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10009049 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1",[{'admission_type': 'EW EMER.'}],SELECT admission_type FROM visits WHERE patient_id = '10009049' ORDER BY visit_date DESC LIMIT 1
99e2661e12b6c6e852955ea5,How was patient 10022281 last admitted to the hospital in terms of admission type?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10022281 ORDER BY admissions.admittime DESC LIMIT 1,[{'admission_type': 'EW EMER.'}],select admission_type_id from ADMISSIONS where patient_num='10022281' order by admission_date desc limit 1
59d3175a30ad9fe65e39996d,"How many times, since 1 year ago, was a open reduction of fracture with internal fixation, humerus procedure ordered?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open reduction of fracture with internal fixation, humerus' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,"select count(*) from cpt_encounter where cpt_code like '2360%' and cpt_date >= DATEADD(year, -1, GETDATE())"
745585ee3b0d6a5e1b414a94,"Count the number of patients who underwent a cholesterol, hdl lab test since 1 year ago.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, hdl' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) FROM lab_tests WHERE test_type IN ('cholesterol', 'hdl') AND test_date >= DATEADD(year, -1, GETDATE())"
a8572111c6db24cf56d0391e,Is patient 10010471's sodium value last measured on the last hospital visit greater than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT MAX(CASE WHEN sr.visit_id = (SELECT MAX(visit_id) FROM SITE_RESEARCH_VALUE WHERE patient_id = 10010471) THEN sr.sodium ELSE NULL END) > MIN(CASE WHEN sr.visit_id = (SELECT MAX(visit_id) FROM SITE_RESEARCH_VALUE WHERE patient_id = 10010471) THEN sr.sodium ELSE NULL END) FROM SITE_RESEARCH_VALUE sr WHERE sr.patient_id = 10010471 AND sr.parameter_name = 'sodium'
9a5ebe2812ee93bc053bbf59,"Since the last time patient 10021487 was diagnosed with alcohol abuse, unspecified on their current hospital visit, how many hours have passed?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT TIMESTAMPDIFF(HOUR, MAX(DiagnosisDate), CURDATE()) AS HoursSinceLastDiagnosis FROM PatientDiagnoses WHERE PatientID = 10021487 AND DiagnosisCode = 'F10.10' AND AdmissionDate > (SELECT MAX(AdmissionDate) FROM PatientDiagnoses WHERE PatientID = 10021487 AND DiagnosisCode = 'F10.10');"
92672fa0de871a17570f6c7b,Tell me patient 10003046's total gastric meds input amount on 01/16/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '01-16'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(amount) AS total_gastric_meds FROM medication_events WHERE patient_id = 10003046 AND medication_type = 'gastric' AND DATE(event_datetime) = '2023-01-16'
2701dd64f96330440b0d5b10,Is a genetic test that patient 95057 has had?,,,SELECT DISTINCT g.name FROM genetic_tests g INNER JOIN patient_tests pt ON g.id = pt.test_id WHERE pt.patient_id = 95057
b70079e92720b4a5b0ac3a9a,Has patient 10004733 had an input of nepro (full) since 12/29/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nepro (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-29'",[{'COUNT(*)>0': 0}],SELECT * FROM medical_records WHERE patient_id = '10004733' AND procedure_name = 'nepro (full)' AND procedure_date >= '12/29/2100'
e7fcf849ac87ce9fbbd3cf84,What was the name of the procedure that was given two or more times to patient 10007795 since 12 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-12 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,Your SQL Query Here
a25bb889984fbcb71773db73,Retrieve the yearly minimum amount of patient 10037975's pre-admission/non-icu intake input.,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission/non-icu intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)",[],"SELECT MIN(input_amount) as yearly_min, EXTRACT(YEAR FROM intake_date) as year FROM intake_inputs WHERE patient_id = 10037975 AND category = 'pre-admission' AND unit_type = 'non-icu' GROUP BY year ORDER BY year"
0e460c97c84c743bb885aefe,When was the first input time for patient 10022281 since 06/03/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-03' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2125-06-17 05:10:00'}],SELECT MIN(input_time) FROM patient_records WHERE patient_id = '10022281' AND input_time >= '06/03/2100'
23bbac068db32a4e588f2d9e,Please list out the monthly maximum weight of patient 10039997 in the first hospital encounter.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m',chartevents.charttime)",[],"SELECT month, MAX(weight) AS max_weight FROM patient_encounter WHERE patient_id = 10039997 AND encounter_number = 1 GROUP BY month"
814f6690d0bc9410fa12b9f4,What was the total dose of aspirin patient 10017492 had been prescribed during the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'aspirin',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(DOSE) FROM prescription WHERE PATIENT_ID = '10017492' AND VISIT_TYPE = 'last';
43377e1ef48d695d15424da9,What is the cost for the medicine topiramate (topamax)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'topiramate (topamax)' ),,SELECT cost FROM medicines WHERE name = 'topiramate (topamax)'
3347c7735b3a39f53f492495,Tell me the average overall hospital cost that includes amitriptyline this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'amitriptyline' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(hospital_cost) FROM admissions WHERE YEAR(admission_date) = YEAR(CURRENT_DATE) AND prescribed_drugs LIKE '%amitriptyline%';
bf7b0e75c5c6bf62f8ebec79,Has patient 10014729 received any piggyback in 03/this year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',inputevents.starttime) = '03'",[{'COUNT(*)>0': 0}],"select count(*) from piggyback where patient_id = 10014729 and date_part('month', date) = 3 and date_part('year', date) = 2023"
906878394c7c53d1c7d622c0,I would like to know all of the prescriptions patient 21003 received at the other department.,,,SELECT * FROM prescriptions WHERE patient_id=21003 AND department_id!=1
4c853a58d04f9b3b5fb7cf1c,What is the id of the ward where patient 40707 can be admitted?,,,SELECT ward_id FROM admissions WHERE patient_id = 40707
32955b67aaf8c2bd57e9ef2b,What was the name of the specimen given to patient 10005817 for the first time since 08/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'URINE'}],select distinct specimen_name from medical_records where patient_id = 10005817 and date >= '08/2100' order by date limit 1
2760ec29711e48dd4fbb1d5e,"Has patient 10007818 gone through a urea nitrogen, urine test in 10/last year?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'",[{'COUNT(*)>0': 0}],"select distinct urea_nitrogen_test_date from lab_results where patient_id = 10007818 and test_type = 'urea nitrogen, urine' and date_part('month', urea_nitrogen_test_date) = 10 and date_part('year', urea_nitrogen_test_date) = date_part('year', current_date) - 1"
bf1ccb5ac4a847d66be6bc96,What was the organism detected in patient 10027602's first mini-bal microbiology test on their first hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],select o.name from organism o inner join mini_bal_microbiology m on o.id = m.organism_id where m.patient_id = 10027602 and m.test_type = 'first' and m.encounter_type = 'first'
19c3aaa1bb33be228b47ea7b,What is the yearly maximum sterile water input for patient 10020740?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'sterile water' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)",[],SELECT MAX(sterile_water_input) FROM patient_input WHERE patient_id = 10020740 GROUP BY YEAR(date)
837818ce3b6b8d41acc4c4ea,"What was the first lab test result of the cholesterol, total for patient 10014354 in 10/2100?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT TOP 1 result FROM lab_tests WHERE patient_id = '10014354' AND test_name = 'Cholesterol, Total' AND date_part('year', test_date) = 2100 AND date_part('month', test_date) = 10 ORDER BY test_date ASC"
38bb18f4f12bf469e4927756,When did patient 10018845 get an input for the last time since 09/09/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-09' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2184-10-09 13:24:00'}],SELECT MAX(date) FROM patient_inputs WHERE patient_id = 10018845 AND date > '2100-09-09' GROUP BY patient_id
e965cf8b6399b0933da46e48,Provide a list of the four most common diagnoses that patients were diagnosed with within 2 months after undergoing the enteral infusion of concentrated nutritional substances procedure in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"select diagnosis, count(diagnosis) as c from (select diagnosis from chartevents where icustay_id in (select icustay_id from chartevents where itemid = 311 and value != 'Enteral Infusion of Concentrated Nutritional Substances' and value != ' ' and value is not null and charttime > (select charttime from chartevents where itemid = 311 and value = 'Enteral Infusion of Concentrated Nutritional Substances') and charttime < date_add((select charttime from chartevents where itemid = 311 and value = 'Enteral Infusion of Concentrated Nutritional Substances'), interval 2 month) and icustay_id in (select icustay_id from icustays where intime >= '2100-01-01' and intime < '2101-01-01') ) group by icustay_id, diagnosis ) as a group by diagnosis order by c desc limit 4;"
036dc7fd74fcfcf46d3ee504,What is the daily average input of or ffp intake that patient 10018081 is getting since 12/22/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ffp intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-22' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],SELECT AVG(OR_FFPM_INPUT) AS daily_avg_or_ffpm_input FROM patient_data WHERE patient_id = '10018081' AND date >= '12/22/2100' GROUP BY DATE(date);
0ae32bee1adc6a16d66b16de,What was patient 10036156's documented weight on the last record since 12 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT TOP 1 weight FROM records WHERE patient_id = 10036156 AND date > DATEADD(month, -12, GETDATE()) ORDER BY date DESC"
73f03c4b396e0636de5ad08b,What are the three commonly taken specimens for patients that were diagnosed with family history of ischemic heart disease previously in the same hospital visit?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of ischemic heart disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"select * from (select t1.specimen, count(t1.specimen) as count from patient_records t1 join patient_records t2 on t1.visit_id = t2.visit_id and t1.patient_id = t2.patient_id and t1.visit_id = t2.visit_id and t1.specimen != t2.specimen and t1.specimen != t3.specimen where t2.condition = 'family history of ischemic heart disease' group by t1.specimen) t order by count desc limit 3"
03cc8765cbc06f1cff174a6c,When did patient 10004733 get an input for the last time on 12/26/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-26' ORDER BY inputevents.starttime DESC LIMIT 1",[],SELECT TOP 1 input_time FROM patient_inputs WHERE patient_id = 10004733 AND input_date = '12/26/2023' ORDER BY input_time DESC
99ec0658e0c4b37ac1798c46,When was the first discharge of patient 10022880 from the hospital?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022880 ORDER BY admissions.dischtime ASC LIMIT 1,[{'dischtime': '2177-03-19 14:25:00'}],SELECT MIN(DischargeDate) FROM PatientDischarge WHERE PatientID = '10022880';
699d1833d8f298ac738b03d6,How many sodium bicarbonate prescription instances occurred since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'sodium bicarbonate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)': 8}],SELECT COUNT(*) FROM `t1` WHERE `days_since_last_fill` >= 365
0de02f3946d72e99a86d60ea,Is there any gene testing that patient 14397 had?,,,select distinct g.testid from gene_tests g join patient_tests t on g.testid = t.testid where t.patientid = 14397
3fad0b33ee39bfb6e59660eb,What was the last dose of sodium polystyrene sulfonate prescribed to patient 10021487 since 06/2100?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'sodium polystyrene sulfonate' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ORDER BY prescriptions.starttime DESC LIMIT 1",[],"SELECT `prescription`.`medication_name`, `prescription`.`dosage`, `prescription`.`prescription_date` FROM `patient_prescriptions` AS `prescription` WHERE `prescription`.`patient_id` = '10021487' AND `prescription`.`medication_name` = 'sodium polystyrene sulfonate' AND `prescription`.`prescription_date` > '2100-06-21' ORDER BY `prescription`.`prescription_date` DESC LIMIT 1"
f082ad77c50f76200f9ef93d,"Tell me the maximum total hospital cost that includes extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic in 2100.","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_hospital_cost) FROM claims WHERE hcpcs_code = '32466' AND year = 2100
58036fbf344f61c449c588f0,Could you count the number of times patient 10039997 visited the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10039997 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT count(*) AS visit_count FROM ADMISSIONS WHERE HADM_ID = '10039997' AND ADMIT_DATE BETWEEN 'YYYY-01-01' AND 'YYYY-12-31';
2977de037421f92addee92ab,What is the total volume of patient 10021487's input on 12/22/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-22'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input_volume) FROM intake_records WHERE patient_id = '10021487' AND date = '12/22/this year'
44fca1429144bd57023476d8,"When was the first time that patient 10014729 has received a calcium, total lab test in 03/2100?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime ASC LIMIT 1",[],"select min(date) from lab_results where patient_id = 10014729 and test_type = 'calcium, total' and date like '03/2100%'"
436811ca71744e404dd509d5,Can you provide me the monthly minimum amount of or cell saver intake that patient 10035185 received?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",[],"SELECT MIN(Amount) FROM Transfusion WHERE PatientID = 10035185 AND ProcedureType IN ('Or', 'Cell Saver') GROUP BY MONTH(Date)"
ddbe991f30c6934480e21599,How many patients were prescribed the drug diltiazem extended-release since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'diltiazem extended-release' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],[SELECT COUNT(DISTINCT p.patient_id)
6c22bec7e47dc38b30e3f2b9,"What was the last instance when the diastolic blood pressure of patient 10026354 was greater than 71.0, since 08/10/2100?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 71.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-10' ORDER BY chartevents.charttime DESC LIMIT 1",[],event_date
819106b66507d6daacc3feba,What's up with the single rooms now?,,,"SELECT room_type, room_status FROM hotel_reservations WHERE room_type = 'single' AND check_in_date >= CURDATE();"
7137bae0cea575cb815bc23e,What drug was prescribed to patient 10004235 within 2 days after the procedure of central venous catheter placement with guidance since 03/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,
55a82d52a8bcc98c682b8a78,How long did patient 26286 have to undergo contr cerebr arteriogram?,,,"SELECT d.dur FROM procedure p, diagnosis d WHERE p.patient_id = 26286 AND p.type = 'contr cerebr arteriogram' AND p.diag_id = d.id"
2092bc06715d6d43db8d20c2,Is the mch value of patient 10025612 on the second measurement on the first hospital visit less than the value from the first measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN mch2 < mch1 THEN 'Yes' ELSE 'No' END FROM (SELECT mch AS mch1, LEAD(mch) OVER (PARTITION BY patientid ORDER BY hospital_visit_id, measurement_id) AS mch2 FROM lab_results WHERE patientid = 10025612 AND hospital_visit_id = (SELECT MIN(hospital_visit_id) FROM lab_results WHERE patientid = 10025612)) AS subquery WHERE measurement_id = 1"
9206421c128de64e2474230a,What were the top five most frequently prescribed medicines since 1 year ago?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]","SELECT MEDICINE_NAME, COUNT(*) AS PRESCRIPTION_COUNT FROM PRESCRIPTIONS WHERE PRESCRIPTION_DATE > DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY MEDICINE_NAME ORDER BY PRESCRIPTION_COUNT DESC LIMIT 5"
b6b5724cdad99c96a0d0a001,When did patient 10024043 get a mrsa screen microbial test for the first time?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],SELECT MIN(ADMISSIONTIME) FROM microbiologyevents WHERE PATIENT_NUM = 10024043 AND SPECIMEN = 'MRSASCREEN'
9536521393863e42357a143b,What was the maximum phosphate value for patient 10012853 in the first hospital visit?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ),[{'MAX(labevents.valuenum)': None}],SELECT MAX(PHOSPHATE) FROM LABEVENTS WHERE SUBJECT_ID = 10012853 AND HADM_ID = (SELECT MIN(HADM_ID) FROM LABEVENTS WHERE SUBJECT_ID = 10012853)
68312cee150a54cd1fa02383,Provide the daily minimum weight of patient 10007058 throughout this year.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT measurement_date, MIN(weight) FROM patient_measurements WHERE patient_id = '10007058' AND YEAR(measurement_date) = YEAR(CURRENT_DATE()) GROUP BY measurement_date ORDER BY measurement_date;"
737c9f23dfb633b9095279c8,What output did patient 10006580 last have since 05/19/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-19' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],"SELECT output, timestamp FROM patient_records WHERE patient_id = '10006580' AND timestamp > '05/19/2100' ORDER BY timestamp DESC LIMIT 1;"
a857fe023621b88d5229e66e,What treatment were provided to patient 10021938 two or more times since 07/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"select t1.treatment_type from Treatment as t1, Patient as t2 where t1.patient_id = t2.id and t2.id = '10021938' and t1.date_time >= '07/2100' group by t1.treatment_type having count(t1.treatment_type) > 1 order by t1.treatment_type"
c7834523cd66eb840495c036,"What are the top four most frequently ordered lab tests for patients within 2 months after being diagnosed with acute edema of lung, unspecified?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute edema of lung, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT test, COUNT(test) AS order_count FROM lab_tests WHERE patient_id IN (SELECT patient_id FROM diagnoses WHERE condition = 'acute edema of lung, unspecified' AND diagnosis_date BETWEEN DATE_SUB(NOW(), INTERVAL 2 MONTH) AND NOW()) GROUP BY test ORDER BY order_count DESC LIMIT 4"
1479c9147e64755116efc852,"In the last hospital visit, how much gemfibrozil has been prescribed to patient 10007795 in total?",SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'gemfibrozil',[{'SUM(prescriptions.dose_val_rx)': None}],select sum(quantity) from prescrip where patid='10007795' and an='Last' and medname='gemfibrozil'
72a6cc827b8581d7058c56f4,Have any procedures been performed on patient 10019917 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,select count(*) from procedure where patientid=10019917 and startdate>='2100-01-01'
ab0e982e3bb15b1ab0e9c576,What are the four most often performed treatments for patients aged 20s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT treatment, COUNT(patient_id) as frequency FROM treatments WHERE YEAR(treatment_date) = 2100 AND patient_age BETWEEN 20 AND 29 GROUP BY treatment ORDER BY frequency DESC LIMIT 4"
30bb66210d2f8e9a6b6b709f,"Count the number of patients who received other endoscopy of small intestine within 2 months after being diagnosed with alcohol abuse, unspecified since 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcohol abuse, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT COUNT(DISTINCT patient_id) AS patient_count FROM patient_records WHERE procedure = 'other endoscopy of small intestine' AND procedure_date BETWEEN diagnosis_date AND DATE_ADD(diagnosis_date, INTERVAL 2 MONTH) AND diagnosis = 'alcohol abuse, unspecified' AND diagnosis_date >= '2100-01-01' AND diagnosis_date <= '2100-12-31'"
ca03ac7bbb7eccf0152f825a,How do you proceed with the anticancer drugs?,,,select * from anticancer_drugs
704f14d72d85257a378afe42,What was the last lab test result of the free calcium for patient 10008287 in 10/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT TOP 1 * FROM lab_results WHERE patient_id = 10008287 AND test_name = 'Free Calcium' AND date >= '2023-10-01' ORDER BY date DESC
26ca7defafe27bfa854cf965,Calculate the number of ICU visits for patient 10009628 last year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 0}],SELECT COUNT(*) AS `Number of ICU Visits` FROM `icu_visits` WHERE `patient_id` = 10009628 AND `visit_date` BETWEEN '2022-01-01' AND '2022-12-31'
68827b6e5c9eec5eb540e971,"Tell me the top three most frequent procedures that patients were given within 2 months after receiving dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"select procedure_name, count(procedure_name) as procedure_count from patient_procedures where procedure_name = 'dilation of lower esophagus with intraluminal device, via natural or artificial opening endoscopic' group by procedure_name order by procedure_count desc limit 3;"
090b965f222b18444e2a1020,"What was the first time that the respiratory rate of patient 10021487 was, on their last ICU visit, less than 27.0?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 27.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],select min(measurement_time) from icu_data where patient_id = 10021487 and respiratory_rate < 27.0 and visit_id = (select max(visit_id) from icu_data where patient_id = 10021487)
ab353a41c3fc36453bfc931c,What was the name of the diagnosis that patient 10007795 received for the last time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,SELECT Diagnosis FROM PatientRecords WHERE PatientID = 10007795 ORDER BY VisitDate DESC LIMIT 1
a0ba285d46d08d5da3b63d69,Which are the top four most common lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",SQL Query
7b2e4a56a587f857df255484,What percentile is the value of 30.0 in calculated total co2 among patients of the same age as patient 10038999 on their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 30.0",,SELECT PERCENT_RANK() OVER (ORDER BY calculated_total_co2) AS percentile FROM patient_first_encounter WHERE patient_id = 10038999 AND calculated_total_co2 <= 30.0
3bbc83c195a74b99b51777c9,"Since 08/2100, when was the last time that patient 10001217 was prescribed medication via the pr route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.route = 'pr' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(order_datetime) AS last_pr_order_date FROM prescriptions WHERE patient_id = '10001217' AND route = 'PR' AND order_datetime >= '2023-08-21 00:00:00'
61d76023e4eecb1aac307c96,Count the number of hospital visits patient 10026354 had since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026354 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],SELECT COUNT(*) FROM `PatientVisits` WHERE `PatientID` = 10026354 AND `VisitDate` > '2100-01-01'
be30995ff00536a1057c7245,Was any nacl 0.9% medication provided to patient 10027602 on their first ICU stay?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],select exists (select 1 from Medication where icustay_id = 10027602 and itemid = (select itemid from Itemid where generic_name = 'nacl 0.9%') and charttime <= (select intime from IcuStays where icustay_id = 10027602)) as MedicationProvided
0918bda2bde8b0408f60fc3e,Can you tell me the top five diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT TOP 5 Diagnosis, 6MonthMortality FROM (SELECT Diagnosis, SUM(6MonthMortality) AS 6MonthMortality FROM patients GROUP BY Diagnosis) AS SubQuery ORDER BY 6MonthMortality DESC"
f07d01a1db0173ba1a3cfff4,"How many people had a test for bilirubin, direct during the previous year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, direct' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) AS num_patients FROM lab_results WHERE test_name = 'Bilirubin, Direct' AND test_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE();"
73cbfeea05bf53b8f480cd6a,What was the last output since 12/19/2100 for patient 10010471?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-19' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Emesis'}],"select output_date, output_result from patient_records where patient_id = 10010471 and output_date > '12/19/2100' order by output_date desc limit 1"
41e594b8986edc48616272fc,When was patient 10013049's last input on the last ICU stay?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,[{'starttime': '2114-06-21 10:00:00'}],"SELECT MAX(input_time) FROM `physionet-data.mimiciii_clinical.inputevents_mv` WHERE patient_id = 10013049 AND hadm_id = (SELECT hadm_id FROM `physionet-data.mimiciii_icu.stays` WHERE patient_id = 10013049 ORDER BY deathtime DESC, intime DESC LIMIT 1)"
ecf8d3921fe7ec039f51e46e,What was the total metformin (glucophage) dose that patient 10020306 has been prescribed on the first hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'metformin (glucophage)',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(Dose) as TotalMetforminDose FROM HospitalEncounters WHERE PatientID = 10020306 AND MedicationName = 'Metformin (Glucophage)' AND EncounterNumber = 1
ff9d739f6aef4f0e6a4fad34,What are the five most common laboratory tests undertaken by patients in the same month following a diagnosis of personal history of other venous thrombosis and embolism since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of other venous thrombosis and embolism' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"[SELECT TOP 5 Test_Name, COUNT(Test_ID) AS Test_Count"
a65675d809840dc8d6dda8a4,What percentile is rdw 13.5 among patients of the same age as patient 10020786 on their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.5",,SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY lab.rdw) AS rdw_percentile FROM lab JOIN encounter ON lab.encounter_id = encounter.id JOIN person ON encounter.patient_id = person.person_id WHERE encounter.encounter_id = 10020786 AND lab.test_date = encounter.encounter_date AND encounter.visit_number = 1 AND encounter.visit_type_id = 2 AND person.age = (SELECT age FROM person WHERE person_id = 10020786) AND lab.test_name = 'rdw'
a8dc3b5c9cad1f39f5e216c6,Give me the count of patients who were prescribed gastroview (diatrizoate meglumine & sodium) since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'gastroview (diatrizoate meglumine & sodium)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"select count(distinct patient_id) from prescriptions where drug_name = 'gastroview' and prescription_date >= DATE_SUB(NOW(), INTERVAL 1 YEAR)"
5f2a159055d6adad640855a4,Show me the top four most frequent drugs that patients were prescribed during the same hospital visit after being diagnosed with hemorrhage complicating a procedure in this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hemorrhage complicating a procedure' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 p.drug, COUNT(*) AS frequency FROM prescriptions p JOIN diagnoses d ON p.patient_id = d.patient_id WHERE d.condition = 'hemorrhage complicating a procedure' AND YEAR(d.diagnosis_date) = YEAR(CURDATE()) GROUP BY p.drug ORDER BY frequency DESC"
fd65cc9a15899b7d467ba196,Could you list the four diagnoses that had the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT diagnosis, COUNT(mortality) as mortality_count FROM patient_records WHERE time_frame = '3-month' GROUP BY diagnosis ORDER BY mortality_count DESC LIMIT 4"
61d45a73e8a0469f9bf963be,Can you tell me if patient 10020944 is male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020944,[{'gender': 'M'}],SELECT gender FROM `physionet-data.mimiciii_clinical.admissions` WHERE subject_id = 10020944
17086641ec84cd4ab9ebe9be,What is the cost of a diagnosis for personal history of antineoplastic chemotherapy?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of antineoplastic chemotherapy' ) ),,select cost from diagnosis where description='Personal history of antineoplastic chemotherapy'
f46ac5597a933d3aa191df19,Give me the four most frequent procedures performed since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT procedure_name, COUNT(*) AS frequency FROM procedures_performed WHERE procedure_date >= '2100-01-01' GROUP BY procedure_name ORDER BY frequency DESC LIMIT 4"
33b970d4dd11fbe67b989d1c,Can you tell me the total amount of acetaminophen that patient 10007928 has been prescribed since 03/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND prescriptions.drug = 'acetaminophen' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(dosage) FROM prescriptions WHERE patient_id = 10007928 AND drug_name = 'acetaminophen' AND prescription_date >= '03/2100'
a3453842fa6d5f908f2e8c6e,What was the medication patient 10010471 was prescribed for the first time via po in 05/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"select distinct p.drug_name from (select distinct drug_name, drug_route, drug_start_date from adt_drugorders where person_id = 10010471 and drug_start_date like '2019-05%') p where p.drug_route='po' order by p.drug_start_date limit 1"
f6274c47226150acc9cef0e2,Find out the number of medicines given to patient 10002428.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ),[{'COUNT(*)': 320}],SELECT COUNT(*) AS NumberOfMedicinesGiven FROM MedicationRecords WHERE PatientID = 10002428
c72069fe9515604ba1be94c3,"During the first hospital encounter, what was the average glucose value for patient 10013049?",SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ),[{'AVG(labevents.valuenum)': None}],SELECT AVG(glucose_value) FROM lab_results WHERE encounter_id = (SELECT id FROM encounters WHERE patient_id = 10013049 AND encounter_sequence = 1) AND test_name = 'Glucose'
df5a3dc1bac62f8679a50e44,Was patient 10023239's % hemoglobin a1c last measured on the first hospital visit greater than the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",Provide the SQL query
c56635619ccd4b7ce64652e4,"Since 09/2100, what amount of fluoxetine was prescribed to patient 10014354?","SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND prescriptions.drug = 'fluoxetine' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(Dosage) AS TotalFluoxetinePrescribed FROM Prescriptions WHERE PatientID = 10014354 AND Medication = 'fluoxetine' AND DatePrescribed >= '2023-09-21'
9838b1b25dbb387afc8f07aa,What is the prescription dose of opioid for patient 31306?,,,SELECT prescription_dose FROM opioid_prescriptions WHERE patient_id = 31306;
d9cc62f7c052734452299128,What is the number of drugs patient 10037861 was prescribed?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ),[{'COUNT(*)': 265}],SELECT COUNT(DISTINCT drug_name) FROM prescriptions WHERE patient_id = 10037861
80804f44b70738e1d5232084,What number of patients were in the neurology during the last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neurology' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) FROM Admissions WHERE department = 'Neurology' AND admission_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
96cf60d6448c822883274a24,When was the first urine microbiology test performed since 03/2100 for patient 10018845?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(test_date) FROM lab_tests WHERE patient_id = '10018845' AND test_type = 'urine microbiology' AND test_date >= '03/2100' AND test_date <= CURRENT_DATE
aae494e615785b0b4e7f5bd8,Tell me the insurance plan of patient 10007928 on their first hospital encounter.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],SELECT insurance_plan FROM patient_records WHERE patient_id = '10007928' AND encounter_order = 1
1cf9f8c80c784082726a6dde,Has patient 10014078 received any treatment of continuous invasive mechanical ventilation for less than 96 consecutive hours in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,"[SELECT DISTINCT p.patient_id, t.treatment_id, t.treatment_type, MIN(t.start_time) AS start_time, MAX(t.end_time) AS end_time, DATEDIFF(hour, MIN(t.start_time), MAX(t.end_time)) AS duration_hours"
f34663f44ea8f4f001b5cd92,When did patient 10005909 receive the first duloxetine and levothyroxine sodium prescription at the same time in 11/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'duloxetine' AND admissions.subject_id = 10005909 AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'levothyroxine sodium' AND admissions.subject_id = 10005909 AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT prescription_date FROM prescriptions WHERE patient_id = 10005909 AND (medication = 'duloxetine' OR medication = 'levothyroxine sodium') AND YEAR(prescription_date) = 2100 GROUP BY prescription_date HAVING COUNT(DISTINCT medication) = 2 ORDER BY prescription_date ASC LIMIT 1
c673226d59266c9f24c1559d,Does patient 70206 have a traveling history abroad?,,,SELECT EXISTS (SELECT 1 FROM travel_history WHERE patient_id = 70206 AND destination_type = 'Abroad') AS has_abroad_travel_history;
a4b7670404c595bc4689c577,When was the first time that in 01/2100 patient 10003046 was prescribed a medication via sc?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(prescription_date) FROM prescriptions WHERE patient_id = '10003046' AND route = 'sc' AND prescription_date LIKE '01/2100%'
21e6de874970fa7ae9510d18,Does patient 6170 have previous overseas travel?,,,select * from `healthcare_database`.`patient_history` where `patient_id` = 6170 and `event_type` = 'overseas_travel'
d4255f4b8d7db34c02b8c1c8,"Throughout this month, when did patient 10008454 receive the last urine microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],"Select the top row from the table 'urine_microbiology_tests' where 'patient_id' equals 10008454 and 'date_performed' is within the current month, ordered by 'date_performed' in descending order, and limit the results to only the first row."
c9f7a8db98a61fe956ee074c,What was the total amount of mirtazapine prescribed to patient 10020786 in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND prescriptions.drug = 'mirtazapine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'",[{'SUM(prescriptions.dose_val_rx)': None}],select sum(AMOUNT) from TABLE where PATIENT_ID = 10020786 and DRUG_NAME = 'Mirtazapine' and ORDER_DATE between '2023-07-01' and '2023-07-31'
6fc987dbdba9f552b5be7f44,Could you calculate the total amount of output from patient 10008454 since 192 days ago?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-192 day')",[{'SUM(outputevents.value)': 10834.0}],SELECT SUM(output) FROM PatientRecords WHERE patient_id = '10008454' AND visit_date >= CURDATE() - INTERVAL 192 DAY
dbc236ec214beb6e0a9a5ff0,What is the treatment that patient 10016742 was given two or more times since 7 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-7 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,[SELECT DISTINCT t.treatment_name
8499e24e138f45443a93fa6d,How much did patient 10002495 weigh when measured for the last time since 12 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"select top 1 weight from measurements where patient_id=10002495 and measurement_date > add_months(current_timestamp,-12) order by measurement_date desc"
88ef45f61812b1ec67818a35,When was the last time that patient 10022017 had the maximum value of respiratory rate since 203 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-203 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],"[SELECT MAX(RESPIRATORY_RATE) AS last_max_respiratory_rate, EXAM_DATE AS date_of_last_max"
9f9db02efbdc2ea5168b658f,Show the respiratory rate changes of patient 10031757 measured at 2100-10-26 21:00:00 compared to the value measured at 2100-10-26 20:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-10-26 21:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-10-26 20:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-10-26 21:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-10-26 20:00:00' )"": None}]",SELECT ((respiratory_rate_21:00 - respiratory_rate_20:00) / respiratory_rate_20:00) * 100 AS percentage_change FROM respiratory_measurements WHERE patient_id = 10031757 AND measurement_time BETWEEN '2100-10-26 20:00:00' AND '2100-10-26 21:00:00'
ae9c55faced4361a10905a51,What were the top five most common procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT `procedure`, COUNT(`procedure`) AS `frequency` FROM `procedures` WHERE `year` >= 2100 GROUP BY `procedure` ORDER BY `frequency` DESC LIMIT 5"
bfd7a42fc2f55f570373a0ef,What was the average value of monocytes for patient 10006053?,SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ),[{'AVG(labevents.valuenum)': None}],select avg(mono_v) from blood_tests where patient_id = '10006053'
8de8d255ebcc53e5933862db,What output did patient 10011398 generate last on this month/26?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '26' ORDER BY outputevents.charttime DESC LIMIT 1 )",[],select * from patient_output where patient_id = 10011398 and output_date = (select max(output_date) from patient_output where patient_id = 10011398 and output_date <= '2023-03-26')
ed782775b12829eac1c6a491,Has there been any organism found in patient 10015860's first swab microbiology test in their first hospital visit?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'swab' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'COUNT(*)>0': 0}],SELECT CASE WHEN COUNT(*) > 0 THEN 'Yes' ELSE 'No' END FROM microbiology_test_results WHERE patient_id = 10015860 AND swab_order_number = 1 AND test_result = 'Positive' AND visit_number = 1
9bb095b969e981359c08d126,Did patient 10022041 experience any procedure on the first hospital stay?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) AS procedure_count FROM procedures WHERE patient_id = '10022041' AND admission_id = (SELECT admission_id FROM admissions WHERE patient_id = '10022041' AND stay_order = 1) AND date_performed BETWEEN admission_date AND discharge_date
ed7775067dbd67782c081e36,Can you inform me of the first macrophage test result for patient 10014078 since 03/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'macrophage' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT TOP 1 `Result` FROM `PatientTestRecords` WHERE `PatientID` = 10014078 AND `TestName` = 'Macrophage' AND `TestDate` > '2000-03-21' ORDER BY `TestDate` ASC
934088633430fb5451e8191e,What was the last measured value of heart rate for patient 10018423 since 289 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-289 day') ORDER BY chartevents.charttime DESC LIMIT 1",[],Your SQL Query Here
5b28d4b561ee2e25d84025fb,What's the number of patients who were pulmonary congestion and hypostasis diagnosed?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pulmonary congestion and hypostasis' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patient_records WHERE diagnosis LIKE '%pulmonary congestion%' AND diagnosis LIKE '%hypostasis%'
6efcf394736a462c14ad905e,How often was phenytoin sodium prescribed since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'phenytoin sodium' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 0}],SQL Query
abae98d91941955983212127,Has patient 10022041 received any d5 1/2ns since 05/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-05'",[{'COUNT(*)>0': 0}],table
def1690cfa1cd58ae29ab510,What was the total amount of soln that patient 10014078 has been prescribed in the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'soln',[{'SUM(prescriptions.dose_val_rx)': None}],select sum(prescribed_soln) from prescriptions where patient_id = 10014078 and visit_date = (select max(visit_date) from prescriptions where patient_id = 10014078)
cfb16f496f6c359ae9e6da4e,"What are the costs of allergic rhinitis, cause unspecified diagnosis?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'allergic rhinitis, cause unspecified' ) )",,"SELECT costs FROM medical_costs WHERE diagnosis = 'allergic rhinitis, cause unspecified'"
bb8a1fa7460a1e93f7fe94cd,What about the single rooms which are now out there?,,,SELECT * FROM Rooms WHERE Type = 'Single' AND Status = 'Available'
eed48c889b928f3ee845e151,How much is the total minimum cost for a hospital that includes a white blood cells lab test throughout this year?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT SUM(MIN_COST) AS Total_Minimum_Cost FROM LABTEST WHERE LABTEST_NAME = 'white blood cells' AND YEAR(TEST_DATE) = YEAR(CURDATE()) AND HOSPITAL_ID IN (SELECT HOSPITAL_ID FROM HOSPITAL) AND LABTEST_ID IN (SELECT LABTEST_ID FROM LABTEST)
9997157eb5c508f263b4a2b0,Tell me the length of stay of patient 10026354's first ICU stay in days.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.3870138889178634}]",
53645af951b7d3f45781e59f,"In relation to others of the same age, where does a urea nitrogen value of 11.0 for patient 10023117 rank in percentiles on their last hospital encounter?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 11.0",,SELECT PERCENT_RANK() OVER (PARTITION BY age ORDER BY urea_nitrogen_value) FROM patient_lab_results WHERE patient_id = '10023117' AND urea_nitrogen_value = 11.0
d57dc0bf4122ea92cbe3fbbf,When was the last time patient 10007818 was prescribed medication via the replace route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'replace' ORDER BY prescriptions.starttime DESC LIMIT 1,[],[SELECT MAX(eventDate) FROM (
aa866c43eb90dfddc649fe35,"How many instances of the dilation of left common iliac vein with intraluminal device, percutaneous approach procedure were there during the previous year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"SELECT COUNT(*) AS procedure_count FROM procedures WHERE procedure_name = 'Dilation of Left Common Iliac Vein with Intraluminal Device' AND approach = 'Percutaneous' AND procedure_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) AND CURRENT_DATE;"
2ad19063a657310f5f20de33,What was the first time patient 10014354 input time since 03/19/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-19' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2146-10-09 01:41:00'}],SELECT MIN(input_time) FROM patient_inputs WHERE patient_id = '10014354' AND input_time > '03/19/2100'
1c2352529be1c26de9ae73e4,What is patient 10031757's rdw change last measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",select rdw_change from lab_results where patient_id = 10031757 and visit_number = (select max(visit_number) from lab_results where patient_id = 10031757) order by lab_draw_time desc limit 1;
d3d61d08b329e1aaf3de1a85,What is the price of a drug named fentanyl citrate?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl citrate' ),,"select price from drug where name = ""fentanyl citrate"""
402ffae6336ceeb14052f50e,Was patient 10018328 diagnosed with anything in the first hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT * FROM hospital_visits WHERE patient_id = '10018328' AND visit_number = 1 AND diagnosis IS NOT NULL
aa8a3e6c3b2e1ac22610e5df,Retrieve the top three most frequent lab tests since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT labtest_name, COUNT(*) AS frequency FROM lab_tests WHERE test_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY labtest_name ORDER BY frequency DESC LIMIT 3"
b8e9b90e80a785175600b2ff,What was the last dose of tobramycin sulfate that patient 10007818 was prescribed during the first hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'tobramycin sulfate' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"SELECT TOP 1 prescription.medication, prescription.dosage, prescription.date_prescribed FROM prescriptions AS prescription INNER JOIN admissions AS admission ON prescription.patient_id = admission.patient_id WHERE admission.patient_id = '10007818' AND admission.admission_number = 1 AND prescription.medication = 'tobramycin sulfate' ORDER BY prescription.date_prescribed DESC"
21f3520f8db52d400b139521,How many hours have passed since the last time patient 10004733 has received a anticardiolipin antibody igg-lab test on the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anticardiolipin antibody igg' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"select datediff(hour, max(antibody_test.result_date_time), getdate()) from patient_encounter left join patient on patient_encounter.patient_id = patient.id left join lab_order on patient_encounter.id = lab_order.encounter_id left join lab_test on lab_order.test_id = lab_test.id left join lab_test_result as antibody_test on lab_test_result.test_id = lab_test.id and lab_test_result.lab_order_id = lab_order.id left join lab_result_type on lab_test_result.result_type_id = lab_result_type.id where patient.id = 10004733 and patient_encounter.id = (select top 1 patient_encounter.id from patient_encounter where patient_encounter.patient_id = 10004733 order by patient_encounter.encounter_date_time desc) and lab_result_type.name = 'anticardiolipin antibody igg-lab'"
4d2e6a2bf7e989ac0488030c,Tell me the average total hospital cost that includes dissection of abdominal aorta.,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of abdominal aorta' ) ) GROUP BY cost.hadm_id ) AS T1,,select avg(total_hospital_cost) from inpatient where hcpcs_code like '%4A%'
894403f12b36b4f785b9894d,What were the total number of patients discharged from the hospital in the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT SUM(patient_count) as total_discharged FROM hospital_discharges WHERE discharge_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) AND CURRENT_DATE"
c642922a8ac294d31682581d,Count the number of hospital visits for patient 10011398.,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10011398,[{'COUNT( DISTINCT admissions.hadm_id )': 1}],SELECT COUNT(*) AS TotalVisits FROM hospital_visits WHERE patient_id = 10011398;
b6556ac9fb3dd561d02e99a5,Which are the top five most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT event, COUNT(*) AS frequency FROM events_table WHERE output = TRUE AND event_date >= CURRENT_DATE - INTERVAL '1 year' GROUP BY event ORDER BY frequency DESC LIMIT 5"
eefb36fdfc2d06211f4348ec,Has patient 10038999 been given any magnesium sulfate (bolus) medication in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'",[{'COUNT(*)>0': 0}],SELECT * FROM chart_events WHERE patientnum='10038999' AND charttime::date BETWEEN '2022-12-01' AND '2022-12-31' AND itemid IN (SELECT itemid FROM d_items WHERE generic= 'MAGNESIUM SULFATE' AND form='BOLUS')
f0792acd794b3cf007d78f92,Could you tell me the maximum total cost for the hospital visits where potassium chl 20 meq / 1000 ml ns is used during this year?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml ns' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_charge) AS MaxTotalCost FROM hospital_visits WHERE medication = 'potassium chl 20 meq / 1000 ml ns' AND visit_date BETWEEN '2023-01-01' AND '2023-12-31'
6bac631eb4407c64590d6679,What was the name of the first medication that was prescribed to patient 10004720 since 02/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': 'Heparin'}],SELECT TOP 1 medication_name FROM Prescriptions WHERE patient_id = 10004720 AND prescription_date >= '02/01/2000' ORDER BY prescription_date ASC
909212b3de8ea34ca2c96475,Is the value of arterial blood pressure diastolic of patient 10004235 second measured on the last ICU visit greater than the value first measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",[SELECT CASE WHEN MAX(diastolic_pressure) > MIN(diastolic_pressure) THEN 'Yes' ELSE 'No' END AS is_greater FROM (
a5245904049b7aae3a154666,"Was hydrochlorothiazide, vial, or atenolol ordered in their last hospital encounter for patient 10016810?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'hydrochlorothiazide', 'vial', 'atenolol' )",[{'COUNT(*)>0': 0}],"SELECT * FROM patient_drug_orders WHERE patient_id = 10016810 AND drug_name IN ('hydrochlorothiazide', 'atenolol') AND drug_form = 'vial' AND encounter_id = (SELECT MAX(encounter_id) FROM patient_encounters WHERE patient_id = 10016810)"
9b56d431c0b4eac3cf5171d7,What percentile is mchc 32.2 among patients of the same age as patient 10027602 during their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 32.2",,[SELECT PERCENT_RANK() OVER (ORDER BY mchc) AS Percentile_Rank
304190e81318d73ef0c5f885,What is today's outpatient schedule for dr. knight?,,,select * from outpatient_schedule where doctor_name = 'dr. knight' and date = curdate();
decc4b6118addbb54d49b4ee,Can you show me the top four frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]","SELECT TOP 4 output_event, COUNT(*) AS Frequency FROM Events WHERE event_time >= DATEADD(year, -1, GETDATE()) GROUP BY output_event ORDER BY Frequency DESC"
2733bc74cdbe99ae5365284d,When was the last time patient 10018081 was measured with a heart rate greater than 62.0 on their current ICU encounter?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 62.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],""""""""
de0f8a295e6a5cf79b31633d,Could you show me the top five most common microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]","SELECT test_name, COUNT(*) AS frequency FROM microbiology_tests WHERE test_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) GROUP BY test_name ORDER BY frequency DESC LIMIT 5"
e55eee58f7de7acb4afa8764,How many times was patient 10022880 in the hospital throughout this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10022880 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],"SELECT SUM(CASE WHEN ADMISSION_DATE >= '2023-01-01' AND ADMISSION_DATE < '2024-01-01' THEN 1 ELSE 0 END) AS ""Number of Admissions"" FROM PATIENT_VISITS WHERE PATIENT_ID = 10022880"
5fb21a95a15d64c85db2fed8,Count the number of drugs prescribed since 08/2100 for patient 10038081.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'",[{'COUNT(*)': 99}],SELECT COUNT(DISTINCT drug) FROM prescriptions WHERE patient_id = '10038081' AND order_date >= '08/2100';
9d4a3fe390f0fef8dc0d86b3,"What are the four frequently prescribed medications for patients diagnosed with bipolar disorder, unspecified previously in the same hospital encounter?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bipolar disorder, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"[SELECT MEDICATION.NAME, COUNT(MEDICATION.NAME) AS PRESCRIPTION_COUNT"
51c4e6f08f5029501e961a4a,When did patient 10009628 receive an input for the first time on 10/02/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '10-02' ORDER BY inputevents.starttime ASC LIMIT 1",[],[select min(date) from (select date from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (select * from (inputevents_mv where person_id=10009628 and date between '2017-02-10' and '2017
7cee0315da660d7678b612e3,When on the last hospital stay did patient 10038992 receive the basophils test for the last time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'basophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT MAX(test_date) AS last_basophils_test_date FROM lab_results WHERE patient_id = 10038992 AND test_name = 'basophils' AND test_date IN (SELECT MAX(admission_date) FROM hospital_stays WHERE patient_id = 10038992);
4d9bd3d3dbfcb23cf47cb0c6,"In 2100, what are the top five most common specimens tested for patients previously diagnosed with personal history of self-harm within the same month?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of self-harm' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 specimen_type, COUNT(*) AS count FROM lab_tests WHERE patient_diagnosis = 'Personal History of Self-Harm' AND YEAR(test_date) = 2100 AND MONTH(test_date) = MONTH(patient_diagnosis_date) GROUP BY specimen_type ORDER BY count DESC"
eba0b6f7c2c449d19740a2ca,What was the name of the drug that was prescribed to patient 10004235 during the same hospital visit after having had a hemodialysis procedure since 11 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-11 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-11 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT prescription.drug_name FROM prescription INNER JOIN patient ON prescription.patient_id = patient.id WHERE patient.id = 10004235 AND prescription.visit_date IN (SELECT visit_date FROM hospital_visit WHERE patient_id = 10004235 AND visit_date > (SELECT DATE_SUB(MAX(visit_date), INTERVAL 11 MONTH) FROM hospital_visit WHERE procedure = 'hemodialysis' AND patient_id = 10004235))"
97618f1a942f1a7582d5b1a9,What are the new medications prescribed to patient 10039831 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL Query Here
4aec6b15c63a023c98af9fbd,When did patient 10018423 have the minimum mean blood pressure the last time on their first ICU visit?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],SELECT date_of_visit FROM patient_icu_visits WHERE patient_id = '10018423' AND visit_number = 1 ORDER BY mean_blood_pressure ASC LIMIT 1
2021b8d65fd7fd080d685ca4,Was patient 10029484 tested in the 25-oh vitamin d lab in the last month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '25-oh vitamin d' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",[{'COUNT(*)>0': 0}],SELECT EXISTS (SELECT * FROM patient_tests WHERE patient_id = 10029484 AND lab_name = '25-oh vitamin d' AND test_date > CURRENT_DATE - INTERVAL '1 month')
a9fa2caa73b48c01d20c7f01,What was the name of the medication that patient 10012552 was prescribed in the same hospital encounter after receiving a single internal mammary-coronary artery bypass procedure in 04/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '04' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT TOP 1 p2.medication FROM patient p1 LEFT JOIN procedure pr1 ON p1.patient_id = pr1.patient_id LEFT JOIN encounter e1 ON e1.encounter_id = pr1.encounter_id LEFT JOIN procedure pr2 ON pr2.encounter_id = e1.encounter_id AND pr2.procedure_date > pr1.procedure_date LEFT JOIN prescription p2 ON p2.encounter_id = pr2.encounter_id WHERE p1.patient_id = '10012552' AND pr1.procedure_name = 'Single internal mammary-coronary artery bypass' AND pr1.procedure_date LIKE '2023-04%' ORDER BY pr2.procedure_date ASC, p2.medication_date DESC"
7e79e5876cb4505b0d14e7f2,Could you tell me the average total cost in a hospital where methylprednisolone sodium succ is used in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylprednisolone sodium succ' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_cost) as AverageTotalCost FROM hospital_stay WHERE medication LIKE '%methylprednisolone sodium succ%' AND year=2100;
dba558e5efd6207a1ad84c29,"Is patient 10031757's chloride, whole blood last measured on the first hospital visit greater than the first value measured on the first hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",select case when (select c.whole_blood from labevents c where c.subject_id=10031757 and c.visit_id=1 and c.itemid=50862 and c.charttime=(select min(c2.charttime) from labevents c2 where c2.subject_id=10031757 and c2.visit_id=1 and c2.itemid=50862))>(select c.whole_blood from labevents c where c.subject_id=10031757 and c.visit_id=1 and c.itemid=50862 order by c.charttime asc limit 1) then 'yes' else 'no' end as answer;
42ba16664bb27443701345aa,"Among patients who underwent ileostomy, not otherwise specified since 2100, what were the top four most common procedures that followed within the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,SQL Query Here
bb21fc57075b8a90bdec2466,What is the standard of reimbursement for chromosome and genetic tests?,,,"SELECT reimbursement_standard FROM tests WHERE category IN ('chromosome', 'genetic')"
bbcd893acd5b02637bedbb4d,"Throughout this month, when did patient 10021118 last receive a absolute basophil count test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute basophil count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT MAX(test_date) as last_test_date FROM test_results WHERE patient_id = '10021118' AND test_name = 'absolute basophil count' AND test_date BETWEEN '2023-01-01' AND '2023-01-31';
74f00dc121afbe12df42ad01,Provide the total input volume for patient 10023239 since 184 days ago.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) ) AND datetime(inputevents.starttime) >= datetime(current_time,'-184 day')",[{'SUM(inputevents.totalamount)': 34120.0}],SELECT SUM(input_volume) FROM patient_data WHERE patient_id = 10023239 AND date >= CURDATE() - INTERVAL 184 DAY
1794f31aaf8abd01fe9c8e47,Can you tell me the five most frequent microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]",SQL Query
f099406d471ff52b20ae8441,Has patient 10020944 had any diagnoses?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ),[{'COUNT(*)>0': 1}],[SELECT COUNT(*) AS DiagnosisCount
82922424bd771f502216cfe8,When was the first time patient 10020187 was measured mean blood pressure less than 91.0 on 02/03/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 91.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-03' ORDER BY chartevents.charttime ASC LIMIT 1",[],select measurement_date from patient_observations where patient_id='10020187' and measurement_type='Mean Blood Pressure' and measurement_value<91.0 and measurement_date like '02/03/%' order by measurement_date limit 1
fde6441b3751a0976d557a92,What are the five most common treatments for patients who are 30s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,your sql
3f0035e87fa9e0e54608b6e8,What were the name of the treatment received by patient 10029291 two or more times during the last hospital visit?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,SELECT DISTINCT t.Treatment_Name FROM treatments t JOIN patient_visits pv ON t.Visit_ID = pv.Visit_ID JOIN patient_records pr ON pv.Patient_ID = pr.Patient_ID WHERE pr.Patient_ID = '10029291' AND pv.Visit_ID = (SELECT MAX(Visit_ID) FROM patient_visits WHERE Patient_ID = '10029291') AND t.Count >= 2
2e2da95ca5d2a04c74e036f7,When was the first time the systolic blood pressure of patient 10018081 was measured on this ICU encounter at less than 100.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 100.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT MIN(measurement_date) FROM measurements WHERE patient_id = 10018081 AND systolic_bp < 100.0 AND measurement_date BETWEEN encounter_start AND encounter_end
06b6972a43b2dba9856ec0bd,"In 2100, what are the top four most frequently tested specimens for patients during the same month after receiving introduction of other therapeutic substance into heart, open approach?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into heart, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,select specimen from lab_events where year = 2100 and month = <same_month> and code = 'B3548Z' group by specimen order by count(specimen) desc limit 4
1e60f35bb520bb22a0d6dcf1,When was patient 10018423 prescribed for the first time in 05/2100 a medication via sc route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(prescription_date) FROM prescriptions WHERE patient_id = '10018423' AND month(prescription_date) = 5 AND year(prescription_date) = 2100 AND route = 'sc' AND medication_id IN (SELECT id FROM medications WHERE route = 'sc')
a693683961d00b054d159be0,What was patient 10019385's total input amount of nacl 0.9% on 03/12/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-12'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(amount) FROM fluid_records WHERE patient_id = 10019385 AND date = '03/12/2100' AND fluid_name = 'nacl 0.9%';
e054b776ce8b992288d3a151,What is the outpatient schedule of dr. swain today?,,,"SELECT appointment_time, patient_name FROM outpatient_schedule WHERE doctor_name = 'dr. swain' AND appointment_date = CURRENT_DATE()"
fb95177b2a968ec680128db1,How many days is it since patient 10004733 first stayed in the careunit medicine during the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT DATEDIFF(CURRENT_DATE, MIN(admit_time)) AS days_since_first_stay FROM careunit_stay WHERE person_id = 10004733 AND careunit_id = (SELECT id FROM careunit WHERE name = 'Medicine') AND hospital_visit_id = (SELECT id FROM hospital_visit WHERE person_id = 10004733 ORDER BY admit_time DESC LIMIT 1) GROUP BY person_id"
f531d0fed3a37f3e379fb328,Did patient 10022041 visit an emergency room in their first hospital visit?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'COUNT(*)>0': 0}],select distinct patient_id from hospital_visits where visit_number = 1 and department = 'emergency' and patient_id = '10022041';
b631a1615445ca9ec8e26a42,What procedure was given to patient 10019777 two times since 21 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-21 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,SELECT procedure_name FROM procedures WHERE patient_id = 10019777 AND date >= NOW() - INTERVAL '21 months' GROUP BY procedure_name HAVING COUNT(procedure_name) = 2
4d21ff0e9b82a46ea21db1c1,Has patient 10005817 had platelet count tests in this month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM test_results WHERE patient_id = '10005817' AND test_name = 'Platelet Count' AND test_date BETWEEN DATE_FORMAT(NOW() ,'%Y-%m-01') AND LAST_DAY(NOW())"
1e7fca2277094f23cec3aa76,What was the total number of patients staying in medical intensive care unit (micu) in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medical intensive care unit (micu)' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT SUM(patient_count) AS Total_Patients FROM patient_stays WHERE year = 2100 AND unit = 'MICU'
c0a87bdad4a3ac34d3210642,"For patient 10022041, what was the first vitamin b12 reading?",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) ORDER BY labevents.charttime ASC LIMIT 1,[],SQL Query
c9d4464b66be176cf11f8d68,"How much will it cost me to get introduction of nutritional substance into central vein, percutaneous approach done?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into central vein, percutaneous approach' ) )",,select sum(total_charge) from claims where hcpcs_code='36871'
f8e70aaaef039854b3b29401,What drugs have been added to patient 10018081's prescription today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL query here
0d93e83a24f730a575941764,"Was there any lisinopril, 0.45% sodium chloride, or levothyroxine sodium ordered for patient 10002428 during their first hospital encounter?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'lisinopril', '0.45% sodium chloride', 'levothyroxine sodium' )",[{'COUNT(*)>0': 0}],SELECT * FROM medication_orders WHERE patient_id = 10002428 AND (drug_name = 'lisinopril' OR drug_name = '0.45% sodium chloride' OR drug_name = 'levothyroxine sodium') AND encounter_id = (SELECT MIN(encounter_id) FROM encounters WHERE patient_id = 10002428)
8bce38cc6e677156d2b90712,When did patient 10038999 receive the first sputum microbiology test in their first hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum' ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],SQLQuery
644f9d16a15d38b492e0d147,"Has since 2100 levothyroxine sodium, acetaminophen, or polyethylene glycol been prescribed to patient 10005909?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND prescriptions.drug IN ( 'levothyroxine sodium', 'acetaminophen', 'polyethylene glycol' ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 0}],"SELECT DISTINCT ON (medication_name) medication_name FROM prescriptions WHERE patient_id = '10005909' AND medication_name IN ('levothyroxine sodium', 'acetaminophen', 'polyethylene glycol') AND date_prescribed > '2100-01-01' ORDER BY medication_name, date_prescribed ASC"
8fe130affd01259653e65799,Can you show me the four most frequently taken lab test?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",SQLQuery
f8da84426c2c001652c1ea5f,When did patient 10021487 last have a maximum value of diastolic blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],SELECT MAX(Date) AS LastMaxDiastolicBPDate FROM PatientVitals WHERE PatientID = '10021487' AND DiastolicBP = (SELECT MAX(DiastolicBP) FROM PatientVitals WHERE PatientID = '10021487')
25c653da4cccc0b0dec24e49,What are the new drugs for patient 10018081 today compared to the earlier ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"SELECT DISTINCT current_drug FROM drug_events ce JOIN (SELECT DISTINCT drug AS prev_drug FROM drug_events WHERE person_id = 10018081 AND drug_exposure_start_date = DATE(CURRENT_DATE) - INTERVAL 1 DAY) de ON ce.person_id = de.person_id AND ce.drug_exposure_start_date = CURRENT_DATE AND ce.drug != de.prev_drug WHERE ce.person_id = 10018081 ORDER BY ce.drug_exposure_start_date, ce.drug_exposure_start_time;"
3756db86af40c5904040408f,What was patient 10021666's minimum SaO2 reading?,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ),[{'MIN(chartevents.valuenum)': None}],SELECT MIN(SaO2) FROM PatientData WHERE PatientID = 10021666;
6ec5c2c1bd1fc8781c4fea87,"How many instances of dilation of left external iliac vein with intraluminal device, percutaneous approach procedures have been completed since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,select count(*) from (select distinct patient_id from procedure_event where (cui='C0020701') and (cui='C0007207') and (cui='C0007195') and (cui='C1514512') and (cui='C1514513') and (cui='C1514514') and (cui='C1514515'))
d4d740fa5b9015e952111b32,When patient 10027445 was prescribed for the first time in 09/this year docusate sodium and furosemide at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'docusate sodium' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'furosemide' AND admissions.subject_id = 10027445 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"SELECT MIN(prescription_date) AS first_prescription_date FROM prescriptions WHERE patient_id = 10027445 AND medication IN ('docusate sodium', 'furosemide') AND YEAR(prescription_date) = YEAR(CURDATE()) AND MONTH(prescription_date) = 9"
501d7e20f28d6572b7ea2104,When did patient 10021118 have the last minimum creatine kinase (ck) value on their first hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase (ck)' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],SELECT MAX(date) FROM lab_results WHERE patient_id = 10021118 AND lab_test = 'Creatine Kinase (CK)' AND encounter_number = 1 AND value = (SELECT MIN(value) FROM lab_results WHERE patient_id = 10021118 AND lab_test = 'Creatine Kinase (CK)' AND encounter_number = 1)
bb8bc2404e614f44d69a488c,Can you tell me the top four most common lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT LabTest, COUNT(LabTest) AS TestCount FROM lab_test_results WHERE Date >= '2100-01-01' GROUP BY LabTest ORDER BY TestCount DESC LIMIT 4"
00f2bfbc43dcc4875ed114f9,What is the maximum total cost at a hospital including a albumin laboratory test in 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT hospital.name, MAX(total_cost) FROM patient_records INNER JOIN hospital ON patient_records.hospital_id = hospital.id WHERE total_cost IS NOT NULL AND record_date = '2100-12-31' AND albumin_test = 1 GROUP BY hospital.name"
196b4c9d5405c65e47b0c14d,What was the organism found in the last microbiology test done on the patient 10007795's foreign body in 05/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'foreign body' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT organism FROM microbiology_tests WHERE patient_id=10007795 AND test_date=(SELECT MAX(test_date) FROM microbiology_tests WHERE patient_id=10007795 AND test_type='foreign body') AND test_type='foreign body'
42e82e626162ecd5abe81360,Can you tell me when patient 10016742 had their first rapid respiratory viral screen & culture microbiology test in 08/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(collection_date) AS first_test_date FROM lab_results WHERE patient_id = '10016742' AND test_name = 'Rapid Respiratory Viral Screen & Culture Microbiology' AND collection_date >= '2023-08-01' AND collection_date < '2023-09-01';
cf8596ed1cee62a5ad2886d8,What is the price for felodipine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'felodipine' ),,SELECT price FROM drug_prices WHERE drug_name = 'felodipine'
c1dfd71e56e3403bac064d97,Can you tell me the top three most common lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",SQL Query here
a5681c4eead8c8b2e1968ab1,How much furosemide has been prescribed to patient 10027445 in 08/this year in total?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.drug = 'furosemide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(quantity) FROM prescriptions WHERE patient_id = 10027445 AND drug_name = 'furosemide' AND date_prescribed BETWEEN '2023-08-01' AND '2023-08-31'
e3732452c0c7cbd80082d35c,Could you tell me the gender of patient 10023239?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10023239,[{'gender': 'F'}],gender
b48e7a50e9e73818c7619a51,How much is the average total hospital cost with personal history of malignant neoplasm of tongue in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of tongue' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,select avg(total_hospital_cost) from seer_data where p_hist_malignant_neoplasm_of_tongue=1 and year_of_diagnosis=2100
9d564188b506bcd7d94a1018,Tell me the top four most frequent procedures that patients received in the same hospital visit after being diagnosed with accidents occurring in other specified places since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidents occurring in other specified places' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,Procedure Name
ff7c3e66b7fe93c4c036fe1e,What is patient 10017492's difference in rbc from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT MAX(rbc) - MIN(rbc) AS rbc_difference FROM lab_results WHERE patient_id = 10017492 AND visit_id = (SELECT MIN(visit_id) FROM lab_results WHERE patient_id = 10017492 GROUP BY visit_id ORDER BY visit_date ASC) GROUP BY visit_id
f2b643094d07ac4dcac036f6,"What is the total count of drainage of pericardial cavity with drainage device, percutaneous approach procedures that were done?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' )",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM `drainage_of_pericardial_cavity_with_drainage_device` WHERE `approach` = 'percutaneous';
26ea9369abea20ebb7ca20ae,What was the last value of the o2 saturation pulseoxymetry for patient 10038999 since 06/03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-03' ORDER BY chartevents.charttime DESC LIMIT 1",[],select * from `physionet-data.mimiciii_clinical.icustays` where subject_id = 10038999 and o2sat = 'pulseoximetry' and charttime > '06/03/2100' and charttime = (select max(charttime) from `physionet-data.mimiciii_clinical.icustays` where subject_id = 10038999 and o2sat = 'pulseoximetry' and charttime > '06/03/2100')
4f3f80819d74ba44d60716b2,Retrieve the top three most frequent medications that patients were prescribed in the same month after being diagnosed with cerebral edema.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral edema' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"select m.medicine_name, count(m.medicine_id) as medication_frequency from patient_records pr join medication_logs m on pr.patient_id = m.patient_id where m.medication_date between pr.diagnosis_date and pr.diagnosis_date + interval '1 month' and pr.condition = 'Cerebral Edema' group by m.medicine_name order by medication_frequency desc limit 3"
c1a9f03dd5bb3142dac26180,List the top three most occurring events.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT event, COUNT(*) AS frequency FROM events_table GROUP BY event ORDER BY frequency DESC LIMIT 3"
b53daa3c6e0af875928b6bd7,"How many days have passed since the last time patient 10021487 received a lab test of calcium, urine during the current hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],SQL Query
7c81288ded12d53cddc28dea,"In 2100, which are the three most frequent lab tests given to patients in the same month after they are diagnosed with atherosclerotic heart disease of native coronary artery without angina pectoris?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery without angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT lab_test, COUNT(*) AS test_count FROM lab_results WHERE patient_diagnosis = 'atherosclerotic heart disease of native coronary artery without angina pectoris' AND EXTRACT(YEAR FROM test_date) = 2100 AND EXTRACT(MONTH FROM test_date) = EXTRACT(MONTH FROM diagnosis_date) GROUP BY lab_test ORDER BY test_count DESC LIMIT 3"
3f7e59eb07f66f58689fdf28,Calculate how many drugs patient 10009049 was prescribed.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ),[{'COUNT(*)': 41}],SELECT COUNT(DISTINCT drug_name) AS NumberOfDrugs FROM prescriptions WHERE patient_id = '10009049';
fdc15c3b4760871eec9eb7f4,"Show the number of patients who underwent respiratory ventilation, greater than 96 consecutive hours.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, greater than 96 consecutive hours' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patient_data WHERE ventilation_hours > 96 AND ventilation_type = 'Respiratory';
1adba3ceaf529ef2a8dda81a,Was the phosphate reading for patient 10020187 measured at 2100-02-10 05:25:00 less than the value measured at 2100-02-09 05:00:00?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.charttime = '2100-02-10 05:25:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.charttime = '2100-02-09 05:00:00' ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.charttime = '2100-02-10 05:25:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.charttime = '2100-02-09 05:00:00' )"": None}]",select * from phosphate_readings where patient_id = 10020187 and ((reading_time = '2100-02-10 05:25:00' and reading_value < (select reading_value from phosphate_readings where patient_id = 10020187 and reading_time = '2100-02-09 05:00:00')) or (reading_time = '2100-02-09 05:00:00' and reading_value > (select reading_value from phosphate_readings where patient_id = 10020187 and reading_time = '2100-02-10 05:25:00')))
1d509edaa223f304f5ee3b9f,What drug was first prescribed to patient 10007058 since 09/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1",[{'drug': '5% Dextrose'}],SELECT DrugName FROM PatientMedicationHistory WHERE PatientID = '10007058' AND PrescribedDate >= '09/21/2000' ORDER BY PrescribedDate ASC LIMIT 1
0ad0dc8594dbfe64d10295e8,"For patients who received other electroshock therapy since 2100, what are the top four most frequent diagnoses that followed afterwards within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 diagnosis, COUNT(diagnosis) AS frequency FROM PatientRecords WHERE procedure = 'electroshock' AND procedure_date >= '2100-01-01' AND diagnosis_date BETWEEN procedure_date AND DATEADD(month, 2, procedure_date) GROUP BY diagnosis ORDER BY frequency DESC"
5a36e2b8accac68f5996e75c,"What is the minimum total hospital cost that includes a procedure named excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic' ) ) GROUP BY cost.hadm_id ) AS T1",,"SELECT MIN(total_hospital_cost) FROM HospitalCosts WHERE procedure_description = 'excision of right main bronchus, via natural or artificial opening endoscopic, diagnostic'"
4a9da1e78cc48ca85038714a,What is the value of patient 10039831's yearly average or packed rbc intake input since 12/08/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or packed rbc intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-08' GROUP BY strftime('%Y',inputevents.starttime)",[],SELECT AVG(input_value) AS yearly_average_packed_rbc FROM medical_records WHERE patient_id = 10039831 AND input_type = 'packed rbc intake' AND input_date >= '12/08/2100';
c41797e8b4af4e6ab554fdc5,What is the name of the treatment given to patient 10007795 two or more times since 28 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-28 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"SELECT TreatmentName, COUNT(*) AS TimesGiven FROM Treatments WHERE PatientID = 10007795 AND TreatmentDate > DATEADD(MONTH, -28, GETDATE()) GROUP BY TreatmentName HAVING COUNT(*) >= 2"
040ab0b8bd0cecfc6dbb03df,When patient 10009628 was prescribed for the last time in 10/this year glucagon and warfarin at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10009628 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'warfarin' AND admissions.subject_id = 10009628 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],[SELECT MAX(prescription_date) as last_prescription_date
7c1e5985e0e94a843e2c335a,What specimen test was given since 08/2100 to patient 10007795 for the last time?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'BLOOD CULTURE'}],"select distinct ""Specimen Test"" from (select ""Specimen Test"",""Specimen Test Date"" from ""Patient Specimen Tests"" where ""Patient ID""=10007795 order by ""Specimen Test Date"" desc) where ""Specimen Test Date""<'2012-08-20' order by ""Specimen Test Date"" desc limit 1"
b7829190559539b14c91b592,Has patient 10037928 had a mch test done since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'",[{'COUNT(*)>0': 0}],SELECT * FROM mch_tests WHERE patient_id = 10037928 AND test_date >= '2100-04-01'
3c1f961554b4f7004f28ef81,What was the maximum value of heart rate for patient 10003046 in the last ICU visit?,SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ),[{'MAX(chartevents.valuenum)': None}],select max(heart_rate) from `mimic-iii.icustays` where subject_id=10003046 and stay_id = (select max(stay_id) from `mimic-iii.icustays` where subject_id = 10003046)
b457b0375ed13ba271e11902,When was the first time of input for patient 10038999 on 06/05/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '06-05' ORDER BY inputevents.starttime ASC LIMIT 1",[],SELECT MIN(input_time) FROM patient_records WHERE patient_id = 10038999 AND input_date = '2023-06-05';
79356e6c9fbb5a33aa5bf030,Give me patient 10010471's total output on this month/16.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '16'",[{'SUM(outputevents.value)': None}],select sum(quantity) from lab_results where patient_id=10010471 and date between '2022-05-01' and '2022-05-16'
4f618d2298a9d6c65fb3663a,Give me the length of stay in days for patient 10013049 during their first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.1769212959334254}]","[SELECT DATEDIFF(day, AdmitDate, DischargeDate) AS LengthOfStay"
d6325d5bf0c0e255155bb97d,Count the total number of hospital visits made by patient 10025463 since 1 year ago.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10025463 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 2}],"SELECT COUNT(*) AS total_visits FROM hospital_visits WHERE patient_id = '10025463' AND visit_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
9fba75551c882938367916bc,Can you tell me how old patient 10029291 was on their last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,SELECT age FROM encounters WHERE patient_id = 10029291 ORDER BY encounter_date DESC LIMIT 1
33c5bee6d20b4effb2ff92c1,How much is the drug morphine sr (ms contin)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'morphine sr (ms contin)' ),,SELECT price FROM drugs WHERE name = 'morphine sr (ms contin)';
beb64497e8a5dd3747e96f78,What is the percentile of 38.1 in the laboratory test with hematocrit at the same age of patient 10019568 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10019568 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 38.1",,SQL query to retrieve the percentile of 38.1 for hematocrit in the specified context
146e130f4ab60443b1facefb,"For patient 10016150, what were the first lymphocytes lab results?",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ORDER BY labevents.charttime ASC LIMIT 1,[],SELECT * FROM lab_results WHERE patient_id = 10016150 AND test_type = 'lymphocytes' ORDER BY result_date ASC LIMIT 1
f4222a52ce7d21c3c9d3c000,What are the precautions that are incurred after undergoing a oth transureth prostatec procedure?,,,SELECT precautions FROM medical_procedures WHERE procedure_name = 'oth transureth prostatec' AND follow_up_type = 'post-procedure'
a1218eb18f008a05c5c527e8,When was the first time that patient 10038933 has been prescribed medication via the tp route on their first hospital encounter?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'tp' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(date_prescribed) FROM prescriptions WHERE patient_id = 10038933 AND route = 'tp' AND encounter_number = 1;
b3017b420fe13c0d01fb5e63,Has patient 10038081 had platelet count tests in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y',labevents.charttime) = '2100'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM lab_tests WHERE patient_id = 10038081 AND test_name = 'platelet count' AND YEAR(date_of_test) = 2100
2aeb48ba6aa5bb661580a085,Can you tell me the first time patient 10027602 had a heart rate that was less than 97.0 on 12/02/this year?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 97.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-02' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(VisitDate) FROM medical_records WHERE patient_id = 10027602 AND heart_rate < 97.0 AND VisitDate BETWEEN '2023-12-01' AND '2023-12-31'
949c6b3479c7ce4f2acd3003,"Since 2100, what are the top three most common microbiology tests that patients were diagnosed with after the diagnosis of esophageal varices in diseases classified elsewhere, with bleeding within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal varices in diseases classified elsewhere, with bleeding' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 TestName, COUNT(*) AS TestFrequency FROM PatientTests INNER JOIN Diagnoses ON PatientTests.DiagnosisID = Diagnoses.DiagnosisID WHERE Diagnoses.DateDiagnosed >= '2100-01-01' AND Diagnoses.Classification = 'Diseases Classified Elsewhere' AND Diagnoses.PrimaryCondition = 'Esophageal Varices' AND PatientTests.DiagnosisDate <= Diagnoses.DateDiagnosed + INTERVAL '2 months' AND PatientTests.TestType = 'Microbiology' GROUP BY TestName ORDER BY TestFrequency DESC;"
3dfc1e7e0bb1375c1771ec03,How often was bisacodyl prescribed in the previous year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'bisacodyl' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)': 0}],"select count(*) as total_prescriptions from prescriptions where drug_name='bisacodyl' and date_prescribed >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
d2d5d1df9320768cf72754db,Has patient 10014078 undergone a central venous catheter placement with guidance procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ),[{'COUNT(*)>0': 0}],"[SELECT DISTINCT o.rn AS recordnum, o.patientnum, o.encounter, o.patient_id, o.encounter_id, o.procedurecode, o.procedureconcept, o.procedurename, o.procedurestatus, o.procedurecodefullname, o.procedurestartdate, o.procedurestarttime, o.procedureenddate, o.procedureendtime, o.proceduremodifier1, o.proceduremodifier2, o.proceduremodifier3, o.proceduremodifier4, o.proceduremodifier5, o.proceduremodifier6, o.proceduremodifier7, o.proceduremodifier8, o.proceduremodifier9, o.proceduremodifier10, o.proceduremodifier1name, o.proceduremodifier2name, o.proceduremodifier3name, o.proceduremodifier4name, o.proceduremodifier5name, o.proceduremodifier6name, o.proceduremodifier7name, o.proceduremodifier8name, o.proceduremodifier9name, o.proceduremodifier10name, o.proceduremodifier1code, o.proceduremodifier2code, o.proceduremodifier3code, o.proceduremodifier4code, o.proceduremodifier5code, o.proceduremodifier6code, o.proceduremodifier7code, o.proceduremodifier"
25766b07f551c549f6e3c32f,Tell me the maximum total cost of a hospital that contains anemia in chronic kidney disease?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia in chronic kidney disease' ) ) GROUP BY cost.hadm_id ) AS T1,,"select max(totalcost) from (select h.hospitalid, h.name, h.address, h.city, h.state, h.zipcode, h.phone, h.condition, h.conditionavgtotalcost, h.conditionavgmedcost, h.numberofadmissions from hospitals h inner join (select distinct hospitalid from conditions where name like '%anemia%' and name like '%chronic kidney disease%') c on h.hospitalid = c.hospitalid) s"
645012622fad2129a6fe1db6,"Since 1 year ago, what was the top three most frequent diagnoses patients were diagnosed with during the same month after receiving extracorporeal circulation auxiliary to open heart surgery?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"[SELECT Diagnosis, COUNT(Diagnosis) AS Frequency"
116aad46ae0fef5a747954b1,"For patients diagnosed with iatrogenic pneumothorax since 1 year ago, what are the top five most recurrent treatments during the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'iatrogenic pneumothorax' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT t.name, COUNT(*) AS frequency FROM Treatments t JOIN HospitalVisits hv ON t.visit_id = hv.id WHERE hv.patient_id IN (SELECT p.id FROM Patients p JOIN Diagnoses d ON p.id = d.patient_id WHERE d.condition = 'iatrogenic pneumothorax' AND d.diagnosis_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()) AND hv.id = t.visit_id GROUP BY t.name ORDER BY frequency DESC LIMIT 5"
908c6c72c2f860ac928fbaf3,Can you tell me the first time in the last ICU stay patient 10009628 had a minimum diastolic blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",[],SELECT MIN(diastolic) AS First_Min_Diastolic_BP FROM `physionet-data.mimiciii_clinical.icustays` INNER JOIN `physionet-data.mimiciii_clinical.labevents` ON icustays.subject_id = labevents.subject_id AND icustays.hadm_id = labevents.hadm_id INNER JOIN `physionet-data.mimiciii_clinical.admissions` ON icustays.hadm_id = admissions.hadm_id WHERE icustays.subject_id = 10009628 AND labevents.ITEMID = 451 AND labevents.charttime <= icustays.intime ORDER BY labevents.charttime ASC LIMIT 1
3c1cd712d2ed352c132bd2ce,Show me the length of time in days patient 10016742 was in the ICU during the first visit.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 4.9095370369032025}]",select sum(days) as total_days_in_icu from icustays where subject_id=10016742 and stay_id=(select min(stay_id) from icustays where subject_id=10016742)
51b0ff1fc9bfcd9831928425,What was the name of the specimen test that patient 10002428 had for the last time in 07/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],[SELECT TOP 1 Name FROM SpecimenTest
887f1892fedc575d080e8217,What's the heart rate difference of patient 10013049's body measured at 2100-06-24 12:00:00 compared to the value measured at 2100-06-24 11:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 12:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 11:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 12:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-24 11:00:00' )"": None}]",select t1.`Value` - t2.`Value` from `dat_record` as t1 join `dat_record` as t2 on t1.`PatientID` = t2.`PatientID` and t1.`RecordDate` = t2.`RecordDate` and t1.`RecordTime` = t2.`RecordTime`+interval 1 hour where t1.`PatientID` = 10013049 and t1.`RecordDate` = '2100-06-24' and t1.`RecordTime` = '12:00:00' and t1.`DataTypeID` = 9 and t2.`DataTypeID` = 9
581c5fbb07539eb5493641eb,"Among patients who underwent introduction of nutritional substance into lower gi, via natural or artificial opening in 2100, what were the top four most common procedures that followed during the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,Your SQL query here
a9a9222a8d37bab9e6d5a6a2,How many instances of the anastomosis of hepatic duct to gastrointestinal tract procedure were there?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ),[{'COUNT(*)': 0}],Select count(*) from procedures where procedure_name = 'Anastomosis of hepatic duct to gastrointestinal tract'
ab35055cb752554bf2ab3c26,When was the last time since 10/2100 that patient 10038992 was prescribed with vitamin d and felodipine at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vitamin d' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'felodipine' AND admissions.subject_id = 10038992 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(STARTDATE) FROM EICU_CRT.CRT WHERE PATID = '10038992' AND (ITEMID IN (SELECT ITEMID FROM D_ITEMS WHERE ITEM_NAME LIKE '%VITAMIN D%' OR ITEM_NAME LIKE '%FELODIPINE%')) AND STARTDATE >= '2100-10-01'
9baa4740ed5e93a3f8178055,Tell me the average total cost of a hospital visit involving esophageal reflux in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal reflux' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_cost) FROM hospital_visits WHERE condition = 'esophageal reflux' AND year = 2100
d80871d283fcf3c937bc3387,Can you tell me how many fluoroscopy of multiple coronary arteries using low osmolar contrast procedures were done since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using low osmolar contrast' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,select count(*) from fluoroscopy where multiple_coronary_arteries = true and osmolarity_contrast = 'low' and date > '2100-01-01'
2706ea1872fb85222790f131,What are the four most frequent diagnoses that patients were diagnosed within 2 months after having received a simple excision of other lymphatic structure procedure since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"[SELECT TOP 4 d.code, d.description, COUNT(*) AS diagnosis_count"
750b75263b3b402e66549596,Which are the four most frequent lab tests given to patients in the same month after they are diagnosed with anticoagulants causing adverse effects in therapeutic use?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anticoagulants causing adverse effects in therapeutic use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,
506c80f153411922f7967305,How much did patient 10008287 weigh during their last measurement since 14 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT weight FROM patient_data WHERE patient_id = 10008287 AND date >= DATE_SUB(CURDATE(), INTERVAL 14 MONTH) ORDER BY date DESC LIMIT 1"
67a35d73e846d6a5995d2dd4,What percentile is the value of the free calcium of 1.06 among patients of the same age as patient 10026255 in the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 1.06",,SELECT PERCENT_RANK() OVER (ORDER BY free_calcium) AS percentile_rank FROM patients WHERE age = (SELECT age FROM patients WHERE patient_id = 10026255) AND hospital_visit = 1 AND free_calcium < 1.06
984b06bd38c5e69abd10d736,Tell me the top three most common specimens tested since 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT specimen_type, COUNT(*) AS num_tests FROM lab_results WHERE test_date >= '2100-01-01' GROUP BY specimen_type ORDER BY num_tests DESC LIMIT 3"
5fa52b07870c541ddad80fd4,What is the dose of the opioid prescribed for patient 19059?,,,SELECT dose FROM opioid_prescriptions WHERE patient_id = 19059
baddc58b8aca169735d88f8d,What were the total number of patients discharged from the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 180733}],select count(*) as total_discharges from patient_records where discharge_status = 'discharged'
6e32e4314cb1b08ef73c4739,What was the last diagnosis for patient 10040025 since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )",,"SELECT diagnosis FROM patient_records WHERE patient_id = '10040025' AND diagnosis_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) ORDER BY diagnosis_date DESC LIMIT 1"
0f36a6421cf0404aebb87507,What were the five most common lab tests given since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(*) as frequency FROM lab_tests WHERE test_date > CURRENT_DATE - INTERVAL '1 year' GROUP BY test_name ORDER BY frequency DESC LIMIT 5"
e8e6ee69e045e5606f6c0aa9,When did patient 10035185 get inputs for the last time since 04/14/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-14' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2120-05-14 15:00:00'}],SELECT MAX(input_date) AS last_input_date FROM patient_inputs WHERE patient_id = 10035185 AND input_date > '2100-04-14'
2cbebf97accbbf3a5041776c,What is the outpatient schedule today for dr. leigh?,,,SELECT * FROM Outpatient_Schedule WHERE doctor_name = 'dr. leigh' AND appointment_date = CURDATE()
21e946effbb48dafa5e842d3,What are the various ways to consume atenolol?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'atenolol',"[{'route': 'PO/NG'}, {'route': 'PO'}, {'route': 'ORAL'}]",SELECT method_of_consumption FROM atenolol_administration_methods
fd67ddabf75b779af8cfe4ac,Please provide the four most common tests performed on specimens this year.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",[],"select test_id, count(test_id) as count from lab_results where test_date between '2023-01-01' and '2023-12-31' group by test_id order by count desc limit 4"
6ecbe5131fa2235952ed05b9,When was the last time patient 10029291 had a respiratory rate that was greater than 23.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 23.0 ORDER BY chartevents.charttime DESC LIMIT 1,[],"SELECT MAX(date) FROM chartevents WHERE itemid IN (211,220051) AND value > 23.0 AND subject_id = 10029291"
4278528d67400edefc633789,How often was the last time patient 20801 had a medication that should be regularly taken?,,,SELECT COUNT(*) AS frequency FROM medication_history WHERE patient_id = 20801 AND medication_taken = 'yes' AND medication_type = 'regular' ORDER BY date_taken DESC LIMIT 1;
d8ce0d4331097090b007f237,"How many patients were diagnosed with migraine with aura, without mention of intractable migraine without mention of status migrainosus during the same hospital visit after they were first diagnosed with street and highway accidents since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'street and highway accidents' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'migraine with aura, without mention of intractable migraine without mention of status migrainosus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,SELECT COUNT(DISTINCT patient_id) AS number_of_patients FROM diagnoses WHERE condition = 'migraine with aura' AND NOT EXISTS (SELECT 1 FROM diagnoses di2 WHERE di2.patient_id = diagnoses.patient_id AND di2.condition = 'intractable migraine without mention of status migrainosus' AND di2.visit_date = diagnoses.visit_date) AND EXISTS (SELECT 1 FROM diagnoses di1 WHERE di1.patient_id = diagnoses.patient_id AND di1.condition = 'street and highway accidents' AND di1.diagnosis_date >= '2100-01-01')
819c7fee312e5058c9f3296f,What was the first drug that patient 10037861 had been prescribed via the neb route in 10/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND prescriptions.route = 'neb' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"SELECT DISTINCT drug_name FROM prescriptions WHERE patient_id = 10037861 AND route = 'NEB' AND date >= DATE_FORMAT(NOW() ,'%Y-10-01') ORDER BY date ASC LIMIT 1"
38b7e8d3f95badf4596cd29a,Whas the earliest patient 9038 goes to the hospital?,,,select min(admission_date) from ADMISSIONS where patient_no='9038'
d6be51fd1c5f29f5d9719bec,How much is the difference of heart rate of patient 10018501 last measured on the last ICU visit compared to the second to last value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT (MAX(hr) - MAX(LAG(hr, 1) OVER (ORDER BY mrn, admid, datetime))) AS heart_rate_difference FROM icustay_detail WHERE mrn = 10018501 AND admid = (SELECT MAX(admid) FROM icustay_detail WHERE mrn = 10018501) AND datetime IN (SELECT datetime FROM (SELECT datetime, ROW_NUMBER() OVER (PARTITION BY mrn, admid ORDER BY datetime DESC) AS rn FROM icustay_detail WHERE mrn = 10018501 AND admid = (SELECT MAX(admid) FROM icustay_detail WHERE mrn = 10018501)) AS subquery WHERE rn <= 2)"
bbe074710272a9a159c13d10,"Since the last time patient 10021487 was diagnosed with injury to liver without mention of open wound into cavity laceration, unspecified in the current hospital encounter, how many days have passed?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to liver without mention of open wound into cavity laceration, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,select extract(day from current_date - max(date))) from admission where mrn=10021487 and icd10 = 'S360XXA';
645da0fe1582ef9cccf3adb7,Is the type of blood of patient 12775?,,,select type from blood where patient_id = 12775
d653fc27e70a4eedd39bd936,What was the total amount of bisacodyl that patient 10001217 has been prescribed in 12/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND prescriptions.drug = 'bisacodyl' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(quantity) as total_quantity FROM prescriptions WHERE patient_id = '10001217' AND medication = 'bisacodyl' AND prescription_date BETWEEN '2023-12-01' AND '2023-12-31';
953f77740c16c1a9a435f427,"Since 2100, what are the top three most frequently taken specimens for patients within 2 months after receiving percutaneous [endoscopic] gastrostomy [peg]?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,SQL Query Here
ecaacdc4fbb0dd2635df78f1,Tell me the total foley output of patient 10018081 on this month/30.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '30'",[{'SUM(outputevents.value)': None}],
e28ceb0ac6e10e4e5f14b4dd,What are the methods for taking ferrous sulfate (liquid)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)',[],SELECT method FROM medication_administration WHERE medication_name = 'ferrous sulfate' AND dosage_form = 'liquid'
84864ac527ad8527348ec48a,What was the name of the organism in the last pleural fluid microbiology test of patient 10014729?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT `organism` FROM `lab_results` WHERE `patient_id` = '10014729' AND `test_type` = 'pleural_fluid_microbiology' ORDER BY `result_date` DESC LIMIT 1
9298a838a1b1fa2910b4a9eb,What are the consumption methods of potassium chl 40 meq / 1000 ml d5ns?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'potassium chl 40 meq / 1000 ml d5ns',[],SELECT consumption_method FROM consumption_methods WHERE product_id = (SELECT id FROM products WHERE name = 'potassium chl 40 meq / 1000 ml d5ns')
bad209f7f1a2e0361719a243,Was there a procedure that patient 10031757 had in the last year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"SELECT p.patient_id, p.patient_name, pr.procedure_name, pr.procedure_date FROM patient AS p INNER JOIN procedure AS pr ON p.patient_id = pr.patient_id WHERE p.patient_id = 10031757 AND pr.procedure_date >= (CURRENT_DATE - INTERVAL '1 year')"
0b9e4acffe9d8f86bd9be2bf,Will patient 97121 get any additional stool (received in transport system) test?,,,"select * from (select p.Patient_ID, p.Patient_Name, t.Test_Name, t.Test_Received_Date, t.Test_Type, t.Test_Result, t.Test_Status from Patients p inner join Tests t on p.Patient_ID = t.Patient_ID where p.Patient_ID = 97121) a left join (select * from (select p.Patient_ID, p.Patient_Name, t.Test_Name, t.Test_Received_Date, t.Test_Type, t.Test_Result, t.Test_Status from Patients p inner join Tests t on p.Patient_ID = t.Patient_ID where p.Patient_ID = 97121) b where b.Test_Type = 'stool') c on a.Patient_ID = c.Patient_ID where a.Test_Type != 'stool' and c.Test_Name is null"
99316caca8e75d93f18ba12c,When for the first time since 09/2100 was patient 10021487 prescribed 5% dextrose and sodium bicarbonate at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium bicarbonate' AND admissions.subject_id = 10021487 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT MIN(admission_date) FROM prescriptions WHERE patient_id = '10021487' AND (medication = '5% dextrose' OR medication = 'sodium bicarbonate') AND admission_date > '2023-09-21' GROUP BY patient_id HAVING COUNT(DISTINCT medication) = 2
1d085776a9f4303e625f4125,How many hours have passed since patient 10039831's first platelet count laboratory test on the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT SUM(TIMESTAMPDIFF(HOUR, t1.LAB_RESULT_DATE, t2.LAB_RESULT_DATE)) as Hours_Since_First_Platelet_Test FROM LAB_RESULTS t1, LAB_RESULTS t2 WHERE t1.PATIENT_ID = 10039831 AND t1.HOSPITAL_VISIT_ID = t2.HOSPITAL_VISIT_ID AND t1.LAB_TEST = 'Platelet Count' AND t2.LAB_TEST = 'Platelet Count' AND t1.LAB_RESULT_DATE < t2.LAB_RESULT_DATE AND t2.LAB_RESULT_DATE = (SELECT MAX(LAB_RESULT_DATE) FROM LAB_RESULTS WHERE PATIENT_ID = 10039831 AND HOSPITAL_VISIT_ID = t2.HOSPITAL_VISIT_ID AND LAB_TEST = 'Platelet Count')"
0cd11d35e8ac3515e3c55d6c,Reveal the drug name that was first prescribed to patient 10014354 via the iv route in 10/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime ASC LIMIT 1",[],select distinct drug from orders where patient_id = 10014354 and route = 'iv' and order_date like '10/%' and year(order_date) = year(current_date) order by order_date asc limit 1
5b0182b6de80a169f35424ab,What is the name of the drug which should not be administered during the insert intercostal cath procedure?,,,select name from drug_info where NOT should_be_administered during_insert_intercostal_cath_procedure=1
bdbd2999610d99f0cde120c1,"When was the first time in 08/this year when patient 10016742 had the minimum value of iron binding capacity, total?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'iron binding capacity, total' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '08' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],SELECT TOP 1 [DATE
e9f3ecc3ec11c4b3396e2825,"Has patient 10004720 received the procedure of a introduction of nutritional substance into upper gi, via natural or artificial opening since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT COUNT(*) AS procedure_count FROM procedures WHERE patient_id = 10004720 AND procedure_code = 'Z53.1' AND procedure_date >= '2100-01-01'
20e39fab12a387f9a7fcce7e,List the top five diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT diagnosis, (SUM(deceased) / SUM(total)) * 100 AS mortality_rate FROM patient_data WHERE time_period = '3-month' GROUP BY diagnosis ORDER BY mortality_rate DESC LIMIT 5;"
d8cceb3ec5f0418b29f0a459,Do you think patient 31615 has an appointment in another department?,,,
3897e55dfcc80af6c9948c75,Has patient 10015860 had a lab test done since 1 year ago?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 1}],"SELECT COUNT(*) FROM LabTests WHERE PatientID = 10015860 AND TestDate >= DATEADD(year, -1, GETDATE())"
bc084c489813e1e8df25c4c3,What was the name of the output the last time patient 10005817 had since 12/03/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-03' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],"select o.outputname from Output o where o.patientid=10005817 and o.date in (select max(o1.date) from Output o1 where o1.patientid=10005817 and o1.date>=str_to_date('12-03-2100','%m-%d-%Y') and o1.status='COMPLETE')"
87a3ea2e67ade278c0c2e7e5,How many times was patient 10014354 in the hospital in the last year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10014354 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],"SELECT COUNT(*) AS hospital_visits FROM hospital_records WHERE patient_id = 10014354 AND admission_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
47e52d08523b3df6810e4e7b,Tell me the top three most common specimens tested.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT specimen, COUNT(*) AS test_count FROM test_results GROUP BY specimen ORDER BY test_count DESC LIMIT 3"
150069fefa392b944fd23073,What were the top five most commonly tested specimens?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]",SQL Query Here
ec4e31f512d6319b08a78d92,What was the total amount of the output patient 10006053 had since 06/06/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-06'",[{'SUM(outputevents.value)': 7045.0}],SELECT SUM(amount) FROM output WHERE patient_id = 10006053 AND date >= '06/06/2100'
ecbcf154c6dfea64fea97371,When was patient 10027445 last prescribed the medication via the sc route during their last hospital visit?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT MAX(visit_start_date) AS last_visit_date FROM admissions WHERE person_id = 10027445
2f5d42ba584507b3ec8786a4,Show me patient 10038081's total tap output since 10/06/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tap' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-06'",[{'SUM(outputevents.value)': None}],SELECT SUM(output) FROM fluid_records WHERE patient_id = 10038081 AND procedure_date >= '2100-10-06' AND procedure_type = 'taps'
857cc6b19c502ce2ba6b66df,When did patient 10020740 have the minimum lipase value for the first time?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lipase' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],SELECT MIN(lipase) AS min_lipase FROM lab_data WHERE patient_id = 10020740;
03597122b60940059ca941bd,Retrieve the top three most common diagnoses?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]","SELECT diagnosis, COUNT(*) AS frequency FROM patient_records GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3"
661a2833119e979de4228585,"Has patient 10029291 been prescribed with the medication perphenazine, furosemide, or neomycin-polymyxin-bacitracin since 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND prescriptions.drug IN ( 'perphenazine', 'furosemide', 'neomycin-polymyxin-bacitracin' ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 0}],SELECT * FROM prescriptions WHERE patient_id = 10029291 AND (medication_name = 'perphenazine' OR medication_name = 'furosemide' OR medication_name = 'neomycin-polymyxin-bacitracin') AND date_prescribed >= '2100-01-01';
44fdec17266371ad7f7871d7,Is patient 85169 to have had a travel history overseas?,,,SELECT has_travel_history FROM patient_records WHERE patient_id = 85169 AND destination = 'overseas'
8d6edf1fda9d534cd9ec0c9f,What was the number of patients who were prescribed prochlorperazine throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prochlorperazine' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) as unique_patient_count FROM prescriptions WHERE medication = 'prochlorperazine' AND YEAR(prescription_date) = YEAR(CURRENT_DATE)
127846a633997fbb95a316a9,"What are the five most commonly prescribed medications for patients who were previously diagnosed with personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits during the same hospital visit, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of transient ischemic attack (tia), and cerebral infarction without residual deficits' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 medication_name FROM prescription_history WHERE patient_diagnosis IN ('transient ischemic attack', 'cerebral infarction without residual deficits') AND visit_date > DATEADD(year, -1, GETDATE()) GROUP BY medication_name ORDER BY COUNT(*) DESC"
5e42606ba946ba548d180e31,List the top four most frequent lab tests since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(*) AS frequency FROM lab_tests WHERE test_date >= '2100-01-01' GROUP BY test_name ORDER BY frequency DESC LIMIT 4"
77a561b95489d211e0dec613,How many times was other electroshock therapy carried out throughout this year?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,SELECT SUM(total) FROM `physician_work_table` WHERE `physician_work_table`.year = 'this_year' AND `physician_work_table`.therapy_type = 'other electroshock therapy';
0e2ed5b1977c59f79cff3b72,"How many patients with long-term (current) use of anticoagulants were diagnosed in the same hospital visit after previously being diagnosed with hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of anticoagulants' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,visits
63d12a773f7455c04714cb1e,What is patient 10005909's sex?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10005909,[{'gender': 'F'}],SELECT sex FROM patient WHERE patient_id = 10005909;
0d22f4703425e474ebd63580,"Compared to measured at 2100-03-10 23:00:00 , is the heart rate value of patient 10019777 greater than measured at 2100-03-10 22:00:00?",SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 22:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-10 22:00:00' )"": None}]",SELECT CASE WHEN hr_23 > hr_22 THEN 'Yes' ELSE 'No' END as Is_Higher FROM (SELECT heart_rate as hr_23 FROM patient_measurements WHERE patient_id = 10019777 AND measurement_datetime = '2100-03-10 23:00:00') a JOIN (SELECT heart_rate as hr_22 FROM patient_measurements WHERE patient_id = 10019777 AND measurement_datetime = '2100-03-10 22:00:00') b ON a.patient_id = b.patient_id
950bba952500eb9d19279afe,Show me the top five most common diagnoses of patients aged 50s this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT TOP 5 DiagnosisCode, COUNT(*) AS DiagnosisCount FROM PatientRecords WHERE YEAR(AdmissionDate) = YEAR(GETDATE()) AND Age BETWEEN 50 AND 59 GROUP BY DiagnosisCode ORDER BY DiagnosisCount DESC"
e253c035e9ea72b0f867ad77,"What new medications are there for patient 10039831 today, compared to the prescriptions given yesterday?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL Query Here
ffa10298ec3846d375cbd553,Let me know the total quantity of input patient 10027602 received since 09/23/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-23'",[{'SUM(inputevents.totalamount)': 81320.0}],SELECT SUM(quantity) FROM inputpatient WHERE patient_id = 10027602 AND entry_date >= '09/23/2100'
7b93007f63a2214c1ddc33f7,Has patient 10019385 been given any medication since 10 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-10 month')",[{'COUNT(*)>0': 1}],SELECT * FROM MedicationEvents WHERE Patient_ID = '10019385' AND Timestamp > (CURRENT_TIMESTAMP - INTERVAL '10' MONTH)
c921eab7b5888cd147156703,When was the first time in which patient 10018081 had the maximum mean blood pressure in the current ICU encounter?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],[SELECT MIN(start_date) AS first_max_bp_date
df30afea60a71f1c1b64dfef,How many hours have passed since last time that patient 10018081 stayed in careunit trauma sicu (tsicu) during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime DESC LIMIT 1",[],SELECT EXTRACT(EPOCH FROM (NOW() - MAX(admittime))) / 3600 AS hours_since_last_stay FROM admissions WHERE person_id = 10018081 AND careunit = 'tsicu' AND admission_time BETWEEN start_date AND end_date;
9b5ab2bf426064b58719cc29,How many hours have passed since patient 10021487 last visited the careunit trauma sicu (tsicu) in the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime DESC LIMIT 1",[],"select datediff(hour, max(t2.visit_start_time), current_timestamp) from visit_occurrence t1 inner join visit_detail t2 on t1.visit_occurrence_id=t2.visit_occurrence_id where t1.person_id=10021487 and t2.place_of_service_concept_id in (select concept_id from concept where concept_code='TSICU') and t1.visit_occurrence_id in (select visit_occurrence_id from visit_occurrence where visit_occurrence.visit_start_date <= current_date and visit_occurrence.visit_start_date >= current_date - interval '7' day)"
7fb6c6e5361721f050111d9f,What was the total volume of foley patient 10022880 had?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ),[{'SUM(outputevents.value)': None}],SELECT SUM(volume) as total_volume FROM foley_events WHERE patient_id = 10022880
0156bbc7fa6f2c54a9587d76,How much does patient 10020187's weight differ from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT ABS(MAX(weight) - MIN(weight)) as weight_difference FROM (SELECT weight FROM patient_records WHERE patient_id = 10020187 AND visit = 1) as first_visit_weights;
a39d417e2b49ba956a7d03a7,What diagnosis did patient 10014078 have last in their first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,SELECT diagnosis FROM patient_records WHERE patient_id = '10014078' ORDER BY visit_date ASC LIMIT 1
ea34c337ef08f5bb39bce43e,How much is the difference of patient 10020944's weight last measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT MAX(WEIGHT_VALUE) - MIN(WEIGHT_VALUE) AS WEIGHT_DIFFERENCE FROM MEASUREMENT WHERE PERSON_ID = '10020944' AND MEASUREMENT_DATE IN (SELECT MAX(MEASUREMENT_DATE) FROM MEASUREMENT WHERE PERSON_ID = '10020944')
fce59dd5045419545d12fe57,Can you give me patient 10004235's monthly minimum platelets input in the first hospital visit?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'platelets' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",[],"SELECT min(Platelets) AS monthly_minimum_platelets_input FROM patient_records WHERE patient_id = '10004235' AND visit_number = 1 AND date_part('month', visit_date) = date_part('month', (SELECT MIN(visit_date) FROM patient_records WHERE patient_id = '10004235' AND visit_number = 1))"
0a966abcccedcc3a0964e05e,Has patient 10038992 had a lab test?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) FROM lab_tests WHERE patient_id = '10038992'
9c7279514181f0cd64efe035,"What is the cost of a altered mental status, unspecified diagnosis?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'altered mental status, unspecified' ) )",,"SELECT SUM(cost) AS total_cost FROM claims WHERE diagnosis_description = 'Altered mental status, unspecified' AND service_type = 'Inpatient' AND provider_type = 'Hospital'"
0fcf3657ba17464a0f38afe8,What's the cost for cardiac mapping?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) ),,SELECT cost FROM medical_procedures WHERE procedure_name = 'cardiac mapping'
c00a358c2d55cd8c5497fc99,"What is the maximum total cost of the hospital, which includes the blood in stool?",SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'blood in stool' ) ) GROUP BY cost.hadm_id ) AS T1,,"SELECT hospital, MAX(total_cost) FROM `healthcare.costs` WHERE `diagnosis`='blood in stool' AND `treatment`='hospitalization' AND `year`=2017 AND `age_group`='40-50' GROUP BY hospital"
b47161883d5f7a57232f66b9,Was patient 10037928 given a hematocrit lab test in the last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT(*)>0': 0}],SELECT * FROM lab_results WHERE patient_id = '10037928' AND test_name = 'Hematocrit' AND test_date > CURRENT_DATE - INTERVAL '1 year'
090c2ad4771d1fc8adaea4ae,Has patient 10014078 been prescribed a specific drug in 09/this year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09'",[{'COUNT(*)>0': 0}],select prescription_id from prescriptions where patient_id = '10014078' and drug_name = 'specific_drug' and date_prescribed like '09/%' and date_prescribed between '2023-09-01' and '2023-09-30'
2c1b4a7fbad74a8a44675a71,What were the top four most frequent diagnoses that followed within 2 months for those patients who received percutaneous abdominal drainage?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,SQL Query Here
f0106cb7094a1c199a9c6565,Retrieve the top four most common diagnoses in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) as frequency FROM medical_records WHERE year = 2100 GROUP BY diagnosis ORDER BY frequency DESC LIMIT 4"
e4b74a53ea1be8cc09b170cb,What are the steps after the cystoscopy nec?,,,select * from urology_procedure_steps where procedure_name = 'Cystoscopy Nec' order by step_order
8c465916ae512fb241ab372c,"In 2100, what are the top four most frequent procedures that patients received within 2 months after being diagnosed with subdural hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'subdural hemorrhage following injury without mention of open intracranial wound, with no loss of consciousness' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,select procedure from inpatient where ...
c4cdd9f12bc74981468685d3,How many times did the percutaneous [endoscopic] gastrostomy [peg] procedure take place throughout this year?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous [endoscopic] gastrostomy [peg]' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,SQL Query Here
09c12062e2d66d05c75bba9f,So how many days have passed since patient 10018081's last other and unspecified hyperlipidemia diagnosis on their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT DATEDIFF('YYYY-MM-DD', (SELECT MAX(visit_date) FROM diagnosis WHERE patient_id = 10018081 AND diagnosis_code = 'E78.89'), (SELECT visit_date FROM hospital_visits WHERE patient_id = 10018081 AND visit_status = 'current')) AS days_since_last_diagnosis"
d3b9aefc8549a18cee8f540a,How much does a hospital typically spend average on a drug named fentanyl patch since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl patch' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(purchase_price) as average_cost FROM purchases WHERE drug_name = 'fentanyl patch' AND purchase_date >= '2100-01-01'
d58380e3bc5d293e5d7d4718,What are the three diagnoses with the lowest 6-month survival rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",,"select * from (select diagnosis, avg(six_month_survival) as avg_survival from cancer_survival_rate where cancer_type = 'Breast' group by diagnosis order by avg_survival asc) as t limit 3"
548efe4af132f8b95bf61624,Is the respiratory rate level of patient 10021118 last measured on the first ICU visit less than second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",[SELECT CASE WHEN MIN(r1.value) < MAX(r2.value) THEN 'Yes' ELSE 'No' END AS 'Is Respiratory Rate Level Less' FROM measurement m1 JOIN measurement m2 ON m1.subject_id = m2.subject_id AND m1.visit_id = m2.visit_id AND m1.visit_id IN (SELECT visit_id FROM visit WHERE visit.subject_id = 10021118 AND visit.hadm_id IN (SELECT hadm_id FROM icustay WHERE icustay.subject_id = 10021118 AND icustay.first_careunit = 'ICU')) AND m1.measurement_concept_id = 5080001 AND m2.measurement_concept_id = 5080001 AND m1.measurement_time < m2.measurement_time AND m1.measurement_time IN (SELECT MIN(measurement_time) FROM measurement WHERE subject_id = 10021118 AND visit_id = m1.visit_id AND measurement_concept_id = 5080001) AND m2.measurement_time IN (SELECT MAX(measurement_time) FROM measurement WHERE subject_id = 10021118 AND visit_id = m2.visit_id AND measurement_concept_id = 5080001 AND measurement_time < (SELECT MIN(measurement_time) FROM
1a0886c3a3d7dd6afb64dabb,"Tell me the minimum total cost of a hospital visit involving respiratory failure, unspecified with hypoxia since 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'respiratory failure, unspecified with hypoxia' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SQLQuery
61b15d7e2318959ccf6194ba,How much did patient 10037975 weigh the first time it was measured since 22 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT weight FROM measurements WHERE patient_id = 10037975 AND measurement_date >= DATE_SUB(CURDATE(), INTERVAL 22 MONTH) ORDER BY measurement_date ASC LIMIT 1"
e3c9d792118d17e382f1eb65,What are the top four common diagnoses since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM hospital_records WHERE admission_date >= '2100-01-01' GROUP BY diagnosis ORDER BY frequency DESC LIMIT 4"
4a42f97a1663ba9024599519,"In 2100, what are the top four most frequently taken specimens for patients within 2 months after receiving bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"SELECT specimen, COUNT(*) AS frequency FROM medical_records WHERE procedure_code = 'bypass_coronary_artery_three_arteries_from_aorta_autologous_venous_tissue_open_approach' AND diagnosis_date BETWEEN '2100-01-01' AND '2100-03-01' GROUP BY specimen ORDER BY frequency DESC LIMIT 4"
446ee7d9f8e891fa807c4f29,How much of a difference is there in patient 10004720's weight last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SQL Query here
cb78a1c0f1fe2f58edc2d283,Was the value of patient 10020786's white blood cells second measured on the first hospital visit greater than the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","select count(*) from labevents where itemid in (50802,50800) and subject_id=10020786 and hadm_id in (select hadm_id from labevents where itemid in (50802,50800) and subject_id=10020786 and order_time < (select order_time from labevents where itemid in (50802,50800) and subject_id=10020786 and hadm_id in (select min(hadm_id) from labevents where itemid in (50802,50800) and subject_id=10020786))) and value > (select value from labevents where itemid in (50802,50800) and subject_id=10020786 and order_time < (select order_time from labevents where itemid in (50802,50800) and subject_id=10020786 and hadm_id in (select min(hadm_id) from labevents where itemid in (50802,50800) and subject_id=10020786))) and hadm_id in (select min(hadm_id) from labevents where itemid in (50802,50800) and subject_id=10020786)"
84ee48b9c8a46dca91210f99,List the top five most frequent microbiology tests that were given to patients after they were diagnosed with postprocedural hemorrhage of a circulatory system organ or structure following other circulatory system procedure in the same hospital visit.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural hemorrhage of a circulatory system organ or structure following other circulatory system procedure' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 MicrobiologyTest, COUNT(MicrobiologyTest) AS TestFrequency FROM labresults WHERE MicrobiologyTest IS NOT NULL AND LabLocation = 'Central Lab' AND LabResultDate BETWEEN AdmissionDate AND DischargeDate GROUP BY MicrobiologyTest ORDER BY TestFrequency DESC"
8e181485cf1adc897c3a3e28,Are patient 10009049's protein levels second measured on the last hospital visit greater than the levels first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","[SELECT CASE WHEN max(protein_level) > min(protein_level) THEN 'Yes' ELSE 'No' END AS ""Are the Second Protein Levels Greater?"""
9dfacc2c7888378be3ee3aac,Give me the five most common microbiology tests in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5",[],"SELECT test_name, COUNT(*) AS test_count FROM microbiology_tests WHERE year = 2100 GROUP BY test_name ORDER BY test_count DESC LIMIT 5"
4287b3790b3f4f5109f1ee57,"Compared to yesterday, what new drugs are present in the prescription of patient 10018081 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],select drug from prescriptions where patient_id = 10018081 and prescription_date = today and drug not in (select drug from prescriptions where patient_id = 10018081 and prescription_date = yesterday)
133e29afd664c35e8accca09,"What is patient 10018328's minimum value of urea nitrogen, urine during the first hospital visit?","SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' )",[{'MIN(labevents.valuenum)': None}],SQL Query here
2374026e2104232fe78b6141,Did patient 10037975 have a enteral infusion of concentrated nutritional substances during their last hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],SELECT 'Yes' AS Answer WHERE EXISTS (SELECT 1 FROM Procedure WHERE PatientID = 10037975 AND Description = 'enteral infusion of concentrated nutritional substances' AND VisitDate = (SELECT MAX(VisitDate) FROM Procedure WHERE PatientID = 10037975))
d96399e5245e5a0e11dcf0ff,What was diagnosed for patient 10003400 the first time on the last hospital encounter?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,"SELECT DISTINCT p1.code AS `Diagnosis` FROM (SELECT * FROM (SELECT p.person_id, p.start_date, p.end_date, p.visit_occurrence_id, p.diagnosis_concept_id FROM (SELECT o.person_id, o.visit_occurrence_id, o.start_date, o.end_date, MIN(o.visit_occurrence_id) OVER (PARTITION BY o.person_id ORDER BY o.start_date DESC) AS min_visit_id FROM visits o WHERE o.person_id=10003400) AS recent_visit JOIN (SELECT * FROM diagnosis d WHERE d.person_id=10003400) AS p ON recent_visit.visit_occurrence_id=p.visit_occurrence_id AND recent_visit.min_visit_id = p.visit_occurrence_id) AS last_encounter JOIN (SELECT DISTINCT c.concept_id AS diagnosis_concept_id, c.concept_name AS code FROM diagnosis_concept c) AS p1 ON last_encounter.diagnosis_concept_id=p1.diagnosis_concept_id) AS unique_diagnoses;"
d1018384915acc94c4043e76,What medication was prescribed for the first time on the last hospital visit to patient 10036156?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Senna'}],SELECT medication_name FROM prescriptions WHERE patient_id = 10036156 AND visit_date = (SELECT MAX(visit_date) FROM hospital_visits WHERE patient_id = 10036156) ORDER BY prescription_date LIMIT 1
1b28343aacf8cb3fdf1051df,What were the top five frequent laboratory tests that patients had after they were diagnosed with other abnormal blood chemistry during the same hospital encounter since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other abnormal blood chemistry' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,select distinct LabName from lab_events le inner join (select distinct pid from lab_events where LabName like 'OtherAbnormalBloodChemistry' and le.encounter_id = lab_events.encounter_id and le.pid = lab_events.pid and le.visit_date > lab_events.visit_date and le.visit_date >= '2018-07-13' and lab_events.visit_date >= '2018-07-13') x on le.pid = x.pid where le.visit_date >= '2018-07-13' and le.result_value is not null group by LabName order by count(*) desc limit 5;
752822475ba10bd4a7205d6d,What drug was patient 10014729 prescribed for within the same hospital visit after undergoing insertion of catheter into spinal canal for infusion of therapeutic or palliative substances in 03/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,SELECT medication_name FROM patient_treatments WHERE patient_id = 10014729 AND admission_date = (SELECT admission_date FROM patient_treatments WHERE patient_id = 10014729 AND procedure_name = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' AND MONTH(admission_date) = 3) AND treatment_id > (SELECT treatment_id FROM patient_treatments WHERE patient_id = 10014729 AND procedure_name = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' AND MONTH(admission_date) = 3)
804ed378cfb82e9aa6f496dd,Has there been a procedure that patient 10038933 had in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,SELECT EXISTS(SELECT 1 FROM procedure_occurrence WHERE person_id = 10038933 AND YEAR(procedure_date) = 2100);
6b4f7abe50c5cf5f9fe5385a,Tell me the top four most frequent lab tests that patients were given within 2 months after being diagnosed with encounter for immunization since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for immunization' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,"select lab_test_name, count(*) as frequency from patient_lab_tests pl join patient_encounters pe on pl.patient_id = pe.patient_id where pe.diagnosis = 'encounter for immunization' and pl.date between pe.diagnosis_date - interval '2 months' and pe.diagnosis_date and pe.diagnosis_date >= current_date - interval '1 year' group by lab_test_name order by frequency desc limit 4"
0c0b7b1acba7c1472c2ffd97,"How many patients were diagnosed with abdominal pain, other specified site in 2100 after previously being diagnosed with unspecified essential hypertension within 2 months?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abdominal pain, other specified site' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,SQL query here
047259e83745142834b50838,"Was milk of magnesia, furosemide, or metoprolol tartrate ordered on their last hospital encounter for patient 10012552?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'milk of magnesia', 'furosemide', 'metoprolol tartrate' )",[{'COUNT(*)>0': 0}],"[SELECT DISTINCT ON (encounter_id) medication_name, order_date"
db32ddeefc60ef2e085d547a,What is the common method for taking nystatin cream?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'nystatin cream',[],SELECT method FROM nystatin_cream_administration WHERE drug = 'nystatin cream' GROUP BY method ORDER BY COUNT(method) DESC LIMIT 1
af95f1ae9259d68f2fe0a56f,List the top five most frequent events occurring.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT event_name, COUNT(*) as frequency FROM events_table GROUP BY event_name ORDER BY frequency DESC LIMIT 5"
75d97d3e27240d4fbce0b019,How much is the average total hospital cost with personal history of malignant neoplasm of other gastrointestinal tract?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of other gastrointestinal tract' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT AVG(total_hospital_cost) AS avg_hospital_cost FROM inpatient WHERE personal_history_of_malignant_neoplasm_of_other_gastrointestinal_tract = 'Yes'
f515f06bef679a5069bf1b69,When was the last time patient 10021312 was prescribed medication via the ih route in 08/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'ih' AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(prescribed_date) FROM prescriptions WHERE patient_id = '10021312' AND route = 'ih' AND EXTRACT(YEAR_MONTH FROM prescribed_date) = '202108';
d97ce57b0238741d318dd305,What is the number of patients who were prescribed phenytoin infatab since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phenytoin infatab' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE medication_name = 'phenytoin infatab' AND date_prescribed >= (CURRENT_DATE - INTERVAL '1 year')
062e5671bf6a5d7df2d8f9ef,When did patient 10039831 receive the last 5% dextrose and pantoprazole prescription at the same time throughout this month?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10039831 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10039831 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"SELECT MAX(visit_occurrence.visit_start_date) FROM visit_occurrence JOIN condition_occurrence ON visit_occurrence.visit_occurrence_id = condition_occurrence.visit_occurrence_id WHERE person_id = 10039831 AND (condition_concept_id IN (SELECT concept_id FROM concept WHERE concept_name IN ('5% dextrose', 'pantoprazole')) AND visit_occurrence.visit_start_date BETWEEN DATE_TRUNC('month', CURRENT_DATE) AND CURRENT_DATE)"
d49a169b25722c624294da5c,"On the first hospital visit, what was the diagnosis for patient 10002495 the first time?",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,SELECT diagnosis FROM hospital_visits WHERE patient_id = '10002495' AND visit_order = 1 ORDER BY visit_date LIMIT 1
af65283ac3452f4ee5fa0142,Has patient 10022041 been admitted into an emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room',[{'COUNT(*)>0': 0}],Select distinct 1 from admissions where patientid = 10022041 and admtype = 'ER' limit 1
06c9202911fa52427beba085,"What was the minimum value of patient 10001217's calcium, total in 12/2100?","SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND strftime('%Y-%m',labevents.charttime) = '2100-12'",[{'MIN(labevents.valuenum)': None}],"SELECT MIN(total) FROM lab_results WHERE patient_id = 10001217 AND test_name = 'calcium, total' AND date = '12/2100'"
e257942d050e74a2e2aef5b3,"What are the five commonly ordered medications for patients who were diagnosed with unspecified disorder of kidney and ureter previously in the same month, since 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified disorder of kidney and ureter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"[SELECT Medication, COUNT(Medication) AS Frequency"
cb5415c33f751a6b441a1cd4,"What are the top five most common microbiology tests for people who were diagnosed with rheumatic disorders of both mitral and aortic valves earlier in the same hospital encounter, in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,select distinct top 5 Microbiology_test from lab_results where Patient_Diagnosis='rheumatic disorders of both mitral and aortic valves' and Encounter_date like '%2100%' order by count(Microbiology_test) desc
093bd4e875cc23f9739cdd09,What was the output of patient 10020740 for the last time on 06/15/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '06-15' ORDER BY outputevents.charttime DESC LIMIT 1 )",[],select max(output) from chartevent where itemid = 211 and subject_id=10020740 and charttime between '2023-06-15 00:00' and '2023-06-15 23:59' and value > 0
c9bd206b23c8ece065ccbc5f,Retrieve the top four most frequent lab tests during this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"select test_name, count(*) as frequency from lab_tests where YEAR(test_date) = 2023 group by test_name order by frequency desc limit 4"
8ef6fa9dfc5f788fb73b69e8,Can you show me the top three most common procedures conducted in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT ProcedureName, COUNT(*) AS ProcedureCount FROM MedicalRecords WHERE YEAR(ProcedureDate) = 2100 GROUP BY ProcedureName ORDER BY ProcedureCount DESC LIMIT 3"
9cfc6425bde940cf398a73dc,"What's the average monthly number of patients who had multiple fractures of ribs, bilateral, initial encounter for closed fracture in 2100?","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'multiple fractures of ribs, bilateral, initial encounter for closed fracture' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,"select year, month, round(avg(number of patients),2) as avg_patients from inpatient_benes where icd10_code in ('S22.39XA', 'S22.3XXA') and year=2100 group by year, month"
04c9a043e311b54b777c1b7d,Can you tell the five most frequent lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT lab_test_name, COUNT(*) AS frequency FROM lab_tests GROUP BY lab_test_name ORDER BY frequency DESC LIMIT 5"
785d76bc0b177869d3d36d87,How many operating rooms is there now,,,SELECT COUNT(DISTINCT room_id) FROM rooms WHERE is_operating = 1;
7f904e1c55c930388a753052,How many patients required alteplase (catheter clearance)?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'alteplase (catheter clearance)' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patient_id) from stroke where alteplase = 'catheter clearance'
398d1c05773ae55b7220d406,What was the medication patient 10022017 was prescribed for the last time since 04/2100 via the sc route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT medication_name FROM prescriptions WHERE patient_id = 10022017 AND prescription_date = (SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = 10022017 AND prescription_date >= '04/2100' AND route = 'sc')
d4f9d7cf2cdd1caea918a666,What are the costs of other psoriasis diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other psoriasis' ) ),,SELECT cost FROM diagnosis WHERE condition = 'psoriasis' AND diagnosis_type = 'other'
cd9b4dacacdde7494c082761,Gather the total number of times patient 10023239 visited the hospital during this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10023239 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT COUNT(*) AS total_visits FROM visits WHERE patient_id = 10023239 AND YEAR(visit_date) = YEAR(CURDATE())
df115de912364769eda352c1,Show me patient 10007058's total amount of cath lab intake input since 07/17/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cath lab intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-17'",[{'SUM(inputevents.totalamount)': None}],"select patientid, sum(total) from lab_input where patientid='10007058' and lab_name='cath' and datetime between '2100-07-17' and '2100-07-17' group by patientid"
ea3505754407fd4d8ea5fdd8,How much difference is there in pco2 levels among patient 10009035 last measured on the first hospital visit compared to the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT (MAX(pco2) - MIN(pco2)) AS pco2_difference FROM lab_results WHERE patient_id = '10009035' AND visit = 1 AND result_date = (SELECT MIN(result_date) FROM lab_results WHERE patient_id = '10009035' AND visit = 1) OR result_date = (SELECT MAX(result_date) FROM lab_results WHERE patient_id = '10009035' AND visit = 1)
27b1f84153a5a461120468de,Has patient 10005817 undergone laboratory tests since 4 months ago?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(labevents.charttime) >= datetime(current_time,'-4 month')",[{'COUNT(*)>0': 1}],SELECT patient_id FROM laboratory_tests WHERE patient_id = '10005817' AND test_date >= (CURRENT_DATE - INTERVAL '4 MONTHS')
ead0a72fbee21b877251d88f,How much does malignant neoplasm of central portion of female breast cost to get diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of central portion of female breast' ) ),,SELECT AVG(diagnosis_cost) AS average_diagnosis_cost FROM healthcare_costs WHERE condition = 'malignant neoplasm of central portion of female breast' AND diagnosis_type = 'diagnostic test'
2b73e239d32f4e598b39620c,Can you tell me the last value of the free calcium test for patient 10023239?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT `free_calcium_test_value` FROM `medical_records` WHERE `patient_id` = '10023239' ORDER BY `test_date` DESC LIMIT 1
5af27171b0a97add7aee4ea6,What was the amount of acetaminophen that patient 10023239 were prescribed in total in 06/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND prescriptions.drug = 'acetaminophen' AND strftime('%Y-%m',prescriptions.starttime) = '2100-06'",[{'SUM(prescriptions.dose_val_rx)': None}],select sum(qty) from drugrx where patientid=10023239 and ndc like '637460%' and date between '06/01/2100' and '06/30/2100'
342ee94f22cb4edb3916fb14,What was patient 10005909's first input time since 04/03/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-03' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2144-10-29 23:15:00'}],SELECT MIN(input_time) FROM patient_data WHERE patient_id = 10005909 AND input_time >= '04/03/2100' AND input_time <= '07/31/2100' AND status = 'input' AND event_type = 'first_input';
55c7172525f47f43ab6b752a,What percentile does a alanine aminotransferase (alt) value of 55.0 for patient 10007818 place in today in the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 55.0",,select percentile_cont(0.5) within group (order by alt) from labevents where subject_id = 10007818 and hadm_id = (select min(hadm_id) from labevents where subject_id = 10007818 and charttime::date = current_date) and itemid = 50868 and alt::numeric <= 55.0 and charttime::date = current_date;
3a11d55ef59b984180bf191b,What was an insurance plan for patient 10001217 during their first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Other'}],Select * from Encounter where patient_id = '10001217' and encounter_rank = 1 and service_type = 'insurance_plan'
f39b6fca5e6f640b836a9c9c,Get me the top three most frequent procedures that patients received within 2 months after receiving diagnostic ultrasound of heart.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of heart' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT procedure_name, COUNT(procedure_name) AS frequency FROM procedures WHERE patient_id IN (SELECT patient_id FROM procedures WHERE procedure_name = 'diagnostic ultrasound of heart' AND procedure_date BETWEEN DATE_SUB(diagnosis_date, INTERVAL 2 MONTH) AND DATE_ADD(diagnosis_date, INTERVAL 2 MONTH)) GROUP BY procedure_name ORDER BY frequency DESC LIMIT 3;"
26d017535d48be13b43f72f2,What were the top five most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]","SELECT TOP 5 TestName, COUNT(*) AS Frequency FROM MicrobiologyTests GROUP BY TestName ORDER BY Frequency DESC"
44976b84ff1c95d71e982f32,What immunocancer drugs have been used for the last five years?,,,
c4e464a5e3c26b34a598c2d4,"What are the three most commonly prescribed medications for patients diagnosed with other and unspecified hyperlipidemia previously within the same hospital visit, throughout this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,Your SQL query here
e138f038c01ab7ff83cbbb98,What is the price of a procedure named arteriography of other specified sites?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other specified sites' ) ),,select price from procedures where procedure_name = 'arteriography of other specified sites'
a178876b3ab67646062e1b51,How many hours has it been since patient 10021487 stayed in the careunit emergency department in this hospital encounter for the last time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MAX(stay_time), NOW()) AS hours_since_last_stay FROM careunit_stay WHERE patient_id = 10021487 AND careunit = 'emergency department' AND hospital_encounter_id = (SELECT MAX(hospital_encounter_id) FROM careunit_stay WHERE patient_id = 10021487 AND careunit = 'emergency department')"
027706ca26ae55a15b9f1d91,"Among the patients of age 40s in 2100, what are the top three most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,
024dcd124ec3d33f8ac7d1e6,Show me the four most common specimens tested during this year.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4",[],SQL Query
4e1f8471625f8559d0c64629,Count the number of times that arteriography of renal arteries was performed since 1 year ago.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of renal arteries' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,"SELECT COUNT(*) FROM procedures WHERE procedure_type = 'arteriography' AND body_part = 'renal arteries' AND procedure_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
7f969459fa4b9cddf822c495,"What are the four frequently prescribed medications for patients diagnosed with septicemia due to escherichia coli [e. coli] previously in the same hospital visit, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'septicemia due to escherichia coli [e. coli]' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 medication.name FROM medication JOIN prescription ON medication.id = prescription.medication_id WHERE prescription.diagnosis = 'septicemia due to E. coli' AND prescription.date >= DATEADD(year, -1, GETDATE()) GROUP BY medication.name ORDER BY COUNT(prescription.id) DESC"
1ed08f1aa0fe257e5b029f58,When was the last time patient 10021118 had an minimum absolute basophil count in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute basophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],SELECT MAX(result_date) FROM result WHERE patient_id = 10021118 AND result_type = 'basophil count absolute minimum' AND result_date BETWEEN '2023-12-01' AND '2023-12-31'
8281e9dde4a495faf9a70ae4,When was the first time on this month/29 patient 10018081's heart rate was greater than 72.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 72.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '29' ORDER BY chartevents.charttime ASC LIMIT 1",[],[SELECT MIN(HEART_RATE_DATETIME) AS 'First Time Above Threshold'
145ae721e90f0d4889236e9b,Tell me the percentile for pt of 12.9 among patients in the same age as patient 10001217 in their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 12.9",,[SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY pt) OVER (PARTITION BY age) AS median_pt
523b2264acf6a8ceaf29d220,What was patient 10004733's last serology/blood's microbiology test time in 12/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND microbiologyevents.spec_type_desc = 'serology/blood' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(test_time) FROM serology_blood_microbiology WHERE patient_id = 10004733 AND test_time BETWEEN '2023-12-01' AND '2023-12-31'
cd5de61128bf4493b8a116a3,Did patient 10018423 undergo a alkaline phosphatase test in 05/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05'",[{'COUNT(*)>0': 0}],SELECT DISTINCT patient_id FROM lab_results WHERE test_name = 'alkaline phosphatase' AND patient_id = '10018423' AND date = '05/2100';
bddff1513f83253443df0ee2,"Count the number of people who received drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic within 2 months after having been diagnosed with other cirrhosis of liver in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cirrhosis of liver' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT count(*) FROM (SELECT count(*) FROM `physionet-data.mimiciii_clinical.diagnoses_icd` as d1, `physionet-data.mimiciii_clinical.noteevents` as n1, `physionet-data.mimiciii_procedures.icustays` as p WHERE d1.icustay_id=p.icustay_id AND n1.icustay_id=p.icustay_id AND d1.icd9_code LIKE '571.%' AND n1.text LIKE '%drainage of right lower lobe bronchus%' AND n1.charttime > d1.chartdate AND n1.charttime <= date_add(d1.chartdate, interval 2 month)) as subquery"
802527c0be8a9149dbd4a8eb,What was the name of the organism that was found during the last urine test of patient 10008454 in 12/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT OrganismName FROM UrineTests WHERE PatientID = 10008454 AND TestDate = (SELECT MAX(TestDate) FROM UrineTests WHERE PatientID = 10008454 AND TestDate LIKE '12/2100%')
8f6f18c72c81b1627f391252,Has patient 23070 ever experienced any side effects while receiving a blood transfusion?,,,"SELECT DISTINCT patient_id, side_effects FROM medical_records WHERE patient_id = 23070 AND treatment_type = 'blood transfusion' AND side_effects IS NOT NULL"
e7b0a2fb743b8d418360896e,Calculate the total amount of foley of patient 10006580 in the first ICU visit.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ),[{'SUM(outputevents.value)': None}],SELECT SUM(amount) AS total_foley FROM admissions JOIN payments ON admissions.admission_id = payments.admission_id WHERE patient_id = '10006580' AND icu_visits = 1 AND payment_type = 'Foley'
8189f1610cb803102103466a,Has any medication been prescribed to patient 10015931 since 12/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12'",[{'COUNT(*)>0': 1}],SELECT COUNT(*) FROM prescriptions WHERE patient_id = '10015931' AND prescription_date > '2100-12-31'
8ff3fa3aa1d227c7f0860781,What are the four most frequent procedures for patients who are in their 20s?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"select top 4 procedure_name, count(*) as frequency from procedures where age between 20 and 29 group by procedure_name order by frequency desc;"
6b9aea1e113e3ec6de66929b,"What were the five most commonly performed lab tests for patients who were previously diagnosed with cholangitis in the same hospital visit, in this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cholangitis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"select t.test_name, count(*) as test_count from lab_tests t, patients p where t.patient_id = p.patient_id and p.previous_diagnosis = 'cholangitis' and year(t.test_date) = 2022 group by t.test_name order by test_count desc limit 5"
b49883cb372deacf8d0d0392,What was the total amount of input for patient 10018081 since 09/25/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-25'",[{'SUM(inputevents.totalamount)': 171300.0}],select sum(input) from input where patient_id = 10018081 and date >= '09/25/2100'
a0cdae836281b14960231c43,What is the list of things to do before you go through the endo polpectomy lrge int procedure?,,,SELECT ThingToDo FROM EndoPolpectomyLrgIntPrep
7a5650e936855a3fa424dc59,Find out the number of hospital visits patient 10014078 had in the last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10014078 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],"SELECT COUNT(*) FROM hospital_visits WHERE patient_id = '10014078' AND visit_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
2c4de5ffe5ea946437ba33a6,"During the last hospital encounter, how old was patient 10019172?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,"SELECT DATEDIFF(year, birthdate, encounter_date) AS age_at_encounter FROM hospital_records WHERE patient_id = 10019172 AND encounter_id = (SELECT MAX(encounter_id) FROM hospital_records WHERE patient_id = 10019172)"
b7b81b39be99bf34446ee242,Has there been any organism found in the last microbiological mrsa screen test of patient 10039997?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'COUNT(*)>0': 0}],SQL Query
4d64d12fe14c8c3ed4e3f73f,Has patient 10039831 got a lab test since 05/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-05'",[{'COUNT(*)>0': 1}],select * from lab_tests where patient_id=10039831 and date>='05/21/2000'
4e9096d82b904f68fcb8006c,What is the average value of creatinine on patient 10023117?,SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ),[{'AVG(labevents.valuenum)': None}],select avg(creatinine) from labtests where patient_id = 10023117
1e3f74247a6a94fae1151382,How much was the difference in weight of patient 10038081 second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","select max(weight)-min(weight) from (select weight from patient_weight where patient_id = 10038081 order by visit_date desc, date desc limit 1) as visit_1 join (select weight from patient_weight where patient_id = 10038081 order by visit_date desc, date desc limit 1 offset 1) as visit_2 on visit_1.visit_date = visit_2.visit_date"
9c3e936bd95a10b43339da38,When did patient 10007818 receive a mrsa screen microbiology test first in 07/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-07' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(START) AS first_screen FROM microbiology WHERE PAT_ID = '10007818' AND TEST_CODE = 'mrsa_screen' AND START BETWEEN '2100-07-01' AND '2100-07-31'
16daefeea8782307bdc2f5f7,Provide the daily maximum weight of patient 10031757 since 12 months ago.,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-12 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],
6403ade93013ea7eb291be96,What are patient 10025612's changes in SaO2 second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT FIRST_VALUE(SaO2_second) OVER (ORDER BY timestamp ASC) - FIRST_VALUE(SaO2_second) OVER (PARTITION BY patient_id ORDER BY timestamp ASC) AS SaO2_change FROM ICU_readings WHERE patient_id = 10025612 AND ICU_visit_number = 1
e63b87cee280daecb46a2af6,"So, the first asparate aminotransferase (ast) test result for the patient 10019172 was?",SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'asparate aminotransferase (ast)' ) ORDER BY labevents.charttime ASC LIMIT 1,[],SELECT TOP 1 ASTResult FROM TestResults WHERE PatientID = '10019172' ORDER BY TestDate ASC
ca889d0ba7397111451ebf74,Count the number of patients who underwent a d-dimer lab test since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'd-dimer' ) AND strftime('%Y',labevents.charttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT(patient_id)) FROM lab_tests WHERE test_name = 'd-dimer' AND date >= '2100-01-01'
4a7d4830011d65962d460041,What is the maximum cost to the hospital that involves nonalcoholic steatohepatitis (nash) since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nonalcoholic steatohepatitis (nash)' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SQL Query Here
388d3f6a45be242b02005c5c,How many hours have passed since patient 10018081 got her last diagnosis of other and unspecified hyperlipidemia on their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT TIMESTAMPDIFF(HOUR, last_diagnosis_date, CURRENT_TIMESTAMP) AS hours_passed FROM diagnoses WHERE patient_id = 10018081 AND diagnosis_code = 'other_and_unspecified_hyperlipidemia' AND encounter_id = (SELECT current_encounter_id FROM patients WHERE patient_id = 10018081)"
5acdc780ba8984cef61073b2,Show me the top five most frequent diagnoses since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) as diagnosis_count FROM diagnoses WHERE date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 5"
3e877dc92daa5d8f28115762,"What is the total count of performance of cardiac output, continuous procedures that were done since 1 year ago?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,"select count(*) from performances where test_name='continuous procedures' and test_subname='cardiac output' and date between date_sub(curdate(), interval 1 year) and curdate()"
47fa8b1ea8f2a4b9b4e04657,When did patient 10006053 have the minimum value of polys last on the first hospital stay?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],
9b039ee786a20e3b239037e0,How many patients were staying in med/surg/trauma in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/trauma' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patient_admissions WHERE unit_type = 'med/surg/trauma' AND year = 2100
80343317e0783f2a96a603d5,Does patient 59275 have a travel history to another country?,,,SELECT EXISTS(SELECT 1 FROM Patients INNER JOIN TravelHistories ON Patients.PatientID = TravelHistories.PatientID WHERE Patients.PatientID = 59275 AND TravelHistories.Country <> 'CountryName')
95315cf3377aff338fc6744d,"What are the top four most common microbiology tests for people who were diagnosed with unspecified deficiency anemia earlier during the same month, in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified deficiency anemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 microbiology_tests, COUNT(*) AS test_frequency FROM PatientMedicalRecords WHERE diagnosis_code = 'Unspecified Deficiency Anemia' AND YEAR(diagnosis_date) = 2100 AND MONTH(diagnosis_date) = MONTH(current_date) GROUP BY microbiology_tests ORDER BY test_frequency DESC"
0e962cda70b80f5930bde5ac,What percentile of the po2 value is 127.0 among patients of the same age as patient 10021487 on this hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'po2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 127.0",,select ... from ... where ...
e6c6113c42e3afffa9a446d8,"Since 2100, what are the top five most common lab tests ordered for patients in the same month after acute respiratory failure with hypoxia?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute respiratory failure with hypoxia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,Your SQL query here
7cfaf497121871d021a26099,Count up how many times patient 10000032 was admitted to the ICU since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}],SELECT COUNT(*) FROM Admissions WHERE patient_id = 10000032 AND admission_date > CURRENT_DATE - INTERVAL '1 year' AND department = 'ICU';
d4efc7e55f28c5602d3467ae,Could you inform me of the minimum alkaline phosphatase value for patient 10018081 since 12/2100?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12'",[{'MIN(labevents.valuenum)': None}],SELECT MIN(alkaline_phosphatase) AS min_alkaline_phosphatase FROM laboratory_events WHERE subject_id = 10018081 AND result_date >= '12/21/2000'
232ebd5bf14d5819bef84afc,"Has furosemide, lidocaine jelly 2% (urojet), or acetaminophen iv been prescribed in 04/last year for patient 10038992?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND prescriptions.drug IN ( 'furosemide', 'lidocaine jelly 2% (urojet)', 'acetaminophen iv' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)>0': 0}],"select distinct m.medicine_name from medicine m where m.patient_id = '10038992' and m.medicine_name in ('Furosemide', 'Lidocaine Jelly 2%', 'Acetaminophen IV') and m.prescribed_date between '2022-04-01' and '2022-04-30'"
bd5f6fd5ab13ce62634ea939,What was patient 10039997's daily average weight since 4 months ago?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-4 month') GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",[],"SELECT AVG(weight) AS avg_weight FROM patient_measurements WHERE patient_id = '10039997' AND measurement_date >= DATE_SUB(CURDATE(), INTERVAL 4 MONTH)"
02960e704986efbe2e56a892,What's the weight difference of patient 10038081's body second measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT hospital_visit_id, patient_id, (bmi_last - bmi_first) AS bmi_weight_difference FROM (SELECT hospital_visit_id, patient_id, MAX(CONCAT(bmi, '_', bmi_order)) AS bmi_last, MIN(CONCAT(bmi, '_', bmi_order)) AS bmi_first FROM (SELECT hospital_visit_id, patient_id, bmi, bmi_order, ROW_NUMBER() OVER (PARTITION BY patient_id, hospital_visit_id ORDER BY visit_date DESC) AS rn FROM hospital_visit) WHERE rn = 1 GROUP BY patient_id) WHERE patient_id = 10038081"
d9a1e858931b19e914db92c6,Calculate patient 10007818's total input amount of fresh frozen plasma on 07/03/this year.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'fresh frozen plasma' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-03'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(amount) FROM transfusions WHERE patient_id = '10007818' AND product = 'fresh frozen plasma' AND transfusion_date = '2023-07-03'
48ee3c32b16e889f8868868d,"Tell me the name of the drug patient 10002495 was prescribed within 2 days after having received a dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach procedure in 06/this year?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT DISTINCT drug_name FROM prescriptions WHERE patient_id = 10002495 AND prescription_date BETWEEN (SELECT procedure_date FROM medical_procedures WHERE patient_id = 10002495 AND description = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' AND EXTRACT(MONTH FROM procedure_date) = 6) AND (SELECT procedure_date FROM medical_procedures WHERE patient_id = 10002495 AND description = 'dilation of coronary artery, one artery with drug-eluting intraluminal device, percutaneous approach' AND EXTRACT(MONTH FROM procedure_date) = 6) + INTERVAL '2 days';"
1aa68945724425b2f49cb5f1,What output did patient 10015860 generate first since 10/04/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Void'}],"SELECT output_type, MIN(date_time) FROM chartevents WHERE icustay_id = '10015860' AND date_time > '2100-10-04' GROUP BY output_type ORDER BY MIN(date_time) ASC LIMIT 1;"
1532ba3736ece73151250484,When were the drugs sodium chloride 0.9% and pantoprazole prescribed to patient 10036156 for the last time at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium chloride 0.9%' AND admissions.subject_id = 10036156 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10036156 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],Your SQL query here
8ba70176af381d80ec259c94,What is the treatment that patient 10020740 was given two times since 05/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,[SELECT treatment
feaaef960a419d81d79e5cfb,Tell me the total acetaminophen dose that patient 10037975 has been prescribed?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND prescriptions.drug = 'acetaminophen',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(acetaminophen_dose) FROM prescriptions WHERE patient_id = 10037975;
a739dee00e50021190bd7f13,When did patient 10014078 have his first microbiology test on the first hospital stay?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'charttime': '2166-08-22 02:04:00'}],SELECT MIN(date) FROM microbiology_tests WHERE patient_id = 10014078 AND hospital_stay_number = 1;
d2c264c9a4496523fd9581ea,"On 10/13/2100, when did patient 10038081 have his first input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-10-13' ORDER BY inputevents.starttime ASC LIMIT 1",[],SELECT MIN(InputDate) FROM PatientInputs WHERE PatientID = 10038081 AND InputDate >= '2023-10-13' AND InputDate < '2023-10-14'
cd3f347fafd6a0b53706f949,Can you tell me the maximum total hospital cost that involved propranolol since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'propranolol' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_hospital_cost) FROM hospital_data WHERE drug_name = 'propranolol' AND year >= 2100
31cdceeb50d5b9593b6c8055,Find out the number of medicines given to patient 10021938 since 03/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",[{'COUNT(*)': 48}],select count(*) from treatment where patient_id=10021938 and treatment_date>'03/2100' and treatment_type='medicine'
14db1e998fac387f2026f225,When was the last time patient 10021487 measured its mean blood pressure less than 63.0 since 339 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 63.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-339 day') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT TOP 1 `Date` FROM `patient_measurements` WHERE `PatientID` = '10021487' AND `MeanBloodPressure` < 63.0 AND `Date` > DATE_SUB(CURDATE(), INTERVAL 339 DAY) ORDER BY `Date` DESC"
5137f76e33516dfdead9f682,Has patient 10004733 been given any gastric meds medication since 12/19/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19'",[{'COUNT(*)>0': 0}],SELECT * FROM medication_records WHERE patient_id = 10004733 AND medication_type = 'gastric meds' AND date_prescribed >= '12/19/2100'
436b1fadeae03c1681161469,Was patient 10016150 through any surgery during the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"select distinct a1.patient_num from ADMISSION a1 where a1.patient_num = 10016150 and (a1.surg_date is not null and a1.surg_date >= date_sub(current_date(), interval 1 year))"
493b74ce7611de520a722436,What was the name of the output patient 10007058 last had since 05/10/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-05-10' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Void'}],SELECT last_output_name FROM patient_history WHERE patient_id = 10007058 AND date >= '2100-05-10' ORDER BY date DESC LIMIT 1
b6c95050bdc4cd4c317d476e,"Tell me the four most common microbiology tests for patients who were previously diagnosed with fall on same level, unspecified, initial encounter during the same month since 2100.","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fall on same level, unspecified, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,SQL Query Here
7a87b3514162ac542fd54a50,"When did patient 10014354 get the creatine kinase, mb isoenzyme lab test in their last hospital visit for the first time?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT MIN(START_DATE) AS First_Test_Date FROM LAB_EVENTS WHERE PATIENT_NUM='10014354' AND LAB_TEST='Creatine Kinase, MB Isoenzyme' AND VISIT_NUM=LAST_VISIT ORDER BY START_DATE;"
297493c491ff8db9a6d2fc45,Has there been a mch lab test performed on patient 10022281 since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND strftime('%Y',labevents.charttime) >= '2100'",[{'COUNT(*)>0': 0}],SELECT * FROM LabTests WHERE PatientID='10022281' AND DatePerformed > '2100-01-01'
2c475b369cef5f55de67b63f,When was the last hospital discharge of patient 10009049?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10009049 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],SELECT MAX(date_of_admission) FROM discharge_data WHERE patient_id = '10009049'
33dd2e95b6eaf89b0361b109,What are the top four most common microbiology tests that patients had after the diagnosis of metabolic encephalopathy in the same month?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'metabolic encephalopathy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 Test, COUNT(Test) AS TestFrequency FROM microbiology_tests WHERE diagnosis = 'metabolic encephalopathy' AND MONTH(diagnosis_date) = MONTH(test_date) GROUP BY Test ORDER BY TestFrequency DESC;"
17fee8730ce67c5cb81363da,Tell me the name of the diagnosis that patient 10019172 received the last time on the last hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,"SELECT DiagnosisName FROM DiagnosisRecords WHERE PatientID = '10019172' ORDER BY VisitDate DESC, DiagnosisDate DESC LIMIT 1"
1bf033967053a3e88b60ffec,How many current patients are there?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patient WHERE discharge_date IS NULL;
7b572da72e10a69e40094361,Tell me the blood type of patient 28443?,,,SELECT blood_type FROM patient_blood_type WHERE patient_id = 28443
d33831f0ec31a6a9c49b16ff,"On 06/23/2100, what was the first value of arterial blood pressure mean of patient 10013049?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-06-23' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT TOP 1 arterial_blood_pressure_mean FROM patient_data WHERE patient_id = 10013049 AND entry_datetime = '2100-06-23 00:00:00' ORDER BY entry_datetime ASC
131ea45cf61be3a504988801,"In total, how many patients were prescribed vancomycin since 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 136}],SELECT SUM(...) FROM ...
b6d7a34bc707d9209a3f1b63,How many hours has elapsed since the last time in this hospital visit patient 10021487 had received a wbc lab test?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'wbc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],select extract (epoch from (now () at time zone 'utc') - max (result_time at time zone 'utc')) / 3600 from lab_results where patient_id = '10021487' and lab_test_type = 'wbc' and result_time < (select max (result_time) from lab_results where patient_id = '10021487' and visit_id = 'V12345')
d0236a73c2938bd7a69aac21,Was any tpn without lipids medication provided to patient 10020740 on 03/26/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tpn without lipids' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-26'",[{'COUNT(*)>0': 0}],SELECT * FROM tblDose WHERE patID = '10020740' AND orderDate = '03/26/2100' AND orderType = 'tpn' AND lipid = 'no'
f65f6f053430f63b922aef1d,How many days has it been since the first time that patient 10004733 was diagnosed with other iatrogenic hypotension on the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT DATEDIFF(CURDATE(), MIN(C.visit_start_date)) AS days_since_first_diagnosis FROM visit_occurrence C WHERE C.visit_occurrence_id IN (SELECT O.visit_occurrence_id FROM visit_detail O WHERE O.person_id = 10004733 AND O.visit_detail_concept_id = 4251337 AND O.visit_detail_source_value LIKE '%other iatrogenic hypotension%') AND C.visit_occurrence_id IN (SELECT P.visit_occurrence_id FROM visit_occurrence P WHERE P.visit_occurrence_id IN (SELECT Q.visit_occurrence_id FROM visit_detail Q WHERE Q.person_id = 10004733 AND Q.visit_detail_concept_id IN (SELECT R.concept_id FROM concept R WHERE R.concept_name LIKE '%current hospital%')))"
d84c6c7fe6daa03fe7f81c8b,"In 2100, how many patients underwent insertion of endotracheal tube during the same month after the diagnosis of acute kidney failure, unspecified?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute kidney failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of endotracheal tube' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,[SELECT COUNT(*) AS TotalPatients
0a32f1c36ff8b32b47e43478,"Tell me, was packed red blood cells given to patient 10007818 on 07/04/this year?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '07-04'",[{'COUNT(*)>0': 0}],SELECT * FROM transfusion_events WHERE patient_id = '10007818' AND transfusion_type = 'Packed Red Blood Cells' AND transfusion_date = '2023-07-04'
06e428e5b1ed6505097a25ad,Tell me the total number of patients in pacu since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS total_patients FROM patients WHERE procedure_date >= '2100-01-01'
f3303ed15c820c9b329af410,What are the top four most common diagnoses that patients were diagnosed with within 2 months after receiving partial hepatectomy's this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) AS diagnosis_count FROM medical_records WHERE procedure = 'partial hepatectomy' AND date BETWEEN '2023-01-01' AND '2023-12-31' AND diagnosis_date BETWEEN procedure_date AND DATE_ADD(procedure_date, INTERVAL 2 MONTH) GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 4"
1b4e7ac4a337c583b0d77b04,The name of the diagnosis received by patient 65582 at the other department.,,,SELECT diagnosis FROM patient_records WHERE patient_id = 65582 AND department != 'current_department'
37c0bde96e8c70d1dcfce0ca,"What is the average daily number of patients suffering from constipation, unspecified?","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1",,"select avg(daily_patients) from disease_statistics where disease_name = 'Constipation, unspecified'"
98eb6c243d1dff5092eb4c38,What's the best way to disinfect a quarantine room?,,,"select disinfection_method, effectiveness_rating from disinfection_methods where room_type = 'quarantine' order by effectiveness_rating desc limit 1"
46024bc03077cc1765abf676,"In 04/last year has insulin, metronidazole (flagyl), or bisacodyl been prescribed for patient 10021487?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug IN ( 'insulin', 'metronidazole (flagyl)', 'bisacodyl' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)>0': 0}],SELECT * FROM Prescription WHERE patient_id='10021487' AND (drug_name='insulin' OR drug_name='metronidazole' OR drug_name='bisacodyl') AND YEAR(prescription_date) = YEAR(CURRENT_DATE) - 1 AND MONTH(prescription_date) = 4
1844c94cefe167cfc46bbbc8,When did patient 10007818 first have their minimum heart rate on 07/03/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-07-03' ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",[],SELECT MIN(MeasurementDateTime) FROM [LabsAndVitals
6b93b67bb974684b413b3c6a,Can I know the total output amount for patient 10018081 since 11/27/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-27'",[{'SUM(outputevents.value)': 66945.0}],SELECT SUM(OutputAmount) AS TotalOutputAmount FROM PatientRecords WHERE PatientID = '10018081' AND Date >= '11/27/2100'
b08e604b0e398d9225a7e1f0,When did the last time patient 10027602 had the minimum value of heart rate since 10/06/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-10-06' ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",[],"select * from (select * from (select * from (select * from (select max(created) as date,patient_id,heart_rate from `physionet-data.mimiciv_clinical_records_v40` where heart_rate > 0 and patient_id = '10027602' group by patient_id,heart_rate order by heart_rate, date desc) as t) group by t.heart_rate) where rownum = 1) as t2 order by date desc limit 1"
8112593e7e23d761e0584c76,Give me patient 10001725's length of stay for the first ICU stay in days.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.338587962090969}]","SELECT DATEDIFF(day, MIN(ADMITTIME), MIN(DISCHTIME)) FROM ADMISSIONS WHERE SUBJECT_ID = 10001725 AND ADMISSION_TYPE = 'First ICU Stay'"
61f59af2792e3a760c51ddd9,When was patient 10011398's first input since 04/16/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-16' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2146-12-15 12:30:00'}],SELECT MIN(input_date) FROM patient_inputs WHERE patient_id = 10011398 AND input_date >= '04/16/2100'
79257401a1158ff7232db9fd,Show me the top four most frequent diagnoses that patients were diagnosed with within 2 months after receiving other electroshock therapy since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patient_records WHERE electroshock_therapy_date >= '2100-01-01' AND diagnosis_date BETWEEN electroshock_therapy_date AND DATE_ADD(electroshock_therapy_date, INTERVAL 2 MONTH) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 4;"
5b1d543d54897c267c07f555,What were the top three most frequent diagnoses in 2100 with which patients were diagnosed after receiving hemodialysis within 2 months?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT TOP 3 diagnosis FROM patient_records WHERE treatment='hemodialysis' AND diagnosis_date >= DATEADD(month, -2, treatment_date) AND YEAR(diagnosis_date) = 2100 GROUP BY diagnosis ORDER BY COUNT(*) DESC"
6b06f9b397dbfbab8b85f6e1,Tell me the percentile of the ptt value of 30.0 among patients of the same age as patient 10038999 during the last hospital visit.,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 30.0",,[SELECT PERCENT_RANK() OVER (ORDER BY ptt) AS ptt_percentile FROM (SELECT ptt FROM labevents le JOIN admissions a ON le.hadm_id = a.hadm_id WHERE le.subject_id = (SELECT subject_id FROM labevents WHERE itemid = (SELECT itemid FROM d_items WHERE label = 'ptt') AND charttime = (SELECT MAX(charttime) FROM labevents WHERE subject_id = (SELECT subject_id FROM admissions WHERE hadm_id = (SELECT MAX(hadm_id) FROM admissions WHERE subject_id = (SELECT subject_id FROM labevents WHERE itemid = (SELECT itemid FROM d_items WHERE label = 'ptt') AND subject_id = 10038999 AND charttime = (SELECT MAX(charttime) FROM labevents WHERE subject_id = 10038999)))))) AND le.subject_id = (SELECT subject_id FROM admissions WHERE hadm_id = (SELECT MAX(hadm_id) FROM admissions WHERE subject_id = (SELECT subject_id FROM labevents WHERE itemid = (SELECT itemid FROM d_items WHERE label = 'ptt') AND subject_id = 10038999 AND charttime = (SELECT MAX(charttime) FROM labevents WHERE subject_id = 10038999))))) AND le.charttime
01fe648fde411db8cc5023ce,What is the maximum total hospital cost for a drug named vancomycin during this year?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vancomycin' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_hospital_cost) FROM drug_cost WHERE drug_name = 'vancomycin' AND date >= '2023-01-01' AND date <= CURRENT_DATE
acc3a9c211f42e9d6d154a20,What are the top five diagnoses associated with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT TOP 5 diagnosis FROM HospitalRecords WHERE date_of_admission >= DATEADD(month, -3, GETDATE()) GROUP BY diagnosis ORDER BY COUNT(death_flag) DESC;"
80583d948d18de33fb6987b2,Could you inform me about patient 10006053's first heart rate on 11/17/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '11-17' ORDER BY chartevents.charttime ASC LIMIT 1",[],[SELECT first_value(heart_rate) OVER (ORDER BY time ASC) AS FirstHeartRate
b3c8c99b83e01986b79456be,What drugs are being added to the prescription of patient 10039831 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],select pd1.drug_name from patient_drug pd1 where pd1.patient_id = 10039831 and pd1.date = CURRENT_DATE and pd1.drug_name not in (select pd2.drug_name from patient_drug pd2 where pd2.patient_id = 10039831 and pd2.date = CURRENT_DATE - 1)
8f44537ed71e3c69bfd87f37,Was patient 10004422 given any procedure in the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,SELECT EXISTS(SELECT 1 FROM procedure_occurrence WHERE person_id = 10004422 AND procedure_date BETWEEN 'YYYY-01-01' AND 'YYYY-12-31') AS HasProcedurePreviousYear
d8f6cf3bc53a60de0a9fc811,When patient 10006053 last had a mrsa screen microbiology test in the previous month?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],"SELECT MAX(test_date) AS last_mrsa_screen_date FROM microbiology_tests WHERE patient_id = 10006053 AND test_type = 'mrsa screen' AND test_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 MONTH) AND CURRENT_DATE"
659e84dd2728a7624246c318,What was the amount of potassium chl 20 meq / 1000 ml ns dose prescribed to patient 10015860 on their first hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'potassium chl 20 meq / 1000 ml ns',[{'SUM(prescriptions.dose_val_rx)': None}],select dosage from prescriptions where patient_id = '10015860' and encounter_number = 1 and medication = 'potassium chl 20 meq / 1000 ml ns'
7ebc983b2a055bd196b0257b,Tell me the average total hospital cost that involves hydrocerin in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'hydrocerin' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_hospital_cost) FROM medical_records WHERE treatment IN (SELECT treatment_id FROM treatments WHERE name = 'hydrocerin') AND year = 2100
5a217759e9fc00e289c1d8c9,What are the newly prescribed medicines for patient 10018081 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL Query
3eaf001189831be5d9a41258,"Give me the top five most frequent treatments patients received within 2 months after being diagnosed with dissection of aorta, abdominal in 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of aorta, abdominal' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,
17e15ae68d3705f96b36cfb4,What is the patient count in the hospital currently?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patients WHERE admission_date <= CURRENT_DATE AND discharge_date IS NULL
563335adf3dce85aa6c280d0,What were the top four diagnoses of patients with age 30s since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"select diagnosis, count(*) as count from patient_diagnosis where age between 30 and 39 and diagnosis_date >= '2022-01-01' group by diagnosis order by count desc limit 4;"
c7841b68bdb2089ac264a977,List the top five most common events in 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],SQL Query Here
05c7819c63aa7a68dc9545c3,How many people were given prescriptions for heparin flush (100 units/ml) since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin flush (100 units/ml)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE medication_name = 'heparin flush' AND concentration = '100 units/ml' AND prescription_date > (CURRENT_DATE - INTERVAL '1 year');
28fb3dd077aebb1daf3e9fe4,Where can i find a reimbursement standard for cerebrovascular mri?,,,SELECT * FROM reimbursement_standards WHERE service = 'cerebrovascular MRI';
39d4a4bdf91208fe3d0468a5,"What are the four most common diagnoses for patients who previously had the performance of cardiac output, continuous procedure within 2 months since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 diagnosis, COUNT(*) AS count FROM diagnoses WHERE patient_id IN (SELECT patient_id FROM procedures WHERE procedure_name = 'Cardiac Output, Continuous' AND procedure_date BETWEEN DATEADD(month, -2, '2100-01-01') AND '2100-01-01') GROUP BY diagnosis ORDER BY count DESC;"
d711ad001701aaf7a999ff6f,"How many patients had extirpation of matter from left femoral vein, percutaneous approach done during this year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,"SELECT COUNT(*) FROM medical_procedures WHERE procedure_type = 'extirpation of matter from left femoral vein, percutaneous approach' AND YEAR(procedure_date) = YEAR(CURDATE());"
5c94acc60a698d8e066b2346,Show me the top four most frequent lab tests.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT lab_test, COUNT(lab_test) AS frequency FROM lab_tests GROUP BY lab_test ORDER BY frequency DESC LIMIT 4"
68002865c7084ae451a8b103,Has patient 10026406 gone to an emergency room since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT(*)>0': 0}],SELECT visit_date FROM emergency_visits WHERE patient_id = 10026406 AND visit_date >= '2100-01-01'
79028656244bb2aab8bd8d5d,"On the first hospital stay, what was the insurance plan of patient 10006580?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,[{'insurance': 'Medicaid'}],select insuranceplan from hospital_stays where patient_id = '10006580' and stay_number = 1
e382d74ae3fcbc0d1ca3a625,When did patient 10007928 first get blood culture ( myco/f lytic bottle)'s microbiology test since 02/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND microbiologyevents.spec_type_desc = 'blood culture ( myco/f lytic bottle)' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SQL Query
3afe51cbe0baae4f9809635a,Has patient 10007818 taken a vital high protein (full) drug since 07/07/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-07'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) AS times_taken FROM prescriptions WHERE patient_id = 10007818 AND drug_name = 'Vital High Protein (Full)' AND date_prescribed >= '2100-07-07' AND is_fulfilled = TRUE
074c7225bee20e2006c6db58,When did patient 10026255 have the minimum hematocrit value the last time in 10/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '10' ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],"SELECT MIN(Value) as MinimumHematocrit, Date FROM Labs WHERE PatientID = 10026255 AND TestID = 'Hematocrit' AND Date LIKE '2023-10%' GROUP BY Date ORDER BY Date DESC LIMIT 1;"
e567aa9d37acea95bac0a52f,"What is the maximum total cost of the hospital visits, which include medicines called acetaminophen-caff-butalbital since 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetaminophen-caff-butalbital' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,select max(total_cost) from hospital_visits where medicine_name in (select distinct medicine_name from medicines where medicine_name like '%acetaminophen-caff-butalbital%') and visit_date >= '2100-01-01';
bf885e40699431f501098369,How does one disinfect a quarantine room?,,,SELECT instructions FROM disinfection_methods WHERE room_type = 'quarantine' AND step = '1' ORDER BY order_number ASC
b857d922261f995e3a1265ac,What is the price of a procedure named insertion or replacement of external ventricular drain [evd]?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) ),,SELECT price FROM medical_procedures WHERE procedure_name LIKE 'insertion or replacement of external ventricular drain%evd%' LIMIT 1
5f932af6bf46cd7718dfafc4,Can you tell me what patient 10001217's last respiratory rate was on 12/05/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-05' ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT ""respiratory_rate"" FROM ""observations"" WHERE ""patient_id"" = 10001217 AND ""observation_date"" = '12/05/2100' ORDER BY ""observation_date"" DESC, ""observation_time"" DESC LIMIT 1"
51825ade8dabf4e61477d4d8,"Since 10/2100, has patient 10039708 undergone a lab test?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10'",[{'COUNT(*)>0': 1}],SELECT COUNT(*) FROM lab_tests WHERE patient_id = 10039708 AND test_date >= '2100-10-01'
955058f5985e47dd049eded6,Provide the four most common medications in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4",[],"SELECT TOP 4 medication, COUNT(*) as frequency FROM patient_medication_history WHERE year = 2100 GROUP BY medication ORDER BY frequency DESC"
e95fcfa72f1c014d79280732,What was the first dose of metoclopramide that on the first hospital stay was prescribed to patient 10019385?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'metoclopramide' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(dose) FROM prescriptions WHERE patient_id = '10019385' AND drug_name = 'metoclopramide' AND stay_id = (SELECT MIN(stay_id) FROM stays WHERE patient_id = '10019385') AND visit_number = 1
eaa2bc139459a0e6de3f0a33,Calculate the number of hospital visits made by patient 10022017 in 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT COUNT(*) AS NumberOfVisits FROM HospitalVisits WHERE PatientID = '10022017' AND Year = 2100;
6841f0afef30c9eaf743f781,Tell me the top four most common lab tests during this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"SELECT lab_test, count(lab_test) as test_count FROM lab_tests WHERE date_of_test BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY lab_test ORDER BY test_count DESC LIMIT 4"
17de3ba481cc927f60d16233,What were the top five diagnoses that had the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT TOP 5 diagnosis, AVG(mortality_rate) as avg_mortality_rate FROM patient_records WHERE diagnosis_date BETWEEN DATEADD(month, -6, GETDATE()) AND GETDATE() GROUP BY diagnosis ORDER BY avg_mortality_rate DESC"
4f390ab9331393d06d9b9595,What was the change in rbc in patient 10018845 last measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT `vital_value` AS `last_value`, (`vital_value` - `baseline_value`) AS `change_in_rbc` FROM `labevents` WHERE `itemid` = (SELECT `itemid` FROM `d_items` WHERE `label` = 'red blood cells' AND `linksto` = 'LOINC') AND `subject_id` = 10018845 AND `hadm_id` IN (SELECT MIN(`hadm_id`) FROM `labevents` WHERE `subject_id` = 10018845) AND `charttime` = (SELECT MAX(`charttime`) FROM `labevents` WHERE `subject_id` = 10018845 AND `hadm_id` = (SELECT MIN(`hadm_id`) FROM `labevents` WHERE `subject_id` = 10018845)) AND `charttime` >= (SELECT MIN(`charttime`) FROM `labevents` WHERE `subject_id` = 10018845 AND `hadm_id` = (SELECT MIN(`hadm_id`) FROM `labevents` WHERE `subject_id` = 10018845)) ORDER BY `charttime` LIMIT 1,1)"
aef5e5dbf6c5848167e2f641,When was patient 10004720 prescribed a medication via the oral route the last time in this month?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'oral' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime DESC LIMIT 1",[],
b69ed3edc52cb224ecb174eb,What is the percentile phosphate value of 3.3 among patients of the same age as patient 10024043 during their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 3.3",,lab_result
c26f64ab0e5b645c25c3281c,"What are the total minimum expenses for a hospital involving a laboratory test for potassium, whole blood in 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT SUM(MINIMUM) AS Total_Minimum FROM LABORATORY WHERE LABORATORY.TEST_NAME = 'potassium, whole blood' AND LABORATORY.HOSPITAL_ID = ? AND YEAR = '2100'"
1a33ef0177e3bdc49dafbced,How many operating rooms are in operation now?,,,SELECT COUNT(*) FROM OperatingRooms WHERE status = 'in use';
103e589c49e80280c9f04475,When was the time of patient 10022017's first hospital discharge?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 ORDER BY admissions.dischtime ASC LIMIT 1,[{'dischtime': '2189-09-16 15:00:00'}],SELECT hospital_discharge_timestamp FROM patient_records WHERE patient_id = '10022017' ORDER BY hospital_discharge_timestamp ASC LIMIT 1
ea31f61daec8ba1d5d9fb9f8,What is the monthly average value of patient 10007928's weight in 2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)",[],SELECT AVG(weight) FROM health_records WHERE patient_id = '10007928' AND YEAR(measurement_date) = 2100 GROUP BY MONTH(measurement_date)
be8cee5520084fc21550d8bb,Has patient 10031404 visited the hospital since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10031404 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT(*)>0': 1}],SELECT COUNT(*) FROM Visits WHERE PatientID = 10031404 AND VisitDate > '2100-01-01'
4d8620a9b634b4449be0b4bd,What exactly was the last drug that patient 10021118 was prescribed since 12/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Furosemide'}],select * from prescription where patient_id = '10021118' order by date desc limit 1
f3e83011de5accbea5625903,"What are the three commonly taken specimens for patients that received excision of right saphenous vein, percutaneous endoscopic approach previously in the same hospital visit since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right saphenous vein, percutaneous endoscopic approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"select * from records where diagnosis_code = 'excision of right saphenous vein, percutaneous endoscopic approach' and specimen_date > '2100-01-01' and specimen_count >= 3 and visit_id = previous_visit_id"
0de9102ca9d14d7b275ec8b7,Tell me the cost of a procedure known as colonoscopy.,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'colonoscopy' ) ),,SELECT cost FROM procedures WHERE name = 'colonoscopy'
c66b8f121c0ec0bc328c5dad,How many medications were prescribed in 2100 to patient 10021118?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],select count(*) from prescription where patient_id = 10021118 and YEAR(prescribed_date) = 2100
972b49483131cf603f6639f5,Can you tell the daily average dose of nacl 0.9% that patient 10014354 received since 03/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-03' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],SELECT AVG(dose) FROM medical_records WHERE patient_id = '10014354' AND drug_name = 'nacl 0.9%' AND date >= '03/2100' GROUP BY DATE(date)
2f74275a2c13953fc65e324f,Count the number of medicines that have been prescribed to patient 10007928 since 03/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",[{'COUNT(*)': 69}],SELECT COUNT(DISTINCT MEDICINE) FROM MEDICINE_PRESCRIPTIONS WHERE PATIENT_ID = '10007928' AND PRESCRIPTION_DATE >= '03/2100';
72c22160d0226e69dd0c8407,Did patient 10035185 receive any diagnoses during the last hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) AS diagnosis_count FROM diagnoses WHERE patient_id = 10035185 AND visit_id = (SELECT MAX(visit_id) FROM visits WHERE patient_id = 10035185)
ba8da70ae7c876cdadf6d50e,What are the top three most frequent microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]",SQL Query
8683f07aa65fa12c04532cd7,What were the top five most common procedures that occurred within the same month for patients who had central venous catheter placement with guidance before in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT procedure, COUNT(*) as frequency FROM Procedures P1 JOIN Procedures P2 ON P1.patient_id = P2.patient_id AND MONTH(P1.procedure_date) = MONTH(P2.procedure_date) AND YEAR(P1.procedure_date) = 2100 WHERE P1.procedure_name = 'central venous catheter placement with guidance before' AND P1.procedure_date < P2.procedure_date GROUP BY P1.procedure_date, P2.procedure_name ORDER BY frequency DESC LIMIT 5"
5e2dc38de1c3863efdd5f7b6,"So, what was the last o2 saturation pulseoxymetry of patient 10004733 since 12/30/2100?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-30' ORDER BY chartevents.charttime DESC LIMIT 1",[],select top 1 o2_saturation from pulseoxymetry where patient_id = '10004733' and measurement_date > '12/30/2100' order by measurement_date desc
9650f7dfbf4442af6df9fb82,What was the name of the outputs that patient 10027445 first had on 09/10/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '09-10' ORDER BY outputevents.charttime ASC LIMIT 1 )",[],select top 1 name from outputs where patientid=10027445 and outputtime between '2023-09-01' and '2023-09-30' order by outputtime asc
ce843fac6f9ff9ab4f1d2dc3,How many hours elapsed since the last time patient 10004733 received a urobilinogen lab test on this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urobilinogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"select timestampdiff(hour, (select max(time) from labevents where person_id = 10004733 and labname = 'Urobilinogen' and visitid = (select max(visitid) from labevents where person_id = 10004733)), now()) as hours_elapsed_since_last_urobilinogen_test"
cf4eb47f352c6460fa580827,"What are the three most frequently ordered medications that patients in their 40s were prescribed during the same month after they were diagnosed with hyperlipidemia, unspecified since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperlipidemia, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 MedicationName, COUNT(MedicationID) AS TotalPrescriptions FROM MedicationPrescriptions INNER JOIN Patients ON MedicationPrescriptions.PatientID = Patients.PatientID WHERE Patients.Age BETWEEN 40 AND 49 AND Patients.Diagnosis = 'Hyperlipidemia, unspecified' AND MedicationPrescriptions.OrderDate BETWEEN DATEADD(month, -1, Patients.DiagnosisDate) AND Patients.DiagnosisDate AND Patients.DiagnosisDate > DATEADD(year, -1, GETDATE()) GROUP BY MedicationName ORDER BY TotalPrescriptions DESC"
2504708564dec501dc2fdde3,Was the platelet count value last measured on the last hospital visit of patient 10005866 less than first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",[select count(distinct hppatient_id) from (
a064cc53a6478ab0d31cb958,What was the name of the specimen test which patient 10038992 has last received in 11/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT name FROM specimen_tests WHERE patient_id = 10038992 AND test_date = (SELECT MAX(test_date) FROM specimen_tests WHERE patient_id = 10038992 AND test_date LIKE '11/2100%')
e0bdf1f255574123e3d82ebc,Did patient 10007818 go through any lab test in 07/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',labevents.charttime) = '2100-07'",[{'COUNT(*)>0': 0}],SELECT DISTINCT t.test_date FROM lab_tests t WHERE t.patient_id = '10007818' AND t.test_date LIKE '07/21%'
b589fb2df1dcb6da13ec9456,"What are the three most frequently given diagnoses for patients who had previously had hemodialysis within 2 months, in 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patient_records WHERE treatment = 'hemodialysis' AND date BETWEEN DATE_SUB('2100-01-01', INTERVAL 2 MONTH) AND '2100-12-31' GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3;"
120f063de471a96faf9b302a,"How many times did the dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic procedure take place last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of right main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,SQL Query
82c36b2b9cc4fe915955f4ec,Inform me about the total amount of patient 10010471's input since 03/19/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-19'",[{'SUM(inputevents.totalamount)': 37625.0}],SELECT SUM(Charge) AS TotalInput FROM patientCharges WHERE PatientID = 10010471 AND ChargeDate >= '03/19/2100'
76f01a85f8f50fc5f408fa3b,How many dofetilide prescription instances occurred in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'dofetilide' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM prescription_instances WHERE drug_name='Dofetilide' AND YEAR(prescription_date)=2100
7bd0fb1be2b05eacb63558d9,What do the precautions be after the spinal canal explor nec procedure?,,,select precautions from procedure_steps where procedure_name = 'spinal canal explor nec' order by step_number desc limit 1
cd7ec076d6dd032a842781fe,"Today compared to yesterday, what new medication does patient 10039831's prescription include?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQLQuery
e48b5607cc89f2dc1adfa775,What was the last time patient 10016810 was prescribed a medication using the po route since 05/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND prescriptions.route = 'po' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 prescription_date FROM prescriptions WHERE patient_id = '10016810' AND route = 'po' AND prescription_date > '2000-05-21' ORDER BY prescription_date DESC
439e2e43115263121a562994,When was the first test of patient 10005348's microbiology urine in 09/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '09' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT Date FROM LabResults WHERE PatientID = 10005348 AND TestType = 'Microbiology Urine' AND TestDate LIKE '09/%' ORDER BY TestDate ASC LIMIT 1
8b5709aba37b6339722a0855,What is the average rdw-sd value of patient 10022880 in 04/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04'",[{'AVG(labevents.valuenum)': None}],SELECT AVG(rdw_sd) FROM lab_results WHERE patient_id = 10022880 AND result_date >= '2023-04-01' AND result_date < '2023-05-01';
5459dfb5c9c49adbe57a0564,Can you tell me the average total hospital cost that involves oxycodone sr (oxycontin)?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'oxycodone sr (oxycontin)' ) GROUP BY cost.hadm_id ) AS T1,,SELECT AVG(total_hospital_cost) AS average_cost FROM claims WHERE drug_name = 'oxycodone sr (oxycontin)'
67f5a1fdc92cd01b4aedb45c,"Of the patients aged 40s this year, what are the top three most common procedures?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT TOP 3 Procedure, COUNT(*) AS ProcedureCount FROM PatientRecords WHERE Age BETWEEN 40 AND 49 AND YEAR(DateOfBirth) BETWEEN YEAR(GETDATE()) - 49 AND YEAR(GETDATE()) - 40 GROUP BY Procedure ORDER BY ProcedureCount DESC"
96a8776128757eb24aa751cc,How many admitted patients are there right now?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],
9b52e008ae7f63b3fa3eeb3d,Tell me the average total cost of a hospital visit involving hyperpotassemia since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperpotassemia' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT AVG(TotalCost) FROM HospitalVisits WHERE DiagnosisCode = 'hyperpotassemia' AND VisitDate >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR)"
c40320a8cc992e9cf6c9c807,"What does a procedure under the name destruction of right lower lung lobe, via natural or artificial opening endoscopic cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' ) )",,"select sum(cast(Proc_Cost as decimal(10,2))) from procedure_cost where upcase(procedure_name) like '%DESTRUCTION OF RIGHT LOWER LUNG LOBE%' and upper(procedure_modifier) like '%ENDOSCOPIC%'"
658f14f535401c3647d83d50,Is the alkaline phosphatase value of patient 10015860 on the last measurement on the first hospital visit greater than the value from the first measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN MAX(CASE WHEN `Measurement Date` = (SELECT MAX(`Measurement Date`) FROM `Hospital Visit 1` WHERE `Patient ID` = 10015860) THEN `Alkaline Phosphatase` END) > MIN(CASE WHEN `Measurement Date` = (SELECT MIN(`Measurement Date`) FROM `Hospital Visit 1` WHERE `Patient ID` = 10015860) THEN `Alkaline Phosphatase` END) THEN 'Yes' ELSE 'No' END AS Is_Greater FROM `Hospital Visit 1` WHERE `Patient ID` = 10015860;
e07ed121ec710b96ce8e6acd,Give me the top five most frequent treatments patients received within 2 months after being diagnosed with rheumatic disorders of both mitral and aortic valves in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'rheumatic disorders of both mitral and aortic valves' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 treatment_name, COUNT(*) AS frequency FROM Treatments INNER JOIN Patients ON Treatments.patient_id = Patients.patient_id INNER JOIN Diagnoses ON Patients.patient_id = Diagnoses.patient_id WHERE Diagnoses.condition = 'rheumatic disorders' AND Diagnoses.valve_affected IN ('mitral', 'aortic') AND Diagnoses.year = 2100 AND Treatments.date >= Diagnoses.date AND Treatments.date <= DATEADD(month, 2, Diagnoses.date) GROUP BY treatment_name ORDER BY frequency DESC"
02759807d268a649ffbc56e0,Can you tell me the total volume of foley output for patient 10018081 since 12/07/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-07'",[{'SUM(outputevents.value)': None}],select sum(Volume) from foley where patient_id = '10018081' and date > '2100-07-12';
4b895ff0d3cb5fd9fe1e5e50,What is the maximum total cost of the hospital visits that included a procedure called alcohol detoxification since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(total_cost) FROM hospital_visits WHERE procedure_name = 'alcohol detoxification' AND visit_date >= '2100-01-01';
f370a107576540264d73906f,Can you confirm the gender of patient 10015931?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10015931,[{'gender': 'M'}],SELECT gender FROM `patients` WHERE patient_id = '10015931';
39292afed1a39dd0e0b8a031,Count the number of patients who stayed during the last year at pacu.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM admissions WHERE stay_length BETWEEN 1 AND 365 AND year = 2022 AND unit='pacu'
e6f198df1f603a2a44353e4d,Could you unfold the four most frequent outputs in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"select output, count(*) as frequency from data group by output order by frequency desc limit 4"
61ac565159bfa5d3f30f2941,"What was the name of the prescription drug given to patient 10018081 within the same day after undergoing the ileostomy, not otherwise specified procedure?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ileostomy, not otherwise specified' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,"SELECT DISTINCT drug_name FROM prescriptions WHERE patient_id = 10018081 AND prescription_date = (SELECT procedure_date FROM procedures WHERE patient_id = 10018081 AND procedure_name = 'ileostomy, not otherwise specified')"
c4fbaf36df80d6e9685e37c1,When was the last time patient 10021312 had a medication prescribed via the vg route since 5 months ago?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND prescriptions.route = 'vg' AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month') ORDER BY prescriptions.starttime DESC LIMIT 1",[],"SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = 10021312 AND medication_route = 'vg' AND prescription_date > DATEADD(month, -5, GETDATE())"
d624abedfa96e75fb614fc58,What was the sw dose that patient 10016810 was first prescribed during their last hospital encounter?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'sw' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(DOSE) FROM PATIENT_MEDICATIONS WHERE PATIENT_ID = 10016810 AND VISIT_ID = (SELECT MAX(VISIT_ID) FROM PATIENT_VISITS WHERE PATIENT_ID = 10016810) AND MEDICATION_NAME = 'Sw'
1dab5b5124587cef9d328d99,Count the number of times that excision of axillary lymph node was performed.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of axillary lymph node' ),[{'COUNT(*)': 0}],SELECT COUNT(*) AS `number_of_axillary_lymph_node_excisions` FROM `surgical_procedures` WHERE `procedure_description` LIKE '%axillary lymph node excision%'
6460cd5a26ffc1b6bcc56a55,How much 0.9% sodium chloride has patient 10038999 been prescribed since 18 months ago?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND prescriptions.drug = '0.9% sodium chloride' AND datetime(prescriptions.starttime) >= datetime(current_time,'-18 month')",[{'SUM(prescriptions.dose_val_rx)': None}],
6256d1fb1cd3aeaba0eb11a8,Has patient 10009035 been prescribed a specific drug since 02/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02'",[{'COUNT(*)>0': 1}],select distinct a.drug_id from prescribes a where a.patient_id='10009035' and a.drug_id is not null and a.visit_date >='02/2100'
0b9e619bdb576876f002d49a,What is the title of the medication that was given to patient 10021118 first via the ih means during the last hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'ih' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SQLQuery1
2d745a50f391efc3dab3ccd8,What was the medication patient 10014354 was prescribed for the last time since 05/2100 via the im route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 medication FROM prescriptions WHERE patient_id = 10014354 AND route = 'im' AND prescription_date > '2100-05-01' ORDER BY prescription_date DESC
5cf80e270db47987d26f8d2c,What was the name of the output that patient 10022017 had last since 10/04/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-04' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Void'}],SELECT TOP 1 Name FROM Output WHERE PatientID = 10022017 AND OutputDate >= '2100-10-04' ORDER BY OutputDate DESC
b5f30bce905a467fe3d9be05,Has patient 10015931 received any laboratory testing since 1 month ago?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 month')",[{'COUNT(*)>0': 1}],"SELECT DISTINCT a.patient_id FROM lab_tests a WHERE a.patient_id=10015931 AND a.date>DATE_SUB(CURDATE(), INTERVAL 1 MONTH)"
12a69eaacc6a1663c3d9259f,What was the last time of input for patient 10018081 since 02/25/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-25' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2134-08-07 14:00:00'}],SELECT MAX(time_of_input) FROM patient_data WHERE patient_id = 10018081 AND time_of_input > '02/25/2100'
405a65223844faf30d226448,"Give me the top five most frequently prescribed drugs within the same month for patients in their 40s who were diagnosed with acute alcoholic intoxication in alcoholism, continuous since 1 year ago.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 drug, COUNT(*) AS prescription_count FROM prescriptions WHERE diagnosis = 'acute alcoholic intoxication' AND condition = 'alcoholism' AND continuous_since >= DATEADD(year, -1, GETDATE()) AND patient_age BETWEEN 40 AND 49 AND DATEPART(month, prescription_date) = DATEPART(month, GETDATE()) GROUP BY drug ORDER BY prescription_count DESC"
fa8dc90654adb35a8f98e8e2,"Patient 10005817, when was your last mrsa screen microbiology test since 10/2100?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],select test_date from microbiology_tests where patient_id=10005817 and test_type='mrsa_screen' and test_date > '2010-10-01'
97972bbea1fe2404f8de1b69,Please calculate the total output for patient 10027602 since 12/02/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-02'",[{'SUM(outputevents.value)': 42636.0}],SELECT SUM(output) FROM dialysis_records WHERE patient_id = '10027602' AND date >= '12/02/2100';
30912953ec6a9977cec930db,What was the admission type during patient 10038992's last entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038992 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime DESC LIMIT 1",[{'admission_type': 'SURGICAL SAME DAY ADMISSION'}],select top 1 admission_type from admissions where person_id = 10038992 order by admission_date desc
8a1a5f5b16afc5af43b04d08,"Can you retrieve the top five most frequent lab tests patients had following a diagnosis of cardiac complications, not elsewhere classified during the same month?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac complications, not elsewhere classified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 lab_tests.name AS test_name, COUNT(*) AS test_count FROM lab_tests JOIN patients ON lab_tests.patient_id = patients.id JOIN diagnoses ON patients.id = diagnoses.patient_id WHERE diagnoses.name = 'Cardiac complications, not elsewhere classified' AND lab_tests.test_date BETWEEN diagnoses.diagnosis_date AND DATEADD(month, 1, diagnoses.diagnosis_date) GROUP BY lab_tests.name ORDER BY test_count DESC"
be836b4ae0b043e2a4a3ff81,"Among patients diagnosed with diastolic heart failure, unspecified , what are the top three most common lab tests that followed afterward in the same hospital encounter?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diastolic heart failure, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,"select test_id, count(test_id) from labevents join diagnoses_icd on labevents.subject_id = diagnoses_icd.subject_id and labevents.hadm_id = diagnoses_icd.hadm_id and labevents.icustay_id = diagnoses_icd.icustay_id where diagnoses_icd.icd9_code = '4280' and labevents.charttime > diagnoses_icd.charttime group by test_id order by count(test_id) desc limit 3"
2dab95be5e31c24b8faf79af,How many days was patient 10020944 in the intensive care unit during their first visit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 9.076828703749925}]","SELECT SUM(DATEDIFF(day, AdmitDate, DischargeDate)) as TotalICU_Days FROM ICUStays WHERE PatientID = 10020944 AND VisitNumber = 1"
241a6bd6f1e129a31b43bea9,Did patient 10021938 go through a lymphocytes test in the last month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",[{'COUNT(*)>0': 0}],"SELECT * FROM lab_tests WHERE patient_id = 10021938 AND test_name = 'lymphocytes' AND test_date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH)"
a5e8f7d9e725fdd3e6eced18,When did patient 10011398 get inputs for the first time since 12/11/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-11' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2146-12-15 12:30:00'}],select * from patient_input where patient_id = '10011398' and input_date > '12/11/2100' order by input_date asc limit 1
7041b79655fa30e1c31b1c57,How many drugs have been prescribed to patient 10019777 since 03/2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03'",[{'COUNT(*)': 154}],SELECT COUNT(DISTINCT drug_name) AS drug_count FROM prescriptions WHERE patient_id = '10019777' AND prescription_date >= '03/2100';
7d5c2f5180cb8edef4ee7d95,Calculate the number of hospital visits made by patient 10036156 during this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10036156 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT COUNT(*) as NumberOfVisits FROM HospitalVisits WHERE PatientID = 10036156 AND YEAR(VisitDate) = YEAR(CURRENT_DATE)
7fd1121ddb007a49e5ed2f4c,How much was the difference in weight of patient 10029291 measured at 2100-03-07 03:00:00 compared to the value measured at 2100-03-05 00:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-07 03:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-05 00:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-07 03:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-05 00:00:00' )"": None}]",SELECT ABS(a.weight - b.weight) FROM measurements a JOIN measurements b ON a.patient_id = b.patient_id WHERE a.patient_id = 10029291 AND a.measurement_time = '2100-03-07 03:00:00' AND b.measurement_time = '2100-03-05 00:00:00'
6eaa704e430235558d82f887,Count the total patients who were prescribed clonidine patch 0.2 mg/24 hr this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'clonidine patch 0.2 mg/24 hr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],
7418b9331c35714137e940b5,When did patient 10023117 receive a mcv lab test on the first occasion?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) ORDER BY labevents.charttime ASC LIMIT 1,[],select top 1 date from mcv_tests where patient_id = 10023117 order by date
0427a5eaa446635b1a4b7f18,How much is the difference of patient 10015272's respiratory rate second measured on the first ICU visit compared to the value first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT patientunitstayid, visitnumber, valuenum FROM `physionet-data.mimiciii_clinical.icustays` WHERE `itemid` = 211 AND `subject_id` = 10015272 AND visitnumber = 1 ORDER BY `charttime` ASC LIMIT 2;"
be691057d7c16aac7ebabc58,Using the other anticancer drugs is the protocol of the anticancer drugs,,,select protocol from other_anticancer_drugs
45cf62bc8aba279eba7b413a,What is the patient count for sotalol prescription since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'sotalol' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 10}],SELECT COUNT(DISTINCT patient_id) AS patient_count FROM prescriptions WHERE drug_name = 'sotalol' AND date_prescribed >= '2100-01-01'
567d369cd559cd950e3354cf,"Since 1 year ago, what are the three common diagnoses of patients of age 20s?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT TOP 3 diagnosis, COUNT(diagnosis) AS frequency FROM patient_records WHERE age BETWEEN 20 AND 29 AND diagnosis_date >= DATEADD(year, -1, GETDATE()) GROUP BY diagnosis ORDER BY frequency DESC"
b179e910614a955e056b279f,What is the maximum total hospital cost including a drug named vitamin d since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'vitamin d' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,"[SELECT MAX(totcost) FROM (SELECT patient_id, sum(los + totcost) AS totcost FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT a.*, b.cost AS los FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM admissions AS a LEFT JOIN diagnoses_icd AS b ON a.icd9_code = b.icd9_code AND a.hadm_id = b.hadm_id) LEFT JOIN drg_definitions AS c ON a.drg_code = c.drg_code) LEFT JOIN (SELECT b.person_id, b.hadm_id, b.seq_num, b.icd9_code, a.service, a.startdate AS service_startdate, a.enddate AS service_enddate FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT"
c4b38e4af79858745e77342a,Calculate the total volume of patient 10014729's input since 03/06/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-06'",[{'SUM(inputevents.totalamount)': 21490.0}],SELECT SUM(volume) FROM patient_input WHERE patient_id = 10014729 AND input_date >= '2100-03-06'
73df5b035a5cac7c093f1211,Calculate patient 10013049's length of stay in days for the first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.1769212959334254}]","SELECT DATEDIFF(day, MIN(EDVISIT_ENDTIME), MAX(EDVISIT_ENDTIME)) FROM EMERGENCY_DEPARTMENT WHERE PATID = 10013049 AND EDVISIT_ENDTIME IS NOT NULL GROUP BY PATID HAVING MIN(EDVISIT_ENDTIME) = (SELECT MIN(EDVISIT_ENDTIME) FROM EMERGENCY_DEPARTMENT WHERE PATID = 10013049)"
9605044db0cc93ca8e59d0be,What is the reimbursement standard for drug?,,,select reimbursement from drug_bnf where name= ?
5a47ea8047b87b5f311738fc,How many times was a excision of dental lesion of jaw procedure done in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,Your SQL query here
2d80cb1e489c0421c68be6f2,How many hours has it been since patient 10021487 last received the red blood cells lab test during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(hour, MAX(STARTED), GETDATE()) FROM LAB_TEST WHERE PATIENT_ID = '10021487' AND LAB_TEST_NAME = 'Red Blood Cells' AND ENCOUNTER_ID = (SELECT ENCOUNTER_ID FROM PATIENT_ENCOUNTER WHERE PATIENT_ID = '10021487') AND END_DATE IS NULL"
39f61d8cb6ee0e63eed2c0c1,Did patient 10035185 receive any disease diagnoses in their last hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) FROM disease_diagnoses WHERE patient_id = 10035185 AND hospital_visit_id = (SELECT MAX(hospital_visit_id) FROM hospital_visits WHERE patient_id = 10035185)
ae7068db15837f529f79fa01,Share the five most frequently performed procedures since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT procedure_code, COUNT(procedure_code) AS procedure_count FROM procedures WHERE procedure_date > CURRENT_DATE - INTERVAL '1 year' GROUP BY procedure_code ORDER BY procedure_count DESC LIMIT 5"
73752639a8e1cbb92081f23b,What is the average total hospital cost which includes a drug named ezetimibe since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ezetimibe' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SQL Query
3aa3f14b20280118b146135d,What was the first hematocrit reading during the last hospital visit for patient 10019385?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1,[],SELECT hct_value FROM lab_results WHERE patient_id = 10019385 AND visit_date = (SELECT MAX(visit_date) FROM lab_results WHERE patient_id = 10019385) ORDER BY test_time ASC LIMIT 1
84ba0d560e8d6b40089569b5,"Was patient 10005909 prescribed with the medication enoxaparin sodium, docusate sodium, or 5% dextrose in their last hospital visit?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'enoxaparin sodium', 'docusate sodium', '5% dextrose' )",[{'COUNT(*)>0': 0}],"SELECT patient_id, medication_name FROM prescriptions WHERE patient_id = '10005909' AND medication_name IN ('enoxaparin sodium', 'docusate sodium', '5% dextrose') AND visit_date = (SELECT MAX(visit_date) FROM visits WHERE patient_id = '10005909');"
30c85360417e25270068544b,Present the count of ICU visits for patient 10004422 since 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND strftime('%Y',icustays.intime) >= '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 1}],select count(1) from i2b2metadata.encounter_fact where patient_num = 10004422 and (encounter_type_cd = 'ICU' or encounter_type_cd = 'Critical Care') and adm_date >= '2100-01-01'
d487fac15a8ce3ed54ed440e,What was the four most common lab test given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT test, COUNT(*) AS test_count FROM lab_tests GROUP BY test ORDER BY test_count DESC LIMIT 4"
008eed7a13c0d37c26d9a293,Get me the top five most frequent diagnoses for patients of age 50s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"select diagnosis, count(*) as frequency from (select diagnosis, patient_age from healthcare_data where year = 2100 and patient_age between 50 and 59) as age_filtered group by diagnosis order by frequency desc limit 5"
1f1add74c7e3a0f4247c5a78,"So, what was the first respiratory rate of patient 10015272 on 06/23/this year?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '06-23' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT respiratory_rate FROM patient_vitals WHERE patient_id = '10015272' AND date_time::date = '2023-06-23' ORDER BY date_time ASC LIMIT 1
9906646cfa86ce749ac4d08e,What methods are used to ingest tramadol?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'tramadol',[{'route': 'ORAL'}],SELECT `methods` FROM `ingestion_methods` WHERE `drug` = 'tramadol';
db0532f93811b5c3527eb224,During a blood transfusion has patient 18866 ever experienced any side effects?,,,SELECT CASE WHEN EXISTS(SELECT 1 FROM SideEffects WHERE PatientID = 18866) THEN 'Yes' ELSE 'No' END AS ExperiencedSideEffects
92628b8e1f9f488eca11c7ea,How much is the average total hospital cost associated with closed fracture of lumbar vertebra without mention of spinal cord injury?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of lumbar vertebra without mention of spinal cord injury' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT AVG(total_hospital_cost) FROM inpatient WHERE diagnosis = 'closed fracture of lumbar vertebra' AND mention_of_spinal_cord_injury = 'no'
83ee51e6e7fdc992ab579780,What was the drug prescribed to patient 10027602 for the last time via the pr route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND prescriptions.route = 'pr' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT TOP 1 drug FROM prescriptions WHERE patient_id = 10027602 AND route = 'pr' ORDER BY prescription_date DESC
781ef8abeed146047598411d,Can you tell me how many extracorporeal circulation auxiliary to open heart surgery procedures were done in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,select count(*) as procedure_count from extracorporeal_circulation_procedures where procedure_type = 'auxiliary to open heart surgery' and year = 2100
c87fdda7e48ed877eae86d9a,Has there been any organism found in the first microbiological pleural fluid test of patient 10014729 since 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y',microbiologyevents.charttime) >= '2100' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)>0': 0}],"select * from (select organism, test_date, patient_no, count(1) over(partition by patient_no) as count from microbiology where patient_no = 10014729 and test_type = 'pleural fluid' and test_date >= '2100-01-01' and organism != 'none' and test_result = 'positive') as t where t.count = 1"
0548ea40a64c517f125a4be7,When did patient 10021487 get input for the last time since 12/14/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-14' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2117-03-09 14:20:00'}],SELECT MAX(input_date) FROM patient_records WHERE patient_id = 10021487 AND input_date >= '12/14/2100'
ef941c1feaedb7696f5f3fda,When did patient 10005817 first leave the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005817 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2132-12-20 15:04:00'}],SELECT MIN(discharge_date) FROM hospital_stays WHERE patient_id = '10005817'
b6084da68e989df297fd4021,Tell me the name of an output that patient 10007818 has first had since 06/08/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-08' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Foley'}],SELECT output_name FROM outputs WHERE patient_id = 10007818 AND output_date >= '2100-06-08' ORDER BY output_date ASC LIMIT 1
26befa90776e4ef7c35488fc,What were the top five diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"select d.dx, d.dx_id, d.name, d3m.mortality, count(p.pid) as patient_count from dx d, (select dx_id, mortality from (select dx_id, count(distinct pid) as num_died, count(distinct pid) as num_all from dx dx, pdx pdx where pdx.dx_id = dx.dx_id and pdx.admit_year = 2010 and pdx.admit_month >= 10 and pdx.admit_month <= 12 group by dx_id) x where num_died / num_all > 0.1) d3m where d.dx_id = d3m.dx_id order by d3m.mortality desc limit 5"
299e7e4682125161d8892193,Give me patient 10027602's total amount of nacl 0.45% input during their last ICU visit.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.45%' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],select sum(amount) from chartevents where itemid in (select itemid from d_items where label='nacl 0.45%') and subject_id=(select subject_id from icustays where subject_id=(select subject_id from admissions where hadm_id=(select max(hadm_id) from icustays where subject_id=(select subject_id from chartevents where icustay_id=(select max(icustay_id) from icustays where subject_id=(select subject_id from admissions where hadm_id=(select max(hadm_id) from icustays where subject_id=(select subject_id from chartevents where subject_id=10027602)))))))) and (value=1 or value='1'))
d4d40dd78c364c6f666d1a05,What percentile does a platelet count value of 328.0 for patient 10023117 place in today on the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10023117 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 328.0",,Your SQL query here
059ed55281d42669ad25d514,"For the first time in the previous month, what was the drug that patient 10019172 was prescribed via iv drip route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.route = 'iv drip' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT drug_name FROM prescriptions WHERE patient_id = 10019172 AND route = 'iv drip' AND MONTH(prescription_date) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH) AND YEAR(prescription_date) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH) ORDER BY prescription_date ASC LIMIT 1
d11f27c0322c15dc8f10c8b2,What is the reimbursement standard for cerebrovascular mri?,,,SELECT reimbursement FROM medical_procedures WHERE procedure_name = 'cerebrovascular MRI'
b9810aef8d75d1d2a9a31183,"In relation to others of the same age, where does a hemoglobin value of 12.2 for patient 10021487 rank in percentiles on this hospital encounter?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ) ) AS T1 WHERE T1.valuenum = 12.2",,select percentile_cont(0.5) within group (order by hemoglobin) from lab_encounter where patient_id = 10021487 and hemoglobin = 12.2 and hemoglobin is not null and encounter_date between '2011-01-01' and '2011-12-31' and age between 35 and 45 and (encounter_type = 'EMERGENCY' or encounter_type = 'URGENT')
bad5c823a031437e5a7ff621,What was the last measurement of o2 saturation pulseoxymetry in patient 10015931's body since 10/01/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-10-01' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT TOP 1 `o2_saturation_pulseoxymetry` FROM `patient_data` WHERE `patient_id` = 10015931 AND `measurement_date` >= '10/01/2100' ORDER BY `measurement_date` DESC
70628d63be371358ecd526de,Which medication was patient 10009628 prescribed during the same hospital encounter following the extracorporeal circulation auxiliary to open heart surgery procedure in 10/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '10' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"select medication_name from prescriptions where patient_id = 10009628 and encounter_id in (select encounter_id from procedures where procedure_name = ""extracorporeal circulation auxiliary to open heart surgery"" and date_of_procedure like ""10/%"") and date_prescribed > (select date_of_procedure from procedures where procedure_name = ""extracorporeal circulation auxiliary to open heart surgery"" and patient_id = 10009628 and date_of_procedure like ""10/%"")"
83c534985f90fb45936d3f90,What was the total dose of lisinopril prescribed to patient 10005817 in their first hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'lisinopril',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(Quantity) FROM Line WHERE PersonId = '10005817' AND NationalDrugCode = '000002570' AND EncounterId IN (SELECT EncounterId FROM Encounter WHERE PersonId = '10005817' ORDER BY EncounterId LIMIT 1)
47b4b008bc5e93c16c231277,Can you give me patient 10021118's daily maximum lr input in 12/2100?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],SELECT MAX(lr_input) FROM patient_data WHERE patient_id = 10021118 AND date BETWEEN '2100-12-01' AND '2100-12-31';
133bff217be024035d5957e2,Was the urea nitrogen value last measured on the first hospital visit of patient 10027445 greater than first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","select top 1 case when a.result > b.result then 'Yes' else 'No' end from lab_results a inner join lab_results b on a.encounter_id = b.encounter_id where a.lab_test = 'Urea Nitrogen' and b.lab_test = 'Urea Nitrogen' and a.patient_id = '10027445' and b.patient_id = '10027445' and b.lab_result_datetime < a.lab_result_datetime order by b.lab_result_datetime desc, a.lab_result_datetime desc"
9ab4162dbb0abdcc190c4d21,What did patient 10018845 have last as the output since 279 days ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-279 day') ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],"SELECT `Last Output` FROM patient_records WHERE patient_id = 10018845 AND record_date >= DATE_SUB(CURDATE(), INTERVAL 279 DAY)"
988d06c4434babbd7c78a275,"Has patient 10016742 gone through a urea nitrogen, urine test in 07/this year?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'",[{'COUNT(*)>0': 0}],"[select distinct ""encounter"".""id"""
249cf2ffc11ec1d31980296c,What was patient 10018081's last input time since 11/26/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-26' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2134-08-07 14:00:00'}],SELECT MAX(input_time) AS last_input_time FROM patient_data WHERE patient_id = '10018081' AND input_time >= '2021-11-26'
dce18218fbb62e3b07c34441,Has there been any diagnosis that patient 10020306 has received?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ),[{'COUNT(*)>0': 1}],SELECT * FROM `diagnoses` WHERE patient_id = 10020306;
f6066d140303a698b6edceea,"How many extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic treatments were executed since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from right lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,select count(*) from [procedure
adf57bf6800cbd7a1bcce75f,"When was the first time on the last hospital encounter that patient 10014078 had the maximum value of osmolality, measured?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, measured' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],SELECT MAX(osmolality_date) FROM hospital_encounters WHERE patient_id = '10014078' AND encounter_id = (SELECT MAX(encounter_id) FROM hospital_encounters WHERE patient_id = '10014078') AND osmolality = (SELECT MAX(osmolality) FROM hospital_encounters WHERE patient_id = '10014078' AND encounter_id = (SELECT MAX(encounter_id) FROM hospital_encounters WHERE patient_id = '10014078'))
c509b3b51764a1c88c5721c0,When did patient 10022017 first leave the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2189-09-16 15:00:00'}],SELECT MIN(discharge_date) AS first_discharge_date FROM hospital_stays WHERE patient_id = 10022017;
3db50784b5c5fd5267669673,How many days have elapsed since patient 10039831 stayed in the careunit discharge lounge for the first time in the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT DATEDIFF(CURRENT_DATE, MIN(stay_date)) AS days_elapsed FROM careunit_stays WHERE patient_id = 10039831 AND careunit_name = 'discharge lounge' AND visit_id = (SELECT visit_id FROM visits WHERE patient_id = 10039831 ORDER BY visit_start_date DESC LIMIT 1);"
0f89bd1a01e56d8d8578cd27,When did the last input for patient 10001217 occur since 10/02/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-02' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2157-12-20 14:00:00'}],SELECT MAX(InputTime) FROM PatientInputs WHERE PatientID = 10001217 AND InputTime >= '2100-10-02';
350181bd71c310c99e34da39,What is the difference between weights second measured on the first hospital visit compared to the first value measured on the first hospital visit for patient 10008454?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","select weight from patient_visits where patient_id = '10008454' order by visit_date limit 1, 1"
16db3d465f88c900b68652e7,Can you tell me the first time patient 10018081 had a SaO2 that was less than 98.0 since 354 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 98.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-354 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(MeasurementTime) as FirstLowSaO2Time FROM Measurements WHERE PatientID = 10018081 AND SaO2 < 98.0 AND MeasurementTime >= DATEADD(day, -354, GETDATE())"
1f2e37aaa091d50e833afad1,What was the admission type for patient 10026255's last entry into the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10026255 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1",[{'admission_type': 'EW EMER.'}],SELECT TOP 1 admission_type_description FROM ADMISSIONS WHERE patient_id = '10026255' ORDER BY admission_date DESC
e65459f8f7e59ea27494cb7b,Tell me the total number of patients who stayed in neuro stepdown in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND strftime('%Y',transfers.intime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM `admissions` WHERE `unit` = 'neuro stepdown' AND YEAR(`admission_date`) = 2100;
298e26144b0f329a5a0615a2,What was the name of the output patient 10022880 last had in their first ICU visit?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY outputevents.charttime DESC LIMIT 1 ),[{'label': 'Void'}],SELECT last_name FROM patient_icu WHERE patient_id = 10022880 AND visit_number = 1
adb4dc30adc6acdfe49dc9c0,"Compared to last measured on the first ICU visit, is the arterial blood pressure mean value of patient 10005817 less than second to last measured on the first ICU visit?",SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",[select case when a.arterial_blood_pressure < b.arterial_blood_pressure then 'true' else 'false' end as is_less_than
998714278a267519fc47473b,"Since 22 months ago, what was patient 10038933's first weight measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-22 month') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT `measurement_date`, `weight` FROM `patient_measurements` WHERE `patient_id` = '10038933' AND `measurement_type` = 'weight' AND `measurement_date` <= NOW() - INTERVAL 22 MONTH ORDER BY `measurement_date` ASC LIMIT 1;"
21c6f3b0cb788bda4faf8249,Tell me the number of patients who stayed in med/surg/gyn.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) AS number_of_patients FROM patient_admissions WHERE department IN ('med', 'surg', 'gyn') GROUP BY patient_id"
574263846551eca2f19ac645,What was the name of the output patient 10015931 first had since 06/06/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-06' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'OR EBL'}],SELECT name FROM output WHERE patient_id = 10015931 AND had_since = '06/06/2100' ORDER BY had_since DESC LIMIT 1
506c9dbd5d01f2cf98f45ec5,List the top five most frequent lab tests during this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],"SELECT test_name, COUNT(*) as frequency FROM lab_tests WHERE YEAR(test_date) = YEAR(CURRENT_DATE) GROUP BY test_name ORDER BY frequency DESC LIMIT 5;"
6cc5dc7c9bdf2cc361bd3a79,"What is the price of the drug, nystatin oral suspension?",SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'nystatin oral suspension' ),,SELECT Price FROM Drugs WHERE Name = 'nystatin oral suspension'
1696ad4b19442533de0141ff,"How many patients received enteral infusion of concentrated nutritional substances within the same month after being diagnosed with cerebral artery occlusion, unspecified with cerebral infarction?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral artery occlusion, unspecified with cerebral infarction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"select count(distinct a.patient_id) from A as a inner join B as b on a.patient_id = b.patient_id inner join C as c on a.patient_id = c.patient_id where a.date_of_diagnosis between c.date_of_infusion - interval '1 month' and c.date_of_infusion and b.substance_type = 'concentrated nutritional substances' and a.diagnosis = 'cerebral artery occlusion, unspecified with cerebral infarction' and a.date_of_diagnosis <= c.date_of_infusion"
762749a6a8452aa83554f391,"On 04/04/2100, when did patient 10020740 receive an input for the first time?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-04-04' ORDER BY inputevents.starttime ASC LIMIT 1",[],SELECT MIN(time) FROM [ICU_Collab Database
ab584de115671b8402117e00,How many patients were given hydroxychloroquine sulfate prescriptions during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'hydroxychloroquine sulfate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],[SELECT COUNT(*) AS NumberOfPrescriptions
694ecac71896531f9afc039a,What was the medication patient 10021118 was prescribed for the last time via im since 10/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT MAX(medication) FROM prescriptions WHERE patient_id = '10021118' AND route = 'im' AND date > '10/2100' GROUP BY patient_id
0e5f94ff7f2b90800950a848,"For patient 10018081, how many hours have passed since the first diagnosis with unspecified essential hypertension during their current hospital visit?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,SELECT EXTRACT(EPOCH FROM (MAX(date) - MIN(date))/3600) FROM patient_visit WHERE patient_id = 10018081 AND diagnosis = 'unspecified essential hypertension' AND visit_status = 'current'
464395597c069391d5a6f398,Show us the top three most common microbiology tests in this year.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3",[],
75349759bb3df71a7b6f7649,When was the last time patient 10038081 was prescribed medication via the iv route in 10/this year?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1",[],select max(medication_date) from prescriptions where patient_id = 10038081 and route = 'iv' and MONTH(prescription_date) = 10 and YEAR(prescription_date) = YEAR(CURRENT_DATE)
fe2ca53dea49bfb8f192692f,What was the first measurement of arterial blood pressure diastolic that patient 10005817 had?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],"[SELECT TOP 1 systolic, diastolic, heart_rate, visit_date"
ad25eb02b71d4d267ce0abfc,Can you tell me the id of patient 1372's ward that he or she may be admitted to?,,,SELECT ward_id FROM wards WHERE patient_id = 1372;
47f5715cbbaf2be1e8505994,When was the first time in which patient 10039831 had the minimum respiratory rate since 253 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-253 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",[],SELECT MIN(record_time) AS min_respiratory_time FROM patient_records WHERE patient_id = '10039831' AND respiratory_rate = (SELECT MIN(respiratory_rate) FROM patient_records WHERE patient_id = '10039831' AND record_time >= NOW() - INTERVAL '253 days') AND record_time >= NOW() - INTERVAL '253 days'
ad9324e51fa0e24a795cc9c7,Tell me the difference in the systolic blood pressure value for patient 10020944 second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT first_value, second_value, (second_value - first_value) AS difference FROM (SELECT MIN(measurement_time) as first_time, MAX(measurement_time) as second_time FROM labevents WHERE subject_id = 10020944 AND itemid = '5080' AND measurement_concept_id = 38000280 AND (measurement_time BETWEEN '2020-01-01 00:00:00' AND '2020-12-31 23:59:59') GROUP BY subject_id) AS time_order JOIN labevents ON (labevents.subject_id = 10020944 AND labevents.itemid = '5080' AND labevents.measurement_concept_id = 38000280 AND labevents.measurement_time IN (first_time, second_time)) AS ordered_values ON labevents.subject_id = time_order.subject_id"
2da4a2b003a50f04b2d7623f,What was the name of that output that patient 10039831 last had since 19 days ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND datetime(outputevents.charttime) >= datetime(current_time,'-19 day') ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],SELECT * FROM `output` WHERE `patient_id` = 10039831 AND `date` <= NOW() - INTERVAL 19 DAY ORDER BY `date` DESC LIMIT 1
a803aa24d51a01da7f6a534e,"Since 2100, how many arteriography of cerebral arteries procedures were there?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT COUNT(*) FROM `procedure_occurrence` WHERE `procedure_concept_id` = 312378 AND `occurrence_date` >= '2100-01-01'
b90aaff4f6dc54dd7eefdaae,What are the five most frequent microbiology tests since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]","SELECT test, COUNT(*) AS frequency FROM microbiology_tests WHERE year >= 2100 GROUP BY test ORDER BY frequency DESC LIMIT 5"
6866d0c0c9db304d897bd1b8,What was the name of the organism that was found in the last microbiology test on patient 10007795's abscess?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],SELECT DISTINCT microbiology_test_results.organism_name FROM microbiology_test_results WHERE microbiology_test_results.patient_id = 10007795 AND microbiology_test_results.location = 'abscess' ORDER BY microbiology_test_results.test_date DESC LIMIT 1
732c03e81ef4b688df802e29,How many days was patient 10019172's last stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.4558912040665746}]","select count(distinct date) from icustays where icustay_id=(select icustay_id from icustays where subject_id=10019172 order by intime desc, outtime desc limit 1)"
d555deebd511e5b4c5c57695,"On 07/03/2100, did patient 10007818 have any input of dextrose 5%?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-07-03'",[{'COUNT(*)>0': 0}],SELECT * FROM patient_treatments WHERE patient_id = '10007818' AND treatment_date = '2100-07-03' AND treatment LIKE '%dextrose 5%' AND input = TRUE
5eabde65a4146642bc2431c9,How many patients in 2100 were prescribed metronidazole (flagyl)?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'metronidazole (flagyl)' AND strftime('%Y',prescriptions.starttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from prescriptions where drug='metronidazole' and year=2100
fc3894dd76e5cc3a753eedfb,What is the reimbursement standard for genetic and chromosomal testing?,,,SELECT reimbursement_standard FROM genetichandchromosometesting LIMIT 1
66f0e9afff14db4b814ca058,"When was patient 10004422's last maximum cholesterol, total value on their last hospital encounter?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, total' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],"[SELECT MAX(e.encounter_datetime) AS last_encounter, MAX(c.value_as_number) AS max_cholesterol_total"
b755ff2035aac255f467595c,So tell me what to do before you go for hemodialysis.,,,SELECT pre_hemodialysis_instructions FROM hemodialysis_routine WHERE patient_id = <Patient ID>
3a7b1ab9c06a0e50231e8017,What is the yearly minimum value of patient 10020944's weight?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y',chartevents.charttime)",[],SQL query to find the yearly minimum weight for patient 10020944
e71755ea81b230d5dd2a212d,"What were the five most frequently diagnosed microbiology tests for patients who were diagnosed with sciatica, unspecified side before within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'sciatica, unspecified side' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"SELECT test_name, COUNT(*) as frequency FROM microbiology_tests WHERE patient_diagnosis = 'sciatica, unspecified side' AND diagnosis_date >= DATE_SUB(NOW(), INTERVAL 2 MONTH) GROUP BY test_name ORDER BY frequency DESC LIMIT 5"
620be6a2707f02d1b5444ed9,Could you list the monthly minimum piggyback input of patient 10011398 since 12/22/2100?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-22' GROUP BY strftime('%Y-%m',inputevents.starttime)",[],"SELECT month, MIN(piggyback_input) FROM patient_data WHERE patient_id = '10011398' AND date >= '12/22/2100' GROUP BY month"
7a49c6dcd4b96553b57013d0,What is the minimum total hospital cost to include a drug called nicardipine iv since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nicardipine iv' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,select min(total_hospital_cost) from drug_costs where drug_name='nicardipine iv' and year >= 2100
3eb6d37c0b82ceb5b2df547e,How is ranitidine (liquid) typically taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ranitidine (liquid)',[],SELECT route FROM `formulation` WHERE generic_name = 'ranitidine' AND form = 'liquid'
8dc71388fea9c3fd6452055a,Has there been any organism detected in the last microbiological examination of patient 10019172's urine on the first hospital visit?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'COUNT(*)>0': 0}],SELECT COUNT(*) AS DetectionCount FROM MicrobiologicalExamination WHERE PatientID = '10019172' AND SampleType = 'Urine' AND HospitalVisit = 1 AND Detection IS NOT NULL
92b7fb1f0888976bb221ed1d,List the preparations for cv cath plcmt w guidance,,,"SELECT DISTINCT p1.""Name"" FROM procedure p1 WHERE p1.""Name"" LIKE '%cv%cath%plcmt%w%guidance%' UNION SELECT DISTINCT p2.""Name"" FROM procedure p2 WHERE p2.""Name"" LIKE '%cv%cath%plcmt%w%guidance%' AND p2.""Name"" NOT LIKE '%without%guidance%'"
3bf09c03de716a687fc51856,What percentile is 0.69 on a troponin t test among patients of the same age as patient 10002495 in their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 0.69",,SELECT PERCENT_RANK() OVER (ORDER BY troponin_t) AS percentile
26c74839913ab4510813fb05,What is the value of patient 10010471's daily average nacl 0.9% input since 12/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],SELECT AVG(nacl_0_9_input) FROM `physionet-data.mimiciii_clinical.inputevents_cvte` WHERE patientunitstayid = 10010471 AND date BETWEEN '2100-12-21' AND '2100-12-22'
975c987c6333e4a188a0a375,When was patient 10016150 prescribed with a drug via the oral route for the last time?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'oral' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT MAX(STARTDATE) FROM LABEVENTS WHERE SUBJECT_ID='10016150' AND SPECIMEN='Oral drug' AND ROUTE='oral' AND CATEGORY='medication'
be05d63abe091e094958fc47,How many patients stayed in careunit medicine in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT PatientID) FROM PatientRecords WHERE CareUnit = 'Medicine' AND YEAR(AdmissionDate) = YEAR(CURRENT_DATE)
93fdc53c054b08a886a68474,What was the total rosuvastatin calcium dose prescribed for patient 10039997 since 08/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND prescriptions.drug = 'rosuvastatin calcium' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(DOSE) AS TOTAL_DOSE FROM prescriptions WHERE patient_id = '10039997' AND drug_name = 'rosuvastatin calcium' AND prescription_date >= '2100-08-01' AND prescription_date <= '2100-08-31'
f235f99faeb9fd03302dd63c,Get me the top four most frequent events since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]","SELECT Event, COUNT(*) AS Frequency FROM Events WHERE EventDate >= DATEADD(YEAR, -1, GETDATE()) GROUP BY Event ORDER BY Frequency DESC LIMIT 4"
45153a5a7e5066d969dc5e94,What was the three most common lab test given in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],"SELECT TOP 3 lab_test_name, COUNT(*) AS test_count FROM lab_tests WHERE YEAR(test_date) = 2100 GROUP BY lab_test_name ORDER BY test_count DESC"
01bb1845215fb7cc77678534,When did patient 10021118 receive urine microbiology test the last time?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'urine' ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],select max(test_date) from laboratory_tests where patient_id = 10021118 and test_type = 'Urine Microbiology'
3f52f0b4c069263ecd9729b0,How many hours have elapsed since patient 10018081 first received a lactate lab test during this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"[SELECT SUM(TIMESTAMPDIFF(HOUR, lab_tests.date, NOW())) AS total_hours"
b02b2e4bfa20498bce6b232d,What were the four most commonly given diagnoses for patients who had received diagnostic ultrasound of digestive system before within 2 months in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"[SELECT diagnosis, count(*) as frequency"
50231ace46e9680780376e5f,Give me the top three most frequent procedures that patients were given within the same hospital visit after receiving parenteral infusion of concentrated nutritional substances in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'parenteral infusion of concentrated nutritional substances' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT Procedure, COUNT(*) as Frequency FROM medical_records WHERE AdmissionDate BETWEEN '2100-01-01' AND '2100-12-31' AND ParenteralNutrition = 'Yes' GROUP BY Procedure ORDER BY Frequency DESC LIMIT 3"
f97a37d5ea7b54467da5e351,What was the last value of arterial blood pressure systolic patient 10035185 had on 05/19/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-05-19' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT MAX(systolic_bp) FROM patient_vitals WHERE patient_id = 10035185 AND date = '2100-05-19'
ba0e6ef5be18634efe802c90,How many patients stayed at the med/surg/gyn?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS patient_count FROM admissions WHERE location IN ('med/surg', 'gyn')"
fb100dfee04065d29677af93,Tell me the last output of patient 10016742 on 07/22/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-07-22' ORDER BY outputevents.charttime DESC LIMIT 1 )",[],"SELECT `output` FROM `patient_data` WHERE `patient_id` = 10016742 AND `date` = '07/22/2100' ORDER BY `date` DESC, `time` DESC LIMIT 1"
46beded22d8893f7ce7fbb8d,Show me the top five most frequent lab tests since 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT TOP 5 LabTestName, COUNT(*) AS Frequency FROM LabTests WHERE TestDate >= '2100-01-01' GROUP BY LabTestName ORDER BY Frequency DESC;"
63963fa9f83cbade78c334a0,Can you count how many operating rooms there is now,,,SELECT COUNT(*) FROM OperatingRoom
43731ce15c8a2d2bccfff70e,What was the five most common microbiology test conducted since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}, {'test_name': 'GRAM STAIN'}]","SELECT test_type, COUNT(*) AS test_count FROM microbiology_tests WHERE test_date >= DATEADD(year, -1, GETDATE()) GROUP BY test_type ORDER BY test_count DESC LIMIT 5"
e18a2d8bc4701233c6f71e19,What is the cost of a diagnosis for other cirrhosis of liver?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other cirrhosis of liver' ) ),,SELECT cost FROM diagnoses WHERE description = 'Other cirrhosis of liver'
1e1a1711a9e429a5c0a74eec,What was the drug prescribed to patient 10007818 for the last time in 07/this year via the pr route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND prescriptions.route = 'pr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 DRUG_NAME FROM PHARMACY_ORDERS WHERE PATIENT_ID = '10007818' AND EXPIRY_DATE = (SELECT MAX(EXPIRY_DATE) FROM PHARMACY_ORDERS WHERE PATIENT_ID = '10007818' AND EXPIRY_DATE BETWEEN '2023-07-01' AND '2023-07-31') AND ROUTE = 'PR' ORDER BY EXPIRY_DATE DESC
83619f693733b0a1c2937f55,What's the average total hospital cost that includes a anticardiolipin antibody igg lab test?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anticardiolipin antibody igg' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT AVG(total_cost) FROM hospital_costs WHERE lab_test = 'anticardiolipin antibody igg'
6d3fe547b78cd9bdc187e610,"How many instances of drainage of peritoneal cavity, percutaneous approach procedures have been completed since 1 year ago?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,[SELECT COUNT(*) AS `Number of Procedures`
88f1c32259e7e65db186fc61,Tell me the protocol of anticancer drugs?,,,SELECT DISTINCT protocol FROM cancer_treatment WHERE treatment_type = 'anticancer'
666412cc886fa97817ea1d59,What was the first value of the o2 saturation pulseoxymetry for patient 10021487 on this month/09?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '09' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(o2_saturation_pulsoxymetry) FROM `physionet-data.mimiciii_clinical.icustays` WHERE patientunitstayid = '10021487' AND intime >= '2021-09-01' AND intime < '2021-10-01' AND o2_saturation_pulsoxymetry IS NOT NULL
1f55785a38dfb75deb3bfb40,When did patient 10040025 get discharged from the hospital for the first time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10040025 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",[],SELECT MIN(admit_date) FROM hospital_discharge WHERE patient_id = 10040025
f4668d73e48714b3c81b72ab,When did patient 10021938 have the maximum respiratory rate the last time during their last ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],"[SELECT MAX(`resp_rate`) AS `Last_Max_Resp_Rate`, `charttime` AS `Time_of_Last_Max`"
b09ed49b64bdf344e14bb1c7,Did patient 10014354 have any chloride lab tests done during the previous month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM lab_results WHERE patient_id = 10014354 AND test_type = 'chloride' AND test_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 MONTH) AND NOW()"
75b0b6062a202e39dc311504,What is the percentile of 26.2 in a mch lab test conducted at the same age as patient 10038081 during the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 26.2",,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY mch) FROM lab_tests WHERE patient_id = (SELECT patient_id FROM patients WHERE patient_number = 10038081) AND encounter_id = (SELECT MAX(encounter_id) FROM encounters WHERE patient_id = (SELECT patient_id FROM patients WHERE patient_number = 10038081)) AND mch = 26.2 AND age_at_encounter = (SELECT age FROM encounters WHERE patient_id = (SELECT patient_id FROM patients WHERE patient_number = 10038081) AND encounter_id = (SELECT MAX(encounter_id) FROM encounters WHERE patient_id = (SELECT patient_id FROM patients WHERE patient_number = 10038081)))
8cd487610ef7e6e0e454d96b,"What was the name of the medication which patient 10016742 was prescribed in the same hospital visit after receiving introduction of nutritional substance into lower gi, via natural or artificial opening?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT medication_name FROM prescriptions JOIN patient_visits ON prescriptions.visit_id = patient_visits.visit_id WHERE patient_visits.patient_id = '10016742' AND patient_visits.treatment = 'Introduction of nutritional substance into lower gi, via natural or artificial opening' AND patient_visits.visit_date < (SELECT visit_date FROM patient_visits WHERE visit_id = patient_visits.visit_id AND visit_date > patient_visits.visit_date)"
1cf1e58d245ff59b4d7adc31,How many hours have passed since patient 10039831 last received a laboratory test of amylase during their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(hour, MAX(visit_lab_test.start_date), GETDATE()) FROM visit_lab_test WHERE visit_lab_test.visit_id = (SELECT visit_id FROM visits WHERE patient_id = 10039831 AND CURRENT_DATE BETWEEN start_date AND end_date) AND visit_lab_test.lab_test_name = 'amylase' GROUP BY visit_id;"
a3bc0d803f5c36757f71d51c,Was patient 10004733's glucose last measured on the current hospital visit greater than the value first measured on the current hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT CASE WHEN MAX(g1.value) > MIN(g2.value) THEN 'YES' ELSE 'NO' END FROM (SELECT value FROM measurement WHERE person_id = 10004733 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 10004733)) AS g1, (SELECT value FROM measurement WHERE person_id = 10004733 AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE person_id = 10004733)) AS g2 WHERE g1.measurement_concept_id = 3020963 AND g2.measurement_concept_id = 3020963"
db9fb5b609cf5c9785924c0c,How many hours have passed since patient 10004733 first visited the careunit medical/surgical intensive care unit (micu/sicu) during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT SUM(TIMESTAMPDIFF(HOUR, careunit_admit_datetime, careunit_discharge_datetime)) FROM encounters WHERE patient_id = 10004733 AND careunit_admit_datetime IS NOT NULL AND careunit_discharge_datetime IS NOT NULL AND careunit_type IN ('medical/surgical intensive care unit', 'micu', 'sicu')"
7ae500ee11764d469951ff85,Can you indicate the yearly minimum dose of kcl (bolus) that patient 10014078 received?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)",[],SELECT MIN(dose_value) AS min_dose_value FROM ADT_PATIENT_DRUG WHERE pat_id = 10014078 AND dose_type = 'BOLUS' AND drug_name = 'KCL' GROUP BY YEAR(date_time)
a3c1f40e880ba9d30165da29,Do you know what type of blood patient 98517 has?,,,"select patient_id, blood_type from patients where patient_id = 98517"
8575bf6a21bdfbbe6b80a4ab,Tell me the total or ebl output of patient 10027602.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or ebl' AND d_items.linksto = 'outputevents' ),[{'SUM(outputevents.value)': None}],SELECT SUM(ebl_output) FROM patient_data WHERE patient_id = '10027602'
355c64d2875efbf6a8cd7683,What was the name of the output which patient 10019172 had first had since 04/07/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-07' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Foley'}],SELECT name FROM output WHERE patient_id = 10019172 AND date > '04/07/2100' ORDER BY date ASC LIMIT 1
aafda5799cef4cdbb1a8c0e0,What's the count of current patients?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from patient where patient_status='Current'
d2d60e3fb7175ae8e24658d9,Tell me what diagnosis patient 32153 received at the other department.,,,SELECT diagnosis FROM other_department_records WHERE patient_id = 32153
042ab61601f982ee4d6436fd,What did patient 10022041 get diagnosed with in 2100 for the first time?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )",,SELECT DISTINCT `diagnoses` FROM `patient_records` WHERE `patient_id` = '10022041' AND `year` = 2100 AND `diagnosis_order` = 1;
9a8f62c083931e6b853cf083,What is the name of a procedure patient 10029291 underwent two or more times since 30 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-30 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,SELECT procedure_name FROM procedures WHERE patient_id = 10029291 AND procedure_date >= (CURRENT_DATE - INTERVAL '30' MONTH) GROUP BY procedure_name HAVING COUNT(procedure_name) >= 2
797af2b7be25b810c1fa0b00,Count the ICU visits of patient 10009035 since 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND strftime('%Y',icustays.intime) >= '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 1}],select count(*) from icu_visits where patient_id = '10009035' and year(date) >= 2100
a2e0e5bf31da42c112583f6a,When did patient 10038933 first get prescribed famotidine and glyburide at the same time since 06/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10038933 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glyburide' AND admissions.subject_id = 10038933 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT MIN(Date) FROM prescriptions WHERE PatientID = 10038933 AND (DrugCode = 'famotidine' OR DrugCode = 'glyburide') GROUP BY PatientID HAVING COUNT(DISTINCT DrugCode) = 2 AND Date >= '06/2100'
d3f3a4406592054ad20c2093,When did patient 10022017 get the microbiology test for the last time since 10/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2189-09-13 08:16:00'}],SELECT MAX(TestDate) FROM PatientTests WHERE PatientID = '10022017' AND TestType = 'Microbiology' AND TestDate >= '10/21/2000'
d9e6af32ff852ac88dc76577,What is dr. barna's outpatient schedule today?,,,SELECT * FROM outpatient_schedule WHERE doctor_name = 'Dr. Barna' AND appointment_date = CURRENT_DATE
1dea8e8367ea15758b8ca92e,Calculate the number of patients prescribed insulin.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'insulin' ),[{'COUNT( DISTINCT admissions.subject_id )': 21}],SELECT COUNT(*) as InsulinPrescriptions FROM Patients WHERE medication = 'Insulin'
2d707b84d2f9dc480c7effa7,What treatment were provided to patient 10021312 two or more times since 05/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-05' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,select distinct t1.code from t_treatment t1 join t_patient p1 on t1.patient_id = p1.patient_id join t_diagnose d1 on p1.patient_id = d1.patient_id where p1.patient_id = 10021312 and t1.date >= '05/21/00' group by t1.code having count(t1.code) >= 2
228233a09c8164c6e564f551,"Has any organism been found in the first fluid,other microbiological test of patient 10021487 in 12/this year?","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'fluid,other' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)>0': 0}],select * from microbiological_test where patient_id = 10021487 and test_type = 'first fluid' and test_result = 'positive' and extract(year from test_date) = extract(year from current_date)
df4054d39dfcc41a5f36e76b,At what time did the last incident of patient 10020944 having a maximum respiratory rate occur on 03/12/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-03-12' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1",[],"[SELECT MAX(RespRate) AS MaximumRespiratoryRate, Timestamp"
4244cfa368679a0ccc3f5672,Does patient 65309 have a trip history overseas?,,,select count(*) from trip_history where patient_id = 65309 and country != 'United States'
1f0fce096cb3fb07a3c96ef2,How many days has it been since the last time during this hospital encounter that patient 10004733 was diagnosed with proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT DATEDIFF(CURRENT_DATE, MAX(ER_VISIT_END_DATE)) FROM EMERGENCY_ENCOUNTERS WHERE PATIENT_ID = 10004733 AND DIAGNOSIS_CODE IN (SELECT DIAGNOSIS_CODE FROM DIAGNOSES WHERE DIAGNOSIS_TEXT = 'PROTEUS (MIRABILIS) (MORGANII) INFECTION IN CONDITIONS CLASSIFIED ELSEWHERE AND OF UNSPECIFIED SITE')"
95523c3c68ef7d68aa2cd797,Tell me the total volume of input that patient 10021938 was given since 07/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-12'",[{'SUM(inputevents.totalamount)': 1754.0}],
480c4f9f6cb6210afb07ec17,Can you tell me the five most frequent diagnoses during this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT Diagnosis, COUNT(Diagnosis) AS Frequency FROM MedicalRecords WHERE Date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY Diagnosis ORDER BY Frequency DESC LIMIT 5"
9c4387eddc635a52994b4e04,How much does it cost for a severe sepsis diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'severe sepsis' ) ),,SELECT cost FROM diagnosis_costs WHERE condition = 'severe sepsis'
e7119697712668b05c2da0e5,Count how many current patients are aged 50s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 50 AND 59,,SELECT COUNT(*) AS num_50s FROM Patient WHERE Age BETWEEN 50 AND 59 AND Status = 'current'
76247d92b87ae733ddbc1905,When was the last test of patient 10020740's microbiology stool in 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND microbiologyevents.spec_type_desc = 'stool' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT TOP 1 [Date
2398b4f90c62615b764ca247,How many days have elapsed since the last time on this hospital encounter patient 10039831 got a magnesium lab test?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(CURRENT_DATE, MAX(date)) FROM lab_tests WHERE patient_id = 10039831 AND test_name = 'magnesium' AND encounter_id = (SELECT encounter_id FROM encounters WHERE patient_id = 10039831 ORDER BY encounter_date DESC LIMIT 1)"
223c28432258577bfde7c6ee,Can you tell me when the first monocytes test of patient 10009049 was conducted in 06/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'monocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '06' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT MIN(test_date) AS first_monocyte_test_date FROM lab_tests WHERE patient_id = 10009049 AND test_type = 'monocytes' AND EXTRACT(MONTH FROM test_date) = 6 AND EXTRACT(YEAR FROM test_date) = EXTRACT(YEAR FROM CURRENT_DATE);
7787b854dab1f43b718313bf,Was patient 10022017 diagnosed with anything last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,SELECT diagnosis FROM PatientRecords WHERE patient_id = '10022017' AND YEAR(diagnosis_date) = YEAR(CURDATE()) - 1;
0577ee51b3ad3c9fcf8fbbae,What is the average value of oxygen in patient 10014729's body in 03/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '03'",[{'AVG(labevents.valuenum)': None}],SELECT AVG(oxygen_value) FROM patient_measurements WHERE patient_id = 10014729 AND measurement_date BETWEEN '2023-03-01' AND '2023-03-31' AND measurement_type = 'oxygen'
adead92d438c2cc8419cbb1a,What was the drug name that patient 10027445 was last prescribed through the tp route in 09/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'tp' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT drug_name FROM prescriptions WHERE patient_id = 10027445 AND route = 'tp' AND prescription_date BETWEEN '2023-09-01' AND '2023-09-30' ORDER BY prescription_date DESC LIMIT 1
dc333dc95c29a9b3f3719647,"For patients previously diagnosed with nicotine dependence, cigarettes, uncomplicated , what were the five most frequent specimens tested in the same month afterward?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nicotine dependence, cigarettes, uncomplicated' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,"SELECT specimen, COUNT(*) AS count FROM lab_events WHERE patient_csn_id IN (SELECT patient_csn_id FROM patient_encounters WHERE primary_diagnosis_cui='C0006019' AND visit_date BETWEEN '2010-01-01' AND '2010-12-31') AND visit_date BETWEEN lab_events.visit_date AND DATE_ADD(lab_events.visit_date, INTERVAL 1 MONTH) GROUP BY specimen ORDER BY count DESC LIMIT 5"
ab3f000e7808a99742228d97,"What was the name of the drug patient 10015931 was prescribed within 2 days after having received a introduction of other therapeutic substance into peripheral artery, percutaneous approach procedure during this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT p2.drug_name FROM patient_procedure p1 JOIN patient_drug p2 ON p1.patient_id = p2.patient_id WHERE p1.patient_id = 10015931 AND p1.procedure_type = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' AND p2.start_date BETWEEN DATE_ADD(p1.procedure_date, INTERVAL 2 DAY) AND LAST_DAY(p1.procedure_date)"
39206b0e94f1d50dfd4f7a97,"In the first hospital visit, what age was patient 10021118?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,,SELECT age FROM visits WHERE visit_id=1 AND patient_id='10021118'
21725d6a5831671fc4d0dc87,Has patient 10016742 come to the ER?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.admission_location = 'emergency room',[{'COUNT(*)>0': 0}],select * from [t1
634b0f8deeebe3bcb1a50a09,What is the dose of prescribed opioid for patient 30826?,,,SELECT OpioidDose FROM OpioidPrescriptions WHERE PatientID = 30826
5939dbebe9fc6fd912fa8878,"What is the average total cost of the hospital, which includes the medicine named glucose gel since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucose gel' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,Your SQL query here
dc21479affad398d7e20b2da,Was there any nacl 0.9% given to patient 10010471 on 12/15/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-15'",[{'COUNT(*)>0': 0}],select * from prescriptions where patient_id = 10010471 and drug_name = 'nacl 0.9%' and date_prescribed = '12/15/2100'
1d30f0f67382fed6a575cafc,What was the name of the drug that patient 10004733 was prescribed within 2 days after having received since 10/2100 a enteral infusion of concentrated nutritional substances procedure?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-10' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,select drug from prescriptions where patient_id = 10004733 and date_prescribed between (select date_procedure + interval '2 days' from procedures where patient_id = 10004733 and procedure_name = 'enteral infusion of concentrated nutritional substances' and date_procedure >= '10/21/00') and (select date_procedure + interval '2 days' from procedures where patient_id = 10004733 and procedure_name = 'enteral infusion of concentrated nutritional substances' and date_procedure >= '10/21/00')
fb61ff0592412ac1416aee55,Calculate the number of patients staying in emergency department observation.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SQL Query
9cdb25ef0c41840e0b599dbb,What is the pricing for ampicillin sodium?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium' ),,select * from drug_list where name = 'ampicillin sodium'
d8f365a561e69cca2b2fea83,What was the first polys reading in 06/2100 for patient 10007818?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.charttime ASC LIMIT 1",[],select min(polys) from data where pid='10007818' and time='06/2100';
abe89412efcd41bf266d253a,What is the name of the diagnosis that patient 30267 received from the other department?,,,SELECT diagnosis FROM patient_records WHERE patient_id = 30267 AND department_type = 'other'
dea9a4a3b6415cd9f853cbe4,"In 09/2100, how much dorzolamide 2%/timolol 0.5% ophth. has been prescribed to patient 10005348 in total?","SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND prescriptions.drug = 'dorzolamide 2%/timolol 0.5% ophth.' AND strftime('%Y-%m',prescriptions.starttime) = '2100-09'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(quantity) as total_prescribed FROM prescriptions WHERE patient_id = 10005348 AND drug_name = 'dorzolamide 2%/timolol 0.5% ophth.' AND date_prescribed BETWEEN '2100-09-01' AND '2100-09-30'
fe6a7a8b896a7b2e6cd69e64,I need the total volume of input for patient 10038999 on 06/03/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-06-03'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(inputVolume) AS totalInputVolume FROM patient_input_records WHERE patient_id = '10038999' AND date = '06/03/2100';
388eba2ee935cfefacdbbcf6,Could you provide the total volume of output for patient 10009049 on 06/13/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-06-13'",[{'SUM(outputevents.value)': None}],SELECT SUM(volume) FROM patient_data WHERE patient_id = 10009049 AND date = '06/13/2100';
dba831b22948cb6030f2a0dd,Count how many current patients are aged 30s.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,,SELECT COUNT(*) FROM patients WHERE age BETWEEN 30 AND 39 AND current_status = 'Active'
c5924167cb9c4a6790f631c5,What was the total of lidocaine 1% (for picc/midline insertions) that patient 10038081 had been prescribed?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug = 'lidocaine 1% (for picc/midline insertions)',[{'SUM(prescriptions.dose_val_rx)': None}],select sum(`lidocaine 1% (for picc/midline insertions)`) from `prescriptions` where `patient_id` = '10038081'
de726b4a741c447f0cdcb8e5,How much does a medication called acetaminophen iv cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetaminophen iv' ),,SELECT price FROM medications WHERE name = 'acetaminophen iv'
c1f271e8baade40b3d9d4596,When did patient 10021666 first get urine microbial tests in 04/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '04' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(test_datetime) AS First_Urine_Microbial_Test_Date FROM lab_events WHERE patient_num = 10021666 AND test_name LIKE '%urine microbial%' AND test_datetime >= '04/01/2023'
e4d3934ae79126d2f578ee32,Did patient 10027602 have gastric meds given in their first hospital visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'gastric meds' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM PatientMeds WHERE PatientID = 10027602 AND Medication LIKE '%gastric%' AND VisitNumber = 1
d073173860e35bfa703b57ab,Display the top three most commonly prescribed drugs.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}]",
2b2758c78e28d13baca5b743,Can you show me the top three most frequent lab tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT TOP 3 LabTest, COUNT(LabTest) AS TestFrequency FROM LabTests WHERE TestDate >= '2100-01-01' GROUP BY LabTest ORDER BY TestFrequency DESC"
8dea7b9b04a6934cbc300217,What was the total dose of readi-cat 2 (barium sulfate 2% suspension) patient 10038992 had been prescribed last month?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND prescriptions.drug = 'readi-cat 2 (barium sulfate 2% suspension)' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month')",[{'SUM(prescriptions.dose_val_rx)': None}],your sql
722720600298a5f82bca4716,What output did patient 10018081 generate last since 12/26/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-26' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],SELECT output FROM patient_outputs WHERE patient_id = '10018081' AND date >= '2100-12-26' ORDER BY date DESC LIMIT 1
dedd0a8a0ba377a957737cd9,Show me the top three most frequent diagnoses that patients were diagnosed with within 2 months after receiving other endoscopy of small intestine since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT diagnosis, COUNT(diagnosis) AS frequency FROM patient_records WHERE diagnosis_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW() AND procedure = 'other endoscopy of small intestine' AND diagnosis_date <= DATE_ADD(procedure_date, INTERVAL 2 MONTH) GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3"
a6cec8e8e6020c8b18e14f57,Has patient 10016810 been provided with any medication since 05/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'",[{'COUNT(*)>0': 1}],select count(1) from chartdrugevents where patientnum = 10016810 and endtime >= '05/2100'
eff7745b76fcafa8bf36d64d,What was the specimen test ranked at three that was done most commonly?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT specimen_test, COUNT(*) AS frequency FROM specimen_tests WHERE rank = 3 GROUP BY specimen_test ORDER BY frequency DESC LIMIT 1"
0cf19476dc727db127ab20bf,What was the name of the last specimen test which patient 10018328 has received since 17 months ago?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-17 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'URINE'}],"SELECT specimen_test_name FROM specimen_tests WHERE patient_id = 10018328 AND test_date >= DATE_ADD(NOW(), INTERVAL -17 MONTH) ORDER BY test_date DESC LIMIT 1;"
bca0d0989ef1a590d9a72d9f,When was the last time patient 10018328 was discharged from hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018328 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2154-05-03 14:00:00'}],SELECT MAX(discharge_date) FROM admissions WHERE patient_id = 10018328;
3f15a65a81b4cc91090d4562,What was the medicine that was prescribed to patient 10009035 in the same hospital encounter after undergoing extracorporeal circulation auxiliary to open heart surgery in 05/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,[SELECT Medication
5301d3f2ee9055f024af59a4,How many hours have elapsed since the last time patient 10039831 got a lactate lab test in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(hour, MAX(ResultsDate), GETDATE()) AS HoursElapsed FROM Labs WHERE PatientID = '10039831' AND TestName = 'Lactate' AND VisitID = (SELECT MAX(VisitID) FROM Labs WHERE PatientID = '10039831')"
5497d84d98c1646706086e2e,Will they have any urine test done for patient 24268?,,,"Select distinct `tests`.`test_type`, `patients`.`patient_id`, `patients`.`name` from `tests` join `patients` on `tests`.`patient_id` = `patients`.`patient_id` where `patients`.`patient_id` = 24268 and `tests`.`test_type` = 'urine test' order by `tests`.`date` desc limit 1"
0424a90b6986dc6ca2da8b3b,"During their last hospital encounter, when did patient 10023239 last receive a calcium, total test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT ""Encounter"".""EncounterDate"" FROM ""Encounter"" JOIN ""LabTest"" ON ""Encounter"".""EncounterID"" = ""LabTest"".""EncounterID"" WHERE ""LabTest"".""PatientID"" = 10023239 AND ""LabTest"".""TestName"" = 'Calcium, Total' ORDER BY ""Encounter"".""EncounterDate"" DESC LIMIT 1"
1b9d385c18198422e5cc0a04,The first time patient 10007795 was prescribed lactated ringers and gemfibrozil at the same time since 06/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'gemfibrozil' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10007795 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],[SELECT MIN(prescription_date) AS first_prescribed_date
45fe917c7821d64a778aee8e,Tell me the total input for patient 10004733 yesterday.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND datetime(inputevents.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(input) FROM patient_data WHERE patient_id = 10004733 AND date = CURDATE() - INTERVAL 1 DAY
8b05dac24440c0e125c2982d,What was the duration of serum transfusion nec for patient 29540?,,,SELECT duration FROM serum_transfusion_nec WHERE patient_id = 29540;
2b2a1cb7c1f3e55513ccdcd8,"Since 2100, what was the top five most frequent diagnoses patients were diagnosed with during the same month after receiving extracorporeal circulation auxiliary to open heart surgery?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT diagnosis, COUNT(diagnosis) AS frequency FROM patient_diagnoses WHERE month = (SELECT month FROM open_heart_surgery WHERE patient_id = patient_diagnoses.patient_id) AND year >= 2100 GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
543fac252e1b711db022052e,"What is the maximum cost of a hospital that involves acute alcoholic intoxication in alcoholism, continuous since 1 year ago?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"select max(c.cost) as max_cost from cost c, admissions a, diagnoses d, conditions dc where c.hospital_id = a.hospital_id and a.patient_id = d.patient_id and dc.code = d.code and dc.term = 'acute alcoholic intoxication' and dc.category = 'alcoholism' and a.admittime < now() - interval '1 year' and a.dischtime > a.admittime"
a5a346eb9f19336f14d5a615,Could you inform me about patient 10019172's last o2 saturation pulseoxymetry since 07/07/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-07-07' ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(date_time) AS last_o2_saturation_time, o2_saturation FROM patient_10019172.pulseoxymetry WHERE date_time >= '07/07/2100' AND o2_saturation IS NOT NULL"
721bfea157a6426f9d055a41,What was the total dose of 0.83% sodium chloride prescribed to patient 10018501 in the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = '0.83% sodium chloride',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(Dosage) AS TotalDose FROM Prescriptions WHERE PatientID = 10018501 AND Drug = '0.83% Sodium Chloride' AND VisitDate = (SELECT MAX(VisitDate) FROM Prescriptions WHERE PatientID = 10018501)
675c3bb58c7f84d6c7abcb76,"Has patient 10016742 been ordered sw, sodium chloride 0.9%, or heparin in 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug IN ( 'sw', 'sodium chloride 0.9%', 'heparin' ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)>0': 0}],"select count(*) from `physionet-data.mimiciii_clinical.charts_events` where itemid in (455, 672, 678) and subject_id=10016742 and hadm_id in (select hadm_id from `physionet-data.mimiciii_clinical.admissions` where admittime < '2010-01-01')"
5837deca15847d294628637f,Can you tell me the cost of repair of atrial septal defect with tissue graft?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'repair of atrial septal defect with tissue graft' ) ),,SQL Query
6cb0d732bdcaaf606d0b499a,"What was the first sodium, whole blood lab value for patient 10005348 in the last hospital visit?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) ORDER BY labevents.charttime ASC LIMIT 1",[],"select distinct on (hospital_visit_id) sodium_whole_blood from lab_results where patient_id = 10005348 and hospital_visit_id in (select max(hospital_visit_id) from hospital_visits where patient_id = 10005348) order by hospital_visit_id desc, lab_result_date asc limit 1"
463dff1e23c71f21ca726e31,When did patient 10038999 last receive a pleural fluid microbiology test in 06/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '06' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT MAX(TestDate) AS LastTestDate FROM PleuralFluidMicrobiology WHERE PatientID = 10038999 AND TestDate BETWEEN '2023-06-01' AND '2023-06-30'
1c752280e681b6e8e598bdae,When was the last time that patient 10021312 has received a red blood cells lab test during their last hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT TOP 1 lab_tests.lab_test_date FROM lab_tests INNER JOIN hospital_encounters ON lab_tests.encounter_id = hospital_encounters.encounter_id WHERE lab_tests.lab_test_name = 'Red Blood Cells' AND lab_tests.patient_id = 10021312 AND hospital_encounters.encounter_end_date = (SELECT MAX(encounter_end_date) FROM hospital_encounters WHERE patient_id = 10021312) ORDER BY lab_tests.lab_test_date DESC
1495b796ffe9d906c0df1b75,Has any prescriptions been given to patient 10016810?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) FROM prescriptions WHERE patient_id = 10016810
88cfaf0dcef49943a266c313,What was the drug that patient 10021487 was prescribed for within 2 days after undergoing arterial catheterization since 2 months ago?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-2 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-2 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,"SELECT prescription.drug_name FROM patient_procedures p JOIN prescription ON p.patient_id = prescription.patient_id WHERE p.procedure_name = 'arterial catheterization' AND p.date_performed >= DATE_SUB(CURDATE(), INTERVAL 2 MONTH) AND prescription.prescription_date BETWEEN p.date_performed AND DATE_ADD(p.date_performed, INTERVAL 2 DAY) AND p.patient_id = '10021487' ORDER BY prescription.prescription_date LIMIT 1;"
d8830bd1398db83dd14ba4d6,What are the three most commonly ordered medications in this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3",[],"SELECT medication_name, COUNT(*) AS order_count FROM orders WHERE YEAR(order_date) = YEAR(CURDATE()) GROUP BY medication_name ORDER BY order_count DESC LIMIT 3"
8694ace52a01f31ca53cc69a,When has patient 10000032 been given urea nitrogen test for the first time in 08/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08' ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT MIN(visit_timestamp) AS first_test_date FROM lab_tests WHERE person_id = 10000032 AND test_name = 'Urea Nitrogen' AND visit_timestamp LIKE '08/2100%'
8022e43f6d6b61363a0e1da2,What was the total foley output of patient 10013049 on 06/24/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '06-24'",[{'SUM(outputevents.value)': None}],SELECT SUM(foley_output) AS total_foley_output FROM patient_data WHERE patient_id = '10013049' AND date = '2023-06-24;'
bbaf6db3927ca6221096a678,When are dr. smith's rounds and procedures?,,,select schedule_time from dr_schedules where dr_name = 'Smith'
e3659a41757c0fd2645fe816,Tell me the total number of patients who stayed in vascular since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'vascular' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(*) as TotalNumberofPatients FROM Vascular WHERE ArrivalTime >= '2100' AND DischargeTime <= '2300'
a0275ba4dd2c244770e9553e,Calculate the number of patients staying in med/surg/gyn since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg/gyn' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT PatientID) AS NumberOfPatients FROM HospitalAdmissions WHERE Department IN ('Medicine', 'Surgery', 'Gynecology') AND AdmissionDate >= DATEADD(year, -1, GETDATE());"
62062f47a37fdbe9d1c27aaa,Did patient 10012552 undergo any procedure in the first hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT procedure_name FROM procedures WHERE patient_id = '10012552' AND encounter_number = 1
73d40a25005323dbe30f475f,What did patient 10026354 get diagnosed with on their first hospital encounter for the first time?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),,SELECT diagnosis_code FROM hospital_encounters WHERE patient_id = '10026354' AND encounter_number = 1 AND is_first_encounter_for_diagnosis = TRUE
2c69aa2c7d2c6989277b55bb,Calculate patient 10027602's total input amount of nacl 0.9% on this month/05.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '05'",[{'SUM(inputevents.totalamount)': None}],"SELECT SUM(input_amount) FROM input_record WHERE patient_id = 10027602 AND input_name = 'nacl 0.9%' AND DATE_FORMAT(input_time, '%Y-%m') = DATE_FORMAT(CURRENT_DATE, '%Y-05')"
b8c83d640d2fe3594c7c2cb3,What was the output patient 10038933 had since 06/15/2100 on the last occasion?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-15' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],select output from patient_records where patient_id = 10038933 and date >= '06/15/2100' order by date desc limit 1
5b73fda84131aee9f4b13b57,Count the number of patients that were discharged during the previous year from the hospital.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM hospital WHERE discharge_date BETWEEN DATEADD(year, -1, GETDATE()) AND GETDATE() AND status = 'discharged'"
3ba74bf54de10d143025c7db,How many prescriptions were prescribed since 1 year ago for pseudoephedrine?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'pseudoephedrine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)': 0}],
7ce2a21d5cd40b04d8cb2c75,Tell me the number of patients diagnosed with personal history of sudden cardiac arrest since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of sudden cardiac arrest' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,SELECT COUNT(DISTINCT patient_id) FROM patient_records WHERE diagnosis LIKE '%personal history of sudden cardiac arrest%' AND diagnosis_date >= '2100-01-01'
e2be072741fd9d09da7ab8b3,"Compared to yesterday, what are the new prescriptions for patient 10004733 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],select * from prescriptions where patient_id = 10004733 and date = current_date and status = 'new' and not exists (select * from prescriptions where patient_id = 10004733 and date = current_date - interval '1 day' and prescription_id = prescriptions.prescription_id)
97d4f5fa5be6b24ab07da93f,I want to know the total volume of input patient 10019172 has received during their first ICU visit.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ),[{'SUM(inputevents.totalamount)': 29170.0}],SELECT SUM(ventsettings.volume) as total_volume FROM icu_ventilator_settings WHERE inputpatientoffsetseq IN (SELECT MIN(inputpatientoffsetseq) FROM icu_inputevents WHERE inputpatientoffsetseq > 0 AND patientunitstayid IN (SELECT unitstayid FROM icustays WHERE patientunitstayid = 10019172))
407b4851260c5c0836e1d89e,Has patient 10003400 been diagnosed with any type of disease?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ),[{'COUNT(*)>0': 1}],SELECT EXISTS (SELECT 1 FROM diagnosis WHERE patient_id = '10003400')
1b7a372bc73c1b3e5e13c41d,Show me patient 10004422's total jackson pratt #1 output on 01/20/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'jackson pratt #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-01-20'",[{'SUM(outputevents.value)': None}],SELECT SUM(`JACKSON PRATT #1 OUTPUT`) FROM `ICU Data` WHERE `MRN` = '10004422' AND `DATETIME` BETWEEN '2100-01-20 00:00:00' AND '2100-01-20 23:59:59'
891190b131bd38e70baa856f,"What is the average total cost of a hospital, which includes a drug called ciprofloxacin iv since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ciprofloxacin iv' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT AVG(total_cost) FROM Hospital, DrugUsage WHERE DrugUsage.drug_name = 'ciprofloxacin iv' AND DrugUsage.hospital_id = Hospital.id AND DrugUsage.usage_date >= '2100-01-01'"
5b8ab7986b30db4c19fb1088,"Was patient 10000032 ordered insulin (regular) for hyperkalemia, tiotropium bromide, or albuterol 0.083% neb soln during their first hospital visit?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'tiotropium bromide', 'insulin (regular) for hyperkalemia', 'albuterol 0.083% neb soln' )",[{'COUNT(*)>0': 0}],select * from prescriptions where patient_id = '10000032' and visit_number = 1 and (drug_name = 'insulin (regular)' and indication = 'hyperkalemia' or drug_name = 'tiotropium bromide' or drug_name = 'albuterol 0.083% neb soln');
82c59daa8e3a56e7f5ad97c0,"Since 1 year ago, what are the top four most frequent procedures that patients received in the same hospital encounter after being diagnosed with unspecified disorder of kidney and ureter?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified disorder of kidney and ureter' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 procedure_name, COUNT(*) AS frequency FROM medical_records WHERE diagnosis = 'unspecified disorder of kidney and ureter' AND encounter_date BETWEEN DATEADD(year, -1, GETDATE()) AND GETDATE() GROUP BY procedure_name ORDER BY frequency DESC"
74439a67da9347c057e1d1c8,When had patient 10016810 last been prescribed for pseudoephedrine and levothyroxine sodium at the same time since 06/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pseudoephedrine' AND admissions.subject_id = 10016810 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'levothyroxine sodium' AND admissions.subject_id = 10016810 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-06' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(prescription_date) FROM prescriptions WHERE patient_id = '10016810' AND (drug = 'pseudoephedrine' OR drug = 'levothyroxine sodium') GROUP BY prescription_date HAVING COUNT(DISTINCT drug) = 2 AND prescription_date > '06/21/00'
d2eeacdc392b4745759a9da7,What is the name of the medication that was prescribed to patient 10007818 for the first time via the subcut route during their last hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'subcut' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT Name FROM Medication WHERE PatientID = 10007818 AND Route = 'subcut' AND VisitDate = (SELECT MAX(VisitDate) FROM Visit WHERE PatientID = 10007818) AND FirstPrescription = TRUE;
1129dbf956a1de639c79960c,When was the last input time of patient 10005817 during the first ICU stay?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,[{'starttime': '2132-12-17 17:23:00'}],SELECT MAX(INPUTTIME) FROM ADMISSIONS WHERE MRN = '10005817' AND STAYTYPE = 'ICU' AND STAYSEQUENCE = '1';
8d8cd6284d24a2bdccc48b42,What number of days has it been since the first time patient 10004733 was diagnosed with diverticulosis of colon (without mention of hemorrhage) during this hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diverticulosis of colon (without mention of hemorrhage)' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT DATEDIFF(CURRENT_DATE, MIN(DIAGNOSIS_DATE)) AS DaysSinceDiagnosis FROM patient_diagnoses WHERE PATIENT_ID = '10004733' AND DIAGNOSIS_CODE = 'K57.30' AND VISIT_ID = 'current_visit_id' GROUP BY PATIENT_ID"
a8704a105b87163e999ca81d,Are there new medications in the prescription of patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],
cbec37a67b1882b8d6f5c38a,What was the top five most frequent diagnoses since 1 year ago that patients were diagnosed with within the same month after receiving incision with removal of foreign body or device from skin and subcutaneous tissue?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'incision with removal of foreign body or device from skin and subcutaneous tissue' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"select diagnosis, count(*) as freq from diagnoses where date_diagnosed between current_date - interval '1 year' and current_date group by diagnosis order by freq desc limit 5;"
ddaecde2d7500bcb038b6060,"Tell me, was lr given to patient 10013049 on 06/23/2100?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-06-23'",[{'COUNT(*)>0': 0}],SELECT CASE WHEN EXISTS (SELECT 1 FROM Prescription WHERE patient_id = '10013049' AND medication = 'lr' AND date_prescribed = '06/23/2100') THEN 'Yes' ELSE 'No' END AS 'Was lr given?'
76ce0be28b35e8726dc606fa,When was the first time the heart rate of patient 10018081 was measured at a reading greater than 107.0 during this ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 107.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT min(measurement_date) FROM patient_data WHERE patient_id = 10018081 AND measurement_type = 'heart_rate' AND reading > 107.0 AND icu_visit_id = (SELECT icu_visit_id FROM patient_data WHERE patient_id = 10018081 ORDER BY measurement_date LIMIT 1)
77056748c01969f4cedd4f49,What was the first medication that patient 10007795 was prescribed via po/ng route in 05/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],
b91c712088f552af0be44e46,What are the top four most common specimens tested for patients previously diagnosed with traumatic shock within 2 months?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic shock' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"SELECT specimen_type, COUNT(*) AS specimen_count FROM lab_results WHERE patient_id IN (SELECT patient_id FROM diagnoses WHERE condition = 'traumatic shock' AND diagnosis_date BETWEEN NOW() - INTERVAL '2 MONTH' AND NOW()) GROUP BY specimen_type ORDER BY specimen_count DESC LIMIT 4"
c7cc1c1c0a6dfab998b9a573,"What is the maximum total hospital cost that includes a procedure named restriction of left internal carotid artery with intraluminal device, percutaneous approach since 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT MAX(total_hospital_cost) FROM mdcardsurg WHERE ccs_procedure_description LIKE '%restriction of left internal carotid artery with intraluminal device, percutaneous approach%' AND total_hospital_cost IS NOT NULL AND cpt_date >= '2100-01-01'"
967175d0df47b1226680f9bc,What was the name of the organism at the first urine test of patient 10031757 during their last hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],SELECT t2.organism_name FROM lab_tests t1 JOIN lab_results t2 ON t1.test_id = t2.test_id WHERE t1.patient_id = 10031757 AND t1.test_type = 'Urine Test' AND t1.visit_date = (SELECT MAX(visit_date) FROM lab_tests WHERE patient_id = 10031757) AND t1.test_sequence = 1
edaebbb4a2886364c2f5455c,"Since 1 year ago, has patient 10021938 been to an emergency room?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 0}],"select distinct encounter_id from encounter where patient_id=10021938 and encounter_type='ER' and encounter_date > DATE_SUB(NOW(), INTERVAL 1 YEAR)"
be95e0c0ef52ac9abbba1a3c,"What is the number of drainage of right pleural cavity with drainage device, percutaneous approach procedures carried out in this year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,SELECT COUNT(*) FROM Procedures WHERE procedure_type = 'drainage of right pleural cavity with drainage device' AND approach = 'percutaneous' AND YEAR(procedure_date) = YEAR(CURRENT_DATE)
b0e46f47baaef8c5efa0dcdb,What was the last measured value of o2 saturation pulseoxymetry for patient 10027445 on 08/12/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-08-12' ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(measurement_time) AS last_measurement_time, o2saturation FROM patient_data WHERE patient_id = 10027445 AND DATE(measurement_time) = '2100-08-12'"
625878ba2c323f56d784df19,"For the last time , what was patient 10017492 diagnosed with?",SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),,SELECT diagnosis FROM medical_records WHERE patient_id = 10017492 ORDER BY date_of_diagnosis DESC LIMIT 1
107acacd9df083f664395e57,How many times patient 10018501 came to the hospital in this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10018501 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],SELECT COUNT(*) FROM patient_visits WHERE patient_id = 10018501 AND visit_date BETWEEN '2023-01-01' AND '2023-12-31'
2815edbcab8252d5b617ad55,When did patient 10029484 last depart from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10029484 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],select max(admittance) from `physionet-data.mimic_core.admissions` where `subject_id` = 10029484
5a5b63cc59222e36f5a0e0ea,"Compared to yesterday, what were the new prescriptions for patient 10004733 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT COUNT(DISTINCT prescription_id) FROM prescriptions WHERE patient_id = 10004733 AND prescription_date = CURRENT_DATE - INTERVAL '1 day'
40c4039e5ddeb88faf4449aa,Which are the top three most frequent procedures patients had within 2 months after being diagnosed with personal history of malignant neoplasm of large intestine since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"[SELECT procedure, COUNT(*) as frequency"
11781310efb83f845ca54e72,Retrieve the top four most frequent procedures that were delivered to patients within 2 months after they received other laparoscopic umbilical herniorrhaphy in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other laparoscopic umbilical herniorrhaphy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,SQL Query
0efae2c62f95516d380e6775,How much is the average total hospital bill when it includes a % hemoglobin a1c lab test in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_hospital_bill) FROM hospital_bills WHERE contains_lab_test = '% hemoglobin a1c' AND year = 2100
5bc31e9ba087ef781c202f7d,What is the maximum total cost for the hospital when a transferrin lab test is involved?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'transferrin' ) ) GROUP BY cost.hadm_id ) AS T1,,SQL Query
df5a70f5890755916496aef6,What is the number of ICU visits for patient 10006580.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ),[{'COUNT( DISTINCT icustays.stay_id )': 1}],SELECT SUM(visit_count) FROM patient_icu_visits WHERE patient_id = 10006580;
83ef051d3b1070d79701011f,What were the five most frequent output events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT TOP 5 EventOutput, COUNT(*) AS Frequency FROM [dbo"
3f355b4c88735775a5eeacb2,What is the opiate dose recommended for patient 2518,,,SELECT opiate_dose FROM opioid_therapy WHERE patient_id = 2518
0caf055cee4dccc45176c275,How many patients last year were diagnosed with attention deficit disorder with hyperactivity?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,SQL Query
ef8f70442734cae2d9b783a3,List the top three most common events since 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT event_name, COUNT(*) AS event_count FROM events WHERE year >= 2100 GROUP BY event_name ORDER BY event_count DESC LIMIT 3"
a6b9ade99c3cfb9b0eddcbec,"In 2100, how many patients received fluoroscopy of multiple coronary arteries using other contrast within the same hospital visit after being diagnosed with severe sepsis with septic shock?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'severe sepsis with septic shock' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,SELECT count(patient_id) AS patient_count FROM procedures WHERE year = 2100 AND procedure_type = 'fluoroscopy' AND coronary_arteries = 'multiple' AND contrast_used = 'other' AND diagnosis = 'severe sepsis with septic shock' AND hospital_visit = 'same' GROUP BY hospital_visit
4613c69ff92c982ad6b0c73e,What was the weight of patient 10014729 first in the first hospital visit?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT weight FROM patient_records WHERE patient_id = '10014729' AND hospital_visit_rank = 1 AND measurement_rank = 1;
ab0dc7cef40d44572a80367e,What is the minimum total hospital cost for a person with coronary atherosclerosis of autologous vein bypass graft since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'coronary atherosclerosis of autologous vein bypass graft' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(TotalHospitalCost) FROM patient_data WHERE Condition = 'coronary atherosclerosis of autologous vein bypass graft' AND Date > '2100-01-01'
1dbe09373cc9df99e58c1b27,Can anyone help me determine the code that corresponds to icd-11 and for preterm nec 2000-2499g in icd-10?,,,"SELECT icd11_code FROM ICDConversionTable WHERE icd10_code IN ('P07.0', 'P07.1', 'P07.2', 'P07.3', 'P07.4')"
60fcfb33b6da12626f9c0ed4,"In the last hospital encounter, what was patient 10037861's age?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,SELECT AGE FROM PATIENT_ENCOUNTERS WHERE PATIENT_ID = 10037861 ORDER BY ENCOUNTER_DATE DESC LIMIT 1
6d16d17d6f59ace9a2e0a9bd,How many patients were discharged since 1 year ago from hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) FROM patients WHERE discharge_date > CURRENT_DATE - INTERVAL '1 year'
ac2e5b4fdd7c9a6ea505a929,What changes were made in the prescription of patient 10004733 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"select p.patient_id, p.date_of_birth, p.gender, p.address, p.city, p.state, p.zip_code, p.phone_number, p.email, p.primary_care_provider, p.primary_care_provider_phone_number, p.primary_care_provider_email, p.secondary_care_provider, p.secondary_care_provider_phone_number, p.secondary_care_provider_email, pr.date, pr.medication, pr.dosage, pr.route, pr.frequency, pr.start_date, pr.end_date, pr.reason, pr.notes, pr.prescriber_id from patient p join prescription pr on p.patient_id = pr.patient_id where p.patient_id = 10004733 and pr.date = CURRENT_DATE"
426f5871dfa620cca1f14a84,Tell me the percentile for mcv of 89.0 among patients in the same age as patient 10020740 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 89.0",,[SELECT PERCENT_RANK() OVER (ORDER BY mcv) as percentile
fe3277e1cb0eca8a574478bb,"On the last hospital stay, what was patient 10007928's insurance plan?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Other'}],"SELECT ""Insurance Plan"" FROM ""PatientInsurance"" WHERE ""Patient ID"" = '10007928' AND ""Hospital Stay ID"" = (SELECT MAX(""Hospital Stay ID"") FROM ""PatientHospitalStay"" WHERE ""Patient ID"" = '10007928')"
8738512f4dab78e20d4a3a23,What are the three most frequently ordered laboratory tests since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) >= '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]",SQL Query
6a7adc80e43e20c9c20e21aa,Tell me the name of the organism found in patient 10007795's last abscess microbiology tests in 05/this year?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND microbiologyevents.spec_type_desc = 'abscess' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT organism_name FROM microbiology_tests WHERE patient_id = '10007795' AND test_date BETWEEN '2023-05-01' AND '2023-05-31' ORDER BY test_date DESC LIMIT 1
e07839bc9af48a037d0d54bb,"Among the patients of age 20s this year, what are the top four most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,your solution
20c1cb7239a17a4dbbe96296,What was the total dosage of chlorpheniramine maleate prescribed to patient 10016810 in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND prescriptions.drug = 'chlorpheniramine maleate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(dosage) FROM prescriptions WHERE patient_id = 10016810 AND medication_name = 'chlorpheniramine maleate' AND date_prescribed LIKE '2023-07-%';
7808f5d4ac9c6409be01f55f,What was the name of the prescription drug given to patient 10004235 in the same day after undergoing the simple excision of other lymphatic structure procedure since 07/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,select distinct drug from prescription where patient_id = 10004235 and date = (select date from procedure where patient_id = 10004235 and procedure_name = 'simple excision of other lymphatic structure' and date >= '07/21')
3b9849548e56c59f768d5447,Tell me the minimum respiratory rate in patient 10021118 in the first ICU visit.,SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ),[{'MIN(chartevents.valuenum)': None}],select min(respiratory_rate) from icustays where icustay_id=10021118
051c19cebb0a8796d0c84043,"What are the three most frequently given lab tests for patients that were diagnosed with atrial fibrillation previously within the same month, in 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atrial fibrillation' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT lab_test, COUNT(*) as frequency FROM patient_records WHERE diagnosis_code = 'atrial_fibrillation' AND diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31' AND patient_id IN (SELECT patient_id FROM patient_records WHERE diagnosis_code = 'atrial_fibrillation' GROUP BY patient_id, MONTH(diagnosis_date) HAVING COUNT(*) > 1) GROUP BY lab_test ORDER BY frequency DESC LIMIT 3"
dcfb3bfb9c133a83a862251a,How should we disinfect the quarantine room?,,,SELECT disinfection_methods FROM quarantine_procedures WHERE room_type = 'quarantine room'
37c75c3b997199029b9998b4,Has patient 10004235 received any surgery?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ),[{'COUNT(*)>0': 1}],SELECT DISTINCT procedure_date FROM surgeries WHERE patient_id = 10004235
b1cb5d3e6f5cc86239c34959,What is the maximum cost of a hospital that involves methicillin resistant pneumonia due to staphylococcus aureus since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin resistant pneumonia due to staphylococcus aureus' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(Cost) AS MaximumCost FROM Hospital WHERE Illness = 'Methicillin Resistant Pneumonia' AND Bacteria = 'Staphylococcus Aureus' AND Year >= 2100
4f0a03f732e95fdcb15376f7,Calculate the total volume of input for patient 10005817 since 06/23/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-23'",[{'SUM(inputevents.totalamount)': 166435.0}],select sum(volume) from inputevents_mv where patientid = '10005817' and carevueoffset >= '2023-06-23 00:00:00' and carevueoffset < '2023-06-24 00:00:00'
c84cfe8470cb11125e4f78bc,"Get me the top five most frequent procedures that patients received during the same hospital visit after receiving extirpation of matter from left common iliac vein, percutaneous approach.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left common iliac vein, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT procedure_code, COUNT(*) AS frequency FROM patient_procedures WHERE visit_id IN (SELECT visit_id FROM patient_procedures WHERE procedure_code = 'EXTIRPATION_LEFT_ILIAC_VEIN') AND procedure_code != 'EXTIRPATION_LEFT_ILIAC_VEIN' GROUP BY procedure_code ORDER BY frequency DESC LIMIT 5"
aefb5d2e178ea9fa647cd5fe,Has patient 10000032 been given any procedure since 1 year ago?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,SELECT ... FROM ... WHERE ...
f1c637616d0c91843526eb96,"List the five most frequent diagnoses a patient was diagnosed with within 2 months after receiving dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"[SELECT TOP 5 Diagnosis, COUNT(Diagnosis) AS Frequency FROM Encounters"
2c770acc2155effc3c66d286,When did patient 10017492 first get the urine's microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND microbiologyevents.spec_type_desc = 'urine' ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],SELECT test_date FROM microbiology_tests WHERE patient_id = 10017492 AND test_type = 'urine' ORDER BY test_date ASC LIMIT 1
760fc9ca5ebd74a67d09783d,Is there any new medication in the prescription of patient 10004733 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],"select distinct m.med_name from prescription as p join medication as m on p.med_id=m.med_id where p.pat_id=10004733 and p.pres_date=to_date('2023-04-05','yyyy-mm-dd') and not exists (select 1 from prescription as p2 join medication as m2 on p2.med_id=m2.med_id where p2.pat_id=10004733 and p2.pres_date=to_date('2023-04-04','yyyy-mm-dd') and m.med_name=m2.med_name)"
e22e5a88ca77a9f96af45fd7,How many patients underwent insertion of intercostal catheter for drainage during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of intercostal catheter for drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,"SELECT COUNT(DISTINCT PatientID) FROM SurgicalProcedures WHERE ProcedureName='Insertion of Intercostal Catheter for Drainage' AND ProcedureDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
911bb06c9471e1c057977c81,What medication was prescribed to patient 10006053 first time in 11/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"SELECT medication_name FROM prescriptions WHERE patient_id = 10006053 AND prescription_date = (SELECT MIN(prescription_date) FROM prescriptions WHERE patient_id = 10006053 AND DATE_FORMAT(prescription_date, '%m/%y') = '11/21')"
f3249c1cae12b134951c017d,What's the average total hospital cost that includes a urea nitrogen lab test in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(Total_Hospital_Cost) AS Average_Cost FROM medical_records WHERE Urea_Nitrogen_Lab_Test = 'Yes' AND Year = 2100
fa3f52c79b018b43a9e8090a,Can you list the single rooms that are available today?,,,SELECT * FROM rooms WHERE type = 'single' AND availability_date = 'today' AND is_available = TRUE
4a41f13171a4d40a9cb9e53b,How many times did the hemodialysis procedure take place?,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ),[{'COUNT(*)': 0}],SELECT COUNT(*) FROM hemodialysis_procedures
dcf9ab0261c9713de6f8dab0,Is the value of respiratory rate of patient 10023239 last measured on the last ICU visit greater than the value second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT CASE WHEN (SELECT respiratory_rate FROM patient_measurements WHERE patient_id = 10023239 AND icu_visit_id = (SELECT MAX(icu_visit_id) FROM patient_icu_visits WHERE patient_id = 10023239) ORDER BY measurement_time DESC LIMIT 1) > (SELECT respiratory_rate FROM patient_measurements WHERE patient_id = 10023239 AND icu_visit_id = (SELECT MAX(icu_visit_id) FROM patient_icu_visits WHERE patient_id = 10023239) ORDER BY measurement_time DESC LIMIT 1, 1) THEN 'Yes' ELSE 'No' END AS is_greater;"
b04265d8d305b0cccc5d7d67,Did patient 10025463 undergo a chloride test during the last hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 0}],SELECT DISTINCT 'yes' as test_performed FROM LabEncounter WHERE patient_id = '10025463' AND test_type = 'chloride' AND encounter_id = (SELECT MAX(encounter_id) FROM LabEncounter WHERE patient_id = '10025463')
b30404be1d0cdffef60e38c6,"In 08/2100, when did patient 10021312 last receive a creatinine test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y-%m',labevents.charttime) = '2100-08' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT MAX(test_date) AS last_test_date FROM lab_results WHERE patient_id = '10021312' AND test_type = 'creatinine' AND YEAR(test_date) = '2100' AND MONTH(test_date) = '08'
0406ba9fa1c3ada7f76965a3,What was the name of the last medication that was prescribed to patient 10039708?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[{'drug': 'Lactulose'}],SELECT TOP 1 Medication FROM PrescriptionHistory WHERE PatientID = '10039708' ORDER BY PrescriptionDate DESC
0f7b20f0c3c6fb3264a2cc98,When did patient 10038933 get inputs for the first time on 09/22/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-09-22' ORDER BY inputevents.starttime ASC LIMIT 1",[],select * from patient_inputs where patient_id = 10038933 and input_date = '09/22/2100' order by input_time asc limit 1
6c0d7988692dd2731863ec96,Have patient 96429s ever suffered any side effects from blood transfusions?,,,SELECT * FROM patient_side_effects WHERE patient_id = 96429 AND cause = 'blood transfusion'
764c1ad18155aabf053779ab,What was the first drug that was prescribed to patient 10027602 during this month via the po/ng route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime ASC LIMIT 1",[],"select * from prescrips where patient_id = 10027602 and route in (""po"", ""ng"") and month = ""this_month"" order by date_prescribed limit 1;"
39cc7a512a66650e91459e27,When did patient 10005348 get the microbiology test for the last time since 07/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2130-10-27 17:02:00'}],SELECT MAX(test_date) AS LastTestDate FROM patient_tests WHERE patient_id = 10005348 AND test_type = 'microbiology' AND test_date >= '2100-07-01'
c5f0f757c748ca958da5182f,What was the name of the output which patient 10039831 had for the last time today?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND datetime(outputevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY outputevents.charttime DESC LIMIT 1 )",[],SELECT TOP 1 name FROM output WHERE patient_id = 10039831 AND date = CURRENT_DATE ORDER BY time DESC
470559b06a3cc6cf01345c4a,"For patients who were previously diagnosed with fibromyalgia, what are the top three most frequent treatments within the same month in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'fibromyalgia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT treatment, COUNT(*) as frequency FROM patient_treatments WHERE diagnosis = 'fibromyalgia' AND YEAR(treatment_date) = 2100 GROUP BY treatment, MONTH(treatment_date) ORDER BY frequency DESC LIMIT 3;"
af1b692aa2f8340f719c17fe,"Among patients diagnosed with lens replaced by other means , what are the top four most common lab tests that followed afterward during the same month?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'lens replaced by other means' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,
0ac5e8c127eb6f8f74e5d260,Total number of patients who had arteriography of cerebral arteries in this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",,SELECT COUNT(*) AS total_patients FROM patient_records WHERE procedure = 'arteriography of cerebral arteries' AND YEAR(procedure_date) = YEAR(CURDATE())
1bbc56c2fd1aad4535efd121,What was the top five most frequent diagnoses that patients were diagnosed with within the same month after receiving hemodialysis?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT diagnosis, COUNT(*) AS frequency FROM PatientRecords WHERE hemodialysis_date BETWEEN diagnosis_date - INTERVAL '1 MONTH' AND diagnosis_date + INTERVAL '1 MONTH' GROUP BY diagnosis ORDER BY frequency DESC LIMIT 5"
c5d9d0626f74f9062b8f7509,What were the top four most frequent specimens ordered for patients after being diagnosed with hesitancy of micturition during the same hospital visit?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hesitancy of micturition' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"select t1.specimen, count(*) from labevents as t1 inner join labevents as t2 on t1.subject_id = t2.subject_id and t1.hadm_id = t2.hadm_id and t1.charttime between t2.charttime - interval '6' hour and t2.charttime + interval '2' hour and t1.itemid not in (select itemid from d_items where category not in ('BLOOD', 'SPECIMEN')) and t2.itemid in (select itemid from d_items where label = 'hesitancy of micturition') group by t1.specimen order by count(*) desc limit 4"
cc6cddf1a72c4c14b010fdf1,What are the the single rooms that are available now?,,,SQL Query
2ba80682f1e2b0050e0acece,What are the three most common specimen tests that occurred since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT test_name, COUNT(*) as frequency FROM LabResults WHERE test_date >= DATE_SUB(NOW(), INTERVAL 1 YEAR) GROUP BY test_name ORDER BY frequency DESC LIMIT 3"
dc5d5f941a6b2d27b4856352,When was the last time of input time of patient 10004720 since 08/08/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-08' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2186-11-17 15:29:00'}],SELECT MAX(input_time) FROM patient_data WHERE patient_id = 10004720 AND input_time > '08/08/2100'
a13c273dcddfa537845c91d0,What medication was last given to patient 10038933?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ORDER BY prescriptions.starttime DESC LIMIT 1,[{'drug': 'Heparin Flush (10 units/ml)'}],SELECT medication_name FROM medication_orders WHERE patient_id = 10038933 ORDER BY administration_time DESC LIMIT 1
e2b25103644606a2debc3586,When was the last time that patient 10038933 was prescribed medication in 09/this year via the ih route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND prescriptions.route = 'ih' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '09' ORDER BY prescriptions.starttime DESC LIMIT 1",[],
d9ff976abef3224333ca77ba,Please inform me of all the prescriptions patient 8888 received in another department.,,,
4805f5b946dd24bdc7c044c0,What are the four frequently ordered medications for patients diagnosed with paralytic ileus previously within the same month?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'paralytic ileus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 medication_name, COUNT(*) AS order_count FROM medication_orders WHERE diagnosis = 'paralytic ileus' AND order_date >= DATEADD(MONTH, -1, GETDATE()) AND patient_id IN (SELECT DISTINCT patient_id FROM medication_orders WHERE diagnosis = 'paralytic ileus' AND order_date < GETDATE()) GROUP BY medication_name ORDER BY order_count DESC"
103610582e111db3b8138c85,What's the cost to get replacement of stent (tube) in biliary or pancreatic duct?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of stent (tube) in biliary or pancreatic duct' ) ),,select * from procedures where description like '%replacement of stent%' and (description like '%biliary%' or description like '%pancreatic duct%')
55a91f4eaa637abafc6b75b7,What is the method of disinfection in the quarantine room?,,,SELECT disinfection_method FROM quarantine_room WHERE method_type = 'disinfection'
32e5482d088de481d141565d,Can you tell me the maximum heart rate for patient 10018081's body on 12/29/this year?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '12-29'",[{'MAX(chartevents.valuenum)': None}],select max(Heart_Rate) from [Heart Rate Data
7fa8d89115dcb79bd3b9d8b6,"How many patients received (aorto)coronary bypass of two coronary arteries treatment within the same month after being diagnosed with congestive heart failure, unspecified since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of two coronary arteries' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,SQL QUERY HERE
dc05a582149cb9a35f095c0b,What were the top four diagnoses of patients with age 20s in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis, COUNT(patient_id) AS num_patients FROM hospital_records WHERE YEAR(admission_date) = 2100 AND age BETWEEN 20 AND 29 GROUP BY diagnosis ORDER BY num_patients DESC LIMIT 4;"
6b81072250740cd9e14626a0,Do you know the ward id of patient 10624 to which they are admitted?,,,select ward_id from patient_ward_map where patient_id=10624
018d243f5ca33716687af47d,Number of patients who received a other electric countershock of heart procedure.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from procedure_occurrence where procedure_concept_id = 4100976
ec6751ca286066dda72e0c84,"Was in their last hospital visit 0.9% sodium chloride, docusate sodium (liquid), or sertraline prescribed to patient 10016742?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( '0.9% sodium chloride', 'docusate sodium (liquid)', 'sertraline' )",[{'COUNT(*)>0': 0}],SELECT ...
f2545d14686ea54127cc9c44,Has patient 10003046 been given any medication since 01/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01'",[{'COUNT(*)>0': 1}],SELECT DISTINCT Medication.Name FROM Medication INNER JOIN Prescriptions ON Medication.ID = Prescriptions.MedicationID WHERE Prescriptions.PatientID = '10003046' AND Prescriptions.Date >= '2100-01-01'
465aed14cf9939565ad6d4cc,How many times was a other endovascular procedures on other vessels procedure conducted since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,select count(*) from AHRQ_surgical_db
a960378edd7b28956a92d2bb,What was the drug that patient 10025463 was prescribed with during the same day after the catheter based invasive electrophysiologic testing?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,"select druggenericname from (select druggenericname,admitdate from prescriptions where patientid=10025463 and admitdate in (select admitdate from procedures where patientid=10025463 and procedurename='catheter based invasive electrophysiologic testing') order by admitdate desc limit 1) a where a.admitdate in (select admitdate from prescriptions where a.patientid=10025463 and a.druggenericname=p.druggenericname order by admitdate limit 1)"
db84c0e7a45cffa783b0950f,What was the last arterial blood pressure systolic in patient 10020187's body on 02/04/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-02-04' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT Last_ABP_Sys FROM patient_records WHERE Patient_ID = '10020187' AND Observation_Date = '02/04/2100' ORDER BY Observation_Time DESC LIMIT 1;
4f0abb317b82d6a5f186ef14,Present the count of ICU visits for patient 10021118 in the first hospital encounter.,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT( DISTINCT icustays.stay_id )': 1}],SELECT count(1) FROM `physionet-data.mimiciii_clinical.icustays` WHERE subject_id=10021118 AND hospital_id=1
fb14ee1d9363c64de1cb8c84,Find out the number of hospital visits patient 10009628 had since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10009628 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 1}],SELECT COUNT(*) AS hospital_visits_count FROM `healthcare_data.historical_hospital_visit` WHERE person_id = '10009628' AND visit_start_date >= '2100-01-01'
3c7e00141c354983c6fb8742,What medication was first given to patient 10014729?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Milk of Magnesia'}],select medication from treatment_records where patient_id = 10014729 order by date_prescribed asc limit 1
084fbed97d37b17fe3de08f7,When did patient 10010471 first receive an input since 12/11/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-11' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2155-12-02 20:54:00'}],SELECT MIN(Date) FROM MedicalRecords WHERE PatientID = '10010471' AND Date > '12/11/2100' AND ActionType = 'Input'
015be3d8662ca93c5c0bab0b,Did patient 10015272 receive any disease diagnoses in the last hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT COUNT(*) AS num_diagnoses FROM Diagnosis WHERE patient_id = 10015272 AND date_of_diagnosis = (SELECT MAX(date_of_encounter) FROM Encounter WHERE patient_id = 10015272) AND code_type = 'disease'
8a4a4c79371999b9915a2ef3,How much does acute on chronic diastolic heart failure cost to get diagnosed?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic heart failure' ) ),,SELECT SUM(DiagnosisCost) FROM HospitalBilling WHERE Diagnosis = 'Acute on Chronic Diastolic Heart Failure'
d048cd029e1afe980ed96d08,Could you inform me about patient 10020187's last arterial blood pressure systolic on 02/04/this year?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '02-04' ORDER BY chartevents.charttime DESC LIMIT 1",[],"select top 1 `Systolic` from `Arterial Blood Pressure` where `PatientID` = '10020187' and `Date` = '2023-02-04' order by `Date` desc, `Time` desc"
54ce172ad4dee0a2a6d24cd0,But does patient 11426 have an appointment in other department?,,,SELECT * FROM appointments WHERE patient_id = 11426 AND department_id != (SELECT department_id FROM appointments WHERE patient_id = 11426 LIMIT 1);
5565327861ed5fcac13b11e2,"How many times was introduction of other thrombolytic into central vein, percutaneous approach carried out this year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,"select count(distinct patient_id) from procedure_log where procedure_name = 'Introduction of other thrombolytic into central vein, percutaneous approach' and procedure_date >= '2023-01-01' and procedure_date <= '2023-12-31'"
55952982603c114a5b29a8b0,"What are the four commonly ordered medications for patients who were diagnosed with other and unspecified alcohol dependence, in remission previously during the same hospital encounter, since 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified alcohol dependence, in remission' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 medication_name, COUNT(medication_name) AS frequency FROM Prescriptions WHERE diagnosis = 'other and unspecified alcohol dependence' AND previous_diagnosis = 'remission' AND order_date > '2100-01-01' GROUP BY medication_name ORDER BY frequency DESC"
95c5860371dc9446921eec10,What's the minimum total cost of the hospital visits that included a drug called fentanyl citrate since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fentanyl citrate' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(TotalCost) FROM HospitalVisits WHERE DrugName = 'fentanyl citrate' AND VisitDate >= '2100-01-01'
c35347e6b1dda9ed6764a067,Could you tell me the last o2 saturation pulseoxymetry value that patient 10039831 had since 12/30/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-30' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT pulseoxymetry FROM lab_results WHERE patient_id = '10039831' AND lab_test = 'O2 SATURATION' AND date >= '12/30/2100' ORDER BY date DESC LIMIT 1;
6f8a9ea4d83dea4c52af5a4b,Was patient 10004422 on their first hospital visit given a mchc lab test?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 0}],SQL Query
f6875e17c4dd27a3b3e56653,How many times did patient 10017492 attend the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10017492 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 2}],SELECT COUNT(*) AS VisitCount FROM HospitalVisits WHERE PatientID = '10017492' AND VisitDate > CURRENT_DATE - INTERVAL '1 year'
6d037a4951c5f57d0e001cee,"What was the name of the medicine that was given to patient 10038999 within 2 days post procedure of drainage of left pleural cavity, percutaneous approach in 06/this year?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '06' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '06' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,[SELECT m.medicineName
d6f34e43fb6592a8c64d3f94,Has patient 10019917 been checked into the hospital since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019917 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 1}],"SELECT * FROM PatientAdmissions WHERE PatientID = 10019917 AND AdmissionDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
93a6f19b82de2d952049362e,When did patient 10006053 get a microbiology test for the last time?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'charttime': '2111-11-14 17:15:00'}],SELECT TOP 1 date_performed FROM microbiology_tests WHERE patient_id = '10006053' ORDER BY date_performed DESC
fecffb251c3f41feb07c69c7,When was the first input time of patient 10001217 since 06/03/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-03' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2157-11-20 19:32:00'}],SELECT min(input_time) FROM patient_data WHERE patient_id = '10001217' AND input_time >= '06/03/2100'
67d324104c936264768323f1,"When was the first time that patient 10036156 was tested for creatine kinase, mb isoenzyme on the last hospital visit?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT TOP 1 date_of_test FROM lab_results WHERE patient_id = '10036156' AND test_name = 'creatinine kinase, mb isoenzyme' AND hospital_visit_date = (SELECT MAX(hospital_visit_date) FROM hospital_visits WHERE patient_id = '10036156') ORDER BY date_of_test ASC"
f7dca6ca66a468ed7f41631a,What is the maximum monthly number of people diagnosed with obstructive sleep apnea (adult)(pediatric) in this year?,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'obstructive sleep apnea (adult)(pediatric)' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1",,"SELECT MAX(count) FROM (SELECT EXTRACT(MONTH FROM diagnosis_date) AS month, COUNT(*) AS count FROM diagnoses WHERE condition = 'obstructive sleep apnea' AND diagnosis_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY month) AS monthly_counts"
61f316cdde3e8b077f86a486,How old was patient 10003400 during their last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10003400 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,,"[SELECT TIMESTAMPDIFF(YEAR, p.dob, MAX(h.encounter_date)) AS age_at_last_encounter"
7f9576332062c59f8d3332f3,How much does patient 10021118 weigh based on the last measurement since 13 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-13 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT weight FROM measurements WHERE patient_id = 10021118 AND measurement_date > (CURRENT_DATE - INTERVAL '13 months') ORDER BY measurement_date DESC LIMIT 1
9043871db343ad385db09772,When did patient 10010471's first microbiological test occur since 1 month ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2155-12-03 19:58:00'}],"SELECT TOP 1 test_date FROM microbiological_tests WHERE patient_id = 10010471 AND test_date >= DATEADD(MONTH, -1, GETDATE()) ORDER BY test_date ASC"
759aa16667e44e03f4caba14,When did patient 10011398 get input for the last time since 12/19/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2146-12-16 08:00:00'}],select max(input_date) from patient_input where patient_id = 10011398 and input_date > '12/19/2100'
36d78a53fb451b1de2c95f2f,How many patients in this year were discharged from the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(distinct patient_id) as num_patients FROM admissions WHERE YEAR(admit_date) = YEAR(CURRENT_DATE) AND discharge_date IS NOT NULL
876f65e64154a3d0ee436ad3,Is patient 10008454's o2 saturation pulseoxymetry second measured on the last ICU visit less than the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN (SELECT `o2 saturation pulseoxymetry second` FROM `icustays` INNER JOIN `labevents` ON `icustays`.`icustay_id` = `labevents`.`icustay_id` WHERE `icustays`.`subject_id` = 10008454 AND `labevents`.`itemid` = 220277 AND `labevents`.`charttime` IN (SELECT MAX(`charttime`) FROM `labevents` WHERE `labevents`.`itemid` = 220277 AND `labevents`.`icustay_id` IN (SELECT MAX(`icustay_id`) FROM `icustays` WHERE `icustays`.`subject_id` = 10008454)) ORDER BY `charttime` DESC LIMIT 1) < (SELECT `value` FROM `labevents` WHERE `itemid` = 220277 AND `icustay_id` IN (SELECT MAX(`icustay_id`) FROM `icustays` WHERE `subject_id` = 10008454) ORDER BY `charttime` LIMIT 1) THEN 'Yes' ELSE 'No' END AS `Is Second Less Than First`
0142fefc91ec6884f43de80b,What is the code in icd-10 that corresponds to icd-11 for voice/resonance dis nec?,,,select icd10.code from icd10 join icd11 on icd10.code = icd11.code where icd11.description like '%voice/resonance dis nec%';
85d31f9d8735d20c26163c0b,How many patients were diagnosed since 1 year ago with chronic systolic (congestive) heart failure?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic systolic (congestive) heart failure' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') )",,"SELECT COUNT(DISTINCT p.PatientId) FROM Patients p JOIN Diagnoses d ON p.PatientId = d.PatientId WHERE d.Diagnosis = 'Chronic Systolic Heart Failure' AND d.DiagnosisDate >= DATEADD(year, -1, GETDATE())"
34324beee54e081e5e88f130,Was any platelets given to patient 10006053 in 11/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'platelets' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-11'",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM LabEvents WHERE (EventName = ""Platelet"" OR EventName = ""Platelets"") AND (PatientEncounterID = '10006053' AND (EventDate LIKE '11/21%') AND (EventValue != 'None'))"
e2ce9bb566451b1c9b9ba7ee,What is the total volume of patient 10027602's input on this month/02?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '02'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(Volume) AS TotalVolume FROM Fluids WHERE PatientID = 10027602 AND Date BETWEEN '2023-02-01' AND '2023-02-28' AND Type = 'Input'
b663ddcb1000b3c27f988cc2,Calculate the number of patients prescribed acetylcysteine 20%.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine 20%' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT PATIENT_ID) FROM MEDICATIONS WHERE MEDICATION_NAME = 'Acetylcysteine 20%' AND FORM = 'Aerosol'
60e23877ec81a6c1b852706e,When pantoprazole and vial were prescribed to patient 10021312 for the first time at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10021312 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vial' AND admissions.subject_id = 10021312 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT MIN(visit_start_date) FROM claims WHERE patient_nbr = 10021312 AND (drug_name = 'pantoprazole' OR drug_name = 'vial') GROUP BY patient_nbr HAVING COUNT(DISTINCT drug_name) = 2
66415948d667e13324c3969a,How much difference is there in creatinine levels among patient 10021938 last measured on the first hospital visit compared to the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SQL Query
28f850662f724d2a12bab092,"Among patients diagnosed with essential (primary) hypertension, what are the top five most common lab tests conducted in the same hospital encounter in 2100?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'essential (primary) hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,SQL Query
11b773ce5f673720f4ff1cd9,Has patient 10009628 experienced any procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,SELECT * FROM `procedure_occurrence` WHERE person_id = 10009628 AND procedure_date > '2100-01-01';
02fe4d0195664f0dc082a343,What are the top three common microbiology tests?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}]","select test_name, count(test_name) as test_count from microbiology_tests group by test_name order by test_count desc limit 3"
327c193923b31d4de7547a06,Tell me the five most common lab tests.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]",
64b39620ce3e1a170ffb4a84,Could you provide me with the three most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT output_event_name, COUNT(*) AS frequency FROM (SELECT DISTINCT output_event_id, output_event_name, output_event_timestamp FROM output_events WHERE output_event_timestamp >= NOW() - INTERVAL '1 year') AS recent_events GROUP BY output_event_name ORDER BY frequency DESC LIMIT 3;"
92ec6272af144fdb3b7740bd,What is the minimum total cost of hospitalization that includes the parathyroid hormone laboratory test in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'parathyroid hormone' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,select min(total_cost) as minimum_total_cost from hospitalizations where year = 2100 and 'parathyroid hormone' in lab_tests
71b139cfa31f5f0c28ac7223,When was the last mrsa screen microbiology test performed in 11/2100 for patient 10027602?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-11' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],select max(test_date) as last_test_date from microbiology_tests where test_name = 'mrsa screen' and test_date like '11/2100' and patient_id = '10027602'
27f061fabd9f7d2e99e832c3,Give me the total amount of dextrose 5% given to patient 10021487 since 10/04/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-04'",[{'SUM(inputevents.totalamount)': None}],
41f819d9fd8944e5602a6279,"Tell me the maximum total hospital cost that involved venous catheterization, not elsewhere classified in 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'venous catheterization, not elsewhere classified' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT MAX(total_hospital_cost) AS max_hospital_cost FROM icd_hospital_stays WHERE procedure_description LIKE '%venous catheterization, not elsewhere classified%' AND discharge_date BETWEEN '2021-01-01' AND '2021-12-31';"
67cfd4b9ba04c04a487ec39f,What are the precautions after the spinal canal explor nec procedure?,,,SELECT precaution FROM spinal_canal_explor_nec_procedures WHERE procedure_name = 'spinal canal explor nec'
a5af87eb9da16c85cfe6ddb7,Has there been any organism observed in patient 10007795's last blood culture ( myco/f lytic bottle) microbiology test on the first hospital visit?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood culture ( myco/f lytic bottle)' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'COUNT(*)>0': 0}],select distinct m.organism_id from microbiology_tests m join patients p on m.patient_id = p.patient_id where m.test_type = 'blood culture ( myco/f lytic bottle)' and p.patient_id = '10007795' and m.test_date = (select max(test_date) from microbiology_tests where patient_id = '10007795' and test_type = 'blood culture ( myco/f lytic bottle)') and m.test_result = 'positive' order by m.test_date desc
0e1a076c06d4a3c6b66107e3,What's the maximum total cost of the hospital visits that involve a procedure called arteriography of femoral and other lower extremity arteries since 1 year ago?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT MAX(total_cost) FROM HospitalVisits WHERE procedure_name = 'arteriography of femoral and other lower extremity arteries' AND visit_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
c3b19c4c394c0f1b38639a43,Can you tell how many times patient 10021938 visited the ICU this year?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT icustays.stay_id )': 0}],"SELECT COUNT(*) AS ""ICU Visit Count"" FROM icustay_detail WHERE subject_id = 10021938 AND discharge_time >= '2023-01-01' AND discharge_time < '2024-01-01'"
73bfff1ea31aa4d903100d70,What is the code which corresponds to the icd-11 for cerebral edema in icd-10?,,,SELECT icd_11_code FROM ICD_10_to_ICD_11_MAPPING WHERE icd_10_code = 'Code_for_cerebral_edema_in_ICD-10'
7d9cdd88b75501b509687396,Calculate the number of patients who were discharged from the hospital since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) AS 'Number of Discharged Patients' FROM HospitalRecords WHERE DischargeDate > '2100-01-01'
5205a0314efeddff42fe6437,"What were the top three most common procedures that occurred during the same hospital encounter for patients who had extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic before since 1 year ago?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT procedure_name, COUNT(*) AS procedure_count FROM procedures WHERE encounter_id IN (SELECT encounter_id FROM procedures WHERE procedure_name = 'Extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic') AND encounter_date >= CURDATE() - INTERVAL 1 YEAR GROUP BY procedure_name ORDER BY procedure_count DESC LIMIT 3;"
5768b3ec354138c3fd79bb7f,"What is the maximum total hospital cost for a patient suffering from acute edema of lung, unspecified since 1 year ago?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute edema of lung, unspecified' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT MAX(TotalHospitalCost) AS MaxHospitalCost FROM patient_records WHERE DiagnosisCode = 'AcuteEdemaLungUnspecified' AND AdmissionDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)"
585b1a785327dcf93085897b,How much does a medication called clobetasol propionate 0.05% ointment cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'clobetasol propionate 0.05% ointment' ),,SELECT price FROM medications WHERE name = 'clobetasol propionate 0.05% ointment'
7fd127de8b5bc25c0ca5a31b,Can you find the five most frequent drugs that were prescribed within the same hospital visit after a cachexia diagnosis was given since 1 year ago?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cachexia' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5",,"SELECT TOP 5 drug_name, COUNT(*) as frequency FROM prescriptions WHERE hospital_visit_id IN (SELECT hospital_visit_id FROM diagnoses WHERE diagnosis = 'cachexia' AND visit_date >= DATEADD(year, -1, GETDATE())) AND visit_date > diagnosis_date GROUP BY drug_name ORDER BY frequency DESC"
e8debe591ef7f4b4639bad49,When did patient 10031404 since 07/04/2100 for the first time have an input?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-04' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2113-08-04 19:00:00'}],SELECT MIN(INPUT_DATE) FROM INPUT_HISTORY WHERE PATIENT_ID = 10031404 AND INPUT_DATE >= '2100-07-04'
21a13676c67585e41b8f6a67,Dosage of opioid prescribed for patient 8116?,,,SELECT dosage FROM opioid_prescriptions WHERE patient_id = '8116'
e1a802bbddcfa313978c2d4b,Can you get me the top four diagnoses that have the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,SQL query goes here
e36f6d845834296a2ace08cd,How much is the average total cost of a hospital that involves a drug named tobramycin sulfate since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tobramycin sulfate' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,select avg(total_cost) from hospital_cost_detail natural join drug_cost where drug_name='tobramycin sulfate' and year>=2100
a4914a96d11642f0050fc3d3,Tell me the three most common diagnosis.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]","SELECT diagnosis, COUNT(*) AS diagnosis_count FROM patient_records GROUP BY diagnosis ORDER BY diagnosis_count DESC LIMIT 3"
707f754d71d05322bf6f1082,When did since 04/2100 patient 10000032 take the last microbiology test?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'charttime': '2180-08-06 20:35:00'}],SELECT MAX(date) FROM microbiology WHERE patient_id = 10000032 AND date >= '2100-04-01';
0f3620b0b09198874571d19d,List the top four most frequent microbiology tests given to patients after being diagnosed with presence of cardiac pacemaker in the same month.,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'presence of cardiac pacemaker' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"select top 4 microbiology_test, count(microbiology_test) as frequency from microbiology_tests join pacemakers on microbiology_tests.patient_id = pacemakers.patient_id and date_part('month', microbiology_tests.date) = date_part('month', pacemakers.date) group by microbiology_test order by frequency desc;"
d2b11a845b1f86d3c1436906,Can you tell me when patient 10020944 had their first stool microbiology test since 13 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND microbiologyevents.spec_type_desc = 'stool' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-13 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT test_date FROM patient_records WHERE patient_id = 10020944 AND test_type = 'stool microbiology' AND test_date > (CURRENT_DATE - INTERVAL '13' MONTH) ORDER BY test_date ASC LIMIT 1
256fd3ca11317b9a7e82835b,When is the earliest scheduled hospital visit by patient 91249?,,,SELECT MIN(visit_date) FROM hospital_visits WHERE patient_id = 91249;
71d04374ffadf723feb6a4f5,When are dr. ford's rounds and procedures?,,,"SELECT patient_name, procedure_date, procedure_time FROM medical_records WHERE doctor_name = 'Dr. Ford'"
801278f003c473902d05fa06,Calculate the total amount of foley of patient 10005909 since 122 days ago.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime) >= datetime(current_time,'-122 day')",[{'SUM(outputevents.value)': None}],SELECT SUM(amount) AS total_foley FROM medical_records WHERE patient_id = '10005909' AND date >= CURDATE() - INTERVAL 122 DAY AND procedure = 'foley'
d126628b6dfa7ff021c37cc5,"Since 06/2100, when did patient 10039831 receive the first mrsa screen microbiology test?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],"select min(`date`) from `mrsatest` where `patientid` = ""10039831"" and `date` >= ""06/2100"""
28146fa3c758abba5cbdbfae,"How much is the total average cost for a hospital that includes a osmolality, measured lab test since 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, measured' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,"SELECT AVG(hosp.cost) FROM hosptial h JOIN hosptial_lab l ON h.hosptial_id = l.hosptial_id JOIN lab_test t ON l.lab_test_id = t.lab_test_id WHERE t.name = ""osmolality"" AND l.measured = 1 AND l.date > '2100-01-01' GROUP BY h.hosptial_id"
861e1a2621058a2c9affd693,"Among patients who were administered extracorporeal circulation auxiliary to open heart surgery since 1 year ago, what were the top five most common treatments that they received during the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 treatment, COUNT(*) AS treatment_count FROM patient_records WHERE surgery_date >= DATEADD(year, -1, GETDATE()) AND extracorporeal_circulation = 'Yes' AND MONTH(surgery_date) = MONTH(GETDATE()) AND YEAR(surgery_date) = YEAR(GETDATE()) GROUP BY treatment ORDER BY treatment_count DESC"
b90455e3cd10a2bcfe8f3419,What were the four frequent output events that occurred since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}]","SELECT TOP 4 * FROM output_events WHERE event_date >= DATEADD(year, -1, GETDATE()) ORDER BY event_count DESC"
1ed10993a5584026aae83537,What was the last urea nitrogen lab value for patient 10002428 since 02/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-02' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT top 1 * FROM lab_results WHERE patient_id = 10002428 AND test_name = 'urea_nitrogen' AND date > '2100-02-01' ORDER BY date DESC
a169e91c54eaa5ebbdb895e6,How much does patient 10008287's systolic blood pressure differ from the last value measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT ABS(MIN(sysbp) - LAG(sysbp) OVER (ORDER BY icu_vis_starttime)) FROM mimiciii.icustays, mimiciii.labevents WHERE icustays.subject_id=labevents.subject_id AND icustays.icustay_id=labevents.icustay_id AND labevents.itemid=50868 AND labevents.charttime BETWEEN icustays.intime AND icustays.outtime AND icustays.subject_id=10008287 AND icustays.icustay_id=(SELECT icustay_id FROM mimiciii.icustays WHERE subject_id=10008287 ORDER BY intime LIMIT 1)"
975040b9662968e36fedac64,What were the five most common lab tests given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Hemoglobin'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(*) as frequency FROM lab_tests GROUP BY test_name ORDER BY frequency DESC LIMIT 5"
4b57287bb27a24b3ea3db358,Is it patient 10008454's arterial blood pressure systolic last measured on the first ICU visit less than second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","select min(case when artpressure_systolic is not null and itemid in (51, 442, 455, 220051) then valuenum end) < max(case when artpressure_systolic is not null and itemid in (51, 442, 455, 220051) then valuenum end) from chartevents where icustay_id in (select icustay_id from icustay_detail where hadm_id in (select hadm_id from admissions where subject_id in (select subject_id from pat_enc where patientunitstayid=10008454))) and charttime <= (select max(charttime) from chartevents where icustay_id in (select icustay_id from icustay_detail where hadm_id in (select hadm_id from admissions where subject_id in (select subject_id from pat_enc where patientunitstayid=10008454))))"
4b4a86909d0c7240eeb9f9f2,What were the three most commonly performed lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Creatinine'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT test_name, COUNT(*) AS test_count FROM lab_results WHERE test_date >= CURDATE() - INTERVAL 1 YEAR GROUP BY test_name ORDER BY test_count DESC LIMIT 3"
bc72b33b40a0a574955d98e6,What are the ways to consume metformin (glucophage)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'metformin (glucophage)',[],SELECT way_of_administration FROM medication WHERE name = 'metformin (glucophage)'
be48ba72929ed97720c91848,What was the first time in 08/this year patient 10016742 had the maximum absolute eosinophil count value?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute eosinophil count' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '08' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],SELECT TOP 1 date from eosinophil_count where patient_id=10016742 and YEAR(date) = 2008 AND abs_eosinophil_count = (SELECT MAX(abs_eosinophil_count) from eosinophil_count where patient_id = 10016742 AND YEAR(date) = 2008) ORDER BY date ASC
b2f05f5bfed93860e52c33a1,Calculate patient 10029291's length of stay in days for the first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 6.327037037815899}]","SELECT DATEDIFF(day, MIN(admit_date), MAX(discharge_date)) AS length_of_stay FROM patient_stays WHERE patient_id = '10029291' AND stay_type = 'ICU' GROUP BY patient_id ORDER BY admit_date ASC LIMIT 1"
696eddd60cdf06cbb9ee62d7,What is the price of a drug named ampicillin sodium?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ampicillin sodium' ),,SELECT Price FROM Drugs WHERE Name = 'ampicillin sodium'
e369e10b6bd8a83d98f15e53,What was the output patient 10026354 had since 06/24/2100 on the last occasion?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-24' ORDER BY outputevents.charttime DESC LIMIT 1 )",[{'label': 'Foley'}],"SELECT MAX(`date`) AS `LastOccasionDate`, `output` FROM `patient_records` WHERE `patient_id` = 10026354 AND `date` >= '06/24/2100';"
fb908288af351cf6ad047aec,List the top five most frequently tested specimens throughout this year.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],"SELECT specimen, COUNT(*) as frequency FROM specimen_tests WHERE test_date >= '2023-01-01' AND test_date <= '2023-12-31' GROUP BY specimen ORDER BY frequency DESC LIMIT 5;"
76457237914bf971488e9425,Which are the five top specimens that were tested throughout this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],SELECT specimen_name FROM Specimens ORDER BY testing_date DESC LIMIT 5
558b74ae3a2858468e9b6d75,How many times was a insertion or replacement of external ventricular drain [evd] procedure conducted since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,"SELECT COUNT(*) FROM Procedures WHERE Procedure_Type IN ('Insertion', 'Replacement') AND Procedure_Subtype = 'External Ventricular Drain (EVD)' AND Procedure_Date >= '2100-01-01'"
f19baaf7b04bf9e553dd2cbf,What was the first time patient 10018328 was prescribed medications via the iv drip route?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'iv drip' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(START_TIME) FROM EHR WHERE PATIENT_ID = 10018328 AND ROUTE = 'IV Drip'
3a16651efda4705bb6cbe794,"What was the name of the drug patient 10007818 was prescribed with during the same hospital visit after having received a introduction of nutritional substance into central vein, percutaneous approach procedure since 11 months ago?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into central vein, percutaneous approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-11 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-11 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT drug_name FROM patient_prescriptions WHERE patient_id = 10007818 AND visit_date = (SELECT MAX(visit_date) FROM patient_procedures WHERE patient_id = 10007818 AND procedure_code = 'Introduction of nutritional substance into central vein, percutaneous approach') AND visit_date > (SELECT visit_date FROM patient_procedures WHERE patient_id = 10007818 AND procedure_code = 'Introduction of nutritional substance into central vein, percutaneous approach' AND DATEDIFF(month, visit_date, GETDATE()) = 11)"
9aaa83b804392690737b00fb,"On the current hospital visit, how many hours have passed since patient 10018081's last diagnosis of acute vascular insufficiency of intestine?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute vascular insufficiency of intestine' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT TIMESTAMPDIFF(HOUR, MAX(diagnosis_time), CURRENT_TIMESTAMP) AS hours_since_last_diagnosis FROM patient_diagnosis WHERE patient_id = '10018081' AND diagnosis_code = 'acute vascular insufficiency of intestine';"
97d549d940853218be2a6803,How many hours has it been since patient 10021487 last received the protein lab test on the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'protein' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"select datediff(hour, max(protein.lab_test_date), sysdatetime()) from lab_test where lab_test_type = 'Protein' and patient_id = 10021487 and visit_id = (select visit_id from patient_visit where patient_id = 10021487 and current_visit = 1) group by patient_id"
91c2a89a059f3c099a994282,When was the first time patient 10009628 had a medication prescribed via the iv drip route in 10/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND prescriptions.route = 'iv drip' AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(StartDate) FROM (SELECT StartDate FROM Medication WHERE PatientID = 10009628 AND Route = 'IV' AND StartDate BETWEEN '10/01/2100' AND '10/31/2100') AS FirstIVPrescription
b6ef3b8f901f6515811991a6,Tell me the total volume of input for patient 10039997 since 03/07/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-07'",[{'SUM(inputevents.totalamount)': 8840.0}],SELECT SUM(input_volume) AS total_input_volume FROM patient_inputs WHERE patient_id = 10039997 AND date >= '2100-03-07'
16836caa5b38e5fa22166c1a,Is the pt level of patient 10027445 last measured on the last hospital visit greater than the second to last measurement on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","SELECT * FROM (SELECT pt_level, visit_date FROM patient_records WHERE patient_id = 10027445 ORDER BY visit_date DESC, measurement_time DESC LIMIT 2) AS last_two_measurements WHERE pt_level > (SELECT pt_level FROM last_two_measurements WHERE RANK() OVER (ORDER BY visit_date DESC, measurement_time DESC) = 2);"
8a0c73ca152264371f4310c1,"In 2100, what are the top three most common lab tests ordered for patients during the same month after acute and subacute necrosis of liver?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute and subacute necrosis of liver' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,"select * from (select lab_test, count(lab_test) as cnt from lab_tests where lab_test_date between '2100-01-01' and '2100-12-31' and lab_test_date >= (select diagnosis_date from diagnosis where diagnosis_type = 'acute necrosis of liver') and lab_test_date <= (select diagnosis_date + interval '1 month' from diagnosis where diagnosis_type = 'acute necrosis of liver') or lab_test_date >= (select diagnosis_date from diagnosis where diagnosis_type = 'subacute necrosis of liver') and lab_test_date <= (select diagnosis_date + interval '1 month' from diagnosis where diagnosis_type = 'subacute necrosis of liver') group by lab_test) order by cnt desc limit 3"
6eab05aa70724d26ebe7e7c1,How many days is it since patient 10021487 last stayed in the careunit trauma sicu (tsicu) on their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'trauma sicu (tsicu)' ORDER BY transfers.intime DESC LIMIT 1",[],SQL Query
50a2ff309d50e7539213d116,"Has patient 10038081 been on 0.9% sodium chloride (mini bag plus), ketamine (for intubation), or heparin flush (10 units/ml) as prescribed since 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND prescriptions.drug IN ( '0.9% sodium chloride (mini bag plus)', 'ketamine (for intubation)', 'heparin flush (10 units/ml)' ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 0}],[SELECT COUNT(*) AS PrescriptionsCount
8349ae15ee5f76bb723596fb,How much does patient 10004733's heart rate differ from the last value measured on the last ICU visit compared to the second to last value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","[select max(abs(hr_1 - hr_2)) as max_hr_diff from (select hr_1, hr_2 from (select hr as hr_1, row_number() over (order by charttime) as row_num from chartevents where subject_id = 10004733 and itemid = 211 and (charttime between (select max(charttime) from chartevents where subject_id = 10004733 and hadm_id in (select distinct hadm_id from icustays where subject_id = 10004733)) - interval '1' day and (select max(charttime) from chartevents where subject_id = 10004733 and hadm_id in (select distinct hadm_id from icustays where subject_id = 10004733)))) as last_icu_visits) as ranked_visits where row_num > 1) as hr_differences;"
a8fc0b9f87df5a45d66da39e,"Can you tell me the cost for the procedure called drainage of left pleural cavity, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach' ) )",,"SELECT AVG(Cost) FROM Procedures WHERE ProcedureName = 'drainage of left pleural cavity, percutaneous approach'"
7adf373e9c0d4a3cd7f5fec3,"This year, what are the three common diagnoses of patients of age 40s?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT Diagnosis, COUNT(*) as diagnosis_count FROM patient_records WHERE YEAR(CurrentDate) = YEAR(CURDATE()) AND age BETWEEN 40 AND 49 GROUP BY Diagnosis ORDER BY diagnosis_count DESC LIMIT 3"
5c20529abfd911e57654f545,Share the four most frequently performed procedures in 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT procedure_name, COUNT(procedure_id) AS frequency FROM procedures WHERE year = 2100 GROUP BY procedure_name ORDER BY frequency DESC LIMIT 4"
8f05ca0c74199be8f6803a5c,How many days is it since patient 10021487 last received the lymphocytes lab test on this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"select datediff(current_date(), max(lab_datetime)) as days_since_last_lymphocytes from lab_events where lab_test_type = 'lymphocytes' and encounter_id = 10021487"
95b245de3db0ff301118f6ef,Was the hematocrit reading for patient 10001725 second measured on the last hospital visit less than the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT (SELECT value FROM labevents WHERE person_id = 10001725 AND labresultid = (SELECT labresultid FROM labresults WHERE name = 'Hematocrit' AND isnumeric = 1 AND iserror = 0 AND value != '') ORDER BY ROW_ID DESC LIMIT 1,1) < (SELECT value FROM labevents WHERE person_id = 10001725 AND labresultid = (SELECT labresultid FROM labresults WHERE name = 'Hematocrit' AND isnumeric = 1 AND iserror = 0 AND value != '') ORDER BY ROW_ID DESC LIMIT 1) AS result"
23065749b2b2053dc0c8dcbc,Tell me the minimum total hospital cost that includes irbesartan.,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'irbesartan' ) GROUP BY cost.hadm_id ) AS T1,,select min(total_hc) from costs where drug in (select drug_name from drug_classes where drug_class_name='Angiotensin II Receptor Antagonists')
d01b05000d59848ec7db20fc,I would like to learn some tips on how to prepare for the tachypnea procedure.,,,select * from medical_tips where procedure_name = 'tachypnea'
cc2bba4f303536420f4558fe,What is the number of patients who had a hyaline casts test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patient_tests WHERE test_name = 'hyaline casts' AND test_date > CURRENT_DATE - INTERVAL '1 year';
e8be8d8ac70685f324507cdc,...when was the last time that patient 60219 had a medication that should be taken regularly?,,,"SELECT TOP 1 DATEADD(day, -1, StartDate) AS LastMedicationDate FROM MedicationPlan WHERE PatientID = 60219 AND DoseType = 'Regular' ORDER BY StartDate DESC"
555044660eecd23dbd5c8fa2,Can you retrieve the top four most frequent lab tests patients had following a diagnosis of secondary malignant neoplasm of bone and bone marrow in the same month?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary malignant neoplasm of bone and bone marrow' ) ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT TOP 4 lab_test_name, COUNT(*) AS frequency FROM patient_records JOIN lab_tests ON patient_records.patient_id = lab_tests.patient_id WHERE patient_records.diagnosis = 'secondary malignant neoplasm of bone and bone marrow' AND lab_tests.test_date >= DATEADD(month, DATEDIFF(month, 0, patient_records.diagnosis_date), 0) AND lab_tests.test_date < DATEADD(month, DATEDIFF(month, -1, patient_records.diagnosis_date), 0) GROUP BY lab_test_name ORDER BY frequency DESC"
9068933037510c1817c920bd,What was the total amount of output from patient 10014078 since 04/09/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-09'",[{'SUM(outputevents.value)': 9445.0}],select sum(amount) from output where patient_id = 10014078 and date >= '2100-04-09'
0de3b7f259a662ea8dea4d2b,How much is the difference of patient 10019777's weight last measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","select ""10019777"", (""PatientWeight"".""value"" - ""PatientWeight1"".""value"") AS ""difference"" from ""PatientWeight"" join ""PatientWeight1"" on ""PatientWeight"".""subject_id"" = ""PatientWeight1"".""subject_id"" and ""PatientWeight"".""encounter_id"" = ""PatientWeight1"".""encounter_id"" and ""PatientWeight"".""value_as_number"" > ""PatientWeight1"".""value_as_number"" where ""PatientWeight"".""subject_id"" = '10019777' and ""PatientWeight"".""encounter_id"" in (select ""encounter_id"" from ""PatientEncounter"" where ""subject_id"" = '10019777' order by ""encounter_id"" desc limit 1)"
86f22514f835be171f0fd68c,What time was the last time the heart rate of patient 10021487 was less than 114.0 on this month/14?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 114.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '14' ORDER BY chartevents.charttime DESC LIMIT 1",[],"select max(time) from health_data where patient_id = 10021487 and heart_rate < 114.0 and time >= date_trunc('month', current_date) and time < date_trunc('month', current_date) + interval '1 month'"
3eb9161ed9a1f7a609811822,What's the cost of a procedure named percutaneous balloon valvuloplasty?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous balloon valvuloplasty' ) ),,"SELECT procedure, cost FROM procedures WHERE procedure_name = 'percutaneous balloon valvuloplasty'"
367a2504a54faf728f7f96fc,"In 2100, what are the top four most frequently tested specimens for patients within 2 months after receiving assistance with cardiac output using balloon pump, continuous?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'assistance with cardiac output using balloon pump, continuous' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,Your answer
fe581d0039127b044368f739,"In their last hospital visit, what was the insurance of patient 10016150?",SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicare'}],SQL Query Here
85c3807521d93484430abc9e,When was patient 10021487 last given an input on 12/17/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-12-17' ORDER BY inputevents.starttime DESC LIMIT 1",[],SELECT MAX(InputDateTime) AS LastInputDateTime FROM PatientInput WHERE PatientID = '10021487' AND InputDateTime <= '2100-12-17 23:59:59';
8b1866c740133c63f16df25c,What's the percentile of 153.0 in a creatine kinase (ck) lab test at the same age as patient 10024043 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase (ck)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 153.0",,SELECT PERCENT_RANK() OVER (ORDER BY ck_value) FROM lab_results WHERE patient_id = 10024043 AND test_type = 'ck' AND age = (SELECT age FROM patients WHERE patient_id = 10024043 AND encounter_date = (SELECT MAX(encounter_date) FROM encounters WHERE patient_id = 10024043)) AND ck_value = 153.0
0b6a628ddf97a2a792d52b70,How many people were given prescriptions for plasmalyte?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'plasmalyte' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) FROM prescriptions WHERE medication_name = 'Plasmalyte'
54ab42240e681be312ba36be,What was the name of the drug that was prescribed to patient 10020306 last time through the im route in 11/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020306 ) AND prescriptions.route = 'im' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime DESC LIMIT 1",[],[SELECT prescription.drug_name FROM prescriptions AS prescription
ac175862df937e28b15bb023,When was the last time that a medication that should be taken regularly was had by patient 594?,,,select max(startdate) from medevents where patid=594 and medtype='regular' and medtaken=1
4d0e1664ae29fa72ddcd640f,How many patients were diagnosed with other specified retention of urine?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified retention of urine' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(*) FROM dataset WHERE diagnosis_code = 'R39.2'
ea3b6816231eff47e5f4ff99,Well tell me what to do ahead of the left heart cardiac cath procedure,,,"SELECT procedure, steps FROM medical_procedure WHERE name='left heart cardiac cath' ORDER BY steps ASC"
90b567e91dc4ca2e45144a58,What is the standard amount of reimbursement for a drug?,,,SELECT standard_reimbursement FROM drugs WHERE drug_type = 'prescription';
ec01a1e86108eda854c5cd91,When was the last time that patient 10038992 had the absolute basophil count minimum value on the first hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute basophil count' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],select max(result_date) as last_min_basophil_count from lab_tests where person_id = 10038992 and lab_test_name = 'Absolute Basophil Count' and visit_occurrence_id = (select min(visit_occurrence_id) from lab_tests where person_id = 10038992) group by result_date having result_value = (select min(result_value) from lab_tests where person_id = 10038992 and lab_test_name = 'Absolute Basophil Count')
13467297765b0e75201a52e3,What are the three most common output instances?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}]","SELECT output_instance, COUNT(*) as frequency FROM dataset GROUP BY output_instance ORDER BY frequency DESC LIMIT 3"
067face22845095ef5e901a0,What is the percentile of 104.0 in a chloride lab test conducted at the same age as patient 10016810 in the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10016810 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 104.0",,SELECT PERCENT_RANK() WITHIN GROUP (ORDER BY chloride_lab_test_result) OVER () AS percentile_rank FROM patient_lab_tests WHERE patient_id = 10016810 AND test_date = (SELECT MAX(test_date) FROM patient_lab_tests WHERE patient_id = 10016810) AND test_name = 'chloride' AND chloride_lab_test_result = 104.0
22ab23e20a87874b13ca865c,What is patient 10010471's heart rate change last measured on the first ICU visit compared to the value first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT patient_id, (max(measured_value) - min(measured_value)) AS heart_rate_change FROM meas WHERE patient_id = 10010471 AND measurement_concept_id = 9031 AND visit_concept_id IN (SELECT visit_id FROM visits WHERE visit_occurrence_id = (SELECT visit_occurrence_id FROM visits WHERE patient_id = 10010471 AND visit_concept_id = 38000280 ORDER BY visit_start_datetime ASC LIMIT 1)) AND visit_occurrence_id IN (SELECT visit_occurrence_id FROM visits WHERE patient_id = 10010471 AND visit_concept_id = 38000280) GROUP BY patient_id;"
c3ad5487d2580375d41c2e06,When was the first time that patient 10008287 had a maximum SaO2?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],select max(date) from patient_data where patient_id = '10008287' and parameter = 'SaO2' group by patient_id
09a8d5869533c169168ee661,Count the total patients who were prescribed nifedipine cr this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'nifedipine cr' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) as total_patients FROM prescriptions WHERE medication_name = 'nifedipine cr' AND YEAR(prescription_date) = YEAR(CURRENT_DATE)
47ed4895c2459c6df72bbc21,And how to find the code that shows icd-11 for mitral valve disorder in icd-10.,,,"[SELECT i10.code AS ICD10_Code, i11.code AS ICD11_Code"
f0fa794eb149befc0d010275,Can you inform me of the first white blood cells test result for patient 10007795 in 04/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '04' ORDER BY labevents.charttime ASC LIMIT 1",[],select top 1 result from laboratory_tests where patient_id = '10007795' and test_type = 'white blood cells' and date between '2023-04-01' and '2023-04-30' order by date asc
3bea1d4c8791561006ff719f,Can you name the procedure/treatment that patient 10015860 was given two or more times since 06/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,"select t.treatment_procedure from (select treatment_procedure, count(treatment_procedure) as cnt from patient_treatment where patient_id=10015860 and date_of_procedure>='06/21' group by treatment_procedure having cnt>1) t;"
3b7aac248d67a932c390edb8,What was the number of patients receiving excision of dental lesion of jaw in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )",,SELECT COUNT(*) FROM patient_records WHERE procedure_code = 'EXCJAW' AND YEAR(procedure_date) = 2100
925ed6c9ab8d40d8dc632226,Did patient 10020944 take a dextrose 5% medication on 03/10/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-03-10'",[{'COUNT(*)>0': 0}],[select distinct a.medication from mde mde
4b0dae2bf00cb70ac501a4d7,Has patient 10003400 been tested in the phosphate lab?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ),[{'COUNT(*)>0': 0}],SELECT DISTINCT c.clinical_id FROM test_results AS t JOIN clinical_patient AS c ON t.clinical_id = c.clinical_id WHERE t.lab_name = 'Phosphate Lab' AND c.clinical_id = '10003400'
6483b1969cfa3eda4e888a7a,What percentile is the value of the mch of 31.5 among patients of the same age as patient 10037928 on the first hospital stay?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 31.5",,SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY mch) AS median_mch FROM (SELECT mch FROM labevents WHERE subject_id = 10037928 AND hadm_id = (SELECT MIN(hadm_id) FROM labevents WHERE subject_id = 10037928) AND itemid = 50862 AND value BETWEEN 30 AND 40 AND category = (SELECT category FROM labevents WHERE itemid = 50862 AND subject_id = 10037928 AND hadm_id = (SELECT MIN(hadm_id) FROM labevents WHERE subject_id = 10037928))) AS age_group_mch
90c8f7dcff48de642efa7222,Tell me what the top three most common diagnoses of patients with an age of 60 or above throughout this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT Diagnosis, COUNT(*) AS diagnosis_count FROM PatientRecords WHERE Age >= 60 AND Year = 2023 GROUP BY Diagnosis ORDER BY diagnosis_count DESC LIMIT 3"
a8995e515e945700a73e1a38,What is the minimum total cost at a hospital including a lymphocytes laboratory test in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_cost) FROM hospital_costs WHERE lymphocytes_test = 'yes' AND year = 2100
2c4e5ef20f7bc4bff7aa7301,Has any organism been found in patient 10021487's last sputum test conducted in 12/this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],SELECT EXISTS (SELECT 1 FROM microbiology.labs WHERE labId = 'sputum' AND patientId = '10021487' AND labDate = (SELECT MAX(labDate) FROM microbiology.labs WHERE labId = 'sputum' AND patientId = '10021487' AND EXTRACT(YEAR FROM labDate) = EXTRACT(YEAR FROM CURRENT_DATE) AND EXTRACT(MONTH FROM labDate) = 12) AND organism IS NOT NULL)
c4e7ab7b177fe5ebd0e590fc,When did patient 10019172's last input since 10/10/2100 occur?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-10-10' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2118-11-19 19:30:00'}],select max(date) from inputevents_mv where person_id = 10019172 and date > '10/10/2100'
8e71be5e11c9a90ff530970e,When was the first time that patient 10021487 was prescribed chlorhexidine gluconate 0.12% oral rinse and famotidine in this month at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'famotidine' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse' AND admissions.subject_id = 10021487 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],SELECT MIN(prescribe.drug_time) FROM prescribe INNER JOIN drug ON prescribe.drug_id = drug.drug_id WHERE prescribe.patient_id = 10021487 AND (drug.drug_name = 'chlorhexidine gluconate 0.12% oral rinse' OR drug.drug_name = 'famotidine') AND MONTH(prescribe.drug_time) = MONTH(CURRENT_DATE()) AND YEAR(prescribe.drug_time) = YEAR(CURRENT_DATE()) GROUP BY prescribe.patient_id HAVING COUNT(DISTINCT drug.drug_name) = 2
2f95bc2423afa4e0a3965518,Get the count of the number of hospital visits of patient 10039708 since 2100.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10039708 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT( DISTINCT admissions.hadm_id )': 10}],SELECT COUNT(*) AS visit_count FROM hospital_visits WHERE patient_id = '10039708' AND visit_date >= '2100-01-01';
b90482cec7b5c892ea5302f4,What percentile is 13.0 urea nitrogen in a patient of the same age as patient 10022017 on their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 13.0",,[SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY lab_result.value)
f2719ed44a2bcf2baaa42242,"What is the minimum total hospital cost which involves congestive heart failure, unspecified in 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SQLQuery
ccf62a429718ac33d9c26686,What are the three most common specimen tests that occurred since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT test_name, COUNT(*) AS test_count FROM laboratory_tests WHERE test_date >= '2100-01-01' GROUP BY test_name ORDER BY test_count DESC LIMIT 3"
c0cedb965b06326bbddb2eb4,Calculate the number of patients discharged from the hospital since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SQL Query Here
2c9a172538d37c27f588e4f8,"What is the percentile of 9.3 in the laboratory test with calcium, total at the same age of patient 10007818 on their last hospital encounter?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 9.3",,"SELECT PERCENT_RANK() OVER (ORDER BY calcium_total) FROM laboratory_tests WHERE patient_id = 10007818 AND age = (SELECT age FROM patient_encounters WHERE patient_id = 10007818 ORDER BY encounter_date DESC LIMIT 1) AND test_name = 'calcium, total' AND value = 9.3"
64dfb6c9030d4565fdcadb6f,When patient 10010471 was first discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10010471 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2155-05-10 18:55:00'}],SELECT MIN(DischargeDate) FROM patient_admissions WHERE PatientID = 10010471
83cc6dc500e1e949c8a26cdc,"Compared to measured at 2100-08-20 07:00:00 , is the o2 saturation pulseoxymetry value of patient 10006580 greater than measured at 2100-08-20 06:00:00?",SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-08-20 07:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-08-20 06:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-08-20 07:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-08-20 06:00:00' )"": None}]",select case when (select o2_saturation_pulseoxymetry_value from (select * from `physionet-data.mimiciii_clinical.labevents` where subject_id = 10006580 and o2_saturation_pulseoxymetry_value is not null and itemid in (220277) and charttime >= '2021-08-20 07:00:00' and charttime <= '2021-08-20 07:00:00' order by charttime desc limit 1) as t1) > (select o2_saturation_pulseoxymetry_value from (select * from `physionet-data.mimiciii_clinical.labevents` where subject_id = 10006580 and o2_saturation_pulseoxymetry_value is not null and itemid in (220277) and charttime >= '2021-08-20 06:00:00' and charttime <= '2021-08-20 06:00:00' order by charttime desc limit 1) as t2) then 'yes' else 'no' end as is_greater
dcebcd167c495b6e52892fc8,I would like to know the top four diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 4 )",,"SELECT TOP 4 diagnosis, MAX(mortality_rate_3month) AS max_mortality_rate FROM diagnoses GROUP BY diagnosis ORDER BY max_mortality_rate DESC;"
5c8d918b88b696fa22b10f23,What are the four most common prescriptions in 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4",[],"SELECT prescription_name, COUNT(*) AS prescription_count FROM prescriptions WHERE year = 2100 GROUP BY prescription_name ORDER BY prescription_count DESC LIMIT 4"
c8111e2baf3638b5ee8951da,What specimen test has patient 10007795 received for the first time since 08/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'BLOOD CULTURE'}],"select distinct * from patient_test where patient_id=10007795 and test_date>=""08/21/2010"" and test_id not in (select test_id from patient_test where patient_id=10007795 and test_date<""08/21/2010"")"
509007e836380f20bbceca57,Retrieve the top five most frequent lab tests that patients had after being diagnosed with ulcer of other part of foot in the same month since 1 year ago.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'ulcer of other part of foot' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT test_name, COUNT(*) AS test_count FROM lab_tests lt INNER JOIN diagnoses d ON lt.patient_id = d.patient_id WHERE d.condition = 'ulcer of other part of foot' AND lt.date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND MONTH(lt.date) = MONTH(d.diagnosis_date) AND YEAR(lt.date) = YEAR(d.diagnosis_date) GROUP BY test_name ORDER BY test_count DESC LIMIT 5"
4f9e42945038788848999c30,Display the top five most commonly prescribed drugs since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}, {'drug': 'Acetaminophen'}]","SELECT drug_name, COUNT(*) AS prescription_count FROM prescriptions WHERE prescription_date >= DATE_SUB(NOW(), INTERVAL 1 YEAR) GROUP BY drug_name ORDER BY prescription_count DESC LIMIT 5;"
458ec4c0b0b1086e917fb739,Tell me the time when patient 10018081's systolic blood pressure was less than 118.0 for the last time yesterday?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 118.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT TOP 1 MeasurementDate, Systolic FROM patient_records WHERE PatientID = 10018081 AND Systolic < 118.0 AND MeasurementDate >= DATEADD(day, DATEDIFF(day, 0, GETDATE()) - 1, 0) AND MeasurementDate < DATEADD(day, DATEDIFF(day, 0, GETDATE()), 0) ORDER BY MeasurementDate DESC"
4678e394b805643ece243dbd,"What are the top four most common microbiology tests that patients were diagnosed with after the diagnosis of spinal stenosis, lumbar region, without neurogenic claudication within the same hospital visit?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, without neurogenic claudication' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"SELECT TestName, COUNT(*) AS Frequency FROM Tests WHERE DiagnosisCode = (SELECT DiagnosisCode FROM Diagnoses WHERE Diagnosis = 'spinal stenosis, lumbar region, without neurogenic claudication') AND HospitalVisitId = (SELECT HospitalVisitId FROM Diagnoses WHERE Diagnosis = 'spinal stenosis, lumbar region, without neurogenic claudication') GROUP BY TestName ORDER BY Frequency DESC LIMIT 4;"
3eee431c56b7e26f4a97d69f,Please calculate the total output for patient 10011398 since 07/15/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-15'",[{'SUM(outputevents.value)': 4314.0}],SELECT SUM(Output) FROM PatientOutput WHERE PatientID = 10011398 AND Date >= '07/15/2100';
df128c1c320ab7a3577dbe3e,When did patient 10020187 get discharged from the hospital for the first time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020187 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[],SELECT MIN(discharge_date) FROM hospital_records WHERE patient_id = 10020187 AND discharge_date IS NOT NULL;
a3bc01d2aacfcab611fc1c53,Please send me the name of the diagnostic diagnosis patient 5828 received at the other department.,,,SELECT DiagnosisName FROM PatientDiagnoses WHERE PatientID = 5828 AND Department = 'Other'
7344c8361b0e586129656284,"Was there a restriction of left internal carotid artery with intraluminal device, percutaneous approach procedure performed on patient 10018328 on their last hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )",[{'COUNT(*)>0': 0}],[SELECT CASE WHEN EXISTS (
6a6f09403ba82cc0aaa73daa,When in 12/2100 did patient 10021118 get the last microbiology test?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT last_test_date FROM microbiology_tests WHERE patient_id = '10021118' AND test_date <= '12/31/2100' ORDER BY test_date DESC LIMIT 1
3eb0479be3a32cecf1cfc9a1,Can you tell the daily maximum dose of or crystalloid intake that patient 10026354 received since 07/08/2100?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-08' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],"select max(oral_dose_mg), max(crystalloid_ml) from daily_intake where patient_id = 10026354 and intake_date >= '07/08/2100'"
dd637812c5b2444154d1942b,What was the first time that patient 10016742 had a minimum heart rate during the first ICU visit?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(HeartRate) AS MinHeartRate, MIN(MeasurementTime) AS FirstTime FROM PatientMeasurements WHERE PatientID = '10016742' AND ICUVisitNumber = 1 AND HeartRate IS NOT NULL GROUP BY PatientID ORDER BY FirstTime LIMIT 1"
e9b6fc1c47118c5de09e95d7,"What are the three most frequently administered laboratory tests for patients previously diagnosed with chronic airway obstruction, not elsewhere classified during the same hospital visit, since 1 year ago?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic airway obstruction, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )",,"[SELECT TestName, COUNT(TestName) AS Frequency FROM LabTests"
5ebecd683c34753383eaaa76,What medication was prescribed for the first time during their first hospital visit to patient 10003046?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Iso-Osmotic Dextrose'}],"select top 1 med_name from medprescriptions where pat_id = 10003046 and first_hosp_visit = 1 order by med_rec_date, med_rec_time"
c1f3f0db61bac26ec0d7afba,What were the four most frequently given diagnoses for patients who received percutaneous abdominal drainage previously within 2 months?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"select d.diagnosis, count(*) as freq from diagnoses d join patients p on p.patient_id = d.patient_id join procedures proc on p.patient_id = proc.patient_id where proc.procedure_type = 'percutaneous abdominal drainage' and proc.date between date_sub(d.diagnosis_date, interval 2 month) and d.diagnosis_date group by d.diagnosis order by freq desc limit 4;"
f84ac0f635563a2f0fad1c41,When was the first time the systolic blood pressure of patient 10009628 was measured at a reading less than 123.0 in the first ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 123.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],select min(medical_events.encounter_start_date) from medical_events join vital_events on medical_events.encounter_id = vital_events.encounter_id where vital_events.vital_sign_name = 'systolic blood pressure' and vital_events.measurement = '<123.0' and vital_events.patient_id = '10009628' and medical_events.encounter_type = 'ICU' and vital_events.encounter_id = medical_events.encounter_id group by medical_events.encounter_id having count(medical_events.encounter_id) = 1
5e54019ee712a69d9eb50369,"What are the three frequently tested specimens for patients that received extirpation of matter from left femoral vein, percutaneous approach previously within 2 months this year?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"[SELECT TOP 3 SpecimenType, COUNT(*) AS Frequency"
db31b23e92a6097f61552803,Was patient 10005817 involved in any medical procedure last year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,SELECT COUNT(*) FROM medical_procedures WHERE patient_id = '10005817' AND procedure_date BETWEEN '2022-01-01' AND '2022-12-31'
9258a1a83e5bbfc697468adf,What is the count of prochlorperazine prescriptions made since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prochlorperazine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')",[{'COUNT(*)': 0}],"SELECT COUNT(*) FROM prescriptions WHERE medication_name = 'prochlorperazine' AND prescription_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
ffefdb9195190d8fcb86fa14,How much does it cost for phenytoin sodium (iv)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'phenytoin sodium (iv)' ),,SELECT cost FROM medication_prices WHERE name = 'phenytoin sodium' AND route = 'iv'
1c91054ab8b9cc71f46ad1dd,"Since 2100, how many patients were diagnosed with type 2 diabetes mellitus with diabetic polyneuropathy?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus with diabetic polyneuropathy' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,"SELECT COUNT(DISTINCT patient_id) as patient_count FROM patient_diagnoses WHERE diagnosis_date >= '2100-01-01' AND diagnosis_code IN ('E11.40', 'E11.41') AND patient_diagnoses.patient_id IN (SELECT patient_id FROM patient_conditions WHERE condition_code = 'G62.9')"
aa7534c96dd01ae4543b138b,What's the average total cost of the hospital that involves a procedure called diagnostic ultrasound of heart since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of heart' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT hospital_id, AVG(total_cost) AS average_total_cost FROM medical_records WHERE procedure_name = ""diagnostic ultrasound of heart"" AND date > CURRENT_DATE - INTERVAL '1 year' GROUP BY hospital_id;"
960af01d63ac5e922c0eb129,"What are the top five most common specimens being tested for patients who were diagnosed with personal history of irradiation, presenting hazards to health within the same month in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of irradiation, presenting hazards to health' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,SQL Query Here
c27b7ef096a3a3f132083738,"In 07/2100, levothyroxine sodium, 0.45% sodium chloride, or lisinopril was prescribed for patient 10002428.","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND prescriptions.drug IN ( 'levothyroxine sodium', '0.45% sodium chloride', 'lisinopril' ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-07'",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM prescriptions WHERE patient_id = '10002428' AND (drug IN ('levothyroxine sodium', 'sodium chloride', 'lisinopril')) AND prescription_date BETWEEN '2100-07-01' AND '2100-07-31'"
ce91ec91b6aaa48439b33e96,What is the procedure of the anticancer drugs.,,,select distinct procedure from drug_concept_stage where drug_concept_stage.concept_name like '%anticancer%'
682676ee539e16fc31ab086e,How many patients were discharged from hospitals?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(patient_id) FROM Patient WHERE discharge_date IS NOT NULL;
24ad2857877ae3f6da374f4c,How many medications were assigned to patient 10038999 throughout this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)': 0}],"SELECT COUNT(DISTINCT MEDICATION) FROM MEDICATIONS WHERE PATIENT_ID = 10038999 AND EXPIRY_DATE >= DATE_FORMAT(NOW() ,'%Y-01-01') AND EXPIRY_DATE <= NOW()"
97acefe23c241af475dc236d,"Has patient 10029291 been treated with introduction of other thrombolytic into central vein, percutaneous approach this year?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,admissions
05a0dd22ccfcd8bac854d247,"Did patient 10018423 have a performance of cardiac output, continuous procedure on the first hospital stay?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of cardiac output, continuous' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )",[{'COUNT(*)>0': 0}],select distinct a.patient_num from cpt_event a inner join cpt c on a.cpt_cd = c.cpt_cd inner join encounter e on a.encntr_id = e.encntr_id inner join person p on e.patient_id = p.person_id inner join person_alias pa on p.person_id = pa.person_id inner join visit_occurrence vo on e.encntr_id = vo.encntr_id where a.patient_num = '10018423' and c.cpt_desc like '%performance of cardiac output%' and c.cpt_proc = 1 and vo.visit_start_date = (select min(visit_start_date) from visit_occurrence where person_id = (select person_id from person where person_id = pa.person_id and person_alias_type_cd = 9998)) and e.encntr_class_cd = 16
807c6c3264c76b6faa008696,What was patient 10006580's documented weight on the last record on the first hospital stay?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],SELECT TOP 1 weight FROM MedicalRecords WHERE patient_id = 10006580 AND hospital_stay = 1 ORDER BY record_date DESC
bf62c5424509b587645d8c69,"What is the diagnosis price for anoxic brain damage, not elsewhere classified?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anoxic brain damage, not elsewhere classified' ) )",,"SELECT diagnosis_price FROM Diagnoses WHERE diagnosis_description='Anoxic brain damage, not elsewhere classified'"
267d7c119f8d5f96a44c309d,What was the name of the prescription drug given to patient 10025463 in the same hospital visit after undergoing the cardiac mapping procedure since 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'cardiac mapping' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,SELECT Prescription.drug_name FROM Prescription JOIN Patient ON Prescription.patient_id = Patient.id JOIN HospitalVisit ON Patient.id = HospitalVisit.patient_id WHERE Patient.id = 10025463 AND HospitalVisit.visit_date > (SELECT visit_date FROM HospitalVisit JOIN Procedure ON HospitalVisit.id = Procedure.visit_id WHERE Procedure.name = 'cardiac mapping' AND HospitalVisit.patient_id = 10025463 AND HospitalVisit.visit_date >= '08/2100') AND HospitalVisit.id IN (SELECT visit_id FROM Procedure WHERE Procedure.name = 'cardiac mapping' AND HospitalVisit.patient_id = 10025463)
dcfe3d31d256b6f0069568e5,"When, since 02/2100, was the first time patient 10027445 was prescribed a medication via the nu route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND prescriptions.route = 'nu' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ORDER BY prescriptions.starttime ASC LIMIT 1",[],[SELECT MIN(Prescription_Date) AS First_Nu_Route_Prescription_Date
3d9d7abd6d9d5b5188725536,What was the total sum of inputs for patient 10007058 since 02/25/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-25'",[{'SUM(inputevents.totalamount)': 10975.0}],select sum(value) from input where person_id=10007058 and input_date >= '02/25/2100'
0845c5b2d9f8bde33129dc7a,Can you tell me which five diagnoses have the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",,"SELECT TOP 5 diagnosis, mortality_rate_3_months FROM medical_records ORDER BY mortality_rate_3_months DESC"
c8b66e1569afc7477b2048fb,What was the last drug that patient 10019917 had been prescribed via the sc route on the first hospital encounter?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT TOP 1 drug_name FROM prescriptions WHERE patient_id = '10019917' AND route = 'sc' AND encounter_number = '1' ORDER BY date_prescribed DESC
8afa74497c4d9b8c7f0fe659,What are the three diagnoses with the lowest 3-month survival rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",,"SELECT TOP 3 dx, SUM(DEATH_EVENT) * 1.0 / COUNT(DIABETES_MED) AS survival_rate FROM diabetes_table GROUP BY dx ORDER BY survival_rate ASC"
def0418fbc10900a82ffd5b9,How many cases involved the prescription of insulin (regular) for hyperkalemia since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'insulin (regular) for hyperkalemia' AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM records WHERE prescription = 'insulin (regular)' AND condition = 'hyperkalemia' AND year >= 2100
4d0cbd90ae58506f9467785f,When was the last time that patient 10001725 was tested for eosinophils on their first hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'eosinophils' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT max(date) FROM labevents WHERE subject_id = 10001725 AND itemid = 50882 AND hadm_id = (SELECT min(hadm_id) FROM labevents WHERE subject_id = 10001725)
62c407ce4b823a8f721bf1b5,What are the five most regularly ordered treatments for patients previously diagnosed with injury to thoracic aorta within the same month in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to thoracic aorta' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"[SELECT Treatment, COUNT(Treatment) as Frequency FROM Orders"
abf27942525ea42427bca966,Is the value of anion gap of patient 10031404 second measured on the first hospital visit less than the value first measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT (SELECT value FROM labevents WHERE patientnum = 10031404 AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Anion Gap') AND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = (SELECT subject_id FROM patients WHERE patientnum = 10031404) ORDER BY admittime LIMIT 1) AND charttime = (SELECT MAX(charttime) FROM labevents WHERE patientnum = 10031404 AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Anion Gap') AND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = (SELECT subject_id FROM patients WHERE patientnum = 10031404) ORDER BY admittime LIMIT 1))) < (SELECT value FROM labevents WHERE patientnum = 10031404 AND itemid = (SELECT itemid FROM d_labitems WHERE label = 'Anion Gap') AND hadm_id = (SELECT hadm_id FROM admissions WHERE subject_id = (SELECT subject_id FROM patients WHERE patientnum = 10031404) ORDER BY admittime LIMIT 1) AND charttime = (SELECT MIN(charttime) FROM labevents WHERE patientnum = 10031404 AND itemid =
ef68de2dc19e6a02e19bace9,What was the medication that patient 10004733 was prescribed for in the same day after receiving central venous catheter placement with guidance in this hospital visit?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,SELECT DISTINCT Medication_Name FROM Medication_Administration JOIN Central_Venous_Catheter_Placement ON Medication_Administration.Patient_ID = Central_Venous_Catheter_Placement.Patient_ID AND Medication_Administration.Date = Central_Venous_Catheter_Placement.Date WHERE Medication_Administration.Patient_ID = 10004733 AND Medication_Administration.Time > Central_Venous_Catheter_Placement.Time
67a50f9b79bc4e4a7c653ac5,What are the five most frequent diagnoses that patients were diagnosed within 2 months after having received a excision of dental lesion of jaw procedure?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,your SQL here
6f9e8ee2deac4ff0313cfd13,When has patient 10029484 been prescribed medication for the first time in 11/this year via the po/ng route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.route = 'po/ng' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"SELECT MIN(prescription_date) AS first_prescription_date FROM prescriptions WHERE patient_id = 10029484 AND YEAR(prescription_date) = YEAR(CURDATE()) AND MONTH(prescription_date) = 11 AND route IN ('po', 'ng')"
8db3a499f8e4f04b7f55b1a4,What procedure was given to patient 10005909 two times during the last month?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",,"SELECT ProcedureName FROM Procedures WHERE PatientID = 10005909 AND ProcedureDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND CURDATE() GROUP BY ProcedureName HAVING COUNT(*) = 2"
315e7c004443575bb2996afc,When was patient 10015272's last maximum chloride value in their first hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],"SELECT MAX(cl1_chloride_val), cl1_encounter_dt FROM lab WHERE patid = 10015272 AND cl1_chloride_val IS NOT NULL AND cl1_encounter_id = (SELECT MIN(cl1_encounter_id) FROM lab WHERE patid = 10015272) GROUP BY cl1_encounter_dt ORDER BY cl1_encounter_dt DESC LIMIT 1;"
b3f1921213d20471bf74e2f5,What was the name of the drug that was prescribed to patient 10027445 in the same hospital encounter after having had a percutaneous balloon valvuloplasty procedure since 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous balloon valvuloplasty' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,SELECT distinct drug_name FROM prescriptions INNER JOIN encounters ON prescriptions.encounter_id = encounters.encounter_id WHERE encounters.patient_id = 10027445 AND encounters.procedure_name LIKE '%percutaneous balloon valvuloplasty%' AND prescriptions.encounter_id = encounters.encounter_id AND prescriptions.encounter_id > (SELECT encounter_id FROM encounters WHERE patient_id = 10027445 AND procedure_name LIKE '%percutaneous balloon valvuloplasty%' AND encounter_datetime >= '08/2100') ORDER BY prescriptions.encounter_datetime ASC LIMIT 1
cc4241e21c09d7f7c2b141ff,What was the cost of the drug albumin 5% (25g / 500ml)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'albumin 5% (25g / 500ml)' ),,"SELECT * FROM drug_costs WHERE drug_name = ""albumin 5% (25g / 500ml)"""
b78c0434ecf85c58970b853d,What is the cost of a diagnosis of long term (current) use of anticoagulants?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of anticoagulants' ) ),,SELECT cost FROM diagnosis WHERE description = 'Long term (current) use of anticoagulants'
c040519bfaa35e04239eecbd,Has patient 10020944 been admitted into an emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room',[{'COUNT(*)>0': 0}],"select count(*) from (select distinct e.patient_id from admissions as a inner join encounters as e on a.encounter_id = e.encounter_id and a.encounter_type in (""EMERGENCY ROOM"", ""EMERGENCY ROOM"", ""EMERGENCY ROOM - TREATMENT"", ""EMERGENCY ROOM - TREATMENT"")) as e where e.patient_id = 10020944"
ec8e06e2b743a81436720c46,"Since 1 year ago, how many patients were provided with tamoxifen citrate?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],prescriptions
e2f69e562ea54caf705bd0c2,How many patients are there presently admitted?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(patient_id) FROM admissions WHERE admission_date = CURRENT_DATE AND discharge_date IS NULL;
7109e759c570a654d53e3ee4,Was patient 10006053 involved in any medical procedure on their first hospital visit?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],SELECT * FROM medical_procedures WHERE patient_id = '10006053' AND visit_number = 1
b5b6f1a8e33ce9cea9bd0292,When was the last time patient 10007928 had the maximum rdw during the last hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],SELECT TOP 1 eventDate FROM labevents WHERE subject_id = 10007928 AND (rdw IS NOT NULL) AND (rdw > 0) AND (value_source_concept_id = 3023309) AND (hadm_id IN (SELECT TOP 1 hadm_id FROM labevents WHERE subject_id = 10007928 ORDER BY eventDate DESC)) ORDER BY eventDate DESC
86cbd6023ea3c6b4277ad089,Quantify the number of patients who were tested since 2100 for ferritin.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND strftime('%Y',labevents.charttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS number_of_patients FROM blood_tests WHERE test_date > '2100-01-01' AND test_name = 'ferritin'
21e50a8f4be7dfdd1d9fb392,Did patient 66015 ever have any side effects during a blood transfusion?,,,SELECT DISTINCT * FROM transfusions WHERE patient_id = 66015 AND side_effects IS NOT NULL
47dbc50e60c6491af7433121,Find out the number of drugs given to patient 10039997 since 02/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02'",[{'COUNT(*)': 59}],SELECT COUNT(DISTINCT drug_id) AS number_of_drugs FROM prescriptions WHERE patient_id = 10039997 AND date >= '02/2100';
af5515bbc62c20e665bfdae3,Is the chloride level of patient 10006053 second measured on the first hospital visit greater than the first measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN MAX(CASE WHEN v.visit_id = 1 AND v.measurement_id = 2 THEN c.value ELSE NULL END) > MIN(CASE WHEN v.visit_id = 1 AND v.measurement_id = 1 THEN c.value ELSE NULL END) THEN 'Yes' ELSE 'No' END AS Is_Greater FROM patient p INNER JOIN visit v ON p.patient_id = v.patient_id INNER JOIN component c ON v.visit_id = c.visit_id WHERE p.patient_id = '10006053' AND c.component_id = 9 AND v.visit_order = 1 AND v.hospital_visit_order = 1
bb0544fc1cbc2ba271291243,What is the sex of patient 10020306?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020306,[{'gender': 'F'}],SELECT sex FROM patient WHERE patient_id = '10020306';
2d8f9dd2fbaff9e32a728bc4,"Has there been any phenobarbital, atenolol, or sodium chloride 0.9% ordered for patient 10018501 in 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND prescriptions.drug IN ( 'phenobarbital', 'atenolol', 'sodium chloride 0.9%' ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) FROM orders WHERE orderid IN ('phenobarbital', 'atenolol', 'sodium chloride 0.9%') AND personid=10018501 AND YEAR(orderdate)=2100"
24fdc72bfa641df5e25a4dd3,"What's the price of a procedure referred to as closed reduction of fracture with internal fixation, femur?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed reduction of fracture with internal fixation, femur' ) )",,SQL Query
40e6d3bcc00d291b26feb3e7,When did patient 10010471 first receive an input in their first ICU visit?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime ASC LIMIT 1,[{'starttime': '2155-12-02 20:54:00'}],"select min(date) from icustays where icustay_id in (select icustay_id from patients, icd_diagnoses, d_icd_diagnoses where patients.subject_id = icd_diagnoses.subject_id and icd_diagnoses.icd_diagnosis_id = d_icd_diagnoses.icd_diagnosis_id and d_icd_diagnoses.icd_code like 'I63%' and patients.subject_id = 10010471)"
cd68238c19445383f9469b6b,Is the temperature celsius level of patient 10005817 second measured on the last ICU visit greater than the first measurement on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN MAX(temp_celsius) > MIN(temp_celsius) THEN 'Yes' ELSE 'No' END AS is_second_measurement_greater FROM patient_measurements WHERE patient_id = '10005817' AND visit_id = (SELECT MAX(visit_id) FROM patient_visits WHERE patient_id = '10005817') AND measurement_time IN (SELECT measurement_time FROM patient_measurements WHERE visit_id = (SELECT MAX(visit_id) FROM patient_visits WHERE patient_id = '10005817') ORDER BY measurement_time ASC LIMIT 2);
01a258cef08c0eb27a9ef878,What methods are used to ingest emtricitabine-tenofovir (truvada)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'emtricitabine-tenofovir (truvada)',[],SELECT method_of_ingestion FROM MedicationAdministration WHERE medication_name = 'emtricitabine-tenofovir (truvada)'
dcd2227eec0068298417064f,Give a count of the number of ICU visits of patient 10020187 throughout this year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT( DISTINCT icustays.stay_id )': 0}],SELECT COUNT(*) AS ICU_Visit_Count FROM HospitalStays WHERE PatientID = '10020187' AND StayType = 'ICU' AND YEAR(AdmissionDate) = YEAR(CURDATE());
c7ae2e00343bbb04614217b6,What medication was prescribed to patient 10023239 first time on their first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Levothyroxine Sodium'}],SELECT TOP 1 medication FROM prescriptions WHERE patient_id = '10023239' AND visit_number = 1 ORDER BY prescription_date ASC
fa51b74dc317c3f8478a0ff5,List the top five most frequently tested specimens in 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],"SELECT Specimen, COUNT(*) as TestCount FROM LaboratoryRecords WHERE Year = 2100 GROUP BY Specimen ORDER BY TestCount DESC LIMIT 5"
fec62efd2a043cb3d54efd38,How many days was patient 10020740's first stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 7.446423612069339}]","SELECT DATEDIFF(day, MIN(AdmissionTime), MAX(DischargeTime)) AS DaysInICU FROM PatientRecords WHERE PatientID = 10020740 AND StayNumber = 1 AND DischargeLocation = 'ICU'"
790f43812849f0e3f94c3c15,"In the first hospital encounter, what age was patient 10020187?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,,"select patient_id, age from first_hospital_encounter where patient_id = '10020187'"
368dc6fa47ea7885905c48d5,How is olanzapine (disintegrating tablet) taken?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'olanzapine (disintegrating tablet)',[],"SELECT Form, Instruction FROM MedicationAdministration WHERE MedicationName = ""olanzapine (disintegrating tablet)"""
6d8b67dc5b7691af8bcd4937,When was patient 10020740 prescribed a medication via the iv route the first time in 03/this year?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ORDER BY prescriptions.starttime ASC LIMIT 1",[],select min(date) from emr_medication_administration where patient_id = 10020740 and route = 'IV' and date between '2023-03-01' and '2023-03-31'
3a071ace73b6a8ed27c95001,"For patient 10021487, what were the first calcium, urine lab results during this month?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, urine' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT TOP 1 result FROM lab_tests WHERE patient_id = '10021487' AND test_name = 'urine calcium' AND date BETWEEN 'YYYY-MM-01' AND 'YYYY-MM-31' ORDER BY date ASC
41deb2b6334194be2b87c10f,Count the number of medicines that have been prescribed to patient 10021312.,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ),[{'COUNT(*)': 126}],SELECT COUNT(DISTINCT drug) FROM prescriptions WHERE patient_id = 10021312;
f74c6d45811f3d87dac9bdc2,When was the first time patient 10038999 had a SaO2 that was greater than 96.0 since 02/02/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 96.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-02-02' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(RecordDate) FROM `physionet-data.mimiciv_clinical.icustays` WHERE SubjectID = 10038999 AND SaO2 > 96.0 AND RecordDate >= '2100-02-02'
db4ef4453f0482846262ad5c,Tell me the total number of patients who stayed in cardiac surgery this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac surgery' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from patients where surgery_type='cardiac' and admission_date between '2023-01-01' and '2023-12-31'
e55cd6da77f12e9a3c3752aa,What were the three most frequent microbiology tests that occurred throughout this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3",[],SQL Query Here
3b0b9d06060760720fcc6f1d,Has patient 10005817 been diagnosed with anything?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ),[{'COUNT(*)>0': 1}],SELECT DISTINCT diagnosis FROM patient_records WHERE patient_id = 10005817 AND diagnosis IS NOT NULL
01c02f4b897bb8192e16bd1d,What was patient 10016742's minimum value of base excess in 07/this year?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'base excess' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07'",[{'MIN(labevents.valuenum)': None}],"select min(base_excess) from chartevents where subject_id='10016742' and charttime::date >= date_trunc('year', current_date) and itemid in (50912)"
ecd2a10f46954975185155af,What was during the last month patient 10038992's minimum alanine aminotransferase (alt) value?,"SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')",[{'MIN(labevents.valuenum)': None}],"SELECT MIN(alt) FROM lab_results WHERE patient_id = 10038992 AND date >= DATE_SUB(NOW(), INTERVAL 1 MONTH)"
d6121ad75765bc51dceaf4c9,When patient 10018501 was last discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10018501 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[{'dischtime': '2141-08-05 18:06:00'}],SELECT MAX(discharge_date) FROM hospital_records WHERE patient_id = '10018501' AND discharge_date IS NOT NULL
328c8f2538243e8dd6f5da24,What was the total cefpodoxime proxetil dose that has been prescribed during the first hospital encounter to patient 10020786?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'cefpodoxime proxetil',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(cefpodoxime_proxetil_dose) FROM first_hospital_encounter WHERE patient_id = 10020786
beba565897d39febcb35f999,"How many hours have passed since patient 10018081 got her first diagnosis of congestive heart failure, unspecified on this hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'congestive heart failure, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,SQL Query Here
215bb31f610d65f9b86033ff,How many hours is it since patient 10021487 first received the epithelial cells lab test during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT DATEDIFF(HOUR, MIN(DT_RESULT), CURRENT_TIMESTAMP) AS HoursSinceFirstTest FROM LAB_RESULT WHERE PERSON_ID = 10021487 AND LAB_TEST_CD = 'Epithelial cells' AND DT_RESULT BETWEEN DATEADD(DAY, -30, CURRENT_TIMESTAMP) AND CURRENT_TIMESTAMP"
65f6f12656c77dd1d0e81081,How much does the drug clobetasol propionate 0.05% ointment cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'clobetasol propionate 0.05% ointment' ),,SELECT cost FROM drug_costs WHERE drug_name='clobetasol propionate 0.05% ointment'
eb857cd3f9ec24928e8c1674,When was the first time patient 10018081 SaO2 was measured greater than 98.0 yesterday.,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 98.0 AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],SQL Query
3e1d007895353da9f631ad02,List the top three most common events this year.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 3 )",[],"SELECT `Event`, COUNT(*) AS `EventCount` FROM `Events` WHERE `Year` = YEAR(CURDATE()) GROUP BY `Event` ORDER BY `EventCount` DESC LIMIT 3"
3ebc0a16e6352b3a0ce7bfab,"For patients diagnosed with right bundle branch block before, what are the top four most common treatments within the same month since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'right bundle branch block' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,
1768d3075c1fd4b1f229afae,Has patient 10018845 received a laboratory test since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'",[{'COUNT(*)>0': 1}],SELECT * FROM laboratory_tests WHERE patient_id = 10018845 AND test_date > '2100-04-01'
e1bb157131c54de5c76b3a0c,When did patient 10018081 have the first systolic blood pressure observed to be less than 130.0 on this ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 130.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],"select min(first_intime) from mimiciii.icustays a join mimiciii.labevents b on a.subject_id = b.subject_id and a.hadm_id = b.hadm_id where b.ITEMID in (50802,50800) and b.VALUE <= '130' and a.subject_id = '10018081'"
b628445609db036ce56787c3,Has there been any organism present in patient 10038999's first pleural fluid microbiology test since 8 months ago?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-8 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)>0': 0}],"SELECT * FROM microbiology_tests WHERE patient_id = 10038999 AND test_type = 'pleural_fluid' AND test_date >= DATE_SUB(CURRENT_DATE, INTERVAL 8 MONTH) AND organism_detected IS NOT NULL"
7ccdae90c6ad3af703d3e038,List the top three most common diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]","SELECT Diagnosis, COUNT(*) AS Frequency FROM patient_records GROUP BY Diagnosis ORDER BY Frequency DESC LIMIT 3"
8a73eab771e03264c24fffde,What was the first value of respiratory rate patient 10014078 had?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],SELECT MIN(RESPIRATORY_RATE) FROM PATIENT_VITALS WHERE PATIENT_ID = 10014078;
63e6ff5237da6b07b0c8a2d7,Tell me the count of other and unspecified pneumonectomy procedures that took place since 1 year ago.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other and unspecified pneumonectomy' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')",,procedure_occurrence
822c7c92c1f48adca005dc81,Show the number of patients who underwent clipping of aneurysm since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'clipping of aneurysm' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )",,SELECT COUNT(*) AS num_patients FROM patient_data WHERE procedure = 'clipping of aneurysm' AND date >= '2100-01-01'
d4a8c8cbd9db88a331e52ca2,"During their last hospital visit, was patient 10014078 admitted to an emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'COUNT(*)>0': 0}],SELECT CASE WHEN emergency_room_admission = 'Yes' THEN 'Admitted to Emergency Room' ELSE 'Not Admitted to Emergency Room' END AS AdmissionStatus FROM hospital_visits WHERE patient_id = 10014078 AND visit_date = (SELECT MAX(visit_date) FROM hospital_visits WHERE patient_id = 10014078)
08421f07d795de9a81dbc4b1,"Since 08/11/2100, when was the last input time of patient 10039831?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-08-11' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2115-12-30 13:05:00'}],SELECT MAX(input_time) AS last_input_time FROM patient_records WHERE patient_id = '10039831' AND input_time >= '08/11/2100'
3a019edb3d03bf43064b460c,How many cases involved the prescription of tiotropium bromide throughout this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tiotropium bromide' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')",[{'COUNT(*)': 0}],SELECT COUNT(*) FROM bronchitis_treatment WHERE medication = 'tiotropium bromide' AND date BETWEEN '2023-01-01' AND '2023-12-31'
d37a478c48d46a196ddaac05,What is the average total hospital cost for a patient diagnosed with abnormal involuntary movements?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'abnormal involuntary movements' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT AVG(total_hospital_cost) AS average_cost FROM PatientRecords WHERE diagnosis = 'abnormal involuntary movements'
644187bf34aa3678b61cb3f5,Has any organism been found in patient 10010471's last microbiological blood culture test in 08/last year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'COUNT(*)>0': 0}],"Select distinct organism from microbiological_blood_cultures where patient_id = 10010471 and test_date = date_sub(date_sub(current_date, interval dayofyear(current_date) - 1 day), interval 1 year)"
271a7ff6c3f876ddc5c5cbfc,How many patients were given a triiodothyronine (t3) lab test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triiodothyronine (t3)' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) AS total_patients FROM lab_tests WHERE test_name = 'triiodothyronine (t3)' AND test_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR)"
ef4ea41e6cdc6751ebe50de2,Show me the top three most frequent specimens tested in 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",[],"SELECT specimen_type, COUNT(*) AS frequency FROM blood_sample_tests WHERE year = 2100 GROUP BY specimen_type ORDER BY frequency DESC LIMIT 3"
a7766be547dac94471bb1f74,How many hours have elapsed since the last time during this hospital encounter that patient 10018081 was diagnosed with unspecified protein-calorie malnutrition?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified protein-calorie malnutrition' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT TIMESTAMPDIFF(HOUR, MAX(eventDateTime), NOW()) FROM `physionet-data.mimiciii_hospitalnote` WHERE SUBJECT_ID = 10018081 AND CATEGORY = 'DISCHARGE' AND ISERROR = 0 AND MATCH(noteText, 'unspecified protein-calorie malnutrition')>0 AND HADM_ID IN (SELECT HADM_ID FROM `physionet-data.diagnoses_icd` WHERE SUBJECT_ID = 10018081 AND HADM_ID IN (SELECT HADM_ID FROM `physionet-data.admissions` WHERE SUBJECT_ID = 10018081) AND SEQ_NUM IN (SELECT MAX(SEQ_NUM) AS SEQ_NUM FROM `physionet-data.diagnoses_icd` WHERE SUBJECT_ID = 10018081 AND HADM_ID IN (SELECT HADM_ID FROM `physionet-data.admissions` WHERE SUBJECT_ID = 10018081)) AND ICD9_CODE IN (SELECT CODE FROM `physionet-data.icd9` WHERE MATCH(CONCEPT, 'unspecified protein-calorie malnutrition')>0))"
ce863b6ee4d6d50f7003ce48,"When did patient 10027602 have a total protein, csf lab test for the first time during the last hospital visit?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, csf' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1",[],[SELECT MIN(procedure_date) AS first_total_protein_date
e07aaf85d212b1a4dea88b36,What is the maximum total cost of the hospital visits that included right heart cardiac catheterization?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) ) GROUP BY cost.hadm_id ) AS T1,,SELECT MAX(Total_Cost) FROM Hospital_Visits WHERE Procedure = 'Right Heart Cardiac Catheterization';
1b28768e1c1598353e806a5d,What was the daily maximum input of or colloid intake for patient 10039831 on the current ICU encounter?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND icustays.outtime IS NULL ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or colloid intake' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m-%d',inputevents.starttime)",[],"SELECT max(amount) FROM intake WHERE item IN ('or', 'colloid') AND patient_id='10039831' AND encounter_date=CURRENT_DATE GROUP BY encounter_date"
d53298425ae0be6acf19c43b,When for the first time in 08/2100 was patient 10031404 prescribed atorvastatin and acetaminophen at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'atorvastatin' AND admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'acetaminophen' AND admissions.subject_id = 10031404 AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],""""""""
1688c6b7696b2a979945cb6c,How many operating rooms exist right now?,,,SELECT count(*) FROM operating_rooms WHERE status = 'operational'
169d3a6eec5e7a3446cd5c85,Did patient 10021118 have or crystalloid intake input on their first ICU stay?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or crystalloid intake' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],SELECT CASE WHEN EXISTS (SELECT 1 FROM inputevents_mv WHERE itemid IN (SELECT itemid FROM d_items WHERE generic_name LIKE '%crystalloid%' OR generic_name LIKE '%IV fluid%') AND subject_id = 10021118 AND intime BETWEEN (SELECT intime FROM icustays WHERE subject_id = 10021118 LIMIT 1) AND (SELECT outtime FROM icustays WHERE subject_id = 10021118 LIMIT 1)) THEN 'Yes' ELSE 'No' END AS Had_Crystalloid_Intake;
46f0cc9294673a19abea3ead,"During what last time during the first hospital visit did patient 10038992 have the maximum urea nitrogen, urine level?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen, urine' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],"SELECT MAX(urea_nitrogen_urine), last_time FROM first_hospital_visit WHERE patient_id = '10038992';"
9ccc39b8569c5131efee591e,"Was chlorhexidine gluconate 0.12% oral rinse, fexofenadine, or ketorolac ordered during the last hospital visit for patient 10019385?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug IN ( 'chlorhexidine gluconate 0.12% oral rinse', 'fexofenadine', 'ketorolac' )",[{'COUNT(*)>0': 0}],"SELECT DISTINCT medication_name FROM prescriptions WHERE patient_id = 10019385 AND visit_date = (SELECT MAX(visit_date) FROM prescriptions WHERE patient_id = 10019385) AND medication_name IN ('chlorhexidine gluconate 0.12% oral rinse', 'fexofenadine', 'ketorolac')"
217fb62b4029d43c8d4778f8,"In 2100, what were the top three most common specimens tested on patients within the same month after the diagnosis of body mass index (bmi) 35.0-35.9, adult?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index (bmi) 35.0-35.9, adult' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"[select specimen, count(*) as total"
e6301d5787e165024081b9d7,"What drug was patient 10022017 prescribed for within the same day after undergoing bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach in 10/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-10' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,"SELECT drug_name FROM prescriptions WHERE patient_id = 10022017 AND prescription_date = '10/21/00' AND procedure_name = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' AND procedure_date = '10/21/00' AND prescription_time >= procedure_time"
48e8561f4462026521fab248,What are the top three diagnoses of patients in their 20s during this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT diagnosis, COUNT(*) as frequency FROM patients WHERE age BETWEEN 20 AND 29 AND visit_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3"
d0e1bf41e5fd8ca04ae79ba4,What were the total amount of sterile water input that patient 10007818 received in their first ICU visit?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'sterile water' AND d_items.linksto = 'inputevents' ),[{'SUM(inputevents.totalamount)': None}],SELECT SUM(amount) FROM sterile_water_input WHERE patient_id = '10007818' AND visit_number = 1
ba7f88a5002e6408a7156eed,When did patient 10021487 first get the rapid respiratory viral screen & culture's microbiology test since 12/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],"SELECT MIN(DATE) FROM (SELECT DATE, LAB_TEST_CD, LAB_TEST_DESC FROM LAB_RESULTS WHERE PATIENT_ID = 10021487 AND (LAB_TEST_CD = 'RVS' OR LAB_TEST_DESC LIKE '%rapid respiratory viral screen%') AND DATE >= '2021-12-01') AS SUBQUERY WHERE LAB_TEST_CD = 'RVS' OR LAB_TEST_DESC LIKE '%microbiology%'"
9c48cfc44e14602d0728ed28,What are the single rooms available?,,,SELECT room_number FROM rooms WHERE room_type = 'single' AND status = 'available'
6d74cbf5c9fe6defe17b715e,What was the last albuterol inhaler dose that patient 10015931 was prescribed on their last hospital encounter?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'albuterol inhaler' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"select max(orderdate), max(dosage) from prescriptions where patient_id = 10015931 and drug_name = 'albuterol inhaler' and encounter_type = 'hospital' order by orderdate desc limit 1"
b180907473d137cd5300bdf3,How many days was patient 10001725's first stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.338587962090969}]","SELECT DATEDIFF(day, MIN(AdmitDateTime), MAX(DischargeDateTime)) AS Duration FROM PatientStays WHERE PatientID = '10001725' AND UnitType = 'ICU' AND AdmissionSequence = 1"
42495442e7c6484bb48ed957,Tell me the icd-11 code for tobacco use disorder in icd-10?,,,SELECT icd11_code FROM icd11_diagnoses WHERE icd10_code = 'F17' LIMIT 1
cf40d706cfc1f0846399ec24,What was the name of the organism found in patient 10029291's last stool microbiology test?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],select sample.organism from stool_microbiology where patient_id = 10029291 order by sample_collection_date desc limit 1
0a403bb61217529f94970734,What was patient 10018081's maximum systolic blood pressure since 06/07/2100?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-07'",[{'MAX(chartevents.valuenum)': None}],SELECT MAX(sys) FROM cardio WHERE person_id = 10018081 AND CAST(measure_date AS DATE) >= '2100-06-07'
0d4db28074f3b1bafc59af7e,What is patient 10011398's chloride change last measured on the first hospital visit compared to the value second to last measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","[select ChlorideChange from `physionet-data.mimic_icu.clinicalevents` where ItemID = 50868 and SubjectID = 10011398 and (ICUSTAY_ID = (select ICUSTAY_ID from `physionet-data.mimic_icu.icustays` where SUBJECT_ID = 10011398 and (ADMITTIME = (select min(ADMITTIME) from `physionet-data.mimic_icu.icustays` where SUBJECT_ID = 10011398)))) and ((ICUSTAY_ID, ChartTime) in (select ICUSTAY_ID, max(ChartTime) from `physionet-data.mimic_icu.clinicalevents` where ItemID = 50868 and SubjectID = 10011398 and (ICUSTAY_ID = (select ICUSTAY_ID from `physionet-data.mimic_icu.icustays` where SUBJECT_ID = 10011398 and (ADMITTIME = (select min(ADMITTIME) from `physionet-data.mimic_icu.icustays` where SUBJECT_ID = 10011398))))) group by ICUSTAY_ID) and ((ICUSTAY_ID, ChartTime)"
52796db611e85270a50a17e5,What is the minimum total hospital cost that involved control of epistaxis by anterior nasal packing procedure since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'control of epistaxis by anterior nasal packing' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,select min(total_hospital_cost) from hospital_costs where procedure_name='anterior nasal packing' and condition='epistaxis' and year>2100
a252cc04ca403620d3979914,When was patient 10004720 prescribed the drugs glucose gel and glucagon at the same time for the last time in 12/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucose gel' AND admissions.subject_id = 10004720 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'glucagon' AND admissions.subject_id = 10004720 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],[SELECT MAX(PrescribedDateTime) AS LastConcurrentPrescriptionDate
c6fff4b55ab874dfb73037a3,"What are the four commonly given procedures for patients that also received reposition left mandible with external fixation device, percutaneous approach previously within 2 months, since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left mandible with external fixation device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT DISTINCT p.Procedure_Name FROM Procedures p JOIN Patients pa ON p.Patient_ID = pa.Patient_ID JOIN Medical_History mh ON pa.Patient_ID = mh.Patient_ID WHERE mh.Procedure_Name = 'Reposition Left Mandible with External Fixation Device, Percutaneous Approach' AND mh.Date_Performed BETWEEN DATE_SUB(NOW(), INTERVAL 2 MONTH) AND NOW() GROUP BY p.Procedure_Name HAVING COUNT(DISTINCT mh.Patient_ID) >= 4"
fa7d9e05618f719c725c75ab,What is the total number of patients who stayed in careunit surgical intensive care unit (sicu)?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'surgical intensive care unit (sicu)' ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT SUM(PatientCount) FROM careunit WHERE unit_name = 'Surgical Intensive Care Unit'
85c838d478a4f152e0c9879e,When was the last discharge of patient 10020944 from the hospital?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10020944 ORDER BY admissions.dischtime DESC LIMIT 1,[{'dischtime': '2131-03-13 17:01:00'}],SELECT MAX(DischargeDate) FROM patient_records WHERE PatientID = '10020944'
42b27d5b68477ed32b23938a,What was the first respiratory rate in patient 10019172's body since 145 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-145 day') ORDER BY chartevents.charttime ASC LIMIT 1",[],"select body_body_body_id, body_body_body_timestamp, body_body_body_value from body_body where body_body_body_id = '10019172' and body_body_body_timestamp >= date('now', '-145 days') and body_body_body_timestamp = (select min(body_body_body_timestamp) from body_body where body_body_body_id = '10019172' and body_body_body_timestamp >= date('now', '-145 days')) and body_body_body_type = 'respiratoryRate' and body_body_body_unit = 'bpm' order by body_body_body_timestamp desc limit 1;"
0e206bae559f3646f2535376,Let me know what i'll need to prepare for the delayed clos abd wound procedure,,,SELECT required_items FROM procedure_preparation WHERE procedure_name = 'delayed clos abd wound' AND status = 'delayed'
989ff39a5fc2d15ff9d12bef,Could you tell me the sex of patient 10007928?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10007928,[{'gender': 'F'}],select sex from patients where patient_id = 10007928
566bbc92e52ac6c9cd03050c,"Today compared to yesterday, what new drugs are being prescribed to patient 10004733?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT ... FROM ... WHERE ... AND ... ORDER BY ...
388e3fc0fa30e6c5b9011872,"Count the number of people who received introduction of nutritional substance into lower gi, via natural or artificial opening in the same month after having been diagnosed with epilepsy, unspecified, not intractable, without status epilepticus in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, not intractable, without status epilepticus' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT COUNT(*) FROM healthcare_records WHERE diagnosis_code = 'Epilepsy, unspecified, not intractable, without status epilepticus' AND treatment_code = 'Introduction of nutritional substance into lower GI, via natural or artificial opening' AND EXTRACT(YEAR FROM diagnosis_date) = 2100 AND EXTRACT(MONTH FROM diagnosis_date) = EXTRACT(MONTH FROM treatment_date) AND EXTRACT(YEAR FROM diagnosis_date) = EXTRACT(YEAR FROM treatment_date) - INTERVAL '1' YEAR"
f548e5423305443cc9bd89c3,When did patient 10005909 first depart from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005909 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2144-11-02 15:23:00'}],SELECT MIN(departure_time) FROM patient_records WHERE patient_id = 10005909
d0c67568fc6aa214a04e3aaa,When did patient 10037928 have the minimum anion gap value the last time?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],SELECT measurement_date FROM lab_tests WHERE patient_id = 10037928 AND anion_gap = (SELECT MIN(anion_gap) FROM lab_tests WHERE patient_id = 10037928) ORDER BY measurement_date DESC LIMIT 1
d080d1e38919b6a529de708c,When did patient 10015931 first have the minimum amount of ph in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],"[SELECT MIN(ph), date"
03b89b45a7325ecb997b183f,Do you have any suggestions for preparation for the temporary tracheostomy procedure?,,,SELECT * FROM Procedures WHERE Name = 'Temporary Tracheostomy' AND Suggestions IS NOT NULL
f591b46504d2236b89d77bf8,What are the total number of fiber-optic bronchoscopy procedures performed during the previous year?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fiber-optic bronchoscopy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,SELECT COUNT(procedure_id) AS total_procedures FROM procedures WHERE procedure_type = 'fiber-optic bronchoscopy' AND procedure_date BETWEEN '2022-01-01' AND '2022-12-31'
5a435c4f165c08508edbd449,"How many patients in the last year were diagnosed with hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",,"SELECT COUNT(*) AS patient_count FROM diagnosis WHERE date_diagnosed BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE() AND (condition = 'Hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv' OR condition = 'Hypertensive chronic kidney disease, unspecified, with chronic kidney disease stage i through stage iv, or unspecified');"
45cf63c5e6579e640cddd3b1,Can you tell me the last value of the alkaline phosphatase test for patient 10015931 on the first hospital encounter?,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1,[],SELECT TOP 1 [ALP
e8fdd9acc2da7140baf49188,Does patient 95470 have reflux esophagitis in his family?,,,SELECT EXISTS(SELECT 1 FROM medical_records WHERE patient_id = 95470 AND condition = 'reflux esophagitis')
643390539a60fbe52d9fc05a,Has patient 10019385 had a hospital admission since 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019385 AND strftime('%Y',admissions.admittime) >= '2100'",[{'COUNT(*)>0': 1}],[SELECT COUNT(*) AS Hospital_Admissions
3c678de40d16a9eae2e6f6dd,Are you letting me know if patient 3677 is subject to covid-19 testing?,,,"SELECT PatientID, TestType FROM Covid19Testing WHERE PatientID = 3677 AND TestType = 'COVID-19'"
ffeeae0595efa3f5c9f10a86,"What is the minimum total cost of the hospital, which includes the glucocorticoid deficiency?",SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'glucocorticoid deficiency' ) ) GROUP BY cost.hadm_id ) AS T1,,select min(total_cost) from hospital_costs where condition = 'glucocorticoid deficiency';
4f90e141b3068b6b2ff3d1a5,Is there any medication that patient 10039831 has received in 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)>0': 0}],SELECT DISTINCT Medication.medic_name FROM Medication INNER JOIN Dispense ON Medication.medication_id = Dispense.medication_id INNER JOIN Patient ON Dispense.patient_id = Patient.patient_id WHERE Patient.patient_id = '10039831' AND YEAR(Dispense.dispense_date) = 2100
aed29b51a927aae66b5d4811,What was the last time that patient 10022041 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022041 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime DESC LIMIT 1",[],select top 1 discharge_date from hospital_stays where patient_id = 10022041 order by discharge_date desc
f4526c3446deb95d067dc788,How long took entral infus nutrit sub for patient 10855?,,,"SELECT patient_id, MAX(procedure_end_time) - MIN(procedure_start_time) AS duration FROM medical_procedures WHERE procedure_name = 'entral infus nutrit sub' AND patient_id = 10855"
f4bb5d766bfd7957102de24a,"Since 05/12/2100, when did patient 10020740 have his last input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-12' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2150-06-04 19:53:00'}],SELECT MAX(datetime) FROM patient_events WHERE patient_id = 10020740 AND event_type = 'input' AND datetime >= '2023-05-12'
c4afaf3f596cdc2be83cac17,How many days have elapsed since the last time patient 10039831 got a creatinine lab test on the current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(MAX(e.start_date), c.start_date) FROM (SELECT start_date, end_date FROM encounter e WHERE patient_id = 10039831 AND e.start_date <= CURRENT_DATE) e LEFT JOIN (SELECT patient_id, start_date FROM lab l WHERE test_name = 'creatinine' AND patient_id = 10039831 AND l.start_date <= e.start_date AND l.end_date >= e.start_date) c ON e.start_date = c.start_date WHERE e.start_date = (SELECT MAX(start_date) FROM encounter WHERE patient_id = 10039831)"
4ebb5e52ed23ff0830bbedbf,What are the four most frequently prescribed drugs?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","[{'drug': 'Insulin'}, {'drug': '0.9% Sodium Chloride'}, {'drug': 'Sodium Chloride 0.9%  Flush'}, {'drug': 'Potassium Chloride'}]","SELECT medication_name, COUNT(*) AS prescription_count FROM prescriptions GROUP BY medication_name ORDER BY prescription_count DESC LIMIT 4"
ccf60f7cf6c692a95a30282b,Tell me the duration in days of patient 10004720's last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 5.056192129850388}]","[SELECT DATEDIFF(day, MIN(ADMIT_DATE), MAX(DISCHARGE_DATE)) AS DurationDays"
0d8dbb180db73cb98f531c2d,Tell me the top four most common specimens tested since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}]","select top 4 species, count(species) as frequency from specimens where test_date > dateadd(year, -1, getdate()) group by species order by frequency desc"
b2d4a908cb2de00418d09277,How much does it cost for a other specified disorders of stomach and duodenum diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified disorders of stomach and duodenum' ) ),,SELECT cost FROM healthcare_costs WHERE diagnosis = 'other specified disorders of stomach and duodenum'
908ae520eb086d09751ea4b9,What are the top four diagnoses of patients in their 30s since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT Diagnosis, COUNT(Diagnosis) AS DiagnosisCount FROM patient_records WHERE Age BETWEEN 30 AND 39 AND RecordDate >= '2100-01-01' GROUP BY Diagnosis ORDER BY DiagnosisCount DESC LIMIT 4"
1d9b6672711d15ed28bd19bc,How much is the minimum total hospital cost associated with pseudomonas infection in conditions classified elsewhere and of unspecified site this year?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pseudomonas infection in conditions classified elsewhere and of unspecified site' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_hospital_cost) FROM pseudomonas_infection WHERE condition = 'Classified Elsewhere and Unspecified Site' AND year = YEAR(CURDATE());
fabc39d4768ddcfc1eaea089,Tell me the amount of po intake input that patient 10018845 received since 01/28/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-01-28'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(amount) FROM intake WHERE patient_id = '10018845' AND intake_date >= '2100-01-28'
468732462fc76ffb0eabb559,What was the admission type for patient 10003046 during their last hospital admission?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10003046 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1",[],SELECT admission_type FROM admissions WHERE patient_id = 10003046 ORDER BY admission_date DESC LIMIT 1
7d25ac3b59f8763886afb8a7,What are the prices of the drug 0.83% sodium chloride?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = '0.83% sodium chloride' ),,SELECT price FROM drugs WHERE name = '0.83% sodium chloride'
54afc6318164ae9f335372fe,Is there any new medication in the prescription of patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT COUNT(*) FROM (SELECT m.medication_name FROM prescription p INNER JOIN medication m ON p.medication_id = m.id WHERE p.patient_id = '10018081' AND p.prescription_date = CURDATE()) AS today_meds LEFT JOIN (SELECT m.medication_name FROM prescription p INNER JOIN medication m ON p.medication_id = m.id WHERE p.patient_id = '10018081' AND p.prescription_date = CURDATE() - INTERVAL 1 DAY) AS yesterday_meds ON today_meds.medication_name = yesterday_meds.medication_name WHERE yesterday_meds.medication_name IS NULL) AS new_meds;
4334a09dd6d34538cc7445dc,What was the drug prescribed to patient 10007795 for the first time via im route during the first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1,[],"select distinct drug from (select drug, route, visit_occurrence_id, patient_id, rank() over(partition by patient_id, visit_occurrence_id order by start_date) as r from drug_exposure where patient_id = 10007795 and route = 'IM' and visit_occurrence_id in (select min(visit_occurrence_id) from visit_occurrence where patient_id = 10007795)) as ranked_drugs where r = 1"
e7552c3d9e8f53dd5494cd5d,"What is the cost for the procedure other operations on carotid body, carotid sinus and other vascular bodies?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other operations on carotid body, carotid sinus and other vascular bodies' ) )",,"SELECT procedure_cost FROM healthcare_costs WHERE procedure_name = 'Other Operations on Carotid Body, Carotid Sinus and Other Vascular Bodies';"
ae5ec3820a0b5ba66f56bc5a,"What is the total number of patients who underwent drainage of pericardial cavity with drainage device, percutaneous approach in 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )",,"SELECT COUNT(*) FROM procedure_event WHERE cpt_code in (32056, 32554) and end_date BETWEEN '01-01-2100' AND '12-31-2100' and cpt_description LIKE '%pericardial cavity%'"
9446bf724e050f51ed6448e1,What's the ward id that can get patient 56490 in?,,,SELECT ward_id FROM patient_to_ward_assignment WHERE patient_id = 56490;
e5194571023c182470d8d9f8,When was the first time that patient 10005817's heart rate was measured at less than 84.0 on their first ICU visit?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 84.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],[SELECT MIN(MIN(MEASUREMENT_DATETIME))
3842f39935a34d58b55be97d,"Did patient 10013049 get a sodium, whole blood lab test in 06/2100?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium, whole blood' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND strftime('%Y-%m',labevents.charttime) = '2100-06'",[{'COUNT(*)>0': 0}],"SELECT * FROM lab_tests WHERE patient_id = '10013049' AND test_name = 'Sodium, whole blood' AND date_performed = '06/2100';"
c6b942401a65b3fa2db93ef0,What kind of blood patient 18866 has.,,,SELECT blood_type FROM patients WHERE patient_id = 18866
b6199c44eb942b29559195b3,Has patient 17944 arranged an appointment with another department?,,,"[SELECT DISTINCT a1.department_id, a1.appointment_datetime, p1.patient_id, p1.name"
631f6c7b12fe0e5f5fad366d,Has patient 10023239 got a diagnosis?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ),[{'COUNT(*)>0': 1}],Select Count(*) as diagnosis_count from diagnosis where patient_id=10023239;
3c21d00c8e06bab6642fad1c,Show the weight changes of patient 10020944 measured at 2100-03-15 04:00:00 compared to the value measured at 2100-03-14 00:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-15 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-14 00:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-15 04:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-03-14 00:00:00' )"": None}]",SELECT ...
654bb26fa8a99fc375bca767,Calculate the total volume of input by patient 10020740 on 04/07/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-04-07'",[{'SUM(inputevents.totalamount)': None}],SELECT SUM(volume) AS total_volume FROM input WHERE patient_id = 10020740 AND input_date = '04/07/2100'
fbe7d2b820e2ed531e0311d7,What is the pricing for 0.9% sodium chloride?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = '0.9% sodium chloride' ),,SELECT * FROM products WHERE name = '0.9% sodium chloride' AND category = 'pharmacy'
fe7e8800a8ef335ce9596217,Has any medicine been prescribed to patient 10038933 since 5 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-5 month')",[{'COUNT(*)>0': 1}],[SELECT DISTINCT m.medicine_name
d66c3f48f55c47d9fb861e1f,Count the ICU visits of patient 10031404 during the last year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 0}],"SELECT COUNT(*) AS `ICU_visits` FROM `admissions` WHERE `patient_id` = 10031404 AND `admission_date` >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) AND `discharge_disposition_id` IN (11, 13)"
285483bc9981158e35956874,"What was the number of dilation of left common iliac vein with intraluminal device, percutaneous approach procedures performed last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left common iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"SELECT COUNT(*) AS `number_of_procedures` FROM `procedures` WHERE `procedure_type` = 'dilation of left common iliac vein with intraluminal device' AND `approach` = 'percutaneous' AND `date_performed` BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW()"
377abeef64a076e8f592c701,How many hours have elapsed since patient 10039831 last received a mch lab test on their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"[select datediff(hour, mch_dt, visit_end_dt) from labevents l"
55afa0bf1f513c0f82f9d9c4,"What was the name of the drug prescribed for patient 10016742 within 2 days after having received a inspection of tracheobronchial tree, via natural or artificial opening endoscopic procedure since 13 months ago?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'inspection of tracheobronchial tree, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-13 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,SELECT distinct drug_name FROM procedure_event ce JOIN drug_exposure de on de.person_id=ce.person_id and de.drug_type_concept_id = 38000263 and de.drug_exposure_start_datetime between ce.procedure_date and (ce.procedure_date + INTERVAL '2' DAY) JOIN concept_ancestor ca on ca.descendant_concept_id=de.drug_concept_id and ca.ancestor_concept_id=38000263 JOIN procedure_occurrence po on po.person_id=ce.person_id and po.procedure_date between ce.procedure_date - INTERVAL '13' MONTH and ce.procedure_date and po.procedure_concept_id in (SELECT concept_id FROM concept_relationship WHERE relationship_id = 'Maps to' AND ancestor_id=4160963) WHERE ce.person_id=10016742 and ce.procedure_concept_id in (SELECT concept_id FROM concept_relationship WHERE relationship_id = 'Maps to' AND ancestor_id=4160963);
d376f746682d3677c16ad196,"For patients who were diagnosed with bradycardia, unspecified since 1 year ago, what are the top three most common medications that followed afterward in the same hospital encounter?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bradycardia, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 Medication, COUNT(*) AS Frequency FROM PatientRecords WHERE DiagnosisCode = 'Bradycardia, unspecified' AND EncounterDate > DATEADD(year, -1, GETDATE()) GROUP BY Medication ORDER BY Frequency DESC"
40f3aab550a4fd091b0e4468,When was the first time that patient 10002495 was prescribed a medication during the first hospital visit via sc?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1,[],"SELECT MIN(admittingdate) AS FirstPrescriptionDate FROM (SELECT DISTINCT admit.DOS as admittingdate, admit.PTID, med.PTID FROM admit LEFT JOIN med ON med.PTID = admit.PTID WHERE admit.PTID = '10002495' AND admit.HADM_ID = med.HADM_ID AND med.ORDERCATEGORYDESCRIPTION = 'Inpatient Medications') AS first_prescriptions"
edb18fda949ab33cd5cd47c8,"Is the value of patient 10004720's hematocrit, second measured on the last hospital visit, greater than the first value measured on the last hospital visit?",SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",select case when (select hematocrit from labevents where subject_id=10004720 and hadm_id=(select max(hadm_id) from labevents where subject_id=10004720) and charttime=(select max(charttime) from labevents where subject_id=10004720 and hadm_id=(select max(hadm_id) from labevents where subject_id=10004720) and itemid=50868)) > (select hematocrit from labevents where subject_id=10004720 and hadm_id=(select max(hadm_id) from labevents where subject_id=10004720) and charttime=(select max(charttime) from labevents where subject_id=10004720 and hadm_id=(select max(hadm_id) from labevents where subject_id=10004720) and itemid=50868 and charttime < (select max(charttime) from labevents where subject_id=10004720 and hadm_id=(select max(hadm_id) from labevents where subject_id=10004720) and itemid=50868))) then 'yes' else 'no' end as comparison_result from dual
13123a9ba850d6caba5a0faa,Has patient 10029484 been diagnosed with any diseases this year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,SELECT DISTINCT diagnosis FROM medical_records WHERE patient_id = 10029484 AND YEAR(diagnosis_date) = YEAR(CURDATE()) AND diagnosis IS NOT NULL
def40a677b6ecbf4f1bd3de2,The earliest hospital visit of patient 99661?,,,SELECT MIN(visit_date) FROM hospital_visits WHERE patient_id = 99661;
a0d612dc021f06119cd82641,"When was the first time patient 10021487, on this month/12, had the maximum mean blood pressure?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '12' ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1",[],SELECT MIN(VisitDate) FROM VisitOccurrence INNER JOIN VitalMeasurement ON VisitOccurrence.VisitOccurrenceID = VitalMeasurement.VisitOccurrenceID WHERE PatientID = '10021487' AND MeasurementType = 'Mean blood pressure' AND YEAR(VisitDate) = 2022 AND MONTH(VisitDate) = 12 GROUP BY DATE(VisitDate) HAVING MAX(MeanValue) ORDER BY MIN(VisitDate) LIMIT 1
0eb2954ae5544e9247d70c59,What were the number of patients who received a polys test?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'polys' ) ),[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM medical_records WHERE test_type = 'polys'
ad181c030f922bb1d3793964,What kind of rooms are available right now?,,,"SELECT room_type, COUNT(*) as available_rooms FROM reservations WHERE check_in_date > CURRENT_DATE AND (status = 'confirmed' OR status = 'reserved') GROUP BY room_type;"
e4f4aa529c397e3b7d0ddcd2,"What is the minimum total hospital cost for a person with jaundice, unspecified, not of newborn since 2100?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'jaundice, unspecified, not of newborn' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_hospital_cost) FROM inpatient_claims WHERE diagnosis_code = 'R17' AND admission_date >= '2100-01-01' AND discharge_date <= '2100-12-31'
eed2ec21308a4facd8e30ec6,When was the first time that patient 10038081 had the minimum immunoglobulin g value?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin g' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",[],"SELECT MIN(immuno_g_value) AS min_immuno_g_value, visit_date FROM patient_records WHERE patient_id = 10038081 GROUP BY visit_date HAVING min_immuno_g_value = (SELECT MIN(immuno_g_value) FROM patient_records WHERE patient_id = 10038081)"
e7fa38bcee63c4dff174564d,When did patient 10012853 depart hospital for the first time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10012853 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[{'dischtime': '2175-04-10 16:55:00'}],SELECT MIN(departure_date) FROM hospital_visits WHERE patient_id = '10012853'
749cd7577c772cdc228d8a49,"What percentile is the calcium, total value of 8.2 among patients of the same age as patient 10020740 on the last hospital stay?","SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.2",,"SELECT PERCENT_RANK() OVER (ORDER BY calcium) AS percentile FROM (SELECT patient_num, age, calcium FROM admissions AS a JOIN labevents AS l ON a.icustay_id = l.icustay_id WHERE a.admittime BETWEEN DATE_SUB(a.dischtime, INTERVAL 1 HOUR) AND a.dischtime AND patient_num != '10020740' AND age = (SELECT age FROM admissions WHERE patient_num = '10020740' AND row_number() OVER (PARTITION BY patient_num ORDER BY dischtime DESC) = 1)) AS patient_data WHERE calcium = 8.2"
408df91458c4945438a0d705,"What are the three frequently tested specimens for patients that received bypass coronary artery, one artery from aorta with autologous venous tissue, open approach previously in the same month in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"[SELECT specimen_type, COUNT(specimen_type) AS frequency FROM procedure_specimens"
180fff17c7418b127d038bf7,How was patient 10038933 admitted in terms of admission type for the last time?,SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10038933 ORDER BY admissions.admittime DESC LIMIT 1,[{'admission_type': 'EW EMER.'}],"select admission_type from (select admission_type, max(admission_date) as admission_date from ADMISSIONS where patient_num='10038933' group by admission_type) as ADMISSIONS where admission_type in (select admission_type from ADMISSIONS where patient_num='10038933' and admission_date=admission_date)"
4712867863ba837a91019c8f,When furosemide and albuterol inhaler were prescribed to patient 10037975 for the first time in 02/this year at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'furosemide' AND admissions.subject_id = 10037975 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'albuterol inhaler' AND admissions.subject_id = 10037975 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '02' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],"SELECT MIN(prescription_date) FROM prescriptions WHERE patient_id = 10037975 AND drug_name IN ('furosemide', 'albuterol inhaler') AND EXTRACT(MONTH FROM prescription_date) = 2 AND EXTRACT(YEAR FROM prescription_date) = 2023 GROUP BY patient_id HAVING COUNT(DISTINCT drug_name) = 2"
4a4b1ff6e491614e8bed8e49,"How many times, , was a rhinoscopy procedure ordered?",SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'rhinoscopy' ),[{'COUNT(*)': 0}],SELECT COUNT(*) AS TotalRhinoscopyOrders FROM MedicalProcedures WHERE ProcedureName = 'rhinoscopy';
79af64ce3260e4d25b227939,What was the amount of tramadol (ultram) prescribed to patient 10012552 in total in 04/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) AND prescriptions.drug = 'tramadol (ultram)' AND strftime('%Y-%m',prescriptions.starttime) = '2100-04'",[{'SUM(prescriptions.dose_val_rx)': None}],select sum(qty) from rxnorm_prescriptions where patient_id = 10012552 and ndc = (select ndc from ndc_lookup where generic_name = 'tramadol hydrochloride' and brand_name = 'ultram') and date_prescribed between '2100-04-01' and '2100-04-30'
aac6ebb3d651674fd6c07123,Ist patient 13329 subject to covid-19 testing,,,SELECT patient_id FROM patients WHERE covid_testing_date IS NOT NULL AND patient_id = 13329
312eb217dff66ce52d145060,How much miconazole nitrate vag cream 2% was given to patient 10021312 for the first time during their first hospital encounter?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'miconazole nitrate vag cream 2%' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(quantity) as first_dose FROM dispensing_records WHERE drug = 'miconazole nitrate vag cream 2%' AND patient_id = 10021312 AND encounter = 'first';
19858e80b7638280abbda010,When did patient 10029484 have the maximum ketone value for the last time since 04/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ketone' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],
cf44316ed6f26cdb2af0efb9,Could you tell me the average total cost in a hospital where tramadol (ultram) is used since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'tramadol (ultram)' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT AVG(total_cost) AS average_cost FROM hospital_stays WHERE medication = 'tramadol' AND DATEDIFF(CURRENT_DATE, admission_date) > 365"
90edd0b36b71d1dde04a4381,What are the top five most frequent procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT procedure_code, COUNT(procedure_code) AS procedure_count FROM procedures WHERE procedure_date >= '2100-01-01' GROUP BY procedure_code ORDER BY procedure_count DESC LIMIT 5"
a492bf5968b017604595cb27,Has patient 10008454 had any ptt lab tests done since 12/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ptt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-12'",[{'COUNT(*)>0': 0}],SELECT * FROM lab_results WHERE patient_id = 10008454 AND test_type = 'PTT' AND test_date >= '2012-01-01';
7d7aee677bb35ba8d39e2a8e,What is the recorded sex of patient 10022880?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10022880,[{'gender': 'M'}],SELECT patient.sex FROM patient WHERE patient.patient_id=10022880
aa2c37cca4ef58130e2faadd,Tell me the amount of or urine patient 10019172 had since 11/12/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-11-12'",[{'SUM(outputevents.value)': None}],SELECT SUM(amount) FROM urine_output WHERE patient_id = '10019172' AND date >= '11/12/2100'
61943ff9aadb518fc206c477,"What is the cost of a surgery called drainage of pericardial cavity with drainage device, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' ) )",,"SELECT total_charge FROM charges WHERE procedure_name = 'drainage of pericardial cavity with drainage device, percutaneous approach';"
47bcce86f3ab85e1c0edd92a,Is the anion gap value of patient 10014729 on the at 2100-04-02 05:22:00 measurement less than the value from the at 2100-04-01 05:18:00 measurement?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-04-02 05:22:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-04-01 05:18:00' ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-04-02 05:22:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-04-01 05:18:00' )"": None}]",[SELECT CASE WHEN MAX(CASE WHEN m2.measurementTime = '2100-04-02 05:22:00' THEN m2.result END) < MAX(CASE WHEN m1.measurementTime = '2100-04-01 05:18:00' THEN m1.result END) THEN 'Yes' ELSE 'No' END AS IsLower
0d74b2ee638041bc581f98ec,When was the first sputum microbiology test of patient 10027602's performed in 12/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],select date from microbiology_tests where patient_id=10027602 and test_name='sputum microbiology' and date='12/2100' order by date limit 1
ded7c37a33a0d81b227fca60,"What's the maximum yearly number of admissions for respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia since 2100?","SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'respiratory failure, unspecified, unspecified whether with hypoxia or hypercapnia' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1",,"SELECT MAX(yearly_admissions) AS max_admissions FROM admissions WHERE condition = 'respiratory failure, unspecified' AND year >= 2100"
4fac3af5df19be6347d3c772,What is the price for acetazolamide sodium?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'acetazolamide sodium' ),,SQL Query for Acetazolamide Sodium Price
1c2f1cfa5e513beb87314705,"What is the diagnosis cost of catatonic type schizophrenia, unspecified?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'catatonic type schizophrenia, unspecified' ) )",,"SELECT DiagnosisCost FROM MentalHealthConditions WHERE ConditionName = 'Catatonic Type Schizophrenia, Unspecified' AND DiagnosisType = 'Psychotic'"
c321346f08463a3979f09efe,What was the accumulated output for patient 10004733 since 10/26/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-26'",[{'SUM(outputevents.value)': 17410.0}],SELECT SUM(output) FROM patient_output WHERE patient_id = '10004733' AND date >= '2100-10-26'
d121006b2aba46e7a9730510,When did patient 10020944 get input on the first ICU stay for the first time?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime ASC LIMIT 1,[{'starttime': '2131-02-27 17:30:00'}],"SELECT MIN(STARTTIME) FROM LABEVENTS WHERE SUBJECT_ID = '10020944' AND ITEMID IN (SELECT ITEMID FROM D_ITEMS WHERE ITEMID IN (SELECT ITEMID FROM LABEVENTS WHERE SUBJECT_ID = '10020944') AND CATEGORY IN ('icu_stay', 'first'))"
48ea16ef9a9f1871ed032c14,What are the three most often performed treatments for patients aged 60 or above in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT TOP 3 treatment_name, COUNT(*) AS treatment_count FROM Patient_Treatments WHERE year = '2100' AND age >= 60 GROUP BY treatment_name ORDER BY treatment_count DESC"
1c7af8d5ad19cc00a657ccc2,When did patient 10027445 get a microbiology test for the first time since 02/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'charttime': '2142-07-31 06:07:00'}],SELECT MIN(test_date) FROM microbiology_tests WHERE patient_id = 10027445 AND test_date > '02/2100';
86b774ee38e2c7aa2ac12919,"Among patients who were diagnosed with hip joint replacement, what were the top five most common microbiology tests conducted within 2 months in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hip joint replacement' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5",,"SELECT microbiology_test, COUNT(*) AS test_count FROM patient_tests WHERE patient_id IN (SELECT patient_id FROM patient_diagnoses WHERE diagnosis = 'hip joint replacement' AND test_date BETWEEN diagnosis_date AND DATE_ADD(diagnosis_date, INTERVAL 2 MONTH)) AND test_date BETWEEN '2100-01-01' AND '2100-12-31' GROUP BY microbiology_test ORDER BY test_count DESC LIMIT 5"
876fc2621bff0c8dd69e9b66,Count the number of patients in neuro stepdown in the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'neuro stepdown' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM patients WHERE unit = 'neuro stepdown' AND admission_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE();"
38d2cf0507adde7b8f7a6eb3,"Tell me the name of the drug patient 10007818 was prescribed during the same day after having received a fluoroscopy of superior vena cava using other contrast, guidance procedure in 07/this year?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '07' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",,"SELECT distinct drug_name FROM prescription WHERE patient_id = 10007818 AND prescription_date = (SELECT DATE_ADD(fluoroscopy_date, INTERVAL 1 DAY) FROM fluoroscopy WHERE patient_id = 10007818 AND procedure_name = 'Superior Vena Cava Contrast Procedure' AND YEAR(fluoroscopy_date) = YEAR(CURDATE()) AND MONTH(fluoroscopy_date) = 07 LIMIT 1)"
c8620b45b18ebc1c914a2581,Does patient 3242 have a family history of malign neopl prostate?,,,select has_family_history_of_malign_neopl_prostate from patient where patient_id = 3242
44a6d21d8264b4fa98a0113f,Tell me the price of gemfibrozil.,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'gemfibrozil' ),,SELECT `price` FROM `drug_data` WHERE `drug_name` = 'gemfibrozil';
71621e85a074b2ac8ffc6ace,How many hours has it been since patient 10004733's last cholesterol ratio (total/hdl) lab test in their current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol ratio (total/hdl)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT DATEDIFF(hour, MAX(lab_datetime), GETDATE()) AS hours_since_last_lab FROM lab_tests WHERE patient_id = 10004733 AND test_name = 'Cholesterol Ratio (total/hdl)' AND visit_id = (SELECT visit_id FROM visits WHERE patient_id = 10004733 AND discharge_date IS NULL)"
f6c6d5c25fc74762144de677,"What is the average total hospital cost that involved implantation or replacement of carotid sinus stimulation device, total system since 1 year ago?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT AVG(total_hospital_cost) FROM medical_records WHERE procedure = 'Implantation or Replacement of Carotid Sinus Stimulation Device, Total System' AND procedure_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
11608a4c97632da4a6c7043d,What is the name of the drug which should not be administered during the venous cath nec procedure?,,,SELECT Drug.name FROM Drug WHERE NOT EXISTS (SELECT * FROM ProcedureDrug WHERE ProcedureDrug.drug_id = Drug.id AND ProcedureDrug.procedure_name = 'venous cath nec')
65a18d6c6863a8702f23d4ed,Did patient 10016810 have albumin 25% input during their first ICU visit?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ),[{'COUNT(*)>0': 0}],SELECT input_type FROM patient_inputs WHERE patient_id = 10016810 AND visit_number = 1 AND input_type LIKE '%albumin 25%' AND input_type LIKE '%input%'
4f7c481bcc13707e66944d07,"What are the three frequently ordered drugs for patients diagnosed with tobacco use disorder previously in the same month, this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tobacco use disorder' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3",,"SELECT TOP 3 drug_name, COUNT(*) as order_count FROM orders WHERE patient_diagnosis = 'tobacco use disorder' AND order_date BETWEEN DATEADD(month, -1, GETDATE()) AND GETDATE() AND YEAR(order_date) = YEAR(GETDATE()) GROUP BY drug_name ORDER BY order_count DESC"
559cabbd94ac4b49afae49bd,How much does patient 10020187's weight differ from the last value measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT ABS((SELECT weight FROM medical_records WHERE patient_id = 10020187 AND visit_date = (SELECT MAX(visit_date) FROM medical_records WHERE patient_id = 10020187) ORDER BY record_date DESC LIMIT 1) - (SELECT weight FROM medical_records WHERE patient_id = 10020187 AND visit_date = (SELECT MAX(visit_date) FROM medical_records WHERE patient_id = 10020187) ORDER BY record_date ASC LIMIT 1)) AS weight_difference FROM DUAL;
771ae0e7dfa569d1298f749c,What is the difference between weights last measured on the current hospital visit compared to the second to last value measured on the current hospital visit for patient 10018081?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT MAX(weight_value) - MAX(CASE WHEN weight_measurement_order = 2 THEN weight_value END) AS weight_difference FROM weight_measurement WHERE subject_id = '10018081' AND visit_occurrence_id = (SELECT MAX(visit_occurrence_id) FROM visit_occurrence WHERE subject_id = '10018081')
28f891c6136adc2119884018,Calculate the number of patients who were discharged from the hospital in the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(*) FROM patients WHERE discharge_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
4fbd4f9863cff8b2fd42e23b,Did patient 10019777 undergo the procedure on single vessel in the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedure on single vessel' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,"SELECT COUNT(*) FROM medical_records WHERE patient_id = '10019777' AND procedure_type = 'single vessel' AND procedure_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
e65595aa4d0b66d5c6625a99,When did patient 10022017 first depart from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.dischtime ASC LIMIT 1",[],select min(EDVisitEndDateTime) as FirstDepartureTime from EDVisit where PatientID='10022017';
65f0a54b0c223f74168d1b02,How many days have it been since the last stay of patient 10004733 in their current hospital visit in the careunit medicine?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime DESC LIMIT 1",[],"SELECT DATEDIFF(CURDATE(), MAX(admission_time)) FROM careunit_data WHERE patient_id = '10004733' AND hospital_id = (SELECT hospital_id FROM careunit_data WHERE patient_id = '10004733' ORDER BY admission_time DESC LIMIT 1) AND department = 'medicine' AND visit_id = (SELECT visit_id FROM careunit_data WHERE patient_id = '10004733' ORDER BY admission_time DESC LIMIT 1)"
62458787b60bd28c2b337541,"During their first hospital encounter, when did patient 10014354 receive their last medication via the im route?",SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime DESC LIMIT 1,[],SELECT max(admission_start_t) FROM admissions WHERE patient_id=10014354 AND admission_start_t<=admission_end_t AND admission_start_t IN (SELECT admission_start_t FROM admissions WHERE patient_id=10014354 AND admission_end_t<=admission_start_t) AND (SELECT max(end_t) FROM orders WHERE admission_id=admissions.admission_id AND orders.route='im' AND orders.start_t<=orders.end_t AND orders.start_t IN (SELECT start_t FROM orders WHERE admission_id=admissions.admission_id AND end_t<=start_t)) AS last_im_time
6c26a6c8707782ccd2a0c56c,How many hours has it been since the first time patient 10004733 stayed on this hospital visit in the careunit medical/surgical intensive care unit (micu/sicu)?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MIN(admission_time), CURRENT_TIMESTAMP()) FROM visits WHERE patient_id = '10004733' AND careunit = 'MICU/SICU';"
bae3bed8ddded1a1b46a172f,"Of the patients aged 60 or above in 2100, what are the top three most common procedures?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,"SELECT TOP 3 PROCEDURES, COUNT(*) AS COUNT FROM PATIENTS JOIN PROCEDURES ON PATIENTS.PATIENT_ID = PROCEDURES.PATIENT_ID WHERE AGE >= 60 AND YEAR = 2100 GROUP BY PROCEDURES ORDER BY COUNT DESC"
e5c3587bfbb2d97b71b9e953,How much duloxetine has been prescribed to patient 10007795 in 05/2100 in total?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND prescriptions.drug = 'duloxetine' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'",[{'SUM(prescriptions.dose_val_rx)': None}],"SELECT SUM(quantity) FROM prescriptions WHERE patient_id = 10007795 AND drug_name = 'duloxetine' AND DATE_FORMAT(prescription_date, '%m/%Y') = '05/21'"
ec5cf43c52672339fb5e9d7f,What is the maximum total hospital cost for a patient suffering from early satiety since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'early satiety' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,select max(total_hospital_cost) from patient_records where diagnosis = 'early satiety' and admission_date >= '2100-01-01'
a7391e86f5ef2065e3ea2a57,Has patient 10001725 been given a diagnosis?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ),[{'COUNT(*)>0': 1}],SELECT * FROM diagnoses WHERE patient_id = '10001725';
0f1dd768a428334842bfec50,What specimen tests did patient 10001217 undergo for the first time since 12/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'spec_type_desc': 'CSF;SPINAL FLUID'}],SELECT DISTINCT test_name FROM tests WHERE patient_id = 10001217 AND date > '12/2100' ORDER BY date ASC LIMIT 1;
b76a7905227123a769fc9e14,How many individuals are current patients in their 40s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,,SQL Query
b0b4926abc6fba2f9b78a017,"How many patients were diagnosed with hyperlipidemia, unspecified during the same hospital encounter after the previous diagnosis with presence of cardiac pacemaker throughout this year?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'presence of cardiac pacemaker' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperlipidemia, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,"select count(distinct a1.patient_id) as num_patients from patient_encounter a1 join diagnosis d1 on a1.encounter_id = d1.encounter_id join diagnosis d2 on a1.encounter_id = d2.encounter_id where d1.diagnosis_name = 'Presence of cardiac pacemaker' and d2.diagnosis_name = 'Hyperlipidemia, unspecified' and date_part('year', a1.encounter_date) = date_part('year', CURRENT_DATE)"
d8cfaf1fb8e89c395bcfc473,Calculate the total quantity of output of patient 10021487 on 12/18/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-18'",[{'SUM(outputevents.value)': None}],SELECT SUM(Quantity) FROM patient_output WHERE PatientID = '10021487' AND Date = '2023-12-18'
53ac27ef5178d9758e371569,What output did patient 10007818 first have on 07/03/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-07-03' ORDER BY outputevents.charttime ASC LIMIT 1 )",[],"SELECT MIN(output_date) AS first_output_date, output_value FROM patient_outputs WHERE patient_id = '10007818' AND output_date >= '07/03/2100' GROUP BY output_value ORDER BY first_output_date LIMIT 1"
cf32c8a66e9b2e46a4a073dd,How much chlorhexidine gluconate 0.12% oral rinse was prescribed on their last hospital encounter for the first time to patient 10027602?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT SUM(quantity) FROM prescriptions WHERE patient_id = 10027602 AND product_name = 'chlorhexidine gluconate 0.12% oral rinse' AND encounter_type = 'last hospital encounter' AND prescribed_first_time = TRUE;
e01675d4835c5611d02521e2,What was the first time in 05/2100 patient 10009035 had the maximum mchc value?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",[],SELECT MIN(date) AS first_time_of_max_mchc FROM lab_tests WHERE patient_id = '10009035' AND test_type = 'MCHC' AND date BETWEEN '2100-05-01' AND '2100-05-31' GROUP BY patient_id HAVING MCHC = MAX(MCHC)
f0229fb196610726d6ec7c44,How many times was other excision or destruction of lesion or tissue of pancreas or pancreatic duct carried out since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other excision or destruction of lesion or tissue of pancreas or pancreatic duct' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,select count(*) as procedure_count from procedure_event where (cpt_code = '50840' or cpt_code = '50845' or cpt_code = '50847' or cpt_code = '50848') and (end_date > '2100-01-01')
0104804c5c294f840bfc43b0,What were the five most commonly performed lab tests during this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],Your SQL query here
7b61d39dc6064005d5fe1b91,What are five of the most frequent specimens taken in this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],"select specimen, count(*) as specimen_count from specimens where YEAR(date_collected) = YEAR(CURDATE()) group by specimen order by specimen_count desc limit 5;"
c122bbbae5a9d7b44953325a,How many days has it been since the last bacteremia diagnosis for patient 10004733 on their current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bacteremia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT DATEDIFF(NOW(), MAX(diagnosis_date)) AS days_since_last_bacteremia FROM diagnoses WHERE patient_id = 10004733 AND diagnosis_code = 'bacteremia' AND encounter_id = (SELECT MAX(encounter_id) FROM encounters WHERE patient_id = 10004733)"
06445e2823bf14c47a058abe,"Has patient 19412 been administered any additional fluid,other test?",,,SELECT EXISTS(SELECT 1 FROM medical_records WHERE patient_id = 19412 AND (fluid_administered = 'Yes' OR additional_tests = 'Yes'))
b99ca86c27c7418b8cadc2bb,"Currently, how many operating rooms are available?",,,SELECT COUNT(*) as AvailableRooms FROM OperatingRooms WHERE Status = 'Available'
b4a201694189deda17a0ac3f,Could you inform me of the top five most common specimen tests that were conducted during this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5",[],Your SQL query here
58b2237d10cf18728234ae55,How many patients were given heparin since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 2}],SELECT COUNT(DISTINCT patient_id) AS patient_count FROM orders WHERE order_date >= '2100-01-01' AND drug = 'heparin'
4ce7e0d7febc6b899fff7a21,What was the change in platelet count in patient 10029484 second measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","[SELECT `10029484` AS patient_id, (second_platelet_count - first_platelet_count) AS platelet_count_change FROM ("
00bc7d25ccf848dbe8ebd03d,Show me the top three most frequent specimens tested since 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","""""""SELECT Specimen, COUNT(*) AS Frequency"
3cf174e9abff40de817ec43c,What was the total volume of foley patient 10026354 had since 07/09/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-09'",[{'SUM(outputevents.value)': None}],SELECT SUM(volume) as total_volume FROM foley_records WHERE patient_id = 10026354 AND entry_date >= '07-09-2100'
893d50d72560ef334a7c8471,What drug was prescribed to patient 10021487 during the same hospital visit after the procedure of enteral infusion of concentrated nutritional substances in 12/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'enteral infusion of concentrated nutritional substances' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,SELECT drug FROM prescriptions WHERE patient_id = '10021487' AND hospital_visit_id = (SELECT hospital_visit_id FROM procedures WHERE patient_id = '10021487' AND procedure_name = 'enteral infusion of concentrated nutritional substances' AND date = '12/2100') AND date > (SELECT date FROM procedures WHERE patient_id = '10021487' AND procedure_name = 'enteral infusion of concentrated nutritional substances' AND date = '12/2100')
8ecbbbd543e11b1626e55488,What was the name of the drug which patient 10007795 was prescribed in the same hospital visit after receiving a drainage of pancreatic cyst by catheter procedure since 04/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pancreatic cyst by catheter' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-04' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,select * from VISIT_OCCURRENCE inner join DRUG_EXPOSURE on VISIT_OCCURRENCE.visit_occurrence_id = DRUG_EXPOSURE.visit_occurrence_id inner join PROCEDURE_OCCURRENCE on VISIT_OCCURRENCE.visit_occurrence_id = PROCEDURE_OCCURRENCE.visit_occurrence_id where VISIT_OCCURRENCE.person_id = 10007795 and PROCEDURE_OCCURRENCE.procedure_concept_id = '3053133' and VISIT_OCCURRENCE.visit_start_date > PROCEDURE_OCCURRENCE.procedure_date and DRUG_EXPOSURE.drug_exposure_start_date > PROCEDURE_OCCURRENCE.procedure_date order by DRUG_EXPOSURE.drug_exposure_start_date limit 1
be8af28d0bb7aa9b2af1434f,Can you provide the name of the drug that was prescribed to patient 10027602 within 2 days post arteriography of cerebral arteries procedure since 12/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of cerebral arteries' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-12' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,SQL query to answer the question
35ed250e4f509e49e30cba17,Could you tell me the sex of patient 10002930?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10002930,[{'gender': 'F'}],SELECT sex FROM patients WHERE id = 10002930
d459384c23821c7436fd1a3e,Give me the top four most commonly prescribed medications during the same month to patients aged 60 or above after they were diagnosed with unspecified essential hypertension since 1 year ago.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4",,
b7db8d58388d97ad0352fd3f,What was the monthly minimum input of nacl 0.9% for patient 10015931 since 09/2100?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-09' GROUP BY strftime('%Y-%m',inputevents.starttime)",[],"SELECT MIN(nacl0_9_input) AS MinMonthlyInput, MONTH(date) AS Month, YEAR(date) AS Year FROM medical_records WHERE patient_id = '10015931' AND nacl0_9_input IS NOT NULL AND date >= '2100-09-01' GROUP BY YEAR(date), MONTH(date) ORDER BY Year, Month;"
8567ab1c50977e5114c864e1,When was the first time since 06/05/2100 that patient 10007818's mean blood pressure was measured greater than 72.0?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 72.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-05' ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT MIN(visit_date) FROM (SELECT visit_date, AVG(blood_pressure) as mean_bp FROM patient_data WHERE patient_id = 10007818 AND visit_date > '2100-06-05' GROUP BY visit_date) AS subquery WHERE mean_bp > 72.0"
05a019fa9f7c243ee7ac5682,Can you give me the five most common output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","[SELECT TOP 5 output_event, COUNT(*) AS frequency"
218edde218dc6a20ef8e8fad,What is the price of a drug named tobramycin sulfate?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'tobramycin sulfate' ),,SELECT Price FROM drugs WHERE Name = 'tobramycin sulfate'
6aa4881be1a49d2ae7f3e749,What were the top five most frequent diagnoses that followed within 2 months for those patients who received laparoscopic partial cholecystectomy since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'laparoscopic partial cholecystectomy' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT diagnosis_code, COUNT(*) AS frequency FROM medical_records WHERE procedure = 'laparoscopic partial cholecystectomy' AND diagnosis_date BETWEEN procedure_date AND DATE_ADD(procedure_date, INTERVAL 2 MONTH) AND procedure_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY diagnosis_code ORDER BY frequency DESC LIMIT 5"
a3ca87a1ecbcd3145068f456,How much octreotide acetate has patient 10007818 been prescribed on the last hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.drug = 'octreotide acetate',[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(amount) FROM prescriptions WHERE patient_id = 10007818 AND drug_name = 'Octreotide Acetate' AND visit_date = (SELECT MAX(visit_date) FROM visits WHERE patient_id = 10007818)
9ad11c0699674c054d7a4074,Can you calculate how many patients were prescribed glucagon this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'glucagon' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patient_id) AS patient_count FROM prescriptions WHERE medication_name = 'glucagon' AND YEAR(prescription_date) = YEAR(CURDATE());
7c3ea800b2b64cb1b3cf89a4,What is the title of the medication that was given to patient 10012853 last via the po means in 04/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 ) AND prescriptions.route = 'po' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1",[],SELECT TOP 1 Medication FROM [EDW
f9a927c46dab94fac56cd983,What is the name of the treatment given to patient 10038081 two or more times since 07/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-07' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )",,SELECT DISTINCT Treatment FROM Treatments WHERE PatientID = 10038081 AND TreatmentDate > '07/2100' GROUP BY Treatment HAVING COUNT(*) >= 2
f26a53de07f2471e33f3f8b5,What is the total number of excision of dental lesion of jaw procedures that took place in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,"SELECT SUM(Count) FROM `CPT` WHERE Code IN (52536,52537,52538) AND Year='2100'"
066f306279b80b6d43827f27,"In 2100, what are the five frequently ordered treatments for patients who were diagnosed with cachexia during the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cachexia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"SELECT TOP 5 TreatmentID, COUNT(TreatmentID) AS Frequency FROM Treatments WHERE PatientDiagnosisMonth = 2100 AND PatientDiagnosisCondition = 'cachexia' GROUP BY TreatmentID ORDER BY Frequency DESC"
6b6d306062e42562e6047276,Tell me the four most common diagnoses since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT diagnosis, COUNT(diagnosis) AS count FROM patient_records WHERE record_date > CURRENT_DATE - INTERVAL '1 year' GROUP BY diagnosis ORDER BY count DESC LIMIT 4;"
4a22689b12923d592f28be83,Has there been any organism present in patient 10016742's first stool microbiology test since 03/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[{'COUNT(*)>0': 0}],select * from stool_microbiolgy where patient_id=10016742 and order_date like '03%2017%' and test_result='present'
0af1a06bcce4aacbc5a936f4,Has patient 10008454 acquired any medication since 10/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'",[{'COUNT(*)>0': 1}],"SELECT medication_name, acquisition_date FROM patient_prescriptions WHERE patient_id = 10008454 AND acquisition_date >= '10/21/00'"
afc288ae1efdf1107f545e9d,When did patient 10004720 receive the last prescription of soln and bag at the same time since 12/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'soln' AND admissions.subject_id = 10004720 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bag' AND admissions.subject_id = 10004720 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(prescription_date) as last_prescription_date FROM prescriptions WHERE patient_id = 10004720 AND (medication_name = 'soln' AND medication_name = 'bag') AND prescription_date >= '12/2100'
f0508cab258d6df36060ea48,What is patient 10016150's heart rate change last measured on the first ICU visit compared to the value first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","select distinct icustay_id, hr from labevents where itemid in (220045,50843) and subject_id=10016150 order by icustay_id,charttime asc limit 1 union all select distinct icustay_id, hr from labevents where itemid in (220045,50843) and subject_id=10016150 order by icustay_id,charttime desc limit 1"
45d38cc2d6126200d9c5ec99,How many days have elapsed since patient 10039831 had received a hemoglobin lab test for the first time in this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],SELECT COUNT(DISTINCT l.lab_date) - 1 AS days_elapsed FROM lab_tests l WHERE l.patient_id = 10039831 AND l.lab_test = 'hemoglobin' AND l.encounter_id = (SELECT MIN(l2.encounter_id) FROM lab_tests l2 WHERE l2.patient_id = 10039831 AND l2.lab_test = 'hemoglobin') AND l.lab_date <= CURRENT_DATE
d6c3eb4c10881ccf9ced74ae,Give me the three most frequent procedures performed.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Other nonoperative respiratory measurements'}]",
3f66ff390a54bf2f82dedd51,"In 09/2100, what was the minimum sodium value for patient 10038933?","SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ) AND strftime('%Y-%m',labevents.charttime) = '2100-09'",[{'MIN(labevents.valuenum)': None}],select min(sodium) from (select sodium from labevents where itemid=50912 and subject_id=10038933 and charttime between '2009-01-01' and '2009-12-31') a where sodium is not null
c0ed5f3463fb838c2206713f,How many days have passed since patient 10004733 got his last diagnosis of proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site on their current hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT DATEDIFF(CURDATE(), MAX(EDDI.ENCOUNTER_END_DATE)) AS days_since_last_diagnosis FROM EMR.ENCOUNTER_DIAGNOSIS EDI INNER JOIN EMR.ENCOUNTER_DIAGNOSIS_DETAIL EDDI ON EDI.ENCOUNTER_DIAGNOSIS_ID=EDDI.ENCOUNTER_DIAGNOSIS_ID WHERE EDI.ENCOUNTER_ID=(SELECT ENCOUNTER_ID FROM EMR.ENCOUNTER WHERE PATIENT_ID=10004733 AND END_DATE=(SELECT MAX(END_DATE) FROM EMR.ENCOUNTER WHERE PATIENT_ID=10004733)) AND EDDI.ICD9_CODE IN ('0060','0061','0086') GROUP BY EDI.ENCOUNTER_DIAGNOSIS_ID HAVING COUNT(EDI.ENCOUNTER_DIAGNOSIS_ID)=3"
7ae435e691f248d18ab7bec3,How many hours have elapsed since patient 10018081 first received a hematocrit lab test during this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hematocrit' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MIN(HEMATOLOGY_TESTS.TEST_DATE), CURRENT_TIMESTAMP) AS elapsed_hours FROM HEMATOLOGY_TESTS INNER JOIN PATIENT_VISITS ON HEMATOLOGY_TESTS.PATIENT_VISIT_ID = PATIENT_VISITS.ID WHERE HEMATOLOGY_TESTS.TEST_NAME = 'Hematocrit' AND PATIENT_VISITS.PATIENT_ID = 10018081 AND PATIENT_VISITS.VISIT_START_DATE <= CURRENT_TIMESTAMP AND PATIENT_VISITS.VISIT_END_DATE >= CURRENT_TIMESTAMP"
aa46c093a028ee5e0201520e,"Tell me the maximum total hospital cost that includes introduction of nutritional substance into lower gi, via natural or artificial opening.","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) ) GROUP BY cost.hadm_id ) AS T1",,"SELECT MAX(tot_hosp_cost) AS Max_Total_Hospital_Cost FROM `physionet-data.mimiciv_hospcosts` WHERE hadm_id IN (SELECT hadm_id FROM `physionet-data.mimiciv_procedures` WHERE proc_icd9_code LIKE '%introduction of nutritional substance into lower gi, via natural or artificial opening%')"
48ce377b6362c251e67e2e6b,What are the top five most frequently performed procedures for patients who are 20s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"select distinct p.name, count(p.name) as count from patient_procedure p join patient_info i on p.patient_id = i.patient_id where p.performed_date > date_sub(now(), interval 1 year) and i.age between 20 and 29 group by p.name order by count desc limit 5"
859635e6c88f004f9e9f32da,When are dr. martin's rounds and procedures?,,,"SELECT `round_time`, `procedure_time` FROM `hospital_schedule` WHERE `doctor_name` = 'dr. martin'"
5969b3f1a95b57d848d81e86,What was the organism found in the last microbiology test done on the patient 10008454's urine since 10/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT TOP 1 Organism FROM microbiology_tests WHERE patient_id = '10008454' AND sample_type = 'urine' AND test_date > '10/21/00' ORDER BY test_date DESC;
4769deceed9b3988f20fff62,Have any diagnoses been made for patient 10039831 during this year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')",,"SELECT DISTINCT D.DiaDate, D.DiaName FROM DIAGNOSES D JOIN PATIENTS P ON D.PatID = P.PatID WHERE P.PatID = '10039831' AND YEAR(D.DiaDate) = YEAR(CURRENT_DATE);"
eee2d17dec0a42b12da8deaa,"Since 1 year ago, how many patients were prescribed prismasate (b22 k4)?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'prismasate (b22 k4)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],
d6a206ecc5cbf7eeccb7956b,"Among patients who underwent other electroshock therapy this year, what were the top five diagnoses they received within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electroshock therapy' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"select top 5 diagnosis from patients where therapy = 'other electroshock therapy' and therapy_date >= '2023-01-01' and diagnosis_date <= dateadd(month, 2, therapy_date) order by diagnosis_count desc"
8c24b509ca406f3cf4ea3e2a,Calculate the number of patients who were in the pacu careunit this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'pacu' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT patientid) AS number_of_patients FROM admissions WHERE careunit = 'PACU' AND YEAR(admissiondate) = YEAR(CURRENT_DATE)
c464ddc6ede81a650537c328,"When, on 01/28/2100, was patient 10019917's heart rate measured less than 73.0 for the last time?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 73.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-01-28' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT MAX(MeasurementDate) FROM measurement WHERE PatientID = 10019917 AND MeasurementDate <= '2100-01-28' AND HeartRate < 73.0 AND MeasurementType = 'HeartRate'
7ba5a831808e4e5851837fe5,Count the number of patients who were discharged.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) FROM patients WHERE discharge_date IS NOT NULL
402d46f2e8f68504cd726d4d,Show me the length of stay in days of patient 10019385 from the last stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.3132870369590819}]","SELECT DATEDIFF(MAX(DischargeDate), MIN(AdmissionDate)) AS LengthOfStay FROM PatientAdmissions WHERE PatientID = 10019385 AND Location = 'ICU' GROUP BY PatientID"
3cc0342acbb3992a4b0cf40b,Can you report the last respiratory rate for patient 10007058 since 09/08/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-08' ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT MAX(Date) AS LastMeasurementDate, RespiratoryRate FROM patient_observations WHERE PatientID = '10007058' AND ObservationType = 'RespiratoryRate' AND Date >= '2100-09-08' GROUP BY PatientID"
f854c9821a5c5435e850b71e,Tell me the top three most frequent procedures that patients received in the same hospital encounter after being diagnosed with other forms of acute ischemic heart disease.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other forms of acute ischemic heart disease' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"SELECT TOP 3 Procedure, COUNT(*) AS Frequency FROM HospitalEncounters JOIN Diagnoses ON HospitalEncounters.EncounterID = Diagnoses.EncounterID WHERE Diagnoses.Code LIKE 'I21%' AND Diagnoses.Type = 'Acute Ischemic Heart Disease' GROUP BY Procedure ORDER BY Frequency DESC"
f9f4d6def655d54dcbd63348,What is the dose of opiate prescribed for patient 8908?,,,SELECT dose FROM prescriptions WHERE patient_id = 8908 AND medication = 'opiate'
83b0e5365db1483f3adcf4cd,What was the medicine that was prescribed to patient 10025463 in the same hospital encounter after undergoing catheter based invasive electrophysiologic testing during the last month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'catheter based invasive electrophysiologic testing' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"SELECT medicine_prescribed FROM patient_records WHERE patient_id = 10025463 AND hospital_encounter_date BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 MONTH) AND CURRENT_DATE AND procedure = 'catheter based invasive electrophysiologic testing' ORDER BY hospital_encounter_date DESC LIMIT 1"
b7925774086e29f5d02b778f,Can you tell how many times patient 10015272 visited the ICU in 2100?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND strftime('%Y',icustays.intime) = '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 0}],SELECT COUNT(*) AS ICU_Visits FROM encounters WHERE person_id = 10015272 AND location_id = 4 AND encounter_date BETWEEN '2100-01-01' AND '2100-12-31'
5febe2a89e917d60303afd4c,What were the top three most common diagnoses?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","[{'long_title': 'Other and unspecified hyperlipidemia'}, {'long_title': 'Unspecified essential hypertension'}, {'long_title': 'Essential (primary) hypertension'}]","SELECT diagnosis, COUNT(*) AS frequency FROM patient_diagnoses GROUP BY diagnosis ORDER BY frequency DESC LIMIT 3"
da71745a0892dc4e3347b091,What is the method for disinfecting the quarantine room?,,,SELECT method FROM disinfection_methods WHERE room_type = 'quarantine'
89f547ad3bff27fb734acf00,"Patient 10015931, when was your last blood culture microbiology test in 12/this year?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT test_date FROM microbiology_tests WHERE patient_id = '10015931' AND test_type = 'blood culture' AND YEAR(test_date) = YEAR(CURDATE()) ORDER BY test_date DESC LIMIT 1
4313578eaa6f5e20b0f3a246,List the top four most frequently prescribed medications in 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4",[],"SELECT medication, COUNT(*) as frequency FROM prescriptions WHERE YEAR(prescription_date) = 2100 GROUP BY medication ORDER BY frequency DESC LIMIT 4"
15aef1c4f860681d29061482,How much is the difference of SaO2 of patient 10019777 last measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SQL Query Here
0981b590800b50362ed9bd99,How many patients were diagnosed with other postoperative infection since 2100 after already being diagnosed with injury to thoracic aorta during the same hospital encounter?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to thoracic aorta' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other postoperative infection' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,[SELECT COUNT(*) AS NumberOfPatients
88a7b298bbf40e3593b5f065,What are the top three most common specimens tested after receiving arteriography of other intra-abdominal arteries in the same month since 1 year ago?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3",,"select * from (select specimen, count(*) as count from (SELECT EXTRACT(YEAR FROM (date - interval '1' year)) as year, specimen from labevents where category in (""Arteriography of other intra-abdominal arteries"") group by specimen) as t where year = EXTRACT(YEAR FROM (NOW() - interval '1' year)) order by count desc limit 3) as t1 order by t1.specimen"
358cc7b4a0a0a45ee24a26fd,"What was the first instance when the SaO2 of patient 10031757 was less than 97.0, during their last ICU stay?",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 97.0 ORDER BY chartevents.charttime ASC LIMIT 1,[],"SELECT TOP 1 event_time FROM `physionet-data.mimiciii_clinical.icustays` WHERE subject_id = 10031757 AND SaO2 < 97.0 ORDER BY stay_id DESC, event_time ASC"
ebc57b735ed65bf597257c3e,What is the average total hospital cost involving a drug named loratadine since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'loratadine' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,select avg(total_hospital_cost) from claims where drug_name = 'loratadine' and service_date >= '2100-01-01'
0a43e2fe814473ab9035db70,What was the total output that patient 10004720 had on 12/06/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-06'",[{'SUM(outputevents.value)': None}],SQL Query
168c04ce1956c158d1651a93,"In 2100, has patient 10002495 received a fluoroscopy of multiple coronary arteries using other contrast treatment?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using other contrast' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,"[SELECT DISTINCT p.patient_id, p.name, COUNT(*) AS num_coronary_fluoroscopies"
59f57cae084573bb29dadab2,Has patient 10001217 been admitted into the emergency room in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'",[{'COUNT(*)>0': 0}],SELECT COUNT(*) FROM EmergencyRoomAdmissions WHERE patient_id = '10001217' AND YEAR(admission_date) = 2100
c204f2867fbb32ebf4703865,Calculate how many drugs patient 10006580 was prescribed in 04/last year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)': 0}],SELECT count(DISTINCT drug_name) FROM prescription WHERE patient_id = '10006580' AND prescription_date BETWEEN '2022-04-01' AND '2022-04-30';
9d1688657943a3556c9c8704,"How many patients were diagnosed with type 2 diabetes mellitus without complications during the same month after they were first diagnosed with altered mental status, unspecified?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'altered mental status, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'type 2 diabetes mellitus without complications' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,[SELECT COUNT(DISTINCT p.patient_id) AS num_patients
26ceeacb486699b10996ccda,Calculate the number of ICU visits of patient 10001725 in 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND strftime('%Y',icustays.intime) = '2100'",[{'COUNT( DISTINCT icustays.stay_id )': 0}],SELECT COUNT(*) AS icu_visits FROM visits WHERE patient_id = 10001725 AND visit_type = 'ICU' AND YEAR(visit_date) = 2100;
06cb3e044663d50bd84a38f0,When has patient 10016742 had the first input since 03/25/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-25' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2178-07-04 01:00:00'}],SELECT MIN(entry_date) AS first_input_since FROM medical_records WHERE patient_id = '10016742' AND entry_date > '2100-03-25' AND entry_type = 'input'
9b71dfdbadbc316c5802b20d,"In 05/2100, what was the first drug that patient 10016150 was prescribed through the iv route?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1",[],select drug_name from prescriptions where patient_id = '10016150' and route = 'iv' and date_prescribed >= '05/2100-01-01' order by date_prescribed asc limit 1
ffb225e9649d2d2a042af243,What was the admission type for patient 10020306's first admission to the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10020306 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1",[],SELECT AdmissionType FROM HospitalAdmissions WHERE PatientID = '10020306' ORDER BY AdmissionDate ASC LIMIT 1;
2cf0ff14f070a284cf574db2,What is the foley output for patient 10018081 on 12/30/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-30'",[{'SUM(outputevents.value)': None}],"SELECT `Foley Output` FROM `PatientRecords` WHERE `PatientID` = 10018081 AND `Date` = DATE_FORMAT(NOW() ,'%Y-12-30')"
b1a78da076378d37eda3aeb6,What are the top four most commonly diagnosed conditions since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT condition_name, COUNT(patient_id) AS patient_count FROM diagnoses WHERE diagnosis_date > DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY condition_name ORDER BY patient_count DESC LIMIT 4"
a1d2ad87eb4e531d5e0486d3,Give me the name of the diagnosis patient 51605 had in the other department,,,SELECT name FROM diagnosis WHERE patient_id = 51605 AND department != 'current_department'
d2dd4d4753286d5a02aee69a,Tell me the minimum total cost of a hospital visit involving a alanine aminotransferase (alt) lab test in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alanine aminotransferase (alt)' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_cost) FROM hospital_visits INNER JOIN lab_tests ON hospital_visits.id = lab_tests.visit_id WHERE lab_tests.test_name = 'alanine aminotransferase (alt)' AND YEAR(hospital_visits.visit_date) = 2100
7da203f6a27901736f057b8c,"On last month/02, what was patient 10021938's first heart rate?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '02' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT MIN(heart_rate) FROM patient_heart_rates WHERE patient_id = '10021938' AND date BETWEEN '2023-02-01' AND '2023-02-28'
4e8e76dc6a0595e8d2d83aba,What was the time of patient 10029291's last blood culture microbiology test in 02/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],SELECT last(test_time) AS last_blood_culture_microbiology_test_time FROM microbiology_test_results WHERE test_type = 'blood culture' AND patient_id = '10029291' AND test_time BETWEEN '2100-02-01' AND '2100-02-28'
2533e11570c9cac4cf3be471,Was patient 10019777 treated with a procedure on single vessel procedure in the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'procedure on single vessel' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')",,select count(*) from procedure_occurrence where person_id = 10019777 and (procedure_concept_id in (select concept_id from concept where concept_name like 'single vessel procedure')) and (cast(procedure_date as date) between (current_date - interval '1 year') and current_date)
edb3cbffb2caabbeb6d54ab6,Retrieve the top five most frequent output occurrences.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","[{'label': 'Foley'}, {'label': 'Void'}, {'label': 'Chest Tube #1'}, {'label': 'Cerebral Ventricular #1'}, {'label': 'TF Residual'}]","SELECT output, COUNT(*) AS frequency FROM results GROUP BY output ORDER BY frequency DESC LIMIT 5"
2dc83d6d0ed121d2f9b4c9ca,What medication was last given to patient 10005817 since 22 months ago?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-22 month') ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'HYDROmorphone (Dilaudid)'}],"select top 1 medication from patient_medication_log where patient_id = '10005817' and date_administered >= dateadd(month, -22, getdate()) order by date_administered desc"
45892e6b5af0f6b70b5c1edd,When was the first hospital discharge time for patient 10005866?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10005866 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",[],AdmittedTime
d11649ef6f1e014d999ead71,When was patient 10022017's last hospital discharge?,SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10022017 ORDER BY admissions.dischtime DESC LIMIT 1,[{'dischtime': '2189-09-16 15:00:00'}],SELECT TOP 1 discharge_date FROM hospital_discharge_records WHERE patient_id = '10022017' ORDER BY discharge_date DESC
ffdfd1a0a23a14c7d23101f8,Can you show me the top four most frequent lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","[{'label': 'Creatinine'}, {'label': 'Urea Nitrogen'}, {'label': 'Hematocrit'}, {'label': 'Platelet Count'}]","SELECT TOP 4 test, count(*) AS frequency FROM lab_results WHERE date >= DATEADD(year, -1, GETDATE()) GROUP BY test ORDER BY frequency DESC"
12d278afa5aced986bad28bf,"Was the chloride, whole blood value of patient 10018423 last measured on the last hospital visit less than the value second to last measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )","[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride, whole blood' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SQL Query
f838d7118ed779a45387d3aa,"How many patients were given occlusion of right femoral artery with intraluminal device, percutaneous approach in 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'occlusion of right femoral artery with intraluminal device, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' )",,"select count(distinct patient_id) from (select distinct patient_id, count(distinct case when procedure_type = 'occlusion' and body_part_examined = 'right femoral artery' and approach = 'percutaneous' and device = 'intraluminal' then procedure_id end) over (partition by patient_id) as procedure_count from procedure where procedure_date like '2100%') where procedure_count >= 1"
2cc3cfa013ef1b065613e661,What is the minimum total cost of a hospital stay involving bariatric surgery status in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bariatric surgery status' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MIN(total_cost) FROM hospital_stays WHERE bariatric_surgery_status = 'yes' AND year = 2100;
b6d3b1cf1ff9f38a9adebb0a,Show me the top five most frequent specimens tested since 1 year ago.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]","SELECT specimen, COUNT(*) AS frequency FROM test_results WHERE test_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY specimen ORDER BY frequency DESC LIMIT 5;"
5498f998fad51770de8a3567,Has patient 10004235 had lab testing since 01/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'",[{'COUNT(*)>0': 1}],SELECT * FROM lab_results WHERE patient_id = '10004235' AND date >= '2100-01-01'
a124aa7b3370848af7ee0c6b,What was the weight of patient 10038081 last since 5 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-5 month') ORDER BY chartevents.charttime DESC LIMIT 1",[],"SELECT weight FROM patient_records WHERE patient_id = '10038081' AND date_recorded >= DATE_SUB(CURRENT_DATE, INTERVAL 5 MONTH)"
662b2f7dbfe34ec1b9a8e485,How is disinfection performed in the quarantine room?,,,SELECT disinfection_method FROM quarantine_room_procedures WHERE room_type='quarantine'
54ed73ce298076765282857a,"When was the last time in the first hospital visit that patient 10007818 had the minimum value of lactate dehydrogenase, ascites?","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase, ascites' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],SELECT MAX(visit_date) AS last_min_ldh_date FROM hospital_visits WHERE patient_id = 10007818 AND visit_sequence = 1 AND lactate_dehydrogenase = (SELECT MIN(lactate_dehydrogenase) FROM hospital_visits WHERE patient_id = 10007818 AND visit_sequence = 1)
98c5ba7c0885aff19ce951a4,Tell me the insurance plan of patient 10029291 on the last hospital encounter.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,[{'insurance': 'Medicare'}],select insurance_plan from patient_encounters where patient_id = 10029291 order by encounter_date desc limit 1
fa71c8774f1846ae6af571b6,What was the last time that patient 10002495 had a maximum value of mchc in 06/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND strftime('%Y-%m',labevents.charttime) = '2100-06' ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],select max(mchc) as maximum_mchc from lab_tests where patient_id = 10002495 and date_collected like '06/2100' and mchc = (select max(mchc) from lab_tests where patient_id = 10002495 and date_collected like '06/2100')
eb7bf6c61602ad306a17337c,What were the most frequent diagnoses among the top three throughout this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",,SQL Query Here
cc6c86acab499b90014c3eac,"Since 1 year ago, has patient 10022281 come to the ER?","SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022281 AND admissions.admission_location = 'emergency room' AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",[{'COUNT(*)>0': 0}],[SELECT COUNT(*) AS ER_Visits_Last_Year
c4b6b11d95a82c6b74f94e76,"Number of patients who were given a drainage of right pleural cavity with drainage device, percutaneous approach procedure.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from procedure_performed where (procedure_performed.procedure_name like '%drainage of right pleural cavity%') and (procedure_performed.procedure_name like '%with drainage device%') and (procedure_performed.procedure_name like '%percutaneous approach%')
55005268f132ecb83abd1166,What was measured as patient 10010471's weight during the first check?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,[],"SELECT measurement_date, weight FROM patient_measurements WHERE patient_id = '10010471' ORDER BY measurement_date ASC LIMIT 1"
7d9bd95cb1ec8590bac2746b,What was the duration in days of patient 10018328's first stay in the ICU?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 7.702511574141681}]","SELECT DATEDIFF(MAX(ED_Out_Date), MIN(ED_Out_Date)) AS Duration_In_Days FROM MIMIC_III.icustays WHERE Subject_ID = 10018328 AND ROW_NUMBER() OVER (PARTITION BY Subject_ID ORDER BY Ed_Stay_ID) = 1;"
0c54d58c887f5d5cfcec260c,"What are the top four most frequently tested specimens for patients within the same hospital visit after receiving bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4",,"SELECT TOP 4 DISTINCT specimen_type FROM `specimen` INNER JOIN `visit_occurrence` ON `specimen`.`visit_occurrence_id`=`visit_occurrence`.`visit_occurrence_id` WHERE `visit_occurrence`.`person_id` IN (SELECT `person_id` FROM `visit_occurrence` INNER JOIN `procedure_occurrence` ON `visit_occurrence`.`visit_occurrence_id`=`procedure_occurrence`.`visit_occurrence_id` WHERE `procedure_occurrence`.`concept_id` IN (SELECT `concept_id` FROM `concept` WHERE `concept_name` LIKE '%bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach%')) GROUP BY `specimen_type` ORDER BY COUNT(`specimen_type`) DESC"
3e3c16a752c633d8a67ecda2,Was the haptoglobin reading for patient 10007818 last measured on the last hospital visit greater than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'haptoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'haptoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'haptoglobin' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'haptoglobin' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]",SELECT CASE WHEN (SELECT max(haptoglobin) FROM patient_data WHERE patient_id = 10007818 AND visit_date = (SELECT MAX(visit_date) FROM patient_data WHERE patient_id = 10007818)) > (SELECT min(haptoglobin) FROM patient_data WHERE patient_id = 10007818 AND visit_date = (SELECT MAX(visit_date) FROM patient_data WHERE patient_id = 10007818)) THEN 'Yes' ELSE 'No' END;
3f1090acd1fbd153ed566e98,What is the percentile of 34.1 in the mchc lab test with the same age as patient 10022041 on the first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 34.1",,SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY mchc) FROM lab_tests WHERE patient_id = 10022041 AND test_type = 'mchc' AND age = (SELECT age FROM encounters WHERE patient_id = 10022041 AND encounter_type = 'first')
1138580aa607ef75fdf6df17,Count the number of patients who were discharged since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT count(*) FROM patient WHERE DischargeDate > '2100-01-01';
38b0a6d72077dca2e36faa92,Show the respiratory rate changes of patient 10023239 last measured on the first ICU visit compared to the value first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]","SELECT 'First ICU visit' AS Timepoint, (SELECT respiratory_rate FROM patient_vital_signs WHERE patient_id = 10023239 AND visit_type = 'ICU' AND measurement_time = (SELECT MIN(measurement_time) FROM patient_vital_signs WHERE patient_id = 10023239 AND visit_type = 'ICU')) AS First_Measurement, (SELECT respiratory_rate FROM patient_vital_signs WHERE patient_id = 10023239 AND visit_type = 'ICU' AND measurement_time = (SELECT MAX(measurement_time) FROM patient_vital_signs WHERE patient_id = 10023239 AND visit_type = 'ICU' AND measurement_time <= (SELECT MIN(measurement_time) FROM patient_vital_signs WHERE patient_id = 10023239 AND visit_type = 'ICU'))) AS Last_Measurement"
354ec0afe942f8cf2f5c706e,"In 10/2100, when did patient 10019172 last receive the % hemoglobin a1c test?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '% hemoglobin a1c' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m',labevents.charttime) = '2100-10' ORDER BY labevents.charttime DESC LIMIT 1",[],SELECT MAX(test_date) FROM lab_results WHERE patient_id = 10019172 AND test_name = '% hemoglobin a1c' AND test_date <= '2100-10-31'
2348bda143e013d91131d2d9,What are patient 10037861's changes in ph last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ph' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","select ph_last_value.ph_last_value as Last, ph_prev_value.ph_prev_value as Previous, ph_last_value.ph_last_value - ph_prev_value.ph_prev_value as Change from (select max(ph_value_timestamp) as last_visit_timestamp from lab_results where patient_id = 10037861) as last_visit join (select ph_value as ph_last_value from lab_results where patient_id = 10037861 and lab_result_timestamp = last_visit.last_visit_timestamp) as ph_last_value on true join (select ph_value as ph_prev_value, row_number() over (partition by lab_result_timestamp order by lab_result_timestamp desc) as rn from lab_results where patient_id = 10037861 and lab_result_timestamp = last_visit.last_visit_timestamp) as ph_prev_value on ph_prev_value.rn = 2;"
5f4091b20b6ccfd4e72a8f1f,Please tell me the sex of patient 10018328.,SELECT patients.gender FROM patients WHERE patients.subject_id = 10018328,[{'gender': 'F'}],SELECT `sex` FROM `patient` WHERE `patient_id` = '10018328'
65faa312dd5804c3f1f638f3,What was the first time of patient 10038992 blood culture ( myco/f lytic bottle) microbiology test during the previous month?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND microbiologyevents.spec_type_desc = 'blood culture ( myco/f lytic bottle)' AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],"SELECT TOP 1 test_time FROM microbiology_tests WHERE patient_id = '10038992' AND test_name = 'blood_culture_mycobacterium/lytic_bottle' AND test_time >= DATEADD(month, -1, GETDATE()) ORDER BY test_time ASC"
94b617e6ff37a625db538e00,"During the last hospital encounter, what was the last time patient 10026406 had a medication via the po/ng route prescribed?",SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'po/ng' ORDER BY prescriptions.starttime DESC LIMIT 1,[],"SELECT MAX(prescribed_date) AS last_prescription_date FROM medication_records WHERE patient_id = 10026406 AND route IN ('po', 'ng') AND encounter_id = (SELECT MAX(encounter_id) FROM encounters WHERE patient_id = 10026406)"
437e22cc3839c9e567107949,What is the average total cost of the hospital which involves chronic systolic (congestive) heart failure in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic systolic (congestive) heart failure' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1",,SQL Query
0056cade81e16f20fe9fe322,Has patient 10023239 had any medication prescribed since 05/2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05'",[{'COUNT(*)>0': 1}],SELECT * FROM patient_medication WHERE patient_id = '10023239' AND date_prescribed > '2000-05-01'
347b35d5873783b49e222bc6,What was the total sum of inputs for patient 10007795 on the first ICU visit?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ),[{'SUM(inputevents.totalamount)': 8640.0}],SQL query here
78c1ef777fd6564ef1b1164f,When was the first time patient 10014729 had been prescribed medication through the td route on the first hospital visit?,SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT MIN(STARTDATE) FROM ADT_ADMN WHERE HADM_ID = (SELECT HADM_ID FROM ADT_ADMN WHERE HADM_ID IN (SELECT HADM_ID FROM ADMISSION WHERE PAT_ID = 10014729 AND ADMITTIME IS NOT NULL) ORDER BY ADMITTIME ASC LIMIT 1) AND MEDROUTE = 'td'
32b1864cd437a05f94495679,What number of patients were in the medicine since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(distinct patient_id) from prescription where medicine_name='medicine' and date_prescribed >= '2100-01-01'
f8bfabf3d67d5c270425864f,What was the last weight of patient 10014729?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,[],select max(weight) from weight where patient_id = 10014729
259109556cec2005a9ea3db8,What specimen test was first given to patient 10038999?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,"[{'spec_type_desc': 'FLUID,OTHER'}]",SELECT `test` FROM `specimen_tests` WHERE `patient_id` = '10038999' ORDER BY `date` ASC LIMIT 1
91d0d988d9caf739b370a0af,What are the new drugs for patient 10039831 today compared to the earlier ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SELECT * FROM (SELECT d.drug FROM drug_exposure d WHERE d.person_id=10039831 AND d.exposure_start_date = CURRENT_DATE) AS today_drugs LEFT JOIN (SELECT d.drug FROM drug_exposure d WHERE d.person_id=10039831 AND d.exposure_start_date = CURRENT_DATE - INTERVAL '1 day') AS yesterday_drugs ON today_drugs.drug = yesterday_drugs.drug WHERE yesterday_drugs.drug IS NULL;
76d64d32df1f5a7f51202106,Has patient 10023117 got a platelet count lab test since 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023117 ) AND strftime('%Y',labevents.charttime) >= '2100'",[{'COUNT(*)>0': 0}],select count(*) from labtests where patientid=10023117 and labtesttype='platelet' and creativedate>'2100-01-01 00:00:00'
01389011a3cea028b226b95b,What was the amount of insulin prescribed to patient 10020740 in total in 05/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'insulin' AND strftime('%Y-%m',prescriptions.starttime) = '2100-05'",[{'SUM(prescriptions.dose_val_rx)': None}],SELECT SUM(insulin_amount) FROM prescriptions WHERE patient_id = '10020740' AND prescription_date BETWEEN '2100-05-01' AND '2100-05-31'
d3ba4b68ea980852ba7f2f4a,What was the last drug prescribed since 09/2100 to patient 10011398?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Metoprolol Tartrate'}],"SELECT MAX(date_prescribed) AS last_prescription_date, drug_name FROM prescription_records WHERE patient_id = '10011398' AND date_prescribed >= '2023-09-21T00:00:00' GROUP BY drug_name ORDER BY last_prescription_date DESC LIMIT 1"
9259d15f15a7db0e59aaff9d,Could you inform me of the maximum rdw value for patient 10021118 in 12/this year?,"SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12'",[{'MAX(labevents.valuenum)': None}],SELECT MAX(rdw) FROM lab_results WHERE patient_id = '10021118' AND EXTRACT(YEAR FROM test_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND EXTRACT(MONTH FROM test_date) = 12
35845dbc8e2d2791d609cc18,What is the reimbursement standard for genetic and chromosome tests?,,,SELECT `Reimbursement Standard` FROM `Genetic and Chromosome Tests` WHERE `Test Type` = 'Genetic and Chromosome' LIMIT 1
a718668474f99aed79794a78,What's the weight difference of patient 10027602's body second measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 )"": None}]",SELECT (max(weight) - min(weight)) AS weight_difference FROM measurements WHERE patient_id = 10027602 AND visit_date = (SELECT max(visit_date) FROM measurements WHERE patient_id = 10027602) AND measurement_type = 'body weight'
221b036ed4f338f8d4bd1c8a,What was the total sum of inputs for patient 10038933 since 03/19/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-19'",[{'SUM(inputevents.totalamount)': 60779.0}],SELECT SUM(input) AS total_inputs FROM patient_data WHERE patient_id = '10038933' AND input_date >= '2100-03-19'
e45d3d0893b986609bb61212,What should not be administered during a proc-vessel bifurcation procedure?,,,SELECT distinct M.MedicationName FROM Medications M JOIN ProceduralRecommendations R ON M.MedicationID = R.MedicationID WHERE R.ProcedureType = 'proc-vessel bifurcation' AND R.Administration = 'No'
d9c4c3a85c5787478f083a3a,What are three of the most frequent specimens taken since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]","SELECT specimen, COUNT(*) AS count FROM lab_data WHERE date >= DATE_SUB(NOW(), INTERVAL 1 YEAR) GROUP BY specimen ORDER BY count DESC LIMIT 3"
40c2eb3691b1c2483780d090,What exactly was the first drug that patient 10038992 was prescribed?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) ORDER BY prescriptions.starttime ASC LIMIT 1,[{'drug': 'Heparin'}],SELECT DISTINCT drug_name FROM prescriptions WHERE patient_id = '10038992' ORDER BY prescription_date ASC LIMIT 1
37bfc037c806a2407d309d50,What is the minimum transitional epithelial cells value of patient 10018081 during their current hospital encounter?,SELECT MIN(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'transitional epithelial cells' ),[{'MIN(labevents.valuenum)': None}],SELECT MIN(TransitionalEpiCell_Value) FROM PathologyResults WHERE EncounterID=(SELECT EncounterID FROM Encounters WHERE PatientID='10018081' AND EncounterType='Hospital' AND EncounterEndDate=CURRENT_DATE) AND PathologyResultType='TransitionalEpiCell'
488e2a77c6798e98c810e20b,What is the patient count for ascorbic acid prescription during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ascorbic acid' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(DISTINCT PatientID) FROM Prescriptions WHERE DrugName = 'Ascorbic Acid' AND YEAR(PrescriptionDate) = YEAR(CURDATE())
ed4bfebb071d64a0de120838,How many of acetaminophen were prescribed to patient 10004235 in total in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = 'acetaminophen' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'",[{'SUM(prescriptions.dose_val_rx)': None}],"SELECT COUNT(*) FROM prescriptions WHERE patient_id = 10004235 AND medication = 'acetaminophen' AND DATE_PART('year', prescription_date) = EXTRACT(YEAR FROM CURRENT_DATE) AND DATE_PART('month', prescription_date) = 7"
c84dfff5f8753a12aab6815f,What organism was found in patient 10029291's first stool test during their first hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],select sample_organism from sample where patient_id = 10029291 and sample_id = (select min(sample_id) from sample where patient_id = 10029291 and visit_id = (select min(visit_id) from visit where patient_id = 10029291))
7765d7fe671288bae59a5fa7,Did patient 10021118 go through any lab test during the first hospital encounter?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),[{'COUNT(*)>0': 1}],select * from lab_events where person_id = 10021118 and visit_occurrence_id in (select visit_occurrence_id from visit_occurrence where person_id = 10021118 and visit_concept_id = 9201 and visit_start_date >= '2012-08-01' and visit_start_date < '2012-09-01')
3f43e5ace937d4b9a8b18b3f,How many hours has it been since the first diagnosis of other iatrogenic hypotension in patient 10021487 on their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other iatrogenic hypotension' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",,"SELECT TIMEDIFF(NOW(), MIN(CASE WHEN DIAGNOSIS = 'other iatrogenic hypotension' THEN ADMIT_DATE END)) AS 'Hours Since First Diagnosis' FROM DIAGNOSIS WHERE PATIENT_ID = '10021487' AND ENCOUNTER_ID = 'current_encounter_id'"
c3b9775f6f9f3f0a14d7ec29,"For the first time in 08/this year, how much scopolamine patch was prescribed to patient 10016742?","SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND prescriptions.drug = 'scopolamine patch' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT SUM(prescribed_amount) FROM prescriptions WHERE drug_name = 'scopolamine patch' AND patient_id = '10016742' AND prescription_date = (SELECT MIN(prescription_date) FROM prescriptions WHERE drug_name = 'scopolamine patch' AND patient_id = '10016742' AND YEAR(prescription_date) = 2008)
0843691130d6cd5cd2dedc9f,What was the number of patients that were given a ferritin test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],"SELECT COUNT(DISTINCT patient_id) FROM patient_tests WHERE test_name = 'Ferritin' AND test_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR)"
8073dc91a374c05758eb7cd2,What are the ways to consume sodium bicarbonate?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'sodium bicarbonate',"[{'route': 'IV'}, {'route': 'ORAL'}]",SELECT ways FROM consumption_methods WHERE substance = 'sodium bicarbonate';
dbadc610a502fc0a6c69d44e,How was patient 10039997 admitted in terms of admission type for the last time at the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10039997 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime DESC LIMIT 1",[],SELECT TOP 1 admission_type FROM admissions WHERE patient_id = '10039997' ORDER BY admission_date DESC
089ab5e83166d7733ba43ccc,Expose the top five most frequent output events in 2100.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )",[],"select top 5 OutputEvent, count(*) as Frequency from Events where YEAR(Date) = 2100 group by OutputEvent order by Frequency desc"
2753f3dc8c10c48e64cf034a,Count how many patients were discharged from hospital since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) AS DischargedPatients FROM hospital_stays WHERE discharge_date >= '2100-01-01';
224951a256954e9d3b39076e,Has patient 10022281 undergone any laboratory tests in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND strftime('%Y',labevents.charttime) = '2100'",[{'COUNT(*)>0': 0}],select count(*) from `treatment_fact` where `treatment_fact`.`patient_id` = '10022281' and `treatment_fact`.`treatment_type` = 'Laboratory' and year(`treatment_fact`.`treatment_date`) = '2100'
bcaec1a9a3a9b59caef1e49a,Is there any record of cardiogenic shock in patient 83182's family?,,,SELECT EXISTS(SELECT 1 FROM PatientFamilyHistory WHERE PatientID = 83182 AND Condition = 'Cardiogenic Shock') AS IsCardiogenicShockInFamily
27640049ed54c86d051fc8ff,"What is the maximum total hospital cost including a cholesterol, ldl, calculated lab test?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'cholesterol, ldl, calculated' ) ) GROUP BY cost.hadm_id ) AS T1",,"SELECT MAX(total_hospital_cost) FROM lab_results WHERE test_name IN ('Cholesterol', 'LDL', 'Calculated')"
68ee1d315023f57029b6ce03,What is the yearly minimum piggyback input for patient 10014729 since 02/2100?,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'piggyback' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-02' GROUP BY strftime('%Y',inputevents.starttime)",[],SELECT MIN(piggyback_input) FROM patient_input_data WHERE patient_id = 10014729 AND date >= '02/2100' GROUP BY YEAR(date)
933c7c79dce6c6b398e200c9,"Has patient 10015860 been ordered triamcinolone acetonide 0.1% cream, docusate sodium, or calcium carbonate since 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND prescriptions.drug IN ( 'triamcinolone acetonide 0.1% cream', 'docusate sodium', 'calcium carbonate' ) AND strftime('%Y',prescriptions.starttime) >= '2100'",[{'COUNT(*)>0': 0}],SELECT DISTINCT order_date FROM `physionet-data.mimic-cxr.chexpert_procedure` WHERE patient_id = 10015860 AND (procedure_name = 'triamcinolone acetonide 0.1% cream' OR procedure_name = 'docusate sodium' OR procedure_name = 'calcium carbonate') AND order_date >= '2100-01-01'
6971ce16d647c323dc5a6150,What was patient 10022041's maximum heart rate reading in their first ICU stay?,SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ),[{'MAX(chartevents.valuenum)': None}],"SELECT MAX(heartrate) AS ""Patient's maximum heart rate"" FROM chartevents WHERE Subject_ID = 10022041 AND HADM_ID = (SELECT MIN(HADM_ID) FROM chartevents WHERE Subject_ID = 10022041) AND ItemID = 211"
c6a37b7e4bf30a4820758f4a,When was the last time that patient 10004235 was prescribed heparin and sodium chloride 0.9% in 07/2100 at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'sodium chloride 0.9%' AND admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10004235 AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],SELECT MAX(CareEventRecord.EffectiveDateTime) FROM CareEventRecord JOIN CareEvent ON CareEventRecord.CareEventID = CareEvent.CareEventID WHERE CareEventRecord.PatientID = '10004235' AND CareEvent.CodeListID = '2.16.840.1.113883.3.26.1.1' AND CareEvent.Code = '101541000124103' AND CareEventRecord.EffectiveDateTime BETWEEN '2100-07-01' AND '2100-07-31' AND EXISTS (SELECT 1 FROM CareEventRecord AS CRE JOIN CareEvent ON CRE.CareEventID = CareEvent.CareEventID WHERE CRE.PatientID = CareEventRecord.PatientID AND CRE.EffectiveDateTime = CareEventRecord.EffectiveDateTime AND CareEvent.CodeListID = '2.16.840.1.113883.3.26.1.1' AND CareEvent.Code = '80161005')
c72ddd4c729a31793b216593,What is the average absolute monocyte count value of patient 10004720 since 10/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'absolute monocyte count' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-10'",[{'AVG(labevents.valuenum)': None}],select avg(absolute_monocyte_count) from lab_events where person_id = 10004720 and encounter_date > '10/2100'
8ce7af691c9be7d9abda7cc7,Count how many patients were discharged from hospital since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT admissions.subject_id )': 180733}],SELECT COUNT(*) AS discharged_patients FROM admissions WHERE discharge_date > CURRENT_DATE - INTERVAL '1 year';
78444405504330982a1f5e0a,"Among patients diagnosed with esophagitis, unspecified, what were the top four most common microbiology tests conducted within the same hospital visit in this year?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophagitis, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4",,"[SELECT Top4MicroTests.TestName, COUNT(*) AS TestFrequency"
9bcc50dfeada714797755ff0,What is the checklist you need to follow in advance of your egd with closed biopsy procedure?,,,SELECT checklist_name FROM pre_procedure_checklists WHERE procedure_name = 'EGD with Closed Biopsy'
0ceee1a85a040c4d57c27a09,"Has patient 10008287 been ordered acetaminophen iv, dexamethasone, or heparin in 04/last year?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND prescriptions.drug IN ( 'acetaminophen iv', 'dexamethasone', 'heparin' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'",[{'COUNT(*)>0': 0}],"SELECT COUNT(*) AS medication_count FROM prescriptions WHERE patient_id = 10008287 AND medication_name IN ('acetaminophen iv', 'dexamethasone', 'heparin') AND date_prescribed BETWEEN '2022-04-01' AND '2022-04-30'"
540b84764bb982f9853d1621,Has patient 10038999 been diagnosed with any diseases in 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'",,SELECT * FROM diagnoses WHERE patient_id = 10038999 AND diagnosis_date BETWEEN '2100-01-01' AND '2100-12-31';
955c6240945fc39d733c8375,Provide the count of hospital visits for patient 10026354 during the last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026354 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],"SELECT COUNT(*) FROM hospital_visits WHERE patient_id = 10026354 AND visit_date BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"
5ee025cab135eb911d61888a,What are the four most frequent procedures for patients aged 50s throughout this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT procedure, COUNT(*) AS frequency FROM patient_procedures WHERE YEAR(procedure_date) = YEAR(CURDATE()) AND age BETWEEN 50 AND 59 GROUP BY procedure ORDER BY frequency DESC LIMIT 4"
82eed12efc2bbbf2dd01b1c2,Tell me what to prepare before the peripheral nerve graft procedure :,,,"SELECT p.name, p.preparation_steps FROM procedures p WHERE p.name = 'Peripheral Nerve Graft'"
35cf8678b7b636890f6218de,How many patients were staying in medicine since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND datetime(transfers.intime) >= datetime(current_time,'-1 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],Your SQL query here
e4740c820cb8320bffa0e957,What is the total count of patients who stayed in careunit cardiac vascular intensive care unit (cvicu) during this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'cardiac vascular intensive care unit (cvicu)' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) AS total_patients FROM patient_records WHERE careunit='cvicu' AND discharge_date BETWEEN '2023-01-01' AND '2023-12-31';
003865fdb611e9f27fe18281,Tell me the top four most common diagnoses for patients aged 30s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,
dd87fb2dfb9bf1eaf69c3a59,When has patient 10019172 had the first input since 03/05/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-05' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2118-11-16 11:20:00'}],SELECT * FROM medical_events WHERE patient_id = '10019172' AND event_type = 'input' AND event_date >= '2100-03-05' ORDER BY event_date ASC LIMIT 1
a61da9b50a816c216dab4107,When was the time of patient 10031757's first hospital discharge?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10031757 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",[],SELECT `discharge_date` FROM `patient_discharges` WHERE `patient_id` = 10031757 ORDER BY `discharge_date` ASC LIMIT 1
9162de3307e705f564c4492d,Provide the top four most common treatments.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","[{'long_title': 'Insertion of Infusion Device into Superior Vena Cava, Percutaneous Approach'}, {'long_title': 'Venous catheterization, not elsewhere classified'}, {'long_title': 'Central venous catheter placement with guidance'}, {'long_title': 'Other nonoperative respiratory measurements'}]","SELECT treatment, COUNT(*) AS frequency FROM medical_records GROUP BY treatment ORDER BY frequency DESC LIMIT 4"
6d3b33c130ee573fc9b4e5f8,Can you retrieve the top four most frequent lab tests patients had following a diagnosis of closed fracture of seven ribs in the same hospital visit since 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of seven ribs' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT lab_test, COUNT(*) AS frequency FROM lab_tests WHERE diagnosis_code = 'S22.42' AND visit_date >= '2100-01-01' GROUP BY lab_test ORDER BY frequency DESC LIMIT 4;"
51bf2e035e47da3885e46b70,"Since 03/03/2100, when was the first input time for patient 10018423?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-03' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2167-05-05 19:22:00'}],SELECT MIN(input_time) FROM patient_data WHERE patient_id = '10018423' AND input_time >= '03/03/2100' AND input_time <= '03/05/2100'
84ba715b229207e9b74e2c7f,Provide the top three most frequent diagnoses that patients were assigned within 2 months after receiving diagnostic ultrasound of digestive system in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )",,"select t1.diagnosis, count(t1.patient_id) as c from diagnosis t1 join diagnosis t2 on t1.patient_id = t2.patient_id where t1.diagnosis_date between t2.diagnosis_date and t2.diagnosis_date + interval '2 months' and t2.diagnosis = 'diagnostic ultrasound of digestive system' and t2.diagnosis_date between '2100-01-01' and '2100-12-31' group by t1.diagnosis order by c desc limit 3"
33b3c4f8d9aabedcd9066605,What was the medication that patient 10019777 was prescribed for within 2 days after receiving other endoscopy of small intestine in 03/this year?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endoscopy of small intestine' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')",,SQL Query
d74b04155d86c3e804553ede,Tell me the five most frequent medical diagnoses since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"select diagnosis, count(*) from diagnoses where admission_date >= '2100-01-01' group by diagnosis order by count(*) desc limit 5"
486aad9ca1f13f573fabc677,How much is the cost for the drug sodium chloride 0.9%?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'sodium chloride 0.9%' ),,SELECT cost FROM drugs WHERE name = 'sodium chloride 0.9%'
1183bcefba1a2e8f38f90e8e,What amount of heparin was prescribed to patient 10021666?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND prescriptions.drug = 'heparin',[{'SUM(prescriptions.dose_val_rx)': None}],select amount from prescriptions where patient_id = 10021666 and medication = 'heparin'
60eba7103445142138d17aea,"Since 09/09/2100, what was the first value of arterial blood pressure mean of patient 10021487?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-09' ORDER BY chartevents.charttime ASC LIMIT 1",[],SELECT TOP 1 arterial_blood_pressure_mean FROM medical_records WHERE patient_id = '10021487' AND record_date >= '2100-09-09' ORDER BY record_date ASC;
5a930b48e4949a1ed44fe056,What immunotherapies have been used for the past five years?,,,SELECT name FROM immunotherapies WHERE year >= YEAR(CURRENT_DATE) - 5
a544c5a0f893e479f14079f0,What was the total number of input patient 10018081 has received since 11/20/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-11-20'",[{'SUM(inputevents.totalamount)': 171300.0}],SELECT SUM(Quantity) AS TotalQuantity FROM Orders WHERE PatientID = 10018081 AND OrderDate >= '2100-11-20'
0eec887f694582394cfc6f10,How many patients in 2100 received open and other cecectomy within 2 months after being diagnosed with pure hypercholesterolemia?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pure hypercholesterolemia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open and other cecectomy' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"select count(distinct patient_id) from (select * from patient_records where diagnosis_code = 'E78.0' and year_of_diagnosis = 2100) as hypercholesterolemia_patients join (select * from surgery_records where surgery_type in ('open_cecectomy', 'other_cecectomy') and surgery_date - diagnosis_date <= 60) as cecectomy_patients on hypercholesterolemia_patients.patient_id = cecectomy_patients.patient_id"
ad15992e182e0964c4084195,What is the opioid dosage prescribed for patient 7107?,,,SELECT opioid_dosage FROM patient_records WHERE patient_id = 7107;
74a38dccf5ce3b494dd37197,What was the change in SaO2 in patient 10016742 last measured on the last ICU visit compared to the second to last value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]","select patient_id, visit_id, (sao2_value - lag(sao2_value) over (partition by patient_id, visit_id order by measurement_time desc)) as sao2_change from icu_measurements where patient_id = 10016742 and measurement_type = 'SaO2' and visit_id = (select max(visit_id) from icu_visits where patient_id = 10016742) order by measurement_time desc limit 2"
8d8518ce9ca76a042a0c5bb0,What are the prices for the drug called vitamin e?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'vitamin e' ),,"SELECT drug_name, price FROM drugs WHERE drug_name = 'vitamin e'"
9f56b7e6de37d05e0ac335a3,Count the number of patients who were given the lamotrigine in 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'lamotrigine' AND strftime('%Y',prescriptions.starttime) = '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],select count(*) from (select distinct patientid from prescription where drugname='lamotrigine' and year(prescribedate) = 2100) as t1
81852273a5351d699a554177,How much midazolam was prescribed since 09/2100 for the first time to patient 10021487?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.drug = 'midazolam' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT SUM(prescribed_amount) FROM prescriptions WHERE patient_id = '10021487' AND drug_name = 'midazolam' AND first_prescription_date >= '2099-09-21'
f691d2a9bc22649ae9adddac,"What is the average total cost of a hospital that includes a procedure called fluoroscopy of superior vena cava using other contrast, guidance throughout this year?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of superior vena cava using other contrast, guidance' ) ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,"select avg(total_cost) from dataset where procedure_description = 'fluoroscopy of superior vena cava using other contrast, guidance throughout' and year = 'this_year'"
81882a684bf6449f672dfca5,When did patient 10006580 get a mrsa screen microbial test for the last time in 08/this year?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[],select max(test_date) from microbiology_lab_tests where patient_id = 10006580 and test_name = 'mrsa screen' and test_date >= '2023-08-01' and test_date < '2023-09-01'
b8c79b9be82f4813cd52ed92,How many hospitalized patients are there now?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT COUNT(*) FROM patients WHERE status = 'hospitalized'
48965885b40400e08e4d8528,Count the number of hospital visits for patient 10020306 during the last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10020306 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],"SELECT COUNT(*) FROM HospitalVisits WHERE patient_id = '10020306' AND visit_date BETWEEN DATE_SUB(NOW(), INTERVAL 1 YEAR) AND NOW()"
981338dedcce7e27679a41c7,When was the last time that patient 59941 had a medication that should be taken daily?,,,"SELECT TOP 1 DATE_FORMAT(date, '%Y-%m-%d') as last_daily_medication_date FROM (SELECT date, med_id, SUM(dose) as total_dose FROM prescriptions WHERE patient_id=59941 GROUP BY date, med_id) as daily_meds WHERE med_id IN (SELECT med_id FROM medications WHERE frequency='Daily') ORDER BY date DESC"
6a4f0f27325a4881d537e381,Show me the five most common specimens tested since 2100.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}, {'spec_type_desc': 'SPUTUM'}, {'spec_type_desc': 'STOOL'}]","SELECT specimen_name, COUNT(*) as count FROM tests GROUP BY specimen_name ORDER BY count DESC LIMIT 5"
6012b1badcebf4d12139de0e,Get me patient 10026354's total output volume on 10/31/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '10-31'",[{'SUM(outputevents.value)': None}],SQL Query here
3fceb3f3200f3f095b671be0,What is the body weight change of patient 10004720 measured at 2100-12-07 00:00:00 compared to the value measured at 2100-12-06 00:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 00:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-06 00:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-07 00:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-06 00:00:00' )"": None}]",SELECT pw1.BodyWeight - pw2.BodyWeight AS WeightChange FROM PatientWeight pw1 JOIN PatientWeight pw2 ON pw1.PatientID = pw2.PatientID WHERE pw1.PatientID = 10004720 AND pw1.DateTime = '2100-12-07 00:00:00' AND pw2.DateTime = '2100-12-06 00:00:00';
22b41e8ee0723aa4a6acf31c,What is the hospital's minimum total cost that involved a procedure called endovascular (total) embolization or occlusion of head and neck vessels since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endovascular (total) embolization or occlusion of head and neck vessels' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",,"SELECT MIN(total_cost) FROM claims WHERE procedure_description LIKE '%endovascular (total) embolization or occlusion of head and neck vessels%' AND claim_date > DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"
24bf28822b415fe4f9bd906c,What specimen tests did patient 10038992 undergo for the first time during the first hospital visit?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'spec_type_desc': 'BLOOD CULTURE'}],SELECT DISTINCT test_type FROM specimen_tests WHERE patient_id = 10038992 AND visit_number = 1 ORDER BY test_date ASC LIMIT 1
99bcce6bc0fdda73e97057c2,When was patient 10027602's first input time since 07/21/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-21' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2201-10-30 12:08:00'}],SELECT MIN(input_time) AS first_input_time FROM patient_data WHERE patient_id = '10027602' AND input_time > '07/21/2100';
7499a31689ceddb83308b2d0,"Since 2100, has patient 10004235 undergone a simple excision of other lymphatic structure procedure?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'",,"[select distinct procedure.procedure_name, procedure.performed_date from patient_procedures"
537ba5b0d8bba89f02aeaf41,"Since 06/14/2100, when did patient 10019172 have his last input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-06-14' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2118-11-19 19:30:00'}],SELECT MAX(input_date) AS last_input_date FROM patient_inputs WHERE patient_id = '10019172' AND input_date > '2100-06-14';
a1b0068465d08286b72f7de4,Tell me the duration in days of patient 10005909's first stay in the ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 3.677384258713573}]",""""""""
1e43adf0cab50573f8e61e90,What was the first thing patient 10021312 had as output since 03/11/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-11' ORDER BY outputevents.charttime ASC LIMIT 1 )",[{'label': 'Void'}],select top 1 type from outputs where patientid=10021312 and date>='03/11/2100' order by date asc
00c6c1102d545178bf7380f3,"Has acetaminophen, lidocaine 0.5%, or soln been prescribed for patient 10007928?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 ) AND prescriptions.drug IN ( 'acetaminophen', 'lidocaine 0.5%', 'soln' )",[{'COUNT(*)>0': 0}],SELECT CASE WHEN EXISTS (SELECT * FROM prescriptions WHERE patient_id = 10007928 AND (drug_name = 'acetaminophen' OR drug_name = 'lidocaine 0.5%' OR drug_name = 'soln')) THEN 'Yes' ELSE 'No' END AS 'Prescribed'
3bf2d40135249f916f915ace,What was the last specimen test given to patient 10020786 since 05/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'BLOOD CULTURE'}],"SELECT TOP 1 test_date, test_type FROM specimen_tests WHERE patient_id = 10020786 AND test_date >= '05/2100' ORDER BY test_date DESC"
5077dabbbdb1f143ad870dd9,"Calculate the number of patients diagnosed with body mass index 31.0-31.9, adult since 2100.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 31.0-31.9, adult' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",,SQL Query
880dda6394687e6af314914f,"Tell me the three most common microbiology tests for patients who were previously diagnosed with adverse effect of penicillins, initial encounter within 2 months.","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'adverse effect of penicillins, initial encounter' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3",,"SELECT test_name, COUNT(*) AS test_count FROM microbiology_tests WHERE patient_id IN (SELECT patient_id FROM diagnoses WHERE diagnosis = 'adverse effect of penicillins' AND encounter_type = 'initial' AND diagnosis_date BETWEEN DATE_SUB(NOW(), INTERVAL 2 MONTH) AND NOW()) GROUP BY test_name ORDER BY test_count DESC LIMIT 3;"
8a5ef0e3b44f9d29e1d8e450,Patient 10014078's chloride last measured on the last hospital visit is less than the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT CASE WHEN (SELECT chloride FROM lab_results WHERE patient_id = 10014078 AND visit_date = (SELECT MAX(visit_date) FROM lab_results WHERE patient_id = 10014078)) < (SELECT chloride FROM lab_results WHERE patient_id = 10014078 AND visit_date = (SELECT MAX(visit_date) FROM lab_results WHERE patient_id = 10014078 AND visit_date < (SELECT MAX(visit_date) FROM lab_results WHERE patient_id = 10014078))) THEN 'Yes' ELSE 'No' END as 'Chloride Decreased'
2723a0b2a202e96ddb72ec44,What were the three most common drugs prescribed throughout this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3",[],"select drug, count(*) as cnt from prescriptions where YEAR(prescription_date) = YEAR(CURDATE()) group by drug order by cnt desc limit 3"
69d1179ddab59c8ffa8e22d7,What was the first time of input for patient 10009049 on 06/14/this year?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '06-14' ORDER BY inputevents.starttime ASC LIMIT 1",[],SELECT MIN(time_of_input) FROM patient_records WHERE patient_id = 10009049 AND date_of_input = '2023-06-14';
b01254cc6625f82626d18102,"What is the cost for the procedure destruction of right main bronchus, via natural or artificial opening endoscopic?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) )",,SELECT cost FROM procedures WHERE name = 'destruction of right main bronchus' AND access_method = 'endoscopic'
5a57c249d0fff38a58052135,"What are the four most typically ordered procedures for patients previously diagnosed with other anaphylactic reaction, which took place within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other anaphylactic reaction' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,"SELECT procedure_name, COUNT(*) AS order_count FROM procedures JOIN patient_history ON procedures.patient_id = patient_history.patient_id WHERE patient_history.diagnosis = 'anaphylactic reaction' AND procedures.procedure_date BETWEEN DATE_SUB(patient_history.diagnosis_date, INTERVAL 2 MONTH) AND patient_history.diagnosis_date GROUP BY procedure_name ORDER BY order_count DESC LIMIT 4"
1e888452b37ac8ca86b6980c,What the code that refers to icd-11 for senile dementia uncomp in icd-10?,,,"select code from icd_11 where description=""senile dementia uncomp"" and icd_10_code in (select code from icd_10 where description=""senile dementia uncomp"")"
5d3b63e510deecde492912dc,What culture was patient 10021666 first tested?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,[{'spec_type_desc': 'MRSA SCREEN'}],SELECT first_culture_tested FROM patients WHERE patient_id = 10021666
ef3149b9a35fb04e1492d336,When did the first time patient 10015272 had the minimum value of SaO2?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",[],SELECT TOP 1 time FROM chartevents WHERE itemid=50960 AND subject_id=10015272 ORDER BY SaO2 ASC
c3ec4bb31cef4c9d976a8b02,What was the organism found in patient 10029291's last urine test?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,[],the organism found in the last urine test for patient 10029291
641457e48596a76706eaa733,"What is the maximum total hospital cost, which includes other acute pain since 2100?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other acute pain' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,SELECT MAX(Total_hospital_cost) FROM dataset WHERE acute_pain_type = 'other acute pain' AND hospital_cost_date >= '2100-01-01'
3917dc2e272fabe6467257d2,I need the name of the diagnostic that patient 31510 received in the other department,,,SELECT d.name FROM diagnosis d JOIN department_diagnosis dd ON d.diagnosis_id = dd.diagnosis_id WHERE dd.patient_id = 31510 AND dd.department_id != (SELECT department_id FROM department_diagnosis WHERE patient_id = 31510 LIMIT 1)
bbb1655c44fb049ef7b879ae,Tell me the number of patients who stayed in medicine since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'medicine' AND strftime('%Y',transfers.intime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(DISTINCT patient_id) as num_patients FROM admissions WHERE department = 'medicine' AND admission_date >= '2100-01-01';
19514defe49fe155ab776c71,What were the top five most frequent specimens ordered for patients after being diagnosed with proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site within the same hospital visit?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'proteus (mirabilis) (morganii) infection in conditions classified elsewhere and of unspecified site' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5",,specimen
997ad426b096ea558462f1a2,Did patient 10005817 have an input of kcl (bolus) on this month/25?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '25'",[{'COUNT(*)>0': 0}],"select distinct c.input_time, c.input_rate from chart c where c.input_time between '2023-01-25' and '2023-02-25' and c.input_type like '%kcl%' and c.patient_id = '10005817' and c.input_rate is not null"
a49d3f97e37407754c15cf05,When for the last time since 08/2100 was patient 10015860 prescribed ondansetron and bisacodyl at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10015860 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'bisacodyl' AND admissions.subject_id = 10015860 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],[select max(a.date) from
543a7a730e5752f6d23804e0,"Did patient 10015931 receive the procedure of a replacement of aortic valve with zooplastic tissue, percutaneous approach during their last hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'replacement of aortic valve with zooplastic tissue, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )",[{'COUNT(*)>0': 0}],"SELECT EncounterID FROM Procedures WHERE PatientID = '10015931' AND ProcedureName = 'Replacement of Aortic Valve with Zooplastic Tissue, Percutaneous Approach' ORDER BY EncounterDate DESC LIMIT 1"
794da47ae77cd75fe2914cf2,"In the previous year, how many patients underwent a transcatheter embolization for gastric or duodenal bleeding within 2 months after the diagnosis of unspecified essential hypertension?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'transcatheter embolization for gastric or duodenal bleeding' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT COUNT(*) AS Number_of_Patients FROM Patient_Treatments WHERE Procedure = 'Transcatheter Embolization' AND Condition = 'Gastric or Duodenal Bleeding' AND Date_of_Procedure BETWEEN DATE_SUB(Diagnosis_Date, INTERVAL 2 MONTH) AND Diagnosis_Date AND Diagnosis = 'Unspecified Essential Hypertension' AND YEAR(Diagnosis_Date) = YEAR(CURRENT_DATE) - 1"
bbd3ab3b5e2878e0c7d8dc79,What was the maximum value of lymphocytes in patient 10016742's body in 07/2100?,"SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND strftime('%Y-%m',labevents.charttime) = '2100-07'",[{'MAX(labevents.valuenum)': None}],SELECT MAX(lymphocytes) FROM bloodwork WHERE patient_id = 10016742 AND date = '2100-07-01'
b0fa39290a379ac3962d1215,Does patient 12410 have experience with overseas travel?,,,SELECT COUNT(*) AS overseas_travel_count FROM patient_travel_history WHERE patient_id = 12410 AND country <> 'Home Country'
381ee96e607f7191231167cb,Tell me the insurance plan in place for patient 10039831 on this hospital stay.,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL,[],select * from `hospital_stay` where `patient_id` = 10039831
1d35d6275c13a75467d5621f,"How many patients underwent endovascular (total) embolization or occlusion of head and neck vessels within the same hospital visit after the diagnosis of attention deficit disorder with hyperactivity, in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endovascular (total) embolization or occlusion of head and neck vessels' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id",,"SELECT COUNT(DISTINCT patient_id) FROM patient_visits pv JOIN procedures p ON pv.visit_id = p.visit_id WHERE p.procedure_type IN ('endovascular embolization', 'occlusion') AND pv.diagnosis = 'attention deficit disorder with hyperactivity' AND pv.visit_date BETWEEN '2100-01-01' AND '2100-12-31'"
5ea4690a08942372011bee45,"Of the patients of age 50s since 1 year ago, what were the top four most frequent diagnoses?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",,"SELECT Diagnosis, COUNT(*) as DiagnosisCount FROM Patients P JOIN Visits V ON P.PatientID = V.PatientID JOIN Diagnoses D ON V.VisitID = D.VisitID WHERE P.Age BETWEEN 50 AND 59 AND V.VisitDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY Diagnosis ORDER BY DiagnosisCount DESC LIMIT 4"
1f7740e7b17317dd9085a8ce,Did patient 10020944 have any surgeries in their last hospital encounter?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),[{'COUNT(*)>0': 1}],SQL Query Here
56902909daa613c259aedbde,What is the average total expenditure of a hospital that involves the medication miconazole nitrate vag cream 2% during this year?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'miconazole nitrate vag cream 2%' ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY cost.hadm_id ) AS T1",,SELECT AVG(total_expenditure) FROM hospital_financials WHERE medication LIKE '%miconazole nitrate vag cream 2%' AND year = YEAR(CURRENT_DATE)
69670441a1821ea09ab84daa,Show me patient 10018081's total ostomy (output) output amount since 07/25/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ostomy (output)' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-07-25'",[{'SUM(outputevents.value)': None}],select sum(qty) from output where patid=10018081 and ostomy='Y' and chartdate>='07/25/2100'
962c0dd05a16f3d046055b17,What specimen tests did patient 10039997 undergo for the last time since 05/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-05' ORDER BY microbiologyevents.charttime DESC LIMIT 1",[{'spec_type_desc': 'MRSA SCREEN'}],
45d81fe4cd05b27444d9f58e,What does a procedure under the name coronary arteriography using two catheters cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) ),,select distinct price from medical_procedures where procedure_name = 'coronary arteriography' and num_catheters = 2;
d4838da30561bc40110b929d,Do you think patient 1912 has dmii circ nt st uncntrld in his or her family?,,,select has_dmii_circ_nt_st_uncntrld from patient_history where patient_id = 1912
049fb43f09ae244560ee52a7,"Compared to yesterday, what new prescriptions were given to patient 10039831 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",[],SQL Query Here
04e24b204bd0cfa1f803ee70,Tell me the difference in the heart rate value for patient 10019385 last measured on the first ICU visit compared to the second to last value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT ABS(MAX(h.heart_rate) - MIN(h.heart_rate)) AS heart_rate_diff FROM heart_rate h WHERE h.subject_id = 10019385 AND h.icu_id = 1 AND h.charttime BETWEEN (SELECT MIN(charttime) FROM heart_rate WHERE subject_id = 10019385 AND icu_id = 1) AND (SELECT MAX(charttime) FROM heart_rate WHERE subject_id = 10019385 AND icu_id = 1)
64a43632d54bb861d083b284,Get the count of the number of hospital visits of patient 10031404 last year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10031404 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",[{'COUNT( DISTINCT admissions.hadm_id )': 0}],select count(*) from visit v inner join patient p on v.patient_id=p.id where p.id=10031404 and v.visit_date between '2022-01-01' and '2022-12-31'
d1848715fb9bd76d88e82c49,What was the last o2 saturation pulseoxymetry value patient 10018081 had on this month/27?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '27' ORDER BY chartevents.charttime DESC LIMIT 1",[],SELECT `oximetry_observations`.`o2Saturation` FROM `oximetry_observations` WHERE `oximetry_observations`.`patient_id` = 10018081 AND `oximetry_observations`.`recordDate` BETWEEN '2023-09-01' AND '2023-09-27' ORDER BY `oximetry_observations`.`recordDate` DESC LIMIT 1;
dd84074c0fd0874c556d0511,How often did patient 10018845 go to the ICU?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ),[{'COUNT( DISTINCT icustays.stay_id )': 1}],SELECT COUNT(*) FROM icu_stays WHERE patient_id = 10018845
c2611c6cae651d68d35a90db,"How many days have elapsed since the last time patient 10004733 was diagnosed with tachycardia, unspecified on the current hospital visit?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'tachycardia, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1",,"SELECT DATEDIFF(CURDATE(), MAX(diagnosis_date)) AS days_since_last_tachycardia FROM diagnoses WHERE patient_id = 10004733 AND diagnosis_code = 'Tachycardia, unspecified' AND visit_id = (SELECT MAX(visit_id) FROM visits WHERE patient_id = 10004733)"
0e012c21a61355d6b84c3090,How much does it cost for insulin?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'insulin' ),,SELECT price FROM medication WHERE name = 'insulin'
58005b8292ece24dcde6f455,What was the number of fluoroscopy of right heart using other contrast procedures performed in 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of right heart using other contrast' ) AND strftime('%Y',procedures_icd.charttime) = '2100'",,SQL Query
687bceb15b59fc60e8fe6650,Could you provide the top four most common output events in 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) = '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",[],"SELECT ""output_event"", COUNT(*) AS frequency FROM events WHERE ""year"" = 2100 GROUP BY ""output_event"" ORDER BY frequency DESC LIMIT 4"
3d45d365e05eb1ff7b926005,How many hours elapsed since patient 10018081 received his chloride lab test for the last time on their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'chloride' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MAX(chl.labDateTime), NOW()) FROM lab_tests chl JOIN encounter e ON chl.encounterID = e.encounterID WHERE e.patientID = 10018081 AND chl.testName = 'chloride' AND e.encounterID = (SELECT MAX(encounterID) FROM encounter WHERE patientID = 10018081)"
7f05f81e2c4bccc575d180b8,Could you inform me of the top three most common specimen tests that were conducted?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","[{'spec_type_desc': 'URINE'}, {'spec_type_desc': 'BLOOD CULTURE'}, {'spec_type_desc': 'SWAB'}]",SQL Query
2d6e4345dac956dd550150ea,When patient 10014078 first had a urine microbiology test since 03/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND microbiologyevents.spec_type_desc = 'urine' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",[],SELECT MIN(date) FROM urine_microbiology WHERE patient_id = 10014078 AND date > '03/2100';
77fee139a7a8698c4a12156a,Tell me the top five most frequent procedures that patients received within 2 months after being diagnosed with hyperplasia of renal artery.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperplasia of renal artery' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",,"select top 5 procedure_name, count(*) as frequency from procedures p join diagnoses d on p.patient_id = d.patient_id where d.diagnosis = 'hyperplasia of renal artery' and p.procedure_date between d.diagnosis_date and dateadd(month, 2, d.diagnosis_date) group by procedure_name order by frequency desc"
18010be66782b5371bb31160,What were the four most commonly given diagnoses for patients who had received percutaneous abdominal drainage before within 2 months since 1 year ago?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",,SQL Query Here
bfb03e1d79c3802ab3081d33,"In total, how many patients were prescribed iso-osmotic sodium chloride since 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic sodium chloride' AND strftime('%Y',prescriptions.starttime) >= '2100' )",[{'COUNT( DISTINCT admissions.subject_id )': 0}],SELECT count(DISTINCT patient_id) FROM prescriptions WHERE medication = 'iso-osmotic sodium chloride' AND date_prescribed >= '2100-01-01';
1ac4bb5a24bb2e2beea14966,Is the respiratory rate reading for patient 10014078 last measured on the first ICU visit greater than the value second to last measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 )"": None}]",SELECT CASE WHEN (SELECT respiratory_rate FROM patient_data WHERE patient_id = 10014078 AND visit_number = 1 AND measurement_order = 'last') > (SELECT respiratory_rate FROM patient_data WHERE patient_id = 10014078 AND visit_number = 1 AND measurement_order = 'second to last') THEN 'Yes' ELSE 'No' END
cb480ff3c89f74e82be45053,What was the last drug prescribed since 12/2100 to patient 10021118?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-12' ORDER BY prescriptions.starttime DESC LIMIT 1",[{'drug': 'Furosemide'}],"SELECT drug_name, MAX(date_prescribed) FROM prescriptions WHERE patient_id = '10021118' AND date_prescribed >= '2023-12-01' GROUP BY drug_name ORDER BY MAX(date_prescribed) DESC LIMIT 1"
3244f169b0839776c6f8d9aa,What's the alkaline phosphatase change of patient 10021938 last measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'alkaline phosphatase' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","select (max(alfs1) - min(alfs1)) as ""Alkaline phosphatase change"" from labevents where subject_id = 10021938 and special_procedure = 'First hospital visit' and alfs1 is not null"
15d1606a584e98abfb4203b3,Retrieve the yearly average amount of patient 10021118's or cell saver intake input since 12/2100.,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12' GROUP BY strftime('%Y',inputevents.starttime)",[],"[SELECT AVG(AMOUNT) AS yearly_average, EXTRACT(YEAR FROM TRANSFUSION_DATE) AS year"
f4312adc1652536556c92455,What was patient 10018423's last input time on 05/21/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-05-21' ORDER BY inputevents.starttime DESC LIMIT 1",[],SELECT MAX(input_time) FROM patient_data WHERE patient_id = '10018423' AND DATE(input_time) = '2100-05-21'
d73de23832fc51ea33bed174,What was the name of the drug that patient 10027602 was prescribed with within the same hospital visit after undergoing continuous invasive mechanical ventilation for less than 96 consecutive hours during this month?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",,"select distinct d.drug_name from prescribes p join patients pe on p.patient_id = pe.patient_id join drugs d on p.drug_id = d.drug_id join admissions a on pe.admission_id = a.admission_id join procedures pr on a.admission_id = pr.admission_id where pe.patient_id = 10027602 and pr.procedure_name = 'continuous invasive mechanical ventilation' and pr.duration <= 96 and a.visit_id = (select visit_id from admissions where patient_id = 10027602 and visit_date >= date('now', 'start of month') and visit_date < date('now', 'start of month', '+1 month')) order by p.prescription_date limit 1"
24ebd2bae7cfabd18b6ce9c8,Does patient 46528 have a history of overseas travel?,,,SELECT EXISTS (SELECT 1 FROM PatientHistory WHERE PatientID = 46528 AND TravelHistory LIKE '%overseas%') AS HasOverseasTravel
db18ec5bfbe1e3422939cf2b,How much is drainage of pancreatic cyst by catheter?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pancreatic cyst by catheter' ) ),,"select sum(p.cost) from (select d.patient_id, d.date, d.procedure, d.cost from drainage_procedure d, patient p where d.patient_id = p.id and d.procedure = 'pancreatic cyst by catheter' and d.date between '2023-01-01' and '2023-12-31') as p"
f06966c4eb707fc9298cf8ed,When has patient 10015272 last had the creatine kinase (ck) minimum value?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase (ck)' ) ORDER BY labevents.valuenum ASC, labevents.charttime DESC LIMIT 1",[],SELECT TOP 1 [visit date
edf02ff65e3bddb4db278a87,When was the last time patient 83182 had medication that should be regularly taken?,,,select MAX(date_prescribed) as last_medication_date from prescriptions where patient_id='83182' and is_regular_maintenance=1
347ab7a4fae1946384a4e79f,What is the maximum total hospital cost which involves (aorto)coronary bypass of four or more coronary arteries since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of four or more coronary arteries' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",,"select max(hospital.cost) from hospital,procedures where hospital.admission_id=procedures.admission_id and procedures.code in ('0211','0212','0213') and procedures.date >= '2100-01-01' group by hospital.admission_id having count(procedures.code) >= 4"
c749d56aa8cacdcfa66338ba,Tell me all the prescriptions that patient 83062 received at the other department.,,,SELECT * FROM prescription_records WHERE patient_id = '83062' AND department <> 'current_department'
c7fe6ea31f9f71af4dcc0072,How many hours is it since patient 10004733 last stayed in the careunit neurology in the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1",[],"SELECT TIMESTAMPDIFF(HOUR, MAX(end_time), NOW()) AS hours_since_last_stay FROM careunit_stays WHERE patient_id = '10004733' AND unit_name = 'neurology' AND encounter_id = (SELECT current_encounter_id FROM patient_encounters WHERE patient_id = '10004733');"
73b0f8fd2749c9bf490fe19c,"What is the maximum total hospital cost that involves a procedure called insertion of infusion device into right atrium, percutaneous approach?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of infusion device into right atrium, percutaneous approach' ) ) GROUP BY cost.hadm_id ) AS T1",,"SELECT MAX(Total_Hospital_Cost) FROM claims WHERE Procedure_Description = 'Insertion of infusion device into right atrium, percutaneous approach'"
d162e9cc060eadbc00511ac2,What methods are used to ingest lisinopril?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'lisinopril',"[{'route': 'ORAL'}, {'route': 'PO/NG'}]",SELECT method FROM drug_ingestion WHERE drug_name = 'lisinopril'
55cd50500d3f96c291347d01,How many patients underwent transcatheter embolization for gastric or duodenal bleeding within the same month after the diagnosis of other specified hypotension?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified hypotension' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'transcatheter embolization for gastric or duodenal bleeding' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,"SELECT COUNT(*) AS PatientCount FROM (SELECT DISTINCT PatientID FROM MedicalProcedures WHERE ProcedureCode IN ('TCE_Gastric', 'TCE_Duodenal') AND Month = (SELECT Month FROM Diagnoses WHERE ConditionCode = 'Hypotension_Specified' AND PatientID = MedicalProcedures.PatientID)) AS Subquery"
ea75ae7fadc90d510e6c9488,What is the price of a diagnosis for other lymphedema?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other lymphedema' ) ),,SELECT price FROM medical_procedures WHERE diagnosis_code = 'Other Lymphedema'
7ea687da89af68315ce96f56,Does patient 19175 have a family history of colostomy status?,,,SQL Query Here
69b4dbcc3e05876c15ab3314,During what last time in their first hospital encounter did patient 10022880 have the maximum epithelial cells level?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'epithelial cells' ) ORDER BY labevents.valuenum DESC, labevents.charttime DESC LIMIT 1",[],select max(endtime) from labevents where subject_id='10022880' and itemid in (8128) and endtime in (select max(endtime) from labevents where subject_id='10022880' and itemid in (8128)) group by charttime order by max(endtime) limit 1
577572963a504b16ab2aced7,Show me patient 10004733's total volume of output since 12/07/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-07'",[{'SUM(outputevents.value)': 17410.0}],
1c833319621b08fd5e14e8ff,What was the last drug prescribed since 05/2100 to patient 10018328 via the sc route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime DESC LIMIT 1",[],"select drug, max(date) from prescriptions where patient_id = 10018328 and date >= '05/2100' and route = 'sc' group by drug order by max(date) desc limit 1;"
a19797fad6ac2c57326769e0,"In 2100, has patient 10005909 been diagnosed with any illness?","SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'",,SELECT diagnosis FROM patient_diagnoses WHERE patient_id = '10005909' AND YEAR(diagnosis_date) = 2100
627069dc134dd25c3ddbbb5a,What was the first medication that patient 10021118 was prescribed via po/ng route in 11/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11' ORDER BY prescriptions.starttime ASC LIMIT 1",[],"select first_name, last_name, gender, medication, route, date_prescribed from medication_prescriptions where patient_id='10021118' and route='po/ng' and date_prescribed >= '11/01/2100' and date_prescribed < '12/01/2100' order by date_prescribed limit 1"
f0f7a54c7ede3f83d04bd4df,What was the name of the organism found in the first microbiological examination of patient 10037861's urine?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,[],SELECT organism_name FROM microbiological_examinations WHERE patient_id = '10037861' ORDER BY examination_date ASC LIMIT 1
facfa7d227ce410e9a85def3,What is the title of the medication that was given to patient 10014078 first via the sc means on the last hospital stay?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1,[],SELECT medication_name FROM prescriptions WHERE patient_id = '10014078' AND route = 'sc' AND admission_id = (SELECT MAX(admission_id) FROM admissions WHERE patient_id = '10014078') ORDER BY date_time ASC LIMIT 1;
96487dd035f8b985f4b01677,When is the earliest of patient 31880's next visit to other departments?,,,SELECT MIN(next_visit) FROM PatientVisits WHERE patient_id = '31880' AND department <> 'Cardiology' AND next_visit IS NOT NULL
6dbf8d68ebe9d4efd1f714f1,What was the last input time of patient 10026354 since 03/12/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-12' ORDER BY inputevents.starttime DESC LIMIT 1",[{'starttime': '2119-10-27 14:02:00'}],[select * from (
d6a0bcd1249a8b5f2385ac6b,When had patient 10018501 first been prescribed for omeprazole and phenobarbital alcohol withdrawal dose taper (days 2-7) at the same time in 08/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'omeprazole' AND admissions.subject_id = 10018501 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phenobarbital alcohol withdrawal dose taper (days 2-7)' AND admissions.subject_id = 10018501 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1",[],select distinct mrs_encounter.visit_start_datetime as visit_start_datetime from mrs_encounter where mrs_encounter.visit_start_datetime like '2023-08%' and mrs_encounter.patient_id='10018501' and (mrs_encounter.encounter_type='Clinic' or mrs_encounter.encounter_type='Telemedicine') and mrs_encounter.visit_start_datetime in (select distinct visit_start_datetime from mrs_medication where medication_name='Omeprazole' and medication_dose='20 mg' and medication_frequency='1/day') and mrs_encounter.visit_start_datetime in (select distinct visit_start_datetime from mrs_medication where medication_name='Phenobarbital' and medication_dose='30 mg' and medication_frequency='1/2 day' and medication_route='Oral') order by mrs_encounter.visit_start_datetime limit 1
42ec95f5707880f8478c4eb9,What were the four most often conducted microbiology tests since 1 year ago?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","[{'test_name': 'URINE CULTURE'}, {'test_name': 'Blood Culture, Routine'}, {'test_name': 'WOUND CULTURE'}, {'test_name': 'RESPIRATORY CULTURE'}]","SELECT test_name, COUNT(*) AS test_count FROM microbiology_tests WHERE test_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY test_name ORDER BY test_count DESC LIMIT 4"
5852e743e53e91715cff50d3,Tell me the length of stay in days of patient 10007795's last ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","[{""strftime('%J', icustays.outtime) - strftime('%J', icustays.intime)"": 1.0505208340473473}]","SELECT DATEDIFF(discharge_date, admission_date) AS length_of_stay_in_days FROM patient_icu_stays WHERE patient_id = '10007795' ORDER BY discharge_date DESC LIMIT 1"
f1308ea9b8bbc94c5e296e34,How much does the neutrophils change in patient 10004733 last measured on the current hospital visit compared to the first value measured on the current hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) ORDER BY labevents.charttime ASC LIMIT 1 ),"[{""( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'neutrophils' ) ORDER BY labevents.charttime ASC LIMIT 1 )"": None}]","SELECT current_visit.visit_id, current_visit.patient_id, (current_visit.neutrophils - first_visit.neutrophils) AS neutrophil_change FROM hospital_visits AS current_visit JOIN hospital_visits AS first_visit ON current_visit.patient_id = first_visit.patient_id AND current_visit.visit_id > first_visit.visit_id AND first_visit.is_first_visit = TRUE WHERE current_visit.patient_id = 10004733 AND current_visit.is_latest = TRUE"
fb06f32bc5c8aef557ce529e,When did patient 10004422 last get prescribed aspirin and milk of magnesia at the same time in 01/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'aspirin' AND admissions.subject_id = 10004422 AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'milk of magnesia' AND admissions.subject_id = 10004422 AND strftime('%Y-%m',prescriptions.starttime) = '2100-01' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1",[],"SELECT MAX(date_prescribed) FROM prescriptions WHERE patient_id = 10004422 AND drug_name IN ('aspirin', 'milk of magnesia') AND date_prescribed LIKE '01/2100%' GROUP BY patient_id HAVING COUNT(DISTINCT drug_name) = 2"
fd81b513857342c1199e0cf2,What was patient 10038999's last tested specimen during their first hospital encounter?,SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,[{'spec_type_desc': 'PLEURAL FLUID'}],SELECT specimen FROM lab_tests WHERE patient_id = 10038999 ORDER BY test_date DESC LIMIT 1
9c5f4de218634410a8efb1a9,Calculate the number of ICU visits of patient 10010471 since 1 year ago.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(icustays.intime) >= datetime(current_time,'-1 year')",[{'COUNT( DISTINCT icustays.stay_id )': 1}],"select count(distinct icustay_id) from `physionet-data.mimiciii_clinical.icustays` where subject_id = 10010471 and intime between date_sub(current_date(), interval 1 year) and current_date()"
0cd0b92b050e9e355d9c8775,What's the total of avapro prescriptions in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'avapro' AND strftime('%Y',prescriptions.starttime) = '2100'",[{'COUNT(*)': 0}],select sum(prescription_count) as total_prescriptions from prescriptions where drug_name='avapro' and year=2100
7a2a83f4a894b5b5f2076da6,What is today's outpatient schedule for dr. gaylor?,,,SELECT * FROM outpatient_schedule WHERE doctor = 'Dr. Gaylor' AND schedule_date = CURRENT_DATE;
79e773e17e3c570dd78813ae,"How many patients received extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic treatment in the same month after having been diagnosed with other diseases of bronchus, not elsewhere classified since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other diseases of bronchus, not elsewhere classified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')",,[select count(distinct a.person_id) from occurrence a
bb37a5a6fa2b7bfb4a31e4e7,Can you show me the top five most common procedures conducted since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",,"SELECT procedure, COUNT(procedure) AS frequency FROM outpatient_procedure GROUP BY procedure ORDER BY frequency DESC LIMIT 5;"
27f86a5f461f220f2b2ed647,How many days have passed since patient 10021487 first visited the careunit emergency department on this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime ASC LIMIT 1",[],"SELECT COUNT(DATE_PART('day', CURRENT_DATE - MIN(visit_date))) AS days_since_first_visit FROM patient_visits WHERE patient_id = '10021487' AND department = 'emergency' AND encounter_id = 'current_encounter_id';"
ffd93124fef0ab4f2c5e1f7d,When did the first input for patient 10021487 occur since 12/19/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-19' ORDER BY inputevents.starttime ASC LIMIT 1",[{'starttime': '2116-12-03 00:26:00'}],SELECT TOP 1 [DATETIME
45ff22c09f3754e81e8ab8b4,How many patients underwent extracorporeal circulation auxiliary to open heart surgery within 2 months after the diagnosis of long-term (current) use of insulin?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long-term (current) use of insulin' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')",,"SELECT COUNT(DISTINCT patient_id) FROM patient_records WHERE insulin_use = 'long-term' AND surgery_type = 'open heart' AND surgery_date BETWEEN diagnosis_date AND DATE_ADD(diagnosis_date, INTERVAL 2 MONTH) AND procedure_type = 'extracorporeal circulation'"
0e87f2737511d219196c8409,What's the weight difference of patient 10038999's body measured at 2100-06-07 05:00:00 compared to the value measured at 2100-06-06 06:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-07 05:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-06 06:00:00' ),"[{""( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-07 05:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-06-06 06:00:00' )"": None}]",[SELECT ABS(B1.weight - B2.weight) AS weight_difference
1707f8cb73d2f9a0fc881db5,What was measured as patient 10007818's weight during the first check since 23 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-23 month') ORDER BY chartevents.charttime ASC LIMIT 1",[],"SELECT measurement_date, measurement_value FROM measurements WHERE patient_id = 10007818 AND measurement_type = 'Weight' AND measurement_date BETWEEN (CURRENT_DATE - INTERVAL '23 months') AND (SELECT MIN(measurement_date) FROM measurements WHERE patient_id = 10007818 AND measurement_date >= (CURRENT_DATE - INTERVAL '23 months')) ORDER BY measurement_date ASC LIMIT 1;"
8f3012a3f38700d9fef0fbad,Is patient 23070 a person with a family history of any disease?,,,SELECT * FROM [PATIENT_FAMILY_HISTORY
ed9a4d3d34a8ae1c9e013631,When was the first time patient 10040025 was prescribed a medication in 03/2100 via the po/ng route?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ORDER BY prescriptions.starttime ASC LIMIT 1",[],SELECT MIN(date) FROM prescriptions WHERE patient_id = '10040025' AND date LIKE '03/2100%' AND route = 'po/ng'
