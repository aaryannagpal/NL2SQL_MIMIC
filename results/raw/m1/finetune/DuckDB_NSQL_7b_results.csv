id,question,true_query,generated_query
3f70d67ccafc181a6d95a5da,When was back to godhead written?,,SELECT DISTINCT prescription_date FROM prescriptions WHERE prescription_id = 36125376 AND prescription_date BETWEEN '2100-01-01 00:00:00' AND '2100-01-01 00:00:00'
a5348117eb65b1c2d5c291ae,Call the it department to report a system issue in patient records.,,SELECT * FROM patients WHERE patients.gender = 'f'
8b093fb10a7007c37b5ff6f9,What is primary and non-contributory under the liability,,SELECT * FROM procedures WHERE procedure_name = 'non-contributory under the liability'
cc6a1305faf59ceadd9f9270,When does patient 1819 cease to be in a quarantine for influenza?,,"SELECT ceil(current_time - (last_contact - current_time) / 365.0) as days_since_last_contact
         FROM (
             SELECT patient_id, (SELECT current_time FROM communications WHERE communications.patient_id = patients.patient_id AND communications.message_type = 'last_contact') as last_contact
             FROM patients
             WHERE patients.patient_id = 1819
         )
         WHERE days_since_last_contact > 365
         ORDER BY days_since_last_contact DESC
         LIMIT 1"
af5df4194e2b15e8dc1e2251,What are the latest guidelines for managing icu patients with sepsis?,,"1. What are the top four most common diagnoses for patients who were diagnosed with other and unspecified sepsis in the same month, in 2100?"
b6a56db2ac82031670874f35,What is the top 10 side effect of magnesium sulfate (ob)?,,10 side effects of magnesium sulfate (ob)
a518bc2ddd1eb83ea00755ac,What are the drugs given as sedatives to patient 22245?,,"SELECT T1.drug FROM ( SELECT prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE prescriptions.patient = 22245 AND prescriptions.drug_type_code = 'sedative' ) AS T1 JOIN ( SELECT events.starttime, events.drug FROM events WHERE events.patient = 22245 AND events.drug_type_code = 'medication' ) AS T2 ON T1.starttime = T2.starttime"
b718fdedc6f3898f1a2e85ab,What is the most common insurance type among patients with an address in dallas?,,"SELECT T1.insurance_type FROM ( SELECT insurance_type, COUNT(insurance_type) AS c1 FROM patients WHERE patients.address.city = 'dallas' GROUP BY insurance_type ) AS T1 ORDER BY T1.c1 DESC LIMIT 1"
774d08103f43dd4c0d900e8c,List the passwords for the patients admitted to the icu whose first wardid and last wardid is 7.,,"SELECT T1.password FROM ( SELECT T1.name, T2.wardid FROM ( SELECT T1.row_id, T1.name, T2.wardid FROM patients AS T1 JOIN wards AS T2 ON T1.row_id = T2.row_id WHERE T2.wardid = 7 ) AS T1 JOIN ( SELECT row_id, wardid FROM patients WHERE wardid = 7 ) AS T2 ON T1.row_id = T2.row_id ) AS T1 JOIN ( SELECT row_id, name FROM patients WHERE wardid = 7 ) AS T2 ON T1.row_id = T2.row_id WHERE T1.wardid_first = T2.wardid AND T1.wardid_last = T2.wardid"
ebf25ceeb5c2a16b2f7ae85d,List the hospital names and their locations.,,"SELECT name, location FROM hospitals"
089e103d861cebd552f0b089,Where could the video be found?,,1000000000000000000
d440a9848fc7ceb07f335a2d,List the passwords for the patients in the icu last month.,,SELECT T1.password FROM patients AS T1 JOIN icustays AS T2 ON T1.subject_id = T2.subject_id WHERE T2.outtime >= ( SELECT MAX(outtime) FROM icustays WHERE subject_id = 10004720 ) - INTERVAL '1 month'
574b827c1b18b74ef8d4e5aa,What is the average minimum humidity of the patients admitted to the icu yesterday?,,"SELECT AVG(T1.Humidity) FROM ( SELECT humidity FROM icu_log WHERE icu_log.icu_id IN ( SELECT icu.icu_id FROM icu WHERE icu.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL ) ) AND datetime(icu_log.timestamp,'start of day') = datetime(current_time,'start of day','-1 day') ) AS T1"
3a2dac716607f985a10414d6,Who are the patients that most recently received input medication from hwid1010?,,SELECT T1.name FROM patients AS T1 JOIN input_events AS T2 ON T1.subject_id = T2.subject_id WHERE T2.input_device_id = 1000 AND T2.start_time >= ( SELECT MAX(start_time) FROM input_events WHERE input_device_id = 1000 )
7bd71f98ee2dc6f246fa0efc,Which month of the year antihistamines are most prescribed?,,"SELECT T1.month, T1.drug FROM ( SELECT T1.month, T1.drug, COUNT(T1.drug) as prescription_count FROM ( SELECT prescriptions.month, prescriptions.drug FROM prescriptions WHERE prescriptions.drug IN ('antihistamines') ) AS T1 GROUP BY T1.month, T1.drug ) AS T2 WHERE T2.prescription_count = ( SELECT MAX(prescription_count) FROM ( SELECT T1.month, T1.drug, COUNT(T1.drug) as prescription_count FROM ( SELECT prescriptions.month, prescriptions.drug FROM prescriptions WHERE prescriptions.drug IN ('antihistamines') ) AS T1 GROUP BY T1.month, T1.drug ) AS T2 )"
a3dd6fd412e2c57c8e042d2c,What month of the year is prescribed for the most antihistamines?,,SELECT T1.month_prescribed FROM ( SELECT EXTRACT(MONTH FROM prescriptions.start_time) as month_prescribed FROM prescriptions WHERE prescriptions.drug_id = ( SELECT drugs.drug_id FROM drugs WHERE drugs.drug_name = 'antihistamines' ) ) as T1 JOIN ( SELECT EXTRACT(MONTH FROM prescriptions.start_time) as month_start FROM prescriptions WHERE prescriptions.drug_id = ( SELECT drugs.drug_id FROM drugs WHERE drugs.drug_name = 'antihistamines' ) ) as T2 ON T1.month_prescribed = T2.month_start
872a8cc39a2fa2be94add274,I.e. what is the address of patient 49036?,,SELECT address FROM patients WHERE patient_id = 49036
a751f404e68e0842c821fdd2,List the arrival times of diabetic patients this month.,,"SELECT COUNT(*) FROM patients AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.hadm_id WHERE T1.diagnosis = 'DIABETIC' AND T2.starttime >= ( SELECT current_time,-30 ) AND T2.starttime < ( SELECT current_time )"
72666d852daac3bed406ef5a,What is the average time for delays in appointments at the oncology department?,,SELECT AVG(T1.C1) FROM ( SELECT JULIANDAY(apt.date) - JULIANDAY(apt_prev.date) AS C1 FROM appointments apt JOIN appointments apt_prev ON apt.patient_id = apt_prev.patient_id WHERE apt.department = 'oncology' ) AS T1
a82eabb8c0c62cfcea76d24a,How many patients with permanent residency status were admitted today?,,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE residency_status = 'permanent';
1b30621cd64122892267eb6c,What was the average difference between charge time and billing time this year?,,"SELECT AVG( ( strftime('%J',billing_time) - strftime('%J',charge_time) ) ) FROM charges_db WHERE strftime('%Y',charge_time) = strftime('%Y',current_time)"
7f333347b430444fa0a766bb,What does the efc number mean,,SELECT DISTINCT efc_number FROM procedures
732d3247063b956a96090f13,What is patient 92063's guardian's phone number?,,SELECT guardian_phone FROM patients WHERE patient_id = 92063
b33d2a1132fb824b0556644d,What are the new drug distribution routes for this year?,,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.start_time >= '2100-01-01 00:00:00'
ac53ccba98a3999f8317cd7b,When does patient 15794 end his/her flu quarantine.,,"SELECT gt.starttime FROM ( SELECT st.starttime, st.stime FROM ( SELECT strftime('%Y-%m-%d %H:%M:%S',inputtime) as inputtime FROM ( SELECT procedures.starttime, procedures.starttime - datetime('1970-01-01 00:00:00', 'start of year', 'localtime') as starttime FROM procedures WHERE procedures.patient_id = 15794 AND procedures.starttime >= '2100-01-01 00:00:00' ) as st WHERE st.starttime < datetime('2100-01-01 00:00:00', 'start of year', 'localtime') ) as gt WHERE gt.starttime >= datetime('2100-01-01 00:00:00', 'start of year', 'localtime') - datetime('2100-01-01 00:00:00', 'start of year', 'localtime') + 1000 *"
d5619a250a533f622fa08740,Which physician performed the most number of procedures this year.,,SELECT T1.name FROM physician AS T1 JOIN procedures AS T2 ON T1.id = T2.physician_id WHERE T2.year = 2100 GROUP BY T1.id ORDER BY COUNT(*) DESC LIMIT 1
5a9ee00ab35bc444ffce03b1,How many patients with single marital status arrived between 06:00:00 and 09:00:00?,,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE marital_status = 'SINGLE' AND hour(admittime) BETWEEN 6 AND 9
87b3e4f536785307eb3c0307,‚äì what drugs are being administered for patient 24268 as sedatives?,,SELECT T1.drug FROM ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 24268 AND prescriptions.drug_type_id = 3 ) AS T1 JOIN ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 24268 AND prescriptions.drug_type_id = 4 ) AS T2 ON T1.drug = T2.drug
98dbae2cefdb17ea7b9dc802,List all requesters who have ordered more than 1000 lab tests this year.,,SELECT DISTINCT T1.name FROM patients AS T1 JOIN lab_tests AS T2 ON T1.subject_id = T2.subject_id WHERE T2.this_year > 1000
9d8003bd44d76d570bd5a8a7,How about what's the address of patient 22983?,,SELECT address FROM patients WHERE patient_id = 22983
628fca20b68618c255b7609b,What is the average time of delay of appointments in the cardiology department?,,SELECT AVG(T1.C1) FROM ( SELECT JULIANDAY(APPOINTMENT_TIME) - JULIANDAY(T1.C1) AS C1 FROM appointments AS T1 JOIN departments AS T2 ON T1.DEPARTMENT_ID = T2.DEPARTMENT_ID WHERE T2.DEPARTMENT_NAME = 'cardiology' ) AS T1
ef11de45a4ae2161f701ecec,What is the most common drug color prescribed to patients with diabetes?,,"SELECT T1.drug_name FROM ( SELECT prescriptions.drug_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.drug_type = 'drug color' GROUP BY prescriptions.drug_name ) AS T1 WHERE T1.C1 <= 1"
804573df458a455d75cf628a,Where is hamburg de located,,1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
37e79ddcdf4503d8d27520c4,What are the invoice numbers of the female patients who are not deceased?,,SELECT DISTINCT T1.invoice_number FROM patients AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id WHERE T1.gender = 'f' AND T1.expiration_time IS NULL
adea3244a3c419ff3bd8efce,What hotel did he purchase?,,SELECT name FROM hotels WHERE id = 27279?
3ebb7dfb50f5ffe20df2a74a,What is the average value of minimum humidity among the patients who were admitted to the icu more than once?,,SELECT AVG(T1.C1) FROM ( SELECT C1 FROM ( SELECT * FROM icustays WHERE icustays.icu_duration > 10000 ) AS T1 JOIN ( SELECT icustays.icu_id FROM icustays WHERE icustays.dischtime IS NOT NULL ) AS T2 ON T1.icu_id = T2.icu_id )</s>
64e462acb79b6175bf2bbc6b,What is the most common year among patients who are not dead and are affiliated with def jam records?,,SELECT MIN(T1.C1) FROM ( SELECT YEAR(P.Birthdate) AS C1 FROM patients AS P WHERE P.affiliation = 'def jam records' AND P.dod_date IS NULL ) AS T1
74b838834d5f5d278388e052,And when does patient 12927 go into the percu abdominal drainage procedure?,,SELECT procedure_time FROM procedures WHERE procedures.patient_id = 12927 AND procedures.procedure_name = 'percu abdominal drainage'
8fb8024e79d5f38a28e0a1ee,Which performing physicians were involved in procedures for patients admitted via emergency room admission?,,"SELECT T3.p_name FROM ( SELECT T2.p_id, T2.t_name FROM ( SELECT T1.subject_id, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.t_name = 'emergency room admission' ) AS T1 GROUP BY T1.subject_id HAVING MIN(diagnoses.t_time) = diagnoses.t_time ) AS T2 JOIN ( SELECT patients.p_id, procedures.p_name FROM procedures JOIN patients ON procedures.p_id = patients.p_id ) AS T3 ON T2.p_id = T3.p_id"
abcfd88c087ff9b6e46059c9,Show the average number of procedures performed per physician.,,"SELECT T1.name, AVG(T1.counts) FROM ( SELECT procedure_name AS name, COUNT(*) AS counts FROM procedures GROUP BY procedure_name ) AS T1 JOIN physicians AS T2 ON T1.name = T2.name GROUP BY T1.name"
28e916123e56f4d1556203b3,Who was the last doctor patient 32153 saw in the obstetrics and gynecology department?,,SELECT T3.name FROM patients AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id JOIN doctors AS T3 ON T2.doctor_id = T3.doctor_id WHERE T1.subject_id = 32153 AND T2.department = 'obstetrics and gynecology' ORDER BY T2.start_time DESC LIMIT 1
f65b450597677193bcbee6c7,What were they riding on?,,SELECT vehicle FROM assistants WHERE assistant_name = 'doctor' UNION SELECT vehicle FROM patients WHERE patient_name = 'john doe'
05215f22ac565a3030674879,Please inform me of the phone number of patient 22782's guardian.,,SELECT guardian_phone FROM patients WHERE patient_id = 22782
6837c9f45272479a2b16a015,What are the record companies with patients older than 45?,,SELECT T1.company FROM patients AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id WHERE T1.age > 45
2e3df8e7ff3e3bf2d3cf7cfe,When did michael laudrup start playing with fc barcelona?,,SELECT im_start FROM ( SELECT JULIANDAY(MIN(diagnosis_date)) as im_start FROM patients WHERE patients.name = 'michael laudrup' AND patients.current_district = 'fc barcelona' ) as subquery
e5afb16514771a25b2e457e0,List the medications prescribed to patients with a male first child.,,"SELECT T1.drug FROM ( SELECT patient.age, patient.gender FROM patients JOIN ( SELECT subject_id FROM diagnoses WHERE diagnosis_id = ( SELECT diagnosis_id FROM diagnoses WHERE diagnosis = 'male first child' ) ) AS T1 JOIN patient ON T1.subject_id = patient.subject_id WHERE patient.age < 20 ) AS T1 JOIN ( SELECT subject_id, prescriptions.drug FROM prescriptions JOIN patients ON prescriptions.patient_id = patients.subject_id WHERE patients.gender = 'm' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.age >= T2.age"
aeb5de2344d963029c6e21b2,What is hydrochlorothiazide? what is its effect?,,SELECT effect FROM drugs WHERE drug = 'hydrochlorothiazide'
084fad161486e9cb715a0230,What are the record companies that muslim patients are affiliated with?,,SELECT DISTINCT T1.company FROM record_company AS T1 JOIN patient AS T2 ON T1.company_id = T2.insurance_company_id WHERE T2.religion = 'muslim'
855fec3a4dfb439928afa3ea,What are the top five requesters of hematology tests this year?,,1. What are the top five most common specimens for hematology tests?
b7deeb354c331dcc04a4b6c5,Tell me the address of patient 86791 and why?,,"SELECT address_city, address_state, address_country FROM patients WHERE patient_id = 86791"
0acbb8c1d8eddbb25083c49a,What are the dates of leaving the university for the patients who went into the hospital more than once this year?,,1. get a list of patients who were admitted to the hospital more than once in this year
63038cdb342e49648810baf9,List all the invoice numbers of the patients deceased last month.,,SELECT T1.invoice_number FROM patients AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id WHERE T1.expiration_date = ( SELECT MAX(expiration_date) FROM patients ) - 1 AND T2.drug_type = 'medical'
1ae3fb2889c1b1e5dd75eb80,What did he ask michael to do?,,SELECT DISTINCT michael_tasks.task_name FROM michael_tasks WHERE michael_tasks.assistant_name = 'michael' AND michael_tasks.task_name = 'ask michael to do'
19bcedd102d2f4e60b3948f6,Who are the top five requesters of lab tests?,,1. What are the top five most common specimens for patients who received a laboratory test since 2100?
9e6e0d6ac2a6f5bf754653c7,What medication is prescribed for the patients diagnosed with atrial fibrillation?,,"SELECT T1.drug FROM ( SELECT patient_id, diagnosis_id FROM diagnoses WHERE diagnosis_name = 'atrial fibrillation' ) AS T1 JOIN prescriptions AS T2 ON T1.patient_id = T2.patient_id AND T1.diagnosis_id = T2.diagnosis_id"
4d49829249a5b147348db1dd,Count the number of procedures that resulted in a 'successful' outcome this year.,,"SELECT COUNT(*) FROM procedures WHERE procedures.outcome = 'successful' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year')"
f651029a2b6efc526940f746,What other polls has he been part of?,,"SELECT T1.Cui FROM ( SELECT Cui, Name FROM procedures WHERE parent_id = 10037410 ) AS T1 JOIN ( SELECT Cui, Name FROM procedures WHERE parent_id = 10037410 AND status = 'completed' ) AS T2 ON T1.Cui = T2.Cui"
445d2ee4fe0aa4c4b936452e,Which type of care unit has the patient with the highest page count?,,"SELECT care_unit_type FROM ( SELECT care_unit, care_unit_type FROM ( SELECT current_patient, care_unit, care_unit_type FROM ( SELECT patient_id, care_unit_type FROM ( SELECT patient_id, care_unit FROM ( SELECT patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ( patient_id, ( SELECT ("
e4739af1bea47bc15c31b32f,List all the intimes of the icu with page counts lower than 20.,,SELECT icu.intime FROM icu WHERE icu.pagecount < 20
480c96ab33f733cbd12262fc,What are the 10 most common side effects of clarithromycin??,,10 common side effects of clarithromycin??
6fd26774e0c807375b7c1739,Why did nicholas sparks divorce his wife,,SELECT divorce_reason FROM patients WHERE patient_name = 'nicholas sparks'
5969ab3416ff62f387b82377,What is a band saw used for,,SELECT DISTINCT T1.name FROM procedures AS T1 JOIN instruments AS T2 ON T1.instrument = T2.code WHERE T2.type = 'band saw'
c92492feda1eb0a1ebcc05f2,List all icu stays during which input medication was administered by hwid1007 at least once.,,SELECT COUNT( DISTINCT icustay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.staff_id = 1007 ) AND icustays.outtime IS NOT NULL
9bcad6eaf94f60b03a7e3d5c,What is team bella all about ?,,SELECT * FROM patients WHERE patients.gender = 'f' AND patients.age < 25
76b834589d3ed7bfa7941cb6,What were some notable times of their early years?,,1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e934023e9a0c16821526e87b,What religion has the highest number of standing tackles made by its believers?,,"SELECT T1.religious_group, T1.count FROM ( SELECT 'islam' AS religious_group, COUNT(*) AS count FROM patients WHERE patients.gender = 'male' AND patients.age BETWEEN 18 AND 30 ) AS T1 JOIN ( SELECT religious_group FROM religious_groups WHERE lower(religious_group) = 'islam' ) AS T2 ON T1.religious_group = T2.religious_group ORDER BY T1.count DESC LIMIT 1"
4d46191e82d4f85bb2fa256b,How many patients admitted to the icu this year have passwords longer than 8 characters?,,"SELECT COUNT( DISTINCT icustay_id ) FROM icustays WHERE icustay_id IN ( SELECT icustay_id FROM procedures WHERE procedures.result = 'password given' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AND strftime('%Y-%m-%d',icustays.intime) = strftime('%Y-%m-%d',current_time)"
4a3ee987d5eed4cb8fc7cbfd,How many different healthcare workers administered input medication to patient 10001?,,SELECT COUNT( DISTINCT staff_id ) FROM input_events WHERE patient_id = 10001
8541dd3e79a2524eef7946e9,Call a medical laboratory to expedite test results.,,100 common of the top three most frequent specimens were tested.
3d269b39239d5b96ed89fd1a,What is the most common location among hospitals?,,SELECT location FROM hospitals GROUP BY location ORDER BY COUNT(*) DESC LIMIT 1
dde7888943c5ce032cffd4e6,How long does it take to get a refund back on your debit card from express returns,,100% refund
d0d2cc96940ac2b577ba70ca,Where did she never go?,,1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2574356f8e9c787e824fdb9b,Skullcandy bluetooth headphones,,"100% of patients who were diagnosed with chronic kidney disease, unspecified in 2100 were in their 60s."
698048f875f64bb38d8c5ef7,What was his first attempt?,,1. What was the first time patient 10004720 was prescribed a medication via the po/ng route?
569f949477cd2fda2d4ea751,What is the difference in the average number of hospital visits per year for patients based on whether their first child is male or female?,,SELECT AVG(T1.C1) FROM ( SELECT COUNT(DISTINCT diagnosis_id) AS C1 FROM patients WHERE patients.gender = 'female' GROUP BY patients.age ) AS T1 JOIN ( SELECT patients.age FROM patients WHERE patients.gender = 'male' AND patients.age < 100 ) AS T2 ON T1.age = T2.age
30d461a261559030034e3257,What are the record companies of the deceased patients?,,SELECT DISTINCT T1.record_company FROM patients AS T1 JOIN demographics AS T2 ON T1.demographic_id = T2.demographic_id WHERE T2.expiration_time = 'expired'
7c4dc59f08a2b6a96b7a1256,Are you able to find a procedure appointment for patient 63849 for today?,,"SELECT COUNT(*)>0 FROM appointments WHERE appointments.patient_id = 63849 AND datetime(appointments.start_time,'start of day') = datetime(current_time,'start of day','-0 day')"
f50b75b54af03eb23b73abc1,What key is alto sax in,,"SELECT T1.key FROM ( SELECT 'alto sax' AS key, 'diagnosis' AS key_type, 'alcohol abuse' AS value_type, 'alcohol abuse' AS value, '10/2100' AS age, 'male' AS gender, 'unspecified' AS ethnicity, 'unspecified' AS marital_status, 'unspecified' AS employment_status, 'unspecified' AS reside_in_hospital, 'unspecified' AS insurance, 'unspecified' AS avaiability_of_pharmacy, 'unspecified' AS count_of_pharmacy_visits, 'unspecified' AS last_pharmacy_visit_time, 'unspecified' AS last_stay_in_hospital, 'unspecified' AS last_stay_in_hospital_days, 'unspecified' AS last_stay_in_hospital_cost ) AS T1 JOIN ( SELECT T1.key, T2.value FROM ( SELECT 'alto sax' AS key, 'diagn"
b205cf40fe142d699a05c9ab,Tell me the address of patient 2536 and why?,,"SELECT address_city, address_state, address_country FROM patients WHERE patient_id = 2536"
17928f8215ac5734b7521160,Count the number of primary physicians who have admitted their patients to the hospital more than three times in the past year.,,"SELECT COUNT(DISTINCT t1.im_id) FROM ( SELECT admissions.im_id, COUNT(*) as num_visits FROM admissions WHERE admissions.admission_type = 'primary physician' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year') GROUP BY admissions.im_id ) as t1 WHERE t1.num_visits > 3"
20bc21d443c654119da97d29,What are the names of the advisors of the patients classified as emergency at admission this year?,,"SELECT T2.Name FROM ( SELECT T1.subject_id, T1.admission_time FROM ( SELECT subject_id, admission_time FROM patients WHERE admission_type = 'emergency' ) AS T1 GROUP BY subject_id HAVING MIN(admission_time) = T1.admission_time AND datetime(T1.admission_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 JOIN patients ON T2.subject_id = patients.subject_id"
0ddd6dc18709a713a76158e8,Where can i find the phone number of patient 73913's guardian?,,SELECT guardian_phone FROM patients WHERE patient_id = 73913
da76927d0eff934f23b6003e,Can you tell me what the drug can be prescribed for patients with esoph varice oth dis nos?,,SELECT T1.drug FROM ( SELECT diagnoses.drug FROM diagnoses WHERE diagnoses.diagnosis = 'esoph varice oth dis nos' ) AS T1 JOIN ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.principal_drug = 'dilacarb' ) AS T2 ON T1.drug = T2.drug
a5cc39d6ea1c9729e9cb051e,Identify 10 crucial factors influencing lab tests.,,1. what are the top three most frequent lab tests that patients had after being diagnosed with other and unspecified hypercholesterolemia?
73529036e49e5922c0bc40a0,Was patient 5364 signed a blood transfusion consent form?,,0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7e2dcdd483a3830f19e16b07,Navigate to the pediatric wing from the main parking area.,,1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
86839ccf835440d41b40bfa2,Which doctor did patient 71558 see when heshe last visited the rheumatology department?,,SELECT T3.name FROM patients AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id JOIN doctors AS T3 ON T2.medical_provider_id = T3.employee_id WHERE T1.subject_id = 71558 AND T3.department = 'rheumatology'
3b19e4a9f4401f94414ae3a6,When does patient 370 end his/her flu quarantine.,,"SELECT gt.starttime FROM ( SELECT st.starttime, st.stime FROM ( SELECT st.starttime, st.stime FROM diagnoses st WHERE st.diagnosis = 'flu' AND st.hadm_id IN ( SELECT adm.hadm_id FROM adm WHERE adm.subject = 370 ) ) as t1 GROUP BY st.starttime HAVING MIN(st.stime) = st.stime ) as t2 JOIN ( SELECT adm.hadm_id, adm.stay_id, adm.stime FROM adm WHERE adm.subject = 370 AND adm.dischtime IS NOT NULL ) as t3 ON t2.hadm_id = t3.hadm_id AND t2.starttime = t3.stime"
659187a74e57637b35daa280,Look up the latest technology used in curing atrial fibrillation.,,"SELECT T1.tech_name FROM ( SELECT procedures.tech_name, procedures.start_time FROM procedures WHERE procedures.diagnosis = 'atrial fibrillation' ) AS T1 JOIN ( SELECT procedures.tech_name, procedures.start_time FROM procedures WHERE procedures.diagnosis = 'atrial fibrillation' AND procedures.status = 'in use' ) AS T2 ON T1.tech_name = T2.tech_name WHERE T1.start_time < T2.start_time ORDER BY T1.start_time DESC LIMIT 1"
5884aff3bbac9bfd0ff165a9,What is haloperidol? what is its effect?,,SELECT effects FROM drugs WHERE drugs.drug_name = 'haloperidol'
4b6353ec5a31b5c1bf637734,Which ethnicity has the highest average page count?,,"SELECT ethnicity, AVG(page_count) FROM medications GROUP BY ethnicity ORDER BY AVG(page_count) DESC LIMIT 1"
f7908eda301fbcbf66fd2c26,Which are the top 10 side effects reported for drug thiamine hcl?,,10 side effects were found for thiamine hcl.
9894aa0117f387ccc3c0a4ce,What was the latest arrival time for patients yesterday?,,SELECT MAX(transfer_time) FROM transfers WHERE transfer_time >= ( SELECT MAX(transfer_time) FROM transfers WHERE transfer_time >= current_time - INTERVAL '1 year' )
767d0e3e0e6a4254a995ac8e,What is the age of the patient who has succeeded in the most standing tackles?,,"10000343 is the patient id.
        SELECT age FROM patients WHERE patient_id = 10000343"
2911905f7b71dc9ee7583199,List the requesters who have ordered more than 100 hemoglobin tests.,,"SELECT T1.CustKey FROM ( SELECT T1.CustKey, COUNT(T1.charttime) as num_tests FROM labevents T1 JOIN prescriptions T2 ON T1.presc_id = T2.presc_id WHERE T2.drug = 'hemoglobin' GROUP BY T1.CustKey ) AS T1 WHERE T1.num_tests > 100"
03c8bb9cb2716f43621cb14b,Whose phone number is the phone number of patient 40707's guardian?,,SELECT guardian.phone FROM patients WHERE patients.subject_id = 40707
15266b6704cdb1f8cd452e63,How do care unit choices in icus affect patient outcomes?,,1. what are the four most common care unit choices for patients who were diagnosed with other and unspecified hypercholesterolemia in the same hospital visit?
4e38bd109d02c58e7d3b58fe,Call a medical supply company to order more icu equipment.,,1. order a reagent (blood)
95ed91ecefd97f4f68d59794,What is the marital status that has the most patients over 30 years of age affiliated with warner brothers records?,,SELECT marital_status FROM patients WHERE age > 30 AND affiliation = 'warner brothers records' GROUP BY marital_status ORDER BY COUNT( DISTINCT patient_id ) DESC LIMIT 1
9b3b15e5a997276568cf4fde,Percent of population considered pre diabetes,,100.0 * ( SELECT COUNT( DISTINCT patient_id ) FROM diagnoses WHERE diagnosis = 'pre diabetes' ) / ( SELECT COUNT( DISTINCT patient_id ) FROM patients )
5c639b834d848ab32371b285,Create a budget plan for the upcoming fiscal year.,,1. get the total amount of inputs for patient 10004720 in the current hospital visit
be77b0162456496c3c5866e3,List the medication administrations by hwid1020 to patients.,,SELECT prescriptions.drug FROM assistants JOIN patients ON assistants.patient_id = patients.subject_id JOIN prescriptions ON assistants.prescription_id = prescriptions.prescription_id WHERE assistants.assistant_name = 'hwid1020'
7e1a9a31db03ad3e9603cf9c,When is the issue coming out?,,SELECT issue_date FROM mrs WHERE mrs.hadm_id IN ( SELECT hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND mrs.dischtime IS NULL
cc01a7a7a65eb126616c7e07,Did he find a person?,,00000-0000-0000-0000-0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
f8c251c96bb987c5ed2076c2,"Are there identical passwords for more than two distinct patients who are older than 60? if so, list them.",,1. SELECT DISTINCT T1.name FROM patients AS T1 JOIN ( SELECT T1.subject_id FROM patients AS T1 JOIN ( SELECT subject_id FROM patients WHERE age > 60 ) AS T2 ON T1.subject_id = T2.subject_id ) AS T3 ON T1.subject_id = T3.subject_id WHERE T1.password = T2.password AND T2.subject_id <> T3.subject_id
a5ec1f13b1b903153ec55164,Whats the efficacy of metoprolol?,,SELECT COUNT(*) FROM medications WHERE name = 'metoprolol'
7da5115d6880b93afe291cab,What's the end date of patient 7112's influenza quarantine?,,"SELECT strftime('%Y-%m-%d', patients.influenza_quarantine_end_date) as end_date
         FROM patients
         WHERE patients.subject_id = 7112
         AND patients.influenza_quarantine_end_date IS NOT NULL"
c141ebc01bb9dd637c004efe,Which religion has the patient who graduated from college most recently?,,"SELECT T1.religion FROM patients AS T1 JOIN ( SELECT T2.subject, T1.start_time FROM diagnoses AS T1 JOIN ( SELECT subject, MIN(start_time) FROM diagnoses GROUP BY subject ) AS T2 ON T1.subject = T2.subject ) AS T3 ON T1.subject = T3.subject AND T1.start_time = T3.start_time"
89e4e46ddc56c90d38aec205,Find the shortest path to the pharmacy from the surgery wing.,,1. Get the single rooms on the surgery ward
43851d9f14a559ea4100f7a1,Tell me all the tests taken in the other department by patient 7698.,,"SELECT T1.test_name FROM ( SELECT T1.test_name, T2.diagnosis FROM ( SELECT * FROM patients WHERE patients.subject_id = 7698 ) AS T1 JOIN diagnoses AS T2 ON T1.diagnosis_id = T2.diagnosis_id ) AS T3 WHERE T3.diagnosis = 'other department'"
9284800fd8ed3ff60873bd1c,When was the time that a patient with the highest cost billed this year?,,"SELECT T1.charttime FROM ( SELECT patient.age, cost.cost FROM cost JOIN patient ON cost.patient_id = patient.patient_id WHERE cost.cost_type_id = 10000000 AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient.age, cost.cost FROM cost JOIN patient ON cost.patient_id = patient.patient_id WHERE cost.cost_type_id = 10000000 AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.age = T2.age ORDER BY T1.cost DESC LIMIT 1"
dca4c06d509b190b42c230ca,What is the phone number of patient 74523's guardian?,,SELECT guardian_phone FROM patients WHERE patient_id = 74523
84d4721f5e61842aa596dca2,"What is the relationship between temperature, pressure and volume of gas",,SELECT * FROM procedures WHERE temperature > 0.0 AND pressure > 0.0 AND volume_of_gas > 0.0
416572d9becf92768f378d48,"I mean, what kinds of side effects does ns have?",,1: What are the top three most common side effects that patients had after being diagnosed with other specified hypotension? 2: What are the top three most common procedures that patients had after being diagnosed with other specified hypotension?
d51e3c859e3835b1c8fa2846,What is the average age of the patients with minimum humidity over 30 percent?,,"SELECT AVG(T1.age) FROM patients AS T1 JOIN ( SELECT T1.subject_id, MIN(T2.percent) as min_percent FROM patients AS T1 JOIN ( SELECT subject_id, percent, rdw, d_icd_procedures.icd_11_code, d_icd_diagnoses.icd_11_code FROM diagnoses JOIN d_icd_diagnoses ON diagnoses.icd_11_code = d_icd_diagnoses.icd_11_code ) AS T2 ON T1.subject_id = T2.subject_id GROUP BY T1.subject_id ) AS T3 ON T1.subject_id = T3.subject_id WHERE T3.min_percent > 30"
824c344d379a08ba9b032a17,What is the average salary of the patients who believe in christianity?,,SELECT AVG(T1.salary) FROM employees AS T1 JOIN patients AS T2 ON T1.employee_id = T2.last_assistant_name WHERE T2.religion = 'christian'
9c2869cef2f1d574d7a0b07e,"Show the patient ids, arrival times, and insurance types of patients admitted for cancer this year.",,"SELECT T1.subject_id, T1.arrival_time, T2.insurance_type FROM ( SELECT * FROM diagnoses WHERE diagnosis_type = 'cancer' AND datetime(diagnoses.diagnosis_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN patients AS T2 ON T1.subject_id = T2.subject_id"
ac454c98485a6e9c43e54799,Tell me of the tests patient 57050 has taken in the other department.,,1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e55a7710442cf455cfc4ec5f,Dangling participle definition and examples,,"1. What are the top three most frequent procedures that patients were diagnosed with in the same month after receiving extirpation of matter from left lower lobe bronchus, via natural or artificial opening endoscopic, diagnostic?"
361609da111503a7dbd0b217,What is the average billing amount for patients with heart disease this month?,,"SELECT AVG(T1.total_cost) FROM ( SELECT SUM(T1.med_cost) AS total_cost FROM ( SELECT T1.med_cost, T2.row_id FROM ( SELECT row_id, med_cost FROM diagnosis_table WHERE diagnosis = 'heart disease' ) AS T1 JOIN cost_table ON T1.diagnosis_id = cost_table.diagnosis_id ) AS T2 ON T1.row_id = T2.row_id WHERE T1.month = cost_table.cost_month AND datetime(cost_table.cost_time,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1"
16f036a5f4e066bfd2d904c1,Retrieve images of different care units.,,SELECT * FROM care_unit_images
1318592db6b84edfe46b7da7,Did patient 51858 fill out the consent form for ct scan?,,SELECT COUNT(*)>0 FROM forms WHERE forms.patient_id = 51858 AND forms.form_name = 'ct scan'
3dc0f83add6ccd420290c66a,Give me a list of microbiology events where the specimen quality was poor.,,SELECT * FROM microbiology_events WHERE specimen_quality = 'poor'
ca6452d0fcc4925d5cc3bef0,When does patient 65582 come into the exc/dest intvrt disc nos process?,,SELECT exc_date FROM procedures WHERE proc_id = ( SELECT proc_id FROM procedures WHERE patient_id = 65582 AND proc_name = 'exc/dest intvrt disc nos' )
ca3ac69651c08b642eb672db,What are the sedative drugs being administered to patient 4401?,,SELECT prescription.drug FROM prescription WHERE prescription.patient_id = 4401 AND prescription.drug_type_id = 3
7cbe8a357afbeaf1db568acc,Do you mean that patient 29741 filled out the consent form for a ct scan?,,SELECT COUNT(*)>0 FROM forms WHERE forms.form_type = 'ct scan' AND forms.patient_id = 29741
cec8a6ee63266a7f01f80da2,What are the most frequently prescribed drug colors for patients over 60?,,"SELECT T1.drug_name FROM ( SELECT prescriptions.drug_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.age >= 60 GROUP BY prescriptions.drug_name ) AS T1 WHERE T1.C1 <= 1"
516980a5554f33c21ca183b5,Where is the hospital located with admission id 145787?,,SELECT hospital_location FROM patients WHERE admission_id = 145787
d2916654a250739fbae2b772,Who patient 31510 saw when they last went to ophthalmology?,,SELECT T1.name FROM patients AS T1 JOIN departments AS T2 ON T1.department = T2.department_id WHERE T1.subject_id = 31510 AND T2.name = 'ophthalmology'
4b91a35cb013448ab5730193,Was the average time of delay of appointments in the rheumatology department is,,SELECT AVG(T1.C1) FROM ( SELECT JULIANDAY(APPOINTMENT_TIME) - JULIANDAY(CONSULTATION_TIME) AS C1 FROM appointments JOIN consultations ON appointments.CONSULTATION_ID = consultations.CONSULTATION_ID WHERE consultations.DEPARTMENT = 'rheumatology' ) AS T1
839008d6dd9a3f492473ed16,What is the average date of death among patients who were deceased and were affiliated with sony records?,,SELECT AVG(T1.C1) FROM ( SELECT patient.age FROM patient WHERE patient.affiliation = 'sony records' AND patient.dischtime IS NOT NULL ) AS T1
31fe116b7574718511ae013c,List all the advisors of the patients who were younger than 21.,,SELECT advisor FROM patients WHERE age < 21
954af13d6dc7c6c533e2e63f,What are the total costs incurred on a specific billing date?,,SELECT SUM(T1.total_cost) FROM ( SELECT total_cost FROM (|im_start|) AS T1 JOIN (|im_start|) AS T2 ON T1.event_id = T2.event_id WHERE T2.billing_date = '2100-01-01' ) AS T3</s>
31679dede264cc93766ffc0a,Which primary physician has the patient with the highest hospital admission cost?,,SELECT T1.name FROM physician AS T1 JOIN patient AS T2 ON T1.employee_id = T2.primary_physician_employee_id ORDER BY T2.hospital_admission_cost DESC LIMIT 1
4e3f38b5acb14b84c19b0fa5,What did they say to him,,"SELECT T1.drug FROM ( SELECT T1.drug, T2.CUI FROM ( SELECT T1.drug FROM ( SELECT diagnosis_of_last_month FROM patients WHERE patients.subject_id = 10007928 ) AS T1 JOIN ( SELECT CUI, score FROM ( SELECT * FROM information_schema.tables ) AS T2 JOIN ( SELECT diagnosis_of_last_month, score FROM ( SELECT patients.subject_id, diagnosis_of_last_month FROM patients WHERE patients.subject_id = 10007928 ) AS T3 JOIN ( SELECT features, score FROM ( SELECT * FROM information_schema.tables ) AS T4 JOIN ( SELECT diagnosis_of_last_month, features FROM ( SELECT patients.subject_id, diagnosis_of_last_month, features FROM patients WHERE patients.subject_id = 10007928 ) ) AS T5 ON T5.diagnosis_of_last_month = T4.diagnosis_of_last_month AND T5.features = T4.features ) AS T6 WHERE T6.score"
5abc9d918535d3307f61919d,Inform me of the tests that patient 95892 took in a different department.,,1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
697c4b98eea851000804f9fe,What is the predominant insurance type among patients who married after age 40?,,"SELECT T1.insurance_type FROM ( SELECT insurance_type, COUNT(*) as num_patients FROM patients WHERE age > 40 GROUP BY insurance_type ) as T1 JOIN ( SELECT insurance_type, COUNT(*) as num_patients FROM patients WHERE marital_status = 'married' GROUP BY insurance_type ) as T2 ON T1.insurance_type = T2.insurance_type ORDER BY T1.num_patients DESC LIMIT 1"
6cbfdc3d86436bf51ac20d19,Do you love being a research coordinator nurse?,,SELECT COUNT(*) FROM users WHERE users.role_code = 'research coordinator nurse'
9728497b208efb3fa27e2aea,How are certain word phrased?,,SELECT DISTINCT phrases.phrase_nat FROM phrases WHERE phrases.phrase_eng LIKE '%cystic%'
dca9a1a1b06f57335405eccb,Can you please tell me the address of patient 6580?,,SELECT address FROM patients WHERE id = 6580
8d71f96fc3062598c863167a,Which primary physician has the highest patient mortality rate?,,SELECT T1.name FROM physician AS T1 JOIN patient AS T2 ON T1.id = T2.primary_physician GROUP BY T1.id ORDER BY T2.mortality_rate DESC LIMIT 1
1a1a4662e9121b2ec51b7bf2,What is the number of patient 29971's guardian's phone?,,"SELECT COUNT(T1.CustKey) FROM ( SELECT T1.CustKey FROM ( SELECT custkey,name FROM customers WHERE name = 'Jane Doe' ) AS T1 JOIN patients AS T2 ON T1.CustKey = T2.CustKey WHERE T2.Age < 25 ) AS T3"
5625e6388567182df2aab97b,What is the average period of delay between appointments in the nephrology department?,,"SELECT AVG(JULIANDAY(appointment_time) - JULIANDAY(last_visit_time)) FROM ( SELECT patient_id, last_visit_time, appointment_time FROM appointments WHERE department = 'nephrology' ) subquery"
28c81639ebcda9f332d3fc94,What is the maximum number of standing tackles made by the patients older than 45 and married?,,SELECT MAX(Tackles.stand_tackles) FROM Tackles WHERE Tackles.tackle_type = 'standing' AND Tackles.age >= 45 AND Tackles.marital_status = 'married'
bfb0403b51d7349e984fe8df,What is the distribution of procedure outcomes by patient ethnicity?,,"SELECT T1.ethnicity, T1.C1 FROM ( SELECT T2.ethnicity, COUNT(T2.ethnicity) AS C1 FROM ( SELECT T1.subject_id, T2.ethnicity FROM ( SELECT T1.subject_id, T2.ethnicity_code FROM procedures AS T1 JOIN patients AS T2 ON T1.subject_id = T2.subject_id ) AS T2 GROUP BY T2.ethnicity_code ) AS T1 JOIN patients AS T2 ON T1.subject_id = T2.subject_id"
20991d9d916622645fd27567,What are the dates of graduating from college among the widowed patients who got admitted to the hospital last month?,,"SELECT admissions.admittime FROM admissions WHERE admissions.maritalstatus = 'WIDOWED' AND datetime(admissions.admittime,'start of month') = datetime(current_time,'start of month','-1 month')"
eccbd9f6d3d0961bf3e2a8be,Develop a meal planning system for patients with dietary restrictions.,,"SELECT T1.food_name FROM ( SELECT food_name, rc_seq FROM prescriptions WHERE prescriptions.drug_name = 'dietary restrictions' ) AS T1 JOIN ( SELECT prescriptions.rc_seq, meals.meal_time FROM meals JOIN prescriptions ON meals.prescription_id = prescriptions.prescription_id ) AS T2 ON T1.rc_seq = T2.rc_seq"
5b7e7cea6c14a66683614904,Which icu had the highest average acuity score last month?,,"SELECT ICU, AVG(acuity_score) FROM ( SELECT ICU, acuity_score FROM icu_assignment WHERE last_month_visit = 1 ) GROUP BY ICU ORDER BY AVG(acuity_score) DESC LIMIT 1"
69efee73f187a30d6812ae88,Find any images used for educating patients about their condition or treatment.,,SELECT * FROM images WHERE image_type = 'education'
94a005f173b3e30833a6eab8,Which antihistamine is prescribed the most?,,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.drug IN ( 'acetaminophen', 'benadryl', 'dextromethorphan', 'acetaminophen-acetaminophen', 'acetaminophen-caffeine', 'caffeine-acetaminophen' ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 1"
f79fa4afc09f637db912a795,What is the average number of standing tackles made by the patients whose last care unit was sicu?,,"SELECT AVG(T1.standing_tackles) FROM ( SELECT COUNT( DISTINCT diagnosis_id ) as standing_tackles FROM ( SELECT patients.subject_id, diagnoses.chart_time FROM diagnoses JOIN patients ON diagnoses.patient_id = patients.subject_id WHERE diagnoses.care_unit = 'sicu' ) AS T1 JOIN ( SELECT patients.subject_id, procedures.chart_time FROM procedures JOIN patients ON procedures.patient_id = patients.subject_id WHERE procedures.care_unit = 'sicu' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time ) AS T3"
fd92836f6e1a812c7e1d314f,What is the average number of patients assigned to each healthcare worker who administers input medication?,,"SELECT T1.name, AVG(T1.C1) FROM ( SELECT T1.name, COUNT(*) AS C1 FROM medical_assistant AS T1 JOIN patient AS T2 ON T1.patient_id = T2.subject_id WHERE T1.assignment_type = 'input' GROUP BY T1.name ) AS T1 GROUP BY T1.name"
e7029de5a892c70bd5f004f0,What are the top three most common procedures performed on patients with an address in san francisco?,,SELECT T1.long_title FROM procedures AS T1 JOIN patients AS T2 ON T1.patient_id = T2.address_id WHERE T2.address_details LIKE '%san francisco%' GROUP BY T1.short_title ORDER BY COUNT(*) DESC LIMIT 3
8958f3216720fc04419d0f11,What month of the year does antihistamines the most prescribe?,,"SELECT T1.month, T1.C1 FROM ( SELECT strftime('%Y-%m', prescriptions.start_time) AS month, COUNT(*) AS C1 FROM prescriptions WHERE prescriptions.drug = 'antihistamines' GROUP BY strftime('%Y-%m', prescriptions.start_time) ) AS T1 ORDER BY T1.C1 DESC LIMIT 1"
4bf932258480b1c7ad5f00ae,What is the most popular record company among married patients?,,"SELECT T1.company FROM ( SELECT T1.company, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T2.company FROM patients AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id WHERE T1.marital_status = 'married' ) AS T1 GROUP BY T1.company ) AS T2 WHERE T2.C1 <= 1"
c9a38b2012537ccc81186e55,Whats the efficacy of nicardipine hcl iv?,,SELECT DISTINCT icd11_duration FROM procedures WHERE procedure_name = 'nicardipine hcl iv'
917badf660136cdbde3c0e4d,What is the average salary for the patients who were admitted to the micu as their last care unit?,,SELECT AVG(T1.salary) FROM salaries AS T1 JOIN departments AS T2 ON T1.department = T2.department_id WHERE T2.care_unit = 'micu'
0064f154fd57bb4cbaa0b873,When does patient 77676 enter into the injection oxazolidinone procedure?,,SELECT procedure_start_time FROM procedures WHERE procedures.patient_id = 77676 AND procedures.procedure_name = 'injection oxazolidinone'
0ac5a4c0eec1c408823ecaca,List the most frequent diagnoses for elderly patients with a female next of kin.,,"SELECT T1.diagnosis FROM ( SELECT diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM ( SELECT patient_id FROM individuals WHERE age >= 50 AND gender = 'female' ) AS T1 JOIN ( SELECT patient_id, next_of_kin FROM individuals WHERE gender = 'male' ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY diagnosis ) AS T3 WHERE T3.C1 <= 3"
16ed22149970531de6f9f3cb,Did patient 369 do a consent to a ct scan?,,SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 369 AND procedures.procedure = 'ct scan'
24f78921cd386503847e3682,What is hardware registration,,SELECT * FROM procedures WHERE procedure_name = 'hardware registration'
506dabdb3420e5ea3eed4cef,What is the average difference in admission duration between patients whose procedure outcomes were all 'successful' and those whose outcomes were not?,,"SELECT AVG(T1.C1) FROM ( SELECT patient.age, procedure.start_time, patient.gender, diagnosis_of_last_attack.diagnosis_time, procedure.end_time, procedure.cost FROM procedure JOIN patient ON procedure.patient_id = patient.patient_id LEFT JOIN diagnosis_of_last_attack ON diagnosis_of_last_attack.patient_id = patient.patient_id WHERE procedure.outcome = 'successful' ) AS T1"
218dc5042482781a3da67df4,What is the telephone number of patient 59941's guardian?,,SELECT guardian_telephone FROM patients WHERE patient_id = 59941
626d9e416ae29a7eb7049e42,What is the average age of patients admitted this year with non-resident status?,,"SELECT AVG(T1.age) FROM patients AS T1 JOIN admissions AS T2 ON T1.subject_id = T2.subject_id WHERE T2.admission_status = 'non-resident' AND datetime(T2.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"
a70b6040eeb73367fcf00abb,What eye drops are available that can be prescribed for patients with dry eyes?,,SELECT DISTINCT prescription_name FROM prescriptions WHERE prescription_type = 'eye drops' AND description LIKE '%dry eyes%'
436e18d4a82406b93d91929f,What medication should be prescribed to patients with glaucoma nos?,,"SELECT T1.drug FROM ( SELECT procedures.patient_id, diagnoses.diagnosis_id FROM diagnoses JOIN procedures ON diagnoses.object_id = procedures.object_id WHERE diagnoses.diagnosis_name = 'glaucoma nos' ) AS T1 JOIN patients ON T1.patient_id = patients.subject_id"
385e641ba9f6d4f87be32048,What is the average age at the time of death for temporary resident patients?,,SELECT AVG( T1.age ) FROM patients AS T1 JOIN ( SELECT patient_id FROM diagnoses WHERE diagnosis_name = 'temporary resident' ) AS T2 ON T1.patient_id = T2.patient_id
99811c06ada374d0f8b22e70,Read out the short title of icd9 code 01166.,,SELECT icd_short_title FROM icd_codes WHERE icd_code = 01166
40fd1207a10c4190e566b432,I need to know the phone number of patient 14749's guardian.,,SELECT guardian_phone FROM patients WHERE patient_id = 14749
1f5292b27876676ec03ee3a9,What is the location of the hospital that admitted the most patients with diabetes?,,SELECT T1.location FROM hospital AS T1 JOIN patients AS T2 ON T1.database_id = T2.database_id WHERE T2.diagnosis_status = 'diabetes' GROUP BY T1.location ORDER BY COUNT(*) DESC LIMIT 1
b8e7e0eaf1d059c2fc7ab7fe,Which doctor were patient 65309s seen when they last visited the cardiology department?,,SELECT T3.name FROM patients AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id JOIN doctors AS T3 ON T2.doctor_id = T3.doctor_id WHERE T1.subject_id = 65309s AND T3.department = 'cardiology' ORDER BY T1.last_visit DESC LIMIT 1
ff31bc2d2babbce54ba584e9,How many male patients have a female next of kin?,,03/2100: 02999
919d12332cf6d5e5cb0c8253,How many patients from the icu in 2100 have page counts higher than 10?,,"SELECT COUNT( DISTINCT icustay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.admittime IS NOT NULL AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-2 year') ) AND icustays.outtime IS NOT NULL AND icustays.in_icu_diagnosis = 'page counts higher than 10'"
d7bfaa791dff50ff50ea52c1,Apply a non-linear regression model to predict the progression of patient health status using 'chartevents'.,,"SELECT * FROM (
         SELECT patient.age, patient.weight, patient.expire_time, patient.dischtime, patient.admit_time, patient.transfertime, patient.diagnose_time, patient.prescriptions_time, patient.labevents_time, patient.inputevents_time, patient.outputevents_time, patient.internalevents_time
         FROM patient
         WHERE patient.dischtime IS NOT NULL
         )
         WHERE patient.age >= 25
         AND patient.age <= 35
         AND patient.weight >= 68
         AND patient.weight <= 100
         AND patient.expire_time >= '2100-01-01 00:00:00'
         AND patient.expire_time <= '2100-12-31 00:00:00'
         AND patient.dischtime >= '2100-01-01 00:00:00'
         AND patient.dischtime <= '2100-12-3"
4604eb882c0a085315bff78d,What is the average number of standing tackles made by patients younger than 40?,,SELECT AVG(T1.standing_tackles) FROM ( SELECT COUNT(*) AS standing_tackles FROM patients WHERE patients.age < 40 GROUP BY patients.subject_id ) AS T1
2a9d088ed54aa381d9b85246,What is capital amount compared to?,,"SELECT T1.code FROM ( SELECT 'capital amount compared to' as code, 'capital amount compared to' as title, 'capital amount compared to' as desc, '1000000000' as code2, '1000000000' as title2, '1000000000' as desc2 ) as T1 JOIN ( SELECT T1.code, T1.title, T1.desc, T2.code2, T2.title2, T2.desc2 FROM ( SELECT 'capital amount compared to' as code, 'capital amount compared to' as title, 'capital amount compared to' as desc, '1000000000' as code2, '1000000000' as title2, '1000000000' as desc2 ) as T1 JOIN ( SELECT 'capital amount compared to' as code2, '1000000000' as title2, '1000000000' as desc2 ) as T"
c9705fb85231f3066df593cb,When does patient 80858 stop being quarantined from the influenza flu?,,SELECT quarantine_end_date FROM patients WHERE patient_id = 80858 AND quarantine_type = 'influenza flu'
f968df813578fd0c367317f1,What are the drug distribution routes used in the hospital?,,SELECT DISTINCT prescriber_info.route FROM ( SELECT prescriber_info.info FROM prescriber_info WHERE prescriber_info.assistant_name = 'assistant specialized in medical database queries' ) AS subquery
f73b2ce37c28f47894ee6bfe,What relationship are jessie and janet?,,0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6b781aa16f1cdc56b618c7cd,Call a research institute for information on a rare diagnosis.,,1000 genetic tests were conducted on patients with other specified sites of injection within the same hospital visit after the diagnosis of other specified sites of injection in 2100.
706443292e92adc73d32d8f4,What is the gender of the first child of subject 3097?,,SELECT children[0].gender FROM patients WHERE patients.subject_id = 3097
a1b471160a18a756c9b258f3,Which antihistamine is the most,,"SELECT T1.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, prescriptions.start_time FROM prescriptions JOIN patient ON prescriptions.patient_id = patient.subject_id WHERE prescriptions.drug = 'antihistamine' ) AS T1 JOIN ( SELECT patient.subject_id, prescriptions.start_time FROM prescriptions JOIN patient ON prescriptions.patient_id = patient.subject_id WHERE prescriptions.drug = 'acetaminophen' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.start_time < T2.start_time ) AS T3 WHERE T3.C1 <= 1"
c5109baf674ec23d0c5833c7,What side effects does propofol have on the body?,,SELECT side_effects FROM medications WHERE medication_name = 'propofol'
e432536973c91611dfb80a3b,Call a rehabilitation center to arrange post-discharge care.,,1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b28dc49a162520774f9b7815,What does the average mcdonald's worker make per hour,,SELECT AVG(T1.hourly_wage) FROM ( SELECT SUM(T1.hourly_wage) AS hourly_wage FROM sql_assistant T1 JOIN patient T2 ON T1.patient_id = T2.subject_id WHERE T1.employee_type = 'mcdonald's worker' GROUP BY T1.employee_id ) AS T1
a51767448d369240d4de63da,What boats need to have a throw safety ring,,SELECT DISTINCT T1.product_id FROM products AS T1 JOIN product_details AS T2 ON T1.product_id = T2.product_id WHERE T2.additional_info = 'throw safety ring'
ccc413b763ed24bfb39994d2,Do you have an idea when patient 19428 goes into the closed bronchial biopsy procedure?,,SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 19428 AND procedures.procedure_name = 'closed bronchial biopsy'
771c5c87039440790cb87cb1,What is the length of stay in the icu for the patient having the most standing tackles?,,1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
82a17c445add2e20e68f48ea,What is the average age of temporary residents admitted for emergencies last month?,,"SELECT AVG(T1.age) FROM patients AS T1 JOIN admissions AS T2 ON T1.subject_id = T2.subject_id WHERE T2.admission_type = 'emergency' AND T2.dischtime IS NOT NULL AND datetime(T2.admittime,'start of month') = datetime(current_time,'start of month','-1 month')"
7751f8c3f1ab0e21c43a613f,What are the invoice numbers for patients with no religion?,,SELECT DISTINCT T1.invoice_number FROM payments AS T1 JOIN patients AS T2 ON T1.patient_id = T2.subject_id WHERE T2.religion = 'NOT SPECIFIED'
2d480d93128c6d01d254b654,When does patient 8016's influenza quarantine end?,,SELECT covid_quarantine_end_date FROM patients WHERE patient_id = 8016
b58a473dfa7c2592ff652a6c,Implement a text analysis on 'org_name' in 'microbiologyevents' to categorize organism types and their frequencies.,,1. Count the number of patients with other staphylococci since 2100.
ceb1b370c018763bf9d540ac,What is the procedure with the earliest consent date?,,SELECT procedure FROM procedures WHERE consent_date = ( SELECT MIN(consent_date) FROM procedures )
a58a76b1090ea49d378d08c7,Show the average age of patients with a female first child.,,SELECT AVG(T1.age) FROM patients AS T1 JOIN ( SELECT patient_id FROM children WHERE sex = 'f' AND age = ( SELECT MIN(age) FROM children WHERE sex = 'f' ) ) AS T2 ON T1.patient_id = T2.patient_id
65b54a9a91e26ef539c19320,What is the most common marital status among patients who graduated from their universities before 2100?,,SELECT T1.marital_status FROM patients AS T1 JOIN universities AS T2 ON T1.university = T2.university_id WHERE T2.graduation_year < 2100 GROUP BY T1.marital_status ORDER BY COUNT(*) DESC LIMIT 1
01d8cc2d8140fe97026f64a1,How many patients gave consent for procedures on holidays?,,"SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE procedures.status = 'consent' AND datetime( procedures.starttime,'start of day') = datetime( current_time,'start of day','-1 year')"
3384a95117cfd66b0be93cc7,What are the names of the advisors of the patients admitted to the icu yesterday?,,SELECT T2.name FROM icustays AS T1 JOIN patients AS T2 ON T1.patient_id = T2.subject_id WHERE T1.admission_id IN ( SELECT T1.admission_id FROM icustays AS T1 JOIN patients AS T2 ON T1.patient_id = T2.subject_id WHERE T1.outtime = ( SELECT MAX(outtime) FROM icustays WHERE patient_id = T2.subject_id ) ) AND T1.intime = ( SELECT MAX(intime) FROM icustays WHERE patient_id = T2.subject_id AND outtime = ( SELECT MAX(outtime) FROM icustays WHERE patient_id = T2.subject_id ) ) - INTERVAL '1 year' AND T1.outtime IS NOT NULL
cd1a10bb48a5d78543c8274e,Calculate the total hospital cost this year for patients with an address in san diego.,,"SELECT SUM(T1.total_cost) FROM ( SELECT SUM(C1.total_cost) * 1.0 FROM ( SELECT P1.d_icd_id, P1.d_icd_str, P1.d_output, P1.d_attention, P1.d_medication, P1.d_labitems, P1.d_diagnoses, P1.d_procedures, P1.d_transfers, P1.d_prescriptions, P1.d_settings, P1.d_dischtime, P1.d_admittime FROM ( SELECT * FROM patients WHERE patients.address_city = 'san diego' ) AS P1 ) AS T1"
1b5b4f108d7e42aaa4f7d982,What is the average time taken for appointments to be delayed in the obstetrics and gynecology department?,,SELECT AVG(T1.C1) FROM ( SELECT COUNT(DISTINCT diagnosis_of_last_encounter) AS C1 FROM patients WHERE diagnosis_of_last_encounter = 'delayed in the obstetrics and gynecology department' GROUP BY diagnosis_of_last_encounter ) AS T1
62dc93be504c5467fcfd7023,What are the record companies of the male patients?,,SELECT DISTINCT T1.record_company FROM patients AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id WHERE T1.gender = 'male'
e85b614de2cd2b16e98d1819,Organize a schedule for routine health check-ups of hospital staff.,,"SELECT 
    staff.staff_name,
    staff.staff_gender,
    staff.age,
    staff.hospital_staff_id,
    staff.has_immunity_test,
    staff.has_cancer_screening,
    staff.has_cardiac_monitoring,
    staff.has_ph_testing,
    staff.has_ecg_testing,
    staff.has_diagnostic_testing,
    staff.has_lab_testing,
    staff.has_daily_routine,
    staff.has_monthly_routine,
    staff.has_yearly_routine,
    staff.last_monthly_routine,
    staff.last_yearly_routine,
    staff.this_monthly_routine,
    staff.this_yearly_routine,
    staff.next_monthly_routine,
    staff.next_yearly_routine,
    staff.last_diagnosis,
    staff.last_diagnosis_date,
    staff.last_dischtime,"
6d4f5b0a77a91969a10a7ca2,How many microbiology events with excellent specimen quality have occurred since last month?,,SELECT COUNT(*) FROM microbiology WHERE specimen_quality = 'excellent' AND month(observation_date) = month(current_date) - 1
6cfb2f10e771a78363a1bc5c,At what age did patient 8245 get married?,,SELECT T1.age FROM patients AS T1 JOIN weddings AS T2 ON T1.subject_id = T2.subject_id WHERE T1.subject_id = 8245
32c14dcc9df90f448106023b,What are the most common distribution routes for drugs prescribed to patients aged 65 or older?,,"SELECT T1.route FROM ( SELECT route, COUNT(route) AS C1 FROM ( SELECT patient_id, prescriptions.route FROM prescriptions JOIN patients ON prescriptions.patient_id = patients.patient_id WHERE patients.age >= 65 ) AS T1 JOIN ( SELECT patient_id FROM diagnoses WHERE diagnoses.diagnosis_id = ( SELECT diagnoses.diagnosis_id FROM diagnoses WHERE diagnoses.diagnosis = 'other specified hypotension' ) ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY route ) AS T3 WHERE T3.C1 = ( SELECT MAX(C1) FROM ( SELECT route, COUNT(route) AS C1 FROM ( SELECT patient_id, prescriptions.route FROM prescriptions JOIN patients ON prescriptions.patient_id = patients.patient_id WHERE patients.age >= 65 ) AS T1 JOIN ( SELECT patient_id FROM diagnoses WHERE diagnoses.diagnosis_id = ( SELECT diagnoses.diagnosis_id FROM diagnoses WHERE diagnoses.diagnosis = 'other specified hypotension"
2db0f8c7e1cefb70047669cd,What is vertical profile,,SELECT * FROM patients WHERE age < 30
20212b42562c96ba09627d57,What can be prescribed for the hyposmolality patient?,,"SELECT T1.drug FROM ( SELECT diagnoses.diagnosis, diagnoses.diagnosis_id, patients.age FROM diagnoses JOIN patients ON diagnoses.patient_id = patients.subject_id WHERE diagnoses.diagnosis = 'hyposmolality' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.drug_id, patients.age FROM prescriptions JOIN patients ON prescriptions.patient_id = patients.subject_id WHERE patients.age >= 30 ) AS T2 ON T1.diagnosis_id = T2.drug_id"
e2998a185c87c0ba4d5fc2f7,What is the specimen quality of the most recent microbiology test done for patient 1272?,,SELECT microbiology.spec_quality FROM microbiology WHERE microbiology.patient_id = 1272 ORDER BY microbiology.charttime DESC LIMIT 1
0ec2b830c3ca46507175024e,Can you please tell me the address of patient 23969?,,SELECT address FROM patients WHERE id = 23969
8d2be59a2ae80a2665cee9f6,What is the longest icu stay duration for a patient with an acuity score of 10?,,10000306 has a acuity score of 10 in their first hospital visit.
760a949d971be61cb70b4e30,Perform a factor analysis on 'chartevents' to identify underlying relationships between various 'itemid'.,,"SELECT * FROM ( SELECT itemid, CATEGORY_ENCODING(itemid) AS CATEGORY FROM chartevents GROUP BY itemid ) AS subquery GROUP BY itemid"
bb09a05cffc9f15b770ef908,Who did patient 6580 see when she or he last went to the oncology department.,,6580 has been to the oncology department in the last year.
7f2296fb74a26260f81ce5ed,Which doctor were patient 30228s seen when he or she last visited the urology department?,,SELECT T3.name FROM patients AS T1 JOIN departments AS T2 ON T1.department = T2.department_id JOIN doctors AS T3 ON T1.last_doctor_id = T3.doctor_id WHERE T1.patient_id = 30228s AND T2.department_name = 'urology'
e24c2b3af926f81b8b39d097,Identify the most common organism associated with poor specimen quality in microbiology tests.,,"SELECT T1.org_name FROM ( SELECT org_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiology_events WHERE spec_type_desc = 'poor specimen' GROUP BY org_name ) AS T1 WHERE T1.C1 <= 3"
89b98595ecb5dd648dfff07a,What is the sum of the standing tackles made by the patients in the icu for the past year?,,"SELECT SUM(T1.tackles_total) FROM ( SELECT SUM(inputs.tackles_total) AS tackles_total FROM ( SELECT outputs.patient_id, inputs.tackles_total FROM ( SELECT current_patients.patient_id, 0 AS tackles_total FROM ( SELECT current_patients.patient_id FROM current_patients WHERE current_patients.dischtime is null ) AS current_patients JOIN ( SELECT patient_id, 1 AS is_last_month FROM ( SELECT patient_id, 1 AS is_first_month FROM ( SELECT patient_id, 1 AS is_first_year FROM ( SELECT patient_id, 1 AS is_first_time FROM ( SELECT patient_id, 1 AS is_last_time FROM ( SELECT patient_id, 1 AS is_this_year FROM ( SELECT patient_id, 1 AS is_this_month FROM ( SELECT patient_id, 1 AS is_this_time FROM ( SELECT patient_id, 1 AS is_last_icu FROM ( SELECT patient_id, 1 AS is_first_icu FROM ("
4b6a1eea90bca13f7f4efb60,Find the number of patients with a male next of kin who were treated in micu.,,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.next_of_kin FROM ( SELECT subject_id, next_of_kin FROM patients WHERE gender = 'm' ) AS T1 JOIN ( SELECT subject_id, next_of_kin FROM patients WHERE gender = 'm' ) AS T2 ON T1.subject_id = T2.subject_id ) WHERE T1.next_of_kin = 'm'"
57b1795f3ebba52457f40a4e,What is the residency status of the patient with the longest hospital stay?,,"SELECT T1.residency FROM ( SELECT patient_id, MIN(days_in_hospital) AS min_days FROM ( SELECT patient_id, days_in_hospital FROM diagnoses WHERE days_in_hospital > 0 ) AS T1 JOIN ( SELECT patient_id, days_in_hospital FROM transfers WHERE days_in_hospital > 0 ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY patient_id ) AS T1 JOIN patients AS T2 ON T1.patient_id = T2.subject_id"
3254e2e1ee8fe4e2b1b311bc,How many admissions had a last contact time on a weekend and were discharged to home?,,"SELECT COUNT(*) FROM admissions WHERE last_contact_time_strftime('%W') IN ( '01', '02', '03', '04', '05', '06' ) AND discharge_location = 'home'"
08b59f00be430697b18e99ef,Did patient 72107 actually fill out the consent form for a ct scan?,,SELECT COUNT(*)>0 FROM forms WHERE forms.subject_id = 72107 AND forms.form_name = 'ct scan'
d35ffc3f43ed6b012ff81b78,Count the number of unique hospital locations.,,SELECT COUNT( DISTINCT location ) FROM microbiologyevents.
f0d231106f67ae20775315a0,What are the latest advancements in lab test technologies?,,SELECT * FROM technologies WHERE type = 'lab' ORDER BY year DESC LIMIT 1
bb25eafdbf46cbaff7655e69,What are the languages spoken by patients who married before age 30?,,SELECT DISTINCT T2.language FROM patients AS T1 JOIN patients_info AS T2 ON T1.subject_id = T2.subject_id WHERE T1.marital_status = 'married' AND T1.age < 30
0b70a63dd87a9cc3e9394bfc,What was los angeles about?,,1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ae0f7e8f47b2f9f678c2f460,List all the salaries of the patients who got admitted to the tsicu for their first care unit.,,SELECT salary FROM patients WHERE last_care_unit = 'tsicu'
084afd2633ec15f7f471f409,What were the other styles?,,"SELECT DISTINCT other_styles FROM (
            SELECT T1.other_styles FROM (
                SELECT (strftime('%Y-%m-%d',diagnosis_date) - strftime('%Y-%m-%d',t1.diagnosis_date)) as other_styles
                FROM (
                    SELECT diagnosis_date,patient_id, (strftime('%Y-%m-%d',current_date) - strftime('%Y-%m-%d',diagnosis_date)) as days_since_diagnosis
                    FROM diagnoses
                    WHERE diagnosis_type = 'other specified procedures'
                ) as t1
                WHERE days_since_diagnosis >= '1 year'
            ) as t2
            WHERE other_styles is not null
        ) as t3"
590a46e35fc2ce6e48793a18,What are the most common side effects of loperamide hcl?,,"SELECT T1.side_effects FROM ( SELECT diagnoses.drug_id, COUNT(diagnoses.drug_id) AS c1 FROM diagnoses JOIN prescriptions ON diagnoses.drug_id = prescriptions.drug_id WHERE prescriptions.drug = 'loperamide hcl' GROUP BY diagnoses.drug_id ) AS T1 JOIN prescriptions ON T1.drug_id = prescriptions.drug_id ORDER BY T1.c1 DESC LIMIT 1"
8c0883ba3fa949b8db01dae8,What are some eye drops that are acceptable for those with dry eye?,,SELECT DISTINCT prescription_name FROM prescriptions WHERE prescription_type = 'eye drops' AND side_effects LIKE '%dry eye%'
db6c51e3b981690d48f9b061,Determine the most influential features for discharge location.,,"SELECT T1.discharge_location, COUNT(T1.discharge_location) FROM ( SELECT T1.discharge_location, T2.CUI FROM ( SELECT T1.discharge_location, T1.CUI, RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.discharge_location, T2.CUI FROM diagnoses AS T1 JOIN patient_features AS T2 ON T1.subject_id = T2.subject_id WHERE T1.dischtime <= current_time AND T1.dischtime >= current_time - 210 ) AS T1 GROUP BY T1.discharge_location, T2.CUI ) AS T1 WHERE T1.C1 <= 3"
f73f1dbf27ae1ba41d5baaae,What is the average number of standing tackles made by patients born after 2050?,,SELECT AVG(T1.standing_tackles) FROM ( SELECT COUNT(*) AS standing_tackles FROM patients WHERE patients.age > 2050 GROUP BY patients.subject_id ) AS T1
007c241a8e7fee7a038f792e,What are the most common procedure outcomes for patients based on their admission locations?,,"SELECT T1.outcome, COUNT(T1.outcome) FROM ( SELECT T2.outcome FROM ( SELECT admission_id, outcome FROM ( SELECT patient_id, diagnosis_id, outcome FROM diagnoses JOIN patients ON diagnoses.patient_id = patients.patient_id ) AS T1 JOIN ( SELECT admission_id, outcome FROM procedures AS T2 JOIN patients ON T2.patient_id = patients.patient_id ) AS T2 ON T1.admission_id = T2.admission_id ) AS T1 GROUP BY T1.outcome ) AS T2 GROUP BY T2.outcome ORDER BY COUNT(T2.outcome) DESC LIMIT 1"
59aeffdc0bac4c82ab171b74,How many primary physicians have been at the hospital since this year?,,"SELECT COUNT( DISTINCT diagnosis.diagnosis_id ) FROM diagnosis WHERE diagnosis.diagnosis_type = 'primary physician' AND datetime(diagnosis.diagnosis_time,'start of year') = datetime(current_time,'start of year','-0 year')"
ff3cb10da055df7f8ad45db1,What is the address of patient 15945.,,SELECT address FROM patients WHERE patient_id = 15945
4ea946f4212eca0acf044771,Which of these types of painting was more likely to have been produced by a northern renaissance,,SELECT T1.type_desc FROM painting_types AS T1 JOIN paintings AS T2 ON T1.type_code = T2.type_code GROUP BY T1.type_code ORDER BY COUNT(*) DESC LIMIT 1
09a532dd5b6e9afd19c87264,What is the adresse of patient 97395?,,SELECT address FROM patients WHERE patient_id = 97395
8d1ff6c593a74a67330e7c04,"Throughout this year, what are the top five most common drugs prescribed during the same hospital encounter to female patients aged 50s after being diagnosed with epilepsy, unspecified, not intractable, without status epilepticus?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, not intractable, without status epilepticus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","1. SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'epilepsy, unspecified, not intractable, without status epilepticus' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT DISTINCT subject_id FROM demographics WHERE gender = 'f' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year"
289be48fc696c588e5a69f9c,Pull up the IDs of patients who were diagnosed with cataract extraction status.,SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cataract extraction status' ) ),SELECT patient_id FROM procedures WHERE procedure_name = 'cataract extraction status'
8465e809028d1263318be90f,What is the difference between platelet count last measured on the first hospital visit compared to the first value measured on the first hospital visit for patient 10009628?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10009628 AND lab_tests.label = 'platelet count' AND lab_tests.charttime = ( SELECT lab_tests.charttime FROM lab_tests WHERE lab_tests.patient_id = 10009628 AND lab_tests.label = 'platelet count' AND lab_tests.charttime = ( SELECT MIN(charttime) FROM lab_tests WHERE lab_tests.patient_id = 10009628 ) ) ) - ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10009628 AND lab_tests.label = 'platelet count' AND lab_tests.charttime = ( SELECT MIN(charttime) FROM lab_tests WHERE lab_tests.patient_id = 10009628 ) ) )
c5d97a3fa6b67acc42a60f3f,How many days have passed since patient 10039831's last stay in careunit discharge lounge in this hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.careunit = 'discharge lounge' AND transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject = 10039831 AND admissions.dischtime IS NULL ) ORDER BY transfers.intime DESC LIMIT 1"
6c76f49427e903af86c8314e,Count the number of days since patient 10021487's first diagnosis of acute respiratory failure following trauma and surgery on this hospital visit.,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute respiratory failure following trauma and surgery' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1",SELECT COUNT(*) FROM ( SELECT diagnosis_time FROM diagnoses WHERE diagnoses.patient_id = 10021487 AND diagnoses.dischtime IS NULL ) AS T1 JOIN ( SELECT charttime FROM procedures WHERE procedures.patient_id = 10021487 AND procedures.dischtime IS NULL ) AS T2 ON T1.diagnosis_time = T2.charttime
6c16600578aa6d76931a6d00,"What are the five commonly taken specimens for patients who received extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic previously during the same month since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.chart_time FROM ( SELECT subject_id, chart_time FROM procedures WHERE procedures.procedure_name = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AS T1 JOIN ( SELECT subject_id, spec_type_desc FROM microbiology_events WHERE microbiology_events.chart_time >= '2100-01-01' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of month') = datetime(T2.chart_time,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5"
220a7871615e4c1a12e5cf08,Retrieve the marital status of patient 10006580 on the last hospital stay.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT marital_status FROM ( SELECT * FROM patients WHERE subject_id = 10006580 AND hospital_id = ( SELECT MAX(hospital_id) FROM patients WHERE subject_id = 10006580 ) )
8a7a53bc8a46ea0c02865fa2,"What was the drug that patient 10004720 prescribed with during the same day after receiving introduction of nutritional substance into upper gi, via natural or artificial opening since 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT T2.drug FROM ( SELECT procedures.starttime, procedures.patient, procedures.drug FROM procedures WHERE procedures.patient = 10004720 AND procedures.starttime >= '2100-03-21 00:00:00' AND procedures.type = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AS T1 JOIN ( SELECT prescriptions.starttime, prescriptions.patient, prescriptions.drug FROM prescriptions WHERE prescriptions.patient = 10004720 AND prescriptions.starttime >= '2100-03-21 00:00:00' ) AS T2 ON T1.patient = T2.patient WHERE T1.starttime < T2.starttime AND datetime(T1.starttime,'start of day') = datetime(T2.starttime,'start of day')"
126247b40bdfae51da6c523f,How frequently was the simple excision of other lymphatic structure procedure done throughout this year?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM procedures WHERE procedures.long_title = 'simple excision of other lymphatic structure' AND datetime(procedures.start_time,'start of year') = datetime(current_time,'start of year','-0 year')"
17bb906271e8d84bf499f645,How much does patient 10038999 change in mesothelial cells last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT lab.value FROM lab WHERE lab.patient_id = 10038999 AND lab.spec_type_desc = 'mesothelial cells' AND lab.charttime = ( SELECT MAX(charttime) FROM lab WHERE lab.patient_id = 10038999 AND lab.spec_type_desc = 'mesothelial cells' AND lab.charttime >= ( SELECT charttime FROM lab WHERE lab.patient_id = 10038999 AND lab.spec_type_desc = 'age' ) ) ) - ( SELECT lab.value FROM lab WHERE lab.patient_id = 10038999 AND lab.spec_type_desc = 'mesothelial cells' AND lab.charttime = ( SELECT MAX(charttime) FROM lab WHERE lab.patient_id = 10038999 AND lab.spec_type_desc = 'mesothelial cells' AND lab.charttime >= ( SELECT charttime FROM lab WHERE lab.patient_id = 10038999 AND lab.spec_
cf75e230ba259301517169ac,What was the total output for patient 10001217 since 12/02/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-02'",SELECT SUM(output) FROM ( SELECT output FROM ( SELECT * FROM input_data WHERE subject = 10001217 ) WHERE input_time >= '2100-12-02' )
f8f6d23e64a92d83dd3fd151,Has there been any organism detected during the last rapid respiratory viral screen & culture microbiology test for patient 10007818 since 02/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT COUNT(*)>0 FROM microbiology_events WHERE microbiology_events.patient_id = 10007818 AND microbiology_events.spec_type_desc = 'rapid respiratory viral screen & culture' AND microbiology_events.last_performance_time >= '2100-02-01'
02641abbf2e5bcb72ad7aedc,Please list the top five most frequent specimens tested.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT specimen, COUNT(*) FROM ( SELECT microbiologyevents.specimen FROM microbiologyevents GROUP BY microbiologyevents.specimen ORDER BY COUNT(*) DESC LIMIT 5 ) subquery GROUP BY specimen"
b472da76f7e2b4d53f38f131,"Can you tell me the last care unit patient 10003046 was in during their last hospital visit, according to the transfer record?",SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1,SELECT transfers.care_unit FROM transfers WHERE transfers.patient_id = 10003046 AND transfers.in_time IN ( SELECT MIN(in_time) FROM transfers WHERE transfers.patient_id = 10003046 AND transfers.in_time >= ( SELECT MIN(in_time) FROM transfers WHERE transfers.patient_id = 10003046 ) )
52c6c669438001d194f1c9a8,What is the length of the first hospital stay in days for patient 10016742?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT strftime('%J',pat.chart_exit) - strftime('%J',pat.chart_admission) FROM patients pat WHERE pat.subject_id = 10016742 AND not pat.dischtime IS NULL ORDER BY pat.admittime ASC LIMIT 1"
82623a9f149ae4a941d737fc,Which condition was diagnosed for patient 10006580 on the last on the last hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),"SELECT diagnoses.long_title FROM diagnoses WHERE diagnoses.patient_id = 10006580 AND diagnoses.hospital_order = ( SELECT MIN(diagnoses.hospital_order) FROM diagnoses WHERE diagnoses.patient_id = 10006580 AND datetime(diagnoses.diagnosis_time,'start of year') = datetime(current_time,'start of year','-1 year') ) ORDER BY diagnoses.diagnosis_time DESC LIMIT 1"
7437f40a03312a89a951bf71,"For patients who had hemodialysis, what were the most frequent four microbiology tests carried out during the same hospital visit?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.hadm_id, T1.charttime, T1.hadm_id AS hadm_id FROM ( SELECT admissions.subject_id, diagnoses.hadm_id, diagnoses.charttime, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'hemodialysis' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiology.test_name, microbiology.charttime, admissions.hadm_id FROM microbiology JOIN admissions ON microbiology.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.hadm_id = T2.hadm_id AND datetime(T1.charttime) = datetime(T2.charttime) GROUP BY T2"
5db93544ca13afa9605c5f92,How many current patients are 30s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE age BETWEEN 30 AND 39
7873d7d50e05f38127c1a555,Has patient 10005866 had any type of diagnosis in this year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM diagnoses WHERE diagnoses.patient_id = 10005866 AND datetime(diagnoses.diagnosis_time,'start of year') = datetime(current_time,'start of year','-0 year')"
ec1ed057dd7ec2a55f903e6e,Calculate the number of times that patient 10004235 had lr input on 12/24/last year.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'","SELECT COUNT(*) FROM inputevents WHERE inputevents.patient_id = 10004235 AND inputevents.input_type_id = 314 AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'"
19a51debb0c5754456d20d1f,How many medications were prescribed to patient 10022017 since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10022017 AND strftime('%Y', medications.starttime) >= '2100'"
0dec474abd85aab4b9b4bf61,What diagnosis did patient 10003400 receive the last time since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )","SELECT diagnosis_name FROM diagnoses WHERE diagnoses.patient_id = 10003400 AND strftime('%Y',diagnoses.diagnosis_date) >= '2100' ORDER BY diagnoses.diagnosis_date DESC LIMIT 1"
e57140ff3a3e15a2db33f62d,How much of a difference is there in patient 10006580's white blood cells second measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT lab.valuenum FROM lab WHERE lab.hadm_id IN ( SELECT hadm.hadm_id FROM hadm WHERE hadm.patient_id = 10006580 AND hadm.dischtime IS NOT NULL ORDER BY hadm.admittime ASC LIMIT 1 ) AND lab.spec_type_desc = 'white blood cells' ORDER BY lab.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT lab.valuenum FROM lab WHERE lab.hadm_id IN ( SELECT hadm.hadm_id FROM hadm WHERE hadm.patient_id = 10006580 AND hadm.dischtime IS NOT NULL ORDER BY hadm.admittime ASC LIMIT 1 ) AND lab.spec_type_desc = 'white blood cells' ORDER BY lab.charttime ASC LIMIT 1 )
18feccbb84730d8b9391bf79,"What were the top three most frequent microbiology tests that patients were given after being diagnosed with acquired absence of organ, genital organs during the same hospital encounter since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of organ, genital organs' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'acquired absence of organ, genital organs' AND strftime('%Y',diagnoses.chart_time) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiology.test_name, microbiology.chart_time, admissions.hadm_id FROM microbiology JOIN admissions ON microbiology.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiology.chart_time) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1.hadm_id = T2.had"
590d8305084857287efef413,How much did patient 10038999 weigh at their first measurement on the first hospital encounter?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,"SELECT MIN(weight_kg) FROM ( SELECT patient_id, weight_kg FROM ( SELECT patient_id, weight_kg, datetime(measure_time, 'start of year') as measure_year_month FROM ( SELECT patient_id, weight_kg, datetime(measure_time, 'start of month') as measure_month FROM ( SELECT patient_id, weight_kg, datetime(measure_time, 'start of year') as measure_year, datetime(measure_time, 'start of month') as measure_month_temp FROM ( SELECT patient_id, weight_kg, datetime(measure_time, 'start of year') as measure_year_temp, datetime(measure_time, 'start of month') as measure_month_temp FROM ( SELECT patient_id, weight_kg, datetime(measure_time, 'start of year') as measure_year_temp, datetime(measure_time, 'start of month') as measure_month_temp FROM patients WHERE patient_id = 10038999 AND datetime(measure_time, 'start of year') = datetime(current_time, 'start of year', '-1 year') AND datetime(measure"
532b30aa4c94b277b88eba32,How many prescriptions were ordered for cyanocobalamin in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' AND strftime('%Y',prescriptions.starttime) = '2100'"
69356637e317ad0c9ca83dce,How many prescriptions were ordered for acetylcysteine (iv) in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine (iv)' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine (iv)' AND strftime('%Y',prescriptions.starttime) = '2100'"
c2d3722d0ba8692f756e7846,What was the first diagnosis that patient 10021666 received this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT diagnosis.text FROM diagnosis WHERE diagnosis.patient_id = 10021666 AND datetime(diagnosis.diagnosis_time,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnosis.diagnosis_time ASC LIMIT 1"
3857136499aee33dbb04cab5,When did patient 10038081 get the first blood (ebv) microbiology test since 16 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood (ebv)' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiology.charttime FROM microbiology WHERE microbiology.patient = 10038081 AND microbiology.spec_type_desc = 'blood (ebv)' AND datetime(microbiology.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiology.charttime ASC LIMIT 1"
f3051b86c007dd34ade04ba9,When was the last time that patient 10003400 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003400 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003400 ORDER BY admissions.dischtime DESC LIMIT 1
04a4403dd1172df24786f145,Please show me the top three most usual procedures for patients aged 20s since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",SELECT T1.long_title FROM procedures AS T1 JOIN patients AS T2 ON T1.patient_id = T2.subject_id WHERE T2.age BETWEEN 20 AND 29 AND T1.year >= 2100 GROUP BY T1.long_title ORDER BY COUNT(*) DESC LIMIT 3
85c3e2700b75549e5f889cf1,What is the name of the medication that patient 10036156 received two or more times in their last hospital visit?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T1.drug FROM ( SELECT prescription.drug, COUNT(prescription.start_time) AS c1 FROM prescription WHERE prescription.patient_id = 10036156 AND prescription.dischtime IS NOT NULL ORDER BY prescription.start_time DESC LIMIT 1 ) AS T1 WHERE T1.c1 >= 2"
c16ba004a34ca12d357c16d6,How many patients in 2100 received central venous catheter placement with guidance after the reopening of recent thoracotomy site procedure within the same month?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reopening of recent thoracotomy site' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.chart_time FROM ( SELECT subject_id, chart_time FROM procedures WHERE procedure_name = 'reopening of recent thoracotomy site' ) AS T1 JOIN ( SELECT subject_id, chart_time FROM procedures WHERE procedure_name = 'central venous catheter placement with guidance' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of year') = datetime(T2.chart_time,'start of year') AND strftime('%B',T1.chart_time) = '2100' ) AS T1 JOIN ( SELECT subject_id, chart_time FROM diagnoses WHERE diagnosis_name = 'other specified procedures' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of year') = datetime(T2.chart_time"
47fd000ef0b1033a8aabfac8,Show me the top five most frequently prescribed medications since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM medication T1 JOIN prescription T2 ON T1.code = T2.medication_code WHERE strftime('%Y',T2.prescription_time) >= '2100' GROUP BY T1.drug ) AS T1 WHERE T1.C1 <= 5"
5af08ca2546f4bf6b47b14b0,Calculate the number of patients who stayed in the med/surg this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )",SELECT COUNT( DISTINCT patient_id ) FROM ( SELECT patient_id FROM procedures WHERE procedure_time >= '2100-01-01' AND procedure_time < '2100-01-01' + INTERVAL '1 year' ) AS T1 JOIN patients ON T1.patient_id = patients.subject_id
58a17f0e9f1fb5701047c022,Did patient 10002428 come to the er during the first hospital encounter?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,10002428 came to the emergency room (er) during the first hospital encounter?
14a8c9364f4f7aced0b46787,How many lactated ringers prescriptions were given out since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lactated ringers' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lactated ringers' AND strftime('%Y',prescriptions.starttime) >= '2100'"
d6d0cf531ac1d23c6fa0a6b6,What is the number of times patient 10019172 visited the hospital?,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019172,SELECT COUNT( DISTINCT visit_id ) FROM hospital_visits WHERE patient_id = 10019172
83b456769e420696daed1609,What's the diastolic blood pressure change of patient 10022281 last measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT diastolic blood pressure FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu_id FROM icu WHERE icu.patient_id = 10022281 AND icu.outtime IS NOT NULL ORDER BY icu.intime DESC LIMIT 1 ) ORDER BY icu_visits.charttime DESC LIMIT 1 ) - ( SELECT diastolic blood pressure FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu_id FROM icu WHERE icu.patient_id = 10022281 AND icu.outtime IS NOT NULL ORDER BY icu.intime DESC LIMIT 1 ) ORDER BY icu_visits.charttime ASC LIMIT 1 )
421648dc5e387538f77aee5c,How many patients were prescribed albuterol 0.083% neb soln within the same hospital visit after they were diagnosed with personal history of malignant neoplasm of prostate in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of prostate' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'albuterol 0.083% neb soln' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses.diagnosis_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'personal history of malignant neoplasm of prostate' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'albuterol 0.083% neb soln' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.starttime AND T1.hadm_id = T2.hadm_id"
3173d5e9349394956703946f,When was the last instance when patient 10021487's respiratory rate was greater than 17.0 on 12/17/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 17.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-17' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT strftime('%Y-%m-%d', patient.age) FROM patient WHERE patient.age > 17.0 AND strftime('%Y-%m-%d', patient.age) = '12/17/2100'"
3dd7cbf61468460681ff3c30,What were the top five most common treatments given to patients in their 60 or above since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.treatment, T1.count FROM ( SELECT T2.treatment, COUNT(T2.treatment) AS count FROM ( SELECT T1.age, T1.treatment FROM ( SELECT T1.age, T1.treatment_id, T1.diagnosis_id FROM ( SELECT T1.age, T1.treatment_id, T1.diagnosis_id, ( SELECT T2.treatment FROM ( SELECT T2.treatment, T2.row_id FROM T2 WHERE T2.row_id IN ( SELECT T1.row_id FROM T1 WHERE T1.age >= 60 ) ) ) AS T1 JOIN ( SELECT row_id, treatment FROM T2 WHERE T2.year >= 2100 ) AS T2 ON T1.treatment_id = T2.row_id ) GROUP BY T2.treatment ) AS T1 ORDER BY T1.count DESC LIMIT 5 )"
f18bca6a8a225c176e87417b,What's new in patient 10039831's medication list today compared to the list yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')",SELECT ( SELECT medication_list FROM medication_history WHERE patient_id = 10039831 AND date = current_date ) - ( SELECT medication_list FROM medication_history WHERE patient_id = 10039831 AND date = current_date - INTERVAL '1 day' )
d0eb687248bca6964f140046,How many people died after being diagnosed with posttraumatic stress disorder within 2 months throughout this year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'posttraumatic stress disorder' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-0 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE ( datetime(T3.dod) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') ) OR ( datetime(T2.charttime) BETWEEN datetime(T3.dod) AND datetime(T3.dod,'+2 month') )","SELECT COUNT(DISTINCT t2.subject_id) FROM ( SELECT t1.subject_id, t1.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'posttraumatic stress disorder' ) AS t1 GROUP BY t1.subject_id HAVING MIN(diagnosis_time) = t1.diagnosis_time AND datetime(t1.diagnosis_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS t2 JOIN ( SELECT subject_id, death_time FROM patients WHERE death_time is NOT NULL ) AS t3 ON t2.subject_id = t3.subject_id WHERE datetime(t3.death_time,'start of year') = datetime(current_time,'start of year','-0 year') AND t2.diagnosis_time < t3.death_time AND datetime(t3.death_time) - datetime(t2.diagnosis_time) < 2 month"
9f97931d5d6f4871dc6efe31,Provide the ID list of patients who were diagnosed with methicillin susceptible pneumonia due to staphylococcus aureus since 2100.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible pneumonia due to staphylococcus aureus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT T1.subject_id FROM ( SELECT subject_id, diagnosed_time FROM diagnoses WHERE diagnosis = 'methicillin susceptible pneumonia due to staphylococcus aureus' AND strftime('%Y',diagnosed_time) >= '2100' ) AS T1 JOIN ( SELECT subject_id, prescriptions_details FROM prescriptions WHERE prescription_type = 'drug' AND strftime('%Y',prescription_time) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id"
7cdb91fabb7e08749637f74e,How many individuals are there who are current patients?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE status = 'current'
68f60925ee10fafbe0a043b1,Is systolic blood pressure of patient 10027602 last measured on the last ICU visit greater than the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT diastolic blood pressure FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu.icu_id FROM icu WHERE icu.had_surgery = 's' AND icu.dischtime IS NOT NULL ORDER BY icu.admittime DESC LIMIT 1 ) AND icu_visits.spec_type_desc = 'systolic blood pressure' ORDER BY icu_visits.charttime DESC LIMIT 1 ) > ( SELECT diastolic blood pressure FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu.icu_id FROM icu WHERE icu.had_surgery = 's' AND icu.dischtime IS NOT NULL ORDER BY icu.admittime DESC LIMIT 1 ) AND icu_visits.spec_type_desc = 'systolic blood pressure' ORDER BY icu_visits.charttime ASC LIMIT 1 )
b0bde5b825a0b0039eb609d0,"Since 178 days ago, when was the mean blood pressure of patient 10005817, for the last time, observed at less than 76.0?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 76.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-178 day') ORDER BY chartevents.charttime DESC LIMIT 1",SELECT ( SELECT MAX(C1.C2) FROM ( SELECT C1.C1 FROM ( SELECT C1.C1 FROM patient_10005817.medication_prescription C1 WHERE C1.patient_id = 10005817.patient_id ) AS C1 WHERE C1.dosage_method_id = 2 ) AS C2 ) < 76.0
55d4903b176bcfa711e73e0f,"Has patient 10006580 had any implantation or replacement of carotid sinus stimulation device, total system procedure in 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10006580 AND procedures.procedure_name = 'implantation or replacement of carotid sinus stimulation device, total system' AND strftime('%Y',procedures.start_time) = '2100'"
ae1a61baad9fcbb6ccb57c0b,"Give me the top four most frequent diagnoses that patients were diagnosed with in the same month after being diagnosed with body mass index 35.0-35.9, adult this year.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.long_title FROM ( SELECT T2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis_time >= '2100-01-01' AND diagnosis_time < '2101-01-01' AND diagnosis = 'body mass index 35.0-35.9, adult' ) AS T1 ) AS T2 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis_time >= '2100-01-01' AND diagnosis_time < '2101-01-01' ) AS T3 ON T2.subject_id = T3.subject_id WHERE T2.diagnosis_time < T3.diagnosis_time AND datetime(T2.diagnosis_time,'start of month') = datetime(T3.diagnosis_time,'start of month') GROUP BY T2"
5c2b95425f850cf9aee654aa,Please list the yearly average volume of stool that was output by patient 10020740 since 03/26/2100.,"SELECT AVG(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'stool' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-26' GROUP BY strftime('%Y',outputevents.charttime)","SELECT AVG(output_volume) FROM ( SELECT 'stool' AS output_name, patient_id, month(output_time) AS output_month, day(output_time) AS output_day, year(output_time) AS output_year FROM microbiology_events WHERE patient_id = 10020740 ) AS subquery GROUP BY output_year, output_month, output_day ORDER BY output_year DESC, output_month DESC, output_day DESC"
82d84ee3f00fa576d3b70969,Is the anion gap level of patient 10003400 measured at 2100-06-15 05:34:00 less than the level measured at 2100-06-14 06:15:00?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-06-15 05:34:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-06-14 06:15:00' ),SELECT ( SELECT anion_gap FROM lab_test WHERE subject_id = 10003400 AND measurement_time = '2100-06-15 05:34:00' ) < ( SELECT anion_gap FROM lab_test WHERE subject_id = 10003400 AND measurement_time = '2100-06-14 06:15:00' )
ef3f743b0397c2df00366c56,Show me the length of stay in days of patient 10004422's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT strftime('%J', icu.outtime) - strftime('%J', icu.intime) FROM icu WHERE icu.patient_id = 10004422 AND icu.outtime IS NOT NULL ORDER BY icu.intime ASC LIMIT 1"
4ea7d91dc5b0b0f4da0cb1c6,"Among patients who were diagnosed with anemia, unspecified since 2100, what are the top three most commonly prescribed medications that followed during the same hospital visit for patients in their 60 or above?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'anemia, unspecified' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY"
01816d54bc83e51d38259aaf,What was patient 10009628's insurance plan on their last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,"SELECT patient_10009628.insurance_plan FROM ( SELECT patient_10009628.id, patient_10009628.age, patient_10009628.gender, patient_10009628.marital_status, patient_10009628.insurance_plan FROM patient_10009628 WHERE patient_10009628.dischtime IS NOT NULL ORDER BY patient_10009628.admittime DESC LIMIT 1 ) AS patient_10009628_2"
e85f97540e562568f8795422,How many patients were treated with endoscopic control of gastric or duodenal bleeding in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic control of gastric or duodenal bleeding' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE procedures.name = 'endoscopic control of gastric or duodenal bleeding' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year')"
fde016b31923066cd34bb168,What was patient 10022281's first output time of foley on 06/23/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-06-23' ORDER BY outputevents.charttime ASC LIMIT 1","SELECT MIN(output_time) FROM ( SELECT output_time FROM output_events WHERE output_events.patient_id = 10022281 AND output_events.output_type = 'foley' ) AS foley_outputs WHERE strftime('%Y-%m-%d',foley_outputs.output_time) = '2100-06-23'"
e96cf491a6710c896774de33,How many people died after being diagnosed with long term (current) use of opiate analgesic during the same month during the last year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of opiate analgesic' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-1 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE datetime(T2.charttime,'start of month') = datetime(T3.dod,'start of month')","SELECT COUNT(DISTINCT t2.subject) FROM ( SELECT t1.subject, t1.charttime FROM ( SELECT subject, charttime FROM procedures WHERE procedures.icd11 = ( SELECT icd11 FROM icd11_map WHERE icd11_map.english_title = 'diagnosis of long term (current) use of opiate analgesic' ) ) AS t1 GROUP BY t1.subject HAVING MIN(t1.charttime) = t1.charttime AND DATETIME(t1.charttime,'start of year') = DATETIME(CURRENT_TIME,'start of year','-1 year') ) AS t2 JOIN ( SELECT subject, charttime FROM diagnoses WHERE diagnoses.icd11 = ( SELECT icd11 FROM icd11_map WHERE icd11_map.english_title = 'long term (current) use of opiate analgesic' ) ) AS t3 ON t2.subject = t3.subject WHERE datetime(t2.charttime,'start of month') = datetime(t3.charttime,'start of month')<|im_end"
d39e6cca12842e2e3d53b7cd,What was the first measurement of patient 10013049's height since 25 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-25 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(patient_measures.value) FROM patient_measures WHERE patient_measures.patient_id = 10013049 AND patient_measures.measure_type = 'height' AND datetime(patient_measures.measure_time) >= datetime(current_time,'-25 month')"
b51508dd79305473d5dbaf7c,List the top three most frequent lab tests that patients were given in the same hospital visit after being diagnosed with dysphonia in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphonia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'dysphonia' AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labtests.test_name, labtests.charttime, admissions.admission_id FROM labtests JOIN admissions ON labtests.admission_id = admissions.admission_id WHERE strftime('%Y',labtests.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.admission_id = T2.admission_id GROUP BY T2.test_name ) AS T3 WHERE T3"
20db068481b9b06cc4340c25,What was patient 10018081's first procedure time since 1 year ago?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY procedures_icd.charttime ASC LIMIT 1","SELECT procedures.start_time FROM procedures WHERE procedures.patient_id = 10018081 AND datetime(procedures.start_time) >= datetime(current_time,'-1 year') ORDER BY procedures.start_time ASC LIMIT 1"
568a32b005438f0d65d4f758,When did patient 10020786 receive the last magnesium test in their last hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT lab_test.chart_time FROM lab_test WHERE lab_test.patient_id = 10020786 AND lab_test.spec_type_desc = 'magnesium' AND lab_test.chart_time >= ( SELECT lab_test.chart_time FROM lab_test WHERE lab_test.patient_id = 10020786 AND lab_test.spec_type_desc = 'magnesium' ORDER BY lab_test.chart_time DESC LIMIT 1 ) ORDER BY lab_test.chart_time DESC LIMIT 1
304589d2a4159d23de6243b4,When was the last mrsa screen microbiology test given to patient 10015272 in the last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiology.charttime FROM microbiology WHERE microbiology.patient_id = 10015272 AND microbiology.spec_type_desc = 'mrsa screen' AND microbiology.charttime >= ( SELECT admissions.charttime FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.charttime DESC LIMIT 1 ) ORDER BY microbiology.charttime DESC LIMIT 1
ee759ac11ca738371bf48a9c,"Among patients in their 30s since 2100, what are the top three prescribed drugs?","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3",1. What are the top three prescribed drugs for patients in their 30s since 2100?
9eda5afbe00ed4d5f058ec11,What was the last time patient 10037975 got the stool microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND microbiologyevents.spec_type_desc = 'stool' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiology.charttime FROM microbiology WHERE microbiology.patient = 10037975 AND microbiology.spec_type_desc = 'stool' ORDER BY microbiology.charttime DESC LIMIT 1
6b48b47dea05709d8dddd909,Was the calculated total co2 level of patient 10038933 last measured on the first hospital visit less than the second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT lab_results.val_num FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND lab_results.spec_type_desc = 'calculated total co2' ORDER BY lab_results.charttime DESC LIMIT 1 ) < ( SELECT lab_results.val_num FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND lab_results.spec_type_desc = 'calculated total co2' ORDER BY lab_results.charttime DESC LIMIT 1 OFFSET 1 )
bc09da3606efe6b770f6ea1f,Tell me the number of times a open heart valvuloplasty of mitral valve without replacement took place in the previous year.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open heart valvuloplasty of mitral valve without replacement' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.long_title = 'open heart valvuloplasty of mitral valve without replacement' AND datetime(procedures.start_time,'start of year') = datetime(current_time,'start of year','-1 year')"
f1fc9f152b1ba46ecd03c1a6,What are the top five most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.output_event_id FROM ( SELECT output_event_id, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures WHERE datetime(current_time,'start time') >= datetime(current_time,'start time', '-1 year') GROUP BY output_event_id ) AS T1 WHERE T1.C1 <= 5"
883c4d0f0f9708f99cf278d8,"What was the last value of a lab test of calcium, urine in 12/this year for patient 10021487?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, urine' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime DESC LIMIT 1","SELECT lab_value FROM lab_tests WHERE lab_test_name = 'calcium, urine' AND patient_id = 10021487 AND datetime(lab_test_date,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',lab_test_date) = '12' ORDER BY lab_test_date DESC LIMIT 1"
8bad69864afaca5758a6aa37,Calculate the patients who received a serology/blood microbiology test since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'serology/blood' AND strftime('%Y',microbiologyevents.charttime) >= '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM microbiology_events WHERE microbiology_event_type = 'serology/blood' AND strftime('%Y',microbiology_events.charttime) >= '2100'"
d7d78a96a2f14b1d1a909d88,"Compared to yesterday, what is new in the prescription of patient 10039831 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescription FROM medications WHERE patient_id = 10039831 AND datetime(prescription.start_time,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescription FROM medications WHERE patient_id = 10039831 AND datetime(prescription.start_time,'start of day') = datetime(current_time,'start of day','-1 day')"
3c71f198ffca8a3ba108d583,What was the organism found in patient 10027602's first mini-bal microbiology test?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,"SELECT T1.org_name FROM ( SELECT microbiology.org_name, microbiology.chart_id FROM microbiology WHERE microbiology.patient_id = 10027602 AND microbiology.spec_type_desc = 'mini-bal' AND microbiology.chart_id = ( SELECT MIN(microbiology.chart_id) FROM microbiology WHERE microbiology.patient_id = 10027602 AND microbiology.spec_type_desc = 'mini-bal' ) ) AS T1 JOIN ( SELECT microbiology.chart_id, microbiology.org_name FROM microbiology WHERE microbiology.patient_id = 10027602 AND microbiology.spec_type_desc = 'mini-bal' ) AS T2 ON T1.chart_id = T2.chart_id"
111dee20bbe14075c60dc939,What were the four most frequently performed lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.test_name FROM ( SELECT lab_tests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM lab_tests WHERE datetime(lab_tests.chart_time) >= datetime(current_time,'-1 year') GROUP BY lab_tests.test_name ) AS T1 WHERE T1.C1 <= 4"
c189cadcf09e3eb65ff5c31a,What are the three commonly ordered medications for patients aged 60 or above?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.age >= 60 GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3"
e0b69eb370890d55d0e2a032,What's the total amount of d5 1/2ns that patient 10038933 received on 09/26/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '09-26'",SELECT SUM(input_events.totalamount) FROM input_events WHERE input_events.patientid = 10038933 AND input_events.starttime >= '2100-09-26 00:00:00' AND input_events.starttime < '2100-09-26 00:00:00' AND input_events.totalamount = 'd5 1/2ns'
0e9be6448c82613884bebdf5,"So, what was the maximum 25-oh vitamin d value of patient 10029484 since 11/2100?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '25-oh vitamin d' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-11'","SELECT MAX(assistant.lab_results.vitamin_d_25_oh) FROM assistant WHERE assistant.patient_id = 10029484 AND strftime('%Y-%m',assistant.lab_results.chart_time) >= '2100-11'"
a63d852e13ffd03ce88b22d1,Tell me the percentile of urea nitrogen 22.0 among all patients of the same age as patient 10007928 in their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 22.0","SELECT DISTINCT T1.C1 FROM ( SELECT lab.C1, PERCENT_RANK() OVER ( ORDER BY lab.C1 ASC ) AS C2 FROM lab WHERE lab.PAT_ID IN ( SELECT patient.PAT_ID FROM patient WHERE patient.AGE = ( SELECT patient.AGE FROM patient WHERE patient.PAT_ID = 10007928 AND patient.HOSP_ITERATIONS = ( SELECT COUNT( DISTINCT diagnosis.DIAG_ID ) FROM diagnosis WHERE diagnosis.PAT_ID = 10007928 AND diagnosis.HOSP_ITERATION_ID = ( SELECT treatment.HOSP_ITERATION_ID FROM treatment WHERE treatment.PAT_ID = 10007928 AND treatment.HOSP_ITERATION_DESCRIPTION = 'discharge from hospital' ORDER BY treatment.HOSP_ITERATION_ID DESC LIMIT 1 ) ) ) AS C1 FROM lab WHERE lab.LAB_NAME = 'urea nitrogen' ) AS T1 WHERE T1.C2"
51978c2653bcfbd2cc8c5eae,"How many people received a introduction of nutritional substance into upper gi, via natural or artificial opening procedure within the same month after they had been diagnosed with postprocedural pneumothorax since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural pneumothorax' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.chart_time FROM ( SELECT subject_id, chart_time FROM diagnoses WHERE diagnosis = 'postprocedural pneumothorax' ) AS T1 JOIN procedures AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time >= '2100-01-01 00:00:00' ) AS T1 JOIN ( SELECT subject_id, chart_time FROM procedures WHERE procedure = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of month') = datetime(T2.chart_time,'start of month')"
84b9e35f62f23089ad08f03e,How much of a difference is there in patient 10035185's mean blood pressure last measured on the first ICU visit compared to the second to last value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT mean_bp FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu_id FROM icu_stays WHERE icu_stays.stay_id IN ( SELECT stay_id FROM stay_events WHERE stay_events.stay_id IN ( SELECT stay_id FROM patients WHERE patients.subject_id = 10035185 ) AND icu_stays.outtime IS NOT NULL ORDER BY icu_stays.intime ASC LIMIT 1 ) ) ORDER BY icu_visits.intime DESC LIMIT 1 ) - ( SELECT mean_bp FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu_id FROM icu_stays WHERE icu_stays.stay_id IN ( SELECT stay_id FROM patients WHERE patients.subject_id = 10035185 ) AND icu_stays.outtime IS NOT NULL ORDER BY icu_stays.intime ASC LIMIT 1 ) ) ORDER BY icu_visits.intime DESC LIMIT 1 OFFSET 1 )
a89804f008cd45087c9507d1,What treatment did patient 10039997 undergo last since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY procedures_icd.charttime DESC LIMIT 1 )","SELECT treatment.treatment_name FROM treatment WHERE treatment.patient_id = 10039997 AND datetime(treatment.treatment_time) >= datetime(current_time,'-1 year') ORDER BY treatment.treatment_time DESC LIMIT 1"
15a83f8dbbf6d2243721a87b,"How many patients underwent single internal mammary-coronary artery bypass during the same month after the diagnosis with arthropathy, unspecified, lower leg, in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'arthropathy, unspecified, lower leg' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis LIKE '%arthropathy, unspecified, lower leg%' ) AS T1 JOIN ( SELECT subject_id, treatment_time FROM procedures WHERE treatment_name = 'single internal mammary-coronary artery bypass' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.treatment_time AND datetime(T1.diagnosis_time,'start of year') = datetime(T2.treatment_time,'start of year') ) AS T3 GROUP BY T3.subject_id HAVING T3.diagnosis_time < datetime(current_time, 'start of year', '-0 year') AND datetime(current_time, 'start of year', '-0 year') <= T3.diagnosis_time"
e57e3f80e3cc0a3b1a3c509c,How many patients in 2100 underwent radical excision of other lymph nodes within the same hospital visit after reopening of recent thoracotomy site?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reopening of recent thoracotomy site' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'radical excision of other lymph nodes' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject ) FROM ( SELECT T1.subject, T1.hadm_id, T2.charttime, T1.hadm_id AS hadm_id FROM ( SELECT admissions.subject, diagnoses.hadm_id, diagnoses.charttime, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'reopening of recent thoracotomy site' ) AS T1 JOIN ( SELECT admissions.subject, procedures.hadm_id, procedures.charttime, admissions.hadm_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.procedure = 'radical excision of other lymph nodes' ) AS T2 ON T1.subject = T2.subject WHERE T1.hadm_id = T2.hadm_id AND strftime('%Y',T1.charttime) = '2100' AND strftime('%Y',T2.charttime) = '2100"
24612cf5da1e8c7c6a9fca8f,Was the SaO2 of patient 10021487 ever greater than 97.0 on 12/12/2100?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 97.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-12'",12/12/2100: Did patient 10021487 have a SaO2 greater than 97.0?
4ee164f320c671cddad63aa1,How many people received a prescription for dextromethorphan-guaifenesin (sugar free) throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dextromethorphan-guaifenesin (sugar free)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patient.subject_id ) FROM patient WHERE patient.had_prescription_drug = 'dextromethorphan-guaifenesin (sugar free)' AND datetime(patient.prescription_date,'start of year') = datetime(current_time,'start of year','-0 year')"
dbc270289021529e6623ca58,How many patients were treated with closed [percutaneous] [needle] biopsy of kidney since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE procedure_name = 'closed [percutaneous] [needle] biopsy of kidney' AND strftime('%Y',procedures.charttime) >= '2100'"
1252ececdb40065ab2ab716c,"For patients who had bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach, what were the most frequent four microbiology tests carried out within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T3.test_name FROM ( SELECT T2.test_name, T1.subject_id, T1.chart_time FROM ( SELECT subject_id, chart_time FROM procedures WHERE open_access_procedure = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue' ) AS T1 JOIN ( SELECT subject_id, test_name, chart_time FROM microbiology ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T2.chart_time) BETWEEN datetime(T1.chart_time) AND datetime(T1.chart_time,'+2 month') ) AS T3 GROUP BY T3.test_name ORDER BY COUNT(*) DESC LIMIT 1"
c5d46b43685ecc76f23dd1be,Pull up the IDs of patients who were diagnosed with chronic systolic heart failure in this year.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic systolic heart failure' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT T1.subject_id FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT * FROM diagnoses WHERE diagnosis = 'chronic systolic heart failure' ) AS T1 JOIN ( SELECT * FROM patients WHERE age BETWEEN 18 AND 60 ) AS T2 ON T1.subject_id = T2.subject_id ) AS T3 WHERE T3.diagnosis_time eqls T1.diagnosis_time AND datetime(T1.diagnosis_time,'start of year') = datetime(current_time,'start of year','-0 year')"
6726244ef1bd924f703f788d,What was the name of the drug which was prescribed to patient 10018501 within the same hospital visit after having received alcohol detoxification in 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedures.chart_id, procedures.start_time, procedures.patient_id FROM procedures WHERE procedures.patient_id = 10018501 AND procedures.procedure = 'alcohol detoxification' AND strftime('%Y-%m',procedures.start_time) = '2100-08' ) AS T1 JOIN ( SELECT prescriptions.chart_id, prescriptions.drug, prescriptions.start_time, prescriptions.patient_id FROM prescriptions WHERE prescriptions.patient_id = 10018501 AND strftime('%Y-%m',prescriptions.start_time) = '2100-08' ) AS T2 ON T1.chart_id = T2.chart_id WHERE T1.start_time < T2.start_time AND T1.patient_id = T2.patient_id"
1baa3b9b6dd6b0bd2c74ac95,How much is the total hospital cost of patient 10020187 during the stay in 2100?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND strftime('%Y',cost.chargetime) = '2100'","SELECT SUM(total_cost) FROM ( SELECT total_cost FROM ( SELECT cost FROM cost_table WHERE cost_table.product_id IN ( SELECT product_id FROM medication_table WHERE medication_table.name = 'd5 1/2ns' ) ) AS T1 JOIN prescription_table ON T1.product_id = prescription_table.product_id ) AS T2 JOIN patient_table ON T2.patient_id = patient_table.patient_id WHERE patient_table.patient_id = 10020187 AND strftime('%Y',prescription_table.start_time) = '2100'"
2b5707d23faf1d54bc3688c3,"On their first hospital visit, what was the age of patient 10022880?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.age FROM patients WHERE patients.id = 10022880 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1
6affdda52b5c91cdefb3ac90,Is patient 10027602's free calcium second measured on the last hospital visit less than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10027602 AND lab_tests.label = 'free calcium' AND lab_tests.charttime = ( SELECT lab_tests.charttime FROM lab_tests WHERE lab_tests.patient_id = 10027602 AND lab_tests.label = 'free calcium' AND lab_tests.charttime = ( SELECT lab_tests.charttime FROM lab_tests WHERE lab_tests.patient_id = 10027602 AND lab_tests.dischtime = ( SELECT admissions.dischtime FROM admissions WHERE admissions.subject = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY lab_tests.charttime ASC LIMIT 1 ) ) < ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10027602 AND lab_tests.label = 'free calcium' AND lab_tests.charttime = ( SELECT lab_
71fb7280916537b48dea629f,How many times was patient 10020786 admitted to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10020786 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(*) FROM hospital_admissions WHERE admissions.subject_id = 10020786 AND strftime('%Y',admissions.admission_date) >= '2100'"
59b3e090a55110929fc25079,Provide me with the five most common diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",SELECT T1.diagnosis FROM diagnoses AS T1 JOIN patient_diagnoses AS T2 ON T1.diagnosis_id = T2.diagnosis_id GROUP BY T2.diagnosis_id ORDER BY COUNT(*) DESC LIMIT 5
4e79db3380f81126bc756ee5,What is the difference between mchc second measured on the last hospital visit compared to the first value measured on the last hospital visit for patient 10007928?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND lab_results.spec_type_desc = 'mchc' ORDER BY lab_results.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND lab_results.spec_type_desc = 'mchc' ORDER BY lab_results.charttime ASC LIMIT 1 )
5706937d471c979d44b7c441,Calculate the number of patients who were prescribed senna.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'senna' ),SELECT COUNT( DISTINCT patient_id ) FROM prescriptions WHERE prescription_name = 'senna'
8389d7126b22d44dfa24365b,Has patient 10037928 received a diagnosis in 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'",10037928 has received a diagnosis in 2100?
0b01e88a1ff2627ccad33628,What is the number of times patient 10014729 visited the hospital in 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10014729 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(*) FROM hospital_history WHERE hospital_history.patient_id = 10014729 AND strftime('%Y', hospital_history.admittime) = '2100'"
a999623358b249c2ff668390,How many current patients are there aged 60 or above?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE age >= 60
20c3ddd36c65c44890c3f3e5,What was the name of the specimen test that patient 10021666 was given for the first time since 03/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1",10021666 has received a specimen test since 03/2100.
7edc30d3b6fa3b7308ebcd4a,How many medications were ordered for patient 10021118 since 10/2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'","SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10021118 AND strftime('%Y-%m', medications.order_time) >= '2100-10'"
ce4170ef70617d0f660eb8c8,Can you show me the top four most frequent lab tests given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents AS T1 JOIN ( SELECT diagnoses.diagnosis_id, procedures.procedure_id FROM diagnoses JOIN procedures ON diagnoses.diagnosis_id = procedures.diagnosis_id ) AS T2 ON T1.diagnosis_id = T2.diagnosis_id OR T1.procedure_id = T2.procedure_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4"
8a081d0fa8a2b464096d8a00,What is the total or cell saver intake amount that patient 10009628 received on 10/02/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '10-02'","SELECT SUM(input_amount) FROM intake_log WHERE patient_id = 10009628 AND input_type_id = 5 AND datetime(log_time,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',log_time) = '10-02'"
694ef79b1e8ab1b548efa5b3,Has patient 10018423 received any lab testing in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y',labevents.charttime) = '2100'",10018423 has received lab testing in 2100
d69a4b8b51374de9e093dde2,How many hours have passed since patient 10004733 stayed in the careunit medicine on this hospital visit for the first time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', patient.last_careunit_visit) ) FROM patient WHERE patient.subject_id = 10004733 AND patient.current_careunit = 'medicine' AND patient.hospital_dischtime IS NULL ORDER BY patient.last_careunit_visit DESC LIMIT 1"
5b35d8420b2779eaf3c7e3ea,List the top four most frequent diagnoses that patients received within 2 months after previously being diagnosed with other candidiasis of other specified sites since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other candidiasis of other specified sites' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.chart_time FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE diagnoses.diagnosis = 'other candidiasis of other specified sites' AND datetime(diagnoses.chart_time) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT patient.subject_id, diagnoses.diagnosis, diagnoses.chart_time FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE datetime(diagnoses.chart_time) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T2.chart_time) BETWEEN datetime(T1.chart_time) AND datetime(T1.chart_time,'+2 month') GROUP BY T2.diagnosis )"
a5356c6c205e9f088964bb9a,Has patient 10006580 received any medication?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ),SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.patient_id = 10006580
706439ddb58cfc688a427d97,"This year, what were the top four specimens that were tested frequently?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT T1.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM ( SELECT T1.spec_type_desc, T1.tube_id FROM ( SELECT T1.subject_id, T1.spec_type_desc, T1.tube_id FROM microbiology_events T1 JOIN ( SELECT T2.spec_type_desc, T2.tube_id FROM microbiology_events T2 GROUP BY T2.spec_type_desc ) T2 ON T1.spec_type_desc = T2.spec_type_desc AND T1.tube_id = T2.tube_id ) AS T1 GROUP BY T1.spec_type_desc ) AS T2 WHERE C1 <= 4"
06b14b6b3b8637569dd435d9,Show me the top five diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT T1.diagnosis, T1.C1 FROM ( SELECT T2.diagnosis, PERCENT_RANK() OVER ( ORDER BY T2.C1 DESC ) AS C1 FROM ( SELECT diagnosis, 100.0 * ( COUNT( DISTINCT patients.dod ) ) / COUNT( DISTINCT patients.subject_id ) AS C1 FROM patients JOIN diagnoses ON patients.subject_id = diagnoses.subject_id GROUP BY diagnosis ) AS T2 ) AS T1 WHERE T1.C1 <= 5"
6d23077db7dbc8321431bf64,How many days have passed since the patient 10004733 was admitted to the hospital?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.subject = 10004733 AND transfers.intime >= '2022-03-01 00:00:00' ORDER BY transfers.intime ASC LIMIT 1"
68e2938f96286a982888a1f6,"Which was the last care unit patient 10007928 was in during their last hospital visit, as per the transfer record?",SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1,SELECT transfers.care_unit FROM transfers WHERE transfers.subject_id = 10007928 AND transfers.in_time IN ( SELECT MIN(in_time) FROM transfers WHERE transfers.subject_id = 10007928 AND transfers.care_unit IS NOT NULL )
7f71c9d84ae065b57a659660,How many current patients are there aged 40s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE age BETWEEN 40 AND 49
0d71c66d0ead111e4df731dd,How much is the maximum total hospital bill that includes personal history of malignant neoplasm of large intestine since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM(C1) AS C1 FROM ( SELECT C1 FROM diagnoses WHERE LOWER(HISTORY_OF) = 'personal history of malignant neoplasm of large intestine' ) AS T1 JOIN patients ON T1.PID = patients.PID WHERE strftime('%Y',C1) >= '2100' GROUP BY T1.PID ) AS T2"
fc9a1a57bacdb774ac5e8f68,What was the admission type for patient 10023117 during their first hospital visit?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10023117 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1",SELECT admission_type FROM ( SELECT * FROM hospital_history WHERE hospital_id = 10023117 AND visit_id = ( SELECT MIN(visit_id) FROM hospital_history WHERE hospital_id = 10023117 ) )
7f07c59357750ac2b84e5221,"What are the five frequently taken specimens for patients that received extirpation of matter from lung lingula, via natural or artificial opening endoscopic previously within 2 months?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from lung lingula, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, T1.attime FROM ( SELECT attime, subject_id FROM procedures WHERE procedures.procedure_name = 'extirpation of matter from lung lingula, via natural or artificial opening endoscopic' ) AS T1 JOIN ( SELECT subject_id, spec_type_desc FROM microbiology_events ) AS T2 ON T1.subject_id = T2.subject_id ) AS T3 WHERE T3.attime >= ( SELECT T2.attime FROM ( SELECT attime, subject_id FROM diagnoses WHERE diagnoses.diagnosis_name = 'other and unspecified hypercholesterolemia' ) AS T2 JOIN ( SELECT subject_id, spec_type_desc FROM microbiology_events ) AS T3 ON T2.subject_id = T3.subject_id WHERE T2.attime < T3.attime AND datetime(T3.attime) BETWEEN datetime(T2.attime) AND datetime(T2.attime,'+2 month') ) AND T3.spec_type_"
105c5b90ad1c402ff786e8bc,What's the cost of the drug known as ferrous sulfate (liquid)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)' ),SELECT DISTINCT cost FROM drugs WHERE drug_name = 'ferrous sulfate (liquid)'
60f1ca714f709dd6094e453e,What was the insurance that patient 10015931 had during the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.insurance FROM patients WHERE patient.subject_id = 10015931 AND patient.dischtime IS NOT NULL ORDER BY patient.admittime ASC LIMIT 1
1252e7fd85be60431814be4f,"What is the cost for a procedure of introduction of other therapeutic substance into peripheral artery, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach'"
89a0d1e183a1c2a585f69c0d,When did patient 10016742 last receive a diagnosis of non-st elevation (nstemi) myocardial infarction on the first hospital stay?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'non-st elevation (nstemi) myocardial infarction' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1,SELECT diagnosis.chart_time FROM diagnosis WHERE diagnosis.patient_id = 10016742 AND diagnosis.dischtime IS NOT NULL ORDER BY diagnosis.chart_time ASC LIMIT 1
0f76c11ee2ae038677e63102,"How many patients received a osmolality, measured test last year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, measured' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patient_id ) FROM tests WHERE test_name = 'osmolality, measured' AND datetime(tests.test_date,'start of year') = datetime(current_time,'start of year','-1 year')"
e7d00371c9b3a702661b3704,Did patient 10040025 have any kind of diagnosis last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM diagnoses WHERE diagnoses.patient_id = 10040025 AND datetime(diagnoses.diagnosis_time,'start of year') = datetime(current_time,'start of year','-1 year')"
681c6fc772c7eda308578ae6,What are the three most frequent drugs prescribed to female patients with an age of 20s within the same month after they were diagnosed with unspecified acquired hypothyroidism?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified acquired hypothyroidism' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age BETWEEN 20 AND 29 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.age, diagnosis.diagnosis_time FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'unspecified acquired hypothyroidism' ) AS T1 JOIN ( SELECT patient.patient_id, prescription.drug, prescription.start_time FROM prescription JOIN patient ON prescription.patient_id = patient.patient_id WHERE patient.gender = 'female' AND patient.age BETWEEN 20 AND 29 ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_time < T2.start_time AND DATETIME(T1.diagnosis_time,'start of month') = DATETIME(T2.start_time,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3"
09304caba4fd05450a56c2af,How much does a procedure called percutaneous abdominal drainage cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'percutaneous abdominal drainage'
9fc0ac6b29d8a361fd6e2512,How much does patient 10007058 change in SaO2 second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT lab_values.valuenum FROM lab_values WHERE lab_values.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND lab_values.spec_type_desc = 'o2 saturation pulseoxymetry' AND lab_values.charttime >= ( SELECT lab_values.charttime FROM lab_values WHERE lab_values.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND lab_values.spec_type_desc = 'o2 saturation pulseoxymetry' AND lab_values.charttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10007058 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY lab_values.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT lab_values.valuenum FROM lab_values WHERE lab_values.
3813f972b07ceee5031bb452,Did patient 10021666 receive a diagnosis during their last hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),10021666 in their last hospital visit received a diagnosis?
770cb760820f25921dc8ac4a,"How much does a thyroxine (t4), free lab test cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroxine (t4), free' ) )","SELECT DISTINCT cost FROM lab_tests WHERE lab_tests.test_name = 'thyroxine (t4), free'"
aeb4b3e5ce8038a370e1e7c1,Count the number of patients who underwent a microbiological mini-bal test since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'mini-bal' AND strftime('%Y',microbiologyevents.charttime) >= '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'mini-bal' AND strftime('%Y',microbiologyevents.charttime) >= '2100'"
f356b6267c56b07e1f3e3045,What was the last time that patient 10035185 had the minimum value of the systolic blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT systolic_bp_min FROM ( SELECT * FROM (systolic_blood_pressure) AS T1 JOIN (diastolic_blood_pressure) AS T2 ON T1.meas_time = T2.meas_time WHERE T1.patient_id = 10035185 ) WHERE systolic_bp_min = ( SELECT MIN(systolic_blood_pressure) FROM ( SELECT * FROM (systolic_blood_pressure) AS T1 JOIN (diastolic_blood_pressure) AS T2 ON T1.meas_time = T2.meas_time WHERE T1.patient_id = 10035185 ) )
5a67eba88dd963170a026d15,What was the dose of glipizide xl patient 10029484 was prescribed?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.drug = 'glipizide xl',SELECT SUM(dose_val_rx) FROM medication_events WHERE medication_events.patient_id = 10029484 AND medication_events.drug = 'glipizide xl'
915a29cc5d0d25f775a9230e,How many duloxetine prescription cases were there since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'duloxetine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM medications WHERE medications.name = 'duloxetine' AND datetime(medications.start_time) >= datetime(current_time,'-1 year')"
d04f4cfbfef7a7f69d8969eb,"What are the three most commonly prescribed drugs for patients who were diagnosed with personal history of tobacco use previously in the same month, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.patient_id WHERE diagnoses.diagnosis = 'personal history of tobacco use' AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT patient.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN patient ON prescriptions.patient_id = patient.patient_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3<|im"
612ad1a0d94b49abf371be2f,"How often was the bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach procedure carried out since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.procedure_name = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' AND strftime('%Y',procedures.procedure_date) >= '2100'"
b4dc074ecd304bf634371924,What are the five most frequently prescribed medications for patients in their 40s since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.age FROM patient WHERE patient.age BETWEEN 40 AND 49 ) AS T1 JOIN prescriptions ON T1.prescription_id = prescriptions.prescription_id WHERE T1.age BETWEEN 40 AND 49 AND strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY T1.drug ) AS T1 WHERE T1.C1 <= 5"
14c735141eaad27a37dfacce,Has any lab tests occurred for patient 10026406 since 01/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'","SELECT COUNT(*)>0 FROM lab_tests WHERE lab_tests.patient_id = 10026406 AND strftime('%Y-%m',lab_tests.charttime) >= '2100-01'"
facfb8f560238eb16739c85e,Did patient 10015860 receive a lymphocytes test on their first hospital visit?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*)>0 FROM lab_test WHERE lab_test.patient_id = 10015860 AND lab_test.label = 'lymphocytes' AND lab_test.charttime >= ( SELECT lab_test.charttime FROM lab_test WHERE lab_test.patient_id = 10015860 AND lab_test.label = 'hematocrit' AND lab_test.charttime IS NOT NULL ORDER BY lab_test.charttime ASC LIMIT 1 )
bdd039b89d9bf57a1d3c4e49,"What are the three most common microbiology tests for people who were diagnosed with malignant neoplasm of lower third of esophagus earlier in the same hospital encounter, since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower third of esophagus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'malignant neoplasm of lower third of esophagus' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiology.test_name, microbiology.charttime, admissions.admission_id FROM microbiology JOIN admissions ON microbiology.admission_id = admissions.admission_id WHERE strftime('%Y',microbiology.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.admission_id = T2.admission"
b2e898b5d1ad3e826001b202,"In 03/this year, what organism was found in patient 10029291's last stool test?","SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '03' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT organism FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiology_events.spec_type_desc = 'stool' AND microbiology_events.org_name IS NOT NULL AND datetime(microbiology_events.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiology_events.charttime) = '03' ORDER BY microbiology_events.charttime DESC LIMIT 1"
99499e3fc35e16828a79d7f6,"How many patients received omeprazole within 2 months after the confirmation of ""personal history of tobacco use"" in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'omeprazole' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT(DISTINCT t1.subject_id) FROM ( SELECT subject_id, last_diagnosis FROM ( SELECT subject_id, diagnosis, (diagnosis_id >= ( SELECT id FROM diagnoses WHERE diagnosis = 'personal history of tobacco use' )) ) as t1 JOIN ( SELECT subject_id, prescription_date FROM prescriptions WHERE prescription_date BETWEEN '2100-01-01' AND '2100-12-31' AND drug = 'omeprazole' ) as t2 ON t1.subject_id = t2.subject_id WHERE t1.last_diagnosis = 'personal history of tobacco use' GROUP BY t1.subject_id HAVING CURRENT_TIMESTAMP - MAX(t1.last_diagnosis) < 2 MONTH"
e1bef8005f669f8fa7a1e3bf,What are the most commonly prescribed drugs given to patient 10021312 twice?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 = 2","SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.start_time ) as num FROM prescriptions WHERE prescriptions.patient_id = 10021312 GROUP BY prescriptions.drug ) as T1 WHERE T1.num >= 2"
2e3384d7ef9a76c0237df519,Tell me patient 10026354's first measured heart rate.,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(heart_rate) FROM ( SELECT heart_rate FROM procedures WHERE patient_id = 10026354 )
1bdf02ef77df577cf44deaee,"Since 2100, how many patients were discharged from the hospital?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE procedure_name = 'discharge from hospital' AND year >= 2100
f195f5a0d57e12581afdc61c,When did patient 10004457 first get discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004457 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patient.dischtime FROM patient WHERE patient.subject = 10004457 ORDER BY patient.dischtime ASC LIMIT 1
2f8aa4c9687c9ee0880c3746,"Since 1 year ago, what are the top four most commonly taken specimens for patients within 2 months after the diagnosis of encounter for immunization?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for immunization' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis_desc = 'encounter for immunization' AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime FROM specimens JOIN admissions ON specimens.admission_id = admissions.admission_id WHERE datetime(specimens.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"
fd9b2daa83ce099cdf252c35,Has there been any procedure that patient 10022880 had in this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10022880 AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year')"
515f28b68da1d15cb0208181,Please list the five most common procedures carried out since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.long_title FROM procedures AS T1 JOIN ( SELECT T2.procedure_id FROM ( SELECT procedure_id, COUNT(patient_id) AS C1 FROM procedures AS T2 WHERE datetime(T2.start_time) >= datetime(current_time,'-1 year') GROUP BY procedure_id ) AS T3 WHERE C1 > 5 ) AS T4 JOIN procedures AS T5 ON T4.procedure_id = T5.procedure_id"
b710f2ea6d630a9c88a40fc2,What was the name of the prescription drug that patient 10017492 was prescribed last in 04/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10017492 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1"
9a53c5a84a90577e106b30ec,"In the first hospital visit, what was patient 10016150's last procedure time?",SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime DESC LIMIT 1,SELECT procedures.charttime FROM procedures WHERE procedures.patient_id = 10016150 AND procedures.charttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures.charttime DESC LIMIT 1
536ad0999a00344e2a06c8a9,How much was patient 10013049 charged to pay for the cost of their hospital stay during the first hospital visit?,SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),"SELECT SUM(total_cost) FROM ( SELECT total_cost FROM ( SELECT diagnosis_cost, patient_id, cost_type_id FROM diagnoses WHERE patient_id = 10013049 AND visit_id = 1 ) AS T1 JOIN cost_types ON T1.cost_type_id = cost_types.cost_type_id ) AS T2"
b71bf47188930e8abb1e562f,When was patient 10036156's last procedure conducted in this year?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.start_time FROM procedures WHERE procedures.patient_id = 10036156 AND datetime(procedures.start_time,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures.start_time DESC LIMIT 1"
c47c43f5d2824c6b2c4f54fe,List the top five most frequent procedures performed since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.long_title FROM procedures AS T1 JOIN ( SELECT T2.procedure_id FROM ( SELECT procedure_id, COUNT(patient_id) AS C1 FROM procedures AS T2 JOIN ( SELECT patient_id, procedure_id FROM procedures_icd10 WHERE icd10_id IN ( SELECT icd10_id FROM procedures_icd10 WHERE long_title IN ( 'other specified procedures not elsewhere classified' ) ) ) T2 GROUP BY procedure_id ) AS T3 ORDER BY C1 DESC LIMIT 5 ) AS T4 JOIN procedures AS T5 ON T4.procedure_id = T5.procedure_id"
92448b3c2bb324d7cc5a35f9,"Show me the top five most commonly prescribed drugs within 2 months for patients in their 60 or above after a thrombocytopenia, unspecified diagnosis since 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'thrombocytopenia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM diagnoses WHERE diagnosis = 'thrombocytopenia, unspecified' ) AS T1 JOIN ( SELECT subject_id, prescriptions.drug FROM prescriptions ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+interval '2 month') AND T1.subject_id IN ( SELECT T4.subject_id FROM ( SELECT subject_id, charttime FROM diagnoses WHERE diagnosis = 'thrombocytopenia, unspecified' ) AS T3 GROUP BY T3.subject_id HAVING MIN(datetime(T3.charttime)) = datetime(T3.charttime,'-2 month') AND MAX(datetime(T"
503c1a271385c7a9c485a82a,Can you tell me the top four most common procedures since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.long_title FROM procedures AS T1 JOIN ( SELECT T2.procedure_id FROM ( SELECT procedure_id, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures AS T2 JOIN ( SELECT patient_id, procedure_id FROM procedures_icd10 ) AS T3 ON T2.procedure_id = T3.procedure_id WHERE datetime(T2.start_time) >= datetime(current_time,'-1 year') GROUP BY T2.procedure_id ) AS T4 WHERE T4.C1 <= 4 ) AS T5 ON T5.procedure_id = T1.procedure_id"
c511f734e9fd03e177de1e9c,Was any sputum microbiology test done to patient 10026255 on their last hospital visit?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum',SELECT COUNT(*)>0 FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiology_events.spec_type_desc = 'sputum'
ac0594e7c1c0b61c1072e703,What were the top five most common output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.output_event_id FROM ( SELECT T2.output_event_id, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.patient_id, T1.output_event_id FROM ( SELECT T1.patient_id, T1.output_event_id FROM output_events T1 JOIN ( SELECT T2.patient_id, T2.output_event_id FROM output_events T2 WHERE T2.year >= 2100 ) AS T2 ON T1.patient_id = T2.patient_id ) AS T1 GROUP BY T1.output_event_id ) AS T2 WHERE T2.C1 <= 5"
4779807de491caeb560e846d,Can you tell me the top five most common microbiology tests that occurred in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM microbiology AS T1 JOIN ( SELECT T2.subject_id, T2.charttime FROM procedures AS T2 WHERE T2.year = 2100 ) AS T3 ON T1.subject_id = T3.subject_id AND T1.charttime = T3.charttime ) AS T2 GROUP BY T2.test_name ) AS T1 WHERE T1.C1 <= 5"
809a2e5b92679e748ad8312c,"What was the maximum monthly number of patients diagnosed with surgical operation with implant of artificial internal device as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure in 2100?","SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'surgical operation with implant of artificial internal device as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT COUNT(DISTINCT diagnosis_of_last_month) AS C1 FROM diagnoses WHERE diagnosis_of_last_month = 'surgical operation with implant of artificial internal device as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' AND strftime('%Y',diagnoses.diagnosis_time) = '2100' GROUP BY strftime('%Y-%m',diagnoses.diagnosis_time) ) AS T1"
5da6b605b949e3c4c068537e,When did patient 10039831 first receive a mrsa screen microbiological test in 12/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiology.charttime FROM microbiology WHERE microbiology.patient = 10039831 AND microbiology.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiology.charttime) = '2100-12' ORDER BY microbiology.charttime ASC LIMIT 1"
727aea1d64b5ba869e4b3dc8,What was the total dose of bisacodyl that patient 10025463 has been prescribed in their first hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'bisacodyl',SELECT SUM(prescription_details.dose_val_rx) FROM prescription_details WHERE prescription_details.patient_id = 10025463 AND prescription_details.drug = 'bisacodyl' AND prescription_details.start_time BETWEEN ( SELECT MIN(start_time) FROM prescription_details WHERE prescription_details.patient_id = 10025463 AND prescription_details.drug = 'bisacodyl' AND prescription_details.start_time IS NOT NULL ) AND ( SELECT MAX(start_time) FROM prescription_details WHERE prescription_details.patient_id = 10025463 AND prescription_details.drug = 'bisacodyl' AND prescription_details.start_time IS NOT NULL )
82ee3d9b301ac0cf74fc8be8,Could you tell me the marital status of patient 10006580 during their first hospital visit?,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT marital_status FROM patients WHERE patient_id = 10006580 AND hospital_id = 1 ORDER BY hospital_admission_date ASC LIMIT 1
97f99846bf73b8acd7a1318e,How many medicines were prescribed since 4 months ago to patient 10014354?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-4 month')","SELECT COUNT(*) FROM medicines WHERE medicines.patient_id = 10014354 AND datetime(medicines.starttime) >= datetime(current_time,'-4 month')"
c2ca78801b0bb755ec80903e,"Which care unit did patient 10004235 last enter since 2100, as recorded in the transfer record?","SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND transfers.careunit IS NOT NULL AND strftime('%Y',transfers.intime) >= '2100' ORDER BY transfers.intime DESC LIMIT 1","SELECT trans.careunit FROM ( SELECT trans.hadm, trans.intime, trans.careunit FROM ( SELECT adm.hadm, adm.intime, care.careunit FROM ( SELECT adm.hadm, dt.intime, care.careunit FROM ( SELECT adm.hadm, ( SELECT data.valuenum FROM ( SELECT value.valuenum FROM ( SELECT * FROM ( SELECT * FROM diagnosis_labels WHERE label = 'unspecified place in hospital' ) ) ) AS value JOIN adm ON value.hadm = adm.hadm ) ) AS diagnoses JOIN adm ON diagnoses.hadm = adm.hadm ) AS trans WHERE trans.intime < datetime('2100-01-01 00:00:00') AND trans.hadm = 10004235 ) AS trans WHERE trans.intime >= datetime('2100-01-01 00:00:00') ORDER BY trans.intime DESC LIMIT 1"
c31c4e310562d4a9cc9837f1,Could you tell me how many patients were given phytonadione last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phytonadione' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )",SELECT COUNT( DISTINCT patient_id ) FROM medications WHERE medication_name = 'phytonadione' AND year = 2100
7d5fe035bb44c9237b17dfe5,"Was patient 10031757 prescribed on their first hospital visit heparin flush (10 units/ml), enoxaparin sodium, or vancomycin?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'heparin flush (10 units/ml)', 'enoxaparin sodium', 'vancomycin' )",1. heparin flush (10 units/ml)<br>2. enoxaparin sodium<br>3. vancomycin
350a9469b2c148343a897fc7,Tell me the top four most common diagnoses for patients with age 30s since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.diagnosis FROM ( SELECT diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM ( SELECT patient_id FROM patients WHERE age BETWEEN 30 AND 39 ) AS T1 JOIN ( SELECT patient_id, diagnosis FROM diagnoses WHERE strftime('%Y',diagnosis_time) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY diagnosis ) AS T1 WHERE C1 <= 4"
4b635ac1325eaf0dd75988d5,"In 04/last year, has patient 10001725 been prescribed with pantoprazole, albuterol 0.083% neb soln, or propranolol?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND prescriptions.drug IN ( 'pantoprazole', 'albuterol 0.083% neb soln', 'propranolol' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.patient_id = 10001725 AND prescriptions.drug IN ('pantoprazole', 'albuterol 0.083% neb soln', 'propranolol') AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'"
81eff335d1116d8fed074540,Give me the top three most common diagnoses for patients of age 60 or above since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.diagnosis FROM ( SELECT diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM ( SELECT patient_id FROM procedures WHERE age >= 60 ) AS T1 JOIN ( SELECT patient_id, diagnosis FROM diagnoses WHERE age >= 60 ) AS T2 ON T1.patient_id = T2.patient_id ) AS T3 WHERE T3.C1 <= 3"
b33541a90c84005891412b3c,What is the count of prescriptions for guaifenesin since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' AND strftime('%Y',prescriptions.starttime) >= '2100'"
c996bd83ae8f43a3717a6f64,"How many times did patient 10002495 have irrigation of genitourinary tract using irrigating substance, via natural or artificial opening since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'irrigation of genitourinary tract using irrigating substance, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10002495 AND procedures.procedure_name = 'irrigation of genitourinary tract using irrigating substance, via natural or artificial opening' AND strftime('%Y',procedures.procedure_date) >= '2100'"
71b23a88bad2ea2f52f12b02,"Among patients who were prescribed with phenytoin infatab, what are the top five most frequently prescribed drugs at the same time in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phenytoin infatab' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM prescriptions WHERE drug = 'phenytoin infatab' ) AS T1 JOIN ( SELECT subject_id, charttime FROM prescriptions WHERE drug = 'topiramate' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND strftime('%Y',T1.charttime) = '2100' ) AS T3 WHERE T3.C1 <= 5"
b05a0cc27584db59d2dc4a8b,What was the length of stay in days for patient 10020944's last hospitalization?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","SELECT strftime('%J',patients.dischtime) - strftime('%J',patients.admittime) FROM patients WHERE patients.subject_id = 10020944 AND strftime('%Y',patients.admittime) = 2100 ORDER BY patients.admittime DESC LIMIT 1"
55712c5df13d0dbf402229f5,What were the first outputs of patient 10019917 since 01/19/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT strftime(output.charttime, '%Y-%m-%d %H:%M:%S') as charttime, output.outputtext
         FROM ( SELECT * FROM (SELECT * FROM patient_10019917.output WHERE patient_10019917.age >= 18) AS t1 ORDER BY t1.charttime ASC LIMIT 1 ) AS output"
7066a7025a2c0442a511c5e1,What was patient 10015272's first SaO2 since 203 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-203 day') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(SaO2) FROM ( SELECT SaO2 FROM procedures WHERE patient_id = 10015272 AND datetime(procedures.starttime) >= datetime(current_time,'-203 day') )"
3d5c7c8185dc079c5e416e14,What was the first time patient 10040025 had the minimum platelet count value in 03/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",SELECT MIN(C1.C1_PLATELET_COUNT) FROM ( SELECT C1_PLATELET_COUNT FROM lab_test WHERE C1_PATIENT_ID = 10040025 AND C1_CHEMICAL_FORMULA = 'platelet count' AND C1_TIME BETWEEN '2000-03-01 00:00:00' AND '2000-03-31 00:00:00' ) AS C1
04ca1a97c725954eac35669a,"When was the last time patient 10018501 was diagnosed with gout, unspecified?","SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gout, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT diagnoses.chart_time FROM diagnoses WHERE diagnoses.patient_id = 10018501 AND diagnoses.diagnosis = 'gout, unspecified' ORDER BY diagnoses.chart_time DESC LIMIT 1"
88a650d28643d60da24b7b3f,What was the last recorded height for patient 10006580 during the first hospital encounter?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT MIN(patient.height) FROM patient WHERE patient.patient_id = 10006580 AND patient.dischtime IS NOT NULL ORDER BY patient.admittime ASC
5984482bf8b3c03a9225ea58,What was the diagnosis of patient 10005866 for the first time on their last hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT diagnosis.long_title FROM diagnosis WHERE diagnosis.patient_id = 10005866 AND diagnosis.hospital_order = ( SELECT COUNT(d.hospital_order) FROM ( SELECT patient.hospital_order FROM patient WHERE patient.patient_id = 10005866 AND patient.current_dischtime IS NOT NULL ORDER BY patient.hospital_order DESC LIMIT 1 ) AS d )
eefb26cc5bd74a549f823166,What is the monthly minimum volume of void that patient 10014354 had since 10/06/2100?,"SELECT MIN(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-06' GROUP BY strftime('%Y-%m',outputevents.charttime)","SELECT MIN(volume) FROM ( SELECT volume FROM procedures WHERE patient_id = 10014354 AND procedure_time >= '2100-10-06' GROUP BY patient_id, procedure_time UNION SELECT volume FROM outputevents WHERE patient_id = 10014354 AND output_time >= '2100-10-06' GROUP BY patient_id, output_time ) AS T"
4fee25cd21a51a255f3f5bcf,What is the name of the prescription drug that patient 10037861 has been given two or more times since 8 months ago?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-8 month') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T1.drug FROM ( SELECT prescription_drug.drug, COUNT(prescription_drug.start_time) AS c1 FROM prescription_drug WHERE prescription_drug.patient_id = 10037861 AND datetime(prescription_drug.start_time) >= datetime(current_time,'-8 month') GROUP BY prescription_drug.drug ) AS T1 WHERE T1.c1 >= 2"
2c613ae6f06d69d93196637f,When was the first time patient 10027602 had attention deficit disorder with hyperactivity diagnosed on their first hospital encounter?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1,SELECT diagnosis_date FROM diagnoses WHERE diagnosis = 'attention deficit disorder with hyperactivity' AND patient_id = 10027602 AND encounter_id = ( SELECT encounters.id FROM encounters WHERE encounters.patient_id = 10027602 AND encounters.dischtime IS NOT NULL ORDER BY encounters.admittime ASC LIMIT 1 ) ORDER BY diagnosis_date ASC LIMIT 1
9aff84dfbc8d4cb85bb5267f,"How much does patient 10038999 change in calcium, total second measured on the last hospital visit compared to the first value measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )","SELECT ( SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND lab_results.label = 'calcium, total' AND lab_results.numtime = 2 ) - ( SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND lab_results.label = 'calcium, total' AND lab_results.numtime = 1 )"
888427e0689a6de5a4d37211,Give me the top four most common diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",SELECT T1.diagnosis FROM diagnoses AS T1 JOIN prescriptions AS T2 ON T1.diagnosis = T2.drug_name GROUP BY T1.diagnosis ORDER BY COUNT(*) DESC LIMIT 4
e6edc67f5259e8f507389a29,"How many patients received a total nucleated cells, pleural test in this year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, pleural' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patient_id ) FROM lab_tests WHERE lab_tests.test_name = 'total nucleated cells, pleural' AND datetime(lab_tests.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
919f039cb4f4fe92f49e7c86,How many current patients belong to the 30s age category?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE age BETWEEN 30 AND 39
5287cbacaf23b703a8551d1c,"For patients who received a encephalopathy, unspecified diagnosis in 2100, which five medications were usually prescribed afterward in the same month?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encephalopathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T1.drug FROM ( SELECT prescriptions.drug, monthname(prescriptions.starttime) as start_month FROM prescriptions WHERE prescriptions.drug = 'encephalopathy, unspecified' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T1 JOIN ( SELECT prescriptions.drug, monthname(prescriptions.starttime) as start_month FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.drug = T2.drug AND T1.start_month = T2.start_month"
15b4990f761db52edf38273c,How many days have passed since the last time that patient 10021487 had received a hemoglobin lab test during the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', lab_test.charttime) ) FROM lab_test WHERE lab_test.patient = 10021487 AND lab_test.label = 'hemoglobin' AND lab_test.charttime >= ( SELECT lab_test2.charttime FROM lab_test as lab_test2 WHERE lab_test2.patient = 10021487 AND lab_test2.label = 'hemoglobin' ORDER BY lab_test2.charttime DESC LIMIT 1 )"
30cdb06c3381ee1320dc4738,"What is the maximum hospital cost for the hospital visits that included scoliosis [and kyphoscoliosis], idiopathic?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'scoliosis [and kyphoscoliosis], idiopathic' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.event_type = 'diagnosis' AND cost.event_id IN ( SELECT diagnosis.event_id FROM diagnosis WHERE diagnosis.diagnosis = 'scoliosis [and kyphoscoliosis], idiopathic' ) GROUP BY cost.event_id ) AS T1"
7af6a3a42f264bdbbfb7c37a,Is the value of diastolic blood pressure of patient 10018081 measured at 2100-12-31 23:00:00 greater than it is measured at 2100-12-31 22:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-31 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-31 22:00:00' ),SELECT ( SELECT diastolic blood pressure FROM measurements WHERE measurements.patient_id = 10018081 AND measurements.measurement_time = '2100-12-31 23:00:00' ) > ( SELECT diastolic blood pressure FROM measurements WHERE measurements.patient_id = 10018081 AND measurements.measurement_time = '2100-12-31 22:00:00' )
dfc058cc8e8d30a29c0177b9,"After being diagnosed with thrombocytopenia, unspecified , how many patients received a diagnosis of chronic airway obstruction, not elsewhere classified during the same hospital visit?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'thrombocytopenia, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic airway obstruction, not elsewhere classified' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time, T2.diagnosis FROM ( SELECT subject_id, diagnosis_time, diagnosis FROM diagnoses WHERE diagnosis = 'thrombocytopenia, unspecified' ) AS T1 JOIN ( SELECT subject_id, diagnosis_time, diagnosis FROM diagnoses WHERE diagnosis = 'chronic airway obstruction, not elsewhere classified' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND T1.subject_id = T2.subject_id ) AS T1 JOIN ( SELECT subject_id, diagnosis_time, diagnosis FROM diagnoses WHERE diagnosis = 'chronic airway obstruction, not elsewhere classified' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND T1.subject_id = T2.subject_id
        <|im_end|"
eeabf0257400d59cb3803434,Count the number of patients that were admitted to the hospital in this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')",SELECT COUNT( DISTINCT patient_id ) FROM hospital_admissions WHERE admission_year = 2100
9b70f7f7a60a0c7994cc0ea0,List the top five most common diagnoses for patients in their 20s throughout this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.diagnosis FROM ( SELECT diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM patients WHERE patients.age BETWEEN 20 AND 29 AND datetime(patients.admittime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnosis ) as T1 WHERE T1.C1 <= 5"
3dcbbb6159d03af90b56b98f,"What are the top five most frequent medications prescribed within 2 months to the patients in their 50s after they were diagnosed with cerebral artery occlusion, unspecified with cerebral infarction this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral artery occlusion, unspecified with cerebral infarction' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.patient_id WHERE diagnoses.diagnosis = 'cerebral artery occlusion, unspecified with cerebral infarction' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN patient ON prescriptions.patient_id = patient.patient_id WHERE patient.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2"
826d1ec55b9cb1dcd3714ce0,What's the minimum total hospital charged for a visit with a white blood cells lab test since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(T2.C2) AS C1 FROM ( SELECT T1.C1 FROM ( SELECT diagnoses.C1 FROM diagnoses WHERE diagnoses.C1 = 'white blood cells' ) AS T1 JOIN ( SELECT procedures.C2 FROM procedures WHERE procedures.C2 = 'drainage of pericardial cavity' ) AS T2 ON T1.C1 = T2.C1 ) AS T1 JOIN ( SELECT prescriptions.C2 FROM prescriptions WHERE prescriptions.C2 = 'insulin' ) AS T2 ON T1.C1 = T2.C1 ) AS T1 JOIN ( SELECT labevents.C1 FROM labevents WHERE labevents.C1 = 'white blood cells' ) AS T2 ON T1.C1 = T2.C1 WHERE T1.C3 = 'yes' AND datetime(T1.C1) >= datetime(current_time,'-1 year') GROUP BY T1.C1 ) AS T1 JOIN ( SELECT prescriptions.C2 FROM prescriptions WHERE prescriptions.C2 = 'insul"
6938557cc42ba52caf388bef,Calculate the aggregate sum for patient 10005909's input since 02/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-12'",SELECT SUM(input_amount) FROM ( SELECT input_amount FROM medication_input WHERE patient_id = 10005909 AND input_time >= '2100-02-12' ) subquery
61a3d12ba8e762f3b53709cd,What were the top five microbiology tests most frequently performed since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT procedures.charttime FROM procedures WHERE procedures.charttime >= '2100-01-01' ) AS T1 JOIN microbiology ON T1.charttime = microbiology.charttime ) AS T2 GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5"
70d14dce56962dcc9931c667,What are the methods for ingesting phenytoin sodium?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'phenytoin sodium',SELECT DISTINCT prescription_method FROM medications WHERE medication_name = 'phenytoin sodium'
ee8306d4a542175197a6d200,What was the maximum value for patient 10009049's specific gravity?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ),SELECT MAX(lab_result) FROM lab_events WHERE lab_event_type = 'specific gravity' AND patient_id = 10009049
844c677f9eb40b4cc09e828a,How many times did patient 10001217 check into the ICU?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ),SELECT COUNT(*) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 )
f8c059d6d1b2b47b1fe1c76d,Retrieve the top five most frequently prescribed drugs since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5"
817d23cea9de1a0e459a25c3,"How much is a bilirubin, indirect lab test?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, indirect' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'bilirubin, indirect'"
672d81cda5b780896726e4f2,When was patient 10015860's respiratory rate less than 21.0 for the first time since 06/06/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-06' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT strftime('%Y-%m-%d %H:%M:%S', resp_time) FROM ( SELECT patient_id, current_time - last_resp_time AS resp_time FROM ( SELECT patient_id, current_time FROM ( SELECT patient_id, respiratory_rate_cmhc_last AS current_time FROM ( SELECT patient_id, respiratory_rate_cmhc_last AS resp_time FROM patient_observations WHERE patient_id = 10015860 ) ) ) ) WHERE respiratory_rate_cmhc_last < 21.0 AND strftime('%Y-%m-%d',resp_time) >= '2100-06-06' )"
2b7276378eab1b3d2a5dbc38,How much total input has patient 10014354 received in the last ICU stay?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ),SELECT SUM(input_total) FROM icu_inputs WHERE icu_id IN ( SELECT icu_id FROM icu_history WHERE patient_id = 10014354 AND stay_length > 0 ORDER BY stay_start_time DESC LIMIT 1 )
af50a318710cad0b74d80aa6,"What is the average total hospital cost when it involves diastolic heart failure, unspecified in 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diastolic heart failure, unspecified' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM(T1.C1) AS C1 FROM ( SELECT T1.ROW_NUMBER() OVER ( ORDER BY T1.C1 DESC ) AS C1 FROM ( SELECT T1.MEMBER_ID, T2.C1 FROM ( SELECT T1.MEMBER_ID, ( T2.BLADDER CANCER/CHLDRN H 0 I D C T G I S T S ) / ( T2.SAMPLE C1CE ) AS C1 FROM ( SELECT T1.MEMBER_ID, T2.C1 FROM ( SELECT T1.MEMBER_ID, T2.C1 FROM diagnoses AS T1 JOIN ( SELECT MEMBER_ID, 0 AS C1 FROM diagnoses WHERE diagnosis_time BETWEEN '2100-01-01' AND '2100-12-31' ) AS T2 ON T1.MEMBER_ID = T2.MEMBER_ID WHERE T1.diagnosis_time BETWEEN '2100-01"
d00ed2cfc1975f9b13bcf1f9,What diagnoses were the latest recorded for patient 10015860?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnoses.diagnosis_name FROM diagnoses WHERE diagnoses.patient_id = 10015860 ORDER BY diagnoses.chart_time DESC LIMIT 1
0c4dd3081cb0d0d1bacad045,What was the total hospital cost for patient 10025612's stay on their last hospital visit?,SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT SUM(total_cost) FROM ( SELECT total_cost FROM ( SELECT diagnosis_cost FROM diagnosis WHERE diagnosis.diagnosis_name = 'other and unspecified hypercholesterolemia' ) AS T1 JOIN ( SELECT procedure_cost FROM procedure WHERE procedure.procedure_name = 'other and unspecified hypercholesterolemia' ) AS T2 ON T1.diagnosis_id = T2.diagnosis_id ) AS T3 WHERE T3.patient_id = 10025612 AND T3.hadm_id IN ( SELECT hadm_id FROM hospital WHERE hospital.name = 'other hospital' AND hospital.id <> ( SELECT hadm_id FROM patient WHERE patient.name = '10025612' AND patient.age < 21 ) ORDER BY hospital.admission_time DESC LIMIT 1 )
391ecf976f96659f09f26269,What's the price for lamotrigine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lamotrigine' ),SELECT DISTINCT cost FROM medications WHERE medication_name = 'lamotrigine'
20e38a034dc27e9626dfa8d9,"Which care unit did patient 10014078 first enter since 2100, based on the transfer record?","SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND transfers.careunit IS NOT NULL AND strftime('%Y',transfers.intime) >= '2100' ORDER BY transfers.intime ASC LIMIT 1","SELECT transfers.care_unit FROM ( SELECT * FROM transfers WHERE transfers.patient_id = 10014078 AND strftime('%Y',transfers.intime) >= '2100' ) AS transfers WHERE transfers.intime <= ( SELECT transfers.intime FROM transfers WHERE transfers.patient_id = 10014078 AND transfers.care_unit = 'med/surg/gyn' AND strftime('%Y',transfers.intime) >= '2100' ORDER BY transfers.intime ASC LIMIT 1 )"
48b62fcb80cf1fee53b8bfb1,What was the total volume of input that patient 10018081 received on this ICU visit?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ),SELECT SUM(input_total) FROM icu_inputs WHERE icu_id IN ( SELECT icu_id FROM icu_assignments WHERE patient_id = 10018081 AND icu_out_time IS NULL )
d2d7d8b52a277ffa44cfb072,Please tell me patient 10019777's sex.,SELECT patients.gender FROM patients WHERE patients.subject_id = 10019777,SELECT DISTINCT sex FROM patients WHERE patient_id = 10019777
f1ca5e6021ac2bbdb6b7e7bf,Is respiratory rate of patient 10000032 last measured on the first ICU visit greater than the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT lab_value FROM ( SELECT * FROM icu_visits WHERE icu_visits.icu_stay_id IN ( SELECT icu_stays.icu_stay_id FROM icu_stays WHERE icu_stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icu_stays.outtime IS NOT NULL ORDER BY icu_stays.intime ASC LIMIT 1 ) AS icu_values WHERE icu_values.item_id IN ( SELECT items.item_id FROM items WHERE items.label = 'respiratory rate' ) ORDER BY icu_values.charttime DESC LIMIT 1 ) > ( SELECT lab_value FROM ( SELECT * FROM icu_visits WHERE icu_visits.icu_stay_id IN ( SELECT icu_stays.icu_stay_id FROM icu_stays WHERE icu_stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id =
2dfc862bcecf1f1b2c037bc9,When did patient 10007818 receive a glucose laboratory test for the first time in 07/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07' ORDER BY labevents.charttime ASC LIMIT 1",SELECT lab_test_date FROM lab_tests WHERE lab_test_type = 'glucose' AND lab_test_date >= '2100-07-01' AND lab_test_date <= '2100-07-31' ORDER BY lab_test_date ASC LIMIT 1
d8c4bcdab05c48a114af4957,Calculate the total number of outputs from patient 10027602 since 06/22/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-22'","SELECT COUNT(*) FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT icd_codes.icd_code, (SELECT procedures.long_title FROM procedures WHERE procedures.short_title = icd_codes.long_title) AS long_title FROM icd_codes WHERE icd_codes.icd_code IN ( SELECT T2.icd_code FROM ( SELECT microbiologyevents.row_id FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND strftime('%Y-%m-%d',microbiologyevents.charttime) >= '2100-06-22' ) AS T1 )"
7c2a2d33722d9a5b379010ff,What new drugs have been prescribed to patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescription_today.drug FROM ( SELECT prescription_today.drug, prescription_today.starttime FROM prescription AS prescription_today WHERE prescription_today.patient = 10018081 ) AS today_prescriptions JOIN ( SELECT prescription_yesterday.drug, prescription_yesterday.starttime FROM prescription AS prescription_yesterday WHERE prescription_yesterday.patient = 10018081 ) AS yesterday_prescriptions ON today_prescriptions.drug = yesterday_prescriptions.drug WHERE today_prescriptions.starttime > yesterday_prescriptions.starttime"
1b49fcb3998703d3dd37e81e,"What is the average total cost of the hospital, which includes the procedure named other incision of pleura?",SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of pleura' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost_procedures(procedures.code)) AS C1 FROM procedures WHERE procedures.name = 'other incision of pleura' GROUP BY procedures.id ) AS T1
828f43dc5831cb08e5ce4ac8,When was patient 10015931 first prescribed a medication via the po/ng route since 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(prescription.starttime) FROM prescription WHERE prescription.patient = 10015931 AND prescription.route = 'po/ng' AND strftime('%Y-%m',prescription.starttime) >= '2100-07'"
3f3b727d5effabd567b64400,Give me the top four most commonly prescribed medications in the same month to the patients aged 50s after they were diagnosed with non-st elevation (nstemi) myocardial infarction throughout this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'non-st elevation (nstemi) myocardial infarction' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.age, diagnosis.diagnosis_time FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'non-st elevation (nstemi) myocardial infarction' AND datetime(diagnosis.diagnosis_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient.age, prescription.drug, prescription.prescription_time FROM prescription JOIN patient ON prescription.patient_id = patient.patient_id WHERE patient.age BETWEEN 50 AND 59 AND datetime(prescription.prescription_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.age = T2.age WHERE T1.diagnosis_time < T2.prescription_time AND datetime(T1.di"
8f037d1cedf499b333e3a25d,When was the first microbiological test of patient 10015931 performed during this month?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiology.chart_time FROM microbiology WHERE microbiology.patient_id = 10015931 AND datetime(microbiology.chart_time,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY microbiology.chart_time ASC LIMIT 1"
6d1e9f74415d70381cffcd18,Has patient 10021938 had a procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10021938 AND strftime('%Y',procedures.starttime) >= '2100'"
df9daf11c602ac48c88b8f7b,"Count the number of patients who had arterial catheterization in the same month after having been diagnosed with osteoarthrosis, localized, not specified whether primary or secondary, pelvic region and thigh in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'osteoarthrosis, localized, not specified whether primary or secondary, pelvic region and thigh' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT subject_id, diagnose_time FROM diagnoses WHERE diagnosis = 'osteoarthrosis, localized, not specified whether primary or secondary, pelvic region and thigh' AND strftime('%Y',diagnose_time) = '2100' ) AS T1 JOIN ( SELECT subject_id, procedure_time FROM procedures WHERE procedure_name = 'arterial catheterization' AND strftime('%Y',procedure_time) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnose_time < T2.procedure_time AND datetime(T1.diagnose_time,'start of month') = datetime(T2.procedure_time,'start of month')"
09963a1437aa17e27738f18a,What are the four most commonly received procedures for patients in their 30s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.long_title FROM procedures AS T1 JOIN patients AS T2 ON T1.patient_id = T2.subject_id WHERE T2.age BETWEEN 30 AND 39 AND datetime(T1.start_time) >= datetime(current_time,'-1 year') GROUP BY T1.long_title ORDER BY COUNT(*) DESC LIMIT 4"
a69440dfa419dc0ff7d88b64,Tell me the total dose of metoprolol succinate xl that patient 10020944 was prescribed in 03/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'metoprolol succinate xl' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03'","SELECT SUM(prescription_details.dose_val_rx) FROM prescription_details WHERE prescription_details.patient_id = 10020944 AND prescription_details.drug = 'metoprolol succinate xl' AND datetime(prescription_details.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescription_details.starttime) = '03'"
ffcf49b4d60d6ba61111c10d,"On last month/17, what was the average of heart rate for patient 10006053?","SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '17'","SELECT AVG(heart_rate) FROM ( SELECT heart_rate FROM procedures WHERE patient_id = 10006053 AND procedure_time >= ( SELECT procedure_time FROM procedures WHERE patient_id = 10006053 AND procedure = 'dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND procedure_time <= ( SELECT procedure_time FROM procedures WHERE patient_id = 10006053 AND procedure = 'dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) AND procedure_id <> ( SELECT procedure_id FROM procedures WHERE patient_id = 10006053 AND procedure = 'dilation of left main bronchus with intraluminal device, via natural or artificial opening endoscopic' ) )"
9eefd9e726c081549a74f486,How many current patients are 60 or above?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE age >= 60
8a56f098370ca6af99a28b53,What was the last prescribed dose of simvastatin that patient 10015860 got in the first hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'simvastatin' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT prescriptions.dose_amount FROM prescriptions WHERE prescriptions.patient_id = 10015860 AND prescriptions.drug = 'simvastatin' ORDER BY prescriptions.start_time DESC LIMIT 1
6e7e6e42109e147a8c37d95d,"What was the last rbc, ascites lab test result for patient 10005866 in their last hospital visit?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, ascites' ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT lab.val FROM lab WHERE lab.hadm_id IN ( SELECT hadm.hadm_id FROM hadm WHERE hadm.subject_id = 10005866 AND hadm.dischtime IS NOT NULL ORDER BY hadm.admittime DESC LIMIT 1 ) AND lab.spec = 'rbc, ascites' ORDER BY lab.charttime DESC LIMIT 1"
4ec97f169fd8ebe7a00e3ec0,Provide the ID list of patients who were diagnosed with unspecified sleep apnea in 2100.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sleep apnea' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT T1.subject_id FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'unspecified sleep apnea' ) AS T2 ON T1.subject_id = T2.subject_id ) AS T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'unspecified sleep apnea' AND strftime('%Y',diagnosis_time) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id"
a652507fb99040108907976b,What was the total of patients discharged from hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE status = 'discharged'
0d6e154c99ea7aa10dc0ac5c,What is the amount of albumin 25% that patient 10025612 received?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ),SELECT SUM(input_amount) FROM input_events WHERE input_event_type = 'albumin 25%' AND patient_id = 10025612
7bb4dd3032dd60767f552577,Has patient 10006580 had any medication since 13 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month')",SELECT COUNT(*)>0 FROM medication_usage WHERE subject_id = 10006580 AND starttime >= ( current_time - INTERVAL '13 month' )
6381c60f67186bd31083fcdf,How was patient 10000032 admitted in terms of admission type for the last time in the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10000032 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1",SELECT admission_type FROM admissions WHERE subject_id = 10000032 ORDER BY hospital_admission_time DESC LIMIT 1
bc393399923f7dabaa005804,Tell me the marital status of patient 10004720 during the first hospital encounter.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT marital_status FROM patients WHERE patient_id = 10004720 AND encounter_id = 1
571b776d0c624ec21b51af31,Has patient 10024043 had any organisms detected in his first mrsa screen microbiology test since 1 year ago?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ORDER BY microbiologyevents.charttime ASC LIMIT 1",10024043 has organisms in the first mrsa screen microbiology test since 1 year ago
ba93c08f689f2e3af0763012,What is the number of times that patient 10004733 visited the hospital in 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004733 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT( DISTINCT diagnosis_id ) FROM diagnoses WHERE diagnoses.patient_id = 10004733 AND strftime('%Y',diagnoses.diagnosis_time) = '2100'"
3ec03a348a536f8a80e9d54e,Please list the yearly average volume of chest tube #1 that was output by patient 10019172 since 09/2100.,"SELECT AVG(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'chest tube #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-09' GROUP BY strftime('%Y',outputevents.charttime)","SELECT AVG(chest_tube_1_volume) FROM output WHERE patient_id = 10019172 AND start_time >= '2100-09-01 00:00:00' AND start_time < '2100-12-31 00:00:00' GROUP BY strftime('%Y',start_time)"
8188f6370eb20b529ef916f2,"Among the patients who were prescribed alprazolam, what are the five most frequently prescribed drugs at the same time in this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alprazolam' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM prescriptions WHERE drug = 'alprazolam' ) AS T1 JOIN ( SELECT subject_id, prescriptions.drug FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
04f2923c808564e420f2e7be,"In 10/this year, when was the last time patient 10037861 was prescribed 5% dextrose and pantoprazole at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10037861 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10037861 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT T1.starttime FROM ( SELECT patient_id, prescription_id, starttime FROM prescriptions WHERE patient_id = 10037861 AND prescription_id IN (SELECT prescription_id FROM prescriptions WHERE drug = '5% dextrose') AND starttime >= '2100-10-01 00:00:00' ) AS T1 JOIN ( SELECT patient_id, prescription_id, starttime FROM prescriptions WHERE patient_id = 10037861 AND prescription_id IN (SELECT prescription_id FROM prescriptions WHERE drug = 'pantoprazole') AND starttime >= '2100-10-01 00:00:00' ) AS T2 ON T1.patient_id = T2.patient_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1"
e3a4b21b27f381659b9997bb,What were the three diagnoses with the lowest 3-month survival rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )",3-month survival rate of the top three most common diagnoses is 100.0.
08bd537529e959a773c05e95,Count the number of occasions in 2100 when patient 10019777 received injection or infusion of thrombolytic agent.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection or infusion of thrombolytic agent' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y',procedures_icd.charttime) = '2100'",SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10019777 AND procedures.procedure_time BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59' AND procedures.long_title = 'injection or infusion of thrombolytic agent'
f9a4d8f655bc4658ff929dab,"Can you list the top three most frequent procedures that patients received in the same hospital encounter after having reposition left maxilla with external fixation device, percutaneous approach?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.long_title FROM ( SELECT T2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime, T1.hadm_id FROM ( SELECT T0.subject_id, T0.charttime, T0.hadm_id FROM ( SELECT admissions.subject_id, procedures.charttime, admissions.hadm_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) AS T0 GROUP BY T0.subject_id ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.long_title, procedures.charttime, admissions.hadm_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.had"
833f3dcc0c1a68ee5c293d02,Did patient 10022041 have any diagnosis in their last hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),10022041 in their last hospital visit had any diagnosis?
f7f4b0b9f1896ea6f3965250,Can you tell me the number of patients that were in the psychiatry careunit since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'psychiatry' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE careunit = 'psychiatry' AND strftime('%Y', patient_info.last_admission_date) >= '2100'"
0a6ec0b4e779434a9be2f99d,What is the name of the procedure that patient 10021938 underwent two or more times in 11/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-11' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT T1.long_title FROM procedures AS T1 JOIN ( SELECT T2.code FROM procedures AS T2 GROUP BY T2.code HAVING COUNT(*) >= 2 ) AS T3 ON T1.code = T3.code WHERE T1.patient_id = 10021938 AND strftime('%Y-%m',T1.start_time) = '2100-11'"
792de6c119e764058112ee54,What was patient 10027445's last output since 06/05/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT strftime(output.charttime, '%Y-%m-%d %H:%M:%S') FROM ( SELECT * FROM (SELECT patient_id, charttime FROM duals WHERE patient_id = 10027445) AS T1 JOIN ( SELECT * FROM (SELECT patient_id, charttime FROM duals WHERE patient_id = 10027445) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime) AS T3 ORDER BY T3.charttime DESC LIMIT 1"
8bca7f05d41683561e862158,Tell me the total number of patients in the psychiatry in this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'psychiatry' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE procedure_name = 'psychiatry' AND datetime(procedures.start_time,'start of year') = datetime(current_time,'start of year','-0 year')"
3b811de97455513816713b43,Show me the yearly minimum magnesium sulfate (bolus) input of patient 10036156.,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)","SELECT MIN(Clinical_Results.Magnesium_Sulfate__bolus__) FROM Clinical_Results WHERE Clinical_Results.patient_id = 10036156 AND strftime('%Y',Clinical_Results.chart_time) = '2100'"
e6ab1bc462921776329e8d65,Was patient 10027602 in the hospital in the last year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10027602 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM hospital WHERE hospital.subject_id = 10027602 AND datetime(hospital.admittime,'start of year') = datetime(current_time,'start of year','-1 year')"
9a126c3d410cde7047840e30,What was the average heart rate on last month/25 for patient 10007058?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '25'",SELECT AVG(heart_rate) FROM ( SELECT heart_rate FROM procedures WHERE patient_id = 10007058 AND procedure_time >= ( SELECT current_time() - INTERVAL '1 month' ) AND procedure_time <= ( SELECT current_time() - INTERVAL '1 month/25' ) )
1254335c726bad61fe05f86b,"What was the name of the drug patient 10021118 was prescribed for within 2 days after having undergone a bypass coronary artery, two arteries from coronary artery, open approach procedure since 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT T1.drug FROM ( SELECT prescriptions.drug, time.clock FROM prescriptions JOIN ( SELECT procedures.subject, procedures.time FROM procedures WHERE procedures.subject = 10021118 AND procedures.type = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AS T2 ON T1.subject = T2.subject WHERE T1.time >= T2.time AND datetime(T1.time) BETWEEN datetime(T2.time) AND datetime(T2.time,'+2 day') ) AS T1 JOIN ( SELECT prescriptions.drug, time.clock FROM prescriptions JOIN ( SELECT procedures.subject, procedures.time FROM procedures WHERE procedures.subject = 10021118 AND procedures.type = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AS T2 ON T1.subject = T2.subject WHERE T1.time >= T2.time AND datetime(T1.time) BETWEEN datetime(T2.time) AND datetime(T2.time,'"
fb2fc2ad15a779e94e21d070,How much time in days has passed since the last time patient 10021487 was prescribed vancomycin on this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'vancomycin' ORDER BY prescriptions.starttime DESC LIMIT 1","12/2100: ( SELECT strftime('%j',current_time) - strftime('%j', prescription.starttime) FROM prescription WHERE prescription.hadm_id IN ( SELECT hadm_id FROM hadm_table WHERE hadm_id IN ( SELECT hadm_id FROM hadm_table WHERE patient_id = 10021487 AND is_current = 't' ) ) AND prescription.drug = 'vancomycin' ORDER BY prescription.starttime DESC LIMIT 1 )"
ff935574170a15f329581c0e,What are the top three commonly treatments for patients who are 40s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d.treatment, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS C1
         FROM (
          SELECT admissions.subject_id
          FROM admissions
          WHERE admissions.age BETWEEN 40 AND 49
          AND strftime('%Y',admissions.admittime) = '2100'
         ) AS d
         GROUP BY d.treatment
         LIMIT 3"
025c400c41ad7c9b0b92dc06,Count the number of times that patient 10007818 took glucerna 1.5 (full) on the first ICU visit.,SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'glucerna 1.5 (full)' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1</s>
cdc870bf47f6134dbbc3cf55,Has the or cell saver intake been given to patient 10011398 since 07/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-07'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.patient = 10011398 AND inputevents.item = 'or cell saver' AND strftime('%Y-%m',inputevents.starttime) >= '2100-07'"
2a440dee395beb895cb930f1,What is the three most frequently given microbiology tests since 1 year ago for patients who were previously diagnosed with cervical spondylosis without myelopathy within the same hospital visit?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cervical spondylosis without myelopathy' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'cervical spondylosis without myelopathy' AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiology.test_name, microbiology.charttime, admissions.admission_id FROM microbiology JOIN admissions ON microbiology.admission_id = admissions.admission_id WHERE datetime(microbiology.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.admission_id = T2.admission_id GROUP BY"
bc59581d2cf65c641d9a1d76,How many patients in the hospital are there currently?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE status = 'current'
f6f7ea6d73b8b83013dc2f03,"For patients who underwent percutaneous abdominal drainage this year, what were the top five most frequent procedures that followed in the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.long_title FROM ( SELECT T2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT T1.subject_id, T1.charttime FROM procedures WHERE procedures.long_title = 'percutaneous abdominal drainage' ) AS T1 JOIN ( SELECT T2.subject_id, T2.charttime FROM procedures AS T2 WHERE T2.long_title = 'other specified procedures' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of year') = datetime(T2.charttime,'start of year') ) AS T3 WHERE T3.C1 <= 5"
68b586764cc7071b73a27296,Can you tell me the output that patient 10035185 had for the last occurrence since 01/16/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-16' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT strftime(output.charttime, '%H:%M:%S') FROM ( SELECT * FROM (SELECT patient_id, output FROM ( SELECT patient_id, '2100-01-16'::timestamp AS charttime, 'output' AS output FROM ( SELECT patient_id, ( SELECT value FROM ( SELECT * FROM ( SELECT * FROM diagnosis_keys WHERE keyword = 'discharge from hospital' ) ) ) AS value FROM ( SELECT * FROM patient_output WHERE patient_id = 10035185 ) ) AS output GROUP BY patient_id, charttime ORDER BY charttime DESC LIMIT 1 ) ) AS output ) AS subquery4 WHERE strftime(subquery4.charttime,'%Y-%m-%d') >= '2100-01-16'"
b7f96cf1be01ab41394d3489,How many patients died during the same month after having been diagnosed since 1 year ago with acute on chronic diastolic (congestive) heart failure?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic (congestive) heart failure' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime) >= datetime(current_time,'-1 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod) >= datetime(current_time,'-1 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE datetime(T2.charttime,'start of month') = datetime(T3.dod,'start of month')","SELECT COUNT( DISTINCT T2.subject ) FROM ( SELECT T1.subject, T1.diagnosis_time FROM ( SELECT subject, diagnosis_time FROM diagnoses WHERE diagnosis = 'acute on chronic diastolic (congestive) heart failure' ) AS T1 GROUP BY subject HAVING MIN(diagnosis_time) = T1.diagnosis_time AND datetime(diagnosis_time) >= datetime(current_time,'-1 year') ) AS T2 JOIN ( SELECT subject, expire_time FROM expirations WHERE expire_time <= datetime(current_time,'-1 year') ) AS T3 ON T2.subject = T3.subject WHERE datetime(T2.diagnosis_time,'start of month') = datetime(T3.expire_time,'start of month')"
ee06998b93ca5610c35e7925,"Has clonidine patch 0.3 mg/24 hr, amlodipine, or 5% dextrose been prescribed for patient 10004733 in this hospital encounter?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'clonidine patch 0.3 mg/24 hr', 'amlodipine', '5% dextrose' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'clonidine patch 0.3 mg/24 hr', 'amlodipine', '5% dextrose' )"
15a9e84696cb054763055092,"Since the first visit of patient 10004733 to the careunit neurology in their current hospital visit, how many hours have elapsed?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', patient.last_visit_time) ) FROM patient WHERE patient.subject_id = 10004733 AND patient.current_careunit = 'neurology' AND patient.dischtime IS NULL ORDER BY patient.last_visit_time DESC LIMIT 1"
c89653463314d3045e9c1e32,What are the top three most frequent procedures that patients underwent within the same hospital visit after receiving a diagnosis of closed fracture of two ribs.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of two ribs' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.long_title FROM ( SELECT T2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.chart_time, patient.hadm_id FROM diagnoses JOIN patient ON diagnoses.hadm_id = patient.hadm_id WHERE diagnoses.long_title = 'closed fracture of two ribs' ) AS T1 JOIN ( SELECT patient.subject_id, procedures.long_title, procedures.chart_time, patient.hadm_id FROM procedures JOIN patient ON procedures.hadm_id = patient.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1.hadm_id = T2.hadm_id GROUP BY T2.long_title ) AS T3 WHERE T3.C1 <= 3"
48859a4418a3875bf6082407,"What was patient 10005866's first value of bilirubin, total since 03/2100?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(Caliber.val) FROM ( SELECT lab.val AS val FROM lab WHERE lab.patient_id = 10005866 AND lab.spec_type_desc = 'bilirubin, total' AND strftime('%Y-%m',lab.charttime) >= '2100-03' ) AS Caliber"
552b047a4b16894db1150381,When did patient 10039708 receive his last microbiology test during the last hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiology.charttime FROM microbiology WHERE microbiology.patient_id = 10039708 AND microbiology.spec_type_desc = 'other' AND microbiology.charttime >= ( SELECT admissions.charttime FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.charttime DESC LIMIT 1 ) ORDER BY microbiology.charttime DESC LIMIT 1
b94d6edc3aae12b1d958fcb5,How many patients since 2100 underwent radical excision of other lymph nodes within the same hospital visit after other repair and plastic operations on bronchus?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair and plastic operations on bronchus' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'radical excision of other lymph nodes' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.chart_time, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses.chart_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'other repair and plastic operations on bronchus' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.chart_time, admissions.hadm_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.procedure = 'radical excision of other lymph nodes' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1.hadm_id = T2.hadm_id AND strftime('%Y',T1.chart_time) >= '2100' ) AS T1;"
75b34f0cc40ad60222a3d432,How was patient 10019777 admitted in terms of admission type for the first time in the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10019777 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1",SELECT admission_type FROM admissions WHERE subject_id = 10019777 ORDER BY hospital_admission_time ASC LIMIT 1
c747e1b668edc722be015e38,When was the first time patient 10020740 was prescribed a medication via the ih route in 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'ih' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(prescription.starttime) FROM prescription WHERE prescription.patient = 10020740 AND prescription.route = 'ih' AND strftime('%Y-%m',prescription.starttime) = '2100-07'"
e7f9ba08efb72fdfd7f40122,"How many instances of drainage of left pleural cavity, percutaneous approach, diagnostic have there been in the last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-1 year')"
9ed380731316b97f5b4cc772,"After being diagnosed with personal history of noncompliance with medical treatment, presenting hazards to health in 2100, how many patients received a diagnosis of blood in stool within 2 months?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of noncompliance with medical treatment, presenting hazards to health' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'blood in stool' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.chart_time FROM ( SELECT subject_id, chart_time FROM diagnoses WHERE diagnosis = 'personal history of noncompliance with medical treatment, presenting hazards to health' ) AS T1 JOIN ( SELECT subject_id, chart_time FROM microbiology_events WHERE microbiology_event_type = 'blood in stool' ) AS T2 ON T1.subject_id = T2.subject_id ) WHERE T1.chart_time < T2.chart_time AND datetime(T2.chart_time) BETWEEN datetime(T1.chart_time) AND datetime(T1.chart_time,'+2 month')"
5be97a0dfd0141a05af0b00e,Count the number of patients who were diagnosed with irritable bowel syndrome but didn't come back to the hospital within 2 months since 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'irritable bowel syndrome' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'irritable bowel syndrome' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) >= '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'irritable bowel syndrome' ) AS T1 JOIN ( SELECT subject_id, encounter_time FROM encounters WHERE encounter_type = 'diagnosis' ) AS T2 ON T1.subject_id = T2.subject_id WHERE strftime('%Y',T1.diagnosis_time) >= '2100' ) AS T1 JOIN ( SELECT subject_id, encounter_time FROM encounters WHERE encounter_type = 'diagnosis' AND strftime('%Y',encounter_time) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.encounter_time AND datetime(T2.encounter_time) BETWEEN datetime(T1.diagnosis_time) AND datetime(T1.diagnosis_time,'+2 month')<|im"
1dffdf5fe800e0b9a0dcf1b3,Has patient 10005866 been in the hospital?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866,SELECT COUNT(*)>0 FROM hospital_history WHERE hospital_history.subject_id = 10005866
eb33e90dbcfbca0c0e049512,"How many patients underwent reopening of recent thoracotomy site within the same month after the diagnosis with other acute postoperative pain, since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other acute postoperative pain' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reopening of recent thoracotomy site' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis LIKE '%other acute postoperative pain%' ) AS T1 JOIN ( SELECT subject_id, procedure_time FROM procedures WHERE procedure = 'reopening of recent thoracotomy site' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.procedure_time AND datetime(T1.diagnosis_time,'start of year') = datetime(T2.procedure_time,'start of year') ) AS T1 GROUP BY T1.subject_id HAVING T1.diagnosis_time < datetime(current_time,'start of year','-2 year') AND datetime(current_time,'start of year','-2 year') <= T1.diagnosis_time"
e4e38f5cdc7fa7972dbcbfcd,When did patient 10019172 leave the hospital the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10019172 ORDER BY admissions.dischtime DESC LIMIT 1
e1f82dce913d0a344d686dcb,What was the total mediastinal output in the last ICU visit that patient 10005817 had?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'mediastinal' AND d_items.linksto = 'outputevents' ),"SELECT SUM(output) FROM ( SELECT json_extract(inputs.input, '$.output') AS output FROM ( SELECT * FROM icu_inputs WHERE icu_id IN ( SELECT icu_id FROM icu WHERE patient_id = 10005817 AND icu_outtime IS NOT NULL ORDER BY icu_intime DESC LIMIT 1 ) ) AS inputs ) AS output_data"
d704f27fd79c99e4a27f1581,Count the number of medicines that patient 10026354 was prescribed in 11/this year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10026354 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11'"
851cd4dfcd01e3388de0e514,"Among those who were prescribed with pseudoephedrine, what are the three most commonly prescribed drugs at the same time in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pseudoephedrine' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM prescriptions WHERE drug = 'pseudoephedrine' ) AS T1 JOIN ( SELECT subject_id, charttime FROM prescriptions WHERE drug = 'caffeine-causal' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND strftime('%Y',T1.charttime) = '2100' ) AS T3 WHERE T3.C1 <= 3"
60fbb0d233ccfd0e7297749b,What were the five most frequent diagnoses that occurred in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",1. What were the five most frequent diagnoses that occurred in 2100?
b5aa101f3fdc45028cfa04f1,What percentile rank does a lactate test value of 2.3 have among patients of the same age as patient 10004422 during the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.3","SELECT T1.C1 FROM ( SELECT lab.val, PERCENT_RANK() OVER ( ORDER BY lab.val ASC ) AS C1 FROM lab WHERE lab.item = 'lactate' AND lab.patient = 10004422 AND lab.charttime >= ( SELECT lab.charttime FROM lab WHERE lab.item = 'lactate' AND lab.patient = 10004422 AND lab.charttime IS NOT NULL ORDER BY lab.charttime DESC LIMIT 1 ) AND lab.charttime >= ( SELECT patient.age FROM patient WHERE patient.age = ( SELECT patient.age FROM patient WHERE patient.name = 'john doe' AND patient.dischtime IS NOT NULL ORDER BY patient.dischtime DESC LIMIT 1 ) ORDER BY patient.age ASC LIMIT 1 ) ) AS T1 WHERE T1.val = 2.3"
5437dceb1f465a249b318f40,How many hours have there been since patient 10039831's admission to the hospital?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', patient.admittime) ) FROM patient WHERE patient.subject_id = 10039831 AND patient.dischtime IS NULL"
a12d2706258e7cd94b157f13,How many times did patient 10021487 stay in ICU?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ),SELECT COUNT( DISTINCT icustay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 )
d08bcacce107729b3e15f70b,"Among patients who received partial hepatectomy since 1 year ago, what are the top three most common diagnoses that followed afterwards within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.charttime FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.procedure = 'partial hepatectomy' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT patient.subject_id, diagnoses.diagnosis, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.diagnosis ) AS T3 WHERE T3.C1 <= 3<|im_"
a318cf44208857796ab33806,What is the 3-month survival rate for patients diagnosed with other psoriasis?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other psoriasis' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )",3-month survival rate for patients diagnosed with other psoriasis:
cbfc8721f283a1c8bc8a32fb,What was the insurance that patient 10013049 had on the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.insurance FROM patients WHERE patient.subject_id = 10013049 AND patient.dischtime IS NOT NULL ORDER BY patient.admittime ASC LIMIT 1
dd025c270eae097731034a6c,How many hours has it been since patient 10018081 first received a mcv lab test during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', lab.charttime) ) FROM lab WHERE lab.patient = 10018081 AND lab.label = 'mcv' AND lab.charttime >= ( SELECT charttime FROM lab WHERE lab.patient = 10018081 AND lab.label = 'mcv' ORDER BY lab.charttime ASC LIMIT 1 )"
c639ce3944c3e8b1431b7f0d,When is the first mrsa screen microbiological test on patient 10011398 during their last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT microbiology.charttime FROM microbiology WHERE microbiology.patient_id = 10011398 AND microbiology.spec_type_desc = 'mrsa screen' AND microbiology.charttime >= ( SELECT admissions.charttime FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiology.charttime ASC LIMIT 1
6c5c8aeb2476c9646d1a2c84,How many hours have gone by since the last time patient 10004733 was diagnosed with hyperosmolality and/or hypernatremia in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperosmolality and/or hypernatremia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnosis.diagnosis_time) ) FROM diagnosis WHERE diagnosis.patient_id = 10004733 AND diagnosis.diagnosis_time >= ( SELECT diagnosis_time FROM diagnosis WHERE patient_id = 10004733 AND diagnosis.diagnosis = 'hyperosmolality and/or hypernatremia' ORDER BY diagnosis.diagnosis_time DESC LIMIT 1 )"
790549b711d398fb4ea8bbcb,"What were the five most commonly given microbiology tests for patients who had received excision of right internal mammary artery, percutaneous endoscopic approach before in the same month?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.chart_time FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.procedure_name = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) AS T1 JOIN ( SELECT patient.subject_id, microbiology.test_name, microbiology.chart_time FROM microbiology JOIN patient ON microbiology.patient_id = patient.subject_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of month') = datetime(T2.chart_time,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5"
d91a86b3f19888f5557a404a,Since 08/2100 has patient 10004733 received a hyaline casts test?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08'","SELECT COUNT(*)>0 FROM lab_test WHERE lab_test.patient_id = 10004733 AND lab_test.spec_type_desc = 'hyaline casts' AND strftime('%Y-%m',lab_test.charttime) >= '2100-08'"
5d5a07118525dfe5b79a0611,Has patient 10026255 had any tests for red blood cells since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*)>0 FROM lab_test WHERE lab_test.patient_id = 10026255 AND lab_test.spec_type_desc = 'red blood cells' AND strftime('%Y-%m',lab_test.charttime) >= '2100-04'"
19d0768436838216fd47a301,Could you provide the last care unit for patient 10009049 in their last hospital encounter according to the transfer record?,SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1,SELECT transfers.care_unit FROM ( SELECT * FROM transfers WHERE transfers.patient_id = 10009049 AND transfers.in_time IN ( SELECT MIN(in_time) FROM transfers WHERE transfers.patient_id = 10009049 AND transfers.care_unit IS NOT NULL ) ) AS T1 JOIN transfers ON T1.patient_id = transfers.patient_id AND T1.in_time = transfers.in_time WHERE T1.care_unit IS NOT NULL ORDER BY T1.in_time DESC LIMIT 1
2920bbd6fd0bc33b5dccb46b,What label is associated with epidural bolus (ml)?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'epidural bolus (ml)',SELECT DISTINCT label FROM procedures WHERE procedure_name = 'epidural bolus (ml)'
c1d91632054e8b6e0c6ddbe3,What were the three most commonly diagnosed conditions in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )",1. What were the three most commonly diagnosed conditions in 2100?
ec48e6b64115e4e42d084f61,What is the number of patients who died after diagnosis of alcoholic cirrhosis of liver within the same month?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcoholic cirrhosis of liver' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL ) as T3 ON T2.subject_id = T3.subject_id WHERE datetime(T2.charttime,'start of month') = datetime(T3.dod,'start of month')","SELECT COUNT( DISTINCT T2.subject ) FROM ( SELECT T1.subject, T1.diagnosis_time, T1.subject_id FROM ( SELECT subject, diagnosis_time, subject_id FROM diagnoses WHERE diagnosis_time < '2100-01-01 00:00:00' ) AS T1 GROUP BY subject ) AS T2 JOIN ( SELECT subject_id, subject, death_time FROM patients WHERE death_time < '2100-01-01 00:00:00' ) AS T3 ON T2.subject_id = T3.subject_id WHERE T2.diagnosis_time < T3.death_time AND datetime(T2.diagnosis_time,'start of month') = datetime(T3.death_time,'start of month')"
512cce50ee8297feb5df8464,"Among patients who received percutaneous abdominal drainage throughout this year, what were the top five most common treatments that were administered within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",1. What were the top five most common treatments that were administered to patients within 2 months after they were diagnosed with other and unspecified hypercholesterolemia?
d04a8f390aa217deadcd1bd1,When was the first time when patient 10027602 received their input on this month/02?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '02' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT input_time FROM input_events WHERE input_events.patient_id = 10027602 AND datetime(input_time,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',input_time) = '02' ORDER BY input_time ASC LIMIT 1"
647bc08d18cac6dbda791c42,"When was, for the last time in 10/2100, patient 10018845 prescribed a medication via the sc route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescription.starttime FROM prescription WHERE prescription.patient = 10018845 AND prescription.route = 'sc' AND strftime('%Y-%m',prescription.starttime) = '2100-10' ORDER BY prescription.starttime DESC LIMIT 1"
f695adacb2c2c0d897a34ec4,What was the drug that was prescribed to patient 10020944 during the same hospital encounter after receiving arterial catheterization in 03/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime",10020944 has received arterial catheterization in 03/2100.
bede0977c8868b145f17fa5e,What was the name of the last specimen test patient 10021938 got since 07/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT spec_type_desc FROM ( SELECT * FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',microbiology_events.charttime) >= '2100-07' ORDER BY microbiology_events.charttime DESC LIMIT 1 )"
842de74a9f0719c2f68b9f9f,"Get me the top five most frequent specimens that patients were tested within 2 months after receiving bypass coronary artery, one artery from aorta with autologous venous tissue, open approach since 2100.","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.chart_time FROM ( SELECT subject_id, chart_time FROM procedures WHERE chart_time >= '2100-01-01' AND chart_time < '2100-01-02' AND spec_type_desc = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AS T1 JOIN ( SELECT subject_id, spec_type_desc, chart_time FROM labevents WHERE chart_time >= '2100-01-01' AND chart_time < '2100-01-02' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T2.chart_time) BETWEEN datetime(T1.chart_time) AND datetime(T1."
c8edd5309596df31109a68a1,What is the average value of mesothelial cells of patient 10021487 since 04/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT AVG(mesothelial_cells) FROM medical_database WHERE patient_id = 10021487 AND strftime('%Y-%m', input_time) >= '2100-04'"
5614cf0da6a6dc8d7f53e2e4,"In the last ICU stay, what was the average value of heart rate of patient 10019385?",SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ),SELECT AVG(heart_rate) FROM icu_observations WHERE icu_id IN ( SELECT icu_id FROM icu_history WHERE patient_id = 10019385 AND stay_length > 0 ORDER BY stay_start_time DESC LIMIT 1 )
288822ce7a0817f505ff7846,"Can you tell me the price of a potassium, whole blood lab test?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) )","SELECT DISTINCT cost FROM lab_tests WHERE test_name = 'potassium, whole blood'"
f7ef7a140ef208ed6c164772,What was patient 10004235 diagnosed with for the first time since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT diagnosis.diagnosis_name FROM diagnosis WHERE diagnosis.patient_id = 10004235 AND strftime('%Y',diagnosis.diagnosis_time) >= '2100' ORDER BY diagnosis.diagnosis_time ASC LIMIT 1"
ca849848206d37bc69b35d9d,When did patient 10018501 get the last input since 145 days ago?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND datetime(inputevents.starttime) >= datetime(current_time,'-145 day') ORDER BY inputevents.starttime DESC LIMIT 1","SELECT input_time FROM input_events WHERE input_events.patient_id = 10018501 AND datetime(input_time) >= datetime(current_time,'-145 day') ORDER BY input_time DESC LIMIT 1"
310609c75ba9429428209b11,What was the length of stay in days for patient 10002495 during the first ICU stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",10002495's first ICU length of stay was 120 days.
0eba370644940aed20760324,What was the name of the drug that patient 10006580 was first prescribed via a sc route in their first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1,"SELECT T1.drug FROM ( SELECT prescriptions.drug, row_number() OVER ( ORDER BY prescriptions.starttime ASC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'sc' ) AS T1 WHERE T1.C1 = 1"
40e911a74ca6a562cbd63623,What's the count of extraction of other tooth procedures that happened since 1 year ago?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extraction of other tooth' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.type = 'extraction of other tooth' AND datetime(procedures.starttime) >= datetime(current_time,'-1 year')"
7f8ee9cd84328b3ac980008b,What is the maximum total hospital cost that has ever included fexofenadine within the same hospital visit?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fexofenadine' ) GROUP BY cost.hadm_id ) AS T1,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost) AS C1 FROM ( SELECT patient_id FROM prescriptions WHERE prescriptions.drug = 'fexofenadine' ) AS T1 JOIN ( SELECT patient_id, stay_id FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.stay_id = T2.stay_id GROUP BY T1.patient_id ) AS T3"
ae564ba44db568a88f5527ac,What is the total cost for patient 10020944's hospital stay throughout this year?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT SUM(cost) FROM ( SELECT cost FROM ( SELECT diagnosis_cost FROM diagnosis WHERE diagnosis.diagnosis_id = diagnosis_of_patient_10020944 ) AS T1 JOIN ( SELECT procedure_cost FROM procedure WHERE procedure.procedure_id = procedure_of_patient_10020944 ) AS T2 ON T1.diagnosis_id = T2.diagnosis_id ) AS T3 WHERE T3.cost_id = cost_id AND datetime(cost_time,'start of year') = datetime(current_time,'start of year','-0 year')"
202ecadc0d16d2f85f8ad189,Show me the monthly maximum dextrose 5% input of patient 10009035 in their first hospital encounter.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)",SELECT MAX(input_dextrose5%) FROM ( SELECT input_dextrose5% FROM medical_log WHERE patient_id = 10009035 AND encounter_id = 1 ) WHERE time_last_measurement = 'month'
efed4e108b270dda785398e4,Can you name the top five diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )",3-month mortality rate of what are the top five diagnoses?
317471edec57125589ff563e,Calculate the duration in days of patient 10002495's stay in the last ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT strftime('%J', icu.outtime) - strftime('%J', icu.intime) FROM icu WHERE icu.patient = 10002495 AND icu.outtime IS NOT NULL ORDER BY icu.intime DESC LIMIT 1"
2cd96b3599e3450802308c45,How many days has it been since patient 10018081's hospital admission?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', patient.admittime) ) FROM patient WHERE patient.subject_id = 10018081 AND patient.dischtime IS NULL"
1c26aa5ab4b654a27fb0f4a6,When did patient 10021487 first have the maximum value of plasma cells since 26 months ago?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'plasma cells' ) AND datetime(labevents.charttime) >= datetime(current_time,'-26 month') ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.spec_type_desc = 'plasma cells' AND datetime(labevents.charttime) >= datetime(current_time,'-26 month') ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1"
ed844ec6192fdc9f7e85ebb3,"Among patients who received a other diagnostic procedures on lung or bronchus procedure , what were the three most frequent microbiology tests conducted during the same hospital encounter?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.chart_time, admissions.hadm_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiology.test_name, microbiology.chart_time, admissions.hadm_id FROM microbiology JOIN admissions ON microbiology.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3"
9cce51057612a8f9dc75a40f,What were the five most common microbiology tests that patients had after undergoing esophagogastroduodenoscopy [egd] with closed biopsy within the same month?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'esophagogastroduodenoscopy [egd] with closed biopsy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.charttime FROM procedures JOIN patient ON procedures.subject_id = patient.subject_id WHERE procedures.long_title = 'esophagogastroduodenoscopy [egd] with closed biopsy' ) AS T1 JOIN ( SELECT patient.subject_id, microbiology.test_name, microbiology.charttime FROM microbiology JOIN patient ON microbiology.subject_id = patient.subject_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5"
7f45ec7922873c06d1b67747,What is the average yearly number of patients who had encounter for palliative care?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for palliative care' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnosis_id ) AS C1 FROM patients WHERE encounter_type = 'encounter for palliative care' GROUP BY strftime('%Y',diagnosis_date) ) AS T1"
ef903edb8d2304b433a243cb,How many hours have there been since patient 10004733's admission to the hospital?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', patient.admittime) ) FROM patient WHERE patient.subject_id = 10004733 AND patient.dischtime IS NULL"
6aea46a3a6bf0c02fb9bd415,What was the last measured value of respiratory rate of patient 10027602 on this month/04?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '04' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MIN(Counters.respiratory_rate) FROM Counters WHERE Counters.patient_id = 10027602 AND datetime(Counters.measure_time,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',Counters.measure_time) = '04'"
e59eccf79830c0ce43f8ca5c,How much metformin xr (glucophage xr) was prescribed to patient 10016150 first time in 05/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.drug = 'metformin xr (glucophage xr)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.drug = 'metformin xr (glucophage xr)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1"
0802fd344595ba15c4b3d32b,Count how many patients underwent a microbiological rapid respiratory viral screen & culture test.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' ),SELECT COUNT( DISTINCT patient_id ) FROM microbiology_events WHERE microbiology_event_type = 'rapid respiratory viral screen & culture'
175e95be4a9b9de2532f300e,Show me the top three most common diagnoses of patients with age in their 20s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.diagnosis FROM ( SELECT diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM patients WHERE patients.age BETWEEN 20 AND 29 GROUP BY diagnosis ) as T1 WHERE T1.C1 <= 3"
7e7f2de29fe0d6cf726ecfd4,Did patient 10020306 visit the hospital for admission during the last year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020306 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM hospital WHERE hospital.subject_id = 10020306 AND datetime(hospital.admittime,'start of year') = datetime(current_time,'start of year','-1 year')"
91b457d33856fa9e57fd105b,"During the last hospital encounter, what was the age of patient 10008454?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.age FROM patients WHERE patient.subject_id = 10008454 AND patient.dischtime IS NOT NULL ORDER BY patient.admittime DESC LIMIT 1
bd54a046a04a62d9d40ba4d4,"This year, what were the four most frequently ordered specimen tests?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT T1.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.spec_type_desc FROM ( spec_types T1 JOIN ( SELECT me.spec_type_desc, me.spec_type_code FROM spec_types me ) AS T2 ON T1.spec_type_code = T2.spec_type_code ) WHERE T1.dischtime is this year GROUP BY T1.spec_type_desc ) AS T1 WHERE C1 <= 4"
41d96d1ac69af1608ab8e287,Can you list the yearly maximum vital high protein (full) input of patient 10019777?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)","SELECT MAX(input_events.totalamount) FROM input_events WHERE input_events.patientid = 10019777 AND input_events.itemid IN ( SELECT DISTINCT item_id FROM inventory WHERE item_name = 'vital high protein (full)' ) GROUP BY strftime('%Y', input_events.starttime)"
3c3a60ef6ea248ad69d36deb,When was patient 10008287 prescribed for the last time a medication via the pr route since 08/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND prescriptions.route = 'pr' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT pr.starttime FROM ( SELECT procedures.starttime, procedures.patient, procedures.output FROM procedures WHERE procedures.patient = 10008287 AND procedures.output = 'pr' AND strftime('%Y-%m',procedures.starttime) >= '2100-08' ) AS pr ORDER BY pr.starttime DESC LIMIT 1"
916c297dfa63e76557d57bb8,Is patient 10025612's heart rate ever greater than 104.0 on 10/03/2100?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 104.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-03'",10025612's heart rate is greater than 104.0 on 10-03-2100
7c6bef368aa5ba846c186719,How much of a difference is there in patient 10038999's c-reactive protein last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c-reactive protein' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c-reactive protein' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT lab.valuenum FROM lab WHERE lab.hadm_id IN ( SELECT hadm.hadm_id FROM hadm WHERE hadm.patient_id = 10038999 AND hadm.dischtime IS NOT NULL ORDER BY hadm.admittime DESC LIMIT 1 ) AND lab.spec_type_desc = 'c-reactive protein' ORDER BY lab.charttime DESC LIMIT 1 ) - ( SELECT lab.valuenum FROM lab WHERE lab.hadm_id IN ( SELECT hadm.hadm_id FROM hadm WHERE hadm.patient_id = 10038999 AND hadm.dischtime IS NOT NULL ORDER BY hadm.admittime DESC LIMIT 1 ) AND lab.spec_type_desc = 'c-reactive protein' ORDER BY lab.charttime ASC LIMIT 1 )
fa829a69da2e049d895218f5,What is the number of times that patient 10020786 had pre-admission on 12/04/last year?,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',outputevents.charttime) = '12-04'","SELECT COUNT(*) FROM pre_admissions WHERE pre_admissions.subject_id = 10020786 AND pre_admissions.admission_time >= ( SELECT admissions.admission_time FROM admissions WHERE admissions.subject_id = 10020786 AND datetime(admissions.admission_time,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',admissions.admission_time) = '12-04' )"
54c7213807ea893bd586bc8a,"Among patients who received reposition left maxilla with external fixation device, percutaneous approach during this year, what were the top four most common treatments that were administered within the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )",1. What were the top four most common treatments that were administered to patients within the same hospital visit after they were diagnosed with other and unspecified hypercholesterolemia?
ba6c7676d03f793bbd5aaf81,Which was the first procedure that patient 10035185 received during their last hospital encounter?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1 ),SELECT procedures.name FROM procedures WHERE procedures.log_time >= ( SELECT admissions.log_time FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures.log_time ASC LIMIT 1
42ab3ab91a8cfe3fa02ec9f2,Retrieve the top five most frequent procedures that patients underwent in the same month after being diagnosed with intermediate coronary syndrome.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intermediate coronary syndrome' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.long_title FROM ( SELECT T2.short_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.chart_time FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.patient_id WHERE diagnoses.long_title = 'intermediate coronary syndrome' ) AS T1 JOIN ( SELECT patient.subject_id, procedures.short_title, procedures.chart_time FROM procedures JOIN patient ON procedures.patient_id = patient.patient_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of month') = datetime(T2.chart_time,'start of month') GROUP BY T2.short_title ) AS T3 WHERE T3.C1 <= 5"
7b11c8a07c7b85627d2a9c47,"Count how many times during their first hospital encounter patient 10018423 experienced the bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach procedure.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10018423 AND procedures.procedure_name = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' AND procedures.start_time >= ( SELECT MIN(start_time) FROM encounters WHERE encounters.patient_id = 10018423 AND encounters.type = 'initial' )"
7b7f155abcaed396f4e612b6,Tell me the name of the medication patient 10004720 was first prescribed via iv route since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT T1.drug FROM ( SELECT prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE prescriptions.patient = 10004720 AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE prescriptions.patient = 10004720 AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' AND datetime(prescriptions.starttime) > datetime(current_time,'-1 year') ) AS T2 ON T1.drug = T2.drug WHERE T1.starttime < T2.starttime ORDER BY T1.starttime ASC LIMIT 1"
18df1101ddb265b920569563,What are the names of the procedures performed on patient 10020740 two or more times since 14 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-14 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT T1.long_title FROM procedures AS T1 JOIN ( SELECT T2.long_title, COUNT( T2.long_title ) AS C1 FROM procedures AS T2 WHERE T2.patient_id = 10020740 AND datetime(T2.start_time) >= datetime(current_time,'-14 month') GROUP BY T2.long_title ) AS T3 ON T1.long_title = T3.long_title WHERE T3.C1 >= 2"
964217a388912122a2c89866,"Tell me patient 10020944's average calcium, total value in 03/2100?","SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'","SELECT AVG(CALCIUM, TOTAL) FROM lab_results WHERE patient_id = 10020944 AND strftime('%Y-%m', lab_results.charttime) = '2100-03'"
ea018f554b80d642628c416c,Tell me the total ICU visits of patient 10004733 since 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',icustays.intime) >= '2100'","SELECT COUNT( DISTINCT icu_id ) FROM icu_history WHERE icu_history.hadm_id IN ( SELECT hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',icu_history.intime) >= '2100'"
5c365a198595d213cd5d103a,Has patient 10004733 received any tests for triglycerides in 10/last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycerides' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'",10004733 has been tested for triglycerides in 10/2100.
46750fb096297aa719284222,Get me the top four most frequent lab tests throughout this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents T2 JOIN ( SELECT diagnostic_events.event_id, diagnoses.diagnosis_name FROM diagnoses JOIN diagnostic_events ON diagnoses.event_id = diagnostic_events.event_id WHERE diagnoses.diagnosis_name IN ( 'unspecified essential hypertension', 'essential hypertension with unspecified cause', 'essential hypertension with unspecified cause', 'essential hypertension with unspecified cause' ) AND datetime(diagnostic_events.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 WHERE T1.C1 <= 4"
e65c919605b77138aef522fe,What is the name of the procedure done to patient 10019777 two times since 21 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-21 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT T1.long_title FROM procedures AS T1 JOIN ( SELECT T2.long_title, COUNT( T2.long_title ) AS C1 FROM procedures AS T2 WHERE T2.patient_id = 10019777 AND datetime(T2.start_time) >= datetime(current_time,'-21 month') GROUP BY T2.long_title ) AS T3 ON T1.long_title = T3.long_title WHERE T3.C1 = 2"
4f8edd5ffa577be90e9a0715,What is the average amount of the total hospital cost which involves dependence on supplemental oxygen since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on supplemental oxygen' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT AVG(T1.C1) FROM ( SELECT SUM(C1) AS C1 FROM ( SELECT C1 FROM diagnoses WHERE LOWER(DIAGNOSIS) = 'dependence on supplemental oxygen' ) AS T1 JOIN patients AS T2 ON T1.PID = T2.PID WHERE T1.YEAR >= 2100 GROUP BY T1.PID ) AS T3
d3f0d98539d2e9134a435816,"On the current hospital visit, how many hours have passed since the first time patient 10021487 was prescribed midazolam?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'midazolam' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.drug = 'midazolam' AND prescriptions.patient_id = 10021487 AND prescriptions.starttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY prescriptions.starttime ASC LIMIT 1"
6e19826cc8478fa8a97d1dee,When was the first time in 07/this year that patient 10007818 had the minimum of tobramycin?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tobramycin' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT MIN(Tobramycin) FROM ( SELECT Tobramycin FROM medical_data WHERE Patient_ID = 10007818 AND datetime(Datetime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',Datetime) = '07' ) AS T1;"
9ab8b4d1a143e09289a29059,What is the maximum metamyelocytes of patient 10038992?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ),SELECT MAX(lab_results.metamyelocytes) FROM lab_results WHERE lab_results.patient_id = 10038992
519da8c653b3284432571957,Has there been any results of microbiology tests for the blood culture of patient 10007818 since 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y',microbiologyevents.charttime) >= '2100'","SELECT COUNT(*)>0 FROM microbiology_test WHERE microbiology_test.patient_id = 10007818 AND microbiology_test.spec_type_desc = 'blood culture' AND strftime('%Y',microbiology_test.charttime) >= '2100'"
5ff41378c47dc43f9ea36aa9,What's the total amount of packed red blood cells that patient 10008454 received on their first ICU stay?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ),SELECT SUM(packed_red_blood_cells) FROM icu_input WHERE icu_input.icu_id IN ( SELECT icu.icu_id FROM icu WHERE icu.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icu.outtime IS NOT NULL ORDER BY icu.intime ASC LIMIT 1 )
05a1330cdcd6729af414b7c7,What is the 6-month survival probability for patients living with a other and unspecified angina pectoris diagnosis?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/2 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified angina pectoris' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT SUM(CASE WHEN patients.dod_date IS NULL THEN 1 WHEN strftime('%J', patients.dod_date) - strftime('%J', T1.chart_time) > 6 * 365 THEN 1 ELSE 0 END) * 100 / COUNT(*) FROM ( SELECT chart_time, patients.subject_id FROM diagnoses JOIN patients ON diagnoses.patient_id = patients.subject_id WHERE diagnoses.diagnosis = 'other and unspecified angina pectoris' ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id"
09e77a973741f315e0526f82,Give me the four most common output events since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.output_event_id FROM ( SELECT T1.output_event_id, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.output_event_id FROM outputevents AS T1 JOIN ( SELECT T2.output_event_id, T1.event_time FROM outputevents AS T1 JOIN ( SELECT diagnoses.diagnosis_id, diagnoses.event_time FROM diagnoses WHERE diagnoses.diagnosis_id IN ( SELECT diagnoses.diagnosis_id FROM diagnoses WHERE diagnoses.diagnosis LIKE '%unspecified place in hospital%' ) ) AS T2 ON T1.output_event_id = T2.output_event_id WHERE datetime(T1.event_time) >= datetime(current_time,'-1 year') GROUP BY T1.output_event_id ) AS T1 WHERE T1.C1 <= 4"
aaa0dd1684e01424ce21edfd,When was the last occasion that patient 10018423 underwent a fluoroscopy of multiple coronary arteries using low osmolar contrast procedure since 1 year ago?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using low osmolar contrast' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10018423 AND procedures.procedure_name = 'fluoroscopy of multiple coronary arteries using low osmolar contrast' AND datetime(procedures.start_time) >= datetime(current_time,'-1 year')"
c1a2df83f43de889081a87be,Find the number of patients who had a right heart cardiac catheterization procedure in the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE procedures.name = 'right heart cardiac catheterization' AND datetime(procedures.start_time,'start of year') = datetime(current_time,'start of year','-1 year')"
849c73c34b291683b2d24907,Tell me the drug that was prescribed to patient 10021487 for the first time through the iv route since 09/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT T1.drug FROM ( SELECT prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE prescriptions.patient = 10021487 AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) AS T1 WHERE T1.starttime = ( SELECT MIN(starttime) FROM ( SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.patient = 10021487 AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ) )"
bed5da859030d9c461ef882a,What was the amount of foley output patient 10038933 has on 09/26/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-09-26'","SELECT SUM(output_amount) FROM output_events WHERE output_type = 'foley' AND patient_id = 10038933 AND strftime('%Y-%m-%d',output_time) = '2100-09-26'"
356df71d59db66ac2534a5d3,Can you tell me the total number of patients who were admitted to the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT( DISTINCT patient_id ) FROM hospital WHERE datetime(admittime) >= datetime(current_time,'-1 year')"
524208cb99d72ea26c67c3f9,How many times did patient 10019385 check into the ICU during this year?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')"
e796f650518046002c58ee85,Count the number of patients who were diagnosed with hypospadias but didn't come back to the hospital within 2 months in 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypospadias' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypospadias' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) = '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'hypospadias' ) AS T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'hypospadias' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T2.diagnosis_time,'start of year') = datetime(T1.diagnosis_time,'start of year') ) AS T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'hypospadias' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T2.diagnosis_time,'start of year') = datetime(T1.diagnosis_time,'start of year') AND datetime(T2.diagnosis"
732aa8afc5a1fa558876a572,What is patient 10004235's difference in weight from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT values FROM ( SELECT * FROM patient_data WHERE patient_id = 10004235 AND hospital_id = 1 ORDER BY measurement_time ASC LIMIT 1 ) - ( SELECT * FROM patient_data WHERE patient_id = 10004235 AND hospital_id = 1 ORDER BY measurement_time ASC LIMIT 1 ) )
acf40b3eb276cefbbd1f51be,What is the percentile of 8.0 in urea nitrogen given the same age as patient 10022017 on their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.0","SELECT DISTINCT T1.C1 FROM ( SELECT lab.valuenum, PERCENT_RANK() OVER ( ORDER BY lab.valuenum ) AS C1 FROM lab WHERE lab.itemid IN ( SELECTITEMID FROM labitems WHERE labitems.item LIKE '%urea nitrogen%' ) AND lab.hadm_id IN ( SELECT hadm_id FROM patients WHERE patients.age = ( SELECT patients.age FROM patients WHERE patients.subject_id = 10022017 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.0"
89602c70b4db3bc65be1d577,"List the top three most frequent lab tests that patients were given within the same month after being diagnosed with constipation, unspecified in 2100.","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.chart_time FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.patient_id WHERE diagnoses.diagnosis = 'constipation, unspecified' AND strftime('%Y',diagnoses.chart_time) = '2100' ) AS T1 JOIN ( SELECT patient.subject_id, labtests.test_name, labtests.chart_time FROM labtests JOIN patient ON labtests.patient_id = patient.patient_id WHERE strftime('%Y',labtests.chart_time) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of month') = datetime(T2.chart_time,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3."
56919090958387812584e77a,"Was lisinopril, warfarin, or heparin prescribed for patient 10012853 in their first hospital encounter?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'lisinopril', 'warfarin', 'heparin' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.patient_id = 10012853 AND prescriptions.drug IN ('warfarin', 'heparin', 'lisinopril') AND prescriptions.had_been_prescribed = 1 AND prescriptions.dischtime IS NOT NULL ORDER BY prescriptions.starttime ASC LIMIT 1"
622ee2e5af88f64d20afb970,"For patients who underwent respiratory ventilation, 24-96 consecutive hours since 2100, what were the five most common diagnoses during the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )",1. Obtain the time of patient 10007818's first diagnosis in 2100
dcc8c7bc0e4f6fed66288c9e,Which patients were diagnosed with accidental fall from bed since 2100?,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental fall from bed' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT T1.subject_id FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT * FROM diagnoses WHERE diagnosis = 'accidental fall from bed' ) AS T1 JOIN ( SELECT * FROM patients WHERE age BETWEEN 40 AND 50 ) AS T2 ON T1.subject_id = T2.subject_id ) AS T3 WHERE T3.diagnosis_time >= '2100-01-01 00:00:00'"
7bef1a39879d33661976e78e,When did patient 10025463 receive a pt laboratory test for the first time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT lab_test_date FROM lab_tests WHERE lab_test_type = 'pt' AND lab_test_patient_id = 10025463 ORDER BY lab_test_date ASC LIMIT 1
1757b6190d9346fb05196adf,What was the name of the specimen test that patient 10007818 received since 06/2100 last?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT spec_type_desc FROM ( SELECT * FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiology_events.charttime) >= '2100-06' ORDER BY microbiology_events.charttime DESC LIMIT 1 )"
204b55b1a8a2dbeafa89b76c,Retrieve the yearly maximum l pleural #1 output of patient 10009035.,"SELECT MAX(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'l pleural #1' AND d_items.linksto = 'outputevents' ) GROUP BY strftime('%Y',outputevents.charttime)",SELECT MAX(diastolic_bp) FROM ( SELECT diastolic_bp FROM procedures WHERE patient_id = 10009035 AND output_type_id = 1 )
fe7098870fdbbc057c054fdc,What are the three frequently ordered medications for patients in their 20s?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.age FROM patient WHERE patient.age BETWEEN 20 AND 29 ) AS T1 JOIN prescriptions ON T1.prescription_id = prescriptions.prescription_id GROUP BY T1.drug ) AS T1 WHERE T1.C1 <= 3"
56393496dcb520b67b7d21d8,How many patients had a bronchial washings test administered since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'bronchial washings' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patient_id ) FROM microbiology_events WHERE microbiology_events.spec_type_desc = 'bronchial washings' AND datetime(microbiology_events.charttime) >= datetime(current_time,'-1 year')"
5c069998e95156db5e7d2e7e,What is the minimum daily number of patients that are suffering from atherosclerotic heart disease of native coronary artery with unstable angina pectoris?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT COUNT(DISTINCT diagnosis_id) AS C1 FROM diagnoses WHERE diagnosis_name = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' GROUP BY strftime('%Y-%m-%d',diagnosis_time) ) AS T1"
a75bc1cf0cdc6921d07386f9,What is the average total cost for a hospital that includes a drug called heparin flush (100 units/ml)?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin flush (100 units/ml)' ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost_medication) AS C1 FROM medication_usage T1 JOIN prescriptions T2 ON T1.medication_id = T2.medication_id WHERE T2.drug_name = 'heparin flush (100 units/ml)' GROUP BY T1.hadm_id ) AS T1
f08654b0c2c58546d18b7efb,"Since 16 months ago, what specimen test did patient 10002428 receive for the last time?","SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT spec_type_desc FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND datetime(microbiology_events.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiology_events.charttime DESC LIMIT 1"
2fcffbbef2cf3c4109b6345d,Has patient 10007795 had a procedure during this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10007795 AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year')"
3a512ac7a9cacbb072843d2a,How many people received a insertion or replacement of external ventricular drain [evd] procedure within 2 months after they had been diagnosed with methicillin resistant pneumonia due to staphylococcus aureus since 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin resistant pneumonia due to staphylococcus aureus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.chart_time FROM ( SELECT subject_id, chart_time FROM diagnoses WHERE diagnosis = 'methicillin resistant pneumonia due to staphylococcus aureus' ) AS T1 JOIN ( SELECT subject_id, chart_time FROM procedures WHERE procedure = 'insertion or replacement of external ventricular drain [evd]' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T2.chart_time) BETWEEN datetime(T1.chart_time) AND datetime(T1.chart_time,'+2 month') ) AS T3"
fa7797af0bc8368e7b76a129,How much do patient 10004733's respiratory rate shifts measured at 2100-12-30 17:00:00 compared to the value measured at 2100-12-30 16:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-30 17:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-30 16:00:00' ),SELECT ( SELECT respiratory_rate FROM patients WHERE patient_id = 10004733 AND measurement_time = '2100-12-30 17:00:00' ) - ( SELECT respiratory_rate FROM patients WHERE patient_id = 10004733 AND measurement_time = '2100-12-30 16:00:00' )
ea764357f7772ceb7cc1de9d,Has patient 10019385 visited the emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.admission_location = 'emergency room',10019385 has visited the emergency room in the last year.
f03742a9f076216fb37d4c2b,When was patient 10021938's SaO2 the first time measured greater than 95.0 on last month/02?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 95.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '02' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT strftime('%Y-%m-%d', m.meas_time) FROM measurements m WHERE m.patient_id = 10021938 AND m.meas_type = 'SaO2' AND m.val_num > 95.0 AND datetime(m.meas_time,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d', m.meas_time) = '02'"
4c5b6d9ba3e9c1e0f82473db,What is the label for ai ncp - problem resolved?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'ai ncp - problem resolved',SELECT label FROM assist_diagnoses WHERE diagnosis_name = 'ai ncp - problem resolved'
f430a02bd152c617a86cd2c3,How much is patient 10038933 needed to pay for the cost of their hospital visit in 2100?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',cost.chargetime) = '2100'",SELECT SUM(cost) FROM ( SELECT cost FROM diagnoses WHERE patient_id = 10038933 AND year = 2100 UNION SELECT cost FROM procedures WHERE patient_id = 10038933 AND year = 2100 )
e6939ccdd15e65dbd229d411,What is the cost of drug called potassium chl 20 meq / 1000 ml d5lr?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' ),SELECT DISTINCT cost FROM drugs WHERE drug_name = 'potassium chl 20 meq / 1000 ml d5lr'
ed91e258dd31d6431b37bd91,What medicine was prescribed to patient 10039708 for the first time since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescription.drug FROM prescription WHERE prescription.patient_id = 10039708 AND strftime('%Y-%m',prescription.start_time) >= '2100-07' ORDER BY prescription.start_time ASC LIMIT 1"
5d31a8336f838e5062d60d2d,"Has patient 10038999 received the procedure of drainage of left pleural cavity, percutaneous approach, diagnostic in 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10038999 AND procedures.name = 'drainage of left pleural cavity, percutaneous approach, diagnostic' AND strftime('%Y',procedures.starttime) = '2100'"
91509e2b22c1e7959786b337,When did patient 10009035 first have the maximum level of free calcium during their last hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT lab.charttime FROM lab WHERE lab.patient = 10009035 AND lab.labname = 'free calcium' AND lab.charttime >= ( SELECT lab.charttime FROM lab WHERE lab.patient = 10009035 AND lab.labname = 'free calcium' ORDER BY lab.valuenum DESC, lab.charttime DESC LIMIT 1 ) ORDER BY lab.charttime ASC LIMIT 1"
e9b5ce5bc64083829c90ddd9,What are the four most frequent drugs that were prescribed to female patients in their 50s during the same hospital encounter after they were diagnosed with unspecified essential hypertension in this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'unspecified essential hypertension' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT demographics.subject_id FROM demographics WHERE demographics.gender = 'f' ) AND demographics.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start"
6985b7163e6c8b9db7102745,Count the number of times that patient 10020740 had tpn w/ lipids since 03/07/2100.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tpn w/ lipids' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-07'","SELECT COUNT(*) FROM inputevents WHERE inputevents.patient_id = 10020740 AND inputevents.item = 'tpn w/ lipids' AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-07'"
1c45da439e97eae264e4d7ce,What does warfarin cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'warfarin' ),SELECT DISTINCT cost FROM medications WHERE medication_name = 'warfarin'
6921a2f2bc13f22b2242fbf5,What's the number of patients who were diagnosed with bite of other animal except arthropod since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bite of other animal except arthropod' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM diagnoses WHERE diagnosis = 'bite of other animal except arthropod' AND strftime('%Y', diagnoses.diagnosis_time) >= '2100'"
675a37ee70bf7108f1389c55,What age was patient 10006580 in their last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,"SELECT strftime('%Y', patient.admittime) - strftime('%Y', patient.dob) FROM patient WHERE patient.subject_id = 10006580 AND patient.dischtime IS NOT NULL ORDER BY patient.admittime DESC LIMIT 1"
fdf5fc622de2b8d98e233ad6,What was the drug prescribed to patient 10020740 in 05/2100 for the first time?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescription.drug FROM prescription WHERE prescription.patient_id = 10020740 AND strftime('%Y-%m',prescription.start_time) = '2100-05' ORDER BY prescription.start_time ASC LIMIT 1"
0645a48c714ef9774ca71964,Please list the three most common procedures carried out this year.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.long_title FROM procedures AS T1 JOIN ( SELECT T2.procedure_id FROM ( SELECT procedure_id, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures AS T2 WHERE datetime(T2.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedure_id ) AS T2 ) AS T1 ON T1.procedure_id = T2.procedure_id WHERE T1.C1 <= 3"
5c5d37eab2cf65bcaafade09,"Count the number of times that patient 10010471 received the performance of urinary filtration, multiple procedure in the previous year.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of urinary filtration, multiple' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10010471 AND procedures.long_title = 'performance of urinary filtration, multiple' AND datetime(procedures.start_time,'start of year') = datetime(current_time,'start of year','-1 year')"
7ed170e256f209788ad3c985,Has there been any organism found in patient 10008454's last mrsa screen microbiological examination since 03/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1",1.0.0 has been released. There are no new questions.
2b4c020024b7a33b31862709,Calculate the total amount of input for patient 10008287 since 05/10/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-10'",SELECT SUM(input_amount) FROM ( SELECT input_amount FROM (im_str2int(input_time) - im_str2int(output_time)) * 0.000247 for output events of patient 10008287 ) WHERE input_time >= '2100-05-10'
fea7c4750795e9fe070f67ba,What was the average monthly number of patients who were diagnosed with accidental fall from bed this year?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental fall from bed' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnosis_id ) AS C1 FROM diagnoses WHERE diagnosis_name = 'accidental fall from bed' AND datetime(diagnosis_time,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m',diagnosis_time) ) AS T1"
66830a78dcd7a98c6df848db,Get me the patient IDs who were diagnosed with acute systolic heart failure since 2100.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute systolic heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT patient_id FROM diagnoses WHERE diagnosis_name = 'acute systolic heart failure' AND strftime('%Y', diagnoses.diagnosis_date) >= '2100'"
3f4da3a38522ffde6a91dfbf,What is the minimum total cost of the hospital visits when they involve other diagnostic procedures on lung or bronchus since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(T1.C1) FROM ( SELECT SUM(diagnosis_cost) AS C1 FROM diagnosis WHERE diagnosis.time >= '2100-01-01' AND diagnosis.time < '2100-01-02' AND diagnosis.category = 'other diagnostic procedures on lung or bronchus' GROUP BY diagnosis.time ) AS T1
08d0d78c62b440d145b0c56d,"What were the four most commonly given diagnoses for patients that had previously received a respiratory ventilation, 24-96 consecutive hours within 2 months, since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.charttime FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' AND strftime('%Y',procedures.charttime) >= '2100' ) AS T1 JOIN ( SELECT patient.subject_id, diagnoses.diagnosis, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE strftime('%Y',diagnoses.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.diagnosis ) AS T3 WHERE T"
c3546915506c74cfcbd2b9ce,Show me the top five most frequently prescribed medications since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM medication T1 JOIN prescription T2 ON T1.code = T2.medication_code WHERE datetime(T2.prescription_time) >= datetime(current_time,'-1 year') GROUP BY T1.drug ) AS T1 WHERE T1.C1 <= 5"
6b1fe6a4f18cb1365ffa3764,What are patient 10004720's changes in weight last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT values FROM ( SELECT * FROM patient_changes WHERE patient_id = 10004720 AND change_type = 'weight' AND hospital_id = 1 ORDER BY hospital_time ASC LIMIT 1 ) AS T1 ORDER BY hospital_time DESC LIMIT 1 ) - ( SELECT values FROM ( SELECT * FROM patient_changes WHERE patient_id = 10004720 AND change_type = 'weight' AND hospital_id = 1 ORDER BY hospital_time ASC LIMIT 1 ) AS T1 ORDER BY hospital_time DESC LIMIT 1 OFFSET 1 )
1353dc68fd8a615fdfb1a80d,What is the cost for diagnosis of other convulsions?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other convulsions' ) ),SELECT DISTINCT cost FROM sql_assistant_medical WHERE name = 'other convulsions'
282f008dd8dfb8f4a1dd6999,Tell me the name of the organism that was detected in the last urine test of patient 10027602 on their first hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism_name FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT hadm_id FROM hospital_events WHERE hospital_events.subject_id = 10027602 AND hospital_events.dischtime IS NOT NULL ORDER BY hospital_events.admittime ASC LIMIT 1 ) AND microbiology_events.spec_type_desc = 'urine' AND microbiology_events.org_name IS NOT NULL ORDER BY microbiology_events.charttime DESC LIMIT 1
0bef44d46b407af716e48911,How much of a difference is there in patient 10018328's respiratory rate measured at 2100-05-15 14:00:00 compared to the value measured at 2100-05-15 13:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-05-15 14:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-05-15 13:00:00' ),SELECT ( SELECT respiratory_rate FROM patients WHERE patient_id = 10018328 AND measurement_time = '2100-05-15 14:00:00' ) - ( SELECT respiratory_rate FROM patients WHERE patient_id = 10018328 AND measurement_time = '2100-05-15 13:00:00' )
4b28b1a0b4ccc7c20dbda5bc,What are the top four most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.output_event_id FROM ( SELECT output_event_id, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures WHERE datetime(current_time,'start time') >= datetime(current_time,'start time', '-1 year') GROUP BY output_event_id ) AS T1 WHERE T1.C1 <= 4"
e3d036a9b6ba87b79199b9e2,What was the name of the procedure that was performed two or more times since 10 months ago on patient 10020740?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-10 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT T1.long_title FROM ( SELECT procedures.long_title, COUNT( procedures.long_title ) AS C1 FROM procedures WHERE procedures.patient_id = 10020740 AND datetime(procedures.start_time) >= datetime(current_time,'-10 month') GROUP BY procedures.long_title ) AS T1 WHERE T1.C1 >= 2"
3f777e85538090faa2446aeb,"Since 1 year ago, what are the top five most commonly taken specimens for patients in the same hospital encounter after the diagnosis of intestinal infection due to other organism, not elsewhere classified?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to other organism, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis_name = 'intestinal infection due to other organism, not elsewhere classified' AND datetime(diagnoses.chart_time) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.chart_time, admissions.admission_id FROM specimens JOIN admissions ON specimens.admission_id = admissions.admission_id WHERE datetime(specimens.chart_time) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1"
7aea773bb0cb8d7705a8afa2,Calculate the length of stay in days for patient 10031757's first hospital stay.,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT strftime('%J', im_end_time) - strftime('%J', im_start_time) FROM ( SELECT admissions.im_start_time, admissions.im_end_time FROM admissions WHERE admissions.subject_id = 10031757 AND not admissions.dischtime IS NULL ORDER BY admissions.admittime ASC LIMIT 1 )"
f4668740245afefef8cada48,"Tell me the diagnosis cost of acquired absence of organ, genital organs in a patient?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of organ, genital organs' ) )","SELECT DISTINCT cost FROM sql_tasks WHERE task_name = 'diagnosis of acquired absence of organ, genital organs'"
8bfea1a0b78f2e98d30ee271,When was patient 10004422 for the first time leaving the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004422 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patient.dischtime FROM patient WHERE patient.subject = 10004422 ORDER BY patient.dischtime ASC LIMIT 1
b41f33bd6784e344776668f2,What was the first dose of 0.9% sodium chloride (mini bag plus) given to patient 10015931?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug = '0.9% sodium chloride (mini bag plus)' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(dose_amount) FROM input_events WHERE input_event_type = '0.9% sodium chloride (mini bag plus)' AND patient_id = 10015931
2e773c48c344e7f33a29892f,What was last procedure time of patient 10018423 since 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.patient = 10018423 AND strftime('%Y',procedures.starttime) >= '2100' ORDER BY procedures.starttime DESC LIMIT 1"
69c8cd3610b365b38e9dc8fb,Has patient 10004235 received the endoscopic insertion of stent (tube) into bile duct procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic insertion of stent (tube) into bile duct' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ),SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10004235 AND procedures.procedure_name = 'endoscopic insertion of stent (tube) into bile duct'
d4de34dfac56b48ccafd9eb4,Can you tell me the top three most common procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.code FROM ( SELECT T1.code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures AS T1 JOIN patients AS T2 ON T1.patient_id = T2.subject_id WHERE strftime('%Y',T1.charttime) >= '2100' GROUP BY T1.code ) AS T1 WHERE T1.C1 <= 3"
8223cedf8e150ea026676246,Tell me the name of the specimen test patient 10011398 last got since 12/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT spec_type_desc FROM ( SELECT * FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',microbiology_events.charttime) >= '2100-12' ORDER BY microbiology_events.charttime DESC LIMIT 1 )"
37b440fc3a82a50003dce7ed,"What was patient 10019385's last creatine kinase, mb isoenzyme lab test time in their last hospital encounter?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT lab.charttime FROM lab WHERE lab.patient = 10019385 AND lab.test = 'creatine kinase, mb isoenzyme' ORDER BY lab.charttime DESC LIMIT 1"
f3d8bb52562c47ecba357230,"What were the top four most frequent microbiology tests that patients were given after being diagnosed with cerebral aneurysm, nonruptured during the same month in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral aneurysm, nonruptured' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.diagnosis_time FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.patient_id WHERE diagnoses.diagnosis = 'cerebral aneurysm, nonruptured' AND strftime('%Y',diagnoses.diagnosis_time) = '2100' ) AS T1 JOIN ( SELECT patient.subject_id, microbiology.test_name, microbiology.test_time FROM microbiology JOIN patient ON microbiology.patient_id = patient.patient_id WHERE strftime('%Y',microbiology.test_time) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.test_time AND datetime(T1.diagnosis_time,'start of month') = datetime(T2.test_time,'start"
d7835456c04a228c24df961d,What is the number of patients who died after diagnosis of septic shock within 2 months during the last year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'septic shock' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-1 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE ( datetime(T3.dod) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') ) OR ( datetime(T2.charttime) BETWEEN datetime(T3.dod) AND datetime(T3.dod,'+2 month') )","SELECT COUNT( DISTINCT T2.subject ) FROM ( SELECT T1.subject, T1.charttime FROM ( SELECT subject, charttime FROM procedures WHERE charttime >= '2100-01-01' AND charttime < '2100-01-02' ) AS T1 GROUP BY subject HAVING MIN(charttime) = charttime ) AS T2 JOIN ( SELECT subject, charttime FROM diagnoses WHERE charttime >= '2100-01-01' AND charttime < '2100-01-02' ) AS T3 ON T2.subject = T3.subject WHERE T2.charttime < T3.charttime AND datetime(T3.charttime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month')"
5459fc4c053a74300114b32b,Give me the top four most commonly prescribed drugs since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT T1.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions AS T1 JOIN patients AS T2 ON T1.patient_id = T2.subject_id WHERE strftime('%Y',T1.starttime) >= '2100' GROUP BY T1.drug ) AS T1 WHERE T1.C1 <= 4"
32bb1be23959c4c55393389e,What was the insurance name of patient 10035185 during their last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.insurance FROM patients WHERE patient.subject_id = 10035185 AND patient.dischtime IS NOT NULL ORDER BY patient.admittime DESC LIMIT 1
cd8edc01787dda933e12fd99,When patient 10021312 had the first void output since 09/16/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-09-16' ORDER BY outputevents.charttime ASC LIMIT 1","SELECT strftime('%Y-%m-%d', output.charttime) as output_time
         FROM (
         SELECT chartitems.itemid, chartitems.charttime
         FROM chartitems
         WHERE chartitems.itemid IN (
         SELECT items.itemid
         FROM items
         WHERE items.itemtype = 'output'
         AND items.value = 'void'
         )
         AND strftime('%Y-%m-%d', chartitems.charttime) >= '2100-09-16'
         ORDER BY chartitems.charttime ASC
         LIMIT 1
         ) as output
         JOIN patients ON output.itemid = patients.subjectid
         WHERE patients.subjectid = 10021312"
8dabcc278b6954eec05639ff,What is the total amount of dextrose 5% input that patient 10039831 got since 02/05/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-05'",SELECT SUM(input_amount) FROM input_events WHERE input_type = 'dextrose 5%' AND patient_id = 10039831 AND start_time >= '2100-02-05'
bc98931efa8f80d2a3e2aa4d,What were the specimen tests that patient 10002930 first had in 08/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime ASC LIMIT 1",1. retrieve the specimen test for patient 10002930 in 08/this year
7e06fac998444826d31f711c,"In 2100, what is the top three most frequent diagnoses that patients had within 2 months after receiving anastomosis of hepatic duct to gastrointestinal tract?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.charttime FROM procedures JOIN patient ON procedures.subject_id = patient.subject_id WHERE procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' AND strftime('%Y',procedures.charttime) = '2100' ) AS T1 JOIN ( SELECT patient.subject_id, diagnoses.diagnosis, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.subject_id = patient.subject_id WHERE strftime('%Y',diagnoses.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.diagnosis ) AS T3 WHERE"
9fef61b6024912cd87201c6a,What are the top three most common diagnoses that patients had within 2 months after receiving injection of anesthetic into spinal canal for analgesia this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection of anesthetic into spinal canal for analgesia' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.charttime FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.procedure = 'injection of anesthetic into spinal canal for analgesia' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient.subject_id, diagnoses.diagnosis, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"
f147512eb438041a5186bf3e,What was the total output of patient 10014354 since 09/07/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-09-07'",SELECT SUM(output) FROM ( SELECT output FROM ( SELECT * FROM input_data WHERE subject_id = 10014354 ) WHERE input_time >= '2100-09-07' )
ca02915764bab9c149d0c83e,"What are the four most commonly taken specimens that patients were tested in the same hospital encounter after receiving a respiratory ventilation, 24-96 consecutive hours procedure since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.chart_time, admissions.admission_id FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id WHERE procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' AND strftime('%Y',procedures.chart_time) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.chart_time, admissions.admission_id FROM specimens JOIN admissions ON specimens.admission_id = admissions.admission_id WHERE strftime('%Y',specimens.chart_time) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1.admission_id"
7fef015e3c73d010f8ac487e,What is the count of patients who were in the coronary care unit (ccu) careunit in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'coronary care unit (ccu)' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM ( SELECT patient_id FROM procedures WHERE procedure_name = 'coronary care unit (ccu) careunit' AND strftime('%Y',procedures.charttime) = '2100' )"
1fcac336ef5d4a18372aeae5,What was the last prescribed dose of docusate sodium (liquid) that patient 10021487 got during the current hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'docusate sodium (liquid)' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT prescriptions.dose_last FROM prescriptions WHERE prescriptions.patient_id = 10021487 AND prescriptions.drug = 'docusate sodium (liquid)' AND prescriptions.starttime >= ( SELECT admissions.starttime FROM admissions WHERE admissions.subject = 10021487 AND admissions.dischtime IS NULL ) ORDER BY prescriptions.starttime DESC LIMIT 1
96b1d3fe1090aafcf5bcc954,When did patient 10008454 first have foley output since 12/04/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-04' ORDER BY outputevents.charttime ASC LIMIT 1","SELECT strftime('%Y-%m-%d', output.starttime) FROM ( SELECT io_history.history_id, io_history.starttime FROM io_history WHERE io_history.patient_id = 10008454 AND io_history.output_type_id = 5 AND strftime('%Y-%m-%d', io_history.starttime) >= '2100-12-04' ) AS output ORDER BY output.starttime ASC LIMIT 1"
e82244401b22ffb372a139b9,"What is the minimum total hospital cost when it includes measurement of cardiac sampling and pressure, left heart, percutaneous approach?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(C1) AS C1 FROM ( SELECT C1 FROM ( SELECT C1 FROM diagnoses WHERE C1 = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) AS T1 JOIN patients AS T2 ON T1.patient_id = T2.patient_id ) AS T3 JOIN prescriptions AS T4 ON T3.patient_id = T4.patient_id ) AS T5;</s>"
31bc055f744e30a632a2f021,Count the number of patients who had a lactate dehydrogenase (ld) test done since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND strftime('%Y',labevents.charttime) >= '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM lab_test WHERE lab_test_name = 'lactate dehydrogenase (ld)' AND strftime('%Y',test_time) >= '2100'"
7559da6b7b189084f45242ea,Was patient 10020944 to the e.r. in their first hospital visit?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*)>0 FROM checkouts WHERE checkouts.patient_id = 10020944 AND checkouts.location = 'emergency room' AND checkouts.in_time >= ( SELECT admissions.in_time FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.in_time ASC LIMIT 1 )
dd1f1e6825a6f105f91f7d0e,"What proportion of patients with a diagnosis of spinal stenosis, lumbar region, with neurogenic claudication survive over a 6-month period?","SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/2 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, with neurogenic claudication' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT COUNT( DISTINCT patient.subject_id ) FROM patient WHERE patient.diagnosis = 'SPINAL STENOSIS, LUMBAR REGION, WITH NEUROGENIC CLAUDICTION' AND patient.discharge_time IS NOT NULL AND datetime(patient.discharge_time) >= datetime(current_time,'-6 month')"
101023c9d00c778450601539,Calculate the length of stay in days for patient 10007928's last hospital stay.,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","SELECT strftime('%J',im_end) - strftime('%J',im_start) FROM ( SELECT * FROM hospital WHERE patient_id = 10007928 AND not im_start IS NULL ORDER BY im_start DESC LIMIT 1 )"
f9ae9091bbfcec86ccce09d6,"In 2100, what was the top three most frequent laboratory tests ordered for patients after the diagnosis of family history of malignant neoplasm of prostate during the same month?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of prostate' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE diagnoses.diagnosis = 'family history of malignant neoplasm of prostate' AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT patient.subject_id, labtests.test_name, labtests.charttime FROM labtests JOIN patient ON labtests.patient_id = patient.subject_id WHERE strftime('%Y',labtests.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <="
9d55be8800c23366c5a86393,How many patients during the previous year were given a bicarbonate test?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patient_id ) FROM lab_results WHERE lab_name = 'bicarbonate' AND datetime(result_date,'start of year') = datetime(current_date,'start of year','-1 year')"
c814a79881c8be3a4809fdb9,Get patient 10018423's monthly minimum weight information in 2100.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT MIN(T1.weight) FROM ( SELECT weight FROM patients WHERE patient_id = 10018423 AND strftime('%Y',inputtime) = '2100' GROUP BY strftime('%Y-%m',inputtime) ) AS T1"
71f42d6affc0c51c8579d29f,Find out the number of patients who were discharged from the hospital.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT( DISTINCT patient_id ) FROM discharge_log WHERE status = 'discharged'
e134d64a96cc7940427b44cf,Did patient 10003046 get a pco2 test in their last hospital visit?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*)>0 FROM tests WHERE tests.patient_id = 10003046 AND tests.test_name = 'pco2' AND tests.charttime >= ( SELECT admissions.charttime FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.charttime DESC LIMIT 1 )
99659e62f4677c9b6f10903d,"What is the minimum monthly number of patients that are suffering from allergic rhinitis, cause unspecified since 1 year ago?","SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'allergic rhinitis, cause unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT COUNT(DISTINCT diagnosis_of_last_month) AS C1 FROM patients WHERE diagnosis_of_last_month = 'allergic rhinitis, cause unspecified' AND datetime(diagnosis_of_last_month,'start of year') = datetime(current_time,'start of year','-1 year') GROUP BY strftime('%Y-%m',diagnosis_of_last_month) ) AS T1"
f64502ea7695fae28227dfce,Did patient 10005817 receive solution on 12/24/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'",SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.patient_id = 10005817 AND inputevents.starttime >= '2100-12-24 00:00:00' AND inputevents.starttime < '2100-12-24 00:00:00' AND inputevents.data = 'solution'
8101d176c45f4e285b9e9540,How many patients were prescribed the medicine ferric gluconate within 2 months after a diagnosis of ankylosing spondylitis since 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'ankylosing spondylitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ferric gluconate' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject ) FROM ( SELECT T1.subject, diagnose_time FROM diagnoses AS T1 JOIN prescriptions AS T2 ON T1.diagnosis_id = T2.diagnosis_id WHERE T1.diagnosis = 'ankylosing spondylitis' AND strftime('%Y',T1.diagnose_time) >= '2100' ) AS T1 JOIN prescriptions AS T2 ON T1.subject = T2.subject WHERE T2.drug = 'ferric gluconate' AND strftime('%Y',T2.starttime) >= '2100'"
3c23367e7687645342a44a61,Show me the top three most commonly prescribed drugs during the same month for patients in their 30s after a unspecified essential hypertension diagnosis.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 39 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.age, diagnosis.charttime FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.patient_id WHERE diagnosis.diagnosis = 'unspecified essential hypertension' ) AS T1 JOIN ( SELECT patient.patient_id, prescription.drug, prescription.starttime FROM prescription JOIN patient ON prescription.patient_id = patient.patient_id WHERE patient.age BETWEEN 30 AND 39 ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3"
2c251f13cfc63c34883bcbcd,Has there been any microbiological urine tests for patient 10005348 in 08/last year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',microbiologyevents.charttime) = '08'","SELECT COUNT(*)>0 FROM microbiology_events WHERE microbiology_events.patient_id = 10005348 AND microbiology_events.spec_type_desc = 'urine' AND datetime(microbiology_events.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',microbiology_events.charttime) = '08'"
740f87417b7715602b678286,"Did patient 10029484 have any tests for creatine kinase, mb isoenzyme during the previous month?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT COUNT(*)>0 FROM lab_test WHERE lab_test.patient_id = 10029484 AND lab_test.test_name IN ('creatine kinase, mb isoenzyme') AND datetime(lab_test.charttime,'start of month') = datetime(current_time,'start of month','-1 month')"
5c22be4f508798bea10dfa73,"What is the 3-month survival rate for patients diagnosed with pleural effusion, not elsewhere classified.","SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pleural effusion, not elsewhere classified' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","3-month survival rate for patients diagnosed with pleural effusion, not elsewhere classified."
43da3486df026843872b9af4,What was the admission type for patient 10019172's first hospital admission?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1",SELECT admission_type FROM ( SELECT * FROM hospital_admissions WHERE subject_id = 10019172 ORDER BY hospital_admission_time ASC LIMIT 1 )
f5b332414c271567297ba2c9,When did patient 10022041 first have an input event?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) ORDER BY inputevents.starttime ASC LIMIT 1,SELECT input_time FROM input_events WHERE subject_id = 10022041 ORDER BY input_time ASC LIMIT 1
01eb9179a54a0f80fb0189a6,"For patients diagnosed with pain in left shoulder previously, what are the top five most common procedures applied within 2 months in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in left shoulder' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.code FROM ( SELECT T2.code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM diagnoses WHERE diagnosis = 'pain in left shoulder' ) AS T1 JOIN ( SELECT subject_id, charttime FROM procedures ) AS T2 ON T1.subject_id = T2.subject_id AND T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.code ) AS T3 WHERE T3.C1 <= 5"
393ccf93d06553bf2947a17a,What are the four most frequent drugs that were prescribed to male patients in their 30s during the same month after they were diagnosed with hyposmolality and/or hyponatremia during this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyposmolality and/or hyponatremia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 30 AND 39 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'hyposmolality and/or hyponatremia' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 30 AND 39 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_"
949dc9ac2dfec702b23219cc,Tell me the top four most frequent diagnoses of patients of age 40s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.diagnosis FROM ( SELECT diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM patients WHERE patients.age BETWEEN 40 AND 49 GROUP BY diagnosis ) AS T1 WHERE T1.C1 <= 4"
5e15ef576080a675d598f4f4,How many current patients are of 60 or above age?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE age >= 60
eccaf3ea4033b34c3afac111,Tell me the percentile of creatinine of 2.7 in patients of the same age as patient 10016150 on the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.7","SELECT DISTINCT T1.C1 FROM ( SELECT lab.value, PERCENT_RANK() OVER ( ORDER BY lab.value ) AS C1 FROM lab WHERE lab.label = 'creatinine' AND lab.patient = 10016150 AND lab.age = 0 ) AS T1 WHERE T1.value = 2.7"
92f0b914005e5b93474fac4e,Can you name the first outputs of patient 10013049 in their last ICU visit?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 ),"SELECT strftime(ICUStays.outtime, '%output') as output FROM ICUStays WHERE ICUStays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND ICUStays.outtime IS NOT NULL ORDER BY ICUStays.intime DESC LIMIT 1"
e0693814cc896b83b3416d2d,Is the value of respiratory rate in patient 10016742 from second measurement on the first ICU visit greater than its first measurement on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT lab_value FROM ( SELECT * FROM icu_visits WHERE icu_visits.icu_stay_id IN ( SELECT icu_stays.icu_stay_id FROM icu_stays WHERE icu_stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icu_stays.outtime IS NOT NULL ORDER BY icu_stays.intime ASC LIMIT 1 ) AS icu_visits_val WHERE icu_visits_val.charttime = ( SELECT lab_charttime FROM lab_results WHERE lab_results.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND lab_results.label = 'respiratory rate' AND icu_visits_val.icu_stay_id = icu_visits_val.icu_stay_id ORDER BY lab_charttime ASC LIMIT 1 OFFSET 1 ) ) > ( SELECT
37d260bf174746e3b0f83bb0,"What are the five most commonly prescribed drugs for patients diagnosed with postprocedural fever previously within the same hospital visit, in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural fever' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'postprocedural fever' AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.admission_id FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.admission_id = T2.admission_id GROUP BY T2.drug ) AS T3"
4a73f78af6f830619516e24b,When did patient 10005909 experience the last instance where their heart rate was less than 115.0 in their last ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 115.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT icu.outtime FROM icu WHERE icu.inpatient_id IN ( SELECT patient.id FROM patient WHERE patient.age < 24 ) AND icu.outtime >= ( SELECT prescription.starttime FROM prescription WHERE prescription.drug = 'nifedipine' AND prescription.patient = 10005909 AND icu.inpatient_id = prescription.inpatient_id ORDER BY prescription.starttime DESC LIMIT 1 ) AND icu.outtime <= ( SELECT measurements.starttime FROM measurements WHERE measurements.patient = 10005909 AND measurements.heartrate < 115.0 AND icu.inpatient_id = measurements.inpatient_id ORDER BY measurements.starttime DESC LIMIT 1 ) ORDER BY icu.outtime DESC LIMIT 1
5cf885d109f3f215844f994e,How many hours have passed since patient 10004733's last stay in careunit medical/surgical intensive care unit (micu/sicu) in this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' AND transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject = 10004733 AND admissions.dischtime IS NULL ) ORDER BY transfers.intime DESC LIMIT 1"
62a5029a9781c0cb6bcc7ce6,What new prescriptions were given to patient 10004733 today compared to those given yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT T1.drug FROM ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10004733 AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') ) AS T1 JOIN ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10004733 AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day') ) AS T2 ON T1.drug = T2.drug WHERE T1.starttime < T2.starttime"
f1dd398aaf1b00d4a562b899,How much is the difference of weights of patient 10037975 second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT weight FROM patients WHERE patients.subject_id = 10037975 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime DESC LIMIT 1 ) - ( SELECT weight FROM patients WHERE patients.subject_id = 10037975 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime DESC LIMIT 1 OFFSET 1 )
a4aeae6cbe8fff13d7e4d651,What was the total output amount for patient 10014729 on 03/05/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-05'","SELECT SUM(output_amount) FROM ( SELECT output_amount FROM medical_log WHERE patient_id = 10014729 AND datetime(log_time,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',log_time) = '03-05' )"
1cb7346d2299d0467b9fcb27,"In 03/last year, was the respiratory rate of patient 10020187 ever greater than 12.0?","SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 12.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',chartevents.charttime) = '03'","SELECT COUNT(*)>0 FROM vital_signs WHERE vital_signs.patient_id = 10020187 AND vital_signs.respiratory_rate > 12.0 AND datetime(vital_signs.chart_time,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',vital_signs.chart_time) = '03'"
8c531cd9b0af5ba949b9fa91,How many hours have it been since patient 10021487's first free calcium lab test during their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', lab.charttime) ) FROM lab WHERE lab.patient = 10021487 AND lab.label = 'free calcium' AND lab.charttime >= ( SELECT lab2.charttime FROM lab as lab2 WHERE lab2.patient = 10021487 AND lab2.label = 'free calcium' ORDER BY lab2.charttime ASC LIMIT 1 )"
6bb8d0b3a6e2b6227b56f595,Tell me patient 10038081's first oxygen value on the first hospital stay.,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen' ) ORDER BY labevents.charttime ASC LIMIT 1,"SELECT MIN(O2) FROM ( SELECT O2 FROM ( SELECT CSF, O2, NOS FROM ( SELECT CSF, O2, NOS, TIME FROM ( SELECT CSF, O2, NOS, TIME, D/O2 CSF FILTER ( WHERE CSF < 100.0 AND CSF > 0.0 ) ) AS C1 ) AS C2 ) AS C3 ) AS C4 WHERE C4.time >= ( SELECT TIME FROM ( SELECT TIME FROM ( SELECT CSF, O2, NOS, TIME FROM ( SELECT CSF, O2, NOS, TIME, D/O2 CSF FILTER ( WHERE CSF < 100.0 AND CSF > 0.0 ) ) AS C1 ) AS C2 ) AS C3 ) AND C4.time <= ( SELECT TIME FROM ( SELECT TIME FROM ( SELECT CSF, O2, NOS, TIME FROM ( SELECT CSF, O2, NOS, TIME, D/O2 CSF FILTER ( WHERE CSF < 100.0 AND CSF > 0.0 )"
ec89baea1f34f1904eed2a70,"Among patients who were prescribed with potassium chl 40 meq / 1000 ml ns, what are the top four most frequently prescribed drugs at the same time since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'potassium chl 40 meq / 1000 ml ns' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM prescriptions WHERE drug = 'potassium chl 40 meq / 1000 ml ns' ) AS T1 JOIN ( SELECT subject_id, charttime FROM prescriptions ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime >= ( SELECT current_time, '-1 year' ) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4"
89a854beb29f40da67997b3c,What was patient 10039831's first diastolic blood pressure value since 12/13/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-13' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(diastolic_bp) FROM ( SELECT diastolic_bp FROM ( SELECT patient_id, blood_pressure FROM ( SELECT patient_id, measurement_time, value FROM ( SELECT patient_id, value, measurement_time, 'diastolic' as measurement_type, '2100-12-13' as measurement_time_offset FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT patient_id, value, measurement_time FROM ( SELECT"
7a1d975dc39f51887f287327,Is patient 10020944 recorded as male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020944,SELECT gender FROM patients WHERE patient_id = 10020944
0552fb2fb3c9ef8054e31fe0,How many times since 2100 did patient 10005817 visit the hospital?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10005817 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT(*) FROM hospital_history WHERE hospital_history.patient_id = 10005817 AND strftime('%Y', hospital_history.admittime) >= '2100'"
2e3cccfa4f52265b94f8579f,What is the minimum total hospital cost involving a procedure named thoracentesis in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracentesis' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(C2.C3) AS C1 FROM procedure AS C2 JOIN cost_table AS C3 ON C2.C3 = C3.C3 WHERE C2.C1 = 'thoracentesis' AND strftime('%Y',C2.C2) = '2100' GROUP BY C2.C1 ) AS T1"
dc1ccc85cf5b684ab55c2b09,Can you tell me the number of patients who were prescribed methylnaltrexone?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylnaltrexone' ),SELECT COUNT( DISTINCT patient_id ) FROM prescriptions WHERE prescription_name = 'methylnaltrexone'
96ac404e31dae66aaf3c7df0,How much difference is there in respiratory rate levels among patient 10019777 last measured on the last ICU visit compared to the value second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT lab_data.valuenum FROM lab_data WHERE lab_data.hadm_id IN ( SELECT icu.hadm_id FROM icu WHERE icu.hadm_id IN ( SELECT patient.hadm_id FROM patient WHERE patient.subject_id = 10019777 AND icu.outtime IS NOT NULL ORDER BY icu.intime DESC LIMIT 1 ) ) AND lab_data.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'respiratory rate' ) ORDER BY lab_data.charttime DESC LIMIT 1 ) - ( SELECT lab_data.valuenum FROM lab_data WHERE lab_data.hadm_id IN ( SELECT icu.hadm_id FROM icu WHERE icu.hadm_id IN ( SELECT patient.hadm_id FROM patient WHERE patient.subject_id = 10019777 AND icu.outtime IS NOT NULL ORDER BY icu.intime DESC LIMIT 1 ) ) AND lab_data.itemid IN ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'resp
7329fbf5056c86af263e9033,Could you show me the total void output of patient 10024043?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ),SELECT SUM(output_void) FROM ( SELECT output_void FROM medical_log WHERE patient_id = 10024043 )
e94fc44f50cb46d93aaa3008,Could you show me the top five most common diagnoses since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.diagnosis, COUNT( T1.diagnosis ) FROM diagnoses AS T1 JOIN patients AS T2 ON T1.patient_id = T2.subject_id WHERE strftime('%Y', T1.charttime) >= '2100' GROUP BY T1.diagnosis ORDER BY COUNT( T1.diagnosis ) DESC LIMIT 5"
99674b531e81a982dc797973,"What are the five most common microbiology tests for patients that had previously received introduction of other thrombolytic into peripheral vein, percutaneous approach within the same hospital visit since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into peripheral vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.chart_time, patient.hadm_id FROM procedures JOIN patient ON procedures.subject_id = patient.subject_id WHERE procedures.long_title = 'introduction of other thrombolytic into peripheral vein, percutaneous approach' AND strftime('%Y',procedures.chart_time) >= '2100' ) AS T1 JOIN ( SELECT patient.subject_id, microbiology.test_name, microbiology.chart_time, patient.hadm_id FROM microbiology JOIN patient ON microbiology.subject_id = patient.subject_id WHERE strftime('%Y',microbiology.chart_time) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1.hadm_id = T2.hadm_id GROUP BY T"
94122ab2640e86cea1d8cefe,Retrieve the top four most frequent procedures that patients underwent in the same hospital visit after being diagnosed with noncompliance with renal dialysis.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.long_title FROM ( SELECT T2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.long_title = 'noncompliance with renal dialysis' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.long_title, procedures.charttime, admissions.admission_id FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.admission_id = T2.admission_id GROUP BY T2.long_title ) AS T3 WHERE T3.C1 <= 4"
805a7efe25e2ce496220ee26,What was the admission type during the first hospital admission for patient 10019172?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1",SELECT admission_type FROM ( SELECT * FROM hospital_admissions WHERE subject_id = 10019172 ORDER BY hospital_admission_time ASC LIMIT 1 )
c58538af9651b0425098d396,"In 07/2100, when was the first time patient 10020786 was prescribed medication via the iv drip route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND prescriptions.route = 'iv drip' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1",SELECT MIN(starttime) FROM ( SELECT starttime FROM prescriptions WHERE patient = 10020786 AND route = 'iv drip' AND starttime >= '2100-07-21 00:00:00' )
db7f20610bfa0be1f5377ba9,What was the admission type during the first hospital admission for patient 10021118?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10021118 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1",SELECT admission_type FROM ( SELECT * FROM hospital_admissions WHERE subject_id = 10021118 ORDER BY hospital_admission_time ASC LIMIT 1 )
89fa29a6a2fb6b1fff321ece,How is ferrous sulfate (liquid) delivered?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)',SELECT DISTINCT prescription_route FROM prescriptions WHERE prescription_drug = 'ferrous sulfate (liquid)'
536c8f181f6fd31f9a127cfa,What were the number of patients discharged from the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE status = 'discharged'
1718f0835a82b0bb7c0517f1,"Since 14 months ago, what was the weight of patient 10016742 in the first measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(CasualtyDepartment.Weight) FROM CASUALTYDEPARTMENT WHERE CasualtyDepartment.PatientId = 10016742 AND datetime(CasualtyDepartment.MeasurementTime) >= datetime(current_time,'-14 month')"
c2cedc6cff27f2430e1a1578,"When was the first time patient 10026354 was diagnosed with dislocation of jaw, initial encounter since 2100?","SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dislocation of jaw, initial encounter' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT diagnosis_time FROM diagnoses WHERE patient_id = 10026354 AND strftime('%Y',diagnosis_time) >= '2100' ORDER BY diagnosis_time ASC LIMIT 1"
2294e45331b6e84efb7132a1,Can you list the top three diagnoses that have the highest mortality rate in a 6-month period?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT T1.diagnosis_name FROM ( SELECT diagnosis_name, DENSE_RANK() OVER ( ORDER BY mortality_rate DESC ) AS C1 FROM ( SELECT diagnosis_name, ( SELECT MAX(percent_change) FROM ( SELECT * FROM ( SELECT diagnosis_name, ( SELECT data from ( SELECT * FROM diagnosis_name, 10000.0 * ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( ("
b8a7d87b64afb7722910bc4f,Was or cell saver intake given during their first ICU visit to patient 10009035?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*)>0 FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1
7d6a60231fdec5e1629a3890,What is the maximum total hospital cost of a hospital involving esophageal obstruction?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal obstruction' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM(C1) AS C1 FROM ( SELECT C1 FROM diagnoses WHERE LOWER(DIAGNOSIS) = 'esophageal obstruction' ) AS T1 JOIN patients AS T2 ON T1.PID = T2.PID GROUP BY T1.PID ) AS T3
ac9de4303d9e69514c759992,What was the organism found in the last urine microbiology test for patient 10038081?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism FROM microbiology_test WHERE microbiology_test.patient_id = 10038081 AND microbiology_test.spec_type_desc = 'urine' AND microbiology_test.charttime >= ( SELECT microbiology_test.charttime FROM microbiology_test WHERE microbiology_test.patient_id = 10038081 AND microbiology_test.spec_type_desc = 'urine' ORDER BY microbiology_test.charttime DESC LIMIT 1 ) ORDER BY microbiology_test.charttime ASC LIMIT 1
039311889be460387c195635,Find out how many patients were admitted to the hospital since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT( DISTINCT patient_id ) FROM hospital WHERE datetime(admittime) >= datetime(current_time,'-1 year')"
52f44dd4ca70f2538c5fdcb9,How many patients received a diagnostic ultrasound of digestive system after the procedure of arteriography of other intra-abdominal arteries in 2100 within the same hospital visit?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.chart_time, T1.hadm_id FROM ( SELECT subject_id, chart_time, hadm_id FROM procedures WHERE procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AS T1 JOIN ( SELECT subject_id, chart_time, hadm_id FROM diagnoses WHERE diagnoses.long_title = 'diagnostic ultrasound of digestive system' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1.hadm_id = T2.hadm_id ) AS T1 JOIN ( SELECT admissions.subject_id, admissions.hadm_id, admissions.chart_time FROM admissions WHERE admissions.dischtime is null ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1.hadm_id = T2.hadm_id AND"
712595edb391862c04d6ec79,Calculate the length of stay in days for patient 10022041's first hospital stay.,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT strftime('%J', im_end_time) - strftime('%J', im_start_time) FROM ( SELECT admissions.im_start_time, admissions.im_end_time FROM admissions WHERE admissions.subject_id = 10022041 AND not admissions.dischtime IS NULL ORDER BY admissions.admittime ASC LIMIT 1 )"
e4389d5bea696426df9502a9,What is the maximum total cost for a hospital that includes laboratory testing for phenytoin?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phenytoin' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.event_type = 'laboratory' AND cost.event_id IN ( SELECT lab.event_id FROM lab WHERE lab.item = 'phenytoin' ) GROUP BY cost.event_id ) AS T1
c09d11621a07d7d859c16278,When was the last time that patient 10014354 has the maximum SaO2 value since 08/19/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-19' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1","SELECT MAX(SaO2) FROM ( SELECT SaO2 FROM procedures WHERE patient_id = 10014354 AND strftime('%Y-%m-%d',procedures.starttime) >= '2100-08-19' )"
499ce7704b771e8824db29e3,Provide the sum of inputs for patient 10024043.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) ),SELECT SUM(inputs) FROM ( SELECT input_events.total_amount AS inputs FROM input_events WHERE input_events.patient_id = 10024043 )
c8ca9d1df94e051908c998f8,When was patient 10009628 last prescribed with 0.9% sodium chloride and neostigmine at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10009628 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'neostigmine' AND admissions.subject_id = 10009628 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT T1.starttime FROM ( SELECT patient_id, prescription_id, starttime FROM prescription_log WHERE patient_id = 10009628 AND prescription_id = ( SELECT prescription_id FROM prescription_log WHERE patient_id = 10009628 AND prescription = '0.9% sodium chloride' ) ) AS T1 JOIN ( SELECT patient_id, prescription_id, starttime FROM prescription_log WHERE patient_id = 10009628 AND prescription_id = ( SELECT prescription_id FROM prescription_log WHERE patient_id = 10009628 AND prescription = 'neostigmine' ) ) AS T2 ON T1.patient_id = T2.patient_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1"
87cf5dab12223c160741d4a7,"What are the four most commonly prescribed drugs for patients who were diagnosed with urinary incontinence, unspecified previously within the same month?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary incontinence, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.patient_id WHERE diagnoses.diagnosis = 'urinary incontinence, unspecified' ) AS T1 JOIN ( SELECT patient.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN patient ON prescriptions.patient_id = patient.patient_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4"
cada9d0e90575a50cef72fe4,What was patient 10007818's diastolic blood pressure at the last measurement since 06/22/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-22' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT diastolic_bp FROM ( SELECT * FROM ( SELECT patient_id, measurement_time, values FROM ( SELECT patient_id, measurement_time, values FROM ( SELECT patient_id, '2100-06-22'::TIMESTAMP, 0.0 FROM ( SELECT patient_id, '2100-06-22'::TIMESTAMP, 0.0 FROM patients WHERE patient_id = 10007818 ) ) ) AS first_measurements JOIN ( SELECT patient_id, measurement_time, values FROM ( SELECT patient_id, '2100-06-22'::TIMESTAMP, 0.0 FROM patients WHERE patient_id = 10007818 ) ) AS second_measurements ON first_measurements.patient_id = second_measurements.patient_id WHERE first_measurements.measurement_time < second_measurements.measurement_time ) AS filtered_data ORDER BY filtered_data.measurement_time DESC LIMIT 1"
f97ed282c4c48f5e86f5b1e6,Is the value of patient 10019385's rdw-sd last measured on the last hospital visit less than the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10019385 AND lab_tests.spec_type_desc = 'rdw-sd' AND lab_tests.charttime >= ( SELECT lab_tests.charttime FROM lab_tests WHERE lab_tests.patient_id = 10019385 AND lab_tests.spec_type_desc = 'rdw-sd' AND lab_tests.charttime = ( SELECT MAX(charttime) FROM lab_tests WHERE lab_tests.patient_id = 10019385 AND lab_tests.spec_type_desc = 'rdw-sd' AND lab_tests.charttime >= ( SELECT patient.age FROM patient WHERE patient.subject_id = 10019385 AND patient.dischtime IS NOT NULL ORDER BY patient.admittime DESC LIMIT 1 ) ) ) AND lab_tests.charttime <= ( SELECT patient.charttime FROM patient WHERE patient.subject_id = 10019385 AND patient.dischtime IS NOT NULL ORDER BY
4786a778a2cfb99246eefeb8,What is the average total cost of a hospital bill that includes a drug called ranitidine (liquid) since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ranitidine (liquid)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost_med) AS C1 FROM medication_usage T1 JOIN prescriptions T2 ON T1.medication_id = T2.medication_id WHERE T2.drug = 'ranitidine (liquid)' AND strftime('%Y',T1.starttime) >= '2100' GROUP BY T1.subject_id ) AS T1"
28070d8edf72fb2952e28930,Count the number of times patient 10040025 went to the hospital during this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10040025 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.charttime FROM ( SELECT subject_id, charttime FROM procedures WHERE subject_id = 10040025 ) AS T1 JOIN ( SELECT subject_id, charttime FROM diagnoses WHERE subject_id = 10040025 ) AS T2 ON T1.subject_id = T2.subject_id ) AS T2 JOIN ( SELECT subject_id, charttime FROM admissions WHERE subject_id = 10040025 ) AS T3 ON T2.subject_id = T3.subject_id WHERE T2.charttime < T3.charttime AND datetime(T2.charttime,'start of year') = datetime(T3.charttime,'start of year')"
b6e85f562fb3d32bcc7d415f,"Since 02/2100, what was patient 10021487's first microbiology test time?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiology.chart_time FROM microbiology WHERE microbiology.patient_id = 10021487 AND strftime('%Y-%m',microbiology.chart_time) >= '2100-02' ORDER BY microbiology.chart_time ASC LIMIT 1"
bba49bd752af25f7a63d7766,What was the admission type for patient 10002930's last hospital admission?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10002930 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10002930 ORDER BY admissions.admittime DESC LIMIT 1
06fbb15466649cd31a1f3b18,What was the name of the organism found at the first pleural fluid test of patient 10014729 since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1",1. what was the organism at the first pleural fluid test of patient 10014729 since 02/2100?
93b59f146da8ee5c67716875,List the top four most frequent diagnoses that patients received in the same month after receiving hemodialysis in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.diagnosis_name FROM ( SELECT T2.diagnosis_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM procedures WHERE procedure_name = 'hemodialysis' ) AS T1 JOIN ( SELECT subject_id, diagnosis_name FROM diagnoses ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < '2100-01-01' AND T1.charttime >= '2100-01-01' ) AS T3 WHERE T3.C1 <= 4"
e56ea93964e30564ef0d8599,What is the four most frequently given microbiology tests since 2100 for patients who were previously diagnosed with cardiac arrest due to underlying cardiac condition in the same hospital encounter?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac arrest due to underlying cardiac condition' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'cardiac arrest due to underlying cardiac condition' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiology.test_name, microbiology.charttime, admissions.admission_id FROM microbiology JOIN admissions ON microbiology.admission_id = admissions.admission_id WHERE strftime('%Y',microbiology.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.admission_id = T2.admission_id GROUP BY T2"
e198cf387b6b22216a593d12,Please show the total amount of output patient 10004720 had since 02/08/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-08'","SELECT SUM(output_amount) FROM ( SELECT output_amount FROM ( SELECT patient_id, output_amount FROM procedures WHERE patient_id = 10004720 ) UNION ALL SELECT patient_id, output_amount FROM prescriptions ) WHERE patient_id = 10004720 AND strftime('%Y-%m-%d',input_time) >= '2100-02-08'"
dc8216b0660d0fb91f366b9e,Have there been any procedures conducted on patient 10001725 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10001725 AND strftime('%Y',procedures.starttime) >= '2100'"
bc8d116f59e4fd75687ea181,What new medications were introduced for patient 10004733 today compared to the ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT T1.drug FROM ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10004733 AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') ) AS T1 JOIN ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10004733 AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day') ) AS T2 ON T1.drug = T2.drug WHERE T1.starttime < T2.starttime"
3e8b5080c946a24c2fb71498,Count the number of times that patient 10021487 during their first ICU visit had a or urine output.,SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ),SELECT COUNT(*) FROM icu WHERE icu.hadm_id IN ( SELECT hadm_id FROM hadm_table WHERE hadm_table.subject = 10021487 AND icu.outtime IS NOT NULL ORDER BY icu.intime ASC LIMIT 1 ) AND icu.output = 'or urine'
753a40539d0be72d6bec0d1c,"Since 2100, what were the five most frequently requested specimen tests?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.spec_type_desc FROM ( SELECT T1.subject_id, T2.spec_type_desc FROM microbiologyevents AS T1 JOIN microbiologyeventitems AS T2 ON T1.row_id = T2.row_id WHERE T1.charttime >= '2100-01-01' ) AS T1 GROUP BY T2.spec_type_desc ) AS T2 WHERE T1.C1 <= 5"
36c85f3d6859ff6ac14e46d4,What is the label assigned to ct #3 crepitus?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'ct #3 crepitus',SELECT DISTINCT label FROM medications WHERE medication_name = 'ct #3 crepitus'
e4072cdd311e5d56562630fe,"What are the three most commonly taken specimens that patients were tested during the same month after receiving a extirpation of matter from left femoral vein, percutaneous approach procedure throughout this year?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.chart_time FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' AND datetime(procedures.chart_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient.subject_id, specimens.spec_type_desc, specimens.chart_time FROM specimens JOIN patient ON specimens.patient_id = patient.subject_id WHERE datetime(specimens.chart_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of month') ="
666f86f3566bfabb76e587a7,When was patient 10038992 last prescribed a drug via the neb route since 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.patient_id = 10038992 AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07'"
ced205244613e91e3ff9ec97,Count the number of times patient 10021487 received replete with fiber (full) on this month/13.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'replete with fiber (full)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '13'","SELECT COUNT(*) FROM inputevents WHERE events.patient_id = 10021487 AND events.eventtype = 'replete with fiber (full)' AND datetime(events.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',events.starttime) = '13'"
878917a494e18bf3082ea4c4,Is SaO2 of patient 10031757 second measured on the first ICU visit greater than the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT lab_value FROM ( SELECT * FROM icu_visits WHERE icu_visits.icu_stay_id IN ( SELECT icu_stays.icu_stay_id FROM icu_stays WHERE icu_stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icu_stays.outtime IS NOT NULL ORDER BY icu_stays.intime ASC LIMIT 1 ) AS icu_values WHERE icu_values.itemid = ( SELECT labitems.itemid FROM labitems WHERE labitems.label = 'o2 saturation pulseoxymetry' ) ORDER BY icu_values.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT lab_value FROM ( SELECT * FROM icu_visits WHERE icu_visits.icu_stay_id IN ( SELECT icu_stays.icu_stay_id FROM icu_stays WHERE icu_stays.hadm_id IN ( SELECT admissions.hadm_id
64be714443bafc724b5d0d44,What are the ways to take emtricitabine-tenofovir (truvada)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'emtricitabine-tenofovir (truvada)',SELECT DISTINCT prescription_route FROM prescriptions WHERE prescription_drug = 'emtricitabine-tenofovir (truvada)'
0fae80f812674773157d9f2a,Can you specify the gender of patient 10022880?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10022880,SELECT patients.gender FROM patients WHERE patients.subject_id = 10022880
40bd0f4265c38c258e1d9e19,Has there been any organism found in patient 10021118's last urine microbiological examination in 12/this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1",12/2100: has organism in patient 10021118's last urine microbiological examination?
01038856e72fffdbf13016be,Did patient 10025463 receive any lab testing in 11/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',labevents.charttime) = '2100-11'","SELECT COUNT(*)>0 FROM lab_test WHERE lab_test.patient_id = 10025463 AND strftime('%Y-%m',lab_test.charttime) = '2100-11'"
ceb130d1950aa38990b64736,"What is the maximum total cost for a hospital that conducts a albumin, ascites lab test?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, ascites' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM(C2.V1) AS C1 FROM diagnoses AS C1 JOIN cost_table AS C2 ON C1.C1 = C2.T1.C1 WHERE C1.C1 = 'albumin, ascites' GROUP BY C1.C1 ) AS T1"
6236365bb1b1dab256878dbe,Has patient 10020187 been prescribed any medications?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ),SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.patient_id = 10020187
20d7ef0b9116aab70a4d883c,"Since 07/2100, what was patient 10021938's last microbiology test time?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT microbiology.charttime FROM microbiology WHERE microbiology.patient = 10021938 AND strftime('%Y-%m',microbiology.charttime) >= '2100-07' ORDER BY microbiology.charttime DESC LIMIT 1"
e56ed5e7a85bff472777e492,"Among patients in their 60 or above , what are the top three prescribed drugs?","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","1. SELECT T1.drug FROM ( SELECT prescribed_drug AS drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM medication_usage JOIN patient ON medication_usage.patient_id = patient.subject_id WHERE patient.age >= 60 GROUP BY prescribed_drug ) AS T1 WHERE T1.C1 <= 3"
6603175d4ba0c226f1b1404c,Can you tell me the cost of a lab immunoglobulin g test?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin g' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'lab immunoglobulin g'
ca656067a8e263ea627dff09,When did patient 10001217 receive a last diagnosis of cerebral edema on the last hospital visit?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral edema' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1,SELECT diagnosis.charttime FROM diagnosis WHERE diagnosis.patient_id = 10001217 AND diagnosis.charttime >= ( SELECT patient.hospitalized.charttime FROM patient WHERE patient.patient_id = 10001217 AND patient.hospitaldischtime IS NOT NULL ORDER BY patient.hospitalized.charttime DESC LIMIT 1 ) ORDER BY diagnosis.charttime DESC LIMIT 1
25b2ba84dbb2d8d8d138ee64,What was patient 10027445's first weight since 21 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-21 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT MIN(diastolic_bp) FROM ( SELECT * FROM patient_observations WHERE patient_id = 10027445 AND observation_type = 'arterial blood pressure' AND datetime(observation_time) >= datetime(current_time,'-21 month') )"
809821a4009fe30207a67903,What is the average immunoglobulin a of patient 10029291 in 02/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin a' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '02'","SELECT AVG(lab.val) FROM lab WHERE lab.pat = 10029291 AND lab.spec = 'immunoglobulin a' AND datetime(lab.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',lab.charttime) = '02'"
3e4b52c69a2bdf36e4f03676,Retrieve the marital status of patient 10005866 during their last hospital encounter.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT marital_status FROM patients WHERE encounter_id IN ( SELECT encounter_id FROM transfers WHERE patient_id = 10005866 AND to_location = 'transfer from hospital' ORDER BY encounter_id DESC LIMIT 1 )
7294971600b3da69c5f504bd,Can you tell me the name of the procedure that patient 10004720 received first?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ORDER BY procedures_icd.charttime ASC LIMIT 1 ),"SELECT T3.long_title FROM ( SELECT T2.item, T1.date FROM ( SELECT T0.row_id, T0.date FROM ( SELECT * FROM procedures WHERE T0.patient_id = 10004720 ) AS T0 GROUP BY T0.row_id ORDER BY T0.date ASC LIMIT 1 ) AS T1 JOIN ( SELECT * FROM procedures WHERE T0.patient_id = 10004720 ) AS T2 ON T1.row_id = T2.row_id ) AS T3"
741720ef5045654c9099edd9,How much time in days has passed since the last time patient 10018081 was prescribed metronidazole (flagyl) in their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'metronidazole (flagyl)' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT 1 * ( strftime('%j',current_time) - strftime('%j', prescription.starttime) ) FROM prescription WHERE prescription.drug = 'metronidazole (flagyl)' AND prescription.patient = 10018081 AND prescription.starttime >= ( SELECT current_time FROM prescription WHERE prescription.patient = 10018081 AND prescription.drug = 'metronidazole (flagyl)' ORDER BY prescription.starttime DESC LIMIT 1 )"
baa17b1b6e497c273e84c277,What is the percentile of 29.0 in a urea nitrogen lab test given the same age as patient 10015931 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 29.0","SELECT DISTINCT T1.C1 FROM ( SELECT lab.valuenum, PERCENT_RANK() OVER ( ORDER BY lab.valuenum ) AS C1 FROM lab WHERE lab.itemid IN ( SELECTITEM_ID FROM labitems WHERE labitems.item LIKE '%urea nitrogen%' ) AND lab.hadm_id IN ( SELECT hadm_id FROM patients WHERE patients.age = ( SELECT patients.age FROM patients WHERE patients.name = '10015931' AND patients.dischtime IS NOT NULL ORDER BY patients.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 29.0"
daad7a245a02c2817e1dab51,When did patient 10007818 last have a fecal bag event since 04/04/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'fecal bag' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-04' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT events.starttime FROM events WHERE events.patient_id = 10007818 AND events.output = 'fecal bag' AND strftime('%Y-%m-%d',events.starttime) >= '2100-04-04' ORDER BY events.starttime DESC LIMIT 1"
555bf9cbad590421927df2cd,"How many patients received a ultrasonography of superior vena cava, guidance procedure in the same hospital encounter after having a introduction of nutritional substance into upper gi, via natural or artificial opening procedure since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ultrasonography of superior vena cava, guidance' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject ) FROM ( SELECT T1.subject, T2.charttime, T1.hadm_id FROM ( SELECT admissions.subject, procedures.charttime, admissions.hadm_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AS T1 JOIN ( SELECT admissions.subject, procedures.charttime, admissions.hadm_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.long_title = 'ultrasonography of superior vena cava, guidance' ) AS T2 ON T1.subject = T2.subject WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id"
fc8557d25a51b1ae5a699bdb,"Since 07/2100, when was the last time that patient 10031757 was prescribed both lactated ringers and metronidazole (flagyl) at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT T1.starttime FROM ( SELECT patient_id, prescription_id, starttime FROM prescription_table WHERE patient_id = 10031757 AND prescription_drug = 'lactated ringers' AND starttime >= '2100-07' ) AS T1 JOIN ( SELECT patient_id, prescription_id, starttime FROM prescription_table WHERE patient_id = 10031757 AND prescription_drug = 'metronidazole (flagyl)' AND starttime >= '2100-07' ) AS T2 ON T1.patient_id = T2.patient_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1"
85870a86f06622ea71a7764e,"How many patients are marked ""emergency department observation"" as a transfer care unit in 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.careunit FROM ( SELECT T1.subject_id, T2.careunit, T1.entry_time FROM diagnoses AS T1 JOIN patient_cares AS T2 ON T1.subject_id = T2.subject_id WHERE T1.careunit = 'emergency department observation' ) AS T2 JOIN ( SELECT subject_id, entry_time FROM admissions WHERE careunit = 'emergency department observation' AND strftime('%Y',entry_time) = '2100' ) AS T1 ON T1.subject_id = T2.subject_id"
75687ea1705bf35f720606d4,Tell me the number of times patient 10027602 got a cerebral ventricular #1 since 01/23/2100.,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cerebral ventricular #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-23'","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10027602 AND procedures.procedure_name = 'cerebral ventricular #1' AND strftime('%Y-%m-%d',procedures.start_time) >= '2100-01-23'"
bbc6747e134e489a305733da,What was patient 10005348's age on the last hospital stay?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT patient.age FROM patients WHERE patient.id = 10005348 AND patient.current_dischtime IS NOT NULL ORDER BY patient.admittime DESC LIMIT 1
5db87efd687aa472406c44c6,Has patient 10015931 been prescribed medication since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.patient_id = 10015931 AND strftime('%Y',prescriptions.starttime) >= '2100'"
089417994ad72edcca9f8050,Count the number of patients who had insertion of intercostal catheter for drainage within 2 months after having been diagnosed with home accidents since 2100.,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'home accidents' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of intercostal catheter for drainage' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis_time >= '2100-01-01' AND diagnosis_time < '2100-01-02' AND diagnosis = 'home accidents' ) AS T1 JOIN ( SELECT subject_id, procedure_time FROM procedures WHERE procedure_time >= '2100-01-01' AND procedure_time < '2100-01-02' AND procedure = 'insertion of intercostal catheter for drainage' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.procedure_time AND datetime(T2.procedure_time) BETWEEN datetime(T1.diagnosis_time) AND datetime(T1.diagnosis_time,'+2 month')"
347a2cad20161a15e564ef29,What is the average total hospital cost that includes a procedure called central venous catheter placement with guidance since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM(T1.C1) AS C1 FROM ( SELECT T1.ROW_NUMBER() OVER ( ORDER BY T1.C1 DESC ) AS ROW_NUMBER, T1.C1 FROM ( SELECT T2.C1 FROM ( SELECT T1.ROW_NUMBER() OVER ( ORDER BY T1.C1 DESC ) AS ROW_NUMBER, T1.C1 FROM ( SELECT PUMP_PROCEDURE_ID, 0 AS C1 FROM procedures WHERE PUMP_PROCEDURE_ID IN ( SELECT PROCEDURE_ID FROM procedures WHERE LOWER(PROCEDURE_NAME) = 'central venous catheter placement with guidance' ) ) AS T1 WHERE T1.ROW_NUMBER() >= 1 AND datetime(T1.C1) >= datetime(current_time,'-1 year') ) AS T2 ) AS T1 WHERE T1.C1 = T2.C1 ) AS T3"
4344afd25464e3304de00b90,What was patient 10013049's length of stay in days in the last ICU stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT strftime('%J', icu_out_time) - strftime('%J', icu_in_time) FROM icu_visits WHERE icu_visits.icu_in_time IS NOT NULL AND icu_visits.patient_id = 10013049 AND icu_visits.out_time IS NOT NULL ORDER BY icu_visits.in_time DESC LIMIT 1"
94d8481d364db4cbd70b366f,How much does patient 10005817 weigh based on the first measurement taken since 10/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-10' ORDER BY chartevents.charttime ASC LIMIT 1",SELECT weight FROM patients WHERE patient_id = 10005817 AND measurement_time >= '2100-10-21 00:00:00' ORDER BY measurement_time ASC LIMIT 1
693650b24cdfd7b8135da88e,What does it cost for a history of falling diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'history of falling' ) ),SELECT DISTINCT cost FROM sql_queries WHERE query_name = 'history of falling'
21768a606512998a1ee96c2a,Count the number of patients who were diagnosed with chronic hepatitis c without mention of hepatic coma but didn't come back to the hospital within the same month.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic hepatitis c without mention of hepatic coma' ) ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic hepatitis c without mention of hepatic coma' ) ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND datetime(T2.charttime,'start of month') = datetime(admissions.admittime,'start of month') )","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses.diagnosis_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'chronic hepatitis c without mention of hepatic coma' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.diagnosis_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'chronic hepatitis c without mention of hepatic coma' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T1.diagnosis_time,'start of month') = datetime(T2.diagnosis_time,'start of month') )"
00ddca0abfcd2315f0c91ce6,What are the three commonly taken specimens for patients who received control of epistaxis by anterior nasal packing previously during the same hospital encounter?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'control of epistaxis by anterior nasal packing' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime, admissions.admission_id FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id WHERE procedures.long_title = 'control of epistaxis by anterior nasal packing' ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime, admissions.admission_id FROM specimens JOIN admissions ON specimens.admission_id = admissions.admission_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.admission_id = T2.admission_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3"
6457fac9c63ce0f20ad03c9c,"For patients who underwent (aorto)coronary bypass of three coronary arteries in 2100, what were the top four most frequent procedures that followed within the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of three coronary arteries' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.long_title FROM ( SELECT T2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.time_since_first_diagnosis FROM ( SELECT T0.subject_id, T0.time_since_first_diagnosis FROM diagnoses AS T0 WHERE T0.diagnosis_long_title = '(aorto)coronary bypass of three coronary arteries' ) AS T1 JOIN ( SELECT T0.subject_id, T0.time_since_first_diagnosis FROM diagnoses AS T0 WHERE T0.diagnosis_long_title = '(aorto)coronary bypass of three coronary arteries' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.time_since_first_diagnosis < T2.time_since_first_diagnosis AND T1.subject_id = T2.subject_id GROUP BY T2.long_title ) AS T3 WHERE T3.C"
879dfc7ea11934d27bc66bc7,Can you name the top three diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT T1.diagnosis_name FROM ( SELECT diagnosis_name, DENSE_RANK() OVER ( ORDER BY t4.mortality_rate DESC ) AS C1 FROM ( SELECT T1.diagnosis_name, ( SELECT MAX(percent_change) FROM ( SELECT PERCENT_CHANGE(C1) FROM ( SELECT C1 FROM ( SELECT diagnosis_name, ( SELECT AS T2.age FROM patients AS T2 WHERE T2.dischtime - T1.diagnosistime >= 1 year ) ) AS T3 GROUP BY diagnosis_name ) AS T4 ) ) AS T1 WHERE T1.discharge_time IS NOT NULL ) AS T2 GROUP BY T1.diagnosis_name ) AS T3 WHERE T3.C1 <= 3"
d50f340e88f09cf2749021b3,"What are the three most commonly ordered lab tests for patients diagnosed with hyperkalemia previously during the same hospital encounter, this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperkalemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'hyperkalemia' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labtests.test_name, labtests.charttime, admissions.admission_id FROM labtests JOIN admissions ON labtests.admission_id = admissions.admission_id WHERE datetime(labtests.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.admission_id = T2.admission_id GROUP"
c0b91d07e6910a05f93e87aa,When did patient 10019172 have his/her last input since 09/07/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-07' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT input_time FROM input_events WHERE subject_id = 10019172 AND strftime('%Y-%m-%d',input_time) >= '2100-09-07' ORDER BY input_time DESC LIMIT 1"
3a0be19d3169bb19a1452e68,"How many hours were there since patient 10021487 was first diagnosed with injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum in their current hospital visit?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnosis.diagnosis_time) ) FROM diagnosis WHERE diagnosis.patient_id = 10021487 AND diagnosis.diagnosis_time >= ( SELECT current_time FROM diagnosis WHERE diagnosis.patient_id = 10021487 AND diagnosis.diagnosis = 'injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum' ) AND diagnosis.dischtime IS NULL"
d72094c1906f3a46217599bb,What are the three most common microbiology tests done since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM microbiology AS T1 JOIN ( SELECT T2.subject_id, T2.charttime FROM microbiology AS T2 WHERE T2.charttime >= '2100-01-01' ) AS T2 ON T1.subject_id = T2.subject_id ) AS T1 GROUP BY T1.test_name ) AS T2 WHERE T1.C1 <= 3"
84ac2bfd0420a297e0a26258,What is the total po intake amount that patient 10000032 received since 07/09/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-09'","SELECT SUM(input_amount) FROM input_events WHERE input_type = 'po intake' AND patient_id = 10000032 AND strftime('%Y-%m-%d', input_time) >= '2100-07-09'"
8de87b88f6cd77d22fb75b7a,How many hours have been since the first time patient 10021487 was diagnosed with traumatic hemothorax without mention of open wound into thorax in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic hemothorax without mention of open wound into thorax' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnosis.diagnosis_time) ) FROM diagnosis WHERE diagnosis.patient_id = 10021487 AND diagnosis.diagnosis_time >= ( SELECT diagnosis_time FROM diagnosis WHERE patient_id = 10021487 AND diagnosis.diagnosis = 'traumatic hemothorax without mention of open wound into thorax' AND diagnosis.dischtime IS NULL ) ORDER BY diagnosis.diagnosis_time ASC LIMIT 1"
c8a2241d70df2c163edad761,What was patient 10039997's last value of the heart rate since 08/13/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-13' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(heart_rate) FROM ( SELECT heart_rate FROM patients WHERE patients.id = 10039997 AND strftime('%Y-%m-%d',heart_rate_date) >= '2100-08-13' )"
10099f05b84afe98cf07a47e,What was the name of drug patient 10020740 was prescribed in the same hospital visit after receiving a other laparoscopic umbilical herniorrhaphy procedure since 01/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other laparoscopic umbilical herniorrhaphy' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-01' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedures.chart_id, procedures.time FROM procedures WHERE procedures.patient_id = 10020740 AND procedures.procedure = 'other laparoscopic umbilical herniorrhaphy' AND strftime('%Y-%m',procedures.time) >= '2100-01' ) AS T1 JOIN ( SELECT prescriptions.patient_id, prescriptions.drug FROM prescriptions WHERE prescriptions.time >= '2100-01' AND strftime('%Y-%m',prescriptions.time) >= '2100-01' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.chart_id = T2.chart_id AND T1.time < T2.time"
91c770552e4894cdd9ea0079,How many patients were tested this year for staph aureus swab?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'staph aureus swab' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patient_id ) FROM microbiology_events WHERE microbiology_events.spec_type_desc = 'staph aureus swab' AND datetime(microbiology_events.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
baa84499707e958def958609,What were the top four most frequent diagnoses that patients were given within 2 months after being diagnosed with encounter for attention to tracheostomy since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for attention to tracheostomy' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnosis.charttime FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE diagnosis.diagnosis = 'encounter for attention to tracheostomy' AND strftime('%Y',diagnosis.charttime) >= '2100' ) AS T1 JOIN ( SELECT patient.subject_id, diagnosis.diagnosis, diagnosis.charttime FROM diagnosis JOIN patient ON diagnosis.patient_id = patient.subject_id WHERE strftime('%Y',diagnosis.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.diagnosis ) AS T3 WHERE T3"
de4d2a4ef0f92ed118449a87,What's the total number of patients in hematology/oncology since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE specialty = 'hematology/oncology' AND strftime('%Y',procedures.start_time) >= '2100'"
84564eb53eb9b3302bd9acf8,Can you tell me the top four most common microbiology tests that occurred in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.sequence_id, T1.charttime FROM microbiology T1 JOIN ( SELECT sequence_id, charttime FROM procedures WHERE charttime BETWEEN '2100-01-01 00:00:00' AND '2100-12-31 23:59:59' ) AS T2 ON T1.sequence_id = T2.sequence_id GROUP BY T2.test_name ) AS T1 WHERE T1.C1 <= 4"
c4b26c0ae57a5f77fcd0c46d,Has patient 10022281 been prescribed a drug since 24 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.patient_id = 10022281 AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')"
dc671c0fb18f291e1d417779,What was patient 10004235's last output time of foley on 03/19/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-19' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT strftime(output_time, '%Y-%m-%d %H:%M:%S') FROM output_events WHERE output_time LIKE '%foley%' AND subject_id = 10004235 AND strftime('%Y-%m-%d',output_time) = '2100-03-19' ORDER BY output_time DESC LIMIT 1"
d6ab8927156136206a55d8a8,"During the current hospital visit, has patient 10021487 been prescribed with readi-cat 2 (barium sulfate 2% suspension), plasmalyte, or acetazolamide sodium?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'readi-cat 2 (barium sulfate 2% suspension)', 'plasmalyte', 'acetazolamide sodium' )",10021487 has been prescribed with acetazolamide sodium during the current hospital visit
cb5bf7d37033da680feb9abe,How many visits did patient 10026354 make to the hospital throughout this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026354 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT( DISTINCT visit_id ) FROM hospital_visits WHERE patient_id = 10026354 AND datetime(visit_date,'start of year') = datetime(current_time,'start of year','-0 year')"
3e7993dbfd153fc21c01b640,How much is the minimum total cost for the hospital visits that include sevelamer carbonate since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'sevelamer carbonate' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.total_cost) FROM ( SELECT SUM(T2.cost) AS total_cost FROM ( SELECT T1.subject_id, T1.hadm_id FROM ( SELECT T1.subject_id, T1.hadm_id FROM diagnoses WHERE T1.diagnosis = 'sevelamer carbonate' ) AS T1 JOIN ( SELECT cost FROM cost_table WHERE cost_table.item = 'sevelamer carbonate' ) AS T2 ON T1.item = T2.item WHERE T1.charttime >= ( current_time, '-1 year' ) ) AS T1 GROUP BY T1.subject_id ) AS T2"
5efdb746ec678cf4fc384eaa,How is chlorhexidine gluconate 0.12% oral rinse delivered?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse',SELECT DISTINCT prescription_route FROM prescriptions WHERE prescription_drug = 'chlorhexidine gluconate 0.12% oral rinse'
0d61464fe9f411c1b299ffef,Count the number of times that patient 10009035 in 12/last year had a or urine output.,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',outputevents.charttime) = '12'","SELECT COUNT(*) FROM results WHERE results.patient_id = 10009035 AND results.output_type = 'or urine' AND datetime(results.result_time,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',results.result_time) = '12'"
a0863c97c9dcec30264c3abd,Name the output that patient 10037975 had for the last time?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 ),SELECT output FROM ( SELECT * FROM procedures WHERE input = 'drainage of pericardial cavity' AND output = 'drainage of pericardial cavity' AND patient_id = 10037975 ) ORDER BY procedure_time DESC LIMIT 1
caf20c3c07abb81f1fb4ce13,What are the methods for ingesting oxymetazoline?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'oxymetazoline',SELECT DISTINCT prescription_route FROM prescriptions WHERE prescription_drug = 'oxymetazoline'
b96e8ac58176933b9e0ee2b3,What are the five most commonly tested specimens for patients that were diagnosed with unarmed fight or brawl previously within 2 months?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unarmed fight or brawl' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.diagnosis_time FROM ( SELECT subject_id, diagnosis_time, spec_type_desc FROM microbiology_events WHERE spec_type_desc = 'other' ) AS T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis_time < '2 months' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T1.diagnosis_time,'start of month') = datetime(T2.diagnosis_time,'start of month') ) AS T3 WHERE T3.C1 <= 5"
60e8ab147beb8159de92a539,How much is the average total cost of a hospital visit that includes a free calcium lab test in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost_lab) AS C1 FROM lab_results WHERE lab_name = 'free calcium' AND strftime('%Y',cost_date) = '2100' GROUP BY patient_id ) AS T1"
a13bd95a1540c1bc4c4568db,Can you tell me the last ferritin lab reading for patient 10020740 in 03/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1","SELECT lab_ferritin FROM lab_results WHERE patient_id = 10020740 AND strftime('%Y-%m',lab_results.charttime) = '2100-03' ORDER BY lab_results.charttime DESC LIMIT 1"
e256c7b08d9dde3880221886,"List the top three most frequent diagnoses that were given to patients within the same month after they were diagnosed with other dependence on machines, supplemental oxygen.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other dependence on machines, supplemental oxygen' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE diagnoses.diagnosis = 'other dependence on machines, supplemental oxygen' ) AS T1 JOIN ( SELECT patient.subject_id, diagnoses.diagnosis, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.diagnosis ) AS T3 WHERE T3.C1 <= 3"
fbf3603d3d2d818a10d4d5b4,"Among patients who were diagnosed with acute alcoholic intoxication in alcoholism, continuous during this year, what are the top five most commonly prescribed medications that followed in the same hospital encounter for patients in their 50s?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'acute alcoholic intoxication in alcoholism' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1"
67269f11d04e63d8d4a6aaf1,"List the top five most frequent procedures that patients underwent within the same month after being diagnosed with diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled in 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.long_title FROM ( SELECT T2.short_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM diagnoses WHERE diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AS T1 JOIN ( SELECT subject_id, procedure_time FROM procedures ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.procedure_time AND datetime(T1.charttime,'start of month') = datetime(T2.procedure_time,'start of month') GROUP BY T2.short_title ) AS T3 WHERE T3.C1 <= 5"
2675abf72b38410bb4eda4ad,What proportion of patients with a diagnosis of acetonuria survive over a 6-month period?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/2 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acetonuria' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )",SELECT COUNT( DISTINCT patient_id ) FROM diagnoses WHERE diagnosis = 'acetonuria' AND survival_months > 6
811d7b1ce1d2dbdbb4648a1b,What procedure was performed on patient 10021938 two times since 11 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-11 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT T1.operation_name FROM ( SELECT procedures.operation_name, COUNT( procedures.time ) AS counter FROM procedures WHERE procedures.patient_id = 10021938 AND datetime(procedures.time) >= datetime(current_time,'-11 month') GROUP BY procedures.operation_name ) AS T1 WHERE T1.counter = 2"
bdf2adbc5d802891bf0837c2,"In 2100, how many patients received pantoprazole in the same hospital encounter after being diagnosed with defibrination syndrome?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'defibrination syndrome' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT(DISTINCT T1.subject_id) FROM ( SELECT T1.subject_id, T2.diagnosis_time, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses.diagnosis_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'defibrination syndrome' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.start_time, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.start_time AND T1.hadm_id = T2.hadm_id"
6d14fafef38d93f2e020c386,"Count how many times in the first hospital encounter patient 10018328 experienced the restriction of left internal carotid artery with intraluminal device, percutaneous approach procedure.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )","SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10018328 AND procedures.long_title = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' AND procedures.encounter_id = ( SELECT encounters.encounter_id FROM encounters WHERE encounters.patient_id = 10018328 AND encounters.dischtime IS NOT NULL ORDER BY encounters.admittime ASC LIMIT 1 )"
f5d1341aa772a131aa8ee445,How many patients were diagnosed with personal history of malignant neoplasm of large intestine in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM diagnoses WHERE diagnosis_name = 'personal history of malignant neoplasm of large intestine' AND strftime('%Y',diagnosis_time) = '2100'"
e5b73688391845090eacc355,"How many patients got a amylase, ascites test since 1 year ago?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patient_id ) FROM tests WHERE test_name = 'amylase, ascites' AND datetime(tests.test_date) >= datetime(current_time,'-1 year')"
b8b5e892b7594cca173fde8a,What label corresponds to volume not removed?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'volume not removed',SELECT DISTINCT label FROM procedures WHERE procedure_name = 'volume not removed'
b26e5939c6b846e6073358d5,How many prescription drugs were ordered for patient 10018328 during their last hospital visit?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10018328 AND prescriptions.dischtime IS NOT NULL ORDER BY prescriptions.starttime DESC LIMIT 1
36d8a80cdf21d731b910f6bf,What are the four most common microbiology tests for people who were diagnosed with dysthymic disorder earlier within 2 months?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysthymic disorder' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'dysthymic disorder' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiology.test_name, microbiology.charttime FROM microbiology JOIN admissions ON microbiology.admission_id = admissions.admission_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4"
8e97f8923eae1120693cf379,Is the value of mchc of patient 10026255 second measured on the last hospital visit less than it was first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10026255 AND lab_tests.spec_type_id = ( SELECT id FROM spec_types WHERE spec_type_name = 'mchc' ) AND lab_tests.chart_time = ( SELECT lab_tests.chart_time FROM lab_tests WHERE lab_tests.patient_id = 10026255 AND lab_tests.spec_type_id = ( SELECT id FROM spec_types WHERE spec_type_name = 'mchc' ) AND lab_tests.hospital_id = ( SELECT hospitals.hospital_id FROM hospitals WHERE hospitals.patient_id = 10026255 AND hospitals.dischtime IS NOT NULL ORDER BY hospitals.admittime DESC LIMIT 1 ) ORDER BY lab_tests.chart_time ASC LIMIT 1 OFFSET 1 ) < ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10026255 AND lab_tests.spec_type
103963052c1ac6130cd2db9a,What is the sum of patient 10003046's or urine output during the last ICU visit.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ),SELECT SUM(output_events.value) FROM output_events WHERE output_events.patient_id = 10003046 AND output_events.output_type = 'or urine' AND output_events.icu_id IN ( SELECT icu_registration.icu_id FROM icu_registration WHERE icu_registration.patient_id = 10003046 AND icu_registration.icu_duration > 0 ORDER BY icu_registration.icu_starttime DESC LIMIT 1 )
c2eed970bacaf0f9bea1ccbc,What are the four most frequently ordered medications that male patients aged 20s were prescribed within 2 months after they were diagnosed with mitral valve disorders since 1 year ago?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mitral valve disorders' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 20 AND 29 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.gender = 'm' AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE admissions.gender = 'm' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS"
411239af52a2ceaa4e79d867,How many prescription drugs were ordered for patient 10020944 since 24 months ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.patient_id = 10020944 AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')"
b38138698b912a998a6f74f3,Count the number of patients for whom vial was prescribed within 2 months post their diagnosis of secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes in 2100.,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vial' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.starttime FROM ( SELECT subject_id, diagnosis_time AS starttime FROM diagnoses WHERE diagnosis = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes' ) AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id WHERE strftime('%Y',T2.starttime) = '2100' ) AS T1 JOIN prescriptions AS T2 ON T1.subject_id = T2.subject_id WHERE strftime('%Y',T2.starttime) = '2100' AND T1.starttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.starttime) AND datetime(T1.starttime,'+2 month')"
cd9067d6c88100bac2cc82c3,What are the three most commonly tested specimens since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT specimen_name FROM ( SELECT specimen_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, specimen_name FROM microbiology_events WHERE datetime(specimen_date) >= datetime(current_time,'-1 year') ) AS T1 JOIN patients AS T2 ON T1.patient_id = T2.subject_id ) AS T3 WHERE C1 <= 3"
84db978ffae9e37098b5f315,What were the top three most common treatments given to patients in their 40s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.treatment FROM ( SELECT T2.treatment, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patients.age FROM patients WHERE patients.age BETWEEN 40 AND 49 ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.charttime FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.age BETWEEN 40 AND 49 AND strftime('%Y',T2.charttime) = '2100' GROUP BY T2.treatment ) AS T3 WHERE T3.C1 <= 3"
3de4eeab52c93e43309156d7,Has any medication been designated for patient 10029484 in 04/last year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.patient_id = 10029484 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'"
135380cceeececcc1d31beb3,Did patient 10021666 come into an ER on their first hospital encounter?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,10021666 in the first hospital visit had an emergency room (emergency room) visit?
ccedb8f78a6736b132f3b079,Tell me the organism that was detected in the last urine test of patient 10031757 during their last hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organism FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT hadm_id FROM hospital_events WHERE hospital_events.subject_id = 10031757 AND hospital_events.dischtime IS NOT NULL ORDER BY hospital_events.admittime DESC LIMIT 1 ) AND microbiology_events.spec_type_desc = 'urine' AND microbiology_events.org_name IS NOT NULL ORDER BY microbiology_events.charttime DESC LIMIT 1
4b72e7b13c37b47053d926d9,Can you provide the monthly maximum output of pre-admission for patient 10022041?,"SELECT MAX(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission' AND d_items.linksto = 'outputevents' ) GROUP BY strftime('%Y-%m',outputevents.charttime)","SELECT MAX(output) FROM ( SELECT output FROM ( SELECT * FROM patients WHERE patient_id = 10022041 ) AS T1 JOIN prescriptions AS T2 ON T1.prescription_id = T2.prescription_id ) AS T3 GROUP BY strftime('%Y-%m',input_time)"
390c4f9e4e7b5c353eff9da7,What was the last dose of potassium chl 20 meq / 1000 ml d5lr prescribed to patient 10016810?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT MAX(dose_val_rx) FROM ( SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.patient_id = 10016810 AND prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' )
ec94ea0d33b90b977c958e6d,How many patients have been admitted currently?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT( DISTINCT patient_id ) FROM current_patients
bbcb03fc3471db9511c31648,What are the total inputs given to patient 10018845 since 03/27/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-27'","SELECT SUM(input_events.total) FROM input_events WHERE input_events.patient_id = 10018845 AND strftime('%Y-%m-%d',input_events.starttime) >= '2100-03-27'"
0c5a19d98fb21ee7f7415577,"What drug was patient 10021118 prescribed with during the same day after receiving bypass coronary artery, one artery from left internal mammary, open approach this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT T2.drug FROM ( SELECT procedures.starttime FROM procedures WHERE procedures.patient_id = 10021118 AND procedures.procedure = 'bypass coronary artery, one artery from left internal mammary, open approach' AND datetime(procedures.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE prescriptions.patient_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.starttime < T2.starttime WHERE T1.starttime >= current_time - datetime('2 days','start of month')"
633d7843ff15021b4c6b6ac9,Tell me the marital status of patient 10012853 in their last hospital encounter.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT marital_status FROM patients WHERE patient_id = 10012853 AND enc_id = ( SELECT enc_id FROM patient_encounters WHERE patient_id = 10012853 AND hospital_id = ( SELECT hospital_id FROM patient_hospital WHERE patient_id = 10012853 ORDER BY hospital_id DESC LIMIT 1 ) ) ORDER BY enc_id DESC LIMIT 1 )
473f0352cd0b38c085ce1628,What is the difference between weights on patient 10038933 second measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT values FROM ( SELECT measurements.value FROM measurements WHERE measurements.patient_id = 10038933 AND measurements.type = 'weight' AND measurements.last_hadm_id IN ( SELECT hadm_id FROM hadm_history WHERE hadm_history.patient_id = 10038933 AND hadm_history.last_dischtime IS NOT NULL ORDER BY hadm_history.admittime DESC LIMIT 1 ) ORDER BY measurements.measuretime ASC LIMIT 1 OFFSET 1 ) - ( SELECT values FROM ( SELECT measurements.value FROM measurements WHERE measurements.patient_id = 10038933 AND measurements.type = 'weight' AND measurements.last_hadm_id IN ( SELECT hadm_id FROM hadm_history WHERE hadm_history.patient_id = 10038933 AND hadm_history.last_dischtime IS NOT NULL ORDER BY hadm_history.admittime DESC LIMIT 1 ) ORDER BY measurements.measuretime ASC LIMIT 1 )
4e04be3ade7631c7f953c6b5,Can you provide the list of the four most commonly ordered specimen tests this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT T1.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents AS T1 JOIN prescriptions AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.CUI = 'malignant neoplasm of unspecified part of lung' AND T2.starttime >= '2100-01-01 00:00:00' AND T2.starttime < '2101-01-01 00:00:00' ) AS T1 GROUP BY T1.spec_type_desc ) AS T2 WHERE T1.C1 <= 4"
a4371b693f24038ad04881c2,"Was patient 10005909 prescribed with 0.9% sodium chloride, bag, or duloxetine during the first hospital visit?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( '0.9% sodium chloride', 'bag', 'duloxetine' )","1. did patient 10005909 receive a prescription for 0.9% sodium chloride, bag, or duloxetine during the first hospital visit?"
7536a12b6079eeb3ed78aa85,What is the maximum total cost of the hospital visits that included the drug named fenofibrate since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fenofibrate' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM(T2.C2) AS C1 FROM ( SELECT T1.row_id, T1.month_visit, T1.patient_id, T1.total_cost FROM ( SELECT row_id, month_visit, patient_id, total_cost FROM diagnoses_table WHERE strftime('%Y',month_visit) >= '2100' ) AS T1 JOIN ( SELECT row_id, month_visit, patient_id, total_cost FROM prescriptions_table WHERE strftime('%Y',month_visit) >= '2100' AND name = 'fenofibrate' ) AS T2 ON T1.row_id = T2.row_id ) AS T1;"
647fbc4c18dc9b7300f25187,Count the number of days since patient 10021487's first diagnosis of other chronic nonalcoholic liver disease on the current hospital encounter.,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other chronic nonalcoholic liver disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', T1.diagnosis_time) ) FROM ( SELECT diagnosis_time, patient_id FROM diagnoses WHERE patient_id = 10021487 AND current_time IS NOT NULL ) AS T1"
ab2159e2914558a41cd56bff,What was the ciprofloxacin hcl dosage that patient 10019172 had been prescribed in 11/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.drug = 'ciprofloxacin hcl' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11'","SELECT T1.dosage FROM ( SELECT prescriptions.drug_id, prescriptions.start_time FROM prescriptions WHERE prescriptions.patient_id = 10019172 AND prescriptions.drug = 'ciprofloxacin hcl' AND strftime('%Y-%m',prescriptions.start_time) = '2100-11' ) AS T1 JOIN ( SELECT prescriptions.drug_id, prescriptions.start_time FROM prescriptions WHERE prescriptions.patient_id = 10019172 AND prescriptions.drug = 'ciprofloxacin hcl' AND strftime('%Y-%m',prescriptions.start_time) = '2100-11' AND prescriptions.start_time < datetime('2100-11-21 00:00:00') AND prescriptions.start_time >= datetime('2100-11-14 00:00:00') ) AS T2 ON T1"
efc169498c87c222d5b7020b,When was the last stool microbial test done in patient 10002495 since 04/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND microbiologyevents.spec_type_desc = 'stool' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.patientid = 10002495 AND microbiologyevents.spec_type_desc = 'stool' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1"
729c62dcfd9ac11a32a56161,Has patient 10015860 been prescribed a drug since 1 year ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.patient_id = 10015860 AND datetime(prescriptions.start_time) >= datetime(current_time,'-1 year')"
9c733436d319028b982e6657,Can you show the top five most frequently prescribed drugs?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5"
a3585e47c9d9845ccde194bf,"Has patient 10037975 been given a creatinine, urine test since 15 months ago?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND datetime(labevents.charttime) >= datetime(current_time,'-15 month')","SELECT COUNT(*)>0 FROM lab_test WHERE lab_test.patient_id = 10037975 AND lab_test.spec_type_desc = 'creatinine, urine' AND datetime(lab_test.charttime) >= datetime(current_time,'-15 month')"
fed90306e7ed0344ed0a3b7d,Was patient 10021487 given any dextrose 5% on this month/07?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '07'","SELECT COUNT(*)>0 FROM inputevents WHERE events.patient_id = 10021487 AND events.item = 'dextrose 5%' AND datetime(events.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',events.starttime) = '07'"
52f6bc8e9873cce45456c38e,Can you specify the gender of patient 10025463?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10025463,SELECT gender FROM patients WHERE patient_id = 10025463
7b18e66852f4386ce57b39c1,Has there been any mrsa screen microbiology test done for patient 10029484 since 09/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09'","SELECT COUNT(*)>0 FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiology_events.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiology_events.charttime) >= '2100-09'"
a4e1867554fe617ae563f780,Calculate the total volume of drainage bag for patient 10021487 on this month/17.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'drainage bag' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '17'","SELECT SUM(bag_volume) FROM ( SELECT bag_volume FROM ( SELECT patient_id, expiration_time, input_time FROM ( SELECT patient_id, expiration_time, input_time, (strftime('%j',input_time) - strftime('%j',expiration_time)) as bag_volume FROM ( SELECT patient_id, expiration_time, input_time, (strftime('%Y-%m-%d %H:%M:%S',input_time) - strftime('%Y-%m-%d %H:%M:%S',expiration_time)) as bag_volume FROM ( SELECT patient_id, expiration_time, input_time FROM ( SELECT patient_id, expiration_time, input_time, (strftime('%Y-%m-%d',input_time) - strftime('%Y-%m-%d',expiration_time)) as bag_volume FROM ( SELECT patient_id, expiration_time, input_time FROM ( SELECT patient_id, expiration_time, input_time, (strftime('%Y-%m-%d',input_time) - strft"
b216e416603adce99fc11398,"Among those who were prescribed with lidocaine 0.5%, what are the five most commonly prescribed drugs at the same time since 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lidocaine 0.5%' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lidocaine 0.5%' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
2340588e1e30b4204874ee2d,What were the three most frequently taken lab tests this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.test_name FROM ( SELECT lab_tests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM lab_tests WHERE datetime(lab_tests.chart_time,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY lab_tests.test_name ) AS T1 WHERE T1.C1 <= 3"
5ee74a87e14a3df9c0561df9,What's the admission count of patients in the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT(DISTINCT patient_id) FROM hospital WHERE year = EXTRACT(YEAR FROM CURRENT_DATE) - 1
04e0b332c01bf8b36c4973b5,Was the mean blood pressure of patient 10014729 ever less than 79.0 on 03/07/this year?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 79.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '03-07'","SELECT COUNT(*)>0 FROM ( SELECT patient_id, MIN(diastolic_bp) as min_diastolic_bp FROM ( SELECT patient_id, diastolic_bp FROM ( SELECT patient_id, ( (systolic_bp + diastolic_bp) / 2.0 ) as diastolic_bp FROM ( SELECT patient_id, systolic_bp, diastolic_bp from ( SELECT patient_id, systolic_bp, diastolic_bp from patient_blood_pressure where patient_id = 10014729 ) ) ) as diastolic_bp_temp GROUP BY patient_id ) as diastolic_bp_temp WHERE diastolic_bp_temp < 79.0 AND datetime(diastolic_bp_temp.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',diastolic_bp_temp.charttime) = '03-07' ) as ass
        <|im_end"
636e9b1dbf501867d3e6e18b,How many patients went through a blood (toxo) microbiology test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood (toxo)' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patient_id ) FROM microbiology_events WHERE microbiology_event_type = 'blood (toxo)' AND datetime(microbiology_event_time) >= datetime(current_time,'-1 year')"
264e8e9083e7fe02916af314,What was the name of the medication that patient 10025612 was prescribed for the last time in 10/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT T1.drug FROM ( SELECT prescriptions.drug, row_number() OVER (PARTITION BY prescriptions.patient_id ORDER BY prescriptions.starttime DESC) AS rn FROM prescriptions WHERE prescriptions.patient_id = 10025612 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T1 WHERE T1.rn = 1"
56cc41f276a6e10711d396f4,When was patient 10004720's first microbiology test done?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT microbiology.chart_time FROM microbiology WHERE microbiology.patient_id = 10004720 ORDER BY microbiology.chart_time ASC LIMIT 1
cfe831c90fd2c89d0116f576,What was the name of the drug that patient 10019385 is first prescribed via td route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1,"SELECT T1.drug FROM ( SELECT prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE prescriptions.patient = 10019385 AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.patient = admissions.subject_id WHERE admissions.subject_id = 10019385 AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime < T2.starttime"
463e41b4b414a3258b0bbab5,What's the maximum total cost of the hospital visits when they involve diagnostic ultrasound of digestive system since 1 year ago?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM(diagnosis_cost) AS C1 FROM diagnosis WHERE diagnosis.long_title = 'diagnostic ultrasound of digestive system' AND datetime(diagnosis.diagnosis_time) >= datetime(current_time,'-1 year') GROUP BY diagnosis.patient_id ) AS T1"
cfce5f7c561e0bbfd11e26e0,"How much does drainage of pericardial cavity with drainage device, percutaneous approach cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' ) )","SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'drainage of pericardial cavity with drainage device, percutaneous approach'"
90a33678a92aaf96e62fc2a2,Find the number of patients who were admitted to the hospital during the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT( DISTINCT patient_id ) FROM hospital_admissions WHERE admission_year = 2021
2c065386f4cdb6f367bcf87b,How many patients got a mch test in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y',labevents.charttime) = '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM lab_results WHERE lab_name = 'mch' AND strftime('%Y',test_time) = '2100'"
53eee4b8cfb226d8418ce3fa,What procedure did patient 10007818 receive for the last time in this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures_icd.charttime DESC LIMIT 1 )","SELECT procedures.name FROM procedures WHERE procedures.patient_id = 10007818 AND datetime(procedures.start_time,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures.start_time DESC LIMIT 1"
47dc2df1f6767f65907affb2,What are the top five most common output events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.output_event FROM ( SELECT output_event, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures AS T1 JOIN output_events AS T2 ON T1.output_event_id = T2.output_event_id GROUP BY output_event ) AS T1 WHERE T1.C1 <= 5"
c86ef1c99a73bd58d05ad456,How many days have passed since patient 10021487 stayed in the careunit emergency department during the current hospital visit for the last time?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', patient.last_visit_time) ) FROM patient WHERE patient.subject_id = 10021487 AND patient.current_location = 'emergency department' AND patient.dischtime IS NULL"
e812406c3bfd789c61094039,How many people were discharged from hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')",SELECT COUNT( DISTINCT patient_id ) FROM discharge_log WHERE date_dischtime >= ( CURRENT_TIMESTAMP - INTERVAL '1 year' )
7431290c2ccaa0fdcb10a27d,What are the three most frequently ordered medications that female patients aged 60 or above were prescribed within 2 months after they were diagnosed with unspecified essential hypertension in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'unspecified essential hypertension' AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'female' ) AND admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2"
867b31660f489ea1d519e617,How many patients since 1 year ago underwent a blood (ebv) test?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood (ebv)' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patient_id ) FROM microbiology_events WHERE microbiology_events.spec_type_desc = 'blood (ebv)' AND datetime(microbiology_events.charttime) >= datetime(current_time,'-1 year')"
80d095627a05abf538ea0c80,"What are the three most commonly tested specimens for patients that were diagnosed with secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified previously in the same month, since 1 year ago?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.diagnosis_time FROM ( SELECT subject_id, diagnosis_time, diagnosis FROM diagnoses WHERE diagnosis = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' ) AS T1 ) AS T2 JOIN ( SELECT subject_id, spec_type_desc FROM specimens ) AS T3 ON T2.subject_id = T3.subject_id WHERE T1.diagnosis_time < T3.spec_type_desc AND datetime(T1.diagnosis_time,'start of month') = datetime(T3.spec_type_desc,'start of month') AND datetime(T1.diagnosis_time,'start of year') >= datetime(current_time,'start of year','-1 year') GROUP BY T2.spec_type_desc ) AS T4 WHERE T4.C1 <= 3<|"
028f7b61531a4e8e6da28cd3,"For patients diagnosed with other and unspecified angina pectoris previously, what are the top four most common procedures applied within the same hospital visit since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.code FROM ( SELECT T2.code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'other and unspecified angina pectoris' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.code, procedures.charttime, admissions.admission_id FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id WHERE strftime('%Y',procedures.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.admission_id = T2.admission_id GROUP BY T2.code ) AS T3 WHERE T3.C1 <="
46231873609912fe8e1019e7,Count the number of patients who since 2100 were prescribed pregabalin.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'pregabalin' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM prescriptions WHERE prescriptions.drug = 'pregabalin' AND strftime('%Y',prescriptions.starttime) >= '2100'"
0d3f767c99e8d250fc86ba71,Was patient 10015272's mcv second measured on the last hospital visit greater than the value from the first measurement on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT mcv FROM patients WHERE patient_id = 10015272 AND hospital_id = ( SELECT MAX(hospital_id) FROM patients WHERE patient_id = 10015272 ) AND measurement_time = ( SELECT MIN(measurement_time) FROM lab_results WHERE patient_id = 10015272 AND lab_name = 'mcv' AND hospital_id = ( SELECT MAX(hospital_id) FROM patients WHERE patient_id = 10015272 ) ) ) > ( SELECT mcv FROM patients WHERE patient_id = 10015272 AND hospital_id = ( SELECT MAX(hospital_id) FROM patients WHERE patient_id = 10015272 ) AND measurement_time = ( SELECT MIN(measurement_time) FROM lab_results WHERE patient_id = 10015272 AND lab_name = 'mcv' AND hospital_id = ( SELECT MAX(hospital_id) FROM patients WHERE patient_id = 10015272 ) ) )
8cfda20a9826789d8b58747a,How much does patient 10018423 change in systolic blood pressure last measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT systolic blood pressure FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu_id FROM icu_history WHERE icu_history.patient_id = 10018423 AND icu_history.outtime IS NOT NULL ORDER BY icu_history.intime DESC LIMIT 1 ) ORDER BY icu_visits.charttime DESC LIMIT 1 ) - ( SELECT systolic blood pressure FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu_id FROM icu_history WHERE icu_history.patient_id = 10018423 AND icu_history.outtime IS NOT NULL ORDER BY icu_history.intime DESC LIMIT 1 ) ORDER BY icu_visits.charttime ASC LIMIT 1 )
0ee20c63c4be119281d02113,Count the number of patients who were tested throughout this year for vitamin b12.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patient_id ) FROM lab_results WHERE lab_name = 'vitamin b12' AND datetime(result_date,'start of year') = datetime(current_date,'start of year','-0 year')"
92b8f8b9f70e026d369cdfbd,Has there been any mrsa screen microbiology test result for patient 10003046 throughout this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND microbiology_events.spec_type_desc = 'mrsa screen' AND datetime(microbiology_events.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
0298d7de83dc23f17441f202,Were there any procedures conducted on patient 10006580 during the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10006580 AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-1 year')"
eea838bba39870d24a4fe781,Tell me what patient 10018501's void output was since 06/05/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05'","SELECT SUM(output_volume) FROM ( SELECT patient_id, output_volume FROM medication_log WHERE patient_id = 10018501 AND output_type = 'void' AND strftime('%Y-%m-%d',input_time) >= '2100-06-05' )"
0e4bb22781a9b0bc9dedffb9,When did patient 10004733 first have the minimum number of specific gravity on the current hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1",SELECT MIN(lab.val_num) FROM lab WHERE lab.hadm_id IN ( SELECT adm.hadm_id FROM adm WHERE adm.subject = 10004733 AND adm.dischtime IS NULL ) AND lab.spec_type = 'specific gravity'
2a853454c790cac539c5c85d,"On 11/16/2100, did patient 10006053 have any cryoprecipitate input?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cryoprecipitate' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-11-16'","11/16/2100, did patient 10006053 have any cryoprecipitate input?"
9b79fc00bb70e04132ba060c,What is the number of times that patient 10018081 had ostomy (output) since 12/03/2100?,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ostomy (output)' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-03'","SELECT COUNT(*) FROM output WHERE output.patient_id = 10018081 AND output.output_type = 'ostomy (output)' AND strftime('%Y-%m-%d',output.output_time) >= '2100-12-03'"
7022bd51f5732800e05583f3,"In 2100, how many patients were diagnosed with other specified forms of effusion, except tuberculous during the same hospital encounter after being diagnosed with injury to thoracic aorta?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to thoracic aorta' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified forms of effusion, except tuberculous' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses.diagnosis_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'injury to thoracic aorta' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.diagnosis_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'other specified forms of effusion, except tuberculous' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND T1.hadm_id = T2.hadm_id"
bdb9a3e39281b6f931c8ce45,"Since 2100, what are the top five most frequently given diagnoses that patients received within 2 months after being diagnosed with gout, unspecified?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gout, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.long_title FROM ( SELECT T2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.chart_time FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE diagnoses.long_title = 'gout, unspecified' AND strftime('%Y',diagnoses.chart_time) >= '2100' ) AS T1 JOIN ( SELECT patient.subject_id, diagnoses.long_title, diagnoses.chart_time FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE strftime('%Y',diagnoses.chart_time) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T2.chart_time) BETWEEN datetime(T1.chart_time) AND datetime(T1.chart_time,'+2 month') GROUP BY T2.long_title )"
606c8894c16dee6dfac6b9ec,"Following the diagnosis of nicotine dependence, cigarettes, uncomplicated in 2100, how many patients developed malignant neoplasm of unspecified part of unspecified bronchus or lung within 2 months?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nicotine dependence, cigarettes, uncomplicated' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis LIKE '%nicotine dependence, cigarettes, uncomplicated%' ) AS T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis LIKE '%malignant neoplasm of unspecified part of unspecified bronchus or lung%' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T2.diagnosis_time) BETWEEN datetime(T1.diagnosis_time) AND datetime(T1.diagnosis_time,'+2 month')"
8227bef3ad3149f4b7e3b6e2,"Count the number of patients who had their extirpation of matter from left main bronchus, via natural or artificial opening endoscopic performed since 1 year ago.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left main bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE procedures.long_title = 'extirpation of matter from left main bronchus, via natural or artificial opening endoscopic' AND datetime(procedures.start_time) >= datetime(current_time,'-1 year')"
601558b753933c463ad3089a,"During this ICU encounter, was the respiratory rate of patient 10018081 ever less than 35.0?",SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 35.0,SELECT COUNT(*)>0 FROM icu_observations WHERE icu_observations.icu_id IN ( SELECT icu.icu_id FROM icu WHERE icu.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND icu.outtime IS NULL ) AND icu_observations.observation_type = 'respiratory rate' AND icu_observations.value < 35.0 )
bb5e3f49dbcb908901443bf7,Did patient 10029291 take any nacl 0.9% on 02/25/this year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '02-25'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.patient_id = 10029291 AND inputevents.item = 'nacl 0.9%' AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '02-25'"
882c567028490e3b5f7d3fcc,What is the count of patients admitted to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT( DISTINCT patient_id ) FROM hospital WHERE strftime('%Y',admittime) >= '2100'"
aa8337326151ea27fe36af1b,What was the name of the procedure that was performed two or more times in 03/this year on patient 10029291?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT T1.long_title FROM ( SELECT procedures.long_title, COUNT( procedures.long_title ) AS C1 FROM procedures WHERE procedures.patient_id = 10029291 AND datetime(procedures.start_time,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures.start_time) = '03' GROUP BY procedures.long_title ) AS T1 WHERE T1.C1 >= 2"
9444a73db82e2c64ae8bcdb3,What was the total output volume that patient 10019172 had on 11/20/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-11-20'","SELECT SUM(output_volume) FROM ( SELECT output_volume FROM ( SELECT * FROM input_events WHERE input_events.stay_id IN ( SELECT stays.stay_id FROM stays WHERE stays.subject_id = 10019172 ) ) AS events JOIN output_events ON events.event_id = output_events.event_id WHERE strftime('%Y-%m-%d',input_events.starttime) = '2100-11-20' ) AS event_results"
264edd3d4d5f3f14d0173879,What was the last height record for patient 10011398 since 12/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-12' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(patient_records.valuenum) FROM ( SELECT patient_records.valuenum FROM patient_records WHERE patient_records.patient_id = 10011398 AND strftime('%Y-%m',patient_records.record_time) >= '2100-12' ) AS filtered_records"
9a35c7b42b40e00811be3aac,Has patient 10039997 received nacl 0.9% in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'",12/2100: Has patient 10039997 received nacl 0.9%?
a71d906583f596e06c9f330d,What are the three most commonly received procedures for patients in their 30s since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.long_title FROM procedures AS T1 JOIN patient_ages AS T2 ON T1.short_title = T2.age_group WHERE T2.age_group = '30s' AND strftime('%Y',T1.start_time) >= '2100' GROUP BY T1.short_title ORDER BY COUNT(*) DESC LIMIT 3"
10b2e18ba65bee267f263e57,Does the heart rate of patient 10018081 ever go greater than 105.0 according to the database?,SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 105.0,10018081 has a heart rate that is greater than 105.0 at 03/02/2100 14:00:00
a1db6846c07bdc99c68fda58,Has there been any organism found in the first sputum microbiology test patient 10038999 received?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT COUNT(*)>0 FROM microbiology_events WHERE microbiology_events.patient_id = 10038999 AND microbiology_events.spec_type_desc = 'sputum' AND microbiology_events.org_name IS NOT NULL ORDER BY microbiology_events.chart_time ASC LIMIT 1
1613b932a1fa398b6bb15ef8,Has any lab test been performed on patient 10016150 in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y',labevents.charttime) = '2100'","SELECT COUNT(*)>0 FROM lab_test WHERE lab_test.patient_id = 10016150 AND strftime('%Y',lab_test.charttime) = '2100'"
e06b5c902a757922a7a2e945,Count the number of patients diagnosed with gastro-esophageal reflux disease without esophagitis who did not come to the hospital within 2 months since 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) >= '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, diagnosed_time FROM diagnoses AS T1 JOIN ( SELECT subject_id, diagnosed_time FROM diagnoses WHERE diagnosis_name = 'gastro-esophageal reflux disease without esophagitis' ) AS T2 ON T1.subject_id = T2.subject_id WHERE strftime('%Y',diagnosed_time) >= '2100' ) AS T1 JOIN ( SELECT subject_id, diagnosed_time FROM diagnoses WHERE diagnosis_name = 'gastro-esophageal reflux disease without esophagitis' ) AS T2 ON T1.subject_id = T2.subject_id WHERE strftime('%Y',diagnosed_time) >= '2100' AND diagnosed_time < T1.diagnosed_time AND datetime(diagnosed_time) BETWEEN datetime(T1.diagnosed_time) AND datetime(T1.diagnosed_time,'+2 month')"
d331061cc248eb79de709879,Has patient 10038933 been diagnosed with any type of disease?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ),10038933 in 2100 has been diagnosed with what?
45917bbce3d4be5cd229b409,"When was the last time patient 10021487 had injury to liver without mention of open wound into cavity, hematoma and contusion diagnosed since 1 year ago?","SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to liver without mention of open wound into cavity, hematoma and contusion' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT diagnosis.charttime FROM diagnosis WHERE diagnosis.patient = 10021487 AND diagnosis.diagnosis = 'injury to liver without mention of open wound into cavity, hematoma and contusion' AND datetime(diagnosis.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnosis.charttime DESC LIMIT 1"
6390dcaf504bd34b9a22032f,"Since 1 year ago, what are the top five most common drugs prescribed in the same month to male patients aged 50s after being diagnosed with unspecified sinusitis (chronic)?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sinusitis (chronic)' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'unspecified sinusitis (chronic)' AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime"
df9f9f77da1cf00ef44d4e96,Has patient 10015931 visited the hospital for admission during this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015931 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM hospital_visits WHERE hospital_visits.subject_id = 10015931 AND datetime(hospital_visits.admission_time,'start of year') = datetime(current_time,'start of year','-0 year')"
19858b1d6157d97c01ffb3cf,"During their last hospital visit, what time was patient 10001217's last surgery?",SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime DESC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.patient_id = 10001217 AND procedures.starttime = ( SELECT MAX(starttime) FROM procedures WHERE procedures.patient_id = 10001217 AND procedures.endtime = ( SELECT MAX(endtime) FROM diagnoses WHERE diagnoses.patient_id = 10001217 AND diagnoses.starttime = ( SELECT MIN(starttime) FROM diagnoses WHERE diagnoses.patient_id = 10001217 ) ) )
e840f7d25b661f8952fb1eb0,When was patient 10018081's last maximum diastolic blood pressure on this month/30?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '30' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1","SELECT MAX(diastolic_bp) FROM ( SELECT diastolic_bp FROM ( SELECT bp FROM ( SELECT patient_id, bp FROM ( SELECT 10018081, 0.0 ) ) ) ) AS diastolic_bp WHERE diastolic_bp IS NOT NULL AND datetime(diastolic_bp.meas_time,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',diastolic_bp.meas_time) = '30' )"
3f4dd01d76af18b7e4220202,When did patient 10011398 first receive a diagnosis of other and unspecified hyperlipidemia on their last hospital visit?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1,"SELECT diagnosis.start_time FROM diagnosis WHERE diagnosis.patient_id = 10011398 AND diagnosis.type_id = 3140 AND datetime(diagnosis.start_time,'start of hospital') = datetime(current_time,'start of hospital','-1 year') ORDER BY diagnosis.start_time ASC LIMIT 1"
8fed981f895ac1aafc1084df,What were the top four microbiology tests most frequently performed throughout this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT procedures.object_id, procedures.charttime FROM procedures WHERE procedures.charttime LIKE '2100-01-01 00:00:00' ) AS T1 JOIN ( SELECT microbiology.object_id, microbiology.charttime FROM microbiology WHERE microbiology.charttime LIKE '2100-01-01 00:00:00' ) AS T2 ON T1.object_id = T2.object_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4"
e966f1d77c03eb69dafa1390,Calculate the total number of patients diagnosed with dependence on renal dialysis who didn't revisit the hospital during the same month in 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) = '2100' AND datetime(T2.charttime,'start of month') = datetime(admissions.admittime,'start of month') )","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.charttime FROM ( SELECT subject_id, charttime FROM diagnoses WHERE diagnosis = 'dependence on renal dialysis' ) AS T1 JOIN ( SELECT subject_id, charttime FROM admissions WHERE admission_type = 'transfer' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of year') = datetime(T2.charttime,'start of year') AND strftime('%B',T1.charttime) = strftime('%B',T2.charttime) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND strftime('%Y',T1.charttime) = '2100' AND strftime('%B',T1.charttime) = 'dependence on renal dialysis'"
c6b253614a8ea885b3619a02,What was the last measurement of patient 10020786's height in 07/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-07' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(patient_measures.value) FROM patient_measures WHERE patient_measures.patient_id = 10020786 AND patient_measures.measure_type = 'height' AND strftime('%Y-%m',patient_measures.measure_time) = '2100-07'"
e28928980fdbc1db31ee6b54,How much is the average total cost of a hospital visit that includes a phosphate lab test?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost_lab) AS C1 FROM lab_results WHERE lab_name = 'phosphate' GROUP BY patient_id ) AS T1
c1ba984738060f77fc1c4445,What number of patients were discharged from the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')",SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE status = 'discharged' AND dischtime >= ( SELECT MAX(dischtime) FROM patients ) - INTERVAL '1 year'
2430afd64917976291b6054a,Tell me the top four of the most common output events since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.output_event_id FROM ( SELECT T2.output_event_id, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT procedures.output_event_id FROM procedures WHERE datetime(procedures.start_time) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT procedures.output_event_id FROM procedures WHERE datetime(procedures.start_time) >= datetime(current_time,'-1 year') ) AS T2 ON T1.output_event_id = T2.output_event_id GROUP BY T2.output_event_id ) AS T3 WHERE T3.C1 <= 4"
1436276ff4d05d626c742fa4,How many hours has it been since patient 10021487 got their last prescription of glucagon on this hospital stay?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'glucagon' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescription.starttime) ) FROM prescription WHERE prescription.hadm_id IN ( SELECT hadm_id FROM hadm_table WHERE hadm_id IN ( SELECT hadm_id FROM patient WHERE patient.subject_id = 10021487 AND patient.dischtime IS NULL ) ) AND prescription.drug = 'glucagon' ORDER BY prescription.starttime DESC LIMIT 1"
908ebe3140a3419cb32dc270,How much is a surgery referred to as arteriography of femoral and other lower extremity arteries?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'arteriography of femoral and other lower extremity arteries'
7ae946cb6fe7f5a3cac9bfa8,"What was patient 10018423's last time of the bypass coronary artery, one artery from aorta with autologous venous tissue, open approach procedure in 2100?","SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y',procedures_icd.charttime) = '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10018423 AND procedures.procedure = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' AND strftime('%Y',procedures.start_time) = '2100'"
87ac7c2e247976ad4e577de0,What is the minimum total cost of the hospital visits that ever had the drug named cyanocobalamin?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(T1.C1) FROM ( SELECT SUM(C1) AS C1 FROM ( SELECT C1 FROM medications WHERE LOWER(drug_name) = 'cyanocobalamin' ) AS T1 JOIN ( SELECT HOSP_ID FROM prescriptions WHERE LOWER(drug_name) = 'cyanocobalamin' ) AS T2 ON T1.HOSP_ID = T2.HOSP_ID ) AS T3
87fcf9c0339594cc79adb945,"Can you count the instances of the introduction of other thrombolytic into central vein, percutaneous approach procedure in 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.year = 2100 AND procedures.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach'"
11ee027a4849b568c91b8cfe,"Tell me, what were the five most common microbiology tests since 1 year ago?","SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM microbiology AS T1 JOIN ( SELECT T2.subject_id, T2.charttime FROM microbiology AS T2 WHERE T2.charttime >= ( CURRENT_TIMESTAMP - INTERVAL '1 year' ) ) AS T2 ON T1.subject_id = T2.subject_id ) AS T1 GROUP BY T2.test_name ) AS T2 WHERE T1.C1 <= 5"
2592fc0c41e2b7144c374342,"On the current hospital visit, how many days have passed since the first time patient 10021487 was prescribed clobetasol propionate 0.05% cream?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'clobetasol propionate 0.05% cream' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.drug = 'clobetasol propionate 0.05% cream' AND prescriptions.patient_id = 10021487 AND prescriptions.starttime >= ( SELECT MIN(starttime) FROM prescriptions WHERE prescriptions.patient_id = 10021487 AND prescriptions.drug = 'clobetasol propionate 0.05% cream' )"
9be1173dda0a298a23b91c0b,What is the number of patients who were diagnosed with accidents occurring in residential institution in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidents occurring in residential institution' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM diagnoses WHERE diagnosis_name = 'accidents occurring in residential institution' AND strftime('%Y', diagnosis_time) = '2100'"
ee5f304ed38ac06c2b980f3f,Which patients were diagnosed with hyperpotassemia during this year?,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperpotassemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT T1.subject_id FROM patients AS T1 JOIN diagnoses AS T2 ON T1.subject_id = T2.subject_id WHERE T2.diagnosis = 'hyperpotassemia' AND datetime(T2.diagnosis_time,'start of year') = datetime(current_time,'start of year','-0 year')"
4724c2961dfc05d2b08ea4be,"Did patient 10020187 receive restriction of intracranial artery with intraluminal device, percutaneous approach in the last hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of intracranial artery with intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )",SELECT COUNT(*)>0 FROM procedures WHERE procedures.percutaneous_approach_for_intracranial_artery_restriction = 'intracranial artery restriction' AND procedures.patient_id = 10020187 AND procedures.last_hospital_visit = 1
e5f56337e5fbe51641a80d77,What percentile of the hemoglobin value of 8.5 is within the same age as patient 10009628 during their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.5","SELECT DISTINCT T1.C1 FROM ( SELECT lab.valuenum, PERCENT_RANK() OVER ( ORDER BY lab.valuenum ) AS C1 FROM lab WHERE lab.itemid IN ( SELECT itemids FROM items WHERE items.label = 'hemoglobin' ) AND lab.hadm_id IN ( SELECT hadm_id FROM hadm_history WHERE hadm_history.age = ( SELECT hadm_history.age FROM hadm_history WHERE hadm_history.hadm_id = ( SELECT hadm_history.hadm_id FROM hadm_history WHERE hadm_history.patient_id = 10009628 AND hadm_history.dischtime = ( SELECT hadm_history.admittime FROM hadm_history WHERE hadm_history.patient_id = 10009628 AND hadm_history.dischtime IS NOT NULL ORDER BY hadm_history.admittime DESC LIMIT 1 ) ) ) ) AS T1 WHERE T1.valuenum = 8.5"
580f56a66f7626bbcd078c21,Has patient 10023239 had any organisms detected in his last urine microbiology test in 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y',microbiologyevents.charttime) = '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1",10023239 has organisms in the last urine microbiology test of 2100.
feaa451705254e6b2a61a7fb,"During this month, when was the first time that patient 10005817 was prescribed a medication via the iv drip route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.route = 'iv drip' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT MIN(prescription_time) FROM prescriptions WHERE prescription_route = 'iv drip' AND patient_id = 10005817 AND datetime(prescription_time,'start of month') = datetime(current_time,'start of month','-0 month')"
73e1216fd32c02f0a88adb7b,"How many patients were prescribed the medicine metronidazole (flagyl) within 2 months after a diagnosis of urinary tract infection, site not specified since 1 year ago?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject ) FROM ( SELECT subject, diagnosed_time FROM diagnoses WHERE diagnosis = 'urinary tract infection, site not specified' AND datetime(diagnoses.diagnosed_time) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT subject, prescribed_time FROM medications WHERE medication = 'metronidazole (flagyl)' AND datetime(medications.prescribed_time) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject = T2.subject WHERE T1.diagnosed_time < T2.prescribed_time AND datetime(T2.prescribed_time) BETWEEN datetime(T1.diagnosed_time) AND datetime(T1.diagnosed_time,'+2 month')"
f3d6d302751188c87c7c1304,What was the last medication that was prescribed to patient 10004733 in 12/this year through the iv route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT T4.drug FROM ( SELECT T3.drug, T3.starttime FROM ( SELECT T2.drug, T2.starttime FROM ( SELECT T1.subject_id, T1.hadm_id FROM ( SELECT T10004733, T10004733.hadm_id FROM ( SELECT T10004733, generated_med_info.hadm_id FROM ( SELECT T10004733, json_extract(med_info, '$.hadm_id') as hadm_id FROM ( SELECT T10004733, json_extract(med_info, '$.drug') as drug FROM ( SELECT T10004733, json_extract(med_info, '$.starttime') as starttime FROM ( SELECT T10004733, json_extract(med_info, '$.drug') as drug, json_extract(med_info, '$.starttime') as starttime FROM ( SELECT T10004733, json_extract(med_info"
254b58ea3d513164000b4a51,When did patient 10035185 receive red blood cells test the first time in the first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,"SELECT lab_test.chart_time FROM lab_test WHERE lab_test.patient_id = 10035185 AND lab_test.spec_type_desc = 'red blood cells' AND lab_test.chart_time >= ( SELECT lab_test.chart_time FROM lab_test WHERE lab_test.patient_id = 10035185 AND lab_test.spec_type_desc = 'discharge time' AND lab_test.chart_time = ( SELECT MIN( lab_test.chart_time ) FROM lab_test WHERE lab_test.patient_id = 10035185 AND lab_test.spec_type_desc = 'admission time' ) )
        ORDER BY lab_test.chart_time ASC
        LIMIT 1"
9d71dca8add09e321ec57dd9,When did patient 10026354 last have or urine output since 02/26/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-26' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT strftime('%Y-%m-%d %H:%M:%S',records.charttime) FROM records WHERE records.patient_id = 10026354 AND records.output = 'or urine' AND strftime('%Y-%m-%d',records.charttime) >= '2100-02-26' ORDER BY records.charttime DESC LIMIT 1"
c35acfb89f468f360b299535,"What was the first care unit patient 10018845 was in since 1 year ago, according to the transfer record?","SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND transfers.careunit IS NOT NULL AND datetime(transfers.intime) >= datetime(current_time,'-1 year') ORDER BY transfers.intime ASC LIMIT 1","1 year ago, what was the first care unit that patient 10018845 was in?"
5ad1c0bd8c724486755abcd6,How many ICU visits did patient 10018845 have during the first hospital encounter?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT( DISTINCT icu_id ) FROM icu_history WHERE icu_history.hadm_id IN ( SELECT hadm_id FROM hospital_history WHERE hadm_id IN ( SELECT hadm_id FROM patients WHERE subject_id = 10018845 AND hospital_id = 1 ) AND outtime IS NOT NULL ORDER BY hadm_id ASC LIMIT 1 )
d15b77ed559fe4e57aa57aad,"Among patients who were diagnosed with unspecified viral hepatitis c without hepatic coma during this year, what were the top three most common diagnoses that followed within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c without hepatic coma' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.diagnosis_time FROM diagnoses AS T1 JOIN ( SELECT subject_id, diagnosis FROM diagnoses WHERE diagnosis = 'unspecified viral hepatitis c without hepatic coma' ) AS T2 ON T1.subject_id = T2.subject_id ) AS T3 WHERE T3.C1 <= 3"
c486d3f623a7c682d0051190,Has any procedure been carried out on patient 10010471 in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures WHERE procedures.patient_id = 10010471 AND strftime('%Y',procedures.starttime) = '2100'"
ea9a85005a244ffc9f78a09c,Find out the daily minimum or urine output volume of patient 10019172 during the previous month.,"SELECT MIN(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY strftime('%Y-%m-%d',outputevents.charttime)","SELECT MIN(output_volume) FROM ( SELECT output_volume FROM ( SELECT patient_id, output_volume FROM duckdb_output WHERE patient_id = 10019172 ) WHERE output_type_id = 3 ) WHERE datetime(current_time,'start of month') = datetime(current_time,'start of month', '-1 month') GROUP BY datetime(current_time,'%Y-%m-%d')"
c48a0929fbf88f2a30c26873,"What are the three most frequently given microbiology tests for the patients who had previously received destruction of right main bronchus, via natural or artificial opening endoscopic within 2 months, since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.chart_time FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.procedure_name = 'destruction of right main bronchus, via natural or artificial opening endoscopic' AND strftime('%Y',procedures.chart_time) >= '2100' ) AS T1 JOIN ( SELECT patient.subject_id, microbiology.test_name, microbiology.chart_time FROM microbiology JOIN patient ON microbiology.patient_id = patient.subject_id WHERE strftime('%Y',microbiology.chart_time) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T2.chart_time) BETWEEN datetime(T1.chart_time) AND datetime(T1.chart_time,'"
e5cc41e0f6f46286a68677c5,How many people were discharged since 2100 from the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'",SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE status = 'discharged' AND dischtime >= '2100-01-01'
ae1a0149163b093252133a46,"How many patients underwent diagnosis of postprocedural fever within 2 months after being diagnosed with body mass index 35.0-35.9, adult throughout this year?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural fever' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis LIKE '%postprocedural fever%' ) AS T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis LIKE '%body mass index 35.0-35.9, adult%' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T2.diagnosis_time) BETWEEN datetime(T1.diagnosis_time) AND datetime(T1.diagnosis_time,'+2 month') ) AS T3"
06b4d2263fcb4017df542024,Tell me the top three diagnoses with the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT T1.diagnosis, T1.C1 FROM ( SELECT diagnosis, 100- ( SUM(CASE WHEN patients.dod_month IS NOT NULL THEN 1 WHEN strftime('%J', patients.dod_month) - strftime('%J', patients.age) > 1 * 365 / 2 THEN 1 ELSE 0 END) * 100 / COUNT(*) AS C1 FROM patients WHERE patients.dischtime IS NOT NULL AND strftime('%J', patients.dod_month) - strftime('%J', patients.age) > 1 * 365 / 2 GROUP BY diagnosis ) AS T1 WHERE T1.C13 < 100 ORDER BY T1.C1 DESC LIMIT 3"
d4949e694ea61ec816d403c4,"On 04/05/this year, what was the average value of respiratory rate for patient 10012552?","SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '04-05'",SELECT AVG(respiratory_rate) FROM ( SELECT respiratory_rate FROM medical_database.patients WHERE patient_id = 10012552 )
e1c0f14b4eaae169e2ee99f7,How many patients were prescribed with bupropion (sustained release) in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupropion (sustained release)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patient_id ) FROM prescriptions WHERE prescriptions.drug = 'bupropion (sustained release)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')"
783af9c867b3757480fa6805,Can you tell me the top five most common procedures this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.code FROM procedures AS T1 JOIN ( SELECT T2.code FROM ( SELECT T1.code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures AS T1 JOIN ( SELECT diagnoses.code, procedures.starttime FROM diagnoses JOIN procedures ON diagnoses.object_id = procedures.object_id ) AS T2 ON T1.object_id = T2.object_id WHERE datetime(T1.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY T1.code ) AS T3 WHERE T3.C1 <= 5 ) AS T4 JOIN ( SELECT diagnoses.code, procedures.code, procedures.starttime FROM diagnoses JOIN procedures ON diagnoses.object_id = procedures.object_id ) AS T5 ON T4.code = T5.code AND T4.starttime = T5.starttime"
3a676bfafee66c27173904e8,"On the first hospital visit, was patient 10005866 admitted to the emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1
5534a345d569cc39211962ae,How many patients underwent other electric countershock of heart within 2 months after the diagnosis with personal history of tobacco use?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'personal history of tobacco use' ) AS T1 JOIN ( SELECT subject_id, treatment_time FROM treatments WHERE treatment = 'other electric countershock of heart' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.treatment_time AND datetime(T2.treatment_time) BETWEEN datetime(T1.diagnosis_time) AND datetime(T1.diagnosis_time,'+2 month') ) AS T3"
ad25b33f618fbda4463dc6d1,Is patient 10021938 recorded as male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10021938,SELECT gender FROM patients WHERE patient_id = 10021938
d738685ff207376b36d479fc,Is the value of patient 10021118's body temperature from second measurement on the last ICU visit less than its first measurement on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT measurements.value FROM measurements WHERE measurements.patient_id = 10021118 AND measurements.type = 'body temperature' AND measurements.when = ( SELECT icu_stays.intime FROM icu_stays WHERE icu_stays.patient_id = 10021118 AND icu_stays.outtime IS NOT NULL ORDER BY icu_stays.intime DESC LIMIT 1 ) ORDER BY measurements.when ASC LIMIT 1 OFFSET 1 ) < ( SELECT measurements.value FROM measurements WHERE measurements.patient_id = 10021118 AND measurements.type = 'body temperature' AND measurements.when = ( SELECT icu_stays.intime FROM icu_stays WHERE icu_stays.patient_id = 10021118 AND icu_stays.outtime IS NOT NULL ORDER BY icu_stays.intime DESC LIMIT 1 ) ORDER BY measurements.when ASC LIMIT 1 )
7d3d29193e98b64900b4be0a,What was the length of stay in days for patient 10012552's last hospitalization?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10012552 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","SELECT strftime('%J',patients.dischtime) - strftime('%J',patients.admittime) FROM patients WHERE patients.subject_id = 10012552 AND strftime('%Y',patients.admittime) = 2100 ORDER BY patients.admittime DESC LIMIT 1"
346a6c07df798347268b1abd,What was the total dosage of 5% dextrose that patient 10019172 was prescribed in 10/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.drug = '5% dextrose' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10'","SELECT SUM(dosage) FROM medications WHERE medications.patient_id = 10019172 AND medications.drug = '5% dextrose' AND datetime(medications.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',medications.starttime) = '10'"
8a165a892467a3f42aa7f482,When did patient 10026255 last get a procedure since 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.patient_id = 10026255 AND strftime('%Y',procedures.starttime) >= '2100' ORDER BY procedures.starttime DESC LIMIT 1"
3f3eaf9f4ef204effd22e28b,What is the length of the first hospital stay in days for patient 10020786?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT strftime('%J',pat.chart_end_time) - strftime('%J',pat.chart_start_time) FROM ( SELECT patient_id, MIN(diagnosis_time) AS chart_start_time, MAX(dischtime) AS chart_end_time FROM diagnoses WHERE patient_id = 10020786 GROUP BY patient_id ) AS pat"
7535579b90cfcb61fed1c380,What was the organism's name found in the last peritoneal fluid microbiology test of patient 10021487 since 09/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT organism_name FROM microbiology_test WHERE microbiology_test.patient_id = 10021487 AND microbiology_test.spec_type_desc = 'peritoneal fluid' AND microbiology_test.charttime >= '2100-09-01' ORDER BY microbiology_test.charttime DESC LIMIT 1
502ed6b90b3e2ec409aab683,"Since 2100, how many patients were diagnosed with cyst and pseudocyst of pancreas in the same month after being diagnosed with secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cyst and pseudocyst of pancreas' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis_time >= '2100-01-01' AND diagnosis = 'cyst and pseudocyst of pancreas' ) AS T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis_time >= '2100-01-01' AND diagnosis = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T1.diagnosis_time,'start of month') = datetime(T2.diagnosis_time,'start of month') ) AS T1"
104c93f89e19274578bafb8d,"When in the first hospital encounter did patient 10038999 receive their first drainage of left pleural cavity, percutaneous approach, diagnostic procedure?","SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1","SELECT MIN(T1.charttime) FROM ( SELECT charttime FROM procedures WHERE procedure = 'drainage of left pleural cavity, percutaneous approach, diagnostic' AND T1.hadm_id IN ( SELECT T2.hadm_id FROM ( SELECT hadm_id FROM admissions WHERE subject_id = 10038999 AND dischtime IS NOT NULL ORDER BY hadm_id ASC LIMIT 1 ) AS T2 ) AS T1 JOIN ( SELECT hadm_id,charttime FROM procedures WHERE procedure = 'admission' AND hadm_id IN ( SELECT T2.hadm_id FROM ( SELECT hadm_id FROM admissions WHERE subject_id = 10038999 AND dischtime IS NOT NULL ORDER BY hadm_id ASC LIMIT 1 ) AS T2 ) AS T3 ON T1.hadm_id = T3.hadm_id WHERE T1.charttime >= T3.charttime"
74968f3f69d0e352733f0a96,When was patient 10027602's first maximum pt in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",SELECT pt_max FROM ( SELECT * FROM lab WHERE pt_patient = 10027602 AND dt_time >= '2100-12-01' AND dt_time < '2100-12-31' ) AS pt_max WHERE pt_max.dt_time = ( SELECT pt_patient.dt_time FROM pt_patient WHERE pt_patient.pt_patient = 10027602 AND pt_patient.dt_time >= '2100-12-01' AND pt_patient.dt_time < '2100-12-31' ORDER BY pt_patient.pt_value DESC LIMIT 1 )
41a1ed79e0d60db97ece0e23,What was the insurance name of patient 10002930 during the first hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT insurance_name FROM patients WHERE patient_id = 10002930 AND visit_count = 1
2f0d855d95535316ee099fde,Could you retrieve patient 10018081's daily minimum weight?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MIN(weight) FROM ( SELECT weight FROM patients WHERE patient_id = 10018081 GROUP BY date_trunc('day') ) subquery
4b10d0fec2f23acab915e3f3,Count how many times in the first hospital visit patient 10004457 had coronary arteriography using two catheters.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) FROM ( SELECT * FROM patients WHERE patients.subject_id = 10004457 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1 ) subquery
e5e99a0d4249da9d001cf97b,Has any laboratory test been performed on patient 10009049 since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*)>0 FROM lab_test WHERE lab_test.patient_id = 10009049 AND strftime('%Y-%m',lab_test.charttime) >= '2100-04'"
8a0d9ca8816e2d1ca14e3fca,What was the last drug that patient 10019172 was prescribed in 11/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT T1.drug FROM ( SELECT prescriptions.drug, row_number() OVER (PARTITION BY prescriptions.patient_id ORDER BY prescriptions.starttime DESC) AS C1 FROM prescriptions WHERE prescriptions.patient_id = 10019172 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ) AS T1 WHERE T1.C1 <= 1"
53388f93019e894471f1753a,Has patient 10026354 undergone a procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ),SELECT COUNT(*)>0 FROM procedures WHERE procedures.per_pat_id = 10026354
9930fa67b91f89cc964e7df3,Get the sum of the outputs that happened on 12/18/2100 for patient 10021487.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-18'",SELECT SUM(output) FROM ( SELECT output FROM ( SELECT * FROM input WHERE input_time >= '2100-12-18' AND input_time < '2100-12-19' AND subject_id = 10021487 ) AS T1 JOIN output ON T1.output_id = output.output_id ) AS T2
97bd7321746aeee64c00043b,How much does patient 10014729 change in mch last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10014729 AND lab_tests.spec_type_desc = 'mch' AND lab_tests.charttime = ( SELECT lab_tests.charttime FROM lab_tests WHERE lab_tests.patient_id = 10014729 AND lab_tests.spec_type_desc = 'mch' AND lab_tests.charttime = ( SELECT MAX(charttime) FROM lab_tests WHERE lab_tests.patient_id = 10014729 AND lab_tests.dischtime IS NOT NULL ORDER BY lab_tests.charttime DESC LIMIT 1 ) - INTERVAL '1 year' ) ) - ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10014729 AND lab_tests.spec_type_desc = 'mch' AND lab_tests.charttime = ( SELECT lab_tests.charttime FROM lab_tests WHERE lab_tests.patient_id = 10014729 AND lab_
2b27156e1bc6e928eb6b916e,Get patient 10039831's yearly minimum weight information since 08/2100.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-08' GROUP BY strftime('%Y',chartevents.charttime)","SELECT MIN(T1.weight) FROM ( SELECT weight FROM patients WHERE patient_id = 10039831 AND starttime >= '2100-08-01' AND starttime < '2100-09-01' GROUP BY strftime('%Y',starttime) ) AS T1"
385953d76516f1f4e2f55b54,"What are the five frequently taken specimens for patients that received bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach previously in the same hospital visit in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.chart_time, admissions.admission_id FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id WHERE procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' AND strftime('%Y',procedures.chart_time) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, spec_type_desc, chart_time FROM microbiology JOIN admissions ON microbiology.admission_id = admissions.admission_id WHERE strftime('%Y',chart_time) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND T1.admission_id = T2.admission_"
3909981e7b8628b8ba2086c0,When did patient 10002495 have an input for the last time on the first ICU stay?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,SELECT icu_inputs.input_time FROM icu_inputs WHERE icu_inputs.icu_id IN ( SELECT icu.icu_id FROM icu WHERE icu.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icu.outtime IS NOT NULL ORDER BY icu.intime ASC LIMIT 1 ) ORDER BY icu_inputs.input_time DESC LIMIT 1
1afade11184c7bc98c9756f8,"When did the last time patient 10005909 have a fibrinogen, functional lab test in the first hospital visit?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT lab.charttime FROM lab WHERE lab.patient = 10005909 AND lab.spec_type_desc = 'fibrinogen, functional' AND lab.charttime >= ( SELECT lab.charttime FROM lab WHERE lab.patient = 10005909 AND lab.spec_type_desc = 'fibrinogen, functional' ORDER BY lab.charttime ASC LIMIT 1 ) ORDER BY lab.charttime DESC LIMIT 1"
e75cb39d6c5c866076d93717,"Count the number of patients diagnosed with cocaine abuse, unspecified.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cocaine abuse, unspecified' ) )","SELECT COUNT( DISTINCT patient_id ) FROM diagnoses WHERE diagnosis = 'cocaine abuse, unspecified'"
67988ec18e5b42a1ac974aae,"Find the number of patients who had a dilation of left external iliac vein with intraluminal device, percutaneous approach procedure during this year.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' AND datetime(procedures.start_time,'start of year') = datetime(current_time,'start of year','-0 year')"
eb20ba71a6257201e3668689,What was the weight of patient 10006580 in the first measurement?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(Clinical_Results.Weight) FROM Clinical_Results WHERE Clinical_Results.Patient_ID = 10006580 AND Clinical_Results.Measurement_Time = ( SELECT MIN( Measurement_Time ) FROM Clinical_Results WHERE Clinical_Results.Patient_ID = 10006580 )
841488e721d7a4c3f1c219d0,Could you tell me the first procedure that patient 10019777 had in their first hospital encounter?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1 ),SELECT procedures.name FROM procedures WHERE procedures.patient_id = 10019777 AND procedures.charttime >= ( SELECT admissions.charttime FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.charttime ASC LIMIT 1 ) ORDER BY procedures.charttime ASC LIMIT 1
6dc27e0c371f7e5dd9d2a981,When was the first time on the first ICU stay that patient 10027602's SaO2 was greater than 95.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 95.0 ORDER BY chartevents.charttime ASC LIMIT 1,"SELECT strftime('%Y-%m-%d %H:%M:%S', patient 10027602's icu stay 1's intime) as in_time
         FROM icustays
         WHERE patient 10027602's id = 10027602 AND patient 10027602's icu stay 1's outtime IS NULL
         AND patient 10027602's SaO2 > 95.0
         ORDER BY in_time ASC
         LIMIT 1"
b4a9db553c9c11bc9d4ae440,What label is associated with activity o2 sat - aerobic activity response?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'activity o2 sat - aerobic activity response',SELECT DISTINCT label FROM procedures WHERE procedure_name = 'activity o2 sat - aerobic activity response'
dddc1e74733a55f7407289ad,"Since 1 year ago, what are the top five most frequently ordered laboratory tests for patients within the same month after diagnosed with dyskinesia of esophagus?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dyskinesia of esophagus' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE diagnoses.diagnosis = 'dyskinesia of esophagus' AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT patient.subject_id, lab.test_name, lab.charttime FROM lab JOIN patient ON lab.patient_id = patient.subject_id WHERE datetime(lab.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5"
fbd3d4a2eec48bed918ccbea,What is the cost of morphine sulfate (oral solution) 2 mg/ml?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate (oral solution) 2 mg/ml' ),SELECT DISTINCT cost FROM medications WHERE medication_name = 'morphine sulfate (oral solution) 2 mg/ml'
a196342dccc0b8df5c23dbb4,Calculate the total number of patients diagnosed with other and unspecified anti-infectives causing adverse effects in therapeutic use who didn't revisit the hospital within the same month since 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified anti-infectives causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified anti-infectives causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) >= '2100' AND datetime(T2.charttime,'start of month') = datetime(admissions.admittime,'start of month') )","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses.diagnosis_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'other and unspecified anti-infectives causing adverse effects in therapeutic use' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.diagnosis_time, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'other and unspecified anti-infectives causing adverse effects in therapeutic use' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T1.diagnosis_time,'start of month') = datetime("
b92ebae1949522c66677d297,What is the label assigned to arterial line waveform appear?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'arterial line waveform appear',SELECT DISTINCT label FROM concepts WHERE concept_name = 'arterial line waveform'
307e60bc520a7699ba41926e,Provide me with the five most common diagnoses in this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",SELECT T1.diagnosis FROM diagnoses AS T1 JOIN prescriptions AS T2 ON T1.diagnosis = T2.drug_name WHERE T1.year = 2100 GROUP BY T1.diagnosis ORDER BY COUNT(*) DESC LIMIT 5
a097854bd791e910e6d7bb57,Calculate how many times patient 10018081 had the input of dextrose 5% since 12/2100.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12'","SELECT COUNT(*) FROM inputevents WHERE inputevents.patient = 10018081 AND inputevents.item = 'dextrose 5%' AND strftime('%Y-%m',inputevents.starttime) >= '2100-12'"
cd72a23c76002c4a524a1b61,How many ICU visits did patient 10022880 have during this year?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT( DISTINCT icu_id ) FROM icu_history WHERE icu_history.hadm_id IN ( SELECT hadm_id FROM hadm_history WHERE hadm_id IN ( SELECT hadm_id FROM patients WHERE patient_id = 10022880 ) ) AND datetime(icu_history.intime,'start of year') = datetime(current_time,'start of year','-0 year')"
59d98dcbea98f9f9a4f33d08,"Since 04/09/2100, when did patient 10013049 have the last input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-09' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT input_time FROM input_events WHERE input_events.patient_id = 10013049 AND strftime('%Y-%m-%d',input_time) >= '2100-04-09' ORDER BY input_time DESC LIMIT 1"
a9ddcfc0c9931bdb889ac570,What is the current number of hospitalized patients?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT(*) FROM patients WHERE patients.dischtime IS NULL
c7725f7db94c9ef481ad6bc8,"Get me the top three most frequently tested specimens that patients took within the same hospital visit after being diagnosed with other postprocedural shock, initial encounter in 2100.","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other postprocedural shock, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'other postprocedural shock, initial encounter' AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, specimens.spec_type_desc, specimens.charttime, admissions.admission_id FROM specimens JOIN admissions ON specimens.admission_id = admissions.admission_id WHERE strftime('%Y',specimens.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.admission_id = T2.admission_"
461ff9eeedf5e9452cbf12b2,"Has patient 10007818 had any drainage of peritoneal cavity, percutaneous approach, diagnostic treatment in 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","10007818 has received drainage of peritoneal cavity, percutaneous approach, diagnostic in 2100"
c15288bf26d6222c25fe91c5,Tell me the total ICU visits of patient 10022281 in this year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT( DISTINCT icu_id ) FROM icu_visits WHERE icu_id IN ( SELECT icu_id FROM patients WHERE patient_id = 10022281 ) AND datetime(icu_visits.start_time,'start of year') = datetime(current_time,'start of year','-0 year')"
fca670cf3abe9563c60d2488,"What was the first time patient 10031757 was prescribed milk of magnesia and polyethylene glycol since 08/2100, at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'milk of magnesia' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'polyethylene glycol' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.starttime FROM ( SELECT patient 10031757, prescription_starttime FROM prescriptions WHERE prescription_starttime >= '2100-08-01' AND patient = 10031757 AND prescription = 'milk of magnesia' ) AS T1 JOIN ( SELECT patient 10031757, prescription_starttime FROM prescriptions WHERE prescription_starttime >= '2100-08-01' AND patient = 10031757 AND prescription = 'polyethylene glycol' ) AS T2 ON T1.patient = T2.patient WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1"
ee981ea61809ebc1e0cc8d32,Tell me the length of stay in days for patient 10018328's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1",10018328's first ICU stay has a length of 120 days.
26fba96883d9bde92fd8e95f,How many hours have elapsed since the last time patient 10004733 on this hospital stay received a lab test for lactate dehydrogenase (ld)?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', lab_test.charttime) ) FROM lab_test WHERE lab_test.patient = 10004733 AND lab_test.test = 'lactate dehydrogenase (ld)' AND lab_test.charttime >= ( SELECT lab_test.charttime FROM lab_test WHERE lab_test.patient = 10004733 AND lab_test.test = 'lactate dehydrogenase (ld)' ORDER BY lab_test.charttime DESC LIMIT 1 )"
9cdee4aaa2811035370a1c86,Could you show me the daily average weight of patient 10039831 since 07/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-07' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT AVG(T1.weight) FROM ( SELECT weight FROM patients WHERE patient_id = 10039831 ) AS T1 JOIN ( SELECT prescription_id,drug_start_time FROM prescriptions WHERE patient_id = 10039831 ) AS T2 ON T1.prescription_id = T2.prescription_id WHERE T1.drug_start_time >= '2100-07-21' GROUP BY strftime('%Y-%m-%d',T2.drug_start_time)"
d91bb87c28806cef8d1448de,When did patient 10023117 for the first time get discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10023117 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patient.dischtime FROM patient WHERE patient.subject = 10023117 ORDER BY patient.dischtime ASC LIMIT 1
c90feea97a983090cf329a91,"This year, what are the top five most frequently prescribed medications for patients who were also prescribed alteplase at the same time?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alteplase' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alteplase' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5<|"
c1c9a4182c3701af71cb1ea6,"What are the five most frequently prescribed medications for patients diagnosed with urethral stricture, unspecified previously within 2 months, this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urethral stricture, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'urethral stricture, unspecified' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1"
5061007ac9969cb42e64a034,When was the first time patient 10018328 had been prescribed enalapril maleate and amlodipine at the same time since 02/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'enalapril maleate' AND admissions.subject_id = 10018328 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'amlodipine' AND admissions.subject_id = 10018328 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.starttime FROM ( SELECT patient_10018328, prescription_starttime FROM prescriptions WHERE prescription_starttime >= '2100-02-01' AND patient_10018328 = 10018328 AND prescription_drug = 'enalapril maleate' ) AS T1 JOIN ( SELECT patient_10018328, prescription_starttime FROM prescriptions WHERE prescription_starttime >= '2100-02-01' AND patient_10018328 = 10018328 AND prescription_drug = 'amlodipine' ) AS T2 ON T1.patient_id = T2.patient_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1"
684346bf3b100ce2706bc5b6,How many patients received senna prescription since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'senna' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM prescriptions WHERE prescription_name = 'senna' AND strftime('%Y',prescription_date) >= '2100'"
6f8551a85f07e537ff14bede,How long has it been in hours since the first time ciprofloxacin iv was prescribed to patient 10018081 on the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'ciprofloxacin iv' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescription.starttime) ) FROM prescription WHERE prescription.hadm_id IN ( SELECT hadm_id FROM hadm_table WHERE hadm_id IN ( SELECT hadm_id FROM admissions WHERE subject_id = 10018081 AND is_active = 1 ) ) AND prescription.drug = 'ciprofloxacin iv' ORDER BY prescription.starttime ASC LIMIT 1"
9e71c9503ead8f262e901ec1,When was patient 10005348 prescribed with docusate sodium and dorzolamide 2%/timolol 0.5% ophth. for the first time at the same time since 08/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'docusate sodium' AND admissions.subject_id = 10005348 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'dorzolamide 2%/timolol 0.5% ophth.' AND admissions.subject_id = 10005348 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.starttime FROM ( SELECT patient 10005348, prescription_starttime FROM prescriptions WHERE prescription_starttime >= '2100-08-21' AND drug = 'docusate sodium' ) AS T1 JOIN ( SELECT patient 10005348, prescription_starttime FROM prescriptions WHERE prescription_starttime >= '2100-08-21' AND drug = 'dorzolamide 2%/timolol 0.5% ophth.' ) AS T2 ON T1.patient = T2.patient WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1"
7ecf2158ebabd494e514c3df,What does a procedure called total esophagectomy cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'total esophagectomy'
73710b96b938a24a7a5c86d5,Tell me the medication that patient 10014729 was prescribed for the first time?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10014729 ORDER BY prescriptions.start_time ASC LIMIT 1
545a6730c778873c467d8235,Has there been any organism found in the last blood (toxo) microbiology test patient 10038081 received on their last hospital encounter?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood (toxo)' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT COUNT(*)>0 FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiology_events.spec_type_desc = 'blood (toxo)' AND microbiology_events.org_name IS NOT NULL ORDER BY microbiology_events.charttime DESC LIMIT 1
72e0ab522c86eeb3cfdf64d1,When did patient 10016742 first have the minimum heart rate since 282 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-282 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1","SELECT MIN(heart_rate) FROM patients WHERE patient_id = 10016742 AND datetime(heart_rate_last) >= datetime(current_time,'-282 day')"
6b2dc0daeb3f829f08bf8da2,"Since the first time patient 10004733 was diagnosed with anemia of other chronic disease in the current hospital visit, how many hours has it been?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia of other chronic disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnosis.diagnosis_time) ) FROM diagnosis WHERE diagnosis.patient_id = 10004733 AND diagnosis.diagnosis = 'anemia of other chronic disease' AND diagnosis.dischtime IS NULL"
0935d36097c74026c3b0a63f,What was the insurance plan of patient 10021666 during the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT insurance FROM patients WHERE patient_id = 10021666 AND encounter_id = 1
87caa8d42ef02882ac678a0c,"Following the diagnosis of other abnormal blood chemistry , how many patients developed autistic disorder, current or active state within the same month?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other abnormal blood chemistry' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'autistic disorder, current or active state' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'other abnormal blood chemistry' ) AS T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'autistic disorder, current or active state' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T1.diagnosis_time,'start of month') = datetime(T2.diagnosis_time,'start of month') ) AS T1"
2e40656c79819632933f3d54,"The number of patients who received drainage of right pleural cavity with drainage device, percutaneous approach.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )","SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE procedure_name = 'drainage of right pleural cavity with drainage device, percutaneous approach'"
160050686bf62ecef4c7dce6,Could you tell me the name of the drug that was prescribed two or more times in 07/this year to patient 10020740?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T1.drug FROM ( SELECT prescription.drug, COUNT(prescription.starttime) AS c1 FROM prescription WHERE prescription.patient = 10020740 AND datetime(prescription.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescription.starttime) = '07' GROUP BY prescription.drug ) AS T1 WHERE T1.c1 >= 2"
419163a7cde49786dfda6fcd,When was patient 10019172 first discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT patient.dischtime FROM patient WHERE patient.subject = 10019172 ORDER BY patient.dischtime ASC LIMIT 1
764c80fc36e53d7964e0f522,"Since 01/2100, when was patient 10038933's first microbiology test done?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiology.chart_time FROM microbiology WHERE microbiology.patient_id = 10038933 AND strftime('%Y-%m',microbiology.chart_time) >= '2100-01' ORDER BY microbiology.chart_time ASC LIMIT 1"
e4373b254aad4b11af3fda65,When did patient 10029291 last have a fecal bag event on 03/06/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'fecal bag' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-06' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT id FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'fecal bag' AND strftime('%Y-%m-%d',microbiologyevents.charttime) = '2100-03-06' ) AS T ORDER BY id DESC LIMIT 1"
e24591cf66202f06a8ac856c,How much is a diagnosis of secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes going to cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes' ) ),SELECT DISTINCT cost FROM sql_table WHERE table_name = 'diagnoses' AND constraint_text = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes'
aef4b8676c07216d65074512,"How many days have passed since patient 10018081 was given a osmolality, urine laboratory test for the last time in the current hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', lab_test.charttime) ) FROM lab_test WHERE lab_test.patient = 10018081 AND lab_test.label = 'osmolality, urine' AND lab_test.charttime = ( SELECT lab_test2.charttime FROM lab_test AS lab_test2 WHERE lab_test2.patient = 10018081 AND lab_test2.label = 'osmolality, urine' AND lab_test2.charttime = ( SELECT charttime FROM lab_test WHERE lab_test.patient = 10018081 AND lab_test.label = 'osmolality, urine' ORDER BY lab_test.charttime DESC LIMIT 1 ) )"
52015439c33be0dc487387d4,"What does a bilirubin, total, ascites lab test typically cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, ascites' ) )","SELECT DISTINCT cost FROM lab_tests WHERE test_name = 'bilirubin, total, ascites'"
8e96be7df6dd4cc4c1e2a3b4,How much is the daily minimum weight of patient 10031757 during the last hospital encounter?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)",SELECT MIN(T1.weight) FROM ( SELECT weight FROM patients WHERE patient_id = 10031757 AND encounter_id = ( SELECT encounter_id FROM transfers WHERE receiver = 'dischtime' AND sender = 'transfer' AND time = ( SELECT MIN(time) FROM transfers WHERE receiver = 'dischtime' AND sender = 'transfer' AND patient_id = 10031757 AND encounter_id = ( SELECT encounter_id FROM encounters WHERE patient_id = 10031757 AND hospital_id = 2 ) ) ) ) AS T1
71cdc4002dd9037845bd713a,When did patient 10031404 have the first procedure?,SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ORDER BY procedures_icd.charttime ASC LIMIT 1,SELECT procedures.start_time FROM procedures WHERE procedures.patient_id = 10031404 ORDER BY procedures.start_time ASC LIMIT 1
9d986798e601a07346824191,What's the cost of a treatment known as excision of dental lesion of jaw?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) ),SELECT DISTINCT cost FROM procedures WHERE procedure_name = 'excision of dental lesion of jaw'
1ade36110470a7879a7d9e8f,"For patients diagnosed with unspecified disorder of kidney and ureter, what were the top three most common microbiology tests that followed in the same hospital encounter since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified disorder of kidney and ureter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'unspecified disorder of kidney and ureter' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiology.test_name, microbiology.charttime, admissions.hadm_id FROM microbiology JOIN admissions ON microbiology.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiology.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP"
a17ee07e69ba77566438512c,"Among patients diagnosed with essential and other specified forms of tremor, what were the top four most common lab tests that followed during the same month throughout this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'essential and other specified forms of tremor' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.diagnosis_time FROM ( SELECT subject_id, diagnosis_time, diagnosis_id FROM diagnoses WHERE diagnosis_time >= '2100-01-01' AND diagnosis_time < '2101-01-01' AND diagnosis_id IN ( SELECT diagnosis_id FROM diagnoses WHERE diagnosis LIKE '%essential and other specified forms of tremor%' ) ) AS T1 JOIN labtests AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.test_time AND datetime(T1.diagnosis_time,'start of year') = datetime(T2.test_time,'start of year') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4"
d198804fbc8f627ea7a4dd74,Can you provide the first care unit that patient 10010471 was in according to the transfer record?,SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime ASC LIMIT 1,SELECT transfers.care_unit FROM transfers WHERE transfers.patient_id = 10010471 AND transfers.care_unit IS NOT NULL ORDER BY transfers.transfer_time ASC LIMIT 1
ce3edde36063a4aeb5180c6d,"On last month/20, what was the maximum value of respiratory rate of patient 10019172?","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '20'","SELECT MAX(respiratory_rate) FROM ( SELECT respiratory_rate FROM patients WHERE patient_id = 10019172 ) WHERE datetime(respiratory_rate_date,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',respiratory_rate_date) = '20'"
9fd9c725dd075244d0eab9a8,What was the maximum sodium of patient 10020187?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ),SELECT MAX(diastolic_bp) FROM ( SELECT diastolic_bp FROM procedures WHERE patient_id = 10020187 )
426ce736177896950ecec77f,When was the first time when patient 10038933 received a other diagnostic procedures on lung or bronchus treatment during the first hospital encounter?,SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.patient_id = 10038933 AND procedures.type_id = 10020043 AND procedures.starttime >= ( SELECT admissions.starttime FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.starttime ASC LIMIT 1 ) ORDER BY procedures.starttime ASC LIMIT 1
7995633cbc3e134de24ae114,"How many hours has it been since the last time patient 10004733 stayed in the ""neurology"" careunit in this hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.careunit = 'neurology' AND transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject = 10004733 AND admissions.dischtime IS NULL ) ORDER BY transfers.intime DESC LIMIT 1"
6e6c78c24792cbb6c1a9ef28,What is the name of the procedure done to patient 10002495 two times since 06/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT T1.long_title FROM procedures AS T1 JOIN ( SELECT T2.long_title, COUNT( T2.long_title ) AS C1 FROM procedures AS T2 WHERE T2.patient_id = 10002495 AND strftime('%Y-%m',T2.start_time) >= '2100-06' GROUP BY T2.long_title ) AS T3 ON T1.long_title = T3.long_title WHERE T3.C1 = 2"
d86a9b2695aa71af6d0d7d55,What treatment did patient 10021118 last receive in their last hospital encounter?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime DESC LIMIT 1 ),SELECT treatment.treatment_name FROM treatment WHERE treatment.patient_id = 10021118 AND treatment.hospital_id = ( SELECT patient.hospital_id FROM patient WHERE patient.name = 'user' AND patient.age BETWEEN 18 AND 30 AND patient.gender = 'male' AND patient.hospital_id <> ( SELECT current_setting('hospital_id')::integer ) ORDER BY patient.hospital_id DESC LIMIT 1 ) ORDER BY treatment.treatment_time DESC LIMIT 1
3f4e4d4220d360db25ef5ec8,What is the daily average dose of packed red blood cells given to patient 10008454 in 12/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)","SELECT AVG(daily_input.total) FROM ( SELECT SUM(input_events.total) AS total FROM input_events WHERE input_events.patient_id = 10008454 AND input_events.input_type_id = ( SELECT input_types.input_type_id FROM input_types WHERE input_types.label = 'packed red blood cells' ) AND strftime('%Y-%m',input_events.starttime) = '2100-12' GROUP BY strftime('%Y-%m-%d',input_events.starttime) ) AS daily_input"
e27e5f5f51fb07c86c07786c,Tell me the top five most common diagnoses of patients aged 20s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.diagnosis FROM ( SELECT diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM patients WHERE patients.age BETWEEN 20 AND 29 AND strftime('%Y', patients.admittime) = '2100' GROUP BY diagnosis ) as T1 WHERE T1.C1 <= 5"
dbf9297a4c1d683faa792fef,What is the yearly minimum volume of emesis that patient 10001217 had since 07/2100?,"SELECT MIN(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'emesis' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-07' GROUP BY strftime('%Y',outputevents.charttime)","SELECT MIN(diagnoses.volume) FROM diagnoses WHERE diagnoses.patient_id = 10001217 AND diagnoses.type = 'emesis' AND strftime('%Y-%m',diagnoses.start_time) >= '2100-07'"
21d5909e4b60ccf617b739c8,Can you list the top four most frequent procedures that patients received in the same month after having right heart cardiac catheterization in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.long_title FROM ( SELECT T2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.chart_time FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.long_title = 'right heart cardiac catheterization' AND strftime('%Y',procedures.chart_time) = '2100' ) AS T1 JOIN ( SELECT patient.subject_id, procedures.long_title, procedures.chart_time FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE strftime('%Y',procedures.chart_time) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T2.chart_time AND datetime(T1.chart_time,'start of month') = datetime(T2.chart_time,'start of month') GROUP BY T2.long_title ) AS T3 WHERE T3.C1 <= 4<|im"
3625536660a06042f6c55dae,What's the cost of a triglycer lab test?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycer' ) ),SELECT DISTINCT cost FROM lab_tests WHERE test_name = 'triglycer'
1e939d14d1e8cb2be9b12f9f,"Count the number of patients diagnosed with dissection of aorta, abdominal who did not come to the hospital within 2 months in 2100.","SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of aorta, abdominal' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of aorta, abdominal' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) = '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T2.diagnosis_time FROM ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'dissection of aorta, abdominal' ) AS T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'dissection of aorta, abdominal' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T2.diagnosis_time,'start of year') = datetime(T1.diagnosis_time,'start of year') ) AS T1 JOIN ( SELECT subject_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'dissection of aorta, abdominal' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.diagnosis_time AND datetime(T2.diagnosis_time,'start of year') = datetime(T1.di"
82b93a79d0dad5db6d3f5918,Has patient 10008454 been in the hospital this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10008454 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM hospital WHERE hospital.subject_id = 10008454 AND datetime(hospital.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"
9aad765d228011b95c3cf16c,Show me the top five diagnoses that have the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT T1.diagnosis, T1.c1 FROM ( SELECT diagnosis, 100- ( ( SUM(CASE WHEN patients.dod_month - patients.diagnosis_month > 6 * 365/24 THEN 1 WHEN patients.dod_month - patients.diagnosis_month > 6 * 365/24 THEN 1 ELSE 0 END) * 100 / COUNT(*) ) as c1 FROM ( SELECT patients.stay_id, diagnosis, patients.diagnosis_month FROM diagnoses JOIN patients ON diagnoses.patient_id = patients.patient_id WHERE patients.dischtime IS NULL ) AS T1 JOIN patients ON T1.stay_id = patients.stay_id GROUP BY T1.diagnosis ) AS T2 ORDER BY T2.c1 DESC LIMIT 5"
d4b6c0167cad9291a4e1dbec,Is the value of troponin t in patient 10007058 from the last measurement on the first hospital visit greater than its second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10007058 AND lab_tests.spec_type_desc = 'troponin t' ORDER BY lab_tests.charttime DESC LIMIT 1 ) > ( SELECT lab_value FROM lab_tests WHERE lab_tests.patient_id = 10007058 AND lab_tests.spec_type_desc = 'troponin t' ORDER BY lab_tests.charttime DESC LIMIT 1 OFFSET 1 )
70516111809660e05336d719,When was the first sputum microbiology test performed on patient 10021487 in 12/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiology.charttime FROM microbiology WHERE microbiology.patient = 10021487 AND microbiology.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiology.charttime) = '2100-12' ORDER BY microbiology.charttime ASC LIMIT 1"
79c09379a9bdcb0e976df35f,Show me the top four most common microbiology tests since 1 year ago.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT T1.test_name FROM microbiology AS T1 JOIN ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiology AS T2 JOIN ( SELECT diagnoses.diagnosis_id, procedures.procedure_time FROM diagnoses JOIN procedures ON diagnoses.diagnosis_id = procedures.diagnosis_id ) AS T3 ON T2.diagnosis_id = T3.diagnosis_id WHERE datetime(T3.procedure_time) >= datetime(current_time,'-1 year') GROUP BY T2.test_name ) AS T4 ON T1.test_name = T4.test_name WHERE T4.C1 <= 4"
42dafd4cb9bdc6f884302fb7,Calculate how many times patient 10021487 had the input of kcl (bolus) in 12/last year.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'","SELECT COUNT(*) FROM inputevents WHERE inputevents.patient = 10021487 AND inputevents.item = 'kcl (bolus)' AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'"
9a8ac4df220dc07a83eeae9b,When was patient 10019777's last insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s) treatment in 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y',procedures_icd.charttime) = '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.performance_time FROM procedures WHERE procedures.patient_id = 10019777 AND procedures.treatment_type = 'insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)' AND strftime('%Y',procedures.performance_time) = '2100' ORDER BY procedures.performance_time DESC LIMIT 1"
45b3c545de90501570505db8,What was the dose of heparin flush (10 units/ml) that was prescribed since 04/2100 for the last time to patient 10004235?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = 'heparin flush (10 units/ml)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT MAX(prescriptions.starttime) FROM prescriptions WHERE prescriptions.patient = 10004235 AND prescriptions.drug = 'heparin flush (10 units/ml)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'"
32fa88a37c2489a86ba893e5,When did patient 10027445 for the last time leave the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10027445 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT patient.dischtime FROM patient WHERE patient.subject_id = 10027445 ORDER BY patient.dischtime DESC LIMIT 1
7d00004b3e825ffc842ff770,"Among patients who were diagnosed with asthma, unspecified type, unspecified since 1 year ago, what are the top three most frequent diagnoses that followed afterwards in the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asthma, unspecified type, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE diagnoses.diagnosis = 'asthma, unspecified type, unspecified' AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT patient.subject_id, diagnoses.diagnosis, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.diagnosis ) AS T3 WHERE T3.C1 <= 3<"
c1088984666feded19fe629d,Is patient 10020306 male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020306,10020306 is male or female?
c2eca2905474a01bac57fe3d,"In the first ICU visit, what was the first mean blood pressure for patient 10018328?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(diastolic_bp) FROM ( SELECT mean_blood_pressure AS diastolic_bp FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu_ids.icu_id FROM icu_ids WHERE icu_ids.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icu_ids.outtime IS NOT NULL ORDER BY icu_ids.intime ASC LIMIT 1 ) )
b822a4c44ce54f12b21a2ba9,Has any lab test been performed on patient 10015931 in 10/last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'",10015931 has received a lab test in 10/2100.
393404a584eb0bb1b6bbe900,What was the last height reading for patient 10020944 in 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(patient_results.value) FROM ( SELECT patient_results.patient_id, patient_results.value FROM patient_results WHERE patient_results.patient_id = 10020944 AND strftime('%Y-%m',patient_results.last_measurement_time) = '2100-03' AND patient_results.result_type = 'heart rate' ) AS subquery"
3721cde992fe90dd17278b65,How many hours have passed since the patient 10021487 was admitted to the hospital?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', patient.admittime) ) FROM patient WHERE patient.subject_id = 10021487 AND patient.dischtime IS NULL"
634500145917954d7e9ba9c0,What are the five most common treatments for patients aged 20s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.treatment, COUNT( T1.treatment ) FROM ( SELECT T1.treatment FROM ( SELECT diagnoses.treatment_id, diagnoses.age FROM diagnoses WHERE diagnoses.age BETWEEN 20 AND 29 ) AS T1 JOIN ( SELECT procedures.treatment_id, procedures.age FROM procedures WHERE procedures.age BETWEEN 20 AND 29 ) AS T2 ON T1.treatment_id = T2.treatment_id WHERE T1.age >= date_sub('year', CURRENT_TIME, T2.age ) GROUP BY T1.treatment ) AS T3 ORDER BY COUNT( T3.treatment ) DESC LIMIT 5"
70b7e8f278566e9443f31eaf,Has there been any results of the microbiological mrsa screen test for patient 10031757 since 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y',microbiologyevents.charttime) >= '2100'","SELECT COUNT(*)>0 FROM microbiology_test WHERE microbiology_test.patient_id = 10031757 AND microbiology_test.spec_type_desc = 'mrsa screen' AND strftime('%Y',microbiology_test.chart_time) >= '2100'"
927645663d3fd105f686319c,"List the top five most frequent procedures that patients underwent during the same month after being diagnosed with adverse effect of anticoagulants, initial encounter in 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'adverse effect of anticoagulants, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.long_title FROM ( SELECT T2.short_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.long_title = 'adverse effect of anticoagulants, initial encounter' AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.short_title, procedures.charttime FROM procedures JOIN admissions ON procedures.admission_id = admissions.admission_id WHERE strftime('%Y',procedures.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.short_title ) AS T3 WHERE T3."
ed31b107608f8a15bae7aa15,How much is a diagnosis of hypovolemia going to cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypovolemia' ) ),SELECT DISTINCT cost FROM sql_table WHERE question = 'what is the cost of a diagnosis of hypovolemia'
f3b876d4c257e4b4bc897442,Can you fetch me patient 10016810's yearly maximum albumin 25% input since 07/02/2100?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-02' GROUP BY strftime('%Y',inputevents.starttime)","SELECT MAX(diagnoses.values) FROM ( SELECT diagnoses.values FROM diagnoses WHERE diagnoses.patient_id = 10016810 AND strftime('%Y-%m-%d',diagnoses.start_time) >= '2100-07-02' GROUP BY strftime('%Y-%m-%d',diagnoses.start_time) ) AS diagnoses"
ce229386a278fc4dbc3f4f87,What was patient 10021487's last weight since 20 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-20 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MIN(diastolic_bp) FROM ( SELECT * FROM patient_monitor WHERE patient_id = 10021487 AND measurement_time >= ( current_time, '-20 month') )"
c60ed59c6b7df6bf5fbfa0cf,How many hours have passed since the first time patient 10004733 has taken a albumin lab test during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', lab_test.charttime) ) FROM lab_test WHERE lab_test.patient = 10004733 AND lab_test.label = 'albumin' AND lab_test.charttime >= ( SELECT charttime FROM lab_test WHERE lab_test.patient = 10004733 AND lab_test.label = 'albumin' ORDER BY lab_test.charttime ASC LIMIT 1 )"
a75f7d749b9d5901f73d2d35,What's the maximum total hospital charged for a visit with a atypical lymphocytes lab test?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'atypical lymphocytes' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM(T2.C2) AS C1 FROM ( SELECT T1.C1 FROM ( SELECT diagnoses.C1 FROM diagnoses WHERE diagnoses.long_title = 'atypical lymphocytes' ) AS T1 JOIN labevents ON T1.stay_id = labevents.stay_id ) AS T2 ) AS T3
59e57b904fb229550751564d,What is the average daily number of patients who had embolism and thrombosis of other specified artery in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'embolism and thrombosis of other specified artery' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnosis_of_last_attack ) AS C1 FROM patients WHERE diagnosis_of_last_attack = 'embolism and thrombosis of other specified artery' AND strftime('%Y',diagnosis_time) = '2100' GROUP BY strftime('%Y-%m-%d',diagnosis_time) ) AS T1"
472793119170f9c8adb0b84b,Is patient 10021487's diastolic blood pressure ever less than 31.0 since 09/08/2100?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 31.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-08'",SELECT COUNT(*)>0 FROM syst_data WHERE syst_data.syst_time >= '2100-09-08' AND syst_data.syst_time < '2100-09-08' AND syst_data.patient_id = 10021487 AND syst_data.val_diastolic < 31.0
e7d42c3433b73b5b7e9bab9a,"Has patient 10021312 been treated with a destruction of right lower lung lobe, via natural or artificial opening endoscopic since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","10021312 has been treated with destruction of right lower lung lobe, via natural or artificial opening endoscopic in 2100."
234a24d7c0ae3805bd918372,What condition was patient 10008454 diagnosed with the last time on the first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT diagnoses.long_title FROM diagnoses WHERE diagnoses.patient_id = 10008454 AND diagnoses.hospital_order = 1 ORDER BY diagnoses.charttime DESC LIMIT 1
5886a94103455554061fb16a,What was the quantity of glucose gel dose prescribed to patient 10020740 in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'glucose gel' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'","SELECT SUM(prescription.dose_val_rx) FROM prescription WHERE prescription.patient_id = 10020740 AND prescription.drug = 'glucose gel' AND datetime(prescription.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescription.starttime) = '07'"
e19ea171900405ad202eba5f,Retrieve the marital status of patient 10038081 on their first hospital visit.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT marital_status FROM patients WHERE patient_id = 10038081 AND hospital_id = 1 ORDER BY hospital_admission_date ASC LIMIT 1
6df8c8add4bde78a73d76071,When was the first time patient 10009035 received the procedure of extracorporeal circulation auxiliary to open heart surgery in the last hospital visit?,SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.patient_id = 10009035 AND procedures.lasttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND procedures.longtitle = 'extracorporeal circulation auxiliary to open heart surgery' ORDER BY procedures.starttime ASC LIMIT 1
5f65914db7e338f8263f8fa7,When was patient 10001217 prescribed the drug heparin and ondansetron at the same time for the last time in 12/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10001217 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10001217 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT T1.starttime FROM ( SELECT patient.subject_id, prescription_1.starttime FROM prescription_1 JOIN patient ON prescription_1.patient_id = patient.subject_id WHERE prescription_1.drug = 'heparin' AND patient.subject_id = 10001217 AND datetime(prescription_1.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescription_1.starttime) = '12' ) AS T1 JOIN ( SELECT patient.subject_id, prescription_2.starttime FROM prescription_2 JOIN patient ON prescription_2.patient_id = patient.subject_id WHERE prescription_2.drug = 'ondansetron' AND patient.subject_id = 10001217 AND datetime(prescription_2.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescription_2.starttime) = '12' ) AS T2 ON"
a54ef0e3bf3dcba73ecf9d1f,"What are the five commonly prescribed drugs for patients diagnosed with personal history of malignant neoplasm of large intestine previously within 2 months, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.diagnosis_time FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'personal history of malignant neoplasm of large intestine' AND datetime(diagnoses.diagnosis_time) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.start_time FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE datetime(prescriptions.start_time) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis_time < T2.start_time AND datetime(T2.start_time) BETWEEN datetime(T1.diagnosis_"
ddb17df095695ae5f9fbddeb,Tell me the top three most common diagnoses for patients with age 60 or above in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.diagnosis FROM ( SELECT diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM ( SELECT patient_id FROM patients WHERE age >= 60 ) AS T1 JOIN ( SELECT patient_id, diagnosis FROM diagnoses WHERE strftime('%Y',diagnosis_time) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY diagnosis ) AS T1 WHERE T1.C1 <= 3"
16df9ac99e3822d7b993b443,"During this year, what are the top five most frequent lab tests given to patients during the same hospital encounter after pleurisy without mention of effusion or current tuberculosis?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pleurisy without mention of effusion or current tuberculosis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.diagnosis = 'pleurisy without mention of effusion or current tuberculosis' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labtests.test_name, labtests.charttime, admissions.hadm_id FROM labtests JOIN admissions ON labtests.hadm_id = admissions.hadm_id WHERE datetime(labtests.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_"
89105357ecaae9b49a2a1134,How many patients received a closed [endoscopic] biopsy of bronchus after the procedure of arterial catheterization during the same hospital encounter?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject ) FROM ( SELECT T1.subject, T2.chart_time, T1.chart_time AS chart_time_last FROM ( SELECT subject, chart_time FROM procedures WHERE procedures.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'arterial catheterization' ) ) AS T1 JOIN ( SELECT subject, chart_time FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'closed [endoscopic] biopsy of bronchus' ) ) AS T2 ON T1.subject = T2.subject WHERE T1.chart_time < T2.chart_time AND T1.hospital_dischtime IS NULL AND T2.hospital_dischtime IS NULL ) AS T1 JOIN ( SELECT subject, chart_time FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long"
22605cacd4a47bb1b91b1b75,What was the name of the drug that patient 10031757 had been prescribed two times in 11/this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 = 2",1. get the list of drugs for patient 10031757 in 11/this year
a07e014b5e2eb6177b5978a3,"Since 15 months ago, what was the last weight for patient 10011398?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-15 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MIN(patient_info.weight) FROM patient_info WHERE patient_info.patient_id = 10011398 AND datetime(patient_info.measurement_time) >= datetime(current_time,'-15 month')"
e38192db81eb4aedd18e81f8,Calculate the total volume of mediastinal for patient 10005817 on 12/24/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'mediastinal' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-24'",SELECT SUM(outputvolume) FROM ( SELECT 'mediastinal' AS outputvolume FROM medication WHERE patient_id = 10005817 AND starttime >= '2100-12-24 00:00:00' AND starttime < '2100-12-25 00:00:00' ) AS T1
23ecc70fdf2e92d39a932541,What would be the average yearly number of patients diagnosed with methicillin susceptible pneumonia due to staphylococcus aureus?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible pneumonia due to staphylococcus aureus' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT(DISTINCT diagnosis_of_last_month) AS C1 FROM patients WHERE diagnosis_of_last_month = 'methicillin susceptible pneumonia due to staphylococcus aureus' GROUP BY strftime('%Y',diagnosis_date) ) AS T1"
58f40bf6ff1c20a773a056ae,"Among the patients who were prescribed fentanyl citrate, what are the five most frequently prescribed drugs at the same time in this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'fentanyl citrate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM prescriptions WHERE drug = 'fentanyl citrate' ) AS T1 JOIN ( SELECT subject_id, prescriptions.drug FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
905bf1d8d8b2ee5cc48396ca,"Has the prescription of sodium chloride 0.9%, nicardipine iv, or ondansetron been given to patient 10039997 in 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND prescriptions.drug IN ( 'sodium chloride 0.9%', 'nicardipine iv', 'ondansetron' ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.patient_id = 10039997 AND prescriptions.drug IN ('sodium chloride 0.9%', 'nicardipine iv', 'ondansetron') AND strftime('%Y',prescriptions.starttime) = '2100'"
86741d2d640a5dbbfa5d1036,Can you tell me the last thyroid stimulating hormone value of patient 10010471 in 05/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroid stimulating hormone' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '05' ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(diagnoses.values) FROM diagnoses WHERE diagnoses.patient_id = 10010471 AND diagnoses.label = 'thyroid stimulating hormone' AND datetime(diagnoses.diagnosis_time,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',diagnoses.diagnosis_time) = '05'"
9aab7dbbef98a04db8de27da,"How much does the calcium, total lab test typically cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) )","SELECT DISTINCT cost FROM lab_tests WHERE lab_tests.test_name = 'calcium, total'"
be39c5b68e4b0a9b3ed9659c,What age was patient 10013049 during their first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,"SELECT strftime('%Y', patient.admittime) - strftime('%Y', patient.dob) FROM patient WHERE patient.subject_id = 10013049 AND patient.dischtime IS NULL ORDER BY patient.admittime ASC LIMIT 1"
7b95ae7410b397d1e2505afb,"Since 2100, what are the top four most commonly taken specimens for patients in the same hospital encounter after the diagnosis of personal history of malignant neoplasm of other gastrointestinal tract?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of other gastrointestinal tract' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.chart_time, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis_desc = 'personal history of malignant neoplasm of other gastrointestinal tract' AND strftime('%Y',diagnoses.chart_time) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, spec_types.spec_type_desc, spec_types.spec_type_code, admissions.admission_id FROM spec_types JOIN admissions ON spec_types.admission_id = admissions.admission_id WHERE strftime('%Y',spec_types.chart_time) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.chart_time < T"
470efb33e7b9dd7a698151cf,How many patients stayed in the discharge lounge as a transfer care unit this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'discharge lounge' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patient_id ) FROM transfers WHERE transfer_care_unit = 'discharge lounge' AND datetime(transfer_time,'start of year') = datetime(current_time,'start of year','-0 year')"
45b34eeae5d3c8d44b703194,How much docusate sodium (liquid) dose has been prescribed to patient 10007818 on the first hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'docusate sodium (liquid)',SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'docusate sodium (liquid)'
8a2c412e28bd7e4d00a2c261,What number of hours have passed since patient 10021487 first received a ntprobnp lab test during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ntprobnp' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', lab.charttime) ) FROM lab WHERE lab.patient = 10021487 AND lab.label = 'ntprobnp' AND lab.charttime = ( SELECT lab2.charttime FROM lab AS lab2 WHERE lab2.patient = 10021487 AND lab2.label = 'ntprobnp' ORDER BY lab2.charttime DESC LIMIT 1 )"
679e9fb3a5f25dcf1ce8aa3c,Could you show me the top four most frequent outputs?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.output FROM ( SELECT output, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM ( SELECT output FROM procedures WHERE output IS NOT NULL ) AS T1 JOIN ( SELECT output FROM diagnoses WHERE output IS NOT NULL ) AS T2 ON T1.output = T2.output ) AS T3 WHERE T3.C1 <= 4"
8d027ecd151d527ed8671fee,What are the four most frequently conducted lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )",1. What are the four most frequently conducted lab tests in 2100?
376ce2f69b8cda44c3960e60,What are the three most commonly administered lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.test_name FROM ( SELECT lab_tests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM lab_tests GROUP BY lab_tests.test_name ) AS T1 WHERE T1.C1 <= 3"
8706d212667c3018e03000a7,Is the value of mean blood pressure of patient 10031757 second measured on the first ICU visit greater than it is first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT mean_blood_pressure FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu_id FROM icu_history WHERE icu_history.patient_id = 10031757 AND icu_history.outtime IS NOT NULL ORDER BY icu_history.intime ASC LIMIT 1 ) AND icu_visits.intime = ( SELECT icu_visits.intime FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu_id FROM icu_history WHERE icu_history.patient_id = 10031757 AND icu_history.outtime IS NOT NULL ORDER BY icu_history.intime ASC LIMIT 1 ) AND icu_visits.intime > ( SELECT icu_visits.intime FROM icu_visits WHERE icu_visits.icu_id IN ( SELECT icu_id FROM icu_history WHERE icu_history.patient_id = 10031757 AND icu_history.outtime IS
e2e9e3d582524db3f2e7d55a,Tell me the name of the drug that was first prescribed to patient 10005817 during the last hospital visit via nu route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'nu' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10005817 AND prescriptions.route = 'nu' ORDER BY prescriptions.starttime DESC LIMIT 1
73a44b74d4ae03e85322ee51,What does fusion or refusion of 2-3 vertebrae cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fusion or refusion of 2-3 vertebrae' ) ),SELECT DISTINCT cost FROM procedures WHERE procedures.name = 'fusion or refusion of 2-3 vertebrae'
44ba2f356939ab27e43cbc9a,When was patient 10000032 first given a creatinine test in 05/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.charttime ASC LIMIT 1","SELECT MIN(assignment_time) FROM ( SELECT patient_10000032, microbiology_test_time as assignment_time FROM microbiology_test WHERE patient_10000032 = 10000032 AND microbiology_test_type = 'creatinine' )"
c731547cf5d2fc4a71b9d129,How many days ago was the last time patient 10018081 was diagnosed with other and unspecified hyperlipidemia in their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnosis.diagnosis_time) ) FROM diagnosis WHERE diagnosis.patient_id = 10018081 AND diagnosis.diagnosis = 'other and unspecified hyperlipidemia' AND diagnosis.dischtime IS NULL"
8777f5505af432365af01179,What is patient 10029291's difference in weight from the second value measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT diagnoses.weight FROM diagnoses WHERE diagnoses.patient_id = 10029291 AND diagnoses.encounter_id = 1 ) - ( SELECT diagnoses.weight FROM diagnoses WHERE diagnoses.patient_id = 10029291 AND diagnoses.encounter_id = 1 ORDER BY diagnoses.charttime ASC LIMIT 1 )
1eff45de74ada2d6145da372,Has any laboratory test been performed on patient 10004733 this month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')","SELECT COUNT(*)>0 FROM lab_test WHERE lab_test.patient_id = 10004733 AND datetime(lab_test.charttime,'start of month') = datetime(current_time,'start of month','-0 month')"
d0be97adb482380a1a57585d,How many times patient 10027602 have a foley output recorded on 12/05/this year?,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-05'","SELECT COUNT(*) FROM outputevents WHERE outputevents.patient = 10027602 AND outputevents.output_type = 'foley' AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-05'"
8e98cbdccd57c7ac55a6c6a1,How many patients received albuterol inhaler in the same month after the confirmation of toxic encephalopathy?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'toxic encephalopathy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'albuterol inhaler' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month')","SELECT COUNT( DISTINCT T1.subject ) FROM ( SELECT T1.subject, T2.charttime FROM ( SELECT subject, charttime FROM procedures WHERE procedure = 'confirmation of toxic encephalopathy' ) AS T1 JOIN ( SELECT subject, prescriptions.starttime FROM prescriptions WHERE prescriptions.drug = 'albuterol inhaler' ) AS T2 ON T1.subject = T2.subject WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') ) AS T1"
3e69022ac78531ddbbfd8b99,"Has patient 10016742 had any introduction of nutritional substance into lower gi, via natural or artificial opening treatment since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*)>0 FROM treatment WHERE treatment.patient_id = 10016742 AND treatment.treatment_type = 'introduction of nutritional substance into lower gi, via natural or artificial opening' AND strftime('%Y',treatment.starttime) >= '2100'"
0bc89b236b722c5eb64dffa8,"What is the maximum total hospital cost, which includes the procedure named insertion of catheter into spinal canal for infusion of therapeutic or palliative substances?",SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.event_type = 'procedure' AND cost.event_id IN ( SELECT procedure.event_id FROM procedure WHERE procedure.long_title = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' ) GROUP BY cost.event_id ) AS T1
5d95e49bfd6d7191297dda3e,How many patients with ventricular tachycardia were there?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'ventricular tachycardia' ) ),SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE diagnosis_long_text LIKE '%ventricular tachycardia%'
ffbb740b9da08e9805048c7f,What was patient 10014729's insurance plan on the last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,"SELECT patient_10014729.insurance_plan FROM ( SELECT patient_10014729.id, patient_10014729.age, patient_10014729.gender, patient_10014729.marital_status, patient_10014729.insurance_plan FROM patient_10014729 WHERE patient_10014729.dischtime IS NOT NULL ORDER BY patient_10014729.admittime DESC LIMIT 1 )"
137af49a158f5739eb59024e,What is the 3-month survival probability for patients living with a asymptomatic human immunodeficiency virus [hiv] infection status diagnosis?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asymptomatic human immunodeficiency virus [hiv] infection status' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )",3-month survival probability for patients living with a asymptomatic human immunodeficiency virus [hiv] infection status diagnosis
3508fba9387d18248281be4e,Was patient 10014078 diagnosed with a disease during their last hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),10014078 in their last hospital visit was diagnosed with what?
b1b111763ce05423f194b8d8,"What is the minimum total cost of a hospital that runs total protein, urine laboratory tests since 1 year ago?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, urine' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(T2.C2) AS C1 FROM ( SELECT T1.C1 FROM ( SELECT diagnoses.C1 FROM diagnoses WHERE diagnoses.C1 = 'other specified procedures' ) AS T1 JOIN labevents ON T1.stay_id = labevents.stay_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') AND labevents.label = 'total protein, urine' ) AS T2 GROUP BY T1.stay_id ) AS T1;"
3c063dda3762046fb6f125fe,Get me the top four most frequently tested specimens that patients took in the same month after being diagnosed with pleural effusion in other conditions classified elsewhere.,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pleural effusion in other conditions classified elsewhere' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT T3.spec_type_desc, T2.C1 FROM ( SELECT T1.diagnosis_code, T1.month FROM ( SELECT diagnosis_code, month FROM diagnoses WHERE diagnosis_code = 'pleural effusion in other conditions classified elsewhere' ) AS T1 GROUP BY diagnosis_code ) AS T2 JOIN ( SELECT spec_type_code, C1 FROM specimens WHERE spec_type_code = 'other blood' ) AS T3 ON T2.spec_type_desc = T3.spec_type_desc GROUP BY T3.spec_type_desc ORDER BY T2.C1 DESC LIMIT 4"
f970e95c531ff8f40c37fadc,How many patients in 2100 received coronary arteriography using two catheters after the single internal mammary-coronary artery bypass procedure within the same hospital visit?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject ) FROM ( SELECT subject, hadm_id, wardid, stay_id FROM ( SELECT subject, hadm_id, wardid, stay_id, (SELECT MIN(starttime) FROM ( SELECT starttime, hadm_id, wardid, stay_id, ( SELECT value, hadm_id, wardid, stay_id, ( SELECT spec_type, hadm_id, wardid, stay_id, ( SELECT value, hadm_id, wardid, stay_id, ( SELECT value, hadm_id, wardid, stay_id, ( SELECT value, hadm_id, wardid, stay_id, ( SELECT value, hadm_id, wardid, stay_id, ( SELECT value, hadm_id, wardid, stay_id, ( SELECT value, hadm_id, wardid, stay_id, ( SELECT value, hadm_id, wardid, stay_id, ( SELECT value, hadm_id, wardid, stay_id, ( SELECT value, hadm_id, ward"
76a3b26583f61cc00377b6a2,Count the medications that patient 10004720 was prescribed since 04/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'","SELECT COUNT(*) FROM medications WHERE medications.patient_id = 10004720 AND strftime('%Y-%m', medications.start_time) >= '2100-04'"
ef5e50d5ccd02aaa3b7e4873,What percentile is a magnesium value of 2.0 among patients of the same age as patient 10037975 on their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.0","SELECT DISTINCT T1.C1 FROM ( SELECT lab.C1, PERCENT_RANK() OVER ( ORDER BY lab.C1 ASC ) AS C2 FROM lab WHERE lab.P1 = ( SELECT P1 FROM lab WHERE lab.C1 = ( SELECT C1 FROM lab WHERE lab.P1 = 10037975 AND lab.S = 1 ORDER BY lab.C1 ASC LIMIT 1 ) ) ) AS T1 WHERE T1.C2 <= 0.5"
dbe56779e1a5f940e7fde7f8,Keep count of how many times patient 10020944 outputted oral gastric on 03/12/this year.,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'oral gastric' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-12'","SELECT COUNT(*) FROM ( SELECT * FROM patients WHERE patients.id = 10020944 ) WHERE patients.output_type = 'oral gastric' AND datetime(patients.output_time,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',patients.output_time) = '03-12'"
debd4fb35717b39a57ee2bec,Tell me the diagnosis cost of unspecified essential hypertension in a patient?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) ),SELECT DISTINCT cost FROM diagnoses WHERE diagnosis = 'unspecified essential hypertension'
16b479cf35ef4b2c6a5488a1,What is the total amount of kcl (bolus) input that patient 10020187 got since 02/02/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-02'","SELECT SUM(input_events.totalamount) FROM input_events WHERE input_events.patientid = 10020187 AND input_events.inputtype = 'kcl (bolus)' AND strftime('%Y-%m-%d',input_events.starttime) >= '2100-02-02'"
ef2b6d1260dfe06ef2737e79,What is the 3-month survival rate for patients diagnosed with history of falling?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'history of falling' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )",3-month survival rate for patients diagnosed with history of falling?
78e5fca5ff0661c021019cac,What medication was patient 10009049 prescribed two times since 05/2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 = 2","SELECT T1.drug FROM ( SELECT prescription.drug, count(prescription.starttime) AS c1 FROM prescription WHERE prescription.patient = 10009049 AND strftime('%Y-%m',prescription.starttime) >= '2100-05' GROUP BY prescription.drug ) AS T1 WHERE T1.c1 = 2"
aacbdaf47632d34594693d85,What was the name of the drug patient 10037861 was given within the same day after receiving right heart cardiac catheterization since 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')",1.Fetch the last dose of insulin (regular) for patient 10037861 on the first hospital visit.
1cbdcc09109e4edff4bdc980,What are the top three most commonly prescribed medicines in this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM medication AS T1 JOIN prescription AS T2 ON T1.code = T2.drug_code WHERE datetime(T2.prescription_time,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY T1.drug ) AS T1 WHERE T1.C1 <= 3"
78b96d788febbe223bbeb490,What are the five commonly ordered medications for patients aged 50s?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions INNER JOIN patients ON prescriptions.patient_id = patients.patient_id WHERE patients.age BETWEEN 50 AND 59 GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5"
2143a6938a83abd7a5830ec5,When was the first time patient 10006580 had a maximum of platelet count on the first hospital stay?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1",SELECT lab.charttime FROM lab WHERE lab.patient = 10006580 AND lab.spec = 'platelet count' AND lab.valuenum = ( SELECT MAX(lab2.valuenum) FROM lab AS lab2 WHERE lab2.patient = lab.patient AND lab2.charttime >= lab.charttime ) ORDER BY lab.charttime ASC LIMIT 1
224bb4d0211cbc31df5ac6e5,"Count the number of patients who had their closed reduction of fracture with internal fixation, femur performed.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed reduction of fracture with internal fixation, femur' ) )","SELECT COUNT( DISTINCT patient_id ) FROM procedures WHERE procedure_name = 'closed reduction of fracture with internal fixation, femur'"
13cdf52f7ef4abd4ac2134e8,Retrieve the top three most frequently prescribed drugs throughout this year.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3"
0b519b394a591392e5d6f8e3,"Today, when was the first time that patient 10018081 had the minimum SaO2?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1",SELECT MIN(SaO2) FROM ( SELECT SaO2 FROM procedures WHERE patient_id = 10018081 )
864335edd9d15c7c2203cf7f,What was patient 10020740's age on the first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.age FROM patients WHERE patient.subject_id = 10020740 AND patient.dischtime IS NOT NULL ORDER BY patient.admittime ASC LIMIT 1
52132e5911d6dc1ae05dcf5a,When was the first continuous invasive mechanical ventilation for less than 96 consecutive hours done for patient 10027445 since 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime ASC LIMIT 1",SELECT procedures.starttime FROM procedures WHERE procedures.patient_id = 10027445 AND procedures.starttime >= '2100-01-01 00:00:00' AND procedures.duration < 96 AND procedures.type = 'continuous invasive mechanical ventilation'
230ffeaf99bdda6a8e74e380,What was the average mean blood pressure on 03/07/this year for patient 10014729?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '03-07'","SELECT AVG(mean_blood_pressure) FROM medical_database.patients WHERE patient_id = 10014729 AND datetime(current_time,'start of year') = datetime(current_time,'start of year', '-0 year') AND strftime('%m-%d',current_time) = '03-07'"
da43f657cbfc7f62319205b6,How many current patients belong to the 40s age category?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,SELECT COUNT( DISTINCT patient_id ) FROM patients WHERE age BETWEEN 40 AND 49
290c69f642635c781b5c7611,"For patients who were given other endovascular procedures on other vessels in 2100, what are the top four most frequent procedures that followed within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT T3.long_title FROM ( SELECT T2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.time_since_first_diagnosis FROM ( SELECT T1.subject_id, T1.time_since_first_diagnosis FROM diagnoses WHERE T1.long_title = 'other endovascular procedures on other vessels' ) AS T1 JOIN ( SELECT T2.subject_id, T2.time_since_first_diagnosis FROM diagnoses AS T2 JOIN ( SELECT T1.subject_id, T1.time_since_first_diagnosis FROM diagnoses AS T1 GROUP BY T1.subject_id HAVING MIN(T1.time_since_first_diagnosis) = T1.time_since_first_diagnosis ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.time_since_first_diagnosis < T2.time_since_first_diagnosis AND datetime(T1.time_since"
44b322551dc60863f32aa258,What was the last procedure patient 10019385 had since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1 )",SELECT T1.name FROM procedures AS T1 JOIN ( SELECT procedures_id FROM ( SELECT procedures_id FROM patient_procedures WHERE patient_id = 10019385 ) AS T2 GROUP BY procedures_id HAVING MIN(starttime) >= '2100-01-01 00:00:00' ) AS T3 ON T1.procedures_id = T3.procedures_id
e19b3138fb3b80c47b5d5688,Has patient 10022041 been admitted to an emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room',10022041 has been admitted to an emergency room in 2100.
7eab95f496de2df04e1d2b80,Could you show me the top four most common diagnoses?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.diagnosis FROM ( SELECT diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) as C1 FROM diagnoses GROUP BY diagnosis ) as T1 WHERE T1.C1 <= 4"
7a4a371e40e613a250b099d0,How much total input did patient 10021487 receive on 12/19/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-19'",SELECT SUM(input_amount) FROM input_events WHERE patient_id = 10021487 AND input_time >= '2100-12-19 00:00:00' AND input_time < '2100-12-19 00:00:00'
a2de199eb11275f923c798c8,Can you tell me the first medicine that was prescribed to patient 10007795?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10007795 ORDER BY prescriptions.start_time ASC LIMIT 1
7eeda0d4bfae5ffe07de0b9b,How many hours has it been since the first time patient 10018081 stayed in the careunit emergency department on the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.careunit = 'emergency department' AND transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject = 10018081 AND admissions.dischtime IS NULL ) ORDER BY transfers.intime ASC LIMIT 1"
785297f1fb8d773e4c4a07e2,Could you tell me the marital status of patient 10012853 on their first hospital visit?,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT marital_status FROM patients WHERE patient_id = 10012853 AND hospital_id = 1 ORDER BY hospital_admission_date ASC LIMIT 1
d8eb075e768231338b08ef56,Has patient 10027445 had any results of his or her mrsa screen microbiology tests in 09/this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '09'","SELECT COUNT(*)>0 FROM microbiology_results WHERE microbiology_results.patient_id = 10027445 AND microbiology_results.spec_type_desc = 'mrsa screen' AND datetime(microbiology_results.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiology_results.charttime) = '09'"
3f83bca7c25ce27ab09a7ef0,What is the difference between weights on patient 10003046 last measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),"SELECT ( SELECT values[1] FROM ( SELECT * FROM ( SELECT patient_id, measurements.value FROM measurements WHERE measurements.patient_id = 10003046 AND measurements.time_type = 'weight' AND measurements.time_start::TIMESTAMP WITH TIME ZONE AT TIME ZONE 'UTC' ORDER BY measurements.time_start DESC LIMIT 1 ) ) AS value_first JOIN ( SELECT * FROM ( SELECT patient_id, measurements.value FROM measurements WHERE measurements.patient_id = 10003046 AND measurements.time_type = 'weight' AND measurements.time_start::TIMESTAMP WITH TIME ZONE AT TIME ZONE 'UTC' ORDER BY measurements.time_start DESC LIMIT 1 ) ) AS value_last ON value_first.patient_id = value_last.patient_id WHERE value_first.time_start = value_last.time_start"
666e67f82411b8a3b4b429e7,Has patient 10005909 been to the e.r. in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(*)>0 FROM transfers WHERE transfers.patient_id = 10005909 AND transfers.careunit = 'emergency room' AND strftime('%Y',transfers.intime) = '2100'"
6336898e3861f505fd6e2a25,How many days have there been since patient 10039831's admission to the hospital?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', patient.admittime) ) FROM patient WHERE patient.subject_id = 10039831 AND patient.dischtime IS NULL"
3de8ef9d5ffcc52173897ea8,What was the first recorded height for patient 10020740 during their first hospital encounter?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT MIN(patient_height) FROM ( SELECT patient_height FROM patients WHERE patient_id = 10020740 AND hospital_id = 1 )
e6fc873eaca2527956432aa0,How many people were admitted to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT( DISTINCT patient_id ) FROM hospital_admissions WHERE strftime('%Y',admission_date) >= '2100'"
fb17ccd962fb6994c5822d11,How many tamoxifen citrate prescriptions were ordered in this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')"
0a6429bfa48cdb76d66bf9a6,How many days has it been since patient 10021487's hospital admission?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', patient.admittime) ) FROM patient WHERE patient.subject_id = 10021487 AND patient.dischtime IS NULL"
15b35d75bfa2fee08c48a6c6,When was the first time since 114 days ago that patient 10011398 had the maximum respiratory rate for?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-114 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT strftime('%Y-%m-%d %H:%M:%S', resp_rate_max.first_time) as first_time
         FROM (
             SELECT resp_rate_min.first_time
             FROM (
                 SELECT d_icd_procedures.match_time as first_time
                 FROM d_icd_procedures
                 WHERE d_icd_procedures.icd_code = (
                     SELECT d_icd_diagnoses.icd_code
                     FROM d_icd_diagnoses
                     WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension'
                 )
                 GROUP BY d_icd_procedures.match_time
                 HAVING MIN(d_icd_procedures.match_time) = d_icd_procedures.match_time
             ) as resp_rate_min
             WHERE resp_rate_min.last_time >= (
                 SELECT d_icd_diagnoses.match_time
                 FROM d_icd_diagn"
01f7d958c0c0cf070ca363b1,Can you list the methods for taking morphine sulfate ir?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate ir',SELECT DISTINCT prescription_method FROM prescriptions WHERE prescription_drug = 'morphine sulfate ir'
a0cc19360d682b011b5a7c9e,What is the total hospital cost for patient 10021118's stay since 2100?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y',cost.chargetime) >= '2100'","SELECT SUM(cost) FROM ( SELECT cost FROM ( SELECT diagnosis_cost FROM diagnosis WHERE diagnosis.code = ( SELECT diagnosis_code FROM diagnosis_lookup WHERE diagnosis_lookup.long_title = 'other and unspecified hypercholesterolemia' ) ) AS T1 JOIN ( SELECT procedure_cost FROM procedure WHERE procedure.code = ( SELECT procedure_code FROM procedure_lookup WHERE procedure_lookup.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) ) AS T2 ON T1.diagnosis_code = T2.diagnosis_code WHERE T1.patient_id = 10021118 AND strftime('%Y',diagnosis_time) >= '2100' ) AS T3"
ec24c1254363c0ed83ac0fa9,How much does the cost of a other and unspecified escherichia coli [e. coli] diagnosis cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified escherichia coli [e. coli]' ) ),SELECT DISTINCT cost FROM sql_queries WHERE query_name = 'other and unspecified escherichia coli [e. coli]'
6968bd319470944ced5ca337,What is the cost of a medication named ibuprofen?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ibuprofen' ),SELECT DISTINCT cost FROM medications WHERE name = 'ibuprofen'
d1d8f2df3141cf92ddc53228,How many prednisone prescription cases were there in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prednisone' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prednisone' AND strftime('%Y',prescriptions.starttime) = '2100'"
6ac4cfa978f125a71ca0e9b0,How much phenazopyridine was last prescribed since 10/2100 to patient 10005909?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND prescriptions.drug = 'phenazopyridine' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.dose FROM prescriptions WHERE prescriptions.patient_id = 10005909 AND prescriptions.drug = 'phenazopyridine' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1"
1d433e5813c63b26ef517551,What was the last glucose lab test result for patient 10022880 in 03/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1","SELECT MAX(lab_test.value) FROM lab_test WHERE lab_test.patient_id = 10022880 AND lab_test.label = 'glucose' AND strftime('%Y-%m',lab_test.charttime) = '2100-03'"
54b62111b52beeb031b293c2,What new medicines were prescribed to patient 10018081 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT T1.drug FROM ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10018081 AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') ) AS T1 JOIN ( SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.patient_id = 10018081 AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day') ) AS T2 ON T1.drug = T2.drug WHERE T1.starttime < T2.starttime"
bd928ffb40c6b3f69d82f2da,What was the last height record for patient 10019777 since 01/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT MAX(patient_records.valuenum) FROM ( SELECT patient_records.valuenum FROM patient_records WHERE patient_records.patient_id = 10019777 AND strftime('%Y-%m',patient_records.record_time) >= '2100-01' AND strftime('%Y-%m',patient_records.record_time) NOT >= '2100-02' ) AS filtered_records"
e208ae3d19686c1132fb4168,How many patients died during the same hospital encounter after having been diagnosed in 2100 with varices of other sites?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'varices of other sites' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND strftime('%Y',T1.charttime) = '2100' ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND strftime('%Y',patients.dod) = '2100' ) as T3 ON T2.subject_id = T3.subject_id WHERE T2.hadm_id = T3.hadm_id","SELECT COUNT( DISTINCT T2.subject ) FROM ( SELECT T1.subject, T1.diagnosis_time, T1.hadm_id FROM ( SELECT T1.subject, T1.diagnosis_time, T1.hadm_id FROM diagnoses AS T1 JOIN patients AS T2 ON T1.subject = T2.subject WHERE T1.diagnosis = 'varices of other sites' ) AS T1 GROUP BY T1.subject HAVING MIN(T1.diagnosis_time) = T1.diagnosis_time AND strftime('%Y',T1.diagnosis_time) = '2100' ) AS T2 JOIN ( SELECT subject, hadm_id, diagnosis_time FROM diagnoses WHERE diagnosis = 'discharge from hospital' ) AS T3 ON T2.subject = T3.subject AND T2.hadm_id = T3.hadm_id WHERE T2.diagnosis_time < T3.diagnosis_time AND strftime('%Y',T3.diagnosis_time) = '210"
21fd9dd9363c6aebcc42bdb9,What was the last output that patient 10021487 has had on 12/10/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-10' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT strftime(output.charttime, '%H:%M:%S') as timestamptz FROM outputs WHERE output.patient = 10021487 AND datetime(output.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime(output.charttime,'%m-%d') = '12-10' ORDER BY output.charttime DESC LIMIT 1"
df207c83b6a4bbaeca1edcf9,What were the top five most common diagnoses that followed within the same month to patients who had received extracorporeal circulation auxiliary to open heart surgery in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.diagnosis FROM ( SELECT T2.diagnosis, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.subject_id, procedures.charttime FROM procedures JOIN patient ON procedures.patient_id = patient.subject_id WHERE procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' AND strftime('%Y',procedures.charttime) = '2100' ) AS T1 JOIN ( SELECT patient.subject_id, diagnoses.diagnosis, diagnoses.charttime FROM diagnoses JOIN patient ON diagnoses.patient_id = patient.subject_id WHERE strftime('%Y',diagnoses.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.diagnosis ) AS T3 WHERE T3.C1 <= 5<"
14d8196b90cb8b401ebd3a91,How long has it been in hours since the first time calcium carbonate was prescribed to patient 10021487 during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'calcium carbonate' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescription.starttime) ) FROM prescription WHERE prescription.drug = 'calcium carbonate' AND prescription.patient = 10021487 AND prescription.starttime >= ( SELECT MIN(starttime) FROM prescription WHERE prescription.patient = 10021487 AND prescription.drug = 'calcium carbonate' )"
ebd6cc5909117f9e521d66c9,What was the first time patient 10018423 had their maximum respiratory rate during their last ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT strftime('%Y-%m-%d %H:%M:%S', icu.outtime) FROM icu WHERE icu.patient_id = 10018423 AND icu.outtime IS NOT NULL ORDER BY icu.respiratory_rate DESC, icu.intime ASC LIMIT 1"
fae84ce9cc96b0e677f844f8,"Since 128 days ago, what was the maximum body temperature for patient 10021118?","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-128 day')",SELECT MAX(T1.C1) FROM ( SELECT * FROM medical_data WHERE T1.patient_id = 10021118 AND T1.measurement_type = 'temperature' AND T1.start_time >= ( CURRENT_TIMESTAMP - INTERVAL '128 day' ) ) AS T1
49a4cd3cf6fcacac9a3bf922,When was the last time patient 10025612 was measured with a greater diastolic blood pressure than 59.0 since 02/02/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 59.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-02-02' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT strftime('%Y-%m-%d', measurement_time) as measurement_time
         FROM blood_pressure
         WHERE patient_id = 10025612
         AND diastolic_bp > 59.0
         AND strftime('%Y-%m-%d', measurement_time) >= '2100-02-02'
         ORDER BY measurement_time DESC
         LIMIT 1"
88c772d92cd993b8ce3eb5a9,What was the name of the medication that patient 10004235 was prescribed two or more times?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T1.drug FROM ( SELECT prescription.drug, COUNT(prescription.start_time) AS c1 FROM prescription WHERE prescription.patient_id = 10004235 GROUP BY prescription.drug ) AS T1 WHERE T1.c1 >= 2"
64d6d6763577abb3e33ea4f0,Tell me the minimum total hospital cost for patient visits that include malignant neoplasm of intrahepatic bile ducts?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of intrahepatic bile ducts' ) ) GROUP BY cost.hadm_id ) AS T1,"SELECT MIN(T1.C1) FROM ( SELECT SUM(T2.C2) AS C1 FROM ( SELECT T1.ROW_NUMBER, T1.CODE, T1.CATEGORY, T2.C2 FROM ( SELECT T1.ROW_NUMBER, T1.CODE, T1.CATEGORY FROM diagnoses ) AS T1 JOIN ( SELECT CODE, CATEGORY, C2 FROM cost_table ) AS T2 ON T1.CODE = T2.CODE ) AS T1 GROUP BY T1.ROW_NUMBER ) AS T2 JOIN ( SELECT CODE, CATEGORY, C2 FROM cost_table ) AS T3 ON T2.CODE = T3.CODE WHERE T2.CATEGORY = 'malignant neoplasm of intrahepatic bile ducts' ) AS T4 ON T4.ROW_NUMBER = T2.ROW_NUMBER"
174eb164f7575dec3a790c67,"In 2100, what are the four frequently ordered medications for patients in their 40s?","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT T1.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient.age FROM patient WHERE patient.age BETWEEN 40 AND 49 ) AS T1 JOIN prescriptions ON T1.prescription_id = prescriptions.prescription_id WHERE T1.age BETWEEN 40 AND 49 AND strftime('%Y',prescriptions.starttime) = '2100' GROUP BY T1.drug ) AS T1 WHERE T1.C1 <= 4"
6375d8b399f74f248505155f,Count the number of times patient 10021487 in the current hospital encounter underwent the thoracentesis procedure.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracentesis' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ),SELECT COUNT(*) FROM procedures WHERE procedures.patient_id = 10021487 AND procedures.procedure_name = 'thoracentesis' AND procedures.start_time >= ( SELECT current_time FROM transfers WHERE transfers.patient_id = 10021487 AND transfers.careunit = 'emergency department' )
af561948138efd557fdd722d,Give a list of the four most frequent medications that patients were prescribed during the same hospital encounter after being diagnosed with personal history of colonic polyps since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of colonic polyps' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.admission_id FROM diagnoses JOIN admissions ON diagnoses.admission_id = admissions.admission_id WHERE diagnoses.diagnosis = 'personal history of colonic polyps' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.admission_id FROM prescriptions JOIN admissions ON prescriptions.admission_id = admissions.admission_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.admission_id = T2.admission_id GROUP BY T2.drug ) AS"
17cef57ccf7e9bd3a4e8882c,What label corresponds to motor current (ma) low (r)?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'motor current (ma) low (r)',"SELECT DISTINCT label FROM sql_queries WHERE query = 'SELECT * FROM procedures WHERE procedure_name = ""motor current (ma) low (r)""</s>"
06b6dc7feba30e1bda1c5617,Could you retrieve patient 10005909's monthly average weight since 09/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-09' GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT AVG(T1.weight) FROM ( SELECT weight FROM patients WHERE patient_id = 10005909 AND strftime('%Y-%m',inputtime) >= '2100-09' GROUP BY strftime('%Y-%m-%d',inputtime) ) AS T1"
dc96f1034667710951f67126,Count the number of patients diagnosed with acute pyelonephritis in the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute pyelonephritis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )",SELECT COUNT( DISTINCT patient_id ) FROM diagnoses WHERE diagnosis = 'acute pyelonephritis' AND year(diagnosis_date) = year( current_date ) - 1
fbbb58618f0b12172d3a2c3f,How much is the difference of weights of patient 10004720 last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"SELECT ( SELECT values FROM ( SELECT * FROM ( SELECT patient_id, weight_kg FROM patients WHERE patient_id = 10004720 AND hospital_id = 1 ORDER BY hospital_id ASC LIMIT 1 ) AS T1 JOIN ( SELECT patient_id, measurement_time, weight_kg FROM measurements WHERE patient_id = 10004720 AND hospital_id = 1 ORDER BY hospital_id ASC LIMIT 1 ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.hospital_id <> T2.hospital_id ) AS T3 ORDER BY measurement_time DESC LIMIT 1 ) - ( SELECT values FROM ( SELECT * FROM ( SELECT patient_id, weight_kg FROM patients WHERE patient_id = 10004720 AND hospital_id = 1 ORDER BY hospital_id ASC LIMIT 1 ) AS T1 JOIN ( SELECT patient_id, measurement_time, weight_kg FROM measurements WHERE patient_id = 10004720 AND hospital_id = 1 ORDER BY hospital_id ASC LIMIT 1 ) AS T2 ON T"
9c072625e88dff652ffe5371,Count the number of times that patient 10038933 took dextrose 5% on 09/26/2100.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-09-26'",SELECT COUNT(*) FROM inputevents WHERE inputevents.patient_id = 10038933 AND inputevents.starttime >= '2100-09-26 00:00:00' AND inputevents.starttime < '2100-09-26 00:00:00' AND inputevents.data = 'dextrose 5%'
5436413908d5e902536630e8,What was the name of the specimen test that patient 10018845 was given for the last time in 10/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT spec_type_desc FROM ( SELECT * FROM microbiology_events WHERE microbiology_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m',microbiology_events.charttime) = '2100-10' ORDER BY microbiology_events.charttime DESC LIMIT 1 )"
554ae2ae8045e12bdcbd48e1,What age was patient 10020740 on the first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT patient.age FROM patients WHERE patient.subject_id = 10020740 AND patient.dischtime IS NOT NULL ORDER BY patient.admittime ASC LIMIT 1
d204e30ef557cf80cbde97fe,List the top five most frequent procedures performed during this year.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.long_title FROM procedures AS T1 JOIN ( SELECT T2.procedure_id FROM ( SELECT procedure_id, COUNT(patient_id) AS C1 FROM procedures AS T2 JOIN patients AS T3 ON T2.patient_id = T3.patient_id WHERE datetime(T2.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedure_id ) AS T2 WHERE C1 > 20 ) AS T3 ON T1.procedure_id = T2.procedure_id"
c8c043eb89e83c83b6beeeb3,Can you calculate the duration in days of patient 10031757's first stay in the intensive care unit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT strftime('%J', icu.outtime) - strftime('%J', icu.intime) FROM icu WHERE icu.hadm_id IN ( SELECT hadm_id FROM hadm_table WHERE subject_id = 10031757 ) AND icu.outtime IS NOT NULL ORDER BY icu.intime ASC LIMIT 1"
a6fe0c3e866e450e5a3bcaf0,Can you find the five most frequently ordered laboratory test this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures AS T1 JOIN labevents AS T2 ON T1.event_id = T2.event_id WHERE T1.starttime >= '2100-01-01' AND T1.starttime < '2101-01-01' GROUP BY T2.test_name ) AS T1 WHERE T1.C1 <= 5"
c1ffcaa8f6eaee005e37aa5d,When did patient 10005909 last undergo a microbiology test on the last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiology.charttime FROM microbiology WHERE microbiology.patient_id = 10005909 AND microbiology.charttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiology.charttime DESC LIMIT 1
007c6a12f2a1a55bd3b09e1e,How many open and other replacement of aortic valve procedures have occurred since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open and other replacement of aortic valve' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures WHERE procedures.type = 'open and other replacement of aortic valve' AND strftime('%Y',procedures.starttime) >= '2100'"
a16e5eeb260d3b031762211d,Tell me the name of the drug that patient 10021487 was first prescribed through the im route.,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1,"SELECT T1.drug FROM ( SELECT prescriptions.drug, prescriptions.starttime FROM prescriptions WHERE prescriptions.patient = 10021487 AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.patient = admissions.subject_id WHERE admissions.subject_id = 10021487 AND prescriptions.route = 'im' ORDER BY prescriptions.starttime DESC LIMIT 1 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime < T2.starttime"
c387a4c3a7bc1f1536ae7916,Is patient 10031404 male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10031404,10031404 is male or female?
4bff1dd96412ee933ce201a2,Find the length in days of the last ICU stay for patient 10006053.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT STRFTIME('%J', icu.outtime) - STRFTIME('%J', icu.intime) FROM icu WHERE icu.patient_id = 10006053 AND icu.outtime IS NOT NULL ORDER BY icu.intime DESC LIMIT 1"
9637bc783f8bbca836af73b7,When did patient 10021487 receive his last input since 12/06/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-06' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT input_time FROM input_events WHERE subject_id = 10021487 AND strftime('%Y-%m-%d',input_time) >= '2100-12-06' ORDER BY input_time DESC LIMIT 1"
68d14f27e5ba3606ce989f0b,What is the cost of a medication known as guaifenesin?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' ),SELECT DISTINCT cost FROM medications WHERE medication_name = 'guaifenesin'
d1cbc79c8f893b6d1d18523b,What is the minimum total cost of the hospital visits which involve dysthymic disorder since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysthymic disorder' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1",SELECT MIN(T1.C1) FROM ( SELECT SUM(diagnosis_cost) AS C1 FROM diagnoses WHERE diagnosis = 'dysthymic disorder' AND year >= 2100 GROUP BY patient_id ) AS T1
6aa28b1f973eb8725565aabc,Can you list the methods for taking methadone?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'methadone',SELECT DISTINCT method_name FROM procedures WHERE procedure_name = 'methods for taking methadone'
4ff852f95fae6d06622555a4,What would be the daily maximum weight of patient 10024043 in their last hospital encounter?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT MAX(T1.weight) FROM ( SELECT weight FROM patients WHERE patient_id = 10024043 AND hospital_id = ( SELECT hospital_id FROM patients WHERE patient_id = 10024043 AND current_time = ( SELECT current_time FROM patients WHERE patient_id = 10024043 ORDER BY current_time DESC LIMIT 1 ) ) ) AS T1 JOIN ( SELECT patient_id, current_time FROM patients WHERE patient_id = 10024043 AND hospital_id = ( SELECT hospital_id FROM patients WHERE patient_id = 10024043 AND current_time = ( SELECT current_time FROM patients WHERE patient_id = 10024043 ORDER BY current_time DESC LIMIT 1 ) ) ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.current_time::DATE = T2.current_time::DATE GROUP BY strftime('%Y-%m-%d',T1.current_time)"
6342a44540e55f3dc3b44fc5,How many patients died after having been diagnosed with facial weakness during the same hospital encounter throughout this year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'facial weakness' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-0 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE T2.hadm_id = T3.hadm_id","SELECT COUNT( DISTINCT T2.subject ) FROM ( SELECT T1.subject, T1.diagnosis_time, T1.hadm_id FROM ( SELECT T1.subject, T1.diagnosis_time, T1.hadm_id FROM diagnoses AS T1 JOIN patients AS T2 ON T1.subject = T2.subject ) AS T1 GROUP BY T1.subject HAVING MIN(T1.diagnosis_time) = T1.diagnosis_time AND T1.diagnosis = 'facial weakness' ) AS T2 JOIN ( SELECT subject, hadm_id, ward_id, stay_start_time FROM transfers ) AS T3 ON T2.subject = T3.subject AND T2.hadm_id = T3.hadm_id WHERE T3.ward_id = 200 AND datetime(T3.stay_start_time,'start of year') = datetime(current_time,'start of year','-0 year')"
88823049d5169eac0fe75ddc,What is the daily average dose of d5 1/2ns that patient 10039831 took since 12/16/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-16' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)","SELECT AVG(input_events.total) FROM input_events WHERE input_events.patient_id = 10039831 AND input_events.input_type_id = ( SELECT input_types.input_type_id FROM input_types WHERE input_types.label = 'd5 1/2ns' ) AND strftime('%Y-%m-%d',input_events.start_time) >= '2100-12-16' GROUP BY strftime('%Y-%m-%d',input_events.start_time)"
301ae55bf7f25fd564f985aa,"Give me the top five most commonly prescribed medications within 2 months to the patients aged 40s after they were diagnosed with constipation, unspecified.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.diagnosis_time FROM diagnoses AS T1 JOIN patients AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnosis = 'constipation, unspecified' ) AS T2 JOIN prescriptions AS T3 ON T2.subject_id = T3.subject_id WHERE T2.age BETWEEN 40 AND 49 GROUP BY T3.drug ) AS T4 WHERE T4.C1 <= 5"
3c2644bcbfce5414f79d1016,What's the minimum total cost of the hospital visits that had iso-osmotic sodium chloride in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic sodium chloride' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM(diagnosis_cost) AS C1 FROM diagnoses WHERE diagnosis_name = 'iso-osmotic sodium chloride' AND strftime('%Y',diagnosis_time) = '2100' GROUP BY patient_id ) AS T1"
f2d9ed56cde7d9f6f4b4bfe7,What is the number of patients who were diagnosed with facial weakness since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'facial weakness' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT( DISTINCT patient_id ) FROM diagnoses WHERE diagnosis = 'facial weakness' AND strftime('%Y', diagnoses.chart_time) >= '2100'"
20652261cb0352fb90678734,What is the yearly average dose of po intake that patient 10001725 took since 04/03/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-03' GROUP BY strftime('%Y',inputevents.starttime)","SELECT AVG(input_events.total) FROM input_events WHERE input_events.patient_id = 10001725 AND input_events.input_type_id = 3 AND strftime('%Y-%m-%d',input_events.start_time) >= '2100-04-03'"
4a82faf774a9f3614964283f,What were the names of the output that patient 10004720 had last since 12/05/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-05' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT drsl/dslmb fus post/post procedure output since 12/05/2100 FROM patients WHERE patient_id = 10004720
11c8c8af342244bb88c103ec,How much is patient 10020786 needed to pay for the cost of their hospital visit?,SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ),SELECT SUM(cost) FROM ( SELECT cost FROM diagnoses WHERE patient_id = 10020786 UNION SELECT cost FROM procedures WHERE patient_id = 10020786 ) AS T1
6daa9b7fb20a9577136bb303,What are the new medications prescribed to patient 10039831 today in comparison to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescription_2.drug FROM ( SELECT prescription_1.drug FROM prescription_1 WHERE prescription_1.patient_id = 10039831 AND datetime(prescription_1.starttime,'start of day') = datetime(current_time,'start of day','-1 day') ) AS prescription_1 JOIN ( SELECT prescription_2.drug FROM prescription_2 WHERE prescription_2.patient_id = 10039831 AND datetime(prescription_2.starttime,'start of day') = datetime(current_time,'start of day','-1 day') AND datetime(prescription_2.starttime,'start of day') > datetime(prescription_1.starttime,'start of day') ) AS prescription_2
        ON prescription_1.drug = prescription_2.drug"
70af8cdd705ae41288815362,What are some of the three common specimens sampled since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3",1. what are the three most common specimens that were sampled since 2100?
c2a42482b7f7bf97e37b7a73,Has patient 10018328 visited the hospital for admission since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018328 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')",10018328 has been admitted into the hospital within 1 year.
