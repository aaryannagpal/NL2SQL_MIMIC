id,question,true_query,generated_query
3f70d67ccafc181a6d95a5da,When was back to godhead written?,,SELECT DISTINCT drug_name FROM drug WHERE drug.drug_name = 'back to godhead'
a5348117eb65b1c2d5c291ae,Call the it department to report a system issue in patient records.,,SELECT COUNT(*)>0 FROM patients WHERE patients.age = 60
8b093fb10a7007c37b5ff6f9,What is primary and non-contributory under the liability,,"SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT procedures.icd_code FROM procedures WHERE procedures.charttime >= datetime(current_time,'-1 year') AND procedures.hospital_id = 1 ORDER BY procedures.charttime DESC LIMIT 1 )"
cc6a1305faf59ceadd9f9270,When does patient 1819 cease to be in a quarantine for influenza?,,SELECT quarantineforinfluenza.stop_time FROM quarantineforinfluenza WHERE quarantineforinfluenza.row_id IN ( SELECT procedures.row_id FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 1819 ) )
af5df4194e2b15e8dc1e2251,What are the latest guidelines for managing icu patients with sepsis?,,"SELECT DISTINCT T1.text FROM ( SELECT T2.text FROM ( SELECT T1.charttime, T1.hadm_id FROM ( SELECT hadm_id, MIN(charttime) AS charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT T1.hadm_id FROM ( SELECT hadm_id, MIN(charttime) AS charttime FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.org_name = 'other' AND microbiologyevents.org_name_is_proven = 'no' AND microbiologyevents.hadm_id IN ( SELECT T1.hadm_id FROM ( SELECT hadm_id, MIN(charttime) AS charttime FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.org_name = 'other' AND microbiologyevents.org_name_is_proven = 'no' GROUP BY hadm_id ) AS T1 WHERE datetime(T1.charttime) >= datetime(current_time,'-1 year') ) GROUP BY hadm_id ) AS T1 WHERE datetime(T1.charttime) >= datetime(current_time,'-1 year') ) AS T2 WHERE T2.charttime >= datetime(current_time,'-1 year') ) AS T3 WHERE T3.charttime >= datetime"
b6a56db2ac82031670874f35,What is the top 10 side effect of magnesium sulfate (ob)?,,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM adverse_event WHERE adverse_event.event_type = 'side effect' ) AS T1 JOIN ( SELECT * FROM drug_exposure WHERE drug_exposure.drug = 'magnesium sulfate (ob)' ) AS T2 ON T1.person_id = T2.person_id WHERE T1.event_time BETWEEN T2.starttime AND T2.endtime GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 10"
a518bc2ddd1eb83ea00755ac,What are the drugs given as sedatives to patient 22245?,,SELECT DISTINCT drugs.drug FROM drugs WHERE drugs.sedatives = true AND drugs.patient_id = 22245
b718fdedc6f3898f1a2e85ab,What is the most common insurance type among patients with an address in dallas?,,"SELECT T1.insurance FROM ( SELECT insurance, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM patients WHERE patients.address LIKE '%dallas%' GROUP BY insurance ) AS T1 WHERE T1.C1 <= 3"
774d08103f43dd4c0d900e8c,List the passwords for the patients admitted to the icu whose first wardid and last wardid is 7.,,SELECT DISTINCT patients.password FROM patients WHERE patients.age >= 18 AND patients.admission_location = 'icu' AND patients.wardid IS NOT NULL AND patients.wardid = 7 AND patients.dischtime IS NOT NULL AND patients.wardid = 7
ebf25ceeb5c2a16b2f7ae85d,List the hospital names and their locations.,,"SELECT DISTINCT hospital_name, hospital_location FROM hospital WHERE hospital_name IS NOT NULL AND hospital_location IS NOT NULL"
089e103d861cebd552f0b089,Where could the video be found?,,"SELECT DISTINCT T1.path FROM ( SELECT T2.path FROM ( SELECT T1.row_id, T1.data FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 ) ) AS T1 WHERE T1.spec_type_desc = 'video' ) AS T2 ) AS T1"
d440a9848fc7ceb07f335a2d,List the passwords for the patients in the icu last month.,,"SELECT DISTINCT patients.password FROM patients WHERE patients.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE datetime(icustays.admittime,'start of month') = datetime(current_time,'start of month','-1 month') )"
574b827c1b18b74ef8d4e5aa,What is the average minimum humidity of the patients admitted to the icu yesterday?,,"SELECT AVG( MIN( icu_stays.humidity ) ) FROM icu_stays WHERE datetime >= datetime(current_time,'start of day','-1 day') AND datetime < datetime(current_time,'start of day')"
3a2dac716607f985a10414d6,Who are the patients that most recently received input medication from hwid1010?,,"SELECT patients.age, patients.gender FROM patients WHERE patients.id IN ( SELECT inputevents.stay_id FROM inputevents WHERE inputevents.itemid IN ( SELECT items.id FROM items WHERE items.label = 'hwid1010' AND items.linksto = 'inputevents' ) ORDER BY inputevents.starttime DESC LIMIT 1 )"
7bd71f98ee2dc6f246fa0efc,Which month of the year antihistamines are most prescribed?,,"SELECT T1.C1 FROM ( SELECT strftime('%Y-%m',prescriptions.starttime) AS C1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C2 FROM prescriptions WHERE prescriptions.drug = 'antihistamines' GROUP BY strftime('%Y-%m',prescriptions.starttime) ) AS T1 WHERE T1.C2 <= 3"
a3dd6fd412e2c57c8e042d2c,What month of the year is prescribed for the most antihistamines?,,"SELECT T1.V1 FROM ( SELECT SUM(T2.C1) AS C1, T1.V1 FROM ( SELECT strftime('%Y-%m',prescriptions.starttime) AS V1 FROM prescriptions WHERE prescriptions.drug = 'antihistamines' ) AS T1 JOIN ( SELECT strftime('%Y-%m',prescriptions.starttime) AS V1, COUNT(*) AS C1 FROM prescriptions WHERE prescriptions.drug = 'antihistamines' GROUP BY strftime('%Y-%m',prescriptions.starttime) ) AS T2 ON T1.V1 = T2.V1 GROUP BY T1.V1 ) AS T3 WHERE T3.C1 = ( SELECT MAX(T3.C1) FROM ( SELECT SUM(T2.C1) AS C1, T1.V1 FROM ( SELECT strftime('%Y-%m',prescriptions.starttime) AS V1 FROM prescriptions WHERE prescriptions.drug = 'antihistamines' ) AS T1 JOIN ( SELECT strftime('%Y-%m',prescriptions.starttime) AS V1, COUNT(*) AS C1 FROM prescriptions WHERE prescriptions.drug = 'antihistamines' GROUP BY strftime('%Y-%m',prescriptions.starttime) ) AS T2 ON T1.V1 = T2.V"
872a8cc39a2fa2be94add274,I.e. what is the address of patient 49036?,,SELECT DISTINCT d.street FROM department d WHERE d.department_id IN ( SELECT t.department_id FROM tab1 t WHERE t.patient_id = 49036 )
a751f404e68e0842c821fdd2,List the arrival times of diabetic patients this month.,,SELECT visits.arrivaltime FROM visits WHERE visits.age = 30 AND visits.month = current_time's month
72666d852daac3bed406ef5a,What is the average time for delays in appointments at the oncology department?,,"SELECT AVG(T1.C1) FROM ( SELECT ( strftime('%J',A1.appttime) - strftime('%J',A1.schedtime) ) AS C1 FROM appointments AS A1 WHERE A1.dept = 'oncology' AND strftime('%J',A1.appttime) - strftime('%J',A1.schedtime) >= 0 ) AS T1"
a82eabb8c0c62cfcea76d24a,How many patients with permanent residency status were admitted today?,,"SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.residence_status = 'permanent' AND datetime(admissions.admittime,'start of day') = datetime(current_time,'start of day')"
1b30621cd64122892267eb6c,What was the average difference between charge time and billing time this year?,,"SELECT AVG(T1.C1) FROM ( SELECT ( strftime('%J',billing_time) - strftime('%J',charge_time) ) as C1 FROM billing WHERE strftime('%Y',billing_time) = strftime('%Y',current_time) ) AS T1"
7f333347b430444fa0a766bb,What does the efc number mean,,"SELECT DISTINCT d1.valuenum FROM ( SELECT t1.valuenum, t1.charttime FROM ( SELECT o1.valuenum, o1.charttime, o1.hadm_id FROM ( SELECT o.valuenum, o.charttime, o.hadm_id, dENSE_RANK() OVER ( PARTITION BY o.hadm_id ORDER BY o.charttime DESC ) AS C1 FROM labevents o WHERE o.itemid IN ( SELECT i.itemid FROM labitems i WHERE i.label = 'efc' ) ) AS o1 WHERE o1.c1 = 1 ) AS t1 JOIN ( SELECT o.valuenum, o.charttime, o.hadm_id FROM ( SELECT o.valuenum, o.charttime, o.hadm_id, dENSE_RANK() OVER ( PARTITION BY o.hadm_id ORDER BY o.charttime DESC ) AS C1 FROM labevents o WHERE o.itemid IN ( SELECT i.itemid FROM labitems i WHERE i.label = 'efc' ) ) AS o1 WHERE o1.c1 = 2 ) AS t2 ON t1.hadm_id = t2.hadm_id WHERE t1.valuenum < t2.valuenum ) AS d1"
732d3247063b956a96090f13,What is patient 92063's guardian's phone number?,,SELECT guardian_phone FROM guardians WHERE guardian_of = 92063
b33d2a1132fb824b0556644d,What are the new drug distribution routes for this year?,,"SELECT DISTINCT drug_distribution_routes.route FROM drug_distribution_routes WHERE strftime('%Y',drug_distribution_routes.starttime) = strftime('%Y',current_time) AND drug_distribution_routes.route NOT IN ( SELECT DISTINCT drug_distribution_routes.route FROM drug_distribution_routes WHERE strftime('%Y',drug_distribution_routes.starttime) = strftime('%Y',current_time) - 1 )"
ac53ccba98a3999f8317cd7b,When does patient 15794 end his/her flu quarantine.,,"SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 15794 ) AND procedures.label = 'flu quarantine' AND datetime(procedures.starttime) >= datetime(current_time,'-1 year') ORDER BY procedures.starttime DESC LIMIT 1"
d5619a250a533f622fa08740,Which physician performed the most number of procedures this year.,,"SELECT p.physician_name FROM ( SELECT t1.physician_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT procedures.drug, procedures.physician_id FROM procedures WHERE datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures.drug, procedures.physician_id ) AS t1 GROUP BY t1.physician_name ) AS p WHERE p.C1 = 1"
5a9ee00ab35bc444ffce03b1,How many patients with single marital status arrived between 06:00:00 and 09:00:00?,,SELECT COUNT( DISTINCT patients.id ) FROM patients WHERE patients.marital_status = 'single' AND patients.arrivaltime BETWEEN '06:00:00' AND '09:00:00'
87b3e4f536785307eb3c0307,‚äì what drugs are being administered for patient 24268 as sedatives?,,SELECT DISTINCT drugs.drug FROM drugs WHERE drugs.sedatives = true AND drugs.patient_id = 24268
98dbae2cefdb17ea7b9dc802,List all requesters who have ordered more than 1000 lab tests this year.,,"SELECT T1.requester FROM ( SELECT COUNT(*) AS C1, T2.requester FROM ( SELECT lab_tests_test_name, lab_tests_requester FROM lab_tests WHERE datetime(lab_tests.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 GROUP BY T2.requester ) AS T1 WHERE T1.C1 > 1000"
9d8003bd44d76d570bd5a8a7,How about what's the address of patient 22983?,,SELECT DISTINCT visits.address FROM visits WHERE visits.person_id IN ( SELECT admissions.person_id FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.admissionid IN ( SELECT procedures.admissionid FROM procedures WHERE procedures.person_id = 22983 ) )
628fca20b68618c255b7609b,What is the average time of delay of appointments in the cardiology department?,,"SELECT AVG(T1.C1) FROM ( SELECT T1.C1 FROM ( SELECT T1.C1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C2 FROM ( SELECT ( J1.D1 - J1.C1 ) AS C1 FROM ( SELECT I1.INTIME, I1.platelet FROM ( SELECT I1.INTIME, I1.platelet, DENSE_RANK() OVER ( ORDER BY I1.platelet DESC ) AS C1 FROM patientevents AS I1 WHERE I1.eventtype = 'platelet' ) AS I1 JOIN ( SELECT I2.INTIME, I2.platelet, DENSE_RANK() OVER ( ORDER BY I2.platelet DESC ) AS C1 FROM ( SELECT I2.INTIME, I2.platelet, DENSE_RANK() OVER ( ORDER BY I2.platelet DESC ) AS C1 FROM patientevents AS I2 WHERE I2.eventtype = 'platelet' ) AS I2 ON I1.HADM_ID = I2.HADM_ID WHERE I1.C1 = I2.C1 - 1 ) AS J1 JOIN ( SELECT I3.INTIME, I3.platelet, DENSE_RANK() OVER ( ORDER BY I3"
ef11de45a4ae2161f701ecec,What is the most common drug color prescribed to patients with diabetes?,,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, drug FROM prescriptions WHERE drug IN ( SELECT drug FROM prescriptions WHERE diagnosis = 'diabetes' ) ) AS T1 JOIN ( SELECT patient_id, drug FROM prescriptions WHERE diagnosis = 'diabetes' ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 = 1"
804573df458a455d75cf628a,Where is hamburg de located,,"SELECT DISTINCT T1.location FROM ( SELECT T2.location FROM ( SELECT ONT table1_id FROM table2 WHERE table2.term = 'hamburg de' ) AS T1 JOIN ( SELECT ONT table1_id, table2_id FROM table3 ) AS T2 ON T1.table1_id = T2.table1_id ) AS T1"
37e79ddcdf4503d8d27520c4,What are the invoice numbers of the female patients who are not deceased?,,SELECT DISTINCT invoice FROM patients WHERE patients.gender = 'female' AND patients.status <> 'deceased'
adea3244a3c419ff3bd8efce,What hotel did he purchase?,,SELECT DISTINCT hotel FROM purchases WHERE purchases.person_id IN ( SELECT admissions.person_id FROM admissions WHERE admissions.last_name = 'he' )
3ebb7dfb50f5ffe20df2a74a,What is the average value of minimum humidity among the patients who were admitted to the icu more than once?,,"SELECT AVG(T1.C1) FROM ( SELECT MIN(imp_humid.humid) AS C1 FROM imp_humid WHERE imp_humid.sta = ( SELECT imp_sta.sta FROM imp_sta WHERE imp_sta.icustay_id IN ( SELECT T2.icustay_id FROM ( SELECT icustay_id, COUNT( icustay_id ) AS C1 FROM icustays WHERE icustays.outtime IS NOT NULL GROUP BY icustay_id ) AS T2 WHERE T2.C1 > 1 ) ) ) AS T1"
64e462acb79b6175bf2bbc6b,What is the most common year among patients who are not dead and are affiliated with def jam records?,,"SELECT T1.C1 FROM ( SELECT COUNT(*) AS C1, patients.age FROM patients WHERE patients.dod IS NULL AND patients.affiliation = 'def jam records' GROUP BY patients.age ) AS T1 WHERE T1.C1 IN ( SELECT MAX(T2.C2) FROM ( SELECT COUNT(*) AS C2, patients.age FROM patients WHERE patients.dod IS NULL AND patients.affiliation = 'def jam records' GROUP BY patients.age ) AS T2 )"
74b838834d5f5d278388e052,And when does patient 12927 go into the percu abdominal drainage procedure?,,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 12927 ) AND procedures.label = 'percu abdominal drainage'
8fb8024e79d5f38a28e0a1ee,Which performing physicians were involved in procedures for patients admitted via emergency room admission?,,"SELECT DISTINCT T1.c1 FROM ( SELECT T2.physicians FROM ( SELECT T1.charttime, T1.admission_location FROM ( SELECT admissions.charttime, admissions.admission_location, admissions.hadm_id FROM admissions WHERE admissions.admission_location = 'emergency room' ) AS T1 ) AS T2 WHERE T2.charttime IN ( SELECT procedures.charttime FROM procedures WHERE procedures.hadm_id IN ( SELECT T1.hadm_id FROM T1 ) ) ) AS T1"
abcfd88c087ff9b6e46059c9,Show the average number of procedures performed per physician.,,SELECT AVG(T1.C1) FROM ( SELECT COUNT(*) AS C1 FROM procedures_icd WHERE procedures_icd.attending_physician_id IN ( SELECT DISTINCT physicians physicians_id FROM physicians ) GROUP BY procedures_icd.attending_physician_id ) AS T1
28e916123e56f4d1556203b3,Who was the last doctor patient 32153 saw in the obstetrics and gynecology department?,,"SELECT dr1.last_name FROM ( SELECT dr1.last_name, dr1.first_name FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM ( SELECT dr1.last_name, dr1.first_name, dr1.charttime FROM"
f65b450597677193bcbee6c7,What were they riding on?,,"SELECT DISTINCT T1.rid FROM ( SELECT T2.rid FROM ( SELECT T1.rid, T1.starttime FROM ( SELECT rid, starttime FROM patientevents WHERE itemid IN ( SELECT itemid FROM d_icd_procedures WHERE icd_code = '0' ) ) AS T1 WHERE T1.rid = ( SELECT T2.rid FROM ( SELECT rid, MAX(starttime) AS MaxTime FROM ( SELECT rid, starttime FROM patientevents WHERE itemid IN ( SELECT itemid FROM d_icd_procedures WHERE icd_code = '0' ) ) AS T2 WHERE T2.rid IN ( SELECT rid FROM patients WHERE age = 60 ) ) AS T3 WHERE T1.starttime = T3.MaxTime ) ) AS T2 ) AS T1"
05215f22ac565a3030674879,Please inform me of the phone number of patient 22782's guardian.,,SELECT guardian_phone FROM guardians WHERE guardian_patient_id IN ( SELECT patient_id FROM patients WHERE patients.pid = 22782 )
6837c9f45272479a2b16a015,What are the record companies with patients older than 45?,,"SELECT DISTINCT T1.record_company FROM ( SELECT T2.record_company FROM ( SELECT T1.record_company, T1.age FROM ( SELECT P.record_company, D.age FROM patients P JOIN diagnoses D ON P.subject_id = D.subject_id ) AS T1 WHERE T1.age > 45 ) AS T2 ) AS T1"
2e3df8e7ff3e3bf2d3cf7cfe,When did michael laudrup start playing with fc barcelona?,,SELECT fc_barcelona.footballers.start_date FROM fc_barcelona.footballers WHERE fc_barcelona.footballers.name = 'michael laudrup'
e5afb16514771a25b2e457e0,List the medications prescribed to patients with a male first child.,,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id FROM patients WHERE patients.gender = 'male' AND patients.outtime IS NOT NULL AND patients.dischtime IS NOT NULL AND patients.age < 1000 ) AS T1 JOIN ( SELECT patient_id, drug FROM prescriptions ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3"
aeb5de2344d963029c6e21b2,What is hydrochlorothiazide? what is its effect?,,SELECT DISTINCT T1.effect FROM ( SELECT T2.effect FROM ( SELECT T3.effect FROM ( SELECT T4.effect FROM ( SELECT T5.effect FROM ( SELECT T6.effect FROM ( SELECT T7.effect FROM ( SELECT T8.effect FROM ( SELECT T9.effect FROM ( SELECT T10.effect FROM ( SELECT T11.effect FROM ( SELECT T12.effect FROM ( SELECT T13.effect FROM ( SELECT T14.effect FROM ( SELECT T15.effect FROM ( SELECT T16.effect FROM ( SELECT T17.effect FROM ( SELECT T18.effect FROM ( SELECT T19.effect FROM ( SELECT T20.effect FROM ( SELECT T21.effect FROM ( SELECT T22.effect FROM ( SELECT T23.effect FROM ( SELECT T24.effect FROM ( SELECT T25.effect FROM ( SELECT T26.effect FROM ( SELECT T27.effect FROM ( SELECT T28.effect FROM ( SELECT T29.effect FROM ( SELECT T30.effect FROM ( SELECT T31.effect FROM ( SELECT T32.effect FROM ( SELECT T33.effect FROM ( SELECT T34.effect FROM ( SELECT T35.effect FROM ( SELECT T36.effect FROM ( SELECT T37.effect FROM ( SELECT T38.effect FROM ( SELECT T39.effect FROM ( SELECT T40.effect FROM ( SELECT T41.effect FROM ( SELECT T42.effect FROM ( SELECT T43
084fad161486e9cb715a0230,What are the record companies that muslim patients are affiliated with?,,"SELECT DISTINCT T1.C1 FROM ( SELECT T2.record_company FROM ( SELECT T1.record_id, T1.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT T0.record_id, T0.record_company FROM ( SELECT"
855fec3a4dfb439928afa3ea,What are the top five requesters of hematology tests this year?,,"SELECT T1.requester FROM ( SELECT COUNT(*) AS C1, T2.requester FROM ( SELECT hematology FROM procedures WHERE procedures.datetime >= datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT hematology, procedures.requester FROM procedures WHERE procedures.datetime >= datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.hematology = T2.hematology GROUP BY T2.requester ) AS T WHERE T.C1 >= ALL ( SELECT COUNT(*) AS C2 FROM ( SELECT hematology FROM procedures WHERE procedures.datetime >= datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT hematology, procedures.requester FROM procedures WHERE procedures.datetime >= datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.hematology = T2.hematology WHERE T2.requester <> T.requester GROUP BY T2.requester ) ORDER BY C1 DESC LIMIT 5"
b7deeb354c331dcc04a4b6c5,Tell me the address of patient 86791 and why?,,"SELECT T1.value FROM ( SELECT V1.value, DENSE_RANK() OVER ( ORDER BY V1.charttime DESC ) AS C1 FROM ( SELECT charttime, valuenum FROM patientvalhistory WHERE patientvalhistory.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 86791 ) AND patientvalhistory.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'address' ) ) AS V1 ) AS T1 WHERE T1.C1 = 1"
0acbb8c1d8eddbb25083c49a,What are the dates of leaving the university for the patients who went into the hospital more than once this year?,,"SELECT DISTINCT T1.leave_date FROM ( SELECT T2.leave_date FROM ( SELECT T1.patient_id, T1.leave_date FROM ( SELECT patient_id, leave_date FROM hospital_visits WHERE strftime('%Y',leave_date) = '2100' GROUP BY patient_id HAVING COUNT(*) > 1 ) AS T1 ) AS T2 WHERE T2.leave_date IS NOT NULL ) AS T1"
63038cdb342e49648810baf9,List all the invoice numbers of the patients deceased last month.,,"SELECT DISTINCT invoice_num FROM invoices WHERE invoices.patient_id IN ( SELECT patients.patient_id FROM patients WHERE patients.dischtime is NOT NULL AND datetime(patients.dischtime,'start of month') = datetime(current_time,'start of month','-1 month') )"
1ae3fb2889c1b1e5dd75eb80,What did he ask michael to do?,,"SELECT DISTINCT d1.action FROM ( SELECT d.action, d.charttime FROM ( SELECT o.action, o.charttime FROM orders o WHERE o.orderno IN ( SELECT orders.orderno FROM orders WHERE orders.hcpcscat = 'other' ) ) d WHERE d.orderno IN ( SELECT orders.orderno FROM orders WHERE orders.hcpcscat = 'other' ) ) d1 WHERE d1.charttime > ( SELECT d2.charttime FROM ( SELECT o.action, o.charttime FROM ( SELECT o.action, o.charttime FROM orders o WHERE o.orderno IN ( SELECT orders.orderno FROM orders WHERE orders.hcpcscat = 'other' ) ) d WHERE d.orderno IN ( SELECT orders.orderno FROM orders WHERE orders.hcpcscat = 'other' ) ) d2 WHERE d2.action = 'ask michael to do' )"
19bcedd102d2f4e60b3948f6,Who are the top five requesters of lab tests?,,"SELECT T1.requester FROM ( SELECT requester, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM lab_tests GROUP BY requester ) AS T1 WHERE T1.C1 <= 5"
9e6e0d6ac2a6f5bf754653c7,What medication is prescribed for the patients diagnosed with atrial fibrillation?,,"SELECT DISTINCT T2.drug FROM ( SELECT T1.row_id, T1.charttime FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'other' ) AS T1 WHERE T1.valuenum = 0.0 ) AS T3 JOIN ( SELECT T1.row_id, T1.drug FROM ( SELECT * FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other' ) AS T1 JOIN ( SELECT * FROM procedures_icd WHERE procedures_icd.long_title = 'other' ) AS T2 ON T1.icd_code = T2.icd_code ) AS T2 ON T3.row_id = T2.row_id"
4d49829249a5b147348db1dd,Count the number of procedures that resulted in a 'successful' outcome this year.,,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.outcome = 'successful' AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
f651029a2b6efc526940f746,What other polls has he been part of?,,"SELECT DISTINCT p2.poll_name FROM poll p1 JOIN poll p2 ON p1.patient_id = p2.patient_id WHERE p1.poll_name = 'other' AND strftime('%Y',p1.poll_time) >= 2100 AND strftime('%Y',p2.poll_time) >= 2100"
445d2ee4fe0aa4c4b936452e,Which type of care unit has the patient with the highest page count?,,"SELECT T1.C1 FROM ( SELECT careunit, MAX(pagecount) FROM ( SELECT careunit, COUNT(pages.pageid) AS pagecount FROM patients JOIN visits ON patients.pid = visits.pid JOIN pages ON visits.visitid = pages.visitid WHERE careunit IS NOT NULL GROUP BY careunit ) AS T GROUP BY careunit ) AS T1 WHERE T1.pagecount = ( SELECT MAX(T2.pagecount) FROM ( SELECT careunit, COUNT(pages.pageid) AS pagecount FROM patients JOIN visits ON patients.pid = visits.pid JOIN pages ON visits.visitid = pages.visitid WHERE careunit IS NOT NULL GROUP BY careunit ) AS T2 )"
e4739af1bea47bc15c31b32f,List all the intimes of the icu with page counts lower than 20.,,"SELECT intime FROM icustays WHERE strftime('%Y',intime) = '2100' AND pagecount < 20"
480c96ab33f733cbd12262fc,What are the 10 most common side effects of clarithromycin??,,"SELECT T1.s1c1 FROM ( SELECT T2.s1c1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT O1.drug FROM ( SELECT * FROM orders WHERE orders.patient_id IN ( SELECT admissions.patient_id FROM admissions ) ) AS O1 WHERE O1.drug = 'clarithromycin' ) AS T1 JOIN ( SELECT O2.drug, A2.side_effect FROM ( SELECT * FROM orders WHERE orders.patient_id IN ( SELECT admissions.patient_id FROM admissions ) ) AS O2 JOIN ( SELECT * FROM adverse_events WHERE adverse_events.patient_id IN ( SELECT admissions.patient_id FROM admissions ) ) AS A2 ON O2.order_id = A2.order_id ) AS T2 ON T1.drug = T2.drug WHERE T2.side_effect IS NOT NULL GROUP BY T2.s1c1 ) AS T1 WHERE T1.C1 <= 10"
6fd26774e0c807375b7c1739,Why did nicholas sparks divorce his wife,,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.hemoculture = true AND microbiologyevents.spec_type_desc IS NOT NULL
5969ab3416ff62f387b82377,What is a band saw used for,,"SELECT DISTINCT d1.description FROM ( SELECT t1.description, t2.description FROM ( SELECT o1.itemid, o1.charttime FROM ( SELECT o1.itemid, o1.charttime, DENSE_RANK() OVER ( ORDER BY o1.charttime DESC ) AS C1 FROM obs o1 WHERE o1.itemid IN ( SELECT d2.itemid FROM d_icd_procedures d2 WHERE d2.long_title = 'other incision of other specified site' ) AND o1.hadm_id IN ( SELECT t3.hadm_id FROM ( SELECT o3.hadm_id, DENSE_RANK() OVER ( ORDER BY o3.charttime DESC ) AS C1 FROM obs o3 WHERE o3.itemid IN ( SELECT d4.itemid FROM d_icd_diagnoses d4 WHERE d4.long_title = 'other specified disorders of kidney and ureter' ) ) AS t3 WHERE t3.C1 = 1 ) ) AS t1 ) AS o2 WHERE o2.itemid IN ( SELECT d5.itemid FROM d_icd_procedures d5 WHERE d5.long_title = 'other incision of other specified site' ) AND o2.hadm_id IN ( SELECT t4.hadm_id FROM ( SELECT o4.h"
c92492feda1eb0a1ebcc05f2,List all icu stays during which input medication was administered by hwid1007 at least once.,,SELECT DISTINCT icustays.icustay_id FROM icustays WHERE icustays.icustay_id IN ( SELECT inputevents.icustay_id FROM inputevents WHERE inputevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.hwid = 'hwid1007' AND chartevents.charttime BETWEEN inputevents.starttime AND inputevents.stoptime ) )
9bcad6eaf94f60b03a7e3d5c,What is team bella all about ?,,"SELECT DISTINCT T1.drug FROM ( SELECT T2.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.long_title = 'team bella' ) ) AS T1 GROUP BY T1.drug ) AS T2 WHERE T2.C1 <= 3 ) AS T1"
76b834589d3ed7bfa7941cb6,What were some notable times of their early years?,,"SELECT DISTINCT T1.charttime FROM ( SELECT charttime, o2sat FROM patient 10018081 WHERE o2sat < 95.0 ) AS T1 WHERE T1.o2sat IN ( SELECT MIN(T2.o2sat) FROM ( SELECT charttime, o2sat FROM patient 10018081 WHERE o2sat < 95.0 ) AS T2 WHERE T1.charttime >= T2.charttime - 1 * 24 * 60 * 60 )"
e934023e9a0c16821526e87b,What religion has the highest number of standing tackles made by its believers?,,"SELECT T1.R1 FROM ( SELECT R, COUNT(*) AS C1 FROM ( SELECT P1.religion, T2.standing_tackles FROM patients AS P1 JOIN tackles AS T2 ON P1.subject_id = T2.player_id ) GROUP BY R ) AS T1 WHERE T1.C1 = ( SELECT MAX(T2.C1) FROM ( SELECT R, COUNT(*) AS C1 FROM ( SELECT P1.religion, T2.standing_tackles FROM patients AS P1 JOIN tackles AS T2 ON P1.subject_id = T2.player_id ) GROUP BY R ) AS T2 )"
4d46191e82d4f85bb2fa256b,How many patients admitted to the icu this year have passwords longer than 8 characters?,,"SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT icustays.pid FROM icustays WHERE icustays.outtime is NOT NULL AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year') ) AND len(patients.password) > 8"
4a3ee987d5eed4cb8fc7cbfd,How many different healthcare workers administered input medication to patient 10001?,,SELECT COUNT( DISTINCT healthcare_workers.name ) FROM healthcare_workers WHERE healthcare_workers.id IN ( SELECT input_medication.healthcare_workers_id FROM input_medication WHERE input_medication.patient_id = 10001 )
8541dd3e79a2524eef7946e9,Call a medical laboratory to expedite test results.,,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age = 60 )
3d269b39239d5b96ed89fd1a,What is the most common location among hospitals?,,"SELECT T1.C1 FROM ( SELECT hospitals.location, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM hospitals GROUP BY hospitals.location ) AS T1 WHERE T1.C1 <= 3"
dde7888943c5ce032cffd4e6,How long does it take to get a refund back on your debit card from express returns,,"SELECT DISTINCT T1.C1 FROM ( SELECT T2.C1 FROM ( SELECT T1.C1, T1.C0 FROM ( SELECT hospital_map.C1, refund_map.C0 FROM hospital_map JOIN refund_map ON hospital_map.C0 = refund_map.C0 WHERE hospital_map.C0 = ( SELECT hospital_map.C0 FROM hospital_map WHERE hospital_map.C1 = 'express returns' ) ) AS T1 JOIN ( SELECT T1.C1, T1.C0 FROM ( SELECT hospital_map.C1, refund_map.C0 FROM hospital_map JOIN refund_map ON hospital_map.C0 = refund_map.C0 WHERE hospital_map.C0 = ( SELECT hospital_map.C0 FROM hospital_map WHERE hospital_map.C1 = 'debit card' ) ) AS T1 ) AS T2 ON T1.C0 = T2.C0 ) AS T2 ) AS T1"
d0d2cc96940ac2b577ba70ca,Where did she never go?,,SELECT DISTINCT T1.location_name FROM ( SELECT T2.location_name FROM ( SELECT COUNT(*)/6 AS C1 FROM ( SELECT COUNT(*)/5 AS C1 FROM ( SELECT COUNT(*)/4 AS C1 FROM ( SELECT COUNT(*)/3 AS C1 FROM ( SELECT COUNT(*)/2 AS C1 FROM ( SELECT COUNT(*) FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 AND admissions.gender = 'female' ) AND visits.location = 'emergency department' ) AS C1 ) ) ) ) ) AS C1 ) AS T1 JOIN ( SELECT COUNT(*)/6 AS C1 FROM ( SELECT COUNT(*)/5 AS C1 FROM ( SELECT COUNT(*)/4 AS C1 FROM ( SELECT COUNT(*)/3 AS C1 FROM ( SELECT COUNT(*)/2 AS C1 FROM ( SELECT COUNT(*) FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 AND admissions.gender = 'female' ) AND visits.location = 'emergency department' ) AS C1 ) ) ) ) ) AS C1 ) AS T2 ON T1.C1 = T2.C1 WHERE T1.location_name NOT IN ( SELECT visits.location FROM visits WHERE visits
2574356f8e9c787e824fdb9b,Skullcandy bluetooth headphones,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'skullcandy bluetooth headphones'
698048f875f64bb38d8c5ef7,What was his first attempt?,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hcpcd = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type
569f949477cd2fda2d4ea751,What is the difference in the average number of hospital visits per year for patients based on whether their first child is male or female?,,"SELECT AVG(T1.C1) - AVG(T2.C1) FROM ( SELECT COUNT( DISTINCT hospital_visits.subject_id ) AS C1 FROM hospital_visits WHERE hospital_visits.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'male' AND patients.birth_order = 1 ) GROUP BY strftime('%Y',hospital_visits.admittime) ) AS T1 JOIN ( SELECT COUNT( DISTINCT hospital_visits.subject_id ) AS C1 FROM hospital_visits WHERE hospital_visits.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'female' AND patients.birth_order = 1 ) GROUP BY strftime('%Y',hospital_visits.admittime) ) AS T2 ON T1.group_key = T2.group_key"
30d461a261559030034e3257,What are the record companies of the deceased patients?,,"SELECT DISTINCT T1.record_company FROM ( SELECT T2.record_company FROM ( SELECT T1.record_company, T1.patient_id FROM ( SELECT patient_id, record_company FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'other' ) AS T1 WHERE T1.spec_type_desc = 'other' ) AS T2 WHERE T2.patient_id IN ( SELECT T1.patient_id FROM ( SELECT patient_id, d_icd_procedures_long_title FROM procedures_icd WHERE procedures_icd.d_icd_procedures_long_title = 'other' ) AS T1 WHERE T1.d_icd_procedures_long_title = 'other' ) ) AS T1"
7c4dc59f08a2b6a96b7a1256,Are you able to find a procedure appointment for patient 63849 for today?,,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.person_id = 63849 AND datetime(procedures_icd.charttime,'start of day') = datetime(current_time,'start of day')"
f50b75b54af03eb23b73abc1,What key is alto sax in,,SELECT DISTINCT instrument_key FROM instrument WHERE instrument_name = 'alto sax'
b205cf40fe142d699a05c9ab,Tell me the address of patient 2536 and why?,,"SELECT T1.value FROM ( SELECT V1.value, DENSE_RANK() OVER ( ORDER BY V1.charttime DESC ) AS C1 FROM ( SELECT charttime, valuenum FROM patientevents WHERE patientevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.patient_id = 2536 ) AND patientevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'address' AND items.linksto = 'patientevents' ) ) AS V1 ) AS T1 WHERE T1.C1 = 1"
17928f8215ac5734b7521160,Count the number of primary physicians who have admitted their patients to the hospital more than three times in the past year.,,"SELECT COUNT( DISTINCT dr1.pr1_id ) FROM ( SELECT dr.pr1_id, COUNT( dr.adm_id ) AS C1 FROM ( SELECT adm.pr1_id, adm.adm_id FROM admissions adm WHERE datetime(adm.adm_time,'start of year') = datetime(current_time,'start of year','-1 year') ) AS dr GROUP BY dr.pr1_id HAVING C1 > 3 ) AS dr1"
20bc21d443c654119da97d29,What are the names of the advisors of the patients classified as emergency at admission this year?,,"SELECT DISTINCT T1.advisor FROM ( SELECT T2.advisor FROM ( SELECT T1.admission_type_id, T1.patient_id FROM ( SELECT admission_type_id, patient_id FROM admissions WHERE strftime('%Y',admittime) = '2100' ) AS T1 WHERE T1.admission_type_id IN ( SELECT admission_type_id FROM admission_type WHERE admission_type = 'emergency' ) ) AS T2 JOIN ( SELECT patient_id, advisor FROM patients WHERE strftime('%Y',patients.admittime) = '2100' ) AS T1 ON T2.patient_id = T1.patient_id ) AS T1"
0ddd6dc18709a713a76158e8,Where can i find the phone number of patient 73913's guardian?,,SELECT guardian_phone FROM guardians WHERE guardian_of = 73913
da76927d0eff934f23b6003e,Can you tell me what the drug can be prescribed for patients with esoph varice oth dis nos?,,"SELECT DISTINCT T2.drug FROM ( SELECT T1.drug FROM ( SELECT drug, COUNT(*) AS C1 FROM ( SELECT drug, visit_id FROM prescriptions ) AS T GROUP BY drug ) AS T1 WHERE T1.C1 >= 3 ) AS T2 JOIN ( SELECT drug, visit_id FROM prescriptions WHERE visit_id IN ( SELECT visit_id FROM diagnoses WHERE diagnoses.label = 'esoph varice oth dis nos' ) ) AS T3 ON T2.drug = T3.drug"
a5cc39d6ea1c9729e9cb051e,Identify 10 crucial factors influencing lab tests.,,"SELECT T1.spec_type_desc FROM ( SELECT spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE labevents.valuenum IS NOT NULL GROUP BY spec_type_desc ) AS T1 WHERE T1.C1 <= 10"
73529036e49e5922c0bc40a0,Was patient 5364 signed a blood transfusion consent form?,,SELECT COUNT(*)>0 FROM blood_transfusion_consent WHERE blood_transfusion_consent.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 56 AND admissions.gender = 'male' AND admissions.dischtime IS NOT NULL AND admissions.deathtime IS NULL AND admissions.age = 56 )
7e2dcdd483a3830f19e16b07,Navigate to the pediatric wing from the main parking area.,,"SELECT DISTINCT T1.room_id FROM ( SELECT T2.room_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT T1.room_id, T1.floor_id FROM ( SELECT"
86839ccf835440d41b40bfa2,Which doctor did patient 71558 see when heshe last visited the rheumatology department?,,SELECT rheumatology.dr_name FROM rheumatology WHERE rheumatology.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = ( SELECT visits.age FROM visits WHERE visits.hadm_id = 71558 AND visits.dept = 'rheumatology' ORDER BY visits.charttime DESC LIMIT 1 ) ) ORDER BY rheumatology.charttime DESC LIMIT 1
3b19e4a9f4401f94414ae3a6,When does patient 370 end his/her flu quarantine.,,SELECT quarantine_endtime FROM quarantine WHERE quarantine_type = 'flu' AND patient_id = 370
659187a74e57637b35daa280,Look up the latest technology used in curing atrial fibrillation.,,"SELECT DISTINCT T1.treatment FROM ( SELECT T1.treatment, T2.charttime FROM ( SELECT treatment, charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'catheter ablation of atrial fibrillation' ) ) AS T1 JOIN ( SELECT treatment, charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'catheter ablation of atrial fibrillation' ) ) AS T2 ON T1.treatment = T2.treatment WHERE T1.charttime < T2.charttime ) AS T3 WHERE T3.charttime IN ( SELECT MAX(T4.charttime) FROM ( SELECT T1.treatment, T2.charttime FROM ( SELECT treatment, charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'catheter ablation of atrial fibrillation' ) ) AS T1 JOIN ( SELECT treatment, charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_ic"
5884aff3bbac9bfd0ff165a9,What is haloperidol? what is its effect?,,SELECT DISTINCT T1.effect FROM ( SELECT T2.effect FROM ( SELECT T3.effect FROM ( SELECT T4.effect FROM ( SELECT T5.effect FROM ( SELECT T6.effect FROM ( SELECT T7.effect FROM ( SELECT T8.effect FROM ( SELECT T9.effect FROM ( SELECT T10.effect FROM ( SELECT T11.effect FROM ( SELECT T12.effect FROM ( SELECT T13.effect FROM ( SELECT T14.effect FROM ( SELECT T15.effect FROM ( SELECT T16.effect FROM ( SELECT T17.effect FROM ( SELECT T18.effect FROM ( SELECT T19.effect FROM ( SELECT T20.effect FROM ( SELECT T21.effect FROM ( SELECT T22.effect FROM ( SELECT T23.effect FROM ( SELECT T24.effect FROM ( SELECT T25.effect FROM ( SELECT T26.effect FROM ( SELECT T27.effect FROM ( SELECT T28.effect FROM ( SELECT T29.effect FROM ( SELECT T30.effect FROM ( SELECT T31.effect FROM ( SELECT T32.effect FROM ( SELECT T33.effect FROM ( SELECT T34.effect FROM ( SELECT T35.effect FROM ( SELECT T36.effect FROM ( SELECT T37.effect FROM ( SELECT T38.effect FROM ( SELECT T39.effect FROM ( SELECT T40.effect FROM ( SELECT T41.effect FROM ( SELECT T42.effect FROM ( SELECT T43
4b6353ec5a31b5c1bf637734,Which ethnicity has the highest average page count?,,"SELECT T1.C1 FROM ( SELECT d_icd_procedures_long_title, AVG(i.page_count) AS C1 FROM procedures d JOIN ( SELECT icd_code, AVG(page_count) AS page_count FROM icd WHERE icd.long_title IS NOT NULL GROUP BY icd_code ) i ON d.icd_code = i.icd_code GROUP BY d_icd_procedures_long_title ) AS T1 WHERE T1.C1 = ( SELECT MAX(T2.C1) FROM ( SELECT d_icd_procedures_long_title, AVG(i.page_count) AS C1 FROM procedures d JOIN ( SELECT icd_code, AVG(page_count) AS page_count FROM icd WHERE icd.long_title IS NOT NULL GROUP BY icd_code ) i ON d.icd_code = i.icd_code GROUP BY d_icd_procedures_long_title ) AS T2 )"
f7908eda301fbcbf66fd2c26,Which are the top 10 side effects reported for drug thiamine hcl?,,"SELECT T1.valuenum FROM ( SELECT T2.valuenum, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM drug_side_effects WHERE drug_side_effects.drug = 'thiamine hcl' ) AS T1 JOIN ( SELECT * FROM patients ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.valuenum = T2.valuenum GROUP BY T2.valuenum ) AS T3 WHERE T3.C1 <= 10"
9894aa0117f387ccc3c0a4ce,What was the latest arrival time for patients yesterday?,,"SELECT DISTINCT ON (patients.id) patients.id, arrivals.arrivaltime FROM patients JOIN arrivals ON patients.id = arrivals.patientid WHERE datetime(arrivals.arrivaltime,'start of day') = datetime(current_time,'start of day','-1 day') ORDER BY patients.id, arrivals.arrivaltime DESC"
767d0e3e0e6a4254a995ac8e,What is the age of the patient who has succeeded in the most standing tackles?,,"SELECT T1.C1 FROM ( SELECT T2.C1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C2 FROM ( SELECT patient_id, standing_tackles FROM procedures_icd WHERE standing_tackles IS NOT NULL ) AS T1 JOIN ( SELECT patient_id, age FROM patients ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY T2.C1 ) AS T1 WHERE T1.C2 <= 3"
2911905f7b71dc9ee7583199,List the requesters who have ordered more than 100 hemoglobin tests.,,SELECT DISTINCT requesters FROM ( SELECT SUM(1) as C1 FROM labtests WHERE labtests.test_name = 'hemoglobin' GROUP BY labtests.requesters ) WHERE C1 > 100
03c8bb9cb2716f43621cb14b,Whose phone number is the phone number of patient 40707's guardian?,,SELECT T3.phone_number FROM ( SELECT T2.phone_number FROM ( SELECT T1.guardian FROM ( SELECT guardian FROM patients WHERE patients.id = 40707 ) AS T1 ) AS T2 WHERE T2.guardian IS NOT NULL ) AS T3 WHERE T3.guardian = ( SELECT T1.guardian FROM ( SELECT guardian FROM patients WHERE patients.id = 40707 ) AS T1 )
15266b6704cdb1f8cd452e63,How do care unit choices in icus affect patient outcomes?,,"SELECT COUNT(*) FROM patients WHERE patients.dischtime is not null AND strftime('%Y',patients.admittime) = '2100' GROUP BY patients.careunit"
4e38bd109d02c58e7d3b58fe,Call a medical supply company to order more icu equipment.,,SELECT COUNT(*)>0 FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 )
95ed91ecefd97f4f68d59794,What is the marital status that has the most patients over 30 years of age affiliated with warner brothers records?,,"SELECT T1.MaritalStatus FROM ( SELECT MaritalStatus, COUNT( DISTINCT T2.PatientID ) AS C1 FROM ( SELECT PatientID, MaritalStatus FROM d_icd_procedures WHERE PatientID IN ( SELECT PatientID FROM patients WHERE patients.Age > 30 ) ) AS T2 GROUP BY T2.MaritalStatus ) AS T1 WHERE T1.C1 = ( SELECT MAX(T3.C1) FROM ( SELECT MaritalStatus, COUNT( DISTINCT T4.PatientID ) AS C1 FROM ( SELECT PatientID, MaritalStatus FROM d_icd_procedures WHERE PatientID IN ( SELECT PatientID FROM patients WHERE patients.Age > 30 ) ) AS T4 GROUP BY T4.MaritalStatus ) AS T3 )"
9b3b15e5a997276568cf4fde,Percent of population considered pre diabetes,,SELECT DISTINCT T1.C1 FROM ( SELECT COUNT(*) / ( SELECT COUNT(*) FROM patients ) * 100 AS C1 FROM patients WHERE patients.diabetes = 'pre' ) AS T1
5c639b834d848ab32371b285,Create a budget plan for the upcoming fiscal year.,,SELECT DISTINCT T1.C1 FROM ( SELECT SUM( T2.C1 ) AS C1 FROM ( SELECT SUM( hospital_charges.cost ) AS C1 FROM hospital_charges WHERE hospital_charges.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.long_title = 'other and unspecified hyperlipidemia' ) ) AS T2 ) AS T1
be77b0162456496c3c5866e3,List the medication administrations by hwid1020 to patients.,,"SELECT COUNT(*) FROM ( SELECT DISTINCT ON ( drug ) drug FROM ( SELECT drug FROM ( SELECT drug, to_char(starttime,'YYYY-MM-DD') AS startdate FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM ( SELECT drug, starttime FROM"
7e1a9a31db03ad3e9603cf9c,When is the issue coming out?,,"SELECT DISTINCT T1.issue_date FROM ( SELECT T2.issue_date FROM ( SELECT MIN(T1.starttime) AS first_starttime FROM ( SELECT * FROM careunitevents WHERE careunitevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 60 ) ) AS T1 WHERE T1.event = 'admission' ) AS T2 ) AS T1 WHERE T1.first_starttime <= datetime(current_time,'-0 day')"
cc01a7a7a65eb126616c7e07,Did he find a person?,,SELECT COUNT(*)>0 FROM patients WHERE patients.gender = 'male'
f8c251c96bb987c5ed2076c2,"Are there identical passwords for more than two distinct patients who are older than 60? if so, list them.",,"SELECT T1.password FROM ( SELECT password, COUNT( DISTINCT patient_id ) AS C1 FROM patients WHERE age > 60 GROUP BY password ) AS T1 WHERE T1.C1 > 2"
a5ec1f13b1b903153ec55164,Whats the efficacy of metoprolol?,,"SELECT DISTINCT T1.trial_outcome FROM ( SELECT T2.trial_outcome, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, drug FROM prescriptions WHERE drug = 'metoprolol' ) AS T1 JOIN ( SELECT patient_id, trial_outcome FROM trials ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY T2.trial_outcome ) AS T1 WHERE T1.C1 <= 3"
7da5115d6880b93afe291cab,What's the end date of patient 7112's influenza quarantine?,,SELECT events.starttime FROM events WHERE events.stay_id IN ( SELECT stays.stay_id FROM stays WHERE stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 71 AND admissions.gender = 'M' AND admissions.dischtime IS NULL ) ) AND events.event_type = 'influenza quarantine' AND events.stay_id IN ( SELECT stays.stay_id FROM stays WHERE stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 71 AND admissions.gender = 'M' AND admissions.dischtime IS NULL ) ) ORDER BY events.starttime DESC LIMIT 1
c141ebc01bb9dd637c004efe,Which religion has the patient who graduated from college most recently?,,"SELECT DISTINCT T1.R Religion FROM ( SELECT T2.R, T1.PID FROM ( SELECT PID, MAX(EXTRACT(YEAR FROM AGE(CURRENT_TIME, GED)) ) AS C1 FROM GED WHERE GED.PID IN ( SELECT T3.PID FROM ( SELECT T2.PID, MAX(T2.AGE) AS C1 FROM ( SELECT PID, EXTRACT(YEAR FROM AGE(CURRENT_TIME, DOD)) AS AGE FROM DOD WHERE DOD.PID IN ( SELECT T1.PID FROM ( SELECT PID, MAX(EXTRACT(YEAR FROM AGE(CURRENT_TIME, AGE))) AS C1 FROM AGE WHERE AGE.PID IN ( SELECT T1.PID FROM ( SELECT PID, MAX(EXTRACT(YEAR FROM AGE(CURRENT_TIME, GED))) AS C1 FROM GED WHERE GED.PID IN ( SELECT T1.PID FROM ( SELECT PID, MAX(EXTRACT(YEAR FROM AGE(CURRENT_TIME, AGE))) AS C1 FROM AGE WHERE AGE.PID IN ( SELECT T1.PID FROM ( SELECT PID, MAX(EXTRACT(YEAR FROM AGE(CURRENT_TIME, GED))) AS C1 FROM GED ) AS T1 WHERE T1.C1 = EXTRACT(YEAR FROM AGE(CURRENT_TIME"
89e4e46ddc56c90d38aec205,Find the shortest path to the pharmacy from the surgery wing.,,"SELECT DISTINCT T1.path FROM ( SELECT T1_1.path FROM ( SELECT T1_1.path, DENSE_RANK() OVER ( ORDER BY LENGTH(T1_1.path) ASC ) AS C1 FROM ( SELECT array_to_string(array_agg(e1.room) OVER ( ORDER BY e1.step ), ' -> ') AS path FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1.room, e1_1.step FROM ( SELECT e1_1"
43851d9f14a559ea4100f7a1,Tell me all the tests taken in the other department by patient 7698.,,SELECT DISTINCT tests.test_name FROM tests WHERE tests.test_name IN ( SELECT other_department_tests.test_name FROM other_department_tests WHERE other_department_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 7698 ) )
9284800fd8ed3ff60873bd1c,When was the time that a patient with the highest cost billed this year?,,"SELECT T1.starttime FROM ( SELECT SUM(T2.cost) AS C1, T1.starttime FROM ( SELECT procedurecost.cost, procedures.starttime FROM procedurecost JOIN procedures ON procedurecost.row_id = procedures.row_id ) AS T2 WHERE T2.starttime >= datetime(current_time,'start of year') GROUP BY T1.starttime ) AS T1 WHERE T1.C1 = ( SELECT MAX(T2.C1) FROM ( SELECT SUM(T3.cost) AS C1, T3.starttime FROM ( SELECT procedurecost.cost, procedures.starttime FROM procedurecost JOIN procedures ON procedurecost.row_id = procedures.row_id ) AS T3 WHERE T3.starttime >= datetime(current_time,'start of year') GROUP BY T3.starttime ) AS T2 )"
dca4c06d509b190b42c230ca,What is the phone number of patient 74523's guardian?,,SELECT guardian_phone FROM guardians WHERE guardian_id IN ( SELECT guardian_id FROM patients WHERE patients.patient_id = 74523 )
84d4721f5e61842aa596dca2,"What is the relationship between temperature, pressure and volume of gas",,SELECT COUNT(*) FROM patients WHERE patients.age = 60
416572d9becf92768f378d48,"I mean, what kinds of side effects does ns have?",,SELECT DISTINCT d1.descr FROM d_icd_procedures d1 WHERE d1.icd_code = ( SELECT d2.icd_code FROM d_icd_procedures d2 WHERE d2.descr = 'ns' )
d51e3c859e3835b1c8fa2846,What is the average age of the patients with minimum humidity over 30 percent?,,"SELECT AVG(T1.C1) FROM ( SELECT V1.age FROM ( SELECT T2.age, DENSE_RANK() OVER ( ORDER BY T2.C1 ASC ) AS C1 FROM ( SELECT AVG(T3.humidity) AS C1, T2.age FROM ( SELECT V2.humidity, V1.age FROM ( SELECT V1.age, V1.subject_id FROM patients AS V1 WHERE V1.dischtime IS NOT NULL ) AS V1 JOIN ( SELECT V2.humidity, V2.age, V2.subject_id FROM ( SELECT V1.humidity, V1.age, V1.subject_id FROM ( SELECT V1.valuenum, V1.charttime, V1.age, V1.subject_id FROM ( SELECT V1.valuenum, V1.charttime FROM ( SELECT V1.valuenum, V1.charttime FROM ( SELECT V1.valuenum, V1.charttime FROM ( SELECT V1.valuenum, V1.charttime FROM ( SELECT V1.valuenum, V1.charttime FROM ( SELECT V1.valuenum, V1.charttime FROM ( SELECT V1.valuenum, V1.charttime FROM ( SELECT V1.valuenum, V1.charttime FROM ( SELECT V1"
824c344d379a08ba9b032a17,What is the average salary of the patients who believe in christianity?,,SELECT AVG(T1.C1) FROM ( SELECT SUM(P1.charges) AS C1 FROM patients P1 WHERE P1.religion = 'christianity' GROUP BY P1.age ) AS T1
9c2869cef2f1d574d7a0b07e,"Show the patient ids, arrival times, and insurance types of patients admitted for cancer this year.",,"SELECT admissions.patient_id, admissions.arrival_time, admissions.insurance FROM admissions WHERE admissions.admission_location = 'cancer' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"
ac454c98485a6e9c43e54799,Tell me of the tests patient 57050 has taken in the other department.,,SELECT COUNT(*) FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 57050 )
e55a7710442cf455cfc4ec5f,Dangling participle definition and examples,,"SELECT DISTINCT T1.tr_text FROM ( SELECT T2.tr_text FROM ( SELECT tr_id, tr_text FROM text_table WHERE rid IN ( SELECT text_table.rid FROM text_table WHERE text_table.tr_text = 'dangling participle' ) ) AS T2 JOIN ( SELECT tr_id, tr_text FROM text_table WHERE rid IN ( SELECT chartevents.rid FROM chartevents WHERE chartevents.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.long_title = 'dangling participle' ) ) ) AS T1 ON T1.tr_id = T2.tr_id )"
361609da111503a7dbd0b217,What is the average billing amount for patients with heart disease this month?,,"SELECT AVG(T1.C1) FROM ( SELECT SUM(BILLING.CHARGE) AS C1 FROM BILLING WHERE BILLING.HADM_ID IN ( SELECT DIAGNOSIS.HADM_ID FROM DIAGNOSIS WHERE DIAGNOSIS.TEXT = 'heart disease' ) AND datetime(BILLING.CHARGE_TIME,'start of month') = datetime(current_time,'start of month','-0 month') GROUP BY BILLING.HADM_ID ) AS T1"
16f036a5f4e066bfd2d904c1,Retrieve images of different care units.,,SELECT DISTINCT careunit FROM careunit WHERE careunit IS NOT NULL
1318592db6b84edfe46b7da7,Did patient 51858 fill out the consent form for ct scan?,,SELECT COUNT(*)>0 FROM consent WHERE consent.type = 'ct scan' AND consent.patient_id = 51858
3dc0f83add6ccd420290c66a,Give me a list of microbiology events where the specimen quality was poor.,,SELECT DISTINCT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.spec_quality_desc = 'poor'
ca6452d0fcc4925d5cc3bef0,When does patient 65582 come into the exc/dest intvrt disc nos process?,,SELECT exc/dest intvrt disc nos.process_start_time FROM exc/dest intvrt disc nos WHERE exc/dest intvrt disc nos.stay_id IN ( SELECT careunit_stay_map.stay_id FROM careunit_stay_map WHERE careunit_stay_map.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 65582 ) )
ca3ac69651c08b642eb672db,What are the sedative drugs being administered to patient 4401?,,SELECT DISTINCT drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 44 AND admissions.gender = 'M' AND admissions.dischtime IS NOT NULL AND admissions.age = 44 ) AND prescriptions.drug = 'sedative' AND prescriptions.hadm_id = 4401
7cbe8a357afbeaf1db568acc,Do you mean that patient 29741 filled out the consent form for a ct scan?,,SELECT COUNT(*)>0 FROM consent WHERE consent.pid = 29741 AND consent.description = 'ct scan'
cec8a6ee63266a7f01f80da2,What are the most frequently prescribed drug colors for patients over 60?,,"SELECT T3.c1 FROM ( SELECT T2.drug FROM ( SELECT T1.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM patients WHERE patients.age > 60 ) AS T1 JOIN ( SELECT * FROM prescriptions ) AS T2 ON T1.subject = T2.subject GROUP BY T2.drug ) AS T2 ) AS T3 WHERE T3.C1 <= 3"
516980a5554f33c21ca183b5,Where is the hospital located with admission id 145787?,,SELECT H.hospital_name FROM hospital H WHERE H.hospital_id IN ( SELECT A.hospital_id FROM admission A WHERE A.admission_id = 145787 )
d2916654a250739fbae2b772,Who patient 31510 saw when they last went to ophthalmology?,,SELECT ophthalmology.dr_name FROM ophthalmology WHERE ophthalmology.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = ( SELECT visits.age FROM visits WHERE visits.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT procedures.age FROM procedures WHERE procedures.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc IS NOT NULL AND microbiologyevents.valuenum = 0.0 AND microbiologyevents.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = 'I10' ) ) ) ) ) ) ORDER BY ophthalmology.charttime DESC LIMIT 1
4b91a35cb013448ab5730193,Was the average time of delay of appointments in the rheumatology department is,,"SELECT AVG(T1.C1) FROM ( SELECT T1.C1 FROM ( SELECT T1.C1, DENSE_RANK() OVER ( ORDER BY AVG(T1.C1) ASC ) AS C2 FROM ( SELECT ( J1.C1 - J1.C2 ) AS C1 FROM ( SELECT I1.C1, I1.C2 FROM ( SELECT E1.C1, E1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C"
839008d6dd9a3f492473ed16,What is the average date of death among patients who were deceased and were affiliated with sony records?,,SELECT AVG(T1.C1) FROM ( SELECT DOD FROM patients WHERE patients.DOD IS NOT NULL AND patients.affiliation = 'sony records' ) AS T1
31fe116b7574718511ae013c,List all the advisors of the patients who were younger than 21.,,"SELECT DISTINCT T1.advisor FROM ( SELECT T2.advisor FROM ( SELECT T1.admission_id, T1.age FROM ( SELECT admission_id, age FROM admissions WHERE admissions.age < 21 ) AS T1 ) AS T2 JOIN ( SELECT admission_id, advisor FROM admissions ) AS T3 ON T2.admission_id = T3.admission_id ) AS T4"
954af13d6dc7c6c533e2e63f,What are the total costs incurred on a specific billing date?,,"SELECT SUM(1 * other_charges) FROM other_charges WHERE strftime('%Y-%m-%d',other_charges.billing_date) = strftime('%Y-%m-%d',?)"
31679dede264cc93766ffc0a,Which primary physician has the patient with the highest hospital admission cost?,,"SELECT T1.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY T2.C1 DESC ) AS C2 FROM ( SELECT SUM(admissions.cost) AS C1, admissions.drug FROM admissions WHERE admissions.drug IS NOT NULL GROUP BY admissions.drug ) AS T2 ) AS T1 WHERE T1.C2 <= 3"
4e3f38b5acb14b84c19b0fa5,What did they say to him,,SELECT DISTINCT d.description FROM d_icd_procedures d WHERE d.icd_code = ( SELECT o.icd_code FROM operating_room o WHERE o.id = ( SELECT pr.operating_room_id FROM procedures pr WHERE pr.id IN ( SELECT po.procedure_id FROM procedure_occurrences po WHERE po.subject_id IN ( SELECT pt.subject_id FROM patients pt WHERE pt.age = 60 AND pt.gender = 'M' ) ) ) )
5abc9d918535d3307f61919d,Inform me of the tests that patient 95892 took in a different department.,,"SELECT DISTINCT T1.test_name FROM ( SELECT procedures_icd.test_name, procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 95892 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.charttime IN ( SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 95892 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND procedures_icd.department = ( SELECT procedures_icd.department FROM procedures_icd WHERE procedures_icd.test_name = T1.test_name AND procedures_icd.charttime = T1.charttime ) )"
697c4b98eea851000804f9fe,What is the predominant insurance type among patients who married after age 40?,,"SELECT T1.insurance_type FROM ( SELECT insurance_type, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patients.insurance_type, marriages.age FROM marriages JOIN patients ON marriages.hadm_id = patients.hadm_id WHERE marriages.age > 40 ) AS T1 GROUP BY insurance_type ) AS T2 WHERE T2.C1 = 1"
6cbfdc3d86436bf51ac20d19,Do you love being a research coordinator nurse?,,SELECT COUNT(*)>0 FROM patients WHERE patients.age = 60
9728497b208efb3fa27e2aea,How are certain word phrased?,,"SELECT DISTINCT T1.spec_type_desc FROM ( SELECT T2.spec_type_desc FROM ( SELECT T1.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT O1.spec_type_desc, DENSE_RANK() OVER ( PARTITION BY O1.order_id ORDER BY O1.starttime ) AS C2 FROM orders O1 WHERE O1.spec_type_desc IS NOT NULL ) AS T1 GROUP BY T1.spec_type_desc ) AS T2 WHERE T2.C1 <= 3 ) AS T1"
dca9a1a1b06f57335405eccb,Can you please tell me the address of patient 6580?,,SELECT DISTINCT p.address FROM patients p WHERE p.id = 6580
8d71f96fc3062598c863167a,Which primary physician has the highest patient mortality rate?,,"SELECT T3.dr_name FROM ( SELECT T2.dr_name, DENSE_RANK() OVER ( ORDER BY T2.c1 ASC ) AS C1 FROM ( SELECT T1.dr_name, AVG(C1.c1) AS c1 FROM ( SELECT T1.dr_name, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365 THEN 0 ELSE 1 END ) as c1 FROM ( SELECT patients.row_id, physicians.dr_name, chartevents.charttime FROM patients JOIN chartevents ON patients.row_id = chartevents.hadm_id JOIN physicians ON chartevents.hadm_id = physicians.hadm_id WHERE physicians.is_primarycarephysician = 1 ) AS T1 JOIN patients ON T1.row_id = patients.row_id ) AS C1 GROUP BY T1.dr_name ) AS T2 ) AS T3 WHERE T3.C1 = 1"
1a1a4662e9121b2ec51b7bf2,What is the number of patient 29971's guardian's phone?,,SELECT guardian_phone FROM patients WHERE patients.patient_id = 29971 AND patients.guardian = 'yes'
5625e6388567182df2aab97b,What is the average period of delay between appointments in the nephrology department?,,"SELECT AVG(T1.C1) FROM ( SELECT T1.C1 FROM ( SELECT T1.C1, DENSE_RANK() OVER ( ORDER BY T1.C1 ) AS C2 FROM ( SELECT ( J1.C1 - J2.C1 ) AS C1 FROM ( SELECT T1.C1, DENSE_RANK() OVER ( ORDER BY T1.C1 ) AS C2 FROM ( SELECT E1.C1 FROM ( SELECT E1.C1, E1.C2 FROM ( SELECT E1.C1, E1.C2, DENSE_RANK() OVER ( ORDER BY E1.C1 ) AS C3 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A1.C2 FROM ( SELECT A1.C1, A"
28c81639ebcda9f332d3fc94,What is the maximum number of standing tackles made by the patients older than 45 and married?,,"SELECT MAX(T1.C1) FROM ( SELECT COUNT( standing_tackles ) AS C1 FROM ( SELECT standing_tackles, patients.age, patients.marital_status FROM standing_tackles JOIN patients ON standing_tackles.person_id = patients.subject_id ) AS T WHERE T.age > 45 AND T.marital_status = 'married' GROUP BY T.person_id ) AS T1"
bfb0403b51d7349e984fe8df,What is the distribution of procedure outcomes by patient ethnicity?,,"SELECT T1.outcome, COUNT(*) FROM ( SELECT procedure_outcomes.outcome, patients.ethnicity FROM procedure_outcomes JOIN patients ON procedure_outcomes.hadm_id = patients.hadm_id WHERE patients.ethnicity IS NOT NULL ) AS T1 GROUP BY T1.outcome"
20991d9d916622645fd27567,What are the dates of graduating from college among the widowed patients who got admitted to the hospital last month?,,"SELECT DISTINCT T1.gradtime FROM ( SELECT T2.gradtime FROM ( SELECT T1.pid, T1.gradtime FROM ( SELECT admissions.pid, education.gradtime FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.admittime >= datetime(current_time,'-1 month') ) AS T1 JOIN education ON T1.pid = education.pid ) AS T2 JOIN ( SELECT admissions.pid FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.admittime >= datetime(current_time,'-1 month') ) AS T3 ON T2.pid = T3.pid WHERE T2.marital = 'widowed' ) AS T1"
eccbd9f6d3d0961bf3e2a8be,Develop a meal planning system for patients with dietary restrictions.,,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.drug = 'meal planning system for patients with dietary restrictions'
5b7e7cea6c14a66683614904,Which icu had the highest average acuity score last month?,,"SELECT T1.icu_name FROM ( SELECT icu_name, AVG(acuity_score) AS C1 FROM ( SELECT icu_stays.icu_name, diagnoses.icustay_id, diagnoses.acuity_score FROM diagnoses JOIN icu_stays ON diagnoses.icustay_id = icu_stays.icustay_id WHERE datetime(diagnoses.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 GROUP BY T1.icu_name ) AS T2 WHERE T2.C1 = ( SELECT MAX(T1.C1) FROM ( SELECT icu_name, AVG(acuity_score) AS C1 FROM ( SELECT icu_stays.icu_name, diagnoses.icustay_id, diagnoses.acuity_score FROM diagnoses JOIN icu_stays ON diagnoses.icustay_id = icu_stays.icustay_id WHERE datetime(diagnoses.charttime,'start of month') = datetime(current_time,'start of month','-1 month') ) AS T1 GROUP BY T1.icu_name ) AS T2 )"
69efee73f187a30d6812ae88,Find any images used for educating patients about their condition or treatment.,,SELECT COUNT(*)>0 FROM patient_edu_imgs WHERE patient_id = 10018081
94a005f173b3e30833a6eab8,Which antihistamine is prescribed the most?,,"SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM prescriptions WHERE drug LIKE '%antihistamine%' ) AS T1 GROUP BY drug ) AS T2 WHERE T2.C1 <= 3"
f79fa4afc09f637db912a795,What is the average number of standing tackles made by the patients whose last care unit was sicu?,,SELECT AVG(T1.C1) FROM ( SELECT COUNT( sicu_events.standing_tackle ) AS C1 FROM sicu_events WHERE sicu_events.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.dischtime IS NOT NULL ORDER BY patients.dischtime DESC LIMIT 1 ) GROUP BY sicu_events.hadm_id ) AS T1
fd92836f6e1a812c7e1d314f,What is the average number of patients assigned to each healthcare worker who administers input medication?,,SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT patients.subject_id ) AS C1 FROM patients WHERE patients.hcw_id IN ( SELECT input_medication.hcw_id FROM input_medication ) GROUP BY input_medication.hcw_id ) AS T1
e7029de5a892c70bd5f004f0,What are the top three most common procedures performed on patients with an address in san francisco?,,"SELECT d1.proc_name FROM ( SELECT d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures d WHERE d.hadm_id IN ( SELECT t1.hadm_id FROM ( SELECT admissions.hadm_id, admissions.age FROM admissions WHERE admissions.address LIKE '%san francisco%' ) AS t1 ) GROUP BY d.proc_name ) AS d1 WHERE d1.C1 <= 3"
8958f3216720fc04419d0f11,What month of the year does antihistamines the most prescribe?,,"SELECT T1.V1 FROM ( SELECT strftime('%Y-%m',prescriptions.starttime) AS V1, COUNT(*) AS C1 FROM prescriptions WHERE prescriptions.drug = 'antihistamines' GROUP BY V1 ) AS T1 WHERE T1.C1 = ( SELECT MAX(T2.C1) FROM ( SELECT strftime('%Y-%m',prescriptions.starttime) AS V1, COUNT(*) AS C1 FROM prescriptions WHERE prescriptions.drug = 'antihistamines' GROUP BY V1 ) AS T2 )"
4bf932258480b1c7ad5f00ae,What is the most popular record company among married patients?,,"SELECT T1.C1 FROM ( SELECT T2.C1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C2 FROM ( SELECT P1.pid FROM patients P1 WHERE P1.marital_status = 'married' ) AS T1 JOIN ( SELECT P2.pid, R1.record_label FROM patients P2 JOIN records R1 ON P2.hadm_id = R1.hadm_id ) AS T2 ON T1.pid = T2.pid GROUP BY T2.C1 ) AS T3 WHERE T3.C2 <= 3"
c9a38b2012537ccc81186e55,Whats the efficacy of nicardipine hcl iv?,,"SELECT DISTINCT T1.trial_outcome FROM ( SELECT T2.trial_outcome, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, drug FROM medication WHERE drug = 'nicardipine hcl iv' ) AS T1 JOIN ( SELECT patient_id, trial_outcome FROM trial_outcome ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY T2.trial_outcome ) AS T1 WHERE T1.C1 <= 3"
917badf660136cdbde3c0e4d,What is the average salary for the patients who were admitted to the micu as their last care unit?,,SELECT AVG(p1.salary) FROM ( SELECT p.salary FROM patients p WHERE p.age BETWEEN 20 AND 30 ) AS p1 WHERE p1.salary IN ( SELECT p2.salary FROM patients p2 WHERE p2.age BETWEEN 20 AND 30 AND p2.dischtime IS NOT NULL AND p2.lastcareunit = 'micu' )
0064f154fd57bb4cbaa0b873,When does patient 77676 enter into the injection oxazolidinone procedure?,,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 77676 ) AND procedures.label = 'injection oxazolidinone'
0ac5a4c0eec1c408823ecaca,List the most frequent diagnoses for elderly patients with a female next of kin.,,"SELECT d.diagnosis_desc FROM ( SELECT d.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses d WHERE d.age = 'elderly' AND d.kin = 'female' GROUP BY d.diagnosis_desc ) WHERE C1 <= 3"
16ed22149970531de6f9f3cb,Did patient 369 do a consent to a ct scan?,,SELECT COUNT(*)>0 FROM consent WHERE consent.patient_id = 369 AND consent.description = 'consent to a ct scan'
24f78921cd386503847e3682,What is hardware registration,,SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hardware registration' )
506dabdb3420e5ea3eed4cef,What is the average difference in admission duration between patients whose procedure outcomes were all 'successful' and those whose outcomes were not?,,SELECT AVG(T1.C1) FROM ( SELECT ( SELECT AVG(admission_duration) FROM ( SELECT admission_duration FROM admissions WHERE admissions.person_id IN ( SELECT procedures.person_id FROM procedures WHERE procedures.outcome = 'successful' ) ) AS T ) - ( SELECT AVG(admission_duration) FROM admissions WHERE admissions.person_id IN ( SELECT procedures.person_id FROM procedures WHERE procedures.outcome != 'successful' ) ) AS C1 FROM procedures ) AS T1
218dc5042482781a3da67df4,What is the telephone number of patient 59941's guardian?,,SELECT guardian_phone FROM guardians WHERE guardian_id IN ( SELECT guardian_id FROM patients WHERE patients.patient_id = 59941 )
626d9e416ae29a7eb7049e42,What is the average age of patients admitted this year with non-resident status?,,"SELECT AVG(age) FROM patients WHERE patients.pid IN ( SELECT admissions.pid FROM admissions WHERE admissions.admission_location = 'non-resident' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') )"
a70b6040eeb73367fcf00abb,What eye drops are available that can be prescribed for patients with dry eyes?,,"SELECT DISTINCT T3.drug FROM ( SELECT T2.drug FROM ( SELECT T1.drug FROM ( SELECT T0.drug, T0.spec_type FROM ( SELECT drug, spec_type FROM prescriptions WHERE drug = 'artificial tears' ) AS T0 WHERE T0.spec_type = 'ophthalmic' ) AS T1 JOIN ( SELECT drug, spec_type FROM prescriptions WHERE drug = 'artificial tears' ) AS T2 ON T1.drug = T2.drug WHERE T2.spec_type = 'ophthalmic' ) AS T3 JOIN ( SELECT drug, spec_type FROM prescriptions WHERE drug = 'artificial tears' ) AS T4 ON T3.drug = T4.drug WHERE T4.spec_type = 'ophthalmic' )"
436e18d4a82406b93d91929f,What medication should be prescribed to patients with glaucoma nos?,,"SELECT DISTINCT T1.drug FROM ( SELECT T2.drug, T1.charttime FROM ( SELECT charttime, subject_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'glaucoma nos' ) AS T1 JOIN ( SELECT drug, subject_id, to_timestamp('2100-01-01 00:00:00') - to_timestamp(starttime) AS dur FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT icd_code FROM icd_procedures WHERE icd_procedures.long_title = 'glaucoma nos' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime >= T2.starttime AND T1.charttime < T2.starttime + T2.dur ) AS T1"
385e641ba9f6d4f87be32048,What is the average age at the time of death for temporary resident patients?,,"SELECT AVG(T1.C1) FROM ( SELECT P1.age FROM patients P1 WHERE P1.dischtime IS NOT NULL AND strftime('%Y',P1.admittime) >= '2100' AND P1.residencestatus = 'temporary resident' ) AS T1"
99811c06ada374d0f8b22e70,Read out the short title of icd9 code 01166.,,SELECT icd9_long_title FROM icd9 WHERE icd9.icd9_code = '01166'
40fd1207a10c4190e566b432,I need to know the phone number of patient 14749's guardian.,,SELECT guardian_phone FROM guardians WHERE guardian_patient_id IN ( SELECT patient_id FROM patients WHERE patients.age = 14749 )
1f5292b27876676ec03ee3a9,What is the location of the hospital that admitted the most patients with diabetes?,,"SELECT T1.hospital FROM ( SELECT hospital, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.patient_id, admissions.hospital FROM admissions WHERE admissions.patient_id IN ( SELECT diagnoses.patient_id FROM diagnoses WHERE diagnoses.long_title = 'diabetes' ) ) AS T1 GROUP BY T1.hospital ) AS T2 WHERE T2.C1 = 1"
b8e7e0eaf1d059c2fc7ab7fe,Which doctor were patient 65309s seen when they last visited the cardiology department?,,"SELECT DISTINCT T1.c1 FROM ( SELECT T2.drname FROM ( SELECT T1.drname, DENSE_RANK() OVER ( ORDER BY T1.charttime DESC ) AS C1 FROM ( SELECT charttime, drname FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 65309 ) AND visits.spec = 'cardiology' ) AS T1 ) AS T2 WHERE T2.C1 <= 2 ) AS T1"
ff31bc2d2babbce54ba584e9,How many male patients have a female next of kin?,,SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.gender = 'male' AND patients.nextofkin IN ( SELECT relatives.pid FROM relatives WHERE relatives.gender = 'female' )
919d12332cf6d5e5cb0c8253,How many patients from the icu in 2100 have page counts higher than 10?,,"SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT icustays.pid FROM icustays WHERE icustays.icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'page count' ) AND chartevents.valuenum > 10 AND strftime('%Y',chartevents.charttime) = '2100' ) )"
d7bfaa791dff50ff50ea52c1,Apply a non-linear regression model to predict the progression of patient health status using 'chartevents'.,,SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.valuenum IS NOT NULL
4604eb882c0a085315bff78d,What is the average number of standing tackles made by patients younger than 40?,,SELECT AVG(T1.C1) FROM ( SELECT COUNT( standing_tackles.id ) AS C1 FROM standing_tackles WHERE standing_tackles.patient_id IN ( SELECT patients.id FROM patients WHERE patients.age < 40 ) GROUP BY standing_tackles.patient_id ) AS T1
2a9d088ed54aa381d9b85246,What is capital amount compared to?,,"SELECT DISTINCT T1.drug FROM ( SELECT T2.drug FROM ( SELECT T1.drug, T1.dose_val_rx FROM ( SELECT drug, dose_val_rx, DENSE_RANK() OVER ( ORDER BY dose_val_rx DESC ) AS C1 FROM ( SELECT drug, AVG(dose_val_rx) AS dose_val_rx FROM ( SELECT drug, dose_val_rx FROM prescriptions ) AS T1 GROUP BY drug ) AS T1 ) AS T1 WHERE T1.C1 <= 3 ) AS T2 ) AS T1 WHERE T1.drug = 'capital'"
c9705fb85231f3066df593cb,When does patient 80858 stop being quarantined from the influenza flu?,,SELECT DISTINCT quarantinedfrominfluenzaevents.starttime FROM quarantinedfrominfluenzaevents WHERE quarantinedfrominfluenzaevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 80858 )
f968df813578fd0c367317f1,What are the drug distribution routes used in the hospital?,,SELECT DISTINCT route FROM mimiciii.d_icd_procedures WHERE route IS NOT NULL
f73b2ce37c28f47894ee6bfe,What relationship are jessie and janet?,,SELECT DISTINCT T1.relationship FROM ( SELECT P1.relationship FROM patients P1 WHERE P1.age = ( SELECT MIN(P2.age) FROM patients P2 WHERE P2.last_name = 'jessie' ) ) AS T1 JOIN ( SELECT P3.relationship FROM patients P3 WHERE P3.age = ( SELECT MIN(P4.age) FROM patients P4 WHERE P4.last_name = 'janet' ) ) AS T2 ON T1.relationship = T2.relationship
6b781aa16f1cdc56b618c7cd,Call a research institute for information on a rare diagnosis.,,"SELECT DISTINCT T1.institution FROM ( SELECT T2.institution FROM ( SELECT T1.institution, DENSE_RANK() OVER ( ORDER BY COUNT(*) ASC ) AS C1 FROM ( SELECT * FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.long_title = 'other' ) ) AS T1 GROUP BY T1.institution ) AS T2 WHERE T2.C1 <= 3 ) AS T1"
706443292e92adc73d32d8f4,What is the gender of the first child of subject 3097?,,SELECT children.gender FROM children WHERE children.parent = 3097 AND children.age = 'newborn' ORDER BY children.charttime ASC LIMIT 1
a1b471160a18a756c9b258f3,Which antihistamine is the most,,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.charttime, T1.hadm_id FROM ( SELECT hadm_id, MIN(charttime) AS charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT T1.hadm_id FROM ( SELECT hadm_id, COUNT(*) AS C1 FROM ( SELECT hadm_id, strftime('%Y',admittime) AS year FROM admissions WHERE admissions.age = 60 ) AS T1 GROUP BY T1.hadm_id ) AS T2 WHERE T2.C1 >= 2 ) ) AS T1 ) AS T2 JOIN ( SELECT hadm_id, charttime FROM ( SELECT hadm_id, MIN(charttime) AS charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT T1.hadm_id FROM ( SELECT hadm_id, COUNT(*) AS C1 FROM ( SELECT hadm_id, strftime('%Y',admittime) AS year FROM admissions WHERE admissions.age = 60 ) AS T1 GROUP BY T1.hadm_id ) AS T2 WHERE T2.C1 >= 2 ) ) AS T1 ) AS"
c5109baf674ec23d0c5833c7,What side effects does propofol have on the body?,,"SELECT DISTINCT d1.value FROM ( SELECT t1.value, t1.starttime FROM ( SELECT unnest(procedures_icd[1].complications) AS value, procedures_icd[1].starttime FROM procedures_icd WHERE procedures_icd[1].icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.text = 'propofol' ) ) AS t1 ) AS d1"
e432536973c91611dfb80a3b,Call a rehabilitation center to arrange post-discharge care.,,SELECT COUNT(*)>0 FROM rehabilitation WHERE NOT EXISTS ( SELECT 1 FROM procedures WHERE procedures.rehab_id = rehabilitation.id AND procedures.person_id IN ( SELECT 1 FROM patients WHERE patients.age = 60 ) )
b28dc49a162520774f9b7815,What does the average mcdonald's worker make per hour,,SELECT DISTINCT salary FROM salaries WHERE job_title = 'mcdonald's worker'
a51767448d369240d4de63da,What boats need to have a throw safety ring,,"SELECT DISTINCT T1.model FROM ( SELECT T2.model FROM ( SELECT T1.model, T1.id FROM boat T1 WHERE T1.id IN ( SELECT T2.boat_id FROM boat_feature T2 WHERE T2.feature = 'throw safety ring' ) ) AS T2 GROUP BY T2.model HAVING COUNT(*) = ( SELECT COUNT(*) FROM boat_feature WHERE boat_feature.feature = 'throw safety ring' ) ) AS T1"
ccc413b763ed24bfb39994d2,Do you have an idea when patient 19428 goes into the closed bronchial biopsy procedure?,,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = '0b1c0zz' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id = 19428 AND admissions.dischtime IS NULL ) )
771c5c87039440790cb87cb1,What is the length of stay in the icu for the patient having the most standing tackles?,,"SELECT MAX(T1.C1) FROM ( SELECT SUM(1 * ( strftime('%J',admissions.outtime) - strftime('%J',admissions.intime) )) AS C1 FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.label = 'standing tackles' ) GROUP BY admissions.hadm_id ) AS T1"
82a17c445add2e20e68f48ea,What is the average age of temporary residents admitted for emergencies last month?,,"SELECT AVG(age) FROM patients WHERE patients.pid IN ( SELECT admissions.pid FROM admissions WHERE admissions.admission_location = 'emergency room' AND admissions.admission_type = 'temporary resident' AND datetime(admissions.admittime,'start of month') = datetime(current_time,'start of month','-1 month') )"
7751f8c3f1ab0e21c43a613f,What are the invoice numbers for patients with no religion?,,SELECT DISTINCT invoices.invoice_num FROM invoices WHERE invoices.patient_id IN ( SELECT patients.patient_id FROM patients WHERE patients.religion IS NULL )
2d480d93128c6d01d254b654,When does patient 8016's influenza quarantine end?,,"SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 8016 ) AND procedures.label = 'influenza quarantine' AND datetime(procedures.starttime) >= datetime(current_time,'-1 year') ORDER BY procedures.starttime DESC LIMIT 1"
b58a473dfa7c2592ff652a6c,Implement a text analysis on 'org_name' in 'microbiologyevents' to categorize organism types and their frequencies.,,"SELECT T1.org_type, COUNT(*)/1000.0 AS count_in_1000 FROM ( SELECT microbiologyevents.org_name, dictionary.org_type FROM microbiologyevents JOIN dictionary ON microbiologyevents.org_name = dictionary.org_name ) AS T1 GROUP BY T1.org_type"
ceb1b370c018763bf9d540ac,What is the procedure with the earliest consent date?,,SELECT procedures.name FROM procedures WHERE procedures.consent_date is not null ORDER BY procedures.consent_date ASC LIMIT 1
a58a76b1090ea49d378d08c7,Show the average age of patients with a female first child.,,SELECT AVG(T1.C1) FROM ( SELECT P1.age FROM patients P1 WHERE P1.gender = 'female' AND P1.first_child = 'yes' ) AS T1
65b54a9a91e26ef539c19320,What is the most common marital status among patients who graduated from their universities before 2100?,,"SELECT T1.MaritalStatus FROM ( SELECT MaritalStatus, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT Patients.MaritalStatus, Universities.GradYear FROM Patients JOIN Universities ON Patients.subject_id = Universities.subject_id WHERE Universities.GradYear < 2100 GROUP BY Patients.MaritalStatus, Universities.GradYear ) AS T1 GROUP BY T1.MaritalStatus ) AS T2 WHERE T2.C1 = 1"
01d8cc2d8140fe97026f64a1,How many patients gave consent for procedures on holidays?,,SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.procedures_holidays = true )
3384a95117cfd66b0be93cc7,What are the names of the advisors of the patients admitted to the icu yesterday?,,"SELECT DISTINCT T1.advisor FROM ( SELECT T2.advisor FROM ( SELECT T1.patient_id, T1.admission_location FROM ( SELECT patient_id, admission_location FROM admissions WHERE strftime('%Y-%m-%d',admittime) = strftime('%Y-%m-%d',current_time,'-1 day') ) AS T1 WHERE T1.admission_location = 'icu' ) AS T2 JOIN ( SELECT patient_id, advisor FROM patients WHERE strftime('%Y-%m-%d',firstvisittime) = strftime('%Y-%m-%d',current_time,'-1 day') ) AS T3 ON T2.patient_id = T3.patient_id ) AS T1"
cd1a10bb48a5d78543c8274e,Calculate the total hospital cost this year for patients with an address in san diego.,,"SELECT SUM(T1.C1) FROM ( SELECT SUM( hospital_cost ) AS C1 FROM hospital_cost WHERE hospital_cost.patient_id IN ( SELECT patients.patient_id FROM patients WHERE patients.address LIKE '%san diego%' ) AND datetime(hospital_cost.admittime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY hospital_cost.patient_id ) AS T1"
1b5b4f108d7e42aaa4f7d982,What is the average time taken for appointments to be delayed in the obstetrics and gynecology department?,,"SELECT AVG(T1.C1) FROM ( SELECT ( J1.time - J2.time ) AS C1 FROM ( SELECT visits.starttime, visits.hadm_id FROM visits WHERE visits.visitcharttime IS NOT NULL AND visits.visitcharttime >= datetime(current_time,'-1 year') ) AS J1 JOIN ( SELECT admissions.admittime, admissions.hadm_id FROM admissions WHERE admissions.admittime IS NOT NULL AND admissions.admittime >= datetime(current_time,'-1 year') ) AS J2 ON J1.hadm_id = J2.hadm_id WHERE J1.starttime > J2.admittime AND J1.starttime IS NOT NULL AND J2.admittime IS NOT NULL AND J1.starttime >= datetime(current_time,'-1 year') AND J2.admittime >= datetime(current_time,'-1 year') ) AS T1"
62dc93be504c5467fcfd7023,What are the record companies of the male patients?,,"SELECT DISTINCT T1.record_company FROM ( SELECT T2.record_company FROM ( SELECT T1.valuenum, T1.charttime, T1.hadm_id FROM ( SELECT * FROM labevents WHERE labevents.item = 'male' ) AS T1 ) AS T2 WHERE T2.valuenum = 1 ) AS T1"
e85b614de2cd2b16e98d1819,Organize a schedule for routine health check-ups of hospital staff.,,SELECT DISTINCT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT T1
6d4f5b0a77a91969a10a7ca2,How many microbiology events with excellent specimen quality have occurred since last month?,,"SELECT COUNT(*) FROM microbiologyevents WHERE specimenquality = 'excellent' AND datetime >= datetime(current_time,'start of month','-1 month')"
6cfb2f10e771a78363a1bc5c,At what age did patient 8245 get married?,,SELECT DISTINCT age FROM patients WHERE patients.subject_id = 8245 AND patients.marital_status = 'Married'
32c14dcc9df90f448106023b,What are the most common distribution routes for drugs prescribed to patients aged 65 or older?,,"SELECT T3.distribution_route FROM ( SELECT T2.distribution_route, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.drug_name, T1.distribution_route FROM ( SELECT drug_name, distribution_route, age FROM ( SELECT drug_name, distribution_route, age FROM prescriptions ) AS T1 WHERE T1.age >= 65 ) AS T2 GROUP BY T2.distribution_route ) AS T3 WHERE T3.C1 <= 3"
2db0f8c7e1cefb70047669cd,What is vertical profile,,SELECT DISTINCT d1.long_title FROM d_icd_procedures d1 WHERE d1.icd_code = ( SELECT d2.icd_code FROM d_icd_procedures d2 WHERE d2.long_title = 'vertical profile' )
20212b42562c96ba09627d57,What can be prescribed for the hyposmolality patient?,,"SELECT DISTINCT T2.drug FROM ( SELECT T1.drug, T1.spec_type FROM ( SELECT drug, spec_type FROM prescriptions WHERE spec_type = 'for hyposmolality' ) AS T1 ) AS T2"
e2998a185c87c0ba4d5fc2f7,What is the specimen quality of the most recent microbiology test done for patient 1272?,,SELECT microbiologyevents.specimentype_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 1272 ) AND microbiologyevents.specimentype_desc IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1
0ec2b830c3ca46507175024e,Can you please tell me the address of patient 23969?,,SELECT DISTINCT p.address FROM patients p WHERE p.row_id = 23969
8d2be59a2ae80a2665cee9f6,What is the longest icu stay duration for a patient with an acuity score of 10?,,SELECT MAX(icustays.outtime - icustays.intime) FROM icustays WHERE icustays.acuity_score = 10
760a949d971be61cb70b4e30,Perform a factor analysis on 'chartevents' to identify underlying relationships between various 'itemid'.,,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.itemid IN (10018081, 10018082, 10018083, 10018084, 10018085, 10018086, 10018087, 10018088, 10018089, 10018090)"
bb09a05cffc9f15b770ef908,Who did patient 6580 see when she or he last went to the oncology department.,,SELECT oncology.visits.drug FROM oncology.visits WHERE oncology.visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 6580 ) ORDER BY oncology.visits.starttime DESC LIMIT 1
7f2296fb74a26260f81ce5ed,Which doctor were patient 30228s seen when he or she last visited the urology department?,,SELECT urology.dr_name FROM urology WHERE urology.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = ( SELECT visits.age FROM visits WHERE visits.hadm_id = 30228 AND visits.dept = 'urology' ORDER BY visits.charttime DESC LIMIT 1 ) ) ORDER BY urology.charttime DESC LIMIT 1
e24c2b3af926f81b8b39d097,Identify the most common organism associated with poor specimen quality in microbiology tests.,,"SELECT T3.org_name FROM ( SELECT T2.org_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT microbiologyevents.spec_type_desc, microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.spec_quality_desc = 'poor' GROUP BY microbiologyevents.spec_type_desc, microbiologyevents.org_name ) AS T1 JOIN ( SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.spec_quality_desc = 'poor' GROUP BY microbiologyevents.spec_type_desc ) AS T2 ON T1.spec_type_desc = T2.spec_type_desc GROUP BY T2.org_name ) AS T3 WHERE T3.C1 = 1"
89b98595ecb5dd648dfff07a,What is the sum of the standing tackles made by the patients in the icu for the past year?,,"SELECT SUM(standing_tackles) FROM patients WHERE patients.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE datetime(icustays.admittime,'start of year') = datetime(current_time,'start of year','-1 year') )"
4b6a1eea90bca13f7f4efb60,Find the number of patients with a male next of kin who were treated in micu.,,SELECT COUNT( DISTINCT patients.ptid ) FROM patients WHERE patients.nextofkin = 'male' AND patients.ptid IN ( SELECT admissions.ptid FROM admissions WHERE admissions.admission_location = 'micu' )
57b1795f3ebba52457f40a4e,What is the residency status of the patient with the longest hospital stay?,,"SELECT T1.residency FROM ( SELECT T2.residency, DENSE_RANK() OVER ( ORDER BY T2.C1 DESC ) AS C2 FROM ( SELECT SUM( j1.chargetotal ) AS C1, j2.residency FROM ( SELECT SUM( j3.chargetotal ) AS chargetotal, j3.hadm_id FROM ( SELECT SUM( charges ) AS chargetotal, chartevents.hadm_id, chartevents.charttime FROM chartevents WHERE chartevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'total hospital charges' ) GROUP BY chartevents.hadm_id, chartevents.charttime ) AS j3 GROUP BY j3.hadm_id ) AS j1 JOIN ( SELECT hadm_id, residency FROM d_icd_procedures WHERE hadm_id IN ( SELECT chartevents.hadm_id FROM chartevents WHERE chartevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'total hospital charges' ) GROUP BY chartevents.hadm_id, chartevents.charttime ) ) AS j2 ON j1.hadm_id = j2.hadm_id GROUP BY j2.residency ) AS T2 WHERE T2.C2 = 1 ) AS T1"
3254e2e1ee8fe4e2b1b311bc,How many admissions had a last contact time on a weekend and were discharged to home?,,"SELECT COUNT( DISTINCT admissions.admittance_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND admissions.dischtime >= datetime(current_time,'-1 year') AND admissions.dischtime < datetime(current_time) AND admissions.dischto = 'home' AND datetime(admissions.lastcontacttime,'start of day') >= datetime(current_time,'-1 year') AND datetime(admissions.lastcontacttime,'start of day') < datetime(current_time) AND strftime('%w',admissions.lastcontacttime) in (1,7)"
08b59f00be430697b18e99ef,Did patient 72107 actually fill out the consent form for a ct scan?,,SELECT COUNT(*)>0 FROM consent WHERE consent.type = 'ct scan' AND consent.patient_id = 72107
d35ffc3f43ed6b012ff81b78,Count the number of unique hospital locations.,,SELECT COUNT( DISTINCT hospital_location ) FROM hospital_location
f0d231106f67ae20775315a0,What are the latest advancements in lab test technologies?,,"SELECT DISTINCT T1.description FROM ( SELECT T2.description, DENSE_RANK() OVER ( ORDER BY T2.year DESC ) AS C1 FROM ( SELECT P1.test_name, E1.year FROM ( SELECT procedure_name, procedure_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.description = 'lab test' ) ) AS P1 JOIN ( SELECT patient_id, procedure_name, strftime('%Y',start_time) AS year FROM procedures ) AS E1 ON P1.patient_id = E1.patient_id WHERE P1.procedure_name = E1.procedure_name ) AS T2 ) AS T1 WHERE T1.C1 <= 3"
bb25eafdbf46cbaff7655e69,What are the languages spoken by patients who married before age 30?,,"SELECT DISTINCT T1.language FROM ( SELECT T2.language FROM ( SELECT T1.hadm_id, T1.age FROM ( SELECT hadm_id, age FROM patients WHERE age < 30 ) AS T1 JOIN ( SELECT hadm_id FROM ( SELECT hadm_id, MIN(age) AS age FROM ( SELECT hadm_id, age FROM patients WHERE age < 30 ) AS T1 GROUP BY hadm_id ) AS T1 WHERE T1.age = patients.age ) AS T2 ON T1.hadm_id = T2.hadm_id ) AS T3 JOIN ( SELECT hadm_id, language FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT T3.hadm_id FROM T3 ) ) AS T4 ON T3.hadm_id = T4.hadm_id ) AS T5 GROUP BY T5.language"
0b70a63dd87a9cc3e9394bfc,What was los angeles about?,,"SELECT DISTINCT d.description FROM diagnoses d WHERE d.icd_code = ( SELECT t1.icd_code FROM ( SELECT t.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT o.icd_code, o.charttime FROM ( SELECT o.icd_code, o.charttime, o.hadm_id, ROW_NUMBER() OVER ( PARTITION BY o.hadm_id ORDER BY o.charttime DESC ) AS C1 FROM diagnoses o WHERE o.icd_code = ( SELECT t.icd_code FROM ( SELECT o.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT o.icd_code, o.hadm_id FROM diagnoses o WHERE o.icd_code = ( SELECT t1.icd_code FROM ( SELECT o.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT o.icd_code, o.hadm_id FROM diagnoses o WHERE o.icd_code = ( SELECT t1.icd_code FROM ( SELECT o.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT o.icd_code, o.hadm_id FROM diagnoses o WHERE o.icd_code = ( SELECT"
ae0f7e8f47b2f9f678c2f460,List all the salaries of the patients who got admitted to the tsicu for their first care unit.,,SELECT DISTINCT patients.salary FROM patients WHERE patients.age = 0 AND patients.gender = 'M' AND patients.admission_location = 'tsicu'
084afd2633ec15f7f471f409,What were the other styles?,,SELECT DISTINCT procedures.drug FROM procedures WHERE procedures.drug = 'other styles'
590a46e35fc2ce6e48793a18,What are the most common side effects of loperamide hcl?,,"SELECT T1.side_effect FROM ( SELECT side_effect, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT lop_side_effects.side_effect FROM lop_side_effects WHERE lop_side_effects.drug = 'loperamide hcl' ) AS T1 GROUP BY T1.side_effect ) AS T2 WHERE T2.C1 <= 3"
8c0883ba3fa949b8db01dae8,What are some eye drops that are acceptable for those with dry eye?,,SELECT DISTINCT T2.drug FROM ( SELECT T1.drug FROM ( SELECT T3.drug FROM ( SELECT T2.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1.drug FROM ( SELECT T1
db6c51e3b981690d48f9b061,Determine the most influential features for discharge location.,,"SELECT T3.feature FROM ( SELECT T2.feature, DENSE_RANK() OVER ( ORDER BY SUM(T1.discharge_location = 'home') * T2.feature_value DESC ) AS C1 FROM ( SELECT procedure_name, discharge_location FROM procedure_table WHERE procedure_name IN ( SELECT T4.procedure_name FROM ( SELECT procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedure_table GROUP BY procedure_name ) AS T4 WHERE T4.C1 <= 3 ) ) AS T1 JOIN ( SELECT procedure_name, feature, feature_value FROM procedure_feature_table ) AS T2 ON T1.procedure_name = T2.procedure_name GROUP BY T2.feature ) AS T3 WHERE T3.C1 <= 3"
f73f1dbf27ae1ba41d5baaae,What is the average number of standing tackles made by patients born after 2050?,,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.row_id ) AS C1 FROM ( SELECT patient_id, sport FROM patients WHERE strftime('%Y',patients.dob) > '2050' ) AS T1 JOIN ( SELECT patient_id, sport FROM procedures WHERE procedure = 'standing tackle' ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY T1.patient_id ) AS T1"
007c241a8e7fee7a038f792e,What are the most common procedure outcomes for patients based on their admission locations?,,"SELECT T3.Proc_out FROM ( SELECT T2.Proc_out, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.admission_location, T1.subject_id FROM ( SELECT admission_location, subject_id FROM admissions WHERE admissions.dischtime IS NOT NULL ) AS T1 JOIN ( SELECT subject_id, proc_out FROM procedures WHERE procedures.dischtime IS NOT NULL ) AS T2 ON T1.subject_id = T2.subject_id GROUP BY T1.admission_location, T1.subject_id ) AS T2 GROUP BY T2.Proc_out ) AS T3 WHERE T3.C1 <= 3"
59aeffdc0bac4c82ab171b74,How many primary physicians have been at the hospital since this year?,,"SELECT COUNT( DISTINCT primaryphysician ) FROM patients WHERE strftime('%Y',patients.admittime) = strftime('%Y',current_time)"
ff3cb10da055df7f8ad45db1,What is the address of patient 15945.,,SELECT patient_address FROM patient WHERE patient_id = 15945
4ea946f4212eca0acf044771,Which of these types of painting was more likely to have been produced by a northern renaissance,,"SELECT TOP 1 T1.C1 FROM ( SELECT T2.C1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C2 FROM ( SELECT I1.cad_id FROM images I1 WHERE I1.cad_id IN ( SELECT P1.cad_id FROM patients P1 WHERE P1.age = 30 ) ) AS T1 JOIN ( SELECT I2.cad_id, I2.label FROM images I2 WHERE I2.label = 'northern renaissance' ) AS T2 ON T1.cad_id = T2.cad_id GROUP BY T2.C1 ) AS T3 WHERE T3.C2 = 1"
09a532dd5b6e9afd19c87264,What is the adresse of patient 97395?,,SELECT patients.address FROM patients WHERE patients.id = 97395
8d1ff6c593a74a67330e7c04,"Throughout this year, what are the top five most common drugs prescribed during the same hospital encounter to female patients aged 50s after being diagnosed with epilepsy, unspecified, not intractable, without status epilepticus?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'epilepsy, unspecified, not intractable, without status epilepticus' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.row_id, T1.age, T1.gender FROM ( SELECT * FROM patients ) AS T1 WHERE T1.age BETWEEN 50 AND 59 ) AS T2 WHERE T2.gender = 'female' ) AS T3 WHERE T3.row_id IN ( SELECT T1.row_id FROM ( SELECT * FROM ( SELECT T1.row_id, T1.age, T1.gender FROM ( SELECT * FROM patients ) AS T1 WHERE T1.age BETWEEN 50 AND 59 ) AS T2 WHERE T2.gender = 'female' ) AS T1 WHERE T1.row_id IN ( SELECT T2.row_id FROM ( SELECT * FROM ( SELECT T1.row_id, T1.age, T1.gender FROM ( SELECT * FROM patients ) AS T1 WHERE T1.age BETWEEN 50 AND 59 ) AS T2 WHERE T2.gender = 'female' ) AS T1 WHERE T1.row_id IN ( SELECT T2.row_id FROM ( SELECT * FROM ( SELECT T1.row_id, T1.age, T1.gender FROM ( SELECT * FROM patients ) AS"
289be48fc696c588e5a69f9c,Pull up the IDs of patients who were diagnosed with cataract extraction status.,SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cataract extraction status' ) ),"SELECT DISTINCT patients.patient_id FROM patients WHERE patients.age >= 18 AND patients.age <= 60 AND patients.dischtime IS NOT NULL AND patients.admissiontype = 'emergency' AND patients.dischtime < datetime(current_time,'-1 year') AND patients.gender = 'male' ORDER BY patients.age ASC LIMIT 1"
8465e809028d1263318be90f,What is the difference between platelet count last measured on the first hospital visit compared to the first value measured on the first hospital visit for patient 10009628?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT platelet_count FROM laboratory_tests WHERE laboratory_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT laboratory_tests.hadm_id FROM laboratory_tests WHERE laboratory_tests.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'platelet count' ) AND laboratory_tests.valuenum IS NOT NULL ORDER BY laboratory_tests.charttime ASC LIMIT 1 ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) - ( SELECT laboratory_tests.valuenum FROM laboratory_tests WHERE laboratory_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT laboratory_tests.hadm_id FROM laboratory_tests WHERE laboratory_tests.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'platelet count' ) AND laboratory_tests.valuenum IS NOT NULL ORDER BY laboratory_tests.charttime ASC LIMIT 1 ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY laboratory_tests.charttime DESC LIMIT 1 )
c5d97a3fa6b67acc42a60f3f,How many days have passed since patient 10039831's last stay in careunit discharge lounge in this hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'discharge lounge' ORDER BY transfers.intime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT careevents.starttime FROM careevents WHERE careevents.hospitalvisid IN ( SELECT hospitalvisits.hospitalvisid FROM hospitalvisits WHERE hospitalvisits.patientid = 10039831 AND hospitalvisits.dischtime IS NULL ) AND careevents.careunit = 'discharge lounge' AND careevents.endtime IS NOT NULL ORDER BY careevents.starttime DESC LIMIT 1 ) ) )"
6c76f49427e903af86c8314e,Count the number of days since patient 10021487's first diagnosis of acute respiratory failure following trauma and surgery on this hospital visit.,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute respiratory failure following trauma and surgery' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT icd_icd_to_chapter_map.icd_code FROM icd_icd_to_chapter_map WHERE icd_icd_to_chapter_map.long_title = 'acute respiratory failure following trauma and surgery' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT icd_icd_to_chapter_map.icd_code FROM icd_icd_to_chapter_map WHERE icd_icd_to_chapter_map.long_title = 'acute respiratory failure following trauma and surgery' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id = 10021487 AND admissions.dischtime IS NULL ) ) ) ) ) ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1"
6c16600578aa6d76931a6d00,"What are the five commonly taken specimens for patients who received extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic previously during the same month since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'extirpation of matter from left lower lung lobe, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT * FROM specimens WHERE strftime('%Y',specimens.charttime) >= '2100' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5"
220a7871615e4c1a12e5cf08,Retrieve the marital status of patient 10006580 on the last hospital stay.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT marital_status FROM patients WHERE patients.pid = 10006580 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime DESC LIMIT 1
8a7a53bc8a46ea0c02865fa2,"What was the drug that patient 10004720 prescribed with during the same day after receiving introduction of nutritional substance into upper gi, via natural or artificial opening since 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT T2.drug FROM ( SELECT proceduretime, givetime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004720 ) AND procedures.label = 'introduction of nutritional substance into upper gi, via natural or artificial opening' AND strftime('%Y-%m',procedures.proceduretime) >= '2100-03' ) AS T1 JOIN ( SELECT drug, givetime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.proceduretime < T2.starttime AND datetime(T1.proceduretime,'start of day') = datetime(T2.starttime,'start of day')"
126247b40bdfae51da6c523f,How frequently was the simple excision of other lymphatic structure procedure done throughout this year?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'simple excision of other lymphatic structure' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd procedures_icd FROM icd_icd WHERE icd_icd.long_title = 'simple excision of other lymphatic structure' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
17bb906271e8d84bf499f645,How much does patient 10038999 change in mesothelial cells last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT mesothelial_cells FROM microbiologyevents WHERE microbiologyevents.hospital_visit_id IN ( SELECT MIN(hospital_visit_id) FROM hospital_visits WHERE hospital_visits.patient_id = 10038999 AND hospital_visits.dischtime IS NOT NULL ) AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_id IN ( SELECT specimens.spec_id FROM specimens WHERE specimens.hospital_visit_id IN ( SELECT MIN(hospital_visit_id) FROM hospital_visits WHERE hospital_visits.patient_id = 10038999 AND hospital_visits.dischtime IS NOT NULL ) ) ORDER BY microbiologyevents.charttime DESC LIMIT 1 ) - ( SELECT mesothelial_cells FROM microbiologyevents WHERE microbiologyevents.hospital_visit_id IN ( SELECT MIN(hospital_visit_id) FROM hospital_visits WHERE hospital_visits.patient_id = 10038999 AND hospital_visits.dischtime IS NOT NULL ) AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_id IN ( SELECT specimens.spec_id FROM specimens WHERE specimens.hospital_visit_id IN ( SELECT MIN(hospital_visit_id) FROM hospital_visits WHERE hospital_visits.patient_id = 10038999 AND hospital_visits.dischtime IS NOT NULL ) ) ORDER BY
cf75e230ba259301517169ac,What was the total output for patient 10001217 since 12/02/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-02'","SELECT SUM(output) FROM output WHERE output.stay_id IN ( SELECT stay.stay_id FROM stay WHERE stay.hadm_id IN ( SELECT hadm.hadm_id FROM hadm WHERE hadm.subject_id = 10001217 ) ) AND strftime('%Y-%m-%d',output.charttime) >= '2100-12-02'"
f8f6d23e64a92d83dd3fd151,Has there been any organism detected during the last rapid respiratory viral screen & culture microbiology test for patient 10007818 since 02/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' AND microbiologyevents.org_name IS NOT NULL AND microbiologyevents.hadm_id = 10007818 AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime DESC LIMIT 1"
02641abbf2e5bcb72ad7aedc,Please list the top five most frequent specimens tested.,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM specimens WHERE strftime('%Y',spec_date) = '2100' GROUP BY spec_type_desc ) AS T1 WHERE T1.C1 <= 5"
b472da76f7e2b4d53f38f131,"Can you tell me the last care unit patient 10003046 was in during their last hospital visit, according to the transfer record?",SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1,"SELECT T1.careunit FROM ( SELECT T2.careunit, ROW_NUMBER() OVER ( ORDER BY T2.intime DESC ) AS C1 FROM ( SELECT * FROM transferevents WHERE transferevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T2 ) AS T1 WHERE T1.C1 = 1"
52c6c669438001d194f1c9a8,What is the length of the first hospital stay in days for patient 10016742?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT strftime('%J', h1.outtime) - strftime('%J', h1.intime) FROM hospital_visits h1 WHERE h1.hadm_id IN ( SELECT h2.hadm_id FROM hospital_visits h2 WHERE h2.pid = 10016742 AND h2.dischtime IS NOT NULL ORDER BY h2.intime ASC LIMIT 1 )"
82623a9f149ae4a941d737fc,Which condition was diagnosed for patient 10006580 on the last on the last hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses.icd_code FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code IN ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND diagnoses.charttime = ( SELECT MAX(diagnoses.charttime) FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code IN ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )
7437f40a03312a89a951bf71,"For patients who had hemodialysis, what were the most frequent four microbiology tests carried out during the same hospital visit?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( hemodialysis.patient_id ) hemodialysis.charttime, hemodialysis.hadm_id FROM hemodialysis ) AS T1 JOIN ( SELECT DISTINCT ON ( microbiology_test.patient_id ) microbiology_test.test_name, microbiology_test.charttime, microbiology_test.hadm_id FROM microbiology_test ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4"
5db93544ca13afa9605c5f92,How many current patients are 30s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age BETWEEN 30 AND 39 AND patients.dischtime IS NULL
7873d7d50e05f38127c1a555,Has patient 10005866 had any type of diagnosis in this year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005866 ) AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
ec1ed057dd7ec2a55f903e6e,Calculate the number of times that patient 10004235 had lr input on 12/24/last year.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'lr' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'","SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND inputevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'lr' AND items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'"
19a51debb0c5754456d20d1f,How many medications were prescribed to patient 10022017 since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022017 ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10022017 ) AND strftime('%Y',prescriptions.starttime) >= '2100'"
0dec474abd85aab4b9b4bf61,What diagnosis did patient 10003400 receive the last time since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime DESC LIMIT 1 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses.icd_code FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10003400 ) AND strftime('%Y',diagnoses.charttime) >= '2100' ORDER BY diagnoses.charttime DESC LIMIT 1 )"
e57140ff3a3e15a2db33f62d,How much of a difference is there in patient 10006580's white blood cells second measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labresults.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'white blood cells' AND items.linksto = 'labresults' ) ORDER BY labresults.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labresults.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'white blood cells' AND items.linksto = 'labresults' ) ORDER BY labresults.charttime ASC LIMIT 1 )
18feccbb84730d8b9391bf79,"What were the top three most frequent microbiology tests that patients were given after being diagnosed with acquired absence of organ, genital organs during the same hospital encounter since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of organ, genital organs' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_time, hospital_encounter_id FROM diagnoses WHERE diagnoses.label = 'acquired absence of organ, genital organs' AND strftime('%Y',diagnoses.diagnosis_time) >= '2100' ) AS T1 JOIN ( SELECT patient_id, test_name, test_time, hospital_encounter_id FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.test_time) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_time < T2.test_time AND T1.hospital_encounter_id = T2.hospital_encounter_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3"
590d8305084857287efef413,How much did patient 10038999 weigh at their first measurement on the first hospital encounter?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT weight FROM patients_weight WHERE patients_weight.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 1 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND patients_weight.pati_id = 10038999 ORDER BY patients_weight.charttime ASC LIMIT 1
532b30aa4c94b277b88eba32,How many prescriptions were ordered for cyanocobalamin in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' AND strftime('%Y',prescriptions.starttime) = '2100'"
69356637e317ad0c9ca83dce,How many prescriptions were ordered for acetylcysteine (iv) in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine (iv)' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'acetylcysteine (iv)' AND strftime('%Y',prescriptions.starttime) = '2100'"
c2d3722d0ba8692f756e7846,What was the first diagnosis that patient 10021666 received this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses.icd_code FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = d_icd_diagnoses.icd_code ) AND strftime('%Y',admissions.admittime) = '2100' ) ORDER BY admissions.admittime ASC LIMIT 1 ) AND strftime('%Y',diagnoses.charttime) = '2100' ORDER BY diagnoses.charttime ASC LIMIT 1 )"
3857136499aee33dbb04cab5,When did patient 10038081 get the first blood (ebv) microbiology test since 16 months ago?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'blood (ebv)' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hemoglobin = 'blood (ebv)' AND microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.spec_type_desc IS NOT NULL AND microbiologyevents.patient_id = 10038081 AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1"
f3051b86c007dd34ade04ba9,When was the last time that patient 10003400 was discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10003400 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1","SELECT dischtime FROM discharge WHERE pid = 10003400 AND strftime('%Y',admittime) = '2100' ORDER BY dischtime DESC LIMIT 1"
04a4403dd1172df24786f145,Please show me the top three most usual procedures for patients aged 20s since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d1.proc_name FROM ( SELECT d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures d WHERE d.age BETWEEN 20 AND 29 AND strftime('%Y',d.charttime) >= '2100' GROUP BY d.proc_name ) AS d1 WHERE d1.C1 <= 3"
85c3e2700b75549e5f889cf1,What is the name of the medication that patient 10036156 received two or more times in their last hospital visit?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T1.drug FROM ( SELECT drug, COUNT(*) AS C1 FROM ( SELECT drug, strftime('%Y-%m-%d',presc_time) AS T1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'docusate sodium' AND prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) ) ) ) WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id = 10036156 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) GROUP BY drug, T1 ) AS T2 WHERE T2.C1 >= 2"
c16ba004a34ca12d357c16d6,How many patients in 2100 received central venous catheter placement with guidance after the reopening of recent thoracotomy site procedure within the same month?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reopening of recent thoracotomy site' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT T2.patient_id, T2.starttime FROM ( SELECT patient_id, starttime FROM procedures_icd WHERE procedures_icd.icd_code = '0bfb9' AND strftime('%Y',procedures_icd.starttime) = '2100' ) AS T1 JOIN ( SELECT patient_id, starttime FROM procedures_icd WHERE procedures_icd.icd_code = '0bfb0' AND strftime('%Y',procedures_icd.starttime) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.starttime < T2.starttime AND datetime(T1.starttime,'start of month') = datetime(T2.starttime,'start of month') ) AS T"
47fd000ef0b1033a8aabfac8,Show me the top five most frequently prescribed medications since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY drug ) AS T1 WHERE T1.C1 <= 5"
5af08ca2546f4bf6b47b14b0,Calculate the number of patients who stayed in the med/surg this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'med/surg' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') AND admissions.wardid IN ( SELECT wards.id FROM wards WHERE wards.name = 'med/surg' )"
58a17f0e9f1fb5701047c022,Did patient 10002428 come to the er during the first hospital encounter?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10002428 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*)>0 FROM emergency_room_visits WHERE emergency_room_visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10002428 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )
14a8c9364f4f7aced0b46787,How many lactated ringers prescriptions were given out since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lactated ringers' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'lactated ringers' AND strftime('%Y',prescriptions.starttime) >= '2100'"
d6d0cf531ac1d23c6fa0a6b6,What is the number of times patient 10019172 visited the hospital?,SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10019172,SELECT COUNT( DISTINCT visits.hadm_id ) FROM visits WHERE visits.person_id = 10019172
83b456769e420696daed1609,What's the diastolic blood pressure change of patient 10022281 last measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT blood_pressure_diastolic FROM patientdata WHERE patientid = 10022281 AND ICUvisit = ( SELECT MAX( ICUvisit ) FROM patientdata WHERE patientid = 10022281 ) ORDER BY charttime DESC LIMIT 1 ) - ( SELECT blood_pressure_diastolic FROM patientdata WHERE patientid = 10022281 AND ICUvisit = ( SELECT MAX( ICUvisit ) FROM patientdata WHERE patientid = 10022281 ) ORDER BY charttime ASC LIMIT 1 )
421648dc5e387538f77aee5c,How many patients were prescribed albuterol 0.083% neb soln within the same hospital visit after they were diagnosed with personal history of malignant neoplasm of prostate in 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of prostate' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'albuterol 0.083% neb soln' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, visit_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'personal history of malignant neoplasm of prostate' ) AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT patient_id, visit_id FROM procedures WHERE procedures.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.long_title = 'albuterol 0.083% neb soln' ) AND strftime('%Y',procedures.charttime) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.visit_id = T2.visit_id AND T1.charttime < T2.charttime"
3173d5e9349394956703946f,When was the last instance when patient 10021487's respiratory rate was greater than 17.0 on 12/17/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 17.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-17' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT vitalevents.charttime FROM vitalevents WHERE vitalevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) AND vitalevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'respiratory rate' AND items.linksto = 'vitalevents' ) AND vitalevents.valuenum > 17.0 AND strftime('%Y-%m-%d',vitalevents.charttime) = '2100-12-17' ORDER BY vitalevents.charttime DESC LIMIT 1"
3dd7cbf61468460681ff3c30,What were the top five most common treatments given to patients in their 60 or above since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.treatment FROM ( SELECT procedures_icd.description, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.charttime >= '2100-01-01' AND procedures_icd.age >= 60 GROUP BY procedures_icd.description ) AS T1 WHERE T1.C1 <= 5"
f18bca6a8a225c176e87417b,What's new in patient 10039831's medication list today compared to the list yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT T1.drug FROM ( SELECT drug FROM prescriptions WHERE prescriptions.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') ) AS T1 WHERE NOT EXISTS ( SELECT drug FROM prescriptions WHERE prescriptions.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day') AND T1.drug = prescriptions.drug )"
d0eb687248bca6964f140046,How many people died after being diagnosed with posttraumatic stress disorder within 2 months throughout this year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'posttraumatic stress disorder' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-0 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE ( datetime(T3.dod) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') ) OR ( datetime(T2.charttime) BETWEEN datetime(T3.dod) AND datetime(T3.dod,'+2 month') )","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.charttime FROM ( SELECT pid, charttime FROM diagnoses WHERE diagnoses.long_title = 'posttraumatic stress disorder' ) AS T1 WHERE T1.charttime >= datetime(current_time,'start of year') ) AS T1 JOIN ( SELECT pid, charttime FROM ( SELECT pid, charttime FROM diagnoses WHERE diagnoses.long_title = 'other and unspecified conditions originating in perinatal period' ) AS T2 WHERE T2.charttime >= datetime(current_time,'start of year') ) AS T2 ON T1.pid = T2.pid WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"
9f97931d5d6f4871dc6efe31,Provide the ID list of patients who were diagnosed with methicillin susceptible pneumonia due to staphylococcus aureus since 2100.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible pneumonia due to staphylococcus aureus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )",SELECT DISTINCT patients.patient_id FROM patients WHERE patients.age >= 18 AND patients.age <= 65 AND patients.dischtime IS NOT NULL AND patients.gender = 'male' AND patients.admission_location = 'emergency room' AND patients.dischtime - patients.admittime <= 1 * 365.25
7cdb91fabb7e08749637f74e,How many individuals are there who are current patients?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.dischtime IS NULL
68f60925ee10fafbe0a043b1,Is systolic blood pressure of patient 10027602 last measured on the last ICU visit greater than the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT blood_pressure_systolic FROM patientdata WHERE patientdata.patient_id = 10027602 AND patientdata.icustay_id IN ( SELECT icustay_id FROM icustays WHERE icustay_id IN ( SELECT icustay_id FROM icustays WHERE patient_id = 10027602 AND dischtime IS NOT NULL ORDER BY intime DESC LIMIT 1 ) ) ORDER BY charttime DESC LIMIT 1 ) > ( SELECT blood_pressure_systolic FROM patientdata WHERE patientdata.patient_id = 10027602 AND patientdata.icustay_id IN ( SELECT icustay_id FROM icustays WHERE icustay_id IN ( SELECT icustay_id FROM icustays WHERE patient_id = 10027602 AND dischtime IS NOT NULL ORDER BY intime DESC LIMIT 1 ) ) ORDER BY charttime ASC LIMIT 1 )
b0bde5b825a0b0039eb609d0,"Since 178 days ago, when was the mean blood pressure of patient 10005817, for the last time, observed at less than 76.0?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 76.0 AND datetime(chartevents.charttime) >= datetime(current_time,'-178 day') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT blood_pressure.mean_bp FROM blood_pressure WHERE blood_pressure.mean_bp < 76.0 AND blood_pressure.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005817 ) AND datetime(blood_pressure.charttime) >= datetime(current_time,'-178 day') ORDER BY blood_pressure.charttime DESC LIMIT 1"
55d4903b176bcfa711e73e0f,"Has patient 10006580 had any implantation or replacement of carotid sinus stimulation device, total system procedure in 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd.icd_code FROM icd WHERE icd.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd.icd_code FROM icd WHERE icd.long_title = 'implantation or replacement of carotid sinus stimulation device, total system' ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND strftime('%Y',procedures_icd.charttime) = '2100'"
ae1a61baad9fcbb6ccb57c0b,"Give me the top four most frequent diagnoses that patients were diagnosed with in the same month after being diagnosed with body mass index 35.0-35.9, adult this year.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d3.long_title FROM d3 WHERE d3.row_id IN ( SELECT T3.c3 FROM ( SELECT T2.c3, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT p1.subject_id, d1.charttime FROM diagnoses d1 JOIN patients p1 ON d1.subject_id = p1.subject_id WHERE d1.long_title = 'body mass index 35.0-35.9, adult' AND datetime(d1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT p2.subject_id, d2.charttime, d2.long_title FROM diagnoses d2 JOIN patients p2 ON d2.subject_id = p2.subject_id WHERE datetime(d2.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.c3 ) AS T3 WHERE T3.C1 <= 4 )"
5c2b95425f850cf9aee654aa,Please list the yearly average volume of stool that was output by patient 10020740 since 03/26/2100.,"SELECT AVG(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'stool' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-03-26' GROUP BY strftime('%Y',outputevents.charttime)","SELECT AVG(output) FROM stool WHERE patient_id = 10020740 AND strftime('%Y-%m-%d',stool.charttime) >= '2100-03-26' GROUP BY strftime('%Y',stool.charttime)"
82d84ee3f00fa576d3b70969,Is the anion gap level of patient 10003400 measured at 2100-06-15 05:34:00 less than the level measured at 2100-06-14 06:15:00?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-06-15 05:34:00' ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003400 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'anion gap' ) AND labevents.charttime = '2100-06-14 06:15:00' ),SELECT ( SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10003400 ) AND lab_results.item = 'anion gap' AND lab_results.charttime = '2100-06-15 05:34:00' ) < ( SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10003400 ) AND lab_results.item = 'anion gap' AND lab_results.charttime = '2100-06-14 06:15:00' )
ef3f743b0397c2df00366c56,Show me the length of stay in days of patient 10004422's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004422 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004422 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1"
4ea7d91dc5b0b0f4da0cb1c6,"Among patients who were diagnosed with anemia, unspecified since 2100, what are the top three most commonly prescribed medications that followed during the same hospital visit for patients in their 60 or above?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, visit_id FROM diagnoses WHERE diagnoses.label = 'anemia, unspecified' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT patient_id, visit_id, drug FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.visit_id = T2.visit_id AND T1.patient_id IN ( SELECT patient_id FROM patients WHERE patients.age >= 60 ) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3"
01816d54bc83e51d38259aaf,What was patient 10009628's insurance plan on their last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT DISTINCT insurance_plan FROM insurance WHERE insurance.patient_id = 10009628 AND insurance.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.patient_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )
e85f97540e562568f8795422,How many patients were treated with endoscopic control of gastric or duodenal bleeding in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic control of gastric or duodenal bleeding' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'endoscopic control of gastric or duodenal bleeding' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )"
fde016b31923066cd34bb168,What was patient 10022281's first output time of foley on 06/23/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-06-23' ORDER BY outputevents.charttime ASC LIMIT 1","SELECT foley.outputtime FROM foley WHERE foley.stdyzid IN ( SELECT stdyz.stdyzid FROM stdyz WHERE stdyz.hospid IN ( SELECT hosp.hospid FROM hosp WHERE hosp.pid = 10022281 ) ) AND strftime('%Y-%m-%d',foley.outputtime) = '2100-06-23' ORDER BY foley.outputtime ASC LIMIT 1"
e96cf491a6710c896774de33,How many people died after being diagnosed with long term (current) use of opiate analgesic during the same month during the last year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'long term (current) use of opiate analgesic' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-1 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE datetime(T2.charttime,'start of month') = datetime(T3.dod,'start of month')","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.charttime FROM ( SELECT pid, charttime FROM microbiologyevents WHERE microbiologyevents.pid IN ( SELECT diagnoses.pid FROM diagnoses WHERE diagnoses.label = 'long term (current) use of opiate analgesic' ) ) AS T1 JOIN ( SELECT pid, charttime FROM microbiologyevents WHERE microbiologyevents.pid IN ( SELECT diagnoses.pid FROM diagnoses WHERE diagnoses.label = 'other and unspecified acquired absence of brain' ) ) AS T2 ON T1.pid = T2.pid WHERE datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') ) AS T3 JOIN ( SELECT pid, charttime FROM d_icd_procedures WHERE d_icd_procedures.pid IN ( SELECT diagnoses.pid FROM diagnoses WHERE diagnoses.label = 'other and unspecified acquired absence of brain' ) ) AS T4 ON T3.pid = T4.pid WHERE datetime(T3.charttime,'start of month') = datetime(T4.charttime,'start of month') AND strftime('%Y',T3.charttime) = '2100'"
d39e6cca12842e2e3d53b7cd,What was the first measurement of patient 10013049's height since 25 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-25 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT measurements.valuenum FROM measurements WHERE measurements.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10013049 ) AND measurements.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'height' AND items.linksto = 'measurements' ) AND datetime(measurements.charttime) >= datetime(current_time,'-25 month') ORDER BY measurements.charttime ASC LIMIT 1"
b51508dd79305473d5dbaf7c,List the top three most frequent lab tests that patients were given in the same hospital visit after being diagnosed with dysphonia in 2100.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysphonia' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.labtestname FROM ( SELECT T2.labtestname, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( patient_id, diagnosis_id ) patient_id, diagnosis_id, visit_id FROM diagnoses WHERE diagnosis_id IN ( SELECT diagnosis_id FROM icd10 WHERE icd10 = 'dysphonia' ) AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT DISTINCT ON ( patient_id, labtestname, visit_id ) patient_id, labtestname, visit_id FROM labs WHERE strftime('%Y',labs.charttime) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.visit_id = T2.visit_id AND T1.diagnosis_id IS NOT NULL AND T2.labtestname IS NOT NULL AND T1.charttime < T2.charttime GROUP BY T2.labtestname ) AS T3 WHERE T3.C1 <= 3"
20db068481b9b06cc4340c25,What was patient 10018081's first procedure time since 1 year ago?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY procedures_icd.charttime ASC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND datetime(procedures.starttime) >= datetime(current_time,'-1 year') ORDER BY procedures.starttime ASC LIMIT 1"
568a32b005438f0d65d4f758,When did patient 10020786 receive the last magnesium test in their last hospital encounter?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'magnesium test' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'magnesium test' ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ORDER BY labevents.charttime DESC LIMIT 1
304589d2a4159d23de6243b4,When was the last mrsa screen microbiology test given to patient 10015272 in the last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime DESC LIMIT 1
ee759ac11ca738371bf48a9c,"Among patients in their 30s since 2100, what are the top three prescribed drugs?","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM prescription WHERE strftime('%Y',prescription.starttime) >= '2100' ) AS T1 WHERE T1.age BETWEEN 30 AND 39 GROUP BY T1.drug ) AS T2 WHERE T2.C1 <= 3"
9eda5afbe00ed4d5f058ec11,What was the last time patient 10037975 got the stool microbiology test?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND microbiologyevents.spec_type_desc = 'stool' ORDER BY microbiologyevents.charttime DESC LIMIT 1,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hospital_id = 10037975 AND microbiologyevents.spec_type_desc = 'stool' AND strftime('%Y',microbiologyevents.charttime) = '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1"
6b48b47dea05709d8dddd909,Was the calculated total co2 level of patient 10038933 last measured on the first hospital visit less than the second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calculated total co2' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT co2_total FROM patient 10038933 WHERE hospital_visit = 1 AND co2_total IS NOT NULL ORDER BY charttime DESC LIMIT 1 ) < ( SELECT co2_total FROM patient 10038933 WHERE hospital_visit = 1 AND co2_total IS NOT NULL ORDER BY charttime DESC LIMIT 1 OFFSET 1 )
bc09da3606efe6b770f6ea1f,Tell me the number of times a open heart valvuloplasty of mitral valve without replacement took place in the previous year.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open heart valvuloplasty of mitral valve without replacement' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = '00.66' AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')"
f1fc9f152b1ba46ecd03c1a6,What are the top five most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_procedures_long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT icd_code, strftime('%Y-%m-%d',outputevents.charttime) FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY icd_code, strftime('%Y-%m-%d',outputevents.charttime) ) AS T GROUP BY icd_code ) AS T1 WHERE T1.C1 <= 5 )"
883c4d0f0f9708f99cf278d8,"What was the last value of a lab test of calcium, urine in 12/this year for patient 10021487?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, urine' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.charttime DESC LIMIT 1","SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) AND lab_results.item = 'calcium, urine' AND datetime(lab_results.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',lab_results.charttime) = '12' ORDER BY lab_results.charttime DESC LIMIT 1"
8bad69864afaca5758a6aa37,Calculate the patients who received a serology/blood microbiology test since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'serology/blood' AND strftime('%Y',microbiologyevents.charttime) >= '2100' )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'serology/blood microbiology' AND strftime('%Y',procedures.charttime) >= '2100' )"
d7d78a96a2f14b1d1a909d88,"Compared to yesterday, what is new in the prescription of patient 10039831 today?","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')"
3c71f198ffca8a3ba108d583,What was the organism found in patient 10027602's first mini-bal microbiology test?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND microbiologyevents.spec_type_desc = 'mini-bal' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT mini_bal_microbiology_test.org_name FROM mini_bal_microbiology_test WHERE mini_bal_microbiology_test.hc_id IN ( SELECT visits.hc_id FROM visits WHERE visits.age = 10027602 ) AND mini_bal_microbiology_test.org_name IS NOT NULL ORDER BY mini_bal_microbiology_test.charttime ASC LIMIT 1
111dee20bbe14075c60dc939,What were the four most frequently performed lab tests since 1 year ago?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT d_labitems.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM d_labitems WHERE datetime(d_labitems.charttime) >= datetime(current_time,'-1 year') GROUP BY d_labitems.itemid ) AS T1 WHERE T1.C1 <= 4 )"
c189cadcf09e3eb65ff5c31a,What are the three commonly ordered medications for patients aged 60 or above?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT"
e0b69eb370890d55d0e2a032,What's the total amount of d5 1/2ns that patient 10038933 received on 09/26/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '09-26'",SELECT SUM(inputtotalamount) FROM inputevents WHERE inputevents.stdt LIKE '2100-09-26' AND inputevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.valuenum = 'd5 1/2ns' AND chartevents.stp = 'input' ) AND inputevents.hadm_id = 10038933
0e9be6448c82613884bebdf5,"So, what was the maximum 25-oh vitamin d value of patient 10029484 since 11/2100?","SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = '25-oh vitamin d' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-11'","SELECT MAX(labresults.valuenum) FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10029484 ) AND labresults.item = '25-oh vitamin d' AND strftime('%Y-%m',labresults.charttime) >= '2100-11'"
a63d852e13ffd03ce88b22d1,Tell me the percentile of urea nitrogen 22.0 among all patients of the same age as patient 10007928 in their last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 22.0","SELECT DISTINCT T1.C1 FROM ( SELECT C1, PERCENT_RANK() OVER ( ORDER BY C1 ) AS C2 FROM ( SELECT urea_nitrogen FROM patient10007928_last_visit_labtests WHERE patient10007928_last_visit_labtests.age = ( SELECT age FROM patient10007928_last_visit WHERE patient10007928_last_visit.patient_id = patient10007928 ) ) ) AS T1 WHERE T1.urea_nitrogen = 22.0"
51978c2653bcfbd2cc8c5eae,"How many people received a introduction of nutritional substance into upper gi, via natural or artificial opening procedure within the same month after they had been diagnosed with postprocedural pneumothorax since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural pneumothorax' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM diagnoses WHERE diagnoses.long_title = 'postprocedural pneumothorax' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT subject_id, charttime FROM procedures WHERE procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' AND strftime('%Y',procedures.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') ) AS T3"
84b9e35f62f23089ad08f03e,How much of a difference is there in patient 10035185's mean blood pressure last measured on the first ICU visit compared to the second to last value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),"SELECT ( SELECT mean_bp FROM patient10035185_icu1 WHERE strftime('%Y-%m-%d %H:%M:%S',charttime) = ( SELECT MAX(strftime('%Y-%m-%d %H:%M:%S',charttime)) FROM patient10035185_icu1 ) ) - ( SELECT mean_bp FROM patient10035185_icu1 WHERE strftime('%Y-%m-%d %H:%M:%S',charttime) = ( SELECT MIN(strftime('%Y-%m-%d %H:%M:%S',charttime)) FROM patient10035185_icu1 WHERE strftime('%Y-%m-%d %H:%M:%S',charttime) < ( SELECT MAX(strftime('%Y-%m-%d %H:%M:%S',charttime)) FROM patient10035185_icu1 ) ) )"
a89804f008cd45087c9507d1,What treatment did patient 10039997 undergo last since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY procedures_icd.charttime DESC LIMIT 1 )","SELECT procedures.name FROM procedures WHERE procedures.chartevents_charttime >= datetime(current_time,'-1 year') AND procedures.chartevents_rowid IN ( SELECT chartevents.rowid FROM chartevents WHERE chartevents.chartevents_hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.admissions_subject_id = 10039997 ) ) ORDER BY procedures.chartevents_charttime DESC LIMIT 1"
15a83f8dbbf6d2243721a87b,"How many patients underwent single internal mammary-coronary artery bypass during the same month after the diagnosis with arthropathy, unspecified, lower leg, in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'arthropathy, unspecified, lower leg' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, diagnosis_time FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'arthropathy, unspecified, lower leg' ) AND strftime('%Y',diagnoses.diagnosis_time) = '2100' ) AS T1 JOIN ( SELECT patient_id, procedure_time FROM procedures WHERE procedures.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'single internal mammary-coronary artery bypass' ) AND strftime('%Y',procedures.procedure_time) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_time < T2.procedure_time AND datetime(T1.diagnosis_time,'start of month') = datetime(T2.procedure_time,'start of month')"
e57e3f80e3cc0a3b1a3c509c,How many patients in 2100 underwent radical excision of other lymph nodes within the same hospital visit after reopening of recent thoracotomy site?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reopening of recent thoracotomy site' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'radical excision of other lymph nodes' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T1.visit_id FROM ( SELECT subject_id, procedure_occurrence_id, visit_id FROM procedure_occurrence WHERE procedure_occurrence.procedure_desc = 'reopening of recent thoracotomy site' AND strftime('%Y',procedure_occurrence.charttime) = '2100' ) AS T1 JOIN ( SELECT subject_id, procedure_occurrence_id, visit_id FROM procedure_occurrence WHERE procedure_occurrence.procedure_desc = 'radical excision of other lymph nodes' AND strftime('%Y',procedure_occurrence.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.visit_id = T2.visit_id AND T1.procedure_occurrence_id < T2.procedure_occurrence_id ) AS T3"
24612cf5da1e8c7c6a9fca8f,Was the SaO2 of patient 10021487 ever greater than 97.0 on 12/12/2100?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 97.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-12-12'","SELECT COUNT(*)>0 FROM oxygen saturation pulseoxymetry WHERE pulseoxymetry.valuenum > 97.0 AND pulseoxymetry.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) AND strftime('%Y-%m-%d',pulseoxymetry.charttime) = '2100-12-12'"
4ee164f320c671cddad63aa1,How many people received a prescription for dextromethorphan-guaifenesin (sugar free) throughout this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'dextromethorphan-guaifenesin (sugar free)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND admissions.admittime >= datetime(current_time,'start of year','-0 year') AND admissions.admittime < datetime(current_time,'start of year','-0 year')+1 year AND admissions.subject_id IN ( SELECT prescriptions.subject_id FROM prescriptions WHERE prescriptions.drug = 'dextromethorphan-guaifenesin (sugar free)' AND prescriptions.starttime >= datetime(current_time,'start of year','-0 year') AND prescriptions.starttime < datetime(current_time,'start of year','-0 year')+1 year )"
dbc270289021529e6623ca58,How many patients were treated with closed [percutaneous] [needle] biopsy of kidney since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [percutaneous] [needle] biopsy of kidney' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'closed [percutaneous] [needle] biopsy of kidney' AND strftime('%Y',procedures.charttime) >= '2100' )"
1252ececdb40065ab2ab716c,"For patients who had bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach, what were the most frequent four microbiology tests carried out within 2 months?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( patient_id ) patient_id, procedures.starttime FROM procedures WHERE procedures.procedure_name = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' ) AS T1 JOIN ( SELECT DISTINCT ON ( patient_id ) patient_id, microbiologytests.starttime FROM microbiologytests ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.starttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.starttime) AND datetime(T1.starttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4"
c5d46b43685ecc76f23dd1be,Pull up the IDs of patients who were diagnosed with chronic systolic heart failure in this year.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic systolic heart failure' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT DISTINCT patients.patient_id FROM patients WHERE patients.patient_id IN ( SELECT diagnoses.patient_id FROM diagnoses WHERE diagnoses.diag_icd_code = ( SELECT icd_icd_code FROM icd WHERE icd.long_title = 'chronic systolic heart failure' ) AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )"
6726244ef1bd924f703f788d,What was the name of the drug which was prescribed to patient 10018501 within the same hospital visit after having received alcohol detoxification in 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'alcohol detoxification' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedure_occurences.charttime, procedure_occurences.hadm_id FROM procedure_occurences WHERE procedure_occurences.label = 'alcohol detoxification' AND procedure_occurences.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',procedure_occurences.charttime) = '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of visit') = datetime(T2.starttime,'start of visit')"
1baa3b9b6dd6b0bd2c74ac95,How much is the total hospital cost of patient 10020187 during the stay in 2100?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND strftime('%Y',cost.chargetime) = '2100'","SELECT SUM( hospital_charges.chart_charges ) FROM hospital_charges WHERE hospital_charges.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020187 ) AND strftime('%Y',hospital_charges.charttime) = '2100'"
2b5707d23faf1d54bc3688c3,"On their first hospital visit, what was the age of patient 10022880?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022880 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT age FROM patients WHERE patients.age IS NOT NULL AND patients.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age IS NOT NULL AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND patients.pid = 10022880
6affdda52b5c91cdefb3ac90,Is patient 10027602's free calcium second measured on the last hospital visit less than the value first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT free_calcium FROM laboratory_tests WHERE laboratory_tests.person_id = 10027602 AND laboratory_tests.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.person_id = 10027602 AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.person_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND laboratory_tests.charttime IN ( SELECT procedures.charttime FROM procedures WHERE procedures.person_id = 10027602 AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.person_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ORDER BY laboratory_tests.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT free_calcium FROM laboratory_tests WHERE laboratory_tests.person_id = 10027602 AND laboratory_tests.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.person_id = 10027602 AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.person_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND laboratory_tests.charttime IN ( SELECT procedures
71fb7280916537b48dea629f,How many times was patient 10020786 admitted to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10020786 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT( DISTINCT admissions.admission_id ) FROM admissions WHERE admissions.patient_id = 10020786 AND strftime('%Y',admissions.admittime) >= '2100'"
59b3e090a55110929fc25079,Provide me with the five most common diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.diagnosis_desc FROM diagnosis d WHERE d.charttime IN ( SELECT T1.charttime FROM ( SELECT diagnosis.charttime, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnosis GROUP BY diagnosis.charttime ) AS T1 WHERE T1.C1 <= 5 )"
4e79db3380f81126bc756ee5,What is the difference between mchc second measured on the last hospital visit compared to the first value measured on the last hospital visit for patient 10007928?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT mchc FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.pid = 10007928 ) ORDER BY labresults.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT mchc FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.pid = 10007928 ) ORDER BY labresults.charttime ASC LIMIT 1 )
5706937d471c979d44b7c441,Calculate the number of patients who were prescribed senna.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'senna' ),SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT prescriptions.pid FROM prescriptions WHERE prescriptions.drug = 'senna' )
8389d7126b22d44dfa24365b,Has patient 10037928 received a diagnosis in 2100?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037928 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10037928 ) AND strftime('%Y',diagnoses.charttime) = '2100'"
0b01e88a1ff2627ccad33628,What is the number of times patient 10014729 visited the hospital in 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10014729 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT( DISTINCT visits.visit_id ) FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10014729 ) AND strftime('%Y',visits.admittime) = '2100'"
a999623358b249c2ff668390,How many current patients are there aged 60 or above?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age >= 60 AND patients.dischtime IS NULL
20c3ddd36c65c44890c3f3e5,What was the name of the specimen test that patient 10021666 was given for the first time since 03/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT tests.spec_name FROM tests WHERE tests.spec_type IN ( SELECT procedures.spec_type FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021666 ) ) AND strftime('%Y-%m',tests.charttime) >= '2100-03' ORDER BY tests.charttime ASC LIMIT 1"
7edc30d3b6fa3b7308ebcd4a,How many medications were ordered for patient 10021118 since 10/2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10'","SELECT COUNT(*) FROM orders WHERE orders.stay_id IN( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND orders.order_type = 'medication' AND strftime('%Y-%m',orders.starttime) >= '2100-10'"
ce4170ef70617d0f660eb8c8,Can you show me the top four most frequent lab tests given?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.test_name FROM ( SELECT lab_tests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM lab_tests GROUP BY lab_tests.test_name ) AS T1 WHERE T1.C1 <= 4"
8a081d0fa8a2b464096d8a00,What is the total or cell saver intake amount that patient 10009628 received on 10/02/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009628 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '10-02'","SELECT SUM(or_intakeamount) FROM or_intakeevents WHERE or_intakeevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10009628 ) AND or_intakeevents.or_intake = 'or or other intake' AND datetime(or_intakeevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',or_intakeevents.starttime) = '10-02'"
694ef79b1e8ab1b548efa5b3,Has patient 10018423 received any lab testing in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y',labevents.charttime) = '2100'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018423 ) AND strftime('%Y',labevents.charttime) = '2100'"
d69a4b8b51374de9e093dde2,How many hours have passed since patient 10004733 stayed in the careunit medicine on this hospital visit for the first time?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medicine' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', careunit_stays.starttime) ) FROM careunit_stays WHERE careunit_stays.hospital_visit_id IN ( SELECT hospital_visits.hospital_visit_id FROM hospital_visits WHERE hospital_visits.patient_id = 10004733 AND hospital_visits.dischtime IS NULL ) AND careunit_stays.careunit = 'medicine' ORDER BY careunit_stays.starttime ASC LIMIT 1"
5b35d8420b2779eaf3c7e3ea,List the top four most frequent diagnoses that patients received within 2 months after previously being diagnosed with other candidiasis of other specified sites since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other candidiasis of other specified sites' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d1.long_title FROM ( SELECT d2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM diagnosis WHERE datetime >= datetime(current_time,'-1 year') ) AS d1 JOIN ( SELECT * FROM diagnosis WHERE datetime >= datetime(current_time,'-1 year') ) AS d2 ON d1.person_id = d2.person_id WHERE d1.long_title = 'other candidiasis of other specified sites' AND d2.datetime BETWEEN d1.datetime AND datetime(d1.datetime,'+2 month') GROUP BY d2.long_title ) WHERE C1 <= 4"
a5356c6c205e9f088964bb9a,Has patient 10006580 received any medication?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ),SELECT COUNT(*)>0 FROM po WHERE po.sta = 'completed' AND po.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10006580 )
706439ddb58cfc688a427d97,"This year, what were the top four specimens that were tested frequently?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT T1.spec_type_desc FROM ( SELECT spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM specimens WHERE datetime(sdate,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY spec_type_desc ) AS T1 WHERE T1.C1 <= 4"
06b14b6b3b8637569dd435d9,Show me the top five diagnoses that have the highest 3-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT patients.row_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN patients ON diagnoses.hadm_id = patients.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses.charttime) >= 1 * 365/4 ) AS T1 JOIN patients ON T1.row_id = patients.row_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )"
6d23077db7dbc8321431bf64,How many days have passed since the patient 10004733 was admitted to the hospital?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J',admissions.admittime) ) FROM admissions WHERE admissions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10004733 AND admissions.dischtime IS NULL )"
68e2938f96286a982888a1f6,"Which was the last care unit patient 10007928 was in during their last hospital visit, as per the transfer record?",SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1,"SELECT T1.careunit FROM ( SELECT T2.careunit, ROW_NUMBER() OVER ( ORDER BY T2.intime DESC ) AS C1 FROM ( SELECT * FROM transferevents WHERE transferevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T2 ) AS T1 WHERE T1.C1 = 1"
7f71c9d84ae065b57a659660,How many current patients are there aged 40s?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.age BETWEEN 40 AND 49 AND patients.dischtime IS NULL
0d71c66d0ead111e4df731dd,How much is the maximum total hospital bill that includes personal history of malignant neoplasm of large intestine since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM( hospital_charges.total_charges ) AS C1 FROM hospital_charges WHERE hospital_charges.hospital_visit_id IN ( SELECT diagnoses.hospital_visit_id FROM diagnoses WHERE diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND strftime('%Y',hospital_charges.admittime) >= '2100' GROUP BY hospital_charges.hospital_visit_id ) AS T1"
fc9a1a57bacdb774ac5e8f68,What was the admission type for patient 10023117 during their first hospital visit?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10023117 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = 10023117 AND visits.dischtime IS NOT NULL ORDER BY visits.admittime ASC LIMIT 1 )
7f07c59357750ac2b84e5221,"What are the five frequently taken specimens for patients that received extirpation of matter from lung lingula, via natural or artificial opening endoscopic previously within 2 months?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from lung lingula, via natural or artificial opening endoscopic' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, procedure_date FROM procedures_icd WHERE procedures_icd.icd_code = '0jg0jz' ) AS T1 JOIN ( SELECT patient_id, spec_type_desc, specimen_date FROM specimens ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.procedure_date < T2.specimen_date AND datetime(T2.specimen_date) BETWEEN datetime(T1.procedure_date) AND datetime(T1.procedure_date,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5"
105c5b90ad1c402ff786e8bc,What's the cost of the drug known as ferrous sulfate (liquid)?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)' ),SELECT DISTINCT cost FROM drug_cost WHERE drug_name = 'ferrous sulfate (liquid)'
60f1ca714f709dd6094e453e,What was the insurance that patient 10015931 had during the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT insurance FROM insurance WHERE insurance is NOT NULL AND patient = 10015931 AND hospital_encounter_id IN ( SELECT hospital_encounter_id FROM hospital_encounter WHERE patient = 10015931 AND discharge_date IS NOT NULL ORDER BY admission_date ASC LIMIT 1 )
1252e7fd85be60431814be4f,"What is the cost for a procedure of introduction of other therapeutic substance into peripheral artery, percutaneous approach?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach' ) )","SELECT DISTINCT cost FROM procedure_cost WHERE procedure_cost.procedure_description = 'introduction of other therapeutic substance into peripheral artery, percutaneous approach'"
89a0d1e183a1c2a585f69c0d,When did patient 10016742 last receive a diagnosis of non-st elevation (nstemi) myocardial infarction on the first hospital stay?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'non-st elevation (nstemi) myocardial infarction' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1,SELECT diagnoses.charttime FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND diagnoses.long_title = 'non-st elevation (nstemi) myocardial infarction' ORDER BY diagnoses.charttime DESC LIMIT 1
0f76c11ee2ae038677e63102,"How many patients received a osmolality, measured test last year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, measured' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'osmolality, measured' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )"
e7d00371c9b3a702661b3704,Did patient 10040025 have any kind of diagnosis last year?,"SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10040025 ) AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-1 year')"
681c6fc772c7eda308578ae6,What are the three most frequent drugs prescribed to female patients with an age of 20s within the same month after they were diagnosed with unspecified acquired hypothyroidism?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified acquired hypothyroidism' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age BETWEEN 20 AND 29 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'unspecified acquired hypothyroidism' ) AS T1 JOIN ( SELECT patient_id, drug, prescription_date FROM prescriptions ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.prescription_date AND datetime(T1.diagnosis_date,'start of month') = datetime(T2.prescription_date,'start of month') AND T1.patient_id IN ( SELECT patient_id FROM patients WHERE patients.gender = 'female' AND floor(patients.age / 10) = 2 ) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3"
09304caba4fd05450a56c2af,How much does a procedure called percutaneous abdominal drainage cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) ),SELECT DISTINCT cost FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'percutaneous abdominal drainage' )
9fc0ac6b29d8a361fd6e2512,How much does patient 10007058 change in SaO2 second measured on the first ICU visit compared to the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT SaO2 FROM patient10007058_icustay1_obscurv WHERE ord = 2 ) - ( SELECT SaO2 FROM patient10007058_icustay1_obscurv WHERE ord = 1 )
3813f972b07ceee5031bb452,Did patient 10021666 receive a diagnosis during their last hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*)>0 FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT encounters.hadm_id FROM encounters WHERE encounters.dischtime IS NOT NULL ORDER BY encounters.admittime DESC LIMIT 1 ) AND diagnoses.person_id = 10021666
770cb760820f25921dc8ac4a,"How much does a thyroxine (t4), free lab test cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroxine (t4), free' ) )","SELECT DISTINCT cost FROM lab_cost WHERE lab_test = 'thyroxine (t4), free'"
aeb4b3e5ce8038a370e1e7c1,Count the number of patients who underwent a microbiological mini-bal test since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'mini-bal' AND strftime('%Y',microbiologyevents.charttime) >= '2100' )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'microbiological mini-bal' AND strftime('%Y',procedures.charttime) >= '2100' )"
f356b6267c56b07e1f3e3045,What was the last time that patient 10035185 had the minimum value of the systolic blood pressure?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum ASC, chartevents.charttime DESC LIMIT 1",SELECT chartevents.charttime FROM chartevents WHERE chartevents.stdiastolic = ( SELECT MIN( chartevents.stdiastolic ) FROM chartevents WHERE chartevents.stay_id IN ( SELECT stays.stay_id FROM stays WHERE stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10035185 ) ) )
5a67eba88dd963170a026d15,What was the dose of glipizide xl patient 10029484 was prescribed?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND prescriptions.drug = 'glipizide xl',SELECT DISTINCT glipizide xl dose FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10029484 )
915a29cc5d0d25f775a9230e,How many duloxetine prescription cases were there since 1 year ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'duloxetine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'duloxetine' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')"
d04f4cfbfef7a7f69d8969eb,"What are the three most commonly prescribed drugs for patients who were diagnosed with personal history of tobacco use previously in the same month, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'personal history of tobacco use' AND datetime(diagnoses.diagnosis_date) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT patient_id, drug, prescription_date FROM prescriptions WHERE datetime(prescriptions.prescription_date) >= datetime(current_time,'-1 year') ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.prescription_date AND datetime(T1.diagnosis_date,'start of month') = datetime(T2.prescription_date,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3"
612ad1a0d94b49abf371be2f,"How often was the bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach procedure carried out since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = '02.21' AND strftime('%Y',procedures_icd.charttime) >= '2100'"
b4dc074ecd304bf634371924,What are the five most frequently prescribed medications for patients in their 40s since 2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT * FROM prescriptions ) AS T WHERE T.age BETWEEN 40 AND 49 ) AS U GROUP BY drug ) AS T1 WHERE T1.C1 <= 5"
14c735141eaad27a37dfacce,Has any lab tests occurred for patient 10026406 since 01/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026406 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-01'","SELECT COUNT(*)>0 FROM lab_tests WHERE lab_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10026406 ) AND strftime('%Y-%m',lab_tests.charttime) >= '2100-01'"
facfb8f560238eb16739c85e,Did patient 10015860 receive a lymphocytes test on their first hospital visit?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lymphocytes' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*)>0 FROM laboratoryevents WHERE laboratoryevents.valuenum IS NOT NULL AND laboratoryevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND laboratoryevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'lymphocytes' ) )
bdd039b89d9bf57a1d3c4e49,"What are the three most common microbiology tests for people who were diagnosed with malignant neoplasm of lower third of esophagus earlier in the same hospital encounter, since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of lower third of esophagus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( patient_id, diagnosis_id ) patient_id, diagnosis_id, hospital_encounter_id FROM diagnoses WHERE diagnosis_id = ( SELECT diagnosis_id FROM icd_diagnoses WHERE icd_diagnoses.icd_code = 'c15.3' ) AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT DISTINCT ON ( patient_id, microbiology_test_name ) patient_id, microbiology_test_name, hospital_encounter_id FROM microbiology_tests WHERE strftime('%Y',microbiology_tests.charttime) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_id IS NOT NULL AND T1.hospital_encounter_id = T2.hospital_encounter_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3"
b2e898b5d1ad3e826001b202,"In 03/this year, what organism was found in patient 10029291's last stool test?","SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND microbiologyevents.spec_type_desc = 'stool' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '03' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT stool_test.org_name FROM stool_test WHERE stool_test.hc_id IN ( SELECT microbiology_test.hc_id FROM microbiology_test WHERE microbiology_test.org_name IS NOT NULL AND microbiology_test.spec_type_desc = 'stool' AND microbiology_test.hc_id = 10029291 AND strftime('%Y-%m',microbiology_test.charttime) = '2103' ORDER BY microbiology_test.charttime DESC LIMIT 1 )"
99499e3fc35e16828a79d7f6,"How many patients received omeprazole within 2 months after the confirmation of ""personal history of tobacco use"" in 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'omeprazole' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT T1.patient_id, T1.charttime FROM ( SELECT patient_id, charttime FROM microbiologyevents WHERE patient_id IN ( SELECT patient_id FROM d_icd_procedures WHERE icd_code = 'personal history of tobacco use' ) AND strftime('%Y',charttime) = '2100' ) AS T1 JOIN ( SELECT patient_id, charttime FROM medicationevents WHERE medication = 'omeprazole' AND strftime('%Y',charttime) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') ) AS T"
e1bef8005f669f8fa7a1e3bf,What are the most commonly prescribed drugs given to patient 10021312 twice?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 = 2","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT proceduretime, patientid FROM procedures WHERE patientid = 10021312 ) AS T1 JOIN ( SELECT drugstarttime, drug, patientid FROM prescriptions WHERE patientid = 10021312 ) AS T2 ON T1.patientid = T2.patientid WHERE T1.proceduretime < T2.drugstarttime AND datetime(T1.proceduretime,'start of day') = datetime(T2.drugstarttime,'start of day') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 2"
2e3384d7ef9a76c0237df519,Tell me patient 10026354's first measured heart rate.,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT heart_rate FROM vitalevents WHERE patient_id = 10026354 AND measuredtime = ( SELECT MIN(measuredtime) FROM vitalevents WHERE patient_id = 10026354 )
1bdf02ef77df577cf44deaee,"Since 2100, how many patients were discharged from the hospital?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'"
f195f5a0d57e12581afdc61c,When did patient 10004457 first get discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004457 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime ASC LIMIT 1","SELECT strftime('%Y-%m-%d',to1.dischtime) FROM ( SELECT from1.dischtime FROM ( SELECT * FROM hospital_visits WHERE hospital_visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004457 ) ) AS from1 WHERE from1.dischtime IS NOT NULL ORDER BY from1.dischtime ASC LIMIT 1 ) AS to1"
2f8aa4c9687c9ee0880c3746,"Since 1 year ago, what are the top four most commonly taken specimens for patients within 2 months after the diagnosis of encounter for immunization?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for immunization' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM mimiciii_diagnoses WHERE diagnos_is_icd_code = 'Z0231' ) AS T1 JOIN ( SELECT patient_id, spec_type_desc, collection_date FROM mimiciii_specimens ) AS T2 ON T1.patient_id = T2.patient_id WHERE datetime(T1.diagnosis_date) >= datetime(current_time,'-1 year') AND datetime(T2.collection_date) >= datetime(T1.diagnosis_date) AND datetime(T2.collection_date) < datetime(T1.diagnosis_date,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4"
fd9b2daa83ce099cdf252c35,Has there been any procedure that patient 10022880 had in this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.person_id = 10022880 AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
515f28b68da1d15cb0208181,Please list the five most common procedures carried out since 1 year ago.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d1.procedure_name FROM ( SELECT procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime >= datetime(current_time,'-1 year') GROUP BY procedure_name ) AS d1 WHERE d1.C1 <= 5"
b710f2ea6d630a9c88a40fc2,What was the name of the prescription drug that patient 10017492 was prescribed last in 04/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10017492 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10017492 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '04' ORDER BY prescriptions.starttime DESC LIMIT 1"
9a53c5a84a90577e106b30ec,"In the first hospital visit, what was patient 10016150's last procedure time?",SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime DESC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures.starttime DESC LIMIT 1
536ad0999a00344e2a06c8a9,How much was patient 10013049 charged to pay for the cost of their hospital stay during the first hospital visit?,SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT SUM(T1.C1) FROM ( SELECT CHARGES.cost FROM CHARGES WHERE CHARGES.hadm_id IN ( SELECT HADM.hadm_id FROM HADM WHERE HADM.age = ( SELECT MIN(HADM.age) FROM HADM WHERE HADM.pid = 10013049 AND HADM.dischtime IS NOT NULL ) ) ) AS T1
b71bf47188930e8abb1e562f,When was patient 10036156's last procedure conducted in this year?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10036156 ) AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures.starttime DESC LIMIT 1"
c47c43f5d2824c6b2c4f54fe,List the top five most frequent procedures performed since 2100.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d1.procedure_name FROM ( SELECT procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedure_name ) AS d1 WHERE d1.C1 <= 5"
92448b3c2bb324d7cc5a35f9,"Show me the top five most commonly prescribed drugs within 2 months for patients in their 60 or above after a thrombocytopenia, unspecified diagnosis since 2100.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'thrombocytopenia, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.row_id, T1.charttime FROM ( SELECT * FROM diagnosis WHERE diagnosis = 'thrombocytopenia, unspecified' ) AS T1 WHERE strftime('%Y',T1.charttime) >= '2100' ) AS T2 JOIN ( SELECT * FROM ( SELECT T1.row_id, T1.charttime FROM ( SELECT * FROM patients WHERE patients.age >= 60 ) AS T1 JOIN ( SELECT * FROM diagnosis WHERE diagnosis = 'thrombocytopenia, unspecified' ) AS T2 ON T1.row_id = T2.row_id WHERE strftime('%Y',T2.charttime) >= '2100' ) AS T3 ON T2.row_id = T3.row_id WHERE T2.charttime < T3.charttime AND datetime(T3.charttime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') ) AS T4 ON T2.row_id = T4.row_id ) AS T5 ON T4.row_id = T5.row_id GROUP BY T2.drug ) AS T6 WHERE"
503c1a271385c7a9c485a82a,Can you tell me the top four most common procedures since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d1.proc_name FROM ( SELECT d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures d WHERE datetime(d.admittime) >= datetime(current_time,'-1 year') GROUP BY d.proc_name ) AS d1 WHERE d1.C1 <= 4"
c511f734e9fd03e177de1e9c,Was any sputum microbiology test done to patient 10026255 on their last hospital visit?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum',SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'sputum'
ac0594e7c1c0b61c1072e703,What were the top five most common output events since 2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE strftime('%Y',outputevents.charttime) >= '2100' GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_procedures.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM d_icd_procedures WHERE strftime('%Y',d_icd_procedures.charttime) >= '2100' GROUP BY d_icd_procedures.icd_code ) AS T1 WHERE T1.C1 <= 5 )"
4779807de491caeb560e846d,Can you tell me the top five most common microbiology tests that occurred in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.test_name FROM ( SELECT microbiologytests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologytests WHERE strftime('%Y',microbiologytests.charttime) = '2100' GROUP BY microbiologytests.test_name ) AS T1 WHERE T1.C1 <= 5"
809a2e5b92679e748ad8312c,"What was the maximum monthly number of patients diagnosed with surgical operation with implant of artificial internal device as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure in 2100?","SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'surgical operation with implant of artificial internal device as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM ( SELECT subject_id, strftime('%Y-%m',diagnoses.charttime) FROM diagnoses WHERE diagnoses.long_title = 'surgical operation with implant of artificial internal device as the cause of abnormal reaction of the patient, or of later complication, without mention of misadventure at the time of the procedure' ) AS T2 WHERE strftime('%Y',T2.charttime) = '2100' GROUP BY T2.subject_id, T2.charttime ) AS T1 GROUP BY T1.charttime"
5da6b605b949e3c4c068537e,When did patient 10039831 first receive a mrsa screen microbiological test in 12/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id = 10039831 AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1"
727aea1d64b5ba869e4b3dc8,What was the total dose of bisacodyl that patient 10025463 has been prescribed in their first hospital visit?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'bisacodyl',SELECT SUM(bisacodyl.total_daily_dose) FROM bisacodyl WHERE bisacodyl.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bisacodyl' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) )
82ee3d9b301ac0cf74fc8be8,Could you tell me the marital status of patient 10006580 during their first hospital visit?,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT marital_status FROM patients WHERE patients.id = 10006580 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1
97f99846bf73b8acd7a1318e,How many medicines were prescribed since 4 months ago to patient 10014354?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-4 month')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10014354 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-4 month')"
c2ca78801b0bb755ec80903e,"Which care unit did patient 10004235 last enter since 2100, as recorded in the transfer record?","SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND transfers.careunit IS NOT NULL AND strftime('%Y',transfers.intime) >= '2100' ORDER BY transfers.intime DESC LIMIT 1","SELECT T1.careunit FROM ( SELECT T2.careunit, DENSE_RANK() OVER ( ORDER BY T2.intime DESC ) AS C1 FROM ( SELECT careunit, intime FROM transferevents WHERE transferevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004235 ) AND strftime('%Y',intime) >= '2100' ) AS T2 ) AS T1 WHERE T1.C1 = 1"
c31c4e310562d4a9cc9837f1,Could you tell me how many patients were given phytonadione last year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'phytonadione' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND admissions.dischtime >= datetime(current_time,'start of year','-1 year') AND admissions.dischtime < datetime(current_time,'start of year') AND admissions.subject_id IN ( SELECT prescriptions.subject_id FROM prescriptions WHERE prescriptions.drug = 'phytonadione' AND prescriptions.starttime >= datetime(current_time,'start of year','-1 year') AND prescriptions.starttime < datetime(current_time,'start of year') )"
7d5fe035bb44c9237b17dfe5,"Was patient 10031757 prescribed on their first hospital visit heparin flush (10 units/ml), enoxaparin sodium, or vancomycin?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'heparin flush (10 units/ml)', 'enoxaparin sodium', 'vancomycin' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'heparin flush (10 units/ml)', 'enoxaparin sodium', 'vancomycin' )"
350a9469b2c148343a897fc7,Tell me the top four most common diagnoses for patients with age 30s since 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d.diagnosis_desc FROM ( SELECT T1.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT p.id, d.diagnosis_desc FROM diagnoses d JOIN patients p ON d.hadm_id = p.hadm_id WHERE p.age BETWEEN 30 AND 39 AND strftime('%Y',d.charttime) >= '2100' ) AS T1 GROUP BY T1.diagnosis_desc ) AS D1 WHERE D1.C1 <= 4"
4b635ac1325eaf0dd75988d5,"In 04/last year, has patient 10001725 been prescribed with pantoprazole, albuterol 0.083% neb soln, or propranolol?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND prescriptions.drug IN ( 'pantoprazole', 'albuterol 0.083% neb soln', 'propranolol' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10001725 ) AND prescriptions.drug IN ( 'pantoprazole', 'albuterol 0.083% neb soln', 'propranolol' ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'"
81eff335d1116d8fed074540,Give me the top three most common diagnoses for patients of age 60 or above since 1 year ago.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d.diagnosis_desc FROM ( SELECT d.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses d WHERE d.age >= 60 AND datetime(d.charttime) >= datetime(current_time,'-1 year') GROUP BY d.diagnosis_desc ) WHERE C1 <= 3"
b33541a90c84005891412b3c,What is the count of prescriptions for guaifenesin since 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' AND strftime('%Y',prescriptions.starttime) >= '2100'"
c996bd83ae8f43a3717a6f64,"How many times did patient 10002495 have irrigation of genitourinary tract using irrigating substance, via natural or artificial opening since 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'irrigation of genitourinary tract using irrigating substance, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd.icd_code FROM icd WHERE icd.long_title = 'irrigation of genitourinary tract using irrigating substance, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10002495 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'"
71b23a88bad2ea2f52f12b02,"Among patients who were prescribed with phenytoin infatab, what are the top five most frequently prescribed drugs at the same time in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'phenytoin infatab' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.row_id, T1.drug FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT *"
b05a0cc27584db59d2dc4a8b,What was the length of stay in days for patient 10020944's last hospitalization?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","SELECT strftime('%J', hout.time) - strftime('%J', hin.time) FROM hospital_visits AS hv WHERE hv.hadm_id IN ( SELECT h.hadm_id FROM hospitals AS h WHERE h.age = 10020944 AND h.dischtime IS NOT NULL ORDER BY h.admittime DESC LIMIT 1 ) AND hv.dischtime IS NOT NULL ORDER BY hv.admittime DESC LIMIT 1"
55712c5df13d0dbf402229f5,What were the first outputs of patient 10019917 since 01/19/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019917 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-19' ORDER BY outputevents.charttime ASC LIMIT 1 )","SELECT outputs.output FROM outputs WHERE outputs.patient_id = 10019917 AND strftime('%Y-%m-%d',outputs.charttime) >= '2100-01-19' ORDER BY outputs.charttime ASC LIMIT 1"
7066a7025a2c0442a511c5e1,What was patient 10015272's first SaO2 since 203 days ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-203 day') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT SaO2 FROM oxygenationevents WHERE patient_id = 10015272 AND datetime >= datetime(current_time,'-203 day') ORDER BY datetime ASC LIMIT 1"
3d5c7c8185dc079c5e416e14,What was the first time patient 10040025 had the minimum platelet count value in 03/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10040025 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10040025 ) AND labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'platelet count' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1"
04ca1a97c725954eac35669a,"When was the last time patient 10018501 was diagnosed with gout, unspecified?","SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gout, unspecified' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT diagnoses.charttime FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018501 ) AND diagnoses.long_title = 'gout, unspecified' ORDER BY diagnoses.charttime DESC LIMIT 1"
88a650d28643d60da24b7b3f,What was the last recorded height for patient 10006580 during the first hospital encounter?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT visits.stay_id FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'daily weight' AND items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1
5984482bf8b3c03a9225ea58,What was the diagnosis of patient 10005866 for the first time on their last hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1 ),SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses.icd_code FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = 'd_icd_diagnoses.icd_code' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses.charttime ASC LIMIT 1 )
eefb26cc5bd74a549f823166,What is the monthly minimum volume of void that patient 10014354 had since 10/06/2100?,"SELECT MIN(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-10-06' GROUP BY strftime('%Y-%m',outputevents.charttime)","SELECT MIN(voids.volume) FROM voids WHERE voids.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10014354 ) AND strftime('%Y-%m-%d',voids.charttime) >= '2100-10-06' GROUP BY strftime('%Y-%m',voids.charttime)"
4fee25cd21a51a255f3f5bcf,What is the name of the prescription drug that patient 10037861 has been given two or more times since 8 months ago?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-8 month') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T1.drug FROM ( SELECT drug, COUNT(*) AS C1 FROM ( SELECT drug, strftime('%J',presc_time) AS time FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10037861 ) AND datetime(presc_time) >= datetime(current_time,'-8 month') ) AS T1 GROUP BY T1.drug ) AS T2 WHERE T2.C1 >= 2"
2c613ae6f06d69d93196637f,When was the first time patient 10027602 had attention deficit disorder with hyperactivity diagnosed on their first hospital encounter?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'attention deficit disorder with hyperactivity' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1,SELECT diagnoses.charttime FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND diagnoses.long_title = 'attention deficit disorder with hyperactivity' ORDER BY diagnoses.charttime ASC LIMIT 1
9aff84dfbc8d4cb85bb5267f,"How much does patient 10038999 change in calcium, total second measured on the last hospital visit compared to the first value measured on the last hospital visit?","SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) ORDER BY labevents.charttime ASC LIMIT 1 )","SELECT ( SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT lab_results.hadm_id FROM lab_results WHERE lab_results.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'calcium, total' ) AND lab_results.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) ORDER BY lab_results.charttime ASC LIMIT 1 ) ) AND lab_results.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'calcium, total' ) ORDER BY lab_results.charttime ASC LIMIT 1 ) - ( SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND lab_results.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd"
888427e0689a6de5a4d37211,Give me the top four most common diagnoses.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d.diagnosis_desc FROM diagnosis d WHERE d.charttime IN ( SELECT T1.charttime FROM ( SELECT diagnosis.charttime, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnosis GROUP BY diagnosis.charttime ) AS T1 WHERE T1.C1 <= 4 )"
e6edc67f5259e8f507389a29,"How many patients received a total nucleated cells, pleural test in this year?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total nucleated cells, pleural' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT labevents.patients_pid FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'total nucleated cells, pleural' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )"
919f039cb4f4fe92f49e7c86,How many current patients belong to the 30s age category?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 30 AND 39,SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age BETWEEN 30 AND 39 AND patients.dischtime IS NULL
5287cbacaf23b703a8551d1c,"For patients who received a encephalopathy, unspecified diagnosis in 2100, which five medications were usually prescribed afterward in the same month?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encephalopathy, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'encephalopathy, unspecified' AND strftime('%Y',diagnoses.diagnosis_date) = '2100' ) AS T1 JOIN ( SELECT patient_id, drug, prescription_date FROM prescriptions WHERE strftime('%Y',prescriptions.prescription_date) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.prescription_date AND datetime(T1.diagnosis_date,'start of month') = datetime(T2.prescription_date,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
15b4990f761db52edf38273c,How many days have passed since the last time that patient 10021487 had received a hemoglobin lab test during the current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT itemid FROM d_icditems WHERE d_icditems.long_title = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.hadm_id IN ( SELECT events.hadm_id FROM events WHERE events.event_type = 'admission' AND events.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.hadm_id IN ( SELECT events.hadm_id FROM events WHERE events.event_type = 'admission' AND events.person_id = 10021487 ) ) ) ) ) ) AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1"
30cdb06c3381ee1320dc4738,"What is the maximum hospital cost for the hospital visits that included scoliosis [and kyphoscoliosis], idiopathic?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'scoliosis [and kyphoscoliosis], idiopathic' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM( hospital_charges.cost ) AS C1 FROM hospital_charges WHERE hospital_charges.hospital_visit_id IN ( SELECT diagnoses.hospital_visit_id FROM diagnoses WHERE diagnoses.long_title = 'scoliosis [and kyphoscoliosis], idiopathic' ) GROUP BY hospital_charges.hospital_visit_id ) AS T1"
7af6a3a42f264bdbbfb7c37a,Is the value of diastolic blood pressure of patient 10018081 measured at 2100-12-31 23:00:00 greater than it is measured at 2100-12-31 22:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-31 23:00:00' ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-31 22:00:00' ),SELECT ( SELECT diastolic_blood_pressure FROM patient_vitals WHERE patient_id = 10018081 AND datetime = '2100-12-31 23:00:00' ) > ( SELECT diastolic_blood_pressure FROM patient_vitals WHERE patient_id = 10018081 AND datetime = '2100-12-31 22:00:00' )
dfc058cc8e8d30a29c0177b9,"After being diagnosed with thrombocytopenia, unspecified , how many patients received a diagnosis of chronic airway obstruction, not elsewhere classified during the same hospital visit?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'thrombocytopenia, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic airway obstruction, not elsewhere classified' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, hadm_id FROM diagnoses WHERE diagnoses.label = 'thrombocytopenia, unspecified' ) AS T1 JOIN ( SELECT patient_id, hadm_id FROM diagnoses WHERE diagnoses.label = 'chronic airway obstruction, not elsewhere classified' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.hadm_id = T2.hadm_id"
eeabf0257400d59cb3803434,Count the number of patients that were admitted to the hospital in this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"
9b70f7f7a60a0c7994cc0ea0,List the top five most common diagnoses for patients in their 20s throughout this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.diagnosis_desc FROM ( SELECT d.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses d WHERE d.age BETWEEN 20 AND 29 AND datetime(d.admittime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY d.diagnosis_desc ) WHERE C1 <= 5"
3dcbbb6159d03af90b56b98f,"What are the top five most frequent medications prescribed within 2 months to the patients in their 50s after they were diagnosed with cerebral artery occlusion, unspecified with cerebral infarction this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral artery occlusion, unspecified with cerebral infarction' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'cerebral artery occlusion, unspecified with cerebral infarction' AND strftime('%Y',diagnoses.diagnosis_date) = '2100' ) AS T1 JOIN ( SELECT patient_id, drug, prescription_start_time FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.diagnosis_date) AND datetime(T1.diagnosis_date,'+2 month') AND T1.age BETWEEN 50 AND 59 GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
826d1ec55b9cb1dcd3714ce0,What's the minimum total hospital charged for a visit with a white blood cells lab test since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'white blood cells' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM( CHARGES.CHARGE ) AS C1 FROM CHARGES WHERE CHARGES.HADM_ID IN ( SELECT LABEVENTS.HADM_ID FROM LABEVENTS WHERE LABEVENTS.ITEMID IN ( SELECT LABITEMS.ITEMID FROM LABITEMS WHERE LABITEMS.LABTEST = 'white blood cells' ) ) AND datetime(CHARGES.CHARGE_DATE) >= datetime(current_time,'-1 year') GROUP BY CHARGES.HADM_ID ) AS T1"
6938557cc42ba52caf388bef,Calculate the aggregate sum for patient 10005909's input since 02/12/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-12'","SELECT SUM(input) FROM patient10005909_input WHERE strftime('%Y-%m-%d',inputtime) >= '2100-02-12'"
61a3d12ba8e762f3b53709cd,What were the top five microbiology tests most frequently performed since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.test_name FROM ( SELECT microbiologytests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologytests WHERE strftime('%Y',microbiologytests.charttime) >= '2100' GROUP BY microbiologytests.test_name ) AS T1 WHERE T1.C1 <= 5"
70d14dce56962dcc9931c667,What are the methods for ingesting phenytoin sodium?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'phenytoin sodium',SELECT DISTINCT instructions FROM phenytoin_sodium WHERE instructions IS NOT NULL
ee8306d4a542175197a6d200,What was the maximum value for patient 10009049's specific gravity?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ),SELECT MAX(lab_results.valuenum) FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10009049 ) AND lab_results.item = 'specific gravity'
844c677f9eb40b4cc09e828a,How many times did patient 10001217 check into the ICU?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ),SELECT COUNT(1) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10001217 )
f8c059d6d1b2b47b1fe1c76d,Retrieve the top five most frequently prescribed drugs since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY drug ) AS T1 WHERE T1.C1 <= 5"
817d23cea9de1a0e459a25c3,"How much is a bilirubin, indirect lab test?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, indirect' ) )","SELECT DISTINCT cost FROM cost WHERE cost.event_type = 'lab test' AND cost.event_id = ( SELECT lab_test_id FROM lab_tests WHERE lab_tests.name = 'bilirubin, indirect' )"
672d81cda5b780896726e4f2,When was patient 10015860's respiratory rate less than 21.0 for the first time since 06/06/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 21.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-06' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT vitalevents.charttime FROM vitalevents WHERE vitalevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10015860 ) AND vitalevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'respiratory rate' AND items.linksto = 'vitalevents' ) AND vitalevents.valuenum < 21.0 AND strftime('%Y-%m-%d',vitalevents.charttime) >= '2100-06-06' ORDER BY vitalevents.charttime ASC LIMIT 1"
2b7276378eab1b3d2a5dbc38,How much total input has patient 10014354 received in the last ICU stay?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ),SELECT SUM(input.totalamount) FROM input WHERE input.stay_id IN ( SELECT careunit.stay_id FROM careunit WHERE careunit.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10014354 ) AND careunit.careunitid = ( SELECT careunit.careunitid FROM careunit WHERE careunit.description = 'intensive care unit' ) ORDER BY careunit.intime DESC LIMIT 1 )
af50a318710cad0b74d80aa6,"What is the average total hospital cost when it involves diastolic heart failure, unspecified in 2100?","SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diastolic heart failure, unspecified' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM( hospital_charges.cost ) AS C1 FROM hospital_charges WHERE hospital_charges.hospital_visit_id IN ( SELECT diagnoses.hospital_visit_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.icd_name = 'diastolic heart failure, unspecified' ) ) AND strftime('%Y',hospital_charges.chargetime) = '2100' GROUP BY hospital_charges.hospital_visit_id ) AS T1"
d00ed2cfc1975f9b13bcf1f9,What diagnoses were the latest recorded for patient 10015860?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),"SELECT d.diagnoses FROM diagnoses d WHERE d.hadm_id IN ( SELECT t1.hadm_id FROM ( SELECT o.hadm_id, o.charttime FROM other o WHERE o.studysite = 'mimic' AND o.hadm_id IN ( SELECT p.hadm_id FROM patients p WHERE p.age = 10015860 ) ORDER BY o.charttime DESC LIMIT 1 ) AS t1 )"
0c4dd3081cb0d0d1bacad045,What was the total hospital cost for patient 10025612's stay on their last hospital visit?,SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT SUM( hospital_cost ) FROM hospital_cost WHERE hospital_cost.hospital_id IN ( SELECT hospital_visit.hospital_id FROM hospital_visit WHERE hospital_visit.patient_id = 10025612 AND hospital_visit.dischtime IS NOT NULL ORDER BY hospital_visit.admittime DESC LIMIT 1 )
391ecf976f96659f09f26269,What's the price for lamotrigine?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'lamotrigine' ),"SELECT DISTINCT T1.C1 FROM ( SELECT R1.chargetype, R1.cost FROM ( SELECT P1.chargetype, V1.cost FROM ( SELECT E1.chargetype FROM ( SELECT D1.chargetype FROM ( SELECT C1.chargetype FROM ( SELECT B1.chargetype FROM ( SELECT A1.chargetype FROM ( SELECT DISTINCT A1.chargetype FROM procedure_icd A1 WHERE A1.icd_code = ( SELECT procedure_icd.icd_code FROM procedure_icd WHERE procedure_icd.long_title = 'other enteral infusion of concentrated nutritional substances' ) ) UNION SELECT DISTINCT B1.chargetype FROM ( SELECT A1.chargetype, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT procedure_icd.icd_code, procedure_icd.chargetype FROM procedure_icd WHERE procedure_icd.long_title = 'other enteral infusion of concentrated nutritional substances' ) AS A1 GROUP BY A1.chargetype ) AS B1 WHERE B1.C1 <= 3 ) ) AS C1 UNION SELECT DISTINCT D1.chargetype FROM ( SELECT A1.chargetype, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT procedure"
20e38a034dc27e9626dfa8d9,"Which care unit did patient 10014078 first enter since 2100, based on the transfer record?","SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 ) AND transfers.careunit IS NOT NULL AND strftime('%Y',transfers.intime) >= '2100' ORDER BY transfers.intime ASC LIMIT 1","SELECT T1.careunit FROM ( SELECT T2.careunit, DENSE_RANK() OVER ( ORDER BY T2.intime ASC ) AS C1 FROM ( SELECT careunit, intime FROM transferevents WHERE transferevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10014078 ) AND strftime('%Y',intime) >= '2100' ) AS T2 ) AS T1 WHERE T1.C1 = 1"
48b62fcb80cf1fee53b8bfb1,What was the total volume of input that patient 10018081 received on this ICU visit?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ),SELECT SUM(input.totalamount) FROM input WHERE input.stay_id IN ( SELECT visit_stay_id FROM visit WHERE visit.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND visit.dischtime IS NULL )
d2d7d8b52a277ffa44cfb072,Please tell me patient 10019777's sex.,SELECT patients.gender FROM patients WHERE patients.subject_id = 10019777,SELECT patients.gender FROM patients WHERE patients.id = 10019777
f1ca5e6021ac2bbdb6b7e7bf,Is respiratory rate of patient 10000032 last measured on the first ICU visit greater than the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT respiratory_rate FROM patient10000032_icustays_otherdata WHERE icustay_id IN ( SELECT icustay_id FROM patient10000032_icustays WHERE stay_id IN ( SELECT stay_id FROM patient10000032_stays WHERE visits = 1 ) ) ORDER BY charttime DESC LIMIT 1 ) > ( SELECT respiratory_rate FROM patient10000032_icustays_otherdata WHERE icustay_id IN ( SELECT icustay_id FROM patient10000032_icustays WHERE stay_id IN ( SELECT stay_id FROM patient10000032_stays WHERE visits = 1 ) ) ORDER BY charttime ASC LIMIT 1 )
2dfc862bcecf1f1b2c037bc9,When did patient 10007818 receive a glucose laboratory test for the first time in 07/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07' ORDER BY labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'glucose laboratory test' ) AND labevents.hadm_id = 10007818 AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07' ORDER BY labevents.charttime ASC LIMIT 1"
d8c4bcdab05c48a114af4957,Calculate the total number of outputs from patient 10027602 since 06/22/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-22'","SELECT SUM(outputs.total) FROM outputs WHERE outputs.stay_id IN ( SELECT stays.stay_id FROM stays WHERE stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10027602 ) ) AND strftime('%Y-%m-%d',outputs.charttime) >= '2100-06-22'"
7c2a2d33722d9a5b379010ff,What new drugs have been prescribed to patient 10018081 today compared to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')"
1b49fcb3998703d3dd37e81e,"What is the average total cost of the hospital, which includes the procedure named other incision of pleura?",SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other incision of pleura' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.C1) FROM ( SELECT SUM( CHARGE ) AS C1 FROM CHARGES WHERE CHARGES.HADM_ID IN ( SELECT PROCEDURES.HADM_ID FROM PROCEDURES WHERE PROCEDURES.PROC_NAME = 'other incision of pleura' ) GROUP BY CHARGES.HADM_ID ) AS T1
828f43dc5831cb08e5ce4ac8,When was patient 10015931 first prescribed a medication via the po/ng route since 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10015931 ) AND prescriptions.route = 'po/ng' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1"
3f3b727d5effabd567b64400,Give me the top four most commonly prescribed medications in the same month to the patients aged 50s after they were diagnosed with non-st elevation (nstemi) myocardial infarction throughout this year.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'non-st elevation (nstemi) myocardial infarction' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'non-st elevation (nstemi) myocardial infarction' AND datetime(diagnoses.diagnosis_date,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient_id, drug, prescription_start_time FROM prescriptions WHERE datetime(prescriptions.prescription_start_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.prescription_start_time AND datetime(T1.diagnosis_date,'start of month') = datetime(T2.prescription_start_time,'start of month') AND T1.patient_id IN ( SELECT patient_id FROM patients WHERE patients.age BETWEEN 50 AND 59 ) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4"
8f037d1cedf499b333e3a25d,When was the first microbiological test of patient 10015931 performed during this month?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id = 10015931 AND datetime(microbiologyevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY microbiologyevents.charttime ASC LIMIT 1"
6d1e9f74415d70381cffcd18,Has patient 10021938 had a procedure since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.person_id = 10021938 AND strftime('%Y',procedures_icd.charttime) >= '2100'"
df9daf11c602ac48c88b8f7b,"Count the number of patients who had arterial catheterization in the same month after having been diagnosed with osteoarthrosis, localized, not specified whether primary or secondary, pelvic region and thigh in 2100.","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'osteoarthrosis, localized, not specified whether primary or secondary, pelvic region and thigh' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, datetime(diagnoses.charttime,'2100') FROM diagnoses WHERE diagnoses.long_title = 'osteoarthrosis, localized, not specified whether primary or secondary, pelvic region and thigh' AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT patient_id, datetime(procedures.charttime,'2100') FROM procedures WHERE procedures.long_title = 'arterial catheterization' AND strftime('%Y',procedures.charttime) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')"
09963a1437aa17e27738f18a,What are the four most commonly received procedures for patients in their 30s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d1.proc_name FROM ( SELECT d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures d WHERE d.age BETWEEN 30 AND 39 AND datetime(d.charttime) >= datetime(current_time,'-1 year') GROUP BY d.proc_name ) AS d1 WHERE d1.C1 <= 4"
a69440dfa419dc0ff7d88b64,Tell me the total dose of metoprolol succinate xl that patient 10020944 was prescribed in 03/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND prescriptions.drug = 'metoprolol succinate xl' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '03'","SELECT SUM(drug_doses.value) FROM drug_doses WHERE drug_doses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020944 ) AND drug_doses.drug = 'metoprolol succinate xl' AND datetime(drug_doses.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',drug_doses.starttime) = '03'"
ffcf49b4d60d6ba61111c10d,"On last month/17, what was the average of heart rate for patient 10006053?","SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '17'",SELECT AVG(o2 saturation pulseoxymetry) FROM patient 10006053 WHERE datetime >= datetime('2100-04-17 00:00:00') AND datetime < datetime('2100-04-18 00:00:00')
9eefd9e726c081549a74f486,How many current patients are 60 or above?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT( DISTINCT patients.subject_id ) FROM patients WHERE patients.age >= 60 AND patients.dischtime IS NULL
8a56f098370ca6af99a28b53,What was the last prescribed dose of simvastatin that patient 10015860 got in the first hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'simvastatin' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT simvastatin.dose_val_rx FROM simvastatin WHERE simvastatin.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'simvastatin' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY simvastatin.starttime DESC LIMIT 1
6e7e6e42109e147a8c37d95d,"What was the last rbc, ascites lab test result for patient 10005866 in their last hospital visit?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rbc, ascites' ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT labresults.hadm_id FROM labresults WHERE labresults.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'rbc, ascites' ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'rbc, ascites' ) ORDER BY labresults.charttime DESC LIMIT 1"
4ec97f169fd8ebe7a00e3ec0,Provide the ID list of patients who were diagnosed with unspecified sleep apnea in 2100.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sleep apnea' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT DISTINCT patients.patient_id FROM patients WHERE patients.patient_id IN ( SELECT diagnoses.patient_id FROM diagnoses WHERE diagnoses.icd_code = '780.57' AND strftime('%Y',diagnoses.charttime) = '2100' )"
a652507fb99040108907976b,What was the total of patients discharged from hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is NOT NULL
0d6e154c99ea7aa10dc0ac5c,What is the amount of albumin 25% that patient 10025612 received?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ),SELECT SUM(input.amount) FROM input WHERE input.item = 'albumin 25%' AND input.stay_id IN ( SELECT stay.stay_id FROM stay WHERE stay.patient_id = 10025612 )
7bb4dd3032dd60767f552577,Has patient 10006580 had any medication since 13 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-13 month')","SELECT COUNT(*)>0 FROM medication WHERE medication.patient_id = 10006580 AND datetime(medication.starttime) >= datetime(current_time,'-13 month')"
6381c60f67186bd31083fcdf,How was patient 10000032 admitted in terms of admission type for the last time in the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10000032 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1","SELECT admission_type FROM admissions WHERE admissions.person_id = 10000032 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime DESC LIMIT 1"
bc393399923f7dabaa005804,Tell me the marital status of patient 10004720 during the first hospital encounter.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT marital_status FROM patients WHERE patients.id = 10004720 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1
571b776d0c624ec21b51af31,Has patient 10024043 had any organisms detected in his first mrsa screen microbiology test since 1 year ago?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND microbiologyevents.hadm_id = 10024043 AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ORDER BY microbiologyevents.charttime ASC LIMIT 1"
ba93c08f689f2e3af0763012,What is the number of times that patient 10004733 visited the hospital in 2100?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10004733 AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT( DISTINCT visits.visit_id ) FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 ) AND strftime('%Y',visits.admittime) = '2100'"
3ec03a348a536f8a80e9d54e,Please list the yearly average volume of chest tube #1 that was output by patient 10019172 since 09/2100.,"SELECT AVG(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'chest tube #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-09' GROUP BY strftime('%Y',outputevents.charttime)","SELECT AVG(output) FROM chest_tube #1 WHERE patient_id = 10019172 AND strftime('%Y-%m',time) >= '2100-09' GROUP BY strftime('%Y',time)"
8188f6370eb20b529ef916f2,"Among the patients who were prescribed alprazolam, what are the five most frequently prescribed drugs at the same time in this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alprazolam' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, strftime('%Y',prescribed_at) AS C2 FROM prescriptions WHERE drug = 'alprazolam' AND strftime('%Y',prescribed_at) = '2100' ) AS T1 JOIN ( SELECT patient_id, drug, strftime('%Y',prescribed_at) AS C3 FROM prescriptions WHERE strftime('%Y',prescriptions.prescribed_at) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.C2 = T2.C3 GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
04f2923c808564e420f2e7be,"In 10/this year, when was the last time patient 10037861 was prescribed 5% dextrose and pantoprazole at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '5% dextrose' AND admissions.subject_id = 10037861 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND admissions.subject_id = 10037861 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT T1.starttime FROM ( SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10037861 ) AND procedures.label = 'other' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures.starttime) = '10' ) AS T1 JOIN ( SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10037861 ) AND prescriptions.drug = '5% dextrose' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ) AS T2 ON T1.starttime = T2.starttime JOIN ( SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10037861 ) AND prescriptions.drug = 'pantoprazole' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime)"
e3a4b21b27f381659b9997bb,What were the three diagnoses with the lowest 3-month survival rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT patients.row_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN patients ON diagnoses.hadm_id = patients.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses.charttime) >= 1 * 365/4 GROUP BY patients.row_id, diagnoses.icd_code HAVING MIN(diagnoses.charttime) = diagnoses.charttime ) AS T1 JOIN patients ON T1.row_id = patients.row_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )"
08bd537529e959a773c05e95,Count the number of occasions in 2100 when patient 10019777 received injection or infusion of thrombolytic agent.,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection or infusion of thrombolytic agent' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = '0b1f0c0c' ) AND procedures_icd.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age = 10019777 ) AND strftime('%Y',procedures_icd.charttime) = '2100'"
f9a4d8f655bc4658ff929dab,"Can you list the top three most frequent procedures that patients received in the same hospital encounter after having reposition left maxilla with external fixation device, percutaneous approach?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d3.procedure_name FROM ( SELECT d2.procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.row_id, T1.charttime FROM ( SELECT charttime, row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) ) AS T1 JOIN ( SELECT charttime, row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) ) AS T2 ON T1.row_id < T2.row_id WHERE T1.charttime < T2.charttime ) AS T3 JOIN ( SELECT charttime, row_id FROM hospital_encounters ) AS T4 ON T3.row_id = T4.row_id ) AS T5 JOIN ( SELECT charttime, row_id FROM procedures_icd ) AS T6 ON T5.row_id = T6.row_id WHERE T5.charttime < T6.charttime"
833f3dcc0c1a68ee5c293d02,Did patient 10022041 have any diagnosis in their last hospital visit?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'other' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )
f7f4b0b9f1896ea6f3965250,Can you tell me the number of patients that were in the psychiatry careunit since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'psychiatry' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.careunit = 'psychiatry' AND strftime('%Y',admissions.admittime) >= '2100'"
0a6ec0b4e779434a9be2f99d,What is the name of the procedure that patient 10021938 underwent two or more times in 11/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-11' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT procedures.name FROM procedures WHERE procedures.chartevents_charttime IN ( SELECT T1.charttime FROM ( SELECT chartevents.charttime, COUNT( chartevents.row_id ) AS C1 FROM chartevents WHERE chartevents.charttime >= '2100-11-01' AND chartevents.charttime < '2100-12-01' AND chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021938 ) AND chartevents.itemid IN ( SELECT procedures.itemid FROM procedures ) GROUP BY chartevents.charttime ) AS T1 WHERE T1.C1 >= 2 )"
792de6c119e764058112ee54,What was patient 10027445's last output since 06/05/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT output.output FROM output WHERE output.stdiid IN ( SELECT stdepi.stdiid FROM stdepi WHERE stdepi.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10027445 ) ) AND strftime('%Y-%m-%d',output.charttime) >= '2100-06-05' ORDER BY output.charttime DESC LIMIT 1"
8bca7f05d41683561e862158,Tell me the total number of patients in the psychiatry in this year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'psychiatry' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.admission_location = 'psychiatry' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"
3b811de97455513816713b43,Show me the yearly minimum magnesium sulfate (bolus) input of patient 10036156.,"SELECT MIN(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'magnesium sulfate (bolus)' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)","SELECT MIN(input) FROM inputevents WHERE inputevents.stay_id IN ( SELECT stays.stay_id FROM stays WHERE stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10036156 ) ) AND inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'magnesium sulfate (bolus)' AND chartitems.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)"
e6ab1bc462921776329e8d65,Was patient 10027602 in the hospital in the last year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10027602 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM hospital_visits WHERE hospital_visits.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age = 10027602 ) AND datetime(hospital_visits.admittime,'start of year') = datetime(current_time,'start of year','-1 year')"
9a126c3d410cde7047840e30,What was the average heart rate on last month/25 for patient 10007058?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '25'","SELECT AVG(o2 saturation pulseoxymetry) FROM pulseoxymetryevents WHERE pulseoxymetryevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10007058 ) AND datetime(pulseoxymetryevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',pulseoxymetryevents.charttime) = '25'"
1254335c726bad61fe05f86b,"What was the name of the drug patient 10021118 was prescribed for within 2 days after having undergone a bypass coronary artery, two arteries from coronary artery, open approach procedure since 03/2100?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 day')","SELECT T2.drug FROM ( SELECT procedure_occurred_on, procedure_type_id FROM procedure_event WHERE procedure_type_id = ( SELECT procedure_type_id FROM procedure_type WHERE procedure_type = 'bypass coronary artery, two arteries from coronary artery, open approach' ) AND patient_id = 10021118 AND strftime('%Y-%m',procedure_occurred_on) >= '2100-03' ) AS T1 JOIN ( SELECT drug, occurred_on FROM medication_event WHERE patient_id = 10021118 AND strftime('%Y-%m',occurred_on) >= '2100-03' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.procedure_occurred_on < T2.occurred_on AND datetime(T2.occurred_on) BETWEEN datetime(T1.procedure_occurred_on) AND datetime(T1.procedure_occurred_on,'+2 day')"
fb2fc2ad15a779e94e21d070,How much time in days has passed since the last time patient 10021487 was prescribed vancomycin on this hospital encounter?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'vancomycin' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'vancomycin' ORDER BY prescriptions.starttime DESC LIMIT 1"
ff935574170a15f329581c0e,What are the top three commonly treatments for patients who are 40s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.treatment FROM ( SELECT procedures_icd.description, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.charttime >= '2100-01-01' AND procedures_icd.charttime < '2101-01-01' GROUP BY procedures_icd.description ) AS T1 WHERE T1.C1 <= 3 AND EXISTS ( SELECT FROM patients WHERE patients.age BETWEEN 40 AND 49 AND patients.subject_id IN ( SELECT procedures_icd.subject_id FROM procedures_icd WHERE procedures_icd.description = T1.treatment AND procedures_icd.charttime >= '2100-01-01' AND procedures_icd.charttime < '2101-01-01' ) )"
025c400c41ad7c9b0b92dc06,Count the number of times that patient 10007818 took glucerna 1.5 (full) on the first ICU visit.,SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'glucerna 1.5 (full)' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*) FROM intakeevents WHERE intakeevents.item = 'glucerna 1.5 (full)' AND intakeevents.stay_id IN ( SELECT visits.stay_id FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10007818 ) AND visits.dischtime IS NOT NULL ORDER BY visits.admittime ASC LIMIT 1 )
cdc870bf47f6134dbbc3cf55,Has the or cell saver intake been given to patient 10011398 since 07/2100?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-07'","SELECT COUNT(*)>0 FROM intakeevents WHERE intakeevents.item = 'or cell saver' AND intakeevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',intakeevents.starttime) >= '2100-07'"
2a440dee395beb895cb930f1,What is the three most frequently given microbiology tests since 1 year ago for patients who were previously diagnosed with cervical spondylosis without myelopathy within the same hospital visit?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cervical spondylosis without myelopathy' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( patient_id, visit_id ) patient_id, visit_id FROM diagnoses WHERE diagnoses.label = 'cervical spondylosis without myelopathy' ) AS T1 JOIN ( SELECT DISTINCT ON ( patient_id, visit_id ) patient_id, visit_id FROM procedures WHERE procedures.label = 'microbiology tests' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.visit_id = T2.visit_id AND datetime(T1.charttime) >= datetime(current_time,'-1 year') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3"
bc59581d2cf65c641d9a1d76,How many patients in the hospital are there currently?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is null
f6f7ea6d73b8b83013dc2f03,"For patients who underwent percutaneous abdominal drainage this year, what were the top five most frequent procedures that followed in the same month?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d3.label FROM ( SELECT d2.label, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM procedures_icd WHERE procedures_icd.label = 'percutaneous abdominal drainage' AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT subject_id, charttime FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') ) AS U1 JOIN procedures_icd d2 ON U1.subject_id = d2.subject_id WHERE datetime(d2.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY d2.label ) AS d3 WHERE d3.C1 <= 5"
68b586764cc7071b73a27296,Can you tell me the output that patient 10035185 had for the last occurrence since 01/16/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-16' ORDER BY outputevents.charttime DESC LIMIT 1 )",SELECT output FROM patient 10035185 ON last occurrence since 01/16/2100
b7f96cf1be01ab41394d3489,How many patients died during the same month after having been diagnosed since 1 year ago with acute on chronic diastolic (congestive) heart failure?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute on chronic diastolic (congestive) heart failure' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime) >= datetime(current_time,'-1 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod) >= datetime(current_time,'-1 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE datetime(T2.charttime,'start of month') = datetime(T3.dod,'start of month')","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T2.pid, T2.charttime FROM ( SELECT pid, charttime FROM diagnoses WHERE diagnoses.long_title = 'acute on chronic diastolic (congestive) heart failure' ) AS T1 JOIN ( SELECT pid, charttime FROM ( SELECT pid, charttime FROM diagnoses WHERE diagnoses.long_title = 'acute on chronic diastolic (congestive) heart failure' ) AS T1 JOIN ( SELECT pid, charttime FROM ( SELECT pid, charttime FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'other' ) AS T2 WHERE T1.pid = T2.pid AND datetime(T1.charttime) < datetime(T2.charttime) AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') ) AS T3 ON T2.pid = T3.pid WHERE T2.charttime > datetime(current_time,'-1 year') AND T3.charttime > datetime(current_time,'-1 year') ) AS T4 ON T1.pid = T4.pid WHERE T1.charttime > datetime(current_time,'-1 year') ) AS T5 JOIN ( SELECT pid, charttime FROM ( SELECT pid, charttime FROM microbiology"
ee06998b93ca5610c35e7925,"Has clonidine patch 0.3 mg/24 hr, amlodipine, or 5% dextrose been prescribed for patient 10004733 in this hospital encounter?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'clonidine patch 0.3 mg/24 hr', 'amlodipine', '5% dextrose' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'clonidine patch 0.3 mg/24 hr', 'amlodipine', '5% dextrose' )"
15a9e84696cb054763055092,"Since the first visit of patient 10004733 to the careunit neurology in their current hospital visit, how many hours have elapsed?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', ( SELECT careunitevents.starttime FROM careunitevents WHERE careunitevents.hospitalvisid IN ( SELECT admissions.hospitalvisid FROM admissions WHERE admissions.age = 10004733 AND admissions.dischtime IS NULL ) AND careunitevents.careunit = 'neurology' ORDER BY careunitevents.starttime ASC LIMIT 1 ) ) )"
c89653463314d3045e9c1e32,What are the top three most frequent procedures that patients underwent within the same hospital visit after receiving a diagnosis of closed fracture of two ribs.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'closed fracture of two ribs' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d3.procedure_name FROM ( SELECT d2.procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT t1.subject_id, t1.visit_id FROM ( SELECT subject_id, visit_id, diagnosis_time FROM mimiciii.diagnoses WHERE diagnosis_name = 'closed fracture of two ribs' ) t1 JOIN ( SELECT subject_id, visit_id, procedure_time FROM mimiciii.procedures ) t2 ON t1.subject_id = t2.subject_id WHERE t1.visit_id = t2.visit_id AND t1.diagnosis_time < t2.procedure_time ) d2 GROUP BY d2.procedure_name ) d3 WHERE d3.C1 <= 3"
48859a4418a3875bf6082407,"What was patient 10005866's first value of bilirubin, total since 03/2100?","SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005866 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-03' ORDER BY labevents.charttime ASC LIMIT 1","SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005866 ) AND labresults.item = 'bilirubin, total' AND strftime('%Y-%m',labresults.charttime) >= '2100-03' ORDER BY labresults.charttime ASC LIMIT 1"
552b047a4b16894db1150381,When did patient 10039708 receive his last microbiology test during the last hospital visit?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc IS NOT NULL AND microbiologyevents.spec_type_desc != '' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc IS NOT NULL AND microbiologyevents.spec_type_desc != '' ORDER BY microbiologyevents.charttime DESC LIMIT 1
b94d6edc3aae12b1d958fcb5,How many patients since 2100 underwent radical excision of other lymph nodes within the same hospital visit after other repair and plastic operations on bronchus?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other repair and plastic operations on bronchus' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'radical excision of other lymph nodes' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T1.visit_id FROM ( SELECT subject_id, procedure_occurrence_id, visit_id FROM procedure_occurrence WHERE procedure_occurrence.procedure_name = 'other repair and plastic operations on bronchus' AND strftime('%Y',procedure_occurrence.charttime) >= '2100' ) AS T1 JOIN ( SELECT subject_id, procedure_occurrence_id, visit_id FROM procedure_occurrence WHERE procedure_occurrence.procedure_name = 'radical excision of other lymph nodes' AND strftime('%Y',procedure_occurrence.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.visit_id = T2.visit_id AND T1.procedure_occurrence_id < T2.procedure_occurrence_id ) AS T3"
75b34f0cc40ad60222a3d432,How was patient 10019777 admitted in terms of admission type for the first time in the hospital?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10019777 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.admittime ASC LIMIT 1","SELECT admission_type FROM admissions WHERE admissions.person_id = 10019777 AND strftime('%Y',admissions.admittime) = '2100' ORDER BY admissions.admittime ASC LIMIT 1"
c747e1b668edc722be015e38,When was the first time patient 10020740 was prescribed a medication via the ih route in 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.route = 'ih' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT to_char(drug_admin_events.starttime,'YYYY-MM-DD HH24:MI:SS') FROM drug_admin_events WHERE drug_admin_events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020740 ) AND drug_admin_events.route = 'ih' AND strftime('%Y-%m',drug_admin_events.starttime) = '2100-07' ORDER BY drug_admin_events.starttime ASC LIMIT 1"
e7f9ba08efb72fdfd7f40122,"How many instances of drainage of left pleural cavity, percutaneous approach, diagnostic have there been in the last year?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code( '0f1f3a3f-0c8d-11e0-b929-000c29a1d398' ) ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')"
9ed380731316b97f5b4cc772,"After being diagnosed with personal history of noncompliance with medical treatment, presenting hazards to health in 2100, how many patients received a diagnosis of blood in stool within 2 months?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of noncompliance with medical treatment, presenting hazards to health' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'blood in stool' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T2.pid FROM ( SELECT pid, to_char(firsttime,'YYYY') FROM diagnoses WHERE description = 'personal history of noncompliance with medical treatment, presenting hazards to health' AND strftime('%Y',firsttime) = '2100' ) AS T1 JOIN ( SELECT pid, to_char(firsttime,'YYYY') FROM diagnoses WHERE description = 'blood in stool' ) AS T2 ON T1.pid = T2.pid WHERE datetime(T1.firsttime) < datetime(T2.firsttime) AND datetime(T2.firsttime) BETWEEN datetime(T1.firsttime) AND datetime(T1.firsttime,'+2 month') ) AS T3"
5be97a0dfd0141a05af0b00e,Count the number of patients who were diagnosed with irritable bowel syndrome but didn't come back to the hospital within 2 months since 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'irritable bowel syndrome' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'irritable bowel syndrome' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) >= '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid FROM ( SELECT pid, to_char(admittime,'YYYY') FROM admissions WHERE to_char(admittime,'YYYY') >= '2100' ) AS T1 JOIN ( SELECT pid, to_char(admittime,'YYYY') FROM admissions WHERE to_char(admittime,'YYYY') >= '2100' ) AS T2 ON T1.pid = T2.pid WHERE T1.diagnosis = 'irritable bowel syndrome' AND T2.admittime >= datetime(T1.admittime,'+2 month') )"
1dffdf5fe800e0b9a0dcf1b3,Has patient 10005866 been in the hospital?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866,SELECT COUNT(*)>0 FROM hospital_visits WHERE hospital_visits.patient_id = 10005866
eb33e90dbcfbca0c0e049512,"How many patients underwent reopening of recent thoracotomy site within the same month after the diagnosis with other acute postoperative pain, since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other acute postoperative pain' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reopening of recent thoracotomy site' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT T2.patient_id, T2.diagnosis_time FROM ( SELECT patient_id, diagnosis_time FROM diagnoses WHERE diagnoses.long_title = 'other acute postoperative pain' ) AS T2 ) AS T1 JOIN ( SELECT patient_id, procedure_time FROM procedures WHERE procedures.long_title = 'reopening of recent thoracotomy site' ) AS T3 ON T1.patient_id = T3.patient_id WHERE datetime(T1.diagnosis_time,'start of month') = datetime(T3.procedure_time,'start of month') AND strftime('%Y',T1.diagnosis_time) >= '2100'"
e4e38f5cdc7fa7972dbcbfcd,When did patient 10019172 leave the hospital the last time?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT discharge_time FROM discharge WHERE discharge.time IS NOT NULL AND discharge.hadm_id IN ( SELECT hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ORDER BY discharge.time DESC LIMIT 1
e1f82dce913d0a344d686dcb,What was the total mediastinal output in the last ICU visit that patient 10005817 had?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'mediastinal' AND d_items.linksto = 'outputevents' ),SELECT SUM(output) FROM mediastinal WHERE patient_id = 10005817 AND last_icu_visit = true
d704f27fd79c99e4a27f1581,Count the number of medicines that patient 10026354 was prescribed in 11/this year.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10026354 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11'"
851cd4dfcd01e3388de0e514,"Among those who were prescribed with pseudoephedrine, what are the three most commonly prescribed drugs at the same time in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pseudoephedrine' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT patient_id, prescription_starttime FROM prescriptions WHERE drug = 'pseudoephedrine' AND strftime('%Y',prescription_starttime) = '2100' ) AS T1 JOIN ( SELECT patient_id, prescription_starttime FROM prescriptions WHERE strftime('%Y',prescription_starttime) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.prescription_starttime = T2.prescription_starttime ) AS T3 GROUP BY T3.drug ) AS T4 WHERE T4.C1 <= 3"
60fbb0d233ccfd0e7297749b,What were the five most frequent diagnoses that occurred in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.diagnosis_desc FROM diagnosis d WHERE d.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnosis.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnosis WHERE strftime('%Y',diagnosis.charttime) = '2100' GROUP BY diagnosis.icd_code ) AS T1 WHERE T1.C1 <= 5 )"
b5aa101f3fdc45028cfa04f1,What percentile rank does a lactate test value of 2.3 have among patients of the same age as patient 10004422 during the last hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10004422 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.3","SELECT DISTINCT T1.C1 FROM ( SELECT T2.C1, PERCENT_RANK() OVER ( ORDER BY T2.C1 ) AS C2 FROM ( SELECT O1.valuenum, O1.charttime, P1.age FROM ( SELECT O.valuenum, O.charttime, O.hadm_id FROM ( SELECT * FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'lactate' ) ) AS O WHERE O.hadm_id IN ( SELECT H1.hadm_id FROM ( SELECT H.hadm_id, DENSE_RANK() OVER ( ORDER BY H.dischtime DESC ) AS C1 FROM ( SELECT * FROM discharge ) AS H WHERE H.age = ( SELECT P.age FROM ( SELECT * FROM patients ) AS P WHERE P.pid = 10004422 ) ) AS H1 WHERE H1.C1 = 1 ) ) AS O1 JOIN ( SELECT * FROM patients ) AS P1 ON O1.hadm_id = P1.hadm_id ) AS T2 WHERE T2.age = ( SELECT P.age FROM ( SELECT * FROM patients ) AS P WHERE P.pid = 10004422 ) ) AS T1 WHERE T1.valuenum"
5437dceb1f465a249b318f40,How many hours have there been since patient 10039831's admission to the hospital?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT admissiontime FROM admissions WHERE admissions.pid = 10039831 AND admissions.dischtime IS NULL ) ) )"
a12d2706258e7cd94b157f13,How many times did patient 10021487 stay in ICU?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ),SELECT COUNT(1) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 )
d08bcacce107729b3e15f70b,"Among patients who received partial hepatectomy since 1 year ago, what are the top three most common diagnoses that followed afterwards within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'partial hepatectomy' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures WHERE procedures.careunit = 'operating room' AND procedures.performing_physician = 'partial hepatectomy' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses WHERE datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )"
a318cf44208857796ab33806,What is the 3-month survival rate for patients diagnosed with other psoriasis?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other psoriasis' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT T2.C1, DENSE_RANK() OVER ( ORDER BY T2.C2 ASC ) AS C3 FROM ( SELECT T1.C1, AVG(C1) AS C2 FROM ( SELECT T1.C1, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',diagnoses.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM diagnoses WHERE diagnoses.long_title = 'other psoriasis' AND diagnoses.spec_type IS NOT NULL AND diagnoses.spec_desc IS NOT NULL AND diagnoses.spec_desc != '' AND diagnoses.spec_type != '' AND diagnoses.spec_type IS NOT NULL AND diagnoses.spec_desc IS NOT NULL AND diagnoses.spec_desc != '' AND diagnoses.spec_type != '' AND diagnoses.spec_type IS NOT NULL AND diagnoses.spec_desc IS NOT NULL AND diagnoses.spec_desc != '' AND diagnoses.spec_type != '' AND strftime('%J',patients.dod) - strftime('%J',diagnoses.charttime) >= 0 GROUP BY patients.subject_id ) AS T1 GROUP BY T1.C1 ) AS T2 ) AS T3 WHERE T3.C1 = T1.C1"
cbfc8721f283a1c8bc8a32fb,What was the insurance that patient 10013049 had on the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT insurance FROM insurance WHERE insurance.patient_id = 10013049 AND insurance.hadm_id IN ( SELECT hadm_id FROM hadm WHERE hadm.dischtime IS NOT NULL ORDER BY hadm.admittime ASC LIMIT 1 )
dd025c270eae097731034a6c,How many hours has it been since patient 10018081 first received a mcv lab test during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT itemid FROM d_icditems WHERE d_icditems.long_title = 'mcv' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = 'unspecified' ) ) AND admissions.dischtime IS NULL ) AND admissions.age = 10018081 ) ORDER BY labevents.charttime ASC LIMIT 1"
c639ce3944c3e8b1431b7f0d,When is the first mrsa screen microbiological test on patient 10011398 during their last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.valuenum IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1
6c5c8aeb2476c9646d1a2c84,How many hours have gone by since the last time patient 10004733 was diagnosed with hyperosmolality and/or hypernatremia in this hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperosmolality and/or hypernatremia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses.diagnoses_charttime) ) FROM diagnoses WHERE diagnoses.hospital_visit_id IN ( SELECT hospital_visits.hospital_visit_id FROM hospital_visits WHERE hospital_visits.patient_id = 10004733 AND hospital_visits.dischtime IS NULL ) AND diagnoses.long_title = 'hyperosmolality and/or hypernatremia' ORDER BY diagnoses.diagnoses_charttime DESC LIMIT 1"
790549b711d398fb4ea8bbcb,"What were the five most commonly given microbiology tests for patients who had received excision of right internal mammary artery, percutaneous endoscopic approach before in the same month?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'excision of right internal mammary artery, percutaneous endoscopic approach' ) ) AS T1 JOIN ( SELECT * FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'microbiology tests' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5"
d91a86b3f19888f5557a404a,Since 08/2100 has patient 10004733 received a hyaline casts test?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hyaline casts' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-08'",SELECT COUNT(*)>0 FROM laboratoryevents WHERE laboratoryevents.valuenum IS NOT NULL AND laboratoryevents.hyaline_casts = 1 AND laboratoryevents.charttime >= '2100-08-01' AND laboratoryevents.row_id IN ( SELECT procedures.row_id FROM procedures WHERE procedures.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10004733 ) )
5d5a07118525dfe5b79a0611,Has patient 10026255 had any tests for red blood cells since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*)>0 FROM labtests WHERE labtests.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10026255 ) ) AND labtests.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10026255 ) ) AND labtests.valuenum IS NOT NULL AND strftime('%Y-%m',labtests.charttime) >= '2100-04'"
19d0768436838216fd47a301,Could you provide the last care unit for patient 10009049 in their last hospital encounter according to the transfer record?,SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime DESC LIMIT 1,"SELECT T1.careunit FROM ( SELECT T2.careunit, ROW_NUMBER() OVER ( ORDER BY T2.intime DESC ) AS C1 FROM ( SELECT * FROM transferevents WHERE transferevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10009049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AS T2 ) AS T1 WHERE T1.C1 = 1"
2920bbd6fd0bc33b5dccb46b,What label is associated with epidural bolus (ml)?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'epidural bolus (ml)',SELECT DISTINCT d_icd_procedures_long_title FROM d_icd_procedures WHERE d_icd_procedures_short_title = 'epidural bolus (ml)'
c1d91632054e8b6e0c6ddbe3,What were the three most commonly diagnosed conditions in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_diagnoses.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses.icd_code FROM diagnoses WHERE strftime('%Y',diagnoses.charttime) = '2100' ) GROUP BY d_icd_diagnoses.icd_code ) AS T1 WHERE T1.C1 <= 3 )"
ec48e6b64115e4e42d084f61,What is the number of patients who died after diagnosis of alcoholic cirrhosis of liver within the same month?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'alcoholic cirrhosis of liver' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL ) as T3 ON T2.subject_id = T3.subject_id WHERE datetime(T2.charttime,'start of month') = datetime(T3.dod,'start of month')","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.charttime FROM ( SELECT pid, charttime FROM diagnoses WHERE diagnoses.long_title = 'alcoholic cirrhosis of liver' ) AS T1 ) AS T1 JOIN ( SELECT pid, charttime FROM ( SELECT pid, charttime FROM diagnoses WHERE diagnoses.long_title = 'death' ) AS T2 ) AS T2 ON T1.pid = T2.pid WHERE datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')"
512cce50ee8297feb5df8464,"Among patients who received percutaneous abdominal drainage throughout this year, what were the top five most common treatments that were administered within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'percutaneous abdominal drainage' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.treatment FROM ( SELECT T2.treatment, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, procedure_date FROM procedures WHERE procedures.procedure = 'percutaneous abdominal drainage' AND datetime(procedures.procedure_date,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient_id, treatment, treatment_start_time FROM treatments WHERE datetime(treatments.treatment_start_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.procedure_date < T2.treatment_start_time AND datetime(T2.treatment_start_time) BETWEEN datetime(T1.procedure_date) AND datetime(T1.procedure_date,'+2 month') GROUP BY T2.treatment ) AS T3 WHERE T3.C1 <= 5"
d04a8f390aa217deadcd1bd1,When was the first time when patient 10027602 received their input on this month/02?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '02' ORDER BY inputevents.starttime ASC LIMIT 1","SELECT input.time FROM input WHERE input.studysite = ( SELECT studysite.studysite FROM studysite WHERE studysite.hadm_id IN ( SELECT hadm_id FROM hadm_id WHERE hadm_id = 10027602 ) ) AND datetime(input.time,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',input.time) = '02' ORDER BY input.time ASC LIMIT 1"
647bc08d18cac6dbda791c42,"When was, for the last time in 10/2100, patient 10018845 prescribed a medication via the sc route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND prescriptions.route = 'sc' AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.stopsite = 'sc' AND prescriptions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = 10018845 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1"
f695adacb2c2c0d897a34ec4,What was the drug that was prescribed to patient 10020944 during the same hospital encounter after receiving arterial catheterization in 03/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND strftime('%Y-%m',procedures_icd.charttime) = '2100-03' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedure_occurred.charttime, procedure_occurred.hadm_id FROM procedure_occurred WHERE procedure_occurred.label = 'arterial catheterization' AND procedure_occurred.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020944) AND strftime('%Y-%m',procedure_occurred.charttime) = '2100-03' ) AS T1 JOIN ( SELECT prescription.drug, prescription.starttime, prescription.hadm_id FROM prescription WHERE prescription.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020944) AND strftime('%Y-%m',prescription.starttime) = '2100-03' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of visit') = datetime(T2.starttime,'start of visit')"
bede0977c8868b145f17fa5e,What was the name of the last specimen test patient 10021938 got since 07/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT specimen_tests.spec_type FROM specimen_tests WHERE specimen_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021938 ) AND strftime('%Y-%m',specimen_tests.charttime) >= '2100-07' ORDER BY specimen_tests.charttime DESC LIMIT 1"
842de74a9f0719c2f68b9f9f,"Get me the top five most frequent specimens that patients were tested within 2 months after receiving bypass coronary artery, one artery from aorta with autologous venous tissue, open approach since 2100.","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( patient_id ) patient_id, procedures_datetime FROM procedures WHERE procedures_code = 'open bypass coronary artery, one artery from aorta with autologous venous tissue' AND strftime('%Y',procedures_datetime) >= '2100' ) AS T1 JOIN ( SELECT DISTINCT ON ( patient_id ) patient_id, specimens_datetime FROM specimens WHERE strftime('%Y',specimens_datetime) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.procedures_datetime < T2.specimens_datetime AND datetime(T2.specimens_datetime) BETWEEN datetime(T1.procedures_datetime) AND datetime(T1.procedures_datetime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5"
c8edd5309596df31109a68a1,What is the average value of mesothelial cells of patient 10021487 since 04/2100?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mesothelial cells' ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT AVG(mesothelial_cells) FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) AND strftime('%Y-%m',lab_results.charttime) >= '2100-04'"
5614cf0da6a6dc8d7f53e2e4,"In the last ICU stay, what was the average value of heart rate of patient 10019385?",SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ),SELECT AVG(o2 saturation pulseoxymetry) FROM patient 10019385's other in the last ICU stay
288822ce7a0817f505ff7846,"Can you tell me the price of a potassium, whole blood lab test?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'potassium, whole blood' ) )","SELECT DISTINCT cost FROM lab_cost WHERE lab_test = 'potassium, whole blood'"
f7ef7a140ef208ed6c164772,What was patient 10004235 diagnosed with for the first time since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses.icd_code FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004235 ) AND strftime('%Y',diagnoses.charttime) >= '2100' ORDER BY diagnoses.charttime ASC LIMIT 1 )"
ca849848206d37bc69b35d9d,When did patient 10018501 get the last input since 145 days ago?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND datetime(inputevents.starttime) >= datetime(current_time,'-145 day') ORDER BY inputevents.starttime DESC LIMIT 1","SELECT input.inputtime FROM input WHERE input.stay_id IN ( SELECT stay.stay_id FROM stay WHERE stay.hadm_id IN ( SELECT hadm.hadm_id FROM hadm WHERE hadm.subject_id = 10018501 ) ) AND datetime(input.inputtime) >= datetime(current_time,'-145 day') ORDER BY input.inputtime DESC LIMIT 1"
310609c75ba9429428209b11,What was the length of stay in days for patient 10002495 during the first ICU stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT strftime('%J', outtime) - strftime('%J', intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1"
0eba370644940aed20760324,What was the name of the drug that patient 10006580 was first prescribed via a sc route in their first hospital visit?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.route = 'sc' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND prescriptions.route = 'sc' ORDER BY prescriptions.starttime ASC LIMIT 1
40e911a74ca6a562cbd63623,What's the count of extraction of other tooth procedures that happened since 1 year ago?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extraction of other tooth' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.icd_name = 'extraction of other tooth' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year')"
7f8ee9cd84328b3ac980008b,What is the maximum total hospital cost that has ever included fexofenadine within the same hospital visit?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fexofenadine' ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM( hospital_charges.cost ) AS C1 FROM hospital_charges WHERE hospital_charges.hospital_charges.itemid IN ( SELECT prescriptions.itemid FROM prescriptions WHERE prescriptions.drug = 'fexofenadine' ) GROUP BY hospital_charges.hospital_charges.hadm_id ) AS T1
ae564ba44db568a88f5527ac,What is the total cost for patient 10020944's hospital stay throughout this year?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND datetime(cost.chargetime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT SUM(adr1.cost) FROM admissions adr1 WHERE adr1.admissionid IN ( SELECT admissions.admissionid FROM admissions WHERE admissions.hadm_id IN ( SELECT d_icd_procedures.hadm_id FROM d_icd_procedures WHERE d_icd_procedures.charttime >= datetime(current_time,'start of year','-0 year') AND d_icd_procedures.charttime < datetime(current_time,'start of year','-0 year')+1 year ) ) AND admissions.hadm_id IN ( SELECT d_icd_diagnoses.hadm_id FROM d_icd_diagnoses WHERE d_icd_diagnoses.charttime >= datetime(current_time,'start of year','-0 year') AND d_icd_diagnoses.charttime < datetime(current_time,'start of year','-0 year')+1 year ) AND admissions.patient_id = 10020944"
202ecadc0d16d2f85f8ad189,Show me the monthly maximum dextrose 5% input of patient 10009035 in their first hospital encounter.,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)","SELECT MAX(input) FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT encounters.hadm_id FROM encounters WHERE encounters.encounterid IN ( SELECT diagnoses.encounterid FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) ) AND inputevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'dextrose 5%' AND items.linksto = 'inputevents' ) GROUP BY strftime('%Y-%m',inputevents.starttime)"
efed4e108b270dda785398e4,Can you name the top five diagnoses with the highest 3-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT patients.row_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN patients ON diagnoses.hadm_id = patients.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses.charttime) >= 1 * 365/4 ) AS T1 JOIN patients ON T1.row_id = patients.row_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )"
317471edec57125589ff563e,Calculate the duration in days of patient 10002495's stay in the last ICU.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1"
2cd96b3599e3450802308c45,How many days has it been since patient 10018081's hospital admission?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT hospital_admission_table.admittime FROM hospital_admission_table WHERE hospital_admission_table.hadm_id IN ( SELECT observation_table.hadm_id FROM observation_table WHERE observation_table.itemid IN ( SELECT chartevents_table.itemid FROM chartevents_table WHERE chartevents_table.hadm_id IN ( SELECT hospital_admission_table.hadm_id FROM hospital_admission_table WHERE hospital_admission_table.pid = 10018081 ) ) ) ) ) )"
1c26aa5ab4b654a27fb0f4a6,When did patient 10021487 first have the maximum value of plasma cells since 26 months ago?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'plasma cells' ) AND datetime(labevents.charttime) >= datetime(current_time,'-26 month') ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id = 10021487 AND labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'plasma cells' ) AND datetime(labevents.charttime) >= datetime(current_time,'-26 month') ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1"
ed844ec6192fdc9f7e85ebb3,"Among patients who received a other diagnostic procedures on lung or bronchus procedure , what were the three most frequent microbiology tests conducted during the same hospital encounter?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT subject_id, MIN(hospital_visit_id) AS C1 FROM hospital_visits WHERE procedure_name = 'other diagnostic procedures on lung or bronchus' GROUP BY subject_id ) AS T1 JOIN ( SELECT subject_id, hospital_visit_id, test_name FROM ( SELECT subject_id, hospital_visit_id, test_name, ROW_NUMBER() OVER ( PARTITION BY subject_id, hospital_visit_id ORDER BY microbiology_tests.charttime ASC ) AS C1 FROM microbiology_tests ) AS T2 WHERE T2.C1 = 1 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.C1 = T2.hospital_visit_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3"
9cce51057612a8f9dc75a40f,What were the five most common microbiology tests that patients had after undergoing esophagogastroduodenoscopy [egd] with closed biopsy within the same month?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'esophagogastroduodenoscopy [egd] with closed biopsy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'esophagogastroduodenoscopy [egd] with closed biopsy' ) ) AS T1 JOIN ( SELECT * FROM procedures_icd WHERE procedures_icd.table_name = 'microbiology tests' ) AS T2 ON T1.charttime < T2.charttime AND T1.charttime >= datetime(T2.charttime,'start of month') AND T1.hadm_id = T2.hadm_id WHERE datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5"
7f45ec7922873c06d1b67747,What is the average yearly number of patients who had encounter for palliative care?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for palliative care' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM ( SELECT subject_id, strftime('%Y',encounter_datetime) AS Y1 FROM encounter WHERE encounter.type = 'encounter for palliative care' ) AS T2 GROUP BY T2.Y1 ) AS T1"
ef903edb8d2304b433a243cb,How many hours have there been since patient 10004733's admission to the hospital?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT admissiontime FROM admissions WHERE admissions.pid = 10004733 AND admissions.dischtime IS NULL ) ) ) FROM dual"
6aea46a3a6bf0c02fb9bd415,What was the last measured value of respiratory rate of patient 10027602 on this month/04?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '04' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT o1.valuenum FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT d.valuenum, d.charttime, d.itemid FROM ( SELECT * FROM patients WHERE patients.pid = 10027602 ) AS pp JOIN ( SELECT * FROM microbiologyevents WHERE microbiologyevents.pid = pp.pid ) AS pm ON pp.hadm_id = pm.hadm_id JOIN ( SELECT * FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures' ) AS dp ON pm.spec_type_desc = dp.long_title JOIN ( SELECT * FROM d_labitems WHERE d_labitems.label = 'o2 saturation pulseoxymetry' ) AS dl ON pm.spec_type_desc = dl.label JOIN ( SELECT * FROM inputevents WHERE inputevents.pid = pp.pid ) AS inpt ON pp.hadm_id = inpt.hadm_id JOIN ( SELECT * FROM outputevents WHERE outputevents.pid = pp.pid ) AS out ON pp.hadm_id = out.hadm_id JOIN ( SELECT * FROM admissions WHERE admissions.pid = pp.pid ) AS adm ON pp.hadm_id = adm.hadm_id JOIN ( SELECT * FROM prescriptions WHERE prescriptions.pid = pp.pid ) AS pres ON pp.hadm_id = pres.hadm_id"
e59eccf79830c0ce43f8ca5c,How much metformin xr (glucophage xr) was prescribed to patient 10016150 first time in 05/this year?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND prescriptions.drug = 'metformin xr (glucophage xr)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT metformin xr (glucophage xr) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10016150 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '05' ORDER BY prescriptions.starttime ASC LIMIT 1"
0802fd344595ba15c4b3d32b,Count how many patients underwent a microbiological rapid respiratory viral screen & culture test.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'rapid respiratory viral screen & culture' ),SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'microbiological rapid respiratory viral screen & culture' )
175e95be4a9b9de2532f300e,Show me the top three most common diagnoses of patients with age in their 20s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d.diagnosis_desc FROM ( SELECT d.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses d WHERE d.age BETWEEN 20 AND 29 GROUP BY d.diagnosis_desc ) WHERE C1 <= 3"
7e7f2de29fe0d6cf726ecfd4,Did patient 10020306 visit the hospital for admission during the last year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020306 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM admissions WHERE admissions.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age = 10020306 ) AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')"
91b457d33856fa9e57fd105b,"During the last hospital encounter, what was the age of patient 10008454?",SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT age FROM patients WHERE patients.age IS NOT NULL AND patients.subject_id IN ( SELECT admissions.subject_id FROM admissions WHERE admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND patients.subject_id = 10008454
bd54a046a04a62d9d40ba4d4,"This year, what were the four most frequently ordered specimen tests?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT T1.spec_type_desc FROM ( SELECT spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM specimens WHERE datetime(sdate,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY spec_type_desc ) AS T1 WHERE T1.C1 <= 4"
41d96d1ac69af1608ab8e287,Can you list the yearly maximum vital high protein (full) input of patient 10019777?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'vital high protein (full)' AND d_items.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.starttime)","SELECT MAX(T1.C1) FROM ( SELECT SUM(inputtotalamount) AS C1 FROM inputevents WHERE inputevents.stdt >= ( SELECT admittime FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.charttime >= ( SELECT admissions.admittime FROM admissions WHERE admissions.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age = 10019777 ) ) ) ) AND inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'vital high protein (full)' AND chartitems.linksto = 'inputevents' ) GROUP BY strftime('%Y',inputevents.stdt) ) AS T1"
3c3a60ef6ea248ad69d36deb,When was patient 10008287 prescribed for the last time a medication via the pr route since 08/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) AND prescriptions.route = 'pr' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT to_char(drug_exposure.starttime,'YYYY-MM-DD HH24:MI:SS') FROM drug_exposure WHERE drug_exposure.drug = 'pr' AND drug_exposure.route = 'pr' AND drug_exposure.patient_id = 10008287 AND strftime('%Y-%m',drug_exposure.starttime) >= '2100-08' ORDER BY drug_exposure.starttime DESC LIMIT 1"
916c297dfa63e76557d57bb8,Is patient 10025612's heart rate ever greater than 104.0 on 10/03/2100?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 104.0 AND strftime('%Y-%m-%d',chartevents.charttime) = '2100-10-03'","SELECT COUNT(*)>0 FROM heart_rate WHERE heart_rate.val > 104.0 AND heart_rate.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10025612 ) AND strftime('%Y-%m-%d',heart_rate.charttime) = '2100-10-03'"
7c6bef368aa5ba846c186719,How much of a difference is there in patient 10038999's c-reactive protein last measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c-reactive protein' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'c-reactive protein' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT c_reactive_protein FROM laboratory_tests WHERE laboratory_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT laboratory_tests.hadm_id FROM laboratory_tests WHERE laboratory_tests.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'c-reactive protein' ) AND laboratory_tests.valuenum IS NOT NULL AND laboratory_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ORDER BY laboratory_tests.charttime DESC LIMIT 1 ) ) ) - ( SELECT c_reactive_protein FROM laboratory_tests WHERE laboratory_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT laboratory_tests.hadm_id FROM laboratory_tests WHERE laboratory_tests.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'c-reactive protein' ) AND laboratory_tests.valuenum IS NOT NULL AND laboratory_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL ORDER
fa829a69da2e049d895218f5,What is the number of times that patient 10020786 had pre-admission on 12/04/last year?,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',outputevents.charttime) = '12-04'","SELECT COUNT(*) FROM events WHERE events.event_type = 'pre-admission' AND events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020786 ) AND datetime(events.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',events.charttime) = '12-04'"
54c7213807ea893bd586bc8a,"Among patients who received reposition left maxilla with external fixation device, percutaneous approach during this year, what were the top four most common treatments that were administered within the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d1.treatment FROM ( SELECT d1.treatment, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT t1.subject_id, t1.visit_id FROM procedures_icd t1 WHERE t1.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'reposition left maxilla with external fixation device, percutaneous approach' ) AND datetime(t1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS t1 JOIN ( SELECT DISTINCT t2.subject_id, t2.visit_id, t2.treatment FROM procedures_icd t2 WHERE datetime(t2.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS d1 ON t1.subject_id = d1.subject_id AND t1.visit_id = d1.visit_id WHERE t1.icd_code != d1.icd_code GROUP BY d1.treatment ) AS d2 WHERE d2.C1 <= 4"
ba6c7676d03f793bbd5aaf81,Which was the first procedure that patient 10035185 received during their last hospital encounter?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1 ),SELECT procedures.name FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.name = 'other endovascular procedures' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND procedures.name = 'other endovascular procedures' ORDER BY procedures.charttime ASC LIMIT 1
42ab3ab91a8cfe3fa02ec9f2,Retrieve the top five most frequent procedures that patients underwent in the same month after being diagnosed with intermediate coronary syndrome.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intermediate coronary syndrome' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d3.procedure_name FROM ( SELECT d2.procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.subject_id, T1.diagnoses_datetime FROM ( SELECT subject_id, diagnoses_datetime FROM diagnoses WHERE diagnoses.long_title = 'intermediate coronary syndrome' ) AS T1 JOIN ( SELECT subject_id, procedures_datetime FROM procedures ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.diagnoses_datetime < T2.procedures_datetime AND datetime(T1.diagnoses_datetime,'start of month') = datetime(T2.procedures_datetime,'start of month') ) AS D1 GROUP BY D1.procedure_name ) AS D2 ) AS d3 WHERE d3.C1 <= 5"
7b11c8a07c7b85627d2a9c47,"Count how many times during their first hospital encounter patient 10018423 experienced the bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach procedure.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'bypass coronary artery, one artery from left internal mammary with autologous arterial tissue, open approach' ) AND procedures_icd.person_id = 10018423 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND procedures_icd.person_id = 10018423"
7b7f155abcaed396f4e612b6,Tell me the name of the medication patient 10004720 was first prescribed via iv route since 05/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004720 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1"
18df1101ddb265b920569563,What are the names of the procedures performed on patient 10020740 two or more times since 14 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-14 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT procedures.name FROM procedures WHERE procedures.chartevents_id IN ( SELECT T1.chartevents_id FROM ( SELECT chartevents.chartevents_id, procedures.name, COUNT( procedures.chartevents_id ) AS C1 FROM chartevents JOIN procedures ON chartevents.chartevents_id = procedures.chartevents_id WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') GROUP BY chartevents.chartevents_id, procedures.name ) AS T1 WHERE T1.C1 >= 2 )"
964217a388912122a2c89866,"Tell me patient 10020944's average calcium, total value in 03/2100?","SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03'","SELECT AVG(lab_results.valuenum) FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020944 ) AND lab_results.item = 'total calcium' AND strftime('%Y-%m',lab_results.charttime) = '2100-03'"
ea018f554b80d642628c416c,Tell me the total ICU visits of patient 10004733 since 2100.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND strftime('%Y',icustays.intime) >= '2100'","SELECT COUNT(1) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 ) AND strftime('%Y',icustays.intime) >= '2100'"
5c365a198595d213cd5d103a,Has patient 10004733 received any tests for triglycerides in 10/last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycerides' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'","SELECT COUNT(*)>0 FROM laboratoryevents WHERE laboratoryevents.valuenum IS NOT NULL AND laboratoryevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 ) AND laboratoryevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'triglycerides' ) AND datetime(laboratoryevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',laboratoryevents.charttime) = '10'"
46750fb096297aa719284222,Get me the top four most frequent lab tests throughout this year.,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT T1.labtest FROM ( SELECT labtest, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labresults WHERE datetime.datetime >= datetime(current_time,'start of year') GROUP BY labtest ) AS T1 WHERE T1.C1 <= 4"
e65c919605b77138aef522fe,What is the name of the procedure done to patient 10019777 two times since 21 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-21 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT procedures.name FROM procedures WHERE procedures.chartevents_charttime >= datetime(current_time,'-21 month') AND procedures.chartevents_rowid IN ( SELECT procedures.chartevents_rowid FROM procedures WHERE procedures.chartevents_charttime >= datetime(current_time,'-21 month') AND procedures.chartevents_hadm_id = 10019777 GROUP BY procedures.name HAVING count(*) = 2 )"
4f8edd5ffa577be90e9a0715,What is the average amount of the total hospital cost which involves dependence on supplemental oxygen since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on supplemental oxygen' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM( hospital_charges.cost ) AS C1 FROM hospital_charges WHERE hospital_charges.hospital_charges.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.icd_code = 'Z99.1' ) AND strftime('%Y',hospital_charges.chargetime) >= '2100' GROUP BY hospital_charges.hospital_charges.hid ) AS T1"
d3f0d98539d2e9134a435816,"On the current hospital visit, how many hours have passed since the first time patient 10021487 was prescribed midazolam?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'midazolam' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'midazolam' ORDER BY prescriptions.starttime ASC LIMIT 1"
6e19826cc8478fa8a97d1dee,When was the first time in 07/this year that patient 10007818 had the minimum of tobramycin?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'tobramycin' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '07' ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT tobramycin_dose_time FROM tobramycin_dose WHERE tobramycin_dose.patient_id = 10007818 AND datetime(tobramycin_dose.tobramycin_dose_time,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',tobramycin_dose.tobramycin_dose_time) = '07' ORDER BY tobramycin_dose.value ASC, tobramycin_dose.tobramycin_dose_time ASC LIMIT 1"
9ab8b4d1a143e09289a29059,What is the maximum metamyelocytes of patient 10038992?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'metamyelocytes' ),SELECT MAX(metamyelocytes) FROM laboratory_tests WHERE laboratory_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10038992 )
519da8c653b3284432571957,Has there been any results of microbiology tests for the blood culture of patient 10007818 since 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y',microbiologyevents.charttime) >= '2100'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10007818 ) AND microbiologyevents.spec_type_desc = 'blood culture' AND strftime('%Y',microbiologyevents.charttime) >= '2100'"
5ff41378c47dc43f9ea36aa9,What's the total amount of packed red blood cells that patient 10008454 received on their first ICU stay?,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ),SELECT SUM(inputamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10008454 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'packed red blood cells' AND chartitems.linksto = 'inputevents' )
05a1330cdcd6729af414b7c7,What is the 6-month survival probability for patients living with a other and unspecified angina pectoris diagnosis?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/2 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified angina pectoris' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT T2.C1, T2.C0 / T1.C0 AS C2 FROM ( SELECT T1.C1, AVG(T1.C0) AS C0 FROM ( SELECT T1.C1, T1.V1, T1.C0 FROM ( SELECT T1.C1, T1.V1, T1.C0 FROM ( SELECT T1.C1, T1.V1, AVG(C1) AS C0 FROM ( SELECT T1.C1, T1.V1, T1.J1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT T1.C1, T1.V1, T1.J1 FROM ( SELECT T1.C1, T1.V1, T1.J1 FROM ( SELECT T1.C1, T1.V1, T1.J1 FROM ( SELECT T1.C1, T1.V1, T1.J1 FROM ( SELECT T1.C1, T1.V1, T1.J1 FROM ( SELECT T1.C1, T1.V1, T1.J1 FROM ( SELECT T1.C1, T1.V1, T1.J1 FROM ( SELECT T1.C1"
09e77a973741f315e0526f82,Give me the four most common output events since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d.output_desc FROM ( SELECT d.output_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT t1.output_desc, datetime(t1.charttime) AS C2 FROM ( SELECT charttime, output_desc FROM outputevents WHERE datetime(charttime) >= datetime(current_time,'-1 year') ) AS t1 GROUP BY t1.output_desc, C2 ) AS d GROUP BY d.output_desc ) WHERE d.C1 <= 4"
aaa0dd1684e01424ce21edfd,When was the last occasion that patient 10018423 underwent a fluoroscopy of multiple coronary arteries using low osmolar contrast procedure since 1 year ago?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fluoroscopy of multiple coronary arteries using low osmolar contrast' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT fluoroscopy_of_multiple_coronary_arteries_using_low_osmolar_contrast.charttime FROM fluoroscopy_of_multiple_coronary_arteries_using_low_osmolar_contrast WHERE fluoroscopy_of_multiple_coronary_arteries_using_low_osmolar_contrast.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10018423 ) AND datetime(fluoroscopy_of_multiple_coronary_arteries_using_low_osmolar_contrast.charttime) >= datetime(current_time,'-1 year') ORDER BY fluoroscopy_of_multiple_coronary_arteries_using_low_osmolar_contrast.charttime DESC LIMIT 1"
c1a2df83f43de889081a87be,Find the number of patients who had a right heart cardiac catheterization procedure in the last year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'right heart cardiac catheterization' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )"
849c73c34b291683b2d24907,Tell me the drug that was prescribed to patient 10021487 for the first time through the iv route since 09/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) AND prescriptions.route = 'iv' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-09' ORDER BY prescriptions.starttime ASC LIMIT 1"
bed5da859030d9c461ef882a,What was the amount of foley output patient 10038933 has on 09/26/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-09-26'","SELECT SUM(output) FROM foley WHERE foley.stay_id IN ( SELECT stay_id FROM stays WHERE stays.subject_id = 10038933 ) AND strftime('%Y-%m-%d',foley.charttime) = '2100-09-26'"
356df71d59db66ac2534a5d3,Can you tell me the total number of patients who were admitted to the hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE datetime(admissions.admittime) >= datetime(current_time,'-1 year')"
524208cb99d72ea26c67c3f9,How many times did patient 10019385 check into the ICU during this year?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(1) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019385 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')"
e796f650518046002c58ee85,Count the number of patients who were diagnosed with hypospadias but didn't come back to the hospital within 2 months in 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypospadias' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypospadias' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) = '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid FROM ( SELECT pid, to_char(admittime,'YYYY-MM') FROM admissions WHERE to_char(admittime,'YYYY') = '2100' AND diagnoses_icd = 'Q54.9' ) AS T1 JOIN ( SELECT pid, to_char(admittime,'YYYY-MM') FROM admissions WHERE to_char(admittime,'YYYY') = '2100' ) AS T2 ON T1.pid = T2.pid WHERE T1.to_char(admittime,'YYYY-MM') < T2.to_char(admittime,'YYYY-MM') AND datetime(T2.admittime) BETWEEN datetime(T1.admittime) AND datetime(T1.admittime,'+2 month') ) AS T3"
732aa8afc5a1fa558876a572,What is patient 10004235's difference in weight from the last value measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT weight FROM patient_weight WHERE patient_id = 10004235 AND hospital_visit_id IN ( SELECT MIN(hospital_visit_id) FROM hospital_visits WHERE patient_id = 10004235 ) ORDER BY taken_at DESC LIMIT 1 ) - ( SELECT weight FROM patient_weight WHERE patient_id = 10004235 AND hospital_visit_id IN ( SELECT MIN(hospital_visit_id) FROM hospital_visits WHERE patient_id = 10004235 ) ORDER BY taken_at ASC LIMIT 1 )
acf40b3eb276cefbbd1f51be,What is the percentile of 8.0 in urea nitrogen given the same age as patient 10022017 on their first hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10022017 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.0","SELECT DISTINCT T1.C1 FROM ( SELECT R1.C1, PERCENT_RANK() OVER ( ORDER BY R1.C1 ) AS C2 FROM ( SELECT urea_nitrogen, PERCENT_RANK() OVER ( ORDER BY urea_nitrogen ) AS C1 FROM patient_visit_table WHERE patient_visit_table.age = ( SELECT patient_visit_table.age FROM patient_visit_table WHERE patient_visit_table.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT patient_visit_table.hadm_id FROM patient_visit_table WHERE patient_visit_table.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT patient_visit_table.hadm_id FROM patient_visit_table WHERE patient_visit_table.patient_id = 10022017 AND patient_visit_table.dischtime IS NOT NULL ORDER BY patient_visit_table.admittime ASC LIMIT 1 ) ) ) ) ) ) ) AS R1 WHERE R1.urea_nitrogen = 8.0 ) AS T1"
89602c70b4db3bc65be1d577,"List the top three most frequent lab tests that patients were given within the same month after being diagnosed with constipation, unspecified in 2100.","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.labtestname FROM ( SELECT T2.labtestname, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( patient_id ) patient_id, diagnosisdatetime FROM diagnoses WHERE diagnoses.diagnosis = 'constipation, unspecified' AND strftime('%Y',diagnoses.diagnosisdatetime) = '2100' ) AS T1 JOIN ( SELECT DISTINCT ON ( patient_id ) patient_id, labtestdatetime FROM labtests WHERE strftime('%Y',labtests.labtestdatetime) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosisdatetime < T2.labtestdatetime AND datetime(T1.diagnosisdatetime,'start of month') = datetime(T2.labtestdatetime,'start of month') GROUP BY T2.labtestname ) AS T3 WHERE T3.C1 <= 3"
56919090958387812584e77a,"Was lisinopril, warfarin, or heparin prescribed for patient 10012853 in their first hospital encounter?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'lisinopril', 'warfarin', 'heparin' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( 'lisinopril', 'warfarin', 'heparin' )"
622ee2e5af88f64d20afb970,"For patients who underwent respiratory ventilation, 24-96 consecutive hours since 2100, what were the five most common diagnoses during the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d.diagnosis_desc FROM diagnosis d WHERE d.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT o1.person_id, o1.charttime FROM other o1 WHERE o1.itemid IN ( SELECT i.itemid FROM items i WHERE i.label = 'respiratory ventilation, 24-96 consecutive hours' ) AND strftime('%Y',o1.charttime) >= '2100' ) AS T1 JOIN ( SELECT o2.person_id, o2.icd_code, o2.charttime FROM diagnosis o2 WHERE strftime('%Y',o2.charttime) >= '2100' ) AS T2 ON T1.person_id = T2.person_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )"
dcc8c7bc0e4f6fed66288c9e,Which patients were diagnosed with accidental fall from bed since 2100?,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental fall from bed' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT DISTINCT T1.pid FROM ( SELECT T2.pid FROM ( SELECT pid, to_char(admittime,'YYYY') FROM admissions ) AS T1 JOIN ( SELECT pid, to_char(diagtime,'YYYY') FROM diagnoses ) AS T2 ON T1.pid = T2.pid WHERE T1.to_char(admittime,'YYYY') = T2.to_char(diagtime,'YYYY') ) WHERE T2.long_title = 'accidental fall from bed' AND strftime('%Y',T2.diagtime) >= '2100'"
7bef1a39879d33661976e78e,When did patient 10025463 receive a pt laboratory test for the first time?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.hemoglobin_cmv < 12.0 AND labevents.spec_type_desc = 'pt' AND labevents.patient_id = 10025463 ORDER BY labevents.charttime ASC LIMIT 1
1757b6190d9346fb05196adf,What was the name of the specimen test that patient 10007818 received since 06/2100 last?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-06' ORDER BY microbiologyevents.charttime DESC LIMIT 1",SELECT tests.spec_name FROM tests WHERE tests.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.charttime >= '2100-06-01' AND procedures.spec_type IS NOT NULL AND procedures.spec_name IS NOT NULL AND procedures.hadm_id = 10007818 ) ORDER BY tests.charttime DESC LIMIT 1
204b55b1a8a2dbeafa89b76c,Retrieve the yearly maximum l pleural #1 output of patient 10009035.,"SELECT MAX(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'l pleural #1' AND d_items.linksto = 'outputevents' ) GROUP BY strftime('%Y',outputevents.charttime)","SELECT MAX(l_pleural_1_output) FROM patientevents WHERE patientevents.patient_id = 10009035 AND strftime('%Y',patientevents.charttime) IS NOT NULL GROUP BY strftime('%Y',patientevents.charttime)"
fe7098870fdbbc057c054fdc,What are the three frequently ordered medications for patients in their 20s?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT drug, age FROM ( SELECT drug, COUNT(*) OVER ( PARTITION BY drug ) AS C1 FROM prescriptions ) AS T1 WHERE T1.C1 >= ALL ( SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = T1.drug GROUP BY prescriptions.drug ) ) AS T2 WHERE T2.age BETWEEN 20 AND 29 GROUP BY T2.drug ) AS T1 WHERE T1.C1 <= 3"
56393496dcb520b67b7d21d8,How many patients had a bronchial washings test administered since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'bronchial washings' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'bronchial washings' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') )"
5c069998e95156db5e7d2e7e,What is the minimum daily number of patients that are suffering from atherosclerotic heart disease of native coronary artery with unstable angina pectoris?,"SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM ( SELECT subject_id, strftime('%Y-%m-%d',admittime) AS D1 FROM diagnoses WHERE diagnoses.long_title = 'atherosclerotic heart disease of native coronary artery with unstable angina pectoris' ) AS T2 WHERE T2.D1 >= '2100-01-01' GROUP BY T2.D1 ) AS T1"
a75bc1cf0cdc6921d07386f9,What is the average total cost for a hospital that includes a drug called heparin flush (100 units/ml)?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'heparin flush (100 units/ml)' ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.C1) FROM ( SELECT SUM( DRUGS.COST ) AS C1 FROM DRUGS WHERE DRUGS.drug = 'heparin flush (100 units/ml)' GROUP BY DRUGS.hadm_id ) AS T1
f08654b0c2c58546d18b7efb,"Since 16 months ago, what specimen test did patient 10002428 receive for the last time?","SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002428 ) AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-16 month') ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT tests.spec_type_desc FROM tests WHERE tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10002428 ) AND datetime(tests.charttime) >= datetime(current_time,'-16 month') ORDER BY tests.charttime DESC LIMIT 1"
2fcffbbef2cf3c4109b6345d,Has patient 10007795 had a procedure during this year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10007795 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
3a512ac7a9cacbb072843d2a,How many people received a insertion or replacement of external ventricular drain [evd] procedure within 2 months after they had been diagnosed with methicillin resistant pneumonia due to staphylococcus aureus since 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin resistant pneumonia due to staphylococcus aureus' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion or replacement of external ventricular drain [evd]' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'other' AND microbiologyevents.org_name = 'staphylococcus aureus' AND microbiologyevents.resist_name = 'methicillin' AND strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T1 JOIN ( SELECT subject_id, charttime FROM procedures_icd WHERE procedures_icd.icd_code = '0d9920' AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') ) AS T3"
fa7797af0bc8368e7b76a129,How much do patient 10004733's respiratory rate shifts measured at 2100-12-30 17:00:00 compared to the value measured at 2100-12-30 16:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-30 17:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-12-30 16:00:00' ),SELECT ( SELECT respiratory_rate FROM patient_vital_signs WHERE patient_id = 10004733 AND datetime = '2100-12-30 17:00:00' ) - ( SELECT respiratory_rate FROM patient_vital_signs WHERE patient_id = 10004733 AND datetime = '2100-12-30 16:00:00' )
ea764357f7772ceb7cc1de9d,Has patient 10019385 visited the emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.admission_location = 'emergency room',SELECT COUNT(*)>0 FROM emergency_department_visits WHERE emergency_department_visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019385 )
f03742a9f076216fb37d4c2b,When was patient 10021938's SaO2 the first time measured greater than 95.0 on last month/02?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 95.0 AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '02' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT o1.charttime FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT * FROM patient 10021938's oxygen saturation pulseoxymetry ) AS o WHERE o.valuenum > 95.0 AND datetime(o.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',o.charttime) = '02' ) AS o1 WHERE o1.valuenum > 95.0 ORDER BY o1.charttime ASC LIMIT 1"
4c5b6d9ba3e9c1e0f82473db,What is the label for ai ncp - problem resolved?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'ai ncp - problem resolved',SELECT DISTINCT icd11_label FROM icd11 WHERE icd11_code = 'ai ncp - problem resolved'
f430a02bd152c617a86cd2c3,How much is patient 10038933 needed to pay for the cost of their hospital visit in 2100?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y',cost.chargetime) = '2100'","SELECT SUM(1 * cost) FROM cost WHERE cost.event_type = 'hospital visit' AND cost.event_id IN ( SELECT hospital_visit.event_id FROM hospital_visit WHERE hospital_visit.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND strftime('%Y',cost.chargetime) = '2100'"
e6939ccdd15e65dbd229d411,What is the cost of drug called potassium chl 20 meq / 1000 ml d5lr?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' ),SELECT DISTINCT drug_cost.cost FROM drug_cost WHERE drug_cost.drug = 'potassium chl 20 meq / 1000 ml d5lr'
ed91e258dd31d6431b37bd91,What medicine was prescribed to patient 10039708 for the first time since 07/2100?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039708 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10039708 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1"
5d31a8336f838e5062d60d2d,"Has patient 10038999 received the procedure of drainage of left pleural cavity, percutaneous approach, diagnostic in 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code( 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) ) AND procedures_icd.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age = 10038999 ) AND strftime('%Y',procedures_icd.charttime) = '2100'"
91509e2b22c1e7959786b337,When did patient 10009035 first have the maximum level of free calcium during their last hospital encounter?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'free calcium' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1"
e9b5ce5bc64083829c90ddd9,What are the four most frequent drugs that were prescribed to female patients in their 50s during the same hospital encounter after they were diagnosed with unspecified essential hypertension in this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, encounter_id FROM diagnoses WHERE diagnoses.label = 'unspecified essential hypertension' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient_id, encounter_id, drug FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.encounter_id = T2.encounter_id AND T1.charttime < T2.starttime AND T2.gender = 'female' AND T2.age BETWEEN 50 AND 59 GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4"
6985b7163e6c8b9db7102745,Count the number of times that patient 10020740 had tpn w/ lipids since 03/07/2100.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'tpn w/ lipids' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-07'","SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND inputevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'tpn w/ lipids' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-07'"
1c45da439e97eae264e4d7ce,What does warfarin cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'warfarin' ),"SELECT DISTINCT T1.C1 FROM ( SELECT R1.C1 FROM ( SELECT T2.C1 FROM ( SELECT T1.C1, DENSE_RANK() OVER ( ORDER BY T1.C2 ASC ) AS C2 FROM ( SELECT P1.C1, AVG(P1.C2) AS C2 FROM ( SELECT E1.C1, O1.C2 FROM ( SELECT D1.C1 FROM DRUGS D1 WHERE D1.C0 = 'warfarin' ) E1 JOIN ( SELECT C1, C2 FROM ORDERS WHERE C1 IN ( SELECT C1 FROM PATIENTS WHERE C0 = 10021487 ) ) O1 ON E1.C1 = O1.C1 GROUP BY E1.C1, O1.C1 ) P1 GROUP BY P1.C1 ) T1 ) T2 WHERE T2.C1 = ( SELECT T3.C1 FROM ( SELECT T4.C1, DENSE_RANK() OVER ( ORDER BY T4.C2 ASC ) AS C2 FROM ( SELECT T1.C1, AVG(T1.C2) AS C2 FROM ( SELECT P1.C1, P1.C2 FROM ( SELECT E1.C1, O1.C2 FROM ( SELECT D1.C"
6921a2f2bc13f22b2242fbf5,What's the number of patients who were diagnosed with bite of other animal except arthropod since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'bite of other animal except arthropod' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND admissions.diagnoses_icd = ( SELECT diagnoses_icd FROM diagnoses_icd WHERE diagnoses_icd.long_title = 'bite of other animal except arthropod' ) AND strftime('%Y',admissions.admittime) >= '2100'"
675a37ee70bf7108f1389c55,What age was patient 10006580 in their last hospital encounter?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT hospital_encounters.age FROM hospital_encounters WHERE hospital_encounters.hospital_id IN ( SELECT hospital_encounters.hospital_id FROM hospital_encounters WHERE hospital_encounters.patient_id = 10006580 AND hospital_encounters.dischtime IS NOT NULL ORDER BY hospital_encounters.admittime DESC LIMIT 1 )
fdf5fc622de2b8d98e233ad6,What was the drug prescribed to patient 10020740 in 05/2100 for the first time?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) = '2100-05' ORDER BY prescriptions.starttime ASC LIMIT 1"
0645a48c714ef9774ca71964,Please list the three most common procedures carried out this year.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d1.proc_name FROM ( SELECT d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures d WHERE datetime(d.admittime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY d.proc_name ) AS d1 WHERE d1.C1 <= 3"
5c5d37eab2cf65bcaafade09,"Count the number of times that patient 10010471 received the performance of urinary filtration, multiple procedure in the previous year.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'performance of urinary filtration, multiple' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = '0b1f3c7f-0c0f-4d0f-9d0f-0f0f0f0f0f0f' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10010471 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')"
7ed170e256f209788ad3c985,Has there been any organism found in patient 10008454's last mrsa screen microbiological examination since 03/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.org_name IS NOT NULL AND microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10008454 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-03' ORDER BY microbiologyevents.charttime DESC LIMIT 1"
2b4c020024b7a33b31862709,Calculate the total amount of input for patient 10008287 since 05/10/2100.,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008287 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-05-10'","SELECT SUM(input.totalamount) FROM input WHERE input.stay_id IN ( SELECT stay.stay_id FROM stay WHERE stay.hadm_id IN ( SELECT hadm.hadm_id FROM hadm WHERE hadm.subject_id = 10008287 ) ) AND strftime('%Y-%m-%d',input.starttime) >= '2100-05-10'"
fea7c4750795e9fe070f67ba,What was the average monthly number of patients who were diagnosed with accidental fall from bed this year?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidental fall from bed' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM ( SELECT subject_id, strftime('%Y-%m',diagnoses.charttime) FROM diagnoses WHERE diagnoses.long_title = 'accidental fall from bed' ) AS T1 JOIN ( SELECT subject_id, strftime('%Y-%m',admissions.admittime) FROM admissions ) AS T2 ON T1.subject_id = T2.subject_id WHERE strftime('%Y',T1.charttime) = '2100' GROUP BY strftime('%Y-%m',T1.charttime) ) AS T1"
66830a78dcd7a98c6df848db,Get me the patient IDs who were diagnosed with acute systolic heart failure since 2100.,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute systolic heart failure' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT DISTINCT patient_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'acute systolic heart failure' ) AND strftime('%Y',diagnoses.charttime) >= '2100'"
3f4da3a38522ffde6a91dfbf,What is the minimum total cost of the hospital visits when they involve other diagnostic procedures on lung or bronchus since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM( hospital_visits.cost ) AS C1 FROM hospital_visits WHERE hospital_visits.hospital_visits_id IN ( SELECT procedures_hospital_visits.hospital_visits_id FROM procedures_hospital_visits WHERE procedures_hospital_visits.procedures_id IN ( SELECT procedures.procedures_id FROM procedures WHERE procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) ) AND strftime('%Y',hospital_visits.admittime) >= '2100' GROUP BY hospital_visits.hospital_visits_id ) AS T1"
08d0d78c62b440d145b0c56d,"What were the four most commonly given diagnoses for patients that had previously received a respiratory ventilation, 24-96 consecutive hours within 2 months, since 2100?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d1.diagnosis_desc FROM ( SELECT d.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnosis d WHERE d.charttime >= '2100-01-01' AND d.hadm_id IN ( SELECT t1.hadm_id FROM ( SELECT t.hadm_id, t.charttime FROM ( SELECT o.hadm_id, o.charttime FROM ( SELECT o.hadm_id, o.charttime FROM procedures o WHERE o.procedure_name = 'respiratory ventilation, 24-96 consecutive hours' ) t WHERE t.charttime >= '2100-01-01' ) t1 JOIN ( SELECT o.hadm_id, o.charttime FROM ( SELECT o.hadm_id, o.charttime FROM diagnosis o WHERE o.diagnosis_desc = 'other and unspecified hyperlipidemia' ) t WHERE t.charttime >= '2100-01-01' ) t2 ON t1.hadm_id = t2.hadm_id WHERE t1.charttime < t2.charttime AND datetime(t2.charttime) BETWEEN datetime(t1.charttime) AND datetime(t1.charttime) + interval '2' month ) ) d GROUP BY d.diagnosis_desc ) d1 WHERE d1.C1 <="
c3546915506c74cfcbd2b9ce,Show me the top five most frequently prescribed medications since 1 year ago.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM prescriptions WHERE datetime >= datetime(current_time,'-1 year') ) GROUP BY drug ) AS T1 WHERE T1.C1 <= 5"
6b1fe6a4f18cb1365ffa3764,What are patient 10004720's changes in weight last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT weight FROM patient_vitals WHERE patient_id = 10004720 AND hospital_visit_id IN ( SELECT MIN(hospital_visit_id) FROM patient_hospital_visits WHERE patient_id = 10004720 ) ORDER BY charttime DESC LIMIT 1 ) - ( SELECT weight FROM patient_vitals WHERE patient_id = 10004720 AND hospital_visit_id IN ( SELECT MIN(hospital_visit_id) FROM patient_hospital_visits WHERE patient_id = 10004720 ) ORDER BY charttime DESC LIMIT 1 OFFSET 1 )
1353dc68fd8a615fdfb1a80d,What is the cost for diagnosis of other convulsions?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other convulsions' ) ),SELECT DISTINCT cost FROM cost WHERE cost.event_type = 'diagnosis' AND cost.event_id IN ( SELECT diagnosis.id FROM diagnosis WHERE diagnosis.long_title = 'other convulsions' )
282f008dd8dfb8f4a1dd6999,Tell me the name of the organism that was detected in the last urine test of patient 10027602 on their first hospital visit?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT organisms.org_name FROM organisms WHERE organisms.test_id IN ( SELECT tests.test_id FROM tests WHERE tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10027602 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND tests.spec_type_desc = 'urine' AND tests.org_name IS NOT NULL ORDER BY tests.charttime DESC LIMIT 1 )
0bef44d46b407af716e48911,How much of a difference is there in patient 10018328's respiratory rate measured at 2100-05-15 14:00:00 compared to the value measured at 2100-05-15 13:00:00?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-05-15 14:00:00' ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.charttime = '2100-05-15 13:00:00' ),SELECT ( SELECT respiratory_rate FROM patient_vital_signs WHERE patient_id = 10018328 AND datetime = '2100-05-15 14:00:00' ) - ( SELECT respiratory_rate FROM patient_vital_signs WHERE patient_id = 10018328 AND datetime = '2100-05-15 13:00:00' )
4b28b1a0b4ccc7c20dbda5bc,What are the top four most frequent output events since 1 year ago?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d.output_desc FROM ( SELECT output_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime >= datetime(current_time,'-1 year') GROUP BY output_desc ) AS d WHERE d.C1 <= 4"
e3d036a9b6ba87b79199b9e2,What was the name of the procedure that was performed two or more times since 10 months ago on patient 10020740?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-10 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT procedures.name FROM procedures WHERE procedures.chartevents_charttime >= datetime(current_time,'-10 month') AND procedures.chartevents_rowid IN ( SELECT T1.chartevents_rowid FROM ( SELECT chartevents_rowid, procedures.name, COUNT( procedures.chartevents_rowid ) AS C1 FROM procedures WHERE procedures.chartevents_charttime >= datetime(current_time,'-10 month') AND procedures.chartevents_subjectid = 10020740 GROUP BY procedures.chartevents_rowid ) AS T1 WHERE T1.C1 >= 2 )"
3f777e85538090faa2446aeb,"Since 1 year ago, what are the top five most commonly taken specimens for patients in the same hospital encounter after the diagnosis of intestinal infection due to other organism, not elsewhere classified?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'intestinal infection due to other organism, not elsewhere classified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM diagnoses_icd WHERE diagnoses_icd.long_title = 'intestinal infection due to other organism, not elsewhere classified' ) AS T1 JOIN ( SELECT * FROM procedures_icd WHERE procedures_icd.long_title = 'specimen taken' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE datetime(T1.charttime) >= datetime(current_time,'-1 year') AND datetime(T2.charttime) >= datetime(current_time,'-1 year') AND T1.charttime < T2.charttime AND T1.encounter_id = T2.encounter_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5"
7aea773bb0cb8d7705a8afa2,Calculate the length of stay in days for patient 10031757's first hospital stay.,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = 10031757 AND visits.gender = 'M' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"
f4668740245afefef8cada48,"Tell me the diagnosis cost of acquired absence of organ, genital organs in a patient?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acquired absence of organ, genital organs' ) )","SELECT DISTINCT T1.C1 FROM ( SELECT SUM( DRGCosts.cost ) AS C1 FROM DRGCosts WHERE DRGCosts.drg = ( SELECT DRGCosts.drg FROM DRGCosts WHERE DRGCosts.label = 'acquired absence of organ, genital organs' ) GROUP BY DRGCosts.drg ) AS T1"
8bfea1a0b78f2e98d30ee271,When was patient 10004422 for the first time leaving the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10004422 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1",SELECT discharge_time FROM discharge WHERE discharge.time IS NOT NULL AND discharge.patient_id = 10004422 ORDER BY discharge.time ASC LIMIT 1
b41f33bd6784e344776668f2,What was the first dose of 0.9% sodium chloride (mini bag plus) given to patient 10015931?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND prescriptions.drug = '0.9% sodium chloride (mini bag plus)' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT MIN(inputamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND inputevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = '0.9% sodium chloride (mini bag plus)' )
2e773c48c344e7f33a29892f,What was last procedure time of patient 10018423 since 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018423 ) AND strftime('%Y',procedures.starttime) >= '2100' ORDER BY procedures.starttime DESC LIMIT 1"
69c8cd3610b365b38e9dc8fb,Has patient 10004235 received the endoscopic insertion of stent (tube) into bile duct procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'endoscopic insertion of stent (tube) into bile duct' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ),SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = '0b1c0zz' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004235 )
d4de34dfac56b48ccafd9eb4,Can you tell me the top three most common procedures since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d1.proc_name FROM ( SELECT d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd d WHERE strftime('%Y',d.charttime) >= '2100' GROUP BY d.proc_name ) AS d1 WHERE d1.C1 <= 3"
8223cedf8e150ea026676246,Tell me the name of the specimen test patient 10011398 last got since 12/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-12' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT procedures.spec_type_desc FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10011398 ) AND strftime('%Y-%m',procedures.charttime) >= '2100-12' ORDER BY procedures.charttime DESC LIMIT 1"
37b440fc3a82a50003dce7ed,"What was patient 10019385's last creatine kinase, mb isoenzyme lab test time in their last hospital encounter?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'creatine kinase, mb isoenzyme' ) ORDER BY labevents.charttime DESC LIMIT 1"
f3d8bb52562c47ecba357230,"What were the top four most frequent microbiology tests that patients were given after being diagnosed with cerebral aneurysm, nonruptured during the same month in 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral aneurysm, nonruptured' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM diagnosis WHERE diagnosis.description = 'cerebral aneurysm, nonruptured' AND strftime('%Y',diagnosis.charttime) = '2100' ) AS T1 JOIN ( SELECT * FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4"
d7835456c04a228c24df961d,What is the number of patients who died after diagnosis of septic shock within 2 months during the last year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'septic shock' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-1 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-1 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE ( datetime(T3.dod) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') ) OR ( datetime(T2.charttime) BETWEEN datetime(T3.dod) AND datetime(T3.dod,'+2 month') )","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.charttime FROM ( SELECT pid, charttime FROM diagnoses WHERE diagnoses.long_title = 'septic shock' ) AS T1 WHERE T1.charttime >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT pid, charttime FROM ( SELECT pid, charttime FROM chartevents WHERE chartevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.label = 'daily weight' ) ) AS T2 WHERE T2.charttime >= datetime(current_time,'-1 year') ) AS T2 ON T1.pid = T2.pid WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') AND T2.valuenum = 1"
5459fc4c053a74300114b32b,Give me the top four most commonly prescribed drugs since 2100.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' GROUP BY drug ) AS T1 WHERE T1.C1 <= 4"
32bb1be23959c4c55393389e,What was the insurance name of patient 10035185 during their last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT insurance_name FROM insurance WHERE insurance.patient_id = 10035185 AND insurance.hadm_id IN ( SELECT hadm_id FROM hospital_visit WHERE hospital_visit.patient_id = 10035185 AND hospital_visit.dischtime IS NOT NULL ORDER BY hospital_visit.admittime DESC LIMIT 1 )
cd8edc01787dda933e12fd99,When patient 10021312 had the first void output since 09/16/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-09-16' ORDER BY outputevents.charttime ASC LIMIT 1","SELECT outputevents.time FROM outputevents WHERE outputevents.patient_id = 10021312 AND outputevents.output = 'void' AND strftime('%Y-%m-%d',outputevents.time) >= '2100-09-16' ORDER BY outputevents.time ASC LIMIT 1"
8dabcc278b6954eec05639ff,What is the total amount of dextrose 5% input that patient 10039831 got since 02/05/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-05'","SELECT SUM(inputamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND inputevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'dextrose 5%' AND items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-05'"
bc98931efa8f80d2a3e2aa4d,What were the specimen tests that patient 10002930 first had in 08/this year?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002930 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '08' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT specimen_tests.spec_type FROM specimen_tests WHERE specimen_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND datetime(specimen_tests.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',specimen_tests.charttime) = '08' ORDER BY specimen_tests.charttime ASC LIMIT 1"
7e06fac998444826d31f711c,"In 2100, what is the top three most frequent diagnoses that patients had within 2 months after receiving anastomosis of hepatic duct to gastrointestinal tract?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'anastomosis of hepatic duct to gastrointestinal tract' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d1.label FROM ( SELECT d.label, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses d WHERE d.charttime IN ( SELECT T3.charttime FROM ( SELECT T2.charttime, T1.row_id FROM ( SELECT procedures.row_id, procedures.charttime FROM procedures WHERE procedures.label = 'anastomosis of hepatic duct to gastrointestinal tract' AND strftime('%Y',procedures.charttime) = '2100' ) AS T1 JOIN ( SELECT diagnoses.row_id, diagnoses.charttime FROM diagnoses WHERE strftime('%Y',diagnoses.charttime) = '2100' ) AS T2 ON T1.row_id = T2.row_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') ) AS T3 ) GROUP BY d.label ) AS d1 WHERE d1.C1 <= 3"
9fef61b6024912cd87201c6a,What are the top three most common diagnoses that patients had within 2 months after receiving injection of anesthetic into spinal canal for analgesia this year?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'injection of anesthetic into spinal canal for analgesia' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d1.diagnosis_desc FROM ( SELECT d.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses d WHERE d.charttime IN ( SELECT T3.charttime FROM ( SELECT T2.charttime, T1.charttime FROM ( SELECT procedures.charttime, procedures.hadm_id FROM procedures WHERE procedures.label = 'injection of anesthetic into spinal canal for analgesia' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT diagnoses.charttime, diagnoses.hadm_id FROM diagnoses WHERE datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') ) AS T3 WHERE T3.charttime IN ( SELECT diagnoses.charttime FROM diagnoses WHERE diagnoses.hadm_id = T3.hadm_id ) GROUP BY d.diagnosis_desc ) AS d1 WHERE d1.C1 <= 3"
f147512eb438041a5186bf3e,What was the total output of patient 10014354 since 09/07/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-09-07'","SELECT SUM(output) FROM patientoutput WHERE patientoutput.patient_id = 10014354 AND strftime('%Y-%m-%d',patientoutput.charttime) >= '2100-09-07'"
ca02915764bab9c149d0c83e,"What are the four most commonly taken specimens that patients were tested in the same hospital encounter after receiving a respiratory ventilation, 24-96 consecutive hours procedure since 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'respiratory ventilation, 24-96 consecutive hours' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT procedure_event_table.hadm_id, procedure_event_table.charttime FROM procedure_event_table WHERE procedure_event_table.procedure_desc = 'respiratory ventilation, 24-96 consecutive hours' AND strftime('%Y',procedure_event_table.charttime) >= '2100' ) AS T1 JOIN ( SELECT specimen_event_table.hadm_id, specimen_event_table.spec_type_desc, specimen_event_table.charttime FROM specimen_event_table WHERE strftime('%Y',specimen_event_table.charttime) >= '2100' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of visit') = datetime(T2.charttime,'start of visit') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4"
7fef015e3c73d010f8ac487e,What is the count of patients who were in the coronary care unit (ccu) careunit in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'coronary care unit (ccu)' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.careunit = 'coronary care unit (ccu)' AND strftime('%Y',admissions.admittime) = '2100'"
1fcac336ef5d4a18372aeae5,What was the last prescribed dose of docusate sodium (liquid) that patient 10021487 got during the current hospital visit?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'docusate sodium (liquid)' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'docusate sodium (liquid)' ) AND admissions.dischtime IS NULL ) ) AND prescriptions.drug = 'docusate sodium (liquid)' ORDER BY prescriptions.starttime DESC LIMIT 1
96b1d3fe1090aafcf5bcc954,When did patient 10008454 first have foley output since 12/04/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-04' ORDER BY outputevents.charttime ASC LIMIT 1","SELECT foleyevents.charttime FROM foleyevents WHERE foleyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) AND strftime('%Y-%m-%d',foleyevents.charttime) >= '2100-12-04' ORDER BY foleyevents.charttime ASC LIMIT 1"
e82244401b22ffb372a139b9,"What is the minimum total hospital cost when it includes measurement of cardiac sampling and pressure, left heart, percutaneous approach?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM( hospital_charges.charttime ) AS C1 FROM hospital_charges WHERE hospital_charges.hospital_id IN ( SELECT procedures_icd.hospital_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'measurement of cardiac sampling and pressure, left heart, percutaneous approach' ) ) GROUP BY hospital_charges.hospital_id ) AS T1"
31bc055f744e30a632a2f021,Count the number of patients who had a lactate dehydrogenase (ld) test done since 2100.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND strftime('%Y',labevents.charttime) >= '2100' )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT labevents.patients_pid FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'lactate dehydrogenase (ld) test' ) AND strftime('%Y',labevents.charttime) >= '2100' )"
7559da6b7b189084f45242ea,Was patient 10020944 to the e.r. in their first hospital visit?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10020944 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*)>0 FROM emergency_room_visits WHERE emergency_room_visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020944 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )
dd1f1e6825a6f105f91f7d0e,"What proportion of patients with a diagnosis of spinal stenosis, lumbar region, with neurogenic claudication survive over a 6-month period?","SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/2 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'spinal stenosis, lumbar region, with neurogenic claudication' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT AVG(C1) AS C1 FROM ( SELECT T2.C1, T1.C2 FROM ( SELECT T1.C1, T1.C2, DENSE_RANK() OVER ( ORDER BY T1.C1 ASC ) AS C3 FROM ( SELECT ( COUNT(DISTINCT diagnoses.chart_id) * 1.0 / COUNT( DISTINCT patients.chart_id ) ) AS C1, strftime('%Y',diagnoses.charttime) AS C2 FROM diagnoses JOIN patients ON diagnoses.chart_id = patients.chart_id WHERE diagnoses.long_title = 'spinal stenosis, lumbar region, with neurogenic claudication' GROUP BY C2 ) AS T1 ) AS T1 JOIN ( SELECT ( COUNT(DISTINCT diagnoses.chart_id) * 1.0 / COUNT( DISTINCT patients.chart_id ) ) AS C1, strftime('%Y',diagnoses.charttime) AS C2 FROM diagnoses JOIN patients ON diagnoses.chart_id = patients.chart_id WHERE diagnoses.long_title = 'spinal stenosis, lumbar region, with neurogenic claudication' GROUP BY C2 ) AS T2 ON T1.C2 = T2.C2 WHERE T1.C3 <= 6 ) AS T3"
101023c9d00c778450601539,Calculate the length of stay in days for patient 10007928's last hospital stay.,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","SELECT strftime('%J',dischtime) - strftime('%J',admittime) FROM hospital_visits WHERE hospital_visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10007928 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )"
f9ae9091bbfcec86ccce09d6,"In 2100, what was the top three most frequent laboratory tests ordered for patients after the diagnosis of family history of malignant neoplasm of prostate during the same month?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'family history of malignant neoplasm of prostate' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',labevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'family history of malignant neoplasm of prostate' AND strftime('%Y',diagnoses.diagnosis_date) = '2100' ) AS T1 JOIN ( SELECT patient_id, lab_test_name, lab_test_date FROM laboratory_tests WHERE strftime('%Y',laboratory_tests.lab_test_date) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.lab_test_date AND datetime(T1.diagnosis_date,'start of month') = datetime(T2.lab_test_date,'start of month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3"
9d55be8800c23366c5a86393,How many patients during the previous year were given a bicarbonate test?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bicarbonate' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT labevents.pid FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'bicarbonate' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )"
c814a79881c8be3a4809fdb9,Get patient 10018423's monthly minimum weight information in 2100.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y',chartevents.charttime) = '2100' GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT MIN(o1.valuenum) FROM ( SELECT o.valuenum, strftime('%Y-%m',o.charttime) AS time FROM chartevents o WHERE o.stay_id IN ( SELECT i.stay_id FROM patients i WHERE i.subject_id = 10018423 ) AND o.itemid IN ( SELECT p.itemid FROM d_icd_procedures p WHERE p.long_title = 'weight' ) AND strftime('%Y',o.charttime) = '2100' GROUP BY strftime('%Y-%m',o.charttime) ) AS o1"
71f42d6affc0c51c8579d29f,Find out the number of patients who were discharged from the hospital.,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is NOT NULL
e134d64a96cc7940427b44cf,Did patient 10003046 get a pco2 test in their last hospital visit?,SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pco2' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*)>0 FROM pco2 WHERE pco2.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )
99659e62f4677c9b6f10903d,"What is the minimum monthly number of patients that are suffering from allergic rhinitis, cause unspecified since 1 year ago?","SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'allergic rhinitis, cause unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY strftime('%Y-%m',diagnoses_icd.charttime) ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM ( SELECT subject_id, datetime(admittime) FROM admissions WHERE admissions.diagnosis = 'allergic rhinitis, cause unspecified' ) AS T1 JOIN ( SELECT subject_id, datetime(admittime) FROM admissions WHERE datetime(admittime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.admittime,'start of month') = datetime(T2.admittime,'start of month') GROUP BY strftime('%Y-%m',T1.admittime) ) AS T1"
f64502ea7695fae28227dfce,Did patient 10005817 receive solution on 12/24/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'solution' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND inputevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'solution' AND items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'"
8101d176c45f4e285b9e9540,How many patients were prescribed the medicine ferric gluconate within 2 months after a diagnosis of ankylosing spondylitis since 2100?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'ankylosing spondylitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ferric gluconate' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.time1 FROM ( SELECT pid, drgtime FROM diagnoses WHERE diagnoses.label = 'ankylosing spondylitis' AND strftime('%Y',drgtime) >= '2100' ) AS T1 JOIN ( SELECT pid, drgtime FROM prescriptions WHERE prescriptions.drug = 'ferric gluconate' AND strftime('%Y',prescriptions.drgtime) >= '2100' ) AS T2 ON T1.pid = T2.pid WHERE T1.drgtime < T2.drgtime AND datetime(T2.drgtime) BETWEEN datetime(T1.drgtime) AND datetime(T1.drgtime,'+2 month') ) AS T3"
3c23367e7687645342a44a61,Show me the top three most commonly prescribed drugs during the same month for patients in their 30s after a unspecified essential hypertension diagnosis.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 30 AND 39 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.row_id, T1.charttime FROM ( SELECT * FROM diagnosis WHERE diagnosis = 'unspecified essential hypertension' ) AS T1 JOIN ( SELECT * FROM patients WHERE patients.age BETWEEN 30 AND 39 ) AS T2 ON T1.hadm_id = T2.hadm_id ) AS T3 JOIN ( SELECT * FROM ( SELECT T1.row_id, T1.charttime FROM ( SELECT * FROM diagnosis WHERE diagnosis = 'unspecified essential hypertension' ) AS T1 JOIN ( SELECT * FROM patients WHERE patients.age BETWEEN 30 AND 39 ) AS T2 ON T1.hadm_id = T2.hadm_id ) AS T3 JOIN ( SELECT * FROM prescriptions ) AS T4 ON T3.row_id = T4.hadm_id WHERE datetime(T3.charttime,'start of month') = datetime(T4.starttime,'start of month') ) AS T5 ON T3.row_id = T5.row_id ) AS T2 GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3"
2c251f13cfc63c34883bcbcd,Has there been any microbiological urine tests for patient 10005348 in 08/last year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005348 ) AND microbiologyevents.spec_type_desc = 'urine' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',microbiologyevents.charttime) = '08'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hcpcscat = ( SELECT hcpcscat FROM hcpcscat WHERE hcpcscat = 'microbiological urine tests' ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.spec_type_desc IS NOT NULL AND microbiologyevents.patient_id = 10005348 AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',microbiologyevents.charttime) = '08'"
740f87417b7715602b678286,"Did patient 10029484 have any tests for creatine kinase, mb isoenzyme during the previous month?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatine kinase, mb isoenzyme' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month')","SELECT COUNT(*)>0 FROM lab_tests WHERE lab_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10029484 ) AND lab_tests.item = 'creatine kinase, mb isoenzyme' AND datetime(lab_tests.charttime,'start of month') = datetime(current_time,'start of month','-1 month')"
5c22be4f508798bea10dfa73,"What is the 3-month survival rate for patients diagnosed with pleural effusion, not elsewhere classified.","SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pleural effusion, not elsewhere classified' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT T2.C1, DENSE_RANK() OVER ( ORDER BY T2.C1 ASC ) AS C2 FROM ( SELECT COUNT(*)>0 AS C1 FROM ( SELECT T1.row_number() OVER ( ORDER BY T1.charttime ASC ) AS C1 FROM ( SELECT * FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.long_title = 'pleural effusion, not elsewhere classified' ) ) AS T1 JOIN ( SELECT * FROM patients ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.dischtime IS NOT NULL AND datetime(T1.charttime) >= datetime(current_time,'-3 month') GROUP BY T1.row_number() OVER ( ORDER BY T1.charttime ASC ) ) ) AS T2 GROUP BY T2.C1 ) AS T1"
43da3486df026843872b9af4,What was the admission type for patient 10019172's first hospital admission?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.charttime IS NOT NULL ORDER BY diagnoses.charttime ASC LIMIT 1 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1
f5b332414c271567297ba2c9,When did patient 10022041 first have an input event?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) ORDER BY inputevents.starttime ASC LIMIT 1,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT stays.stay_id FROM stays WHERE stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) ORDER BY inputevents.starttime ASC LIMIT 1
01eb9179a54a0f80fb0189a6,"For patients diagnosed with pain in left shoulder previously, what are the top five most common procedures applied within 2 months in 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pain in left shoulder' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d1.proc_desc FROM ( SELECT d.proc_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT t1.subject_id, t1.charttime FROM ( SELECT subject_id, charttime FROM diagnosis WHERE diagnosis = 'pain in left shoulder' ) AS t1 WHERE t1.charttime < 2100 * 1000 * 1000 * 24 * 30 ) AS t2 JOIN ( SELECT subject_id, charttime, proc_desc FROM procedures WHERE strftime('%Y',procedures.charttime) = '2100' ) AS d ON t2.subject_id = d.subject_id WHERE t2.charttime < d.charttime AND datetime(d.charttime) BETWEEN datetime(t2.charttime) AND datetime(t2.charttime,'+2 month') GROUP BY d.proc_desc ) AS d1 WHERE d1.C1 <= 5"
393ccf93d06553bf2947a17a,What are the four most frequent drugs that were prescribed to male patients in their 30s during the same month after they were diagnosed with hyposmolality and/or hyponatremia during this year?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyposmolality and/or hyponatremia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 30 AND 39 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'hyposmolality and/or hyponatremia' AND datetime(diagnoses.diagnosis_date,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient_id, drug, prescription_date FROM prescriptions WHERE datetime(prescriptions.prescription_date,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.prescription_date AND datetime(T1.diagnosis_date,'start of month') = datetime(T2.prescription_date,'start of month') AND T1.patient_id IN ( SELECT patient_id FROM patients WHERE patients.gender = 'male' AND floor((strftime('%J',current_time) - strftime('%J',patients.dob)) / 365.25) BETWEEN 30 AND 39 ) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4"
949dc9ac2dfec702b23219cc,Tell me the top four most frequent diagnoses of patients of age 40s.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )",SELECT d.diagnosis_desc FROM diagnosis d WHERE d.age BETWEEN 40 AND 49 GROUP BY d.diagnosis_desc ORDER BY COUNT(*) DESC LIMIT 4
5e15ef576080a675d598f4f4,How many current patients are of 60 or above age?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age >= 60,SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.age >= 60 AND patients.dischtime IS NULL
eccaf3ea4033b34c3afac111,Tell me the percentile of creatinine of 2.7 in patients of the same age as patient 10016150 on the first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10016150 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.7","SELECT DISTINCT T1.C1 FROM ( SELECT 2.7 AS C1, PERCENT_RANK() OVER ( ORDER BY 2.7 ) AS C2 FROM patients WHERE patients.age = ( SELECT patients.age FROM patients WHERE patients.subject_id = 10016150 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1 ) ) AS T1"
92f0b914005e5b93474fac4e,Can you name the first outputs of patient 10013049 in their last ICU visit?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY outputevents.charttime ASC LIMIT 1 ),SELECT outputs.output FROM outputs WHERE outputs.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY outputs.charttime ASC LIMIT 1
e0693814cc896b83b3416d2d,Is the value of respiratory rate in patient 10016742 from second measurement on the first ICU visit greater than its first measurement on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT respiratory_rate FROM patient_vitals WHERE patient_id = 10016742 AND ICU_visit_nr = 1 ORDER BY charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT respiratory_rate FROM patient_vitals WHERE patient_id = 10016742 AND ICU_visit_nr = 1 ORDER BY charttime ASC LIMIT 1 )
37d260bf174746e3b0f83bb0,"What are the five most commonly prescribed drugs for patients diagnosed with postprocedural fever previously within the same hospital visit, in 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural fever' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, visit_id FROM diagnoses WHERE diagnoses.label = 'postprocedural fever' AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT patient_id, visit_id, drug FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.visit_id = T2.visit_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
4a73f78af6f830619516e24b,When did patient 10005909 experience the last instance where their heart rate was less than 115.0 in their last ICU stay?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 115.0 ORDER BY chartevents.charttime DESC LIMIT 1,SELECT heart_rateevents.charttime FROM heart_rateevents WHERE heart_rateevents.heart_rate < 115.0 AND heart_rateevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND heart_rateevents.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY heart_rateevents.charttime DESC LIMIT 1
5cf885d109f3f215844f994e,How many hours have passed since patient 10004733's last stay in careunit medical/surgical intensive care unit (micu/sicu) in this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', ( SELECT careevents.outtime FROM careevents WHERE careevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 AND admissions.dischtime IS NULL ) AND careevents.careunit = 'medical/surgical intensive care unit (micu/sicu)' ORDER BY careevents.intime DESC LIMIT 1 ) ) )"
62a5029a9781c0cb6bcc7ce6,What new prescriptions were given to patient 10004733 today compared to those given yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id = 10004733 AND datetime(admissions.admittime,'start of day') = datetime(current_time,'start of day','-1 day') ) ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id = 10004733 AND datetime(admissions.admittime,'start of day') = datetime(current_time,'start of day') ) ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day')"
f1dd398aaf1b00d4a562b899,How much is the difference of weights of patient 10037975 second measured on the last hospital visit compared to the first value measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT weight FROM patient_vitals WHERE patient_id = 10037975 AND hospital_visit_id IN ( SELECT MAX(hospital_visit_id) FROM patient_visits ) ORDER BY datetime ASC LIMIT 1 OFFSET 1 ) - ( SELECT weight FROM patient_vitals WHERE patient_id = 10037975 AND hospital_visit_id IN ( SELECT MAX(hospital_visit_id) FROM patient_visits ) ORDER BY datetime ASC LIMIT 1 )
a4aeae6cbe8fff13d7e4d651,What was the total output amount for patient 10014729 on 03/05/this year?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-05'","SELECT SUM(output) FROM patientoutput WHERE patientoutput.patient_id = 10014729 AND datetime(patientoutput.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',patientoutput.charttime) = '03-05'"
1cb7346d2299d0467b9fcb27,"In 03/last year, was the respiratory rate of patient 10020187 ever greater than 12.0?","SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 12.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',chartevents.charttime) = '03'","SELECT COUNT(*)>0 FROM respiratory_vitals WHERE respiratory_vitals.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020187 ) AND respiratory_vitals.rate > 12.0 AND datetime(respiratory_vitals.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',respiratory_vitals.charttime) = '03'"
8c531cd9b0af5ba949b9fa91,How many hours have it been since patient 10021487's first free calcium lab test during their current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT itemid FROM d_icditems WHERE d_icditems.long_title = 'free calcium' AND d_icditems.icd_code = labevents.icd_code ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.visitcharttime = current_time ) ) AND admissions.dischtime IS NULL ) ) ORDER BY labevents.charttime ASC LIMIT 1"
6bb8d0b3a6e2b6227b56f595,Tell me patient 10038081's first oxygen value on the first hospital stay.,SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'oxygen' ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT o2o1o1.o2value FROM o2o1o1 WHERE o2o1o1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY o2o1o1.charttime ASC LIMIT 1
ec89baea1f34f1904eed2a70,"Among patients who were prescribed with potassium chl 40 meq / 1000 ml ns, what are the top four most frequently prescribed drugs at the same time since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'potassium chl 40 meq / 1000 ml ns' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, prescription_start_time FROM prescriptions WHERE drug = 'potassium chl 40 meq / 1000 ml ns' AND datetime(prescription_start_time) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT patient_id, drug, prescription_start_time FROM prescriptions WHERE datetime(prescription_start_time) >= datetime(current_time,'-1 year') ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.prescription_start_time = T2.prescription_start_time GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4"
89a854beb29f40da67997b3c,What was patient 10039831's first diastolic blood pressure value since 12/13/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-12-13' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT blood_pressure_diastolic FROM patient_vitals WHERE patient_id = 10039831 AND strftime('%Y-%m-%d',blood_pressure_diastolic.charttime) >= '2100-12-13' ORDER BY blood_pressure_diastolic.charttime ASC LIMIT 1"
7a1d975dc39f51887f287327,Is patient 10020944 recorded as male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020944,SELECT DISTINCT patients.gender FROM patients WHERE patients.subject_id = 10020944
0552fb2fb3c9ef8054e31fe0,How many times since 2100 did patient 10005817 visit the hospital?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10005817 AND strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT( DISTINCT visits.visit_id ) FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005817 ) AND strftime('%Y',visits.admittime) >= '2100'"
2e3cccfa4f52265b94f8579f,What is the minimum total hospital cost involving a procedure named thoracentesis in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracentesis' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM( procedures.cost ) AS C1 FROM procedures WHERE procedures.name = 'thoracentesis' AND strftime('%Y',procedures.charttime) = '2100' GROUP BY procedures.hadm_id ) AS T1"
dc1ccc85cf5b684ab55c2b09,Can you tell me the number of patients who were prescribed methylnaltrexone?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'methylnaltrexone' ),SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT prescriptions.pid FROM prescriptions WHERE prescriptions.drug = 'methylnaltrexone' )
96ac404e31dae66aaf3c7df0,How much difference is there in respiratory rate levels among patient 10019777 last measured on the last ICU visit compared to the value second to last measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT respiratory_rate FROM patient10019777_icustays_otherdata WHERE icustay_id IN ( SELECT icustay_id FROM patient10019777_icustays WHERE last == True ) ORDER BY charttime DESC LIMIT 1 ) - ( SELECT respiratory_rate FROM patient10019777_icustays_otherdata WHERE icustay_id IN ( SELECT icustay_id FROM patient10019777_icustays WHERE last == True ) ORDER BY charttime DESC LIMIT 1 OFFSET 1 )
7329fbf5056c86af263e9033,Could you show me the total void output of patient 10024043?,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ),SELECT SUM(output) FROM output WHERE output.event_type = 'void' AND output.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10024043 )
e94fc44f50cb46d93aaa3008,Could you show me the top five most common diagnoses since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )",SELECT d.diagnosis_desc FROM diagnoses d WHERE d.charttime >= '2100-01-01' GROUP BY d.diagnosis_desc ORDER BY COUNT(*) DESC LIMIT 5
99674b531e81a982dc797973,"What are the five most common microbiology tests for patients that had previously received introduction of other thrombolytic into peripheral vein, percutaneous approach within the same hospital visit since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into peripheral vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( patient_id, microbiologyevents.charttime ) patient_id, microbiologyevents.charttime FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T1 JOIN ( SELECT DISTINCT ON ( patient_id, thrombolyticevents.charttime ) patient_id, thrombolyticevents.charttime FROM thrombolyticevents WHERE thrombolyticevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.icd_code = '0bfb2f' ) AND strftime('%Y',thrombolyticevents.charttime) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of visit') = datetime(T2.charttime,'start of visit') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5"
94122ab2640e86cea1d8cefe,Retrieve the top four most frequent procedures that patients underwent in the same hospital visit after being diagnosed with noncompliance with renal dialysis.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'noncompliance with renal dialysis' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d3.procedure_name FROM ( SELECT d2.procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM diagnoses WHERE diagnoses.long_title = 'noncompliance with renal dialysis' ) AS T1 JOIN ( SELECT subject_id, charttime FROM procedures ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') ) AS T3 JOIN ( SELECT subject_id, charttime FROM procedures ) AS T4 ON T3.subject_id = T4.subject_id WHERE T3.charttime < T4.charttime AND datetime(T3.charttime,'start of month') = datetime(T4.charttime,'start of month') ) AS T2 GROUP BY d2.procedure_name ) AS d3 WHERE d3.C1 <= 4"
805a7efe25e2ce496220ee26,What was the admission type during the first hospital admission for patient 10019172?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.admittime ASC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.charttime IS NOT NULL ORDER BY diagnoses.charttime ASC LIMIT 1 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1
c58538af9651b0425098d396,"In 07/2100, when was the first time patient 10020786 was prescribed medication via the iv drip route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) AND prescriptions.route = 'iv drip' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.stopschedtime IS NOT NULL AND prescriptions.holdreason IS NULL AND prescriptions.patientid = 10020786 AND prescriptions.route = 'iv drip' AND strftime('%Y-%m',prescriptions.starttime) = '2100-07' ORDER BY prescriptions.starttime ASC LIMIT 1"
db7f20610bfa0be1f5377ba9,What was the admission type during the first hospital admission for patient 10021118?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10021118 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime ASC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.charttime IS NOT NULL ORDER BY diagnoses.charttime ASC LIMIT 1 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1
89fa29a6a2fb6b1fff321ece,How is ferrous sulfate (liquid) delivered?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'ferrous sulfate (liquid)',SELECT DISTINCT d.route FROM drug_route d WHERE d.drug = 'ferrous sulfate (liquid)'
536c8f181f6fd31f9a127cfa,What were the number of patients discharged from the hospital?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL,SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is NOT NULL
1718f0835a82b0bb7c0517f1,"Since 14 months ago, what was the weight of patient 10016742 in the first measurement?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-14 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT weight_val FROM weight WHERE weight.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10016742 ) AND datetime(weight.charttime) >= datetime(current_time,'-14 month') ORDER BY weight.charttime ASC LIMIT 1"
c2cedc6cff27f2430e1a1578,"When was the first time patient 10026354 was diagnosed with dislocation of jaw, initial encounter since 2100?","SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dislocation of jaw, initial encounter' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT diagnoses.charttime FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10026354 ) AND diagnoses.long_title = 'dislocation of jaw, initial encounter' AND strftime('%Y',diagnoses.charttime) >= '2100' ORDER BY diagnoses.charttime ASC LIMIT 1"
2294e45331b6e84efb7132a1,Can you list the top three diagnoses that have the highest mortality rate in a 6-month period?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT d.diagnosis_desc FROM diagnosis d WHERE d.diagnosis_desc IN ( SELECT T1.diagnosis_desc FROM ( SELECT d.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY AVG(C1.C1) ASC ) AS C2 FROM ( SELECT d_icd_procedures.drug, d_icd_procedures.spec_type, d_icd_procedures.spec_desc, d_icd_procedures.diagnosis_desc, AVG(C1.C1) AS C1 FROM ( SELECT COUNT( DISTINCT o1.patient_id ) AS C1 FROM outcomes o1 WHERE o1.diagnosis_desc = d_icd_procedures.diagnosis_desc AND o1.dischtime IS NOT NULL AND datetime(o1.dischtime) BETWEEN datetime(d_icd_procedures.charttime) AND datetime(d_icd_procedures.charttime,'+6 month') GROUP BY o1.patient_id ) C1 JOIN d_icd_procedures ON C1.drug = d_icd_procedures.drug WHERE d_icd_procedures.spec_type = 'diagnosis' GROUP BY d_icd_procedures.diagnosis_desc ) T1 WHERE T1.C2 <= 3 )"
b8a7d87b64afb7722910bc4f,Was or cell saver intake given during their first ICU visit to patient 10009035?,SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or cell saver intake' AND d_items.linksto = 'inputevents' ),SELECT COUNT(*)>0 FROM intakeevents WHERE intakeevents.item = 'or cell saver intake' AND intakeevents.stay_id IN ( SELECT visits.stay_id FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10009035 ) AND visits.dischtime IS NOT NULL ORDER BY visits.admittime ASC LIMIT 1 )
7d6a60231fdec5e1629a3890,What is the maximum total hospital cost of a hospital involving esophageal obstruction?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'esophageal obstruction' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM( hospital_charges.cost ) AS C1 FROM hospital_charges WHERE hospital_charges.hospital_id IN ( SELECT diagnoses.hospital_id FROM diagnoses WHERE diagnoses.diagnosis = 'esophageal obstruction' ) GROUP BY hospital_charges.hospital_id ) AS T1
ac9de4303d9e69514c759992,What was the organism found in the last urine microbiology test for patient 10038081?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiology_test_results.org_name FROM microbiology_test_results WHERE microbiology_test_results.hc_id IN ( SELECT procedures.hc_id FROM procedures WHERE procedures.spec_type = 'urine' AND procedures.spec_test = 'microbiology' AND procedures.hc_id = 10038081 ) AND microbiology_test_results.org_name IS NOT NULL ORDER BY microbiology_test_results.charttime DESC LIMIT 1
039311889be460387c195635,Find out how many patients were admitted to the hospital since 1 year ago.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE datetime(admissions.admittime) >= datetime(current_time,'-1 year')"
52f44dd4ca70f2538c5fdcb9,How many patients received a diagnostic ultrasound of digestive system after the procedure of arteriography of other intra-abdominal arteries in 2100 within the same hospital visit?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of other intra-abdominal arteries' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, visit_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'arteriography of other intra-abdominal arteries' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT patient_id, visit_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'diagnostic ultrasound of digestive system' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.visit_id = T2.visit_id"
712595edb391862c04d6ec79,Calculate the length of stay in days for patient 10022041's first hospital stay.,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = 10022041 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1"
e4389d5bea696426df9502a9,What is the maximum total cost for a hospital that includes laboratory testing for phenytoin?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phenytoin' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM(EX1.C1) AS C1 FROM ( SELECT laboratory_tests.cost FROM laboratory_tests WHERE laboratory_tests.name = 'phenytoin' ) AS EX1 JOIN hospital_visits ON EX1.row_id = hospital_visits.row_id GROUP BY hospital_visits.hadm_id ) AS T1
c09d11621a07d7d859c16278,When was the last time that patient 10014354 has the maximum SaO2 value since 08/19/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014354 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-19' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1","SELECT o1.charttime FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT d.valuenum, d.charttime FROM ( SELECT MIN(o.charttime) AS charttime FROM ( SELECT o.charttime FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT"
499ce7704b771e8824db29e3,Provide the sum of inputs for patient 10024043.,SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 ) ),SELECT SUM(inputs.totalamount) FROM inputs WHERE inputs.stay_id IN ( SELECT stays.stay_id FROM stays WHERE stays.patient_id = 10024043 )
c8ca9d1df94e051908c998f8,When was patient 10009628 last prescribed with 0.9% sodium chloride and neostigmine at the same time?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = '0.9% sodium chloride' AND admissions.subject_id = 10009628 ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'neostigmine' AND admissions.subject_id = 10009628 ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT T1.starttime FROM ( SELECT procedures.starttime, procedures.hadm_id FROM procedures WHERE procedures.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = '0.9% sodium chloride' AND prescriptions.hadm_id = 10009628 ) ) AS T1 JOIN ( SELECT procedures.starttime, procedures.hadm_id FROM procedures WHERE procedures.name = 'neostigmine' AND procedures.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = '0.9% sodium chloride' AND prescriptions.hadm_id = 10009628 ) ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1"
87cf5dab12223c160741d4a7,"What are the four most commonly prescribed drugs for patients who were diagnosed with urinary incontinence, unspecified previously within the same month?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary incontinence, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.row_id, T1.diagnoses_id, T1.charttime FROM ( SELECT * FROM diagnoses WHERE diagnoses.long_title = 'urinary incontinence, unspecified' ) AS T1 JOIN ( SELECT * FROM patients WHERE patients.age = 60 ) AS T2 ON T1.hadm_id = T2.hadm_id ) AS T3 JOIN ( SELECT * FROM ( SELECT T1.row_id, T1.drug, T1.starttime FROM ( SELECT * FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT T1.hadm_id FROM ( SELECT * FROM diagnoses WHERE diagnoses.long_title = 'urinary incontinence, unspecified' ) AS T1 JOIN ( SELECT * FROM patients WHERE patients.age = 60 ) AS T2 ON T1.hadm_id = T2.hadm_id ) ) AS T1 JOIN ( SELECT * FROM patients WHERE patients.age = 60 ) AS T2 ON T1.hadm_id = T2.hadm_id ) AS T3 WHERE T3.starttime >= datetime(T3.row_id, '-1 month') ) AS T4"
cada9d0e90575a50cef72fe4,What was patient 10007818's diastolic blood pressure at the last measurement since 06/22/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-06-22' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT blood_pressure_diastolic FROM blood_pressure WHERE blood_pressure_patient_id = 10007818 AND strftime('%Y-%m-%d',blood_pressure_charttime) >= '2100-06-22' ORDER BY blood_pressure_charttime DESC LIMIT 1"
f97ed282c4c48f5e86f5b1e6,Is the value of patient 10019385's rdw-sd last measured on the last hospital visit less than the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) ORDER BY labevents.charttime DESC LIMIT 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'rdw-sd' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT rdw-sd FROM laboratory_tests WHERE laboratory_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.label = 'rdw-sd' AND procedures.spec_type_desc IS NOT NULL ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND procedures.label = 'rdw-sd' AND procedures.spec_type_desc IS NOT NULL ORDER BY laboratory_tests.charttime DESC LIMIT 1 ) < ( SELECT rdw-sd FROM laboratory_tests WHERE laboratory_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.label = 'rdw-sd' AND procedures.spec_type_desc IS NOT NULL ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND procedures.label = 'rdw-sd' AND procedures.spec_type_desc IS NOT NULL ORDER BY laboratory_tests.charttime DESC LIMIT 1 OFFSET 1 )
4786a778a2cfb99246eefeb8,What is the average total cost of a hospital bill that includes a drug called ranitidine (liquid) since 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'ranitidine (liquid)' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM(BILLABLE_ITEMS.cost) AS C1 FROM BILLABLE_ITEMS WHERE BILLABLE_ITEMS.itemid IN ( SELECT DRUGS.itemid FROM DRUGS WHERE DRUGS.drug = 'ranitidine (liquid)' ) AND strftime('%Y',BILLABLE_ITEMS.charttime) >= '2100' GROUP BY BILLABLE_ITEMS.hid ) AS T1"
28070d8edf72fb2952e28930,Count the number of times patient 10040025 went to the hospital during this year.,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10040025 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT( DISTINCT visits.row_id ) FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10040025 ) AND datetime(visits.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"
b6e85f562fb3d32bcc7d415f,"Since 02/2100, what was patient 10021487's first microbiology test time?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1"
bba49bd752af25f7a63d7766,What was the admission type for patient 10002930's last hospital admission?,"SELECT admissions.admission_type FROM admissions WHERE admissions.subject_id = 10002930 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.admittime DESC LIMIT 1",SELECT admissions.admission_type FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.charttime >= admissions.admittime AND diagnoses.charttime < admissions.dischtime ) AND admissions.dischtime IS NOT NULL AND admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.charttime >= admissions.admittime AND procedures.charttime < admissions.dischtime ) AND admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.charttime >= admissions.admittime AND microbiologyevents.charttime < admissions.dischtime ) AND admissions.hadm_id IN ( SELECT d_icd_procedures.hadm_id FROM d_icd_procedures WHERE d_icd_procedures.charttime >= admissions.admittime AND d_icd_procedures.charttime < admissions.dischtime ) AND admissions.hadm_id IN ( SELECT d_icd_diagnoses.hadm_id FROM d_icd_diagnoses WHERE d_icd_diagnoses.charttime >= admissions.admittime AND d_icd_diagnoses.charttime < admissions.dischtime ) AND admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.charttime >= admissions.admittime AND labevents.charttime <
06fbb15466649cd31a1f3b18,What was the name of the organism found at the first pleural fluid test of patient 10014729 since 02/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) AND microbiologyevents.spec_type_desc = 'pleural fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-02' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT organisms_tested FROM pleural_fluid_tests WHERE organisms_tested IS NOT NULL AND strftime('%Y-%m',tests_done) >= '2100-02' AND patient_id = 10014729 ORDER BY tests_done ASC LIMIT 1"
93b59f146da8ee5c67716875,List the top four most frequent diagnoses that patients received in the same month after receiving hemodialysis in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'hemodialysis' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d1.diagnosis_desc FROM ( SELECT d.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses d WHERE d.charttime IN ( SELECT t1.charttime FROM ( SELECT h.charttime, h.hadm_id FROM hemodialysis h WHERE strftime('%Y',h.starttime) = '2100' ) AS t1 JOIN diagnoses d ON t1.hadm_id = d.hadm_id WHERE strftime('%Y',d.charttime) = '2100' AND datetime(d.charttime,'start of month') = datetime(t1.charttime,'start of month') ) GROUP BY d.diagnosis_desc ) AS d1 WHERE d1.C1 <= 4"
e56ea93964e30564ef0d8599,What is the four most frequently given microbiology tests since 2100 for patients who were previously diagnosed with cardiac arrest due to underlying cardiac condition in the same hospital encounter?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cardiac arrest due to underlying cardiac condition' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( patient_id, hospital_encounter_id ) patient_id, hospital_encounter_id FROM diagnoses WHERE diagnoses.label = 'cardiac arrest due to underlying cardiac condition' AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT DISTINCT ON ( patient_id, hospital_encounter_id ) patient_id, hospital_encounter_id FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.hospital_encounter_id = T2.hospital_encounter_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4"
e198cf387b6b22216a593d12,Please show the total amount of output patient 10004720 had since 02/08/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-08'","SELECT SUM(output.output) FROM output WHERE output.stay_id IN ( SELECT stay.stay_id FROM stay WHERE stay.patient_id = 10004720 ) AND strftime('%Y-%m-%d',output.charttime) >= '2100-02-08'"
dc8216b0660d0fb91f366b9e,Have there been any procedures conducted on patient 10001725 since 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10001725 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'"
bc8d116f59e4fd75687ea181,What new medications were introduced for patient 10004733 today compared to the ones yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')"
3e8b5080c946a24c2fb71498,Count the number of times that patient 10021487 during their first ICU visit had a or urine output.,SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ),SELECT COUNT(*) FROM or_urine_output WHERE or_urine_output.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = 10021487 AND visits.dischtime IS NOT NULL ORDER BY visits.admittime ASC LIMIT 1 )
753a40539d0be72d6bec0d1c,"Since 2100, what were the five most frequently requested specimen tests?","SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 5","SELECT T1.spec_type_desc FROM ( SELECT specimen.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM specimen WHERE strftime('%Y',specimen.charttime) >= '2100' GROUP BY specimen.spec_type_desc ) AS T1 WHERE T1.C1 <= 5"
36c85f3d6859ff6ac14e46d4,What is the label assigned to ct #3 crepitus?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'ct #3 crepitus',"SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT t1.icd_code FROM ( SELECT d_icd_diagnoses.icd_code, d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.short_title = 'ct #3 crepitus' ) AS t1 JOIN ( SELECT d_icd_procedures.icd_code, d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.short_title = 'label assigned to' ) AS t2 ON t1.icd_code = t2.icd_code )"
e4072cdd311e5d56562630fe,"What are the three most commonly taken specimens that patients were tested during the same month after receiving a extirpation of matter from left femoral vein, percutaneous approach procedure throughout this year?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left femoral vein, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( extirpation_of_matter_from_left_femoral_vein_percutaneous_approach.charttime ) extirpation_of_matter_from_left_femoral_vein_percutaneous_approach.charttime, extirpation_of_matter_from_left_femoral_vein_percutaneous_approach.hadm_id FROM extirpation_of_matter_from_left_femoral_vein_percutaneous_approach WHERE datetime(extirpation_of_matter_from_left_femoral_vein_percutaneous_approach.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT DISTINCT ON ( specimen.charttime ) specimen.charttime, specimen.spec_type_desc, specimen.hadm_id FROM specimen WHERE datetime(specimen.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month')"
666f86f3566bfabb76e587a7,When was patient 10038992 last prescribed a drug via the neb route since 07/2100?,"SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038992 ) AND prescriptions.route = 'neb' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT to_char(drug_administration_time,'YYYY-MM-DD HH24:MI:SS') FROM drug_administration WHERE drug_administration.drug = 'neb' AND drug_administration.route = 'neb' AND drug_administration.patient_id = 10038992 AND strftime('%Y-%m',drug_administration.drug_administration_time) >= '2100-07' ORDER BY drug_administration.drug_administration_time DESC LIMIT 1"
ced205244613e91e3ff9ec97,Count the number of times patient 10021487 received replete with fiber (full) on this month/13.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'replete with fiber (full)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '13'",SELECT COUNT(*) FROM intakeevents WHERE intakeevents.item = 'replete with fiber (full)' AND intakeevents.stdt LIKE '2100-03-13%' AND intakeevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 )
878917a494e18bf3082ea4c4,Is SaO2 of patient 10031757 second measured on the first ICU visit greater than the first value measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT SaO2 FROM patient10031757_icustays_otherdata WHERE icustay_id IN ( SELECT icustay_id FROM patient10031757_icustays WHERE stay_id IN ( SELECT stay_id FROM patient10031757_stays WHERE visits = 1 ) ) AND otherdata = 'o2 saturation pulseoxymetry' ORDER BY charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT SaO2 FROM patient10031757_icustays_otherdata WHERE icustay_id IN ( SELECT icustay_id FROM patient10031757_icustays WHERE stay_id IN ( SELECT stay_id FROM patient10031757_stays WHERE visits = 1 ) ) AND otherdata = 'o2 saturation pulseoxymetry' ORDER BY charttime ASC LIMIT 1 )
64be714443bafc724b5d0d44,What are the ways to take emtricitabine-tenofovir (truvada)?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'emtricitabine-tenofovir (truvada)',SELECT DISTINCT d.route FROM drug_route d WHERE d.drug = 'emtricitabine-tenofovir (truvada)'
0fae80f812674773157d9f2a,Can you specify the gender of patient 10022880?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10022880,SELECT gender FROM patients WHERE patients.id = 10022880
40bd0f4265c38c258e1d9e19,Has there been any organism found in patient 10021118's last urine microbiological examination in 12/this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '12' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.org_name IS NOT NULL AND microbiologyevents.hc_id IN ( SELECT admissions.hc_id FROM admissions WHERE admissions.age = 10021118 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.event_time >= datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.event_time) = '12' ORDER BY microbiologyevents.event_time DESC LIMIT 1"
01038856e72fffdbf13016be,Did patient 10025463 receive any lab testing in 11/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025463 ) AND strftime('%Y-%m',labevents.charttime) = '2100-11'","SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10025463 ) AND strftime('%Y-%m',labevents.charttime) = '2100-11'"
ceb130d1950aa38990b64736,"What is the maximum total cost for a hospital that conducts a albumin, ascites lab test?","SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin, ascites' ) ) GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM( chartevents.chartevents_valuenum ) AS C1 FROM chartevents WHERE chartevents.chartevents_itemid IN ( SELECT labevents.labevents_itemid FROM labevents WHERE labevents.label = 'albumin, ascites' ) GROUP BY chartevents.chartevents_hadm_id ) AS T1"
6236365bb1b1dab256878dbe,Has patient 10020187 been prescribed any medications?,SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ),SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020187 )
20d7ef0b9116aab70a4d883c,"Since 07/2100, what was patient 10021938's last microbiology test time?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021938 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-07' ORDER BY microbiologyevents.charttime DESC LIMIT 1"
e56ed5e7a85bff472777e492,"Among patients in their 60 or above , what are the top three prescribed drugs?","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM prescriptions WHERE prescriptions.age >= 60 ) AS T1 GROUP BY drug ) AS T2 WHERE T2.C1 <= 3"
6603175d4ba0c226f1b1404c,Can you tell me the cost of a lab immunoglobulin g test?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin g' ) ),SELECT DISTINCT cost FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_procedures.icd_code FROM icd_procedures WHERE icd_procedures.long_title = 'lab immunoglobulin g' )
ca656067a8e263ea627dff09,When did patient 10001217 receive a last diagnosis of cerebral edema on the last hospital visit?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cerebral edema' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1,"SELECT diagnoses.charttime FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.dischtime IS NOT NULL AND strftime('%Y',visits.admittime) = '2100' ORDER BY visits.admittime DESC LIMIT 1 ) AND diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'cerebral edema' ) AND diagnoses.hadm_id = 10001217 ORDER BY diagnoses.charttime DESC LIMIT 1"
25b2ba84dbb2d8d8d138ee64,What was patient 10027445's first weight since 21 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-21 month') ORDER BY chartevents.charttime ASC LIMIT 1","SELECT weight FROM dailyweight WHERE dailyweight.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 21 AND admissions.age_unit = 'months' AND admissions.dischtime IS NOT NULL AND datetime(admissions.admittime) >= datetime(current_time,'-21 month') ) AND dailyweight.hadm_id = 10027445 ORDER BY dailyweight.charttime ASC LIMIT 1"
809821a4009fe30207a67903,What is the average immunoglobulin a of patient 10029291 in 02/this year?,"SELECT AVG(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'immunoglobulin a' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '02'","SELECT AVG(lab_results.valuenum) FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10029291 ) AND lab_results.item = 'immunoglobulin a' AND datetime(lab_results.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',lab_results.charttime) = '02'"
3e4b52c69a2bdf36e4f03676,Retrieve the marital status of patient 10005866 during their last hospital encounter.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT marital_status FROM patients WHERE patients.id = 10005866 AND patients.marital_status IS NOT NULL ORDER BY patients.charttime DESC LIMIT 1
7294971600b3da69c5f504bd,Can you tell me the name of the procedure that patient 10004720 received first?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ORDER BY procedures_icd.charttime ASC LIMIT 1 ),SELECT procedures.name FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures.charttime ASC LIMIT 1
741720ef5045654c9099edd9,How much time in days has passed since the last time patient 10018081 was prescribed metronidazole (flagyl) in their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'metronidazole (flagyl)' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT prescription_starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'metronidazole (flagyl)' ORDER BY prescription_starttime DESC LIMIT 1 ) ) )"
baa17b1b6e497c273e84c277,What is the percentile of 29.0 in a urea nitrogen lab test given the same age as patient 10015931 on the last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'urea nitrogen' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10015931 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 29.0","SELECT DISTINCT T1.C1 FROM ( SELECT R1.C1, PERCENT_RANK() OVER ( ORDER BY R1.C1 ) AS C2 FROM ( SELECT urea_nitrogen_val FROM lab_tests WHERE lab_tests.age = ( SELECT lab_tests.age FROM lab_tests WHERE lab_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = 'personal history of other diseases' ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) ) AS R1 ) AS T1 WHERE T1.urea_nitrogen_val = 29.0"
daad7a245a02c2817e1dab51,When did patient 10007818 last have a fecal bag event since 04/04/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'fecal bag' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-04-04' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT events.starttime FROM events WHERE events.studypersonid = 10007818 AND events.eventtype = 'fecal bag' AND strftime('%Y-%m-%d',events.starttime) >= '2100-04-04' ORDER BY events.starttime DESC LIMIT 1"
555bf9cbad590421927df2cd,"How many patients received a ultrasonography of superior vena cava, guidance procedure in the same hospital encounter after having a introduction of nutritional substance into upper gi, via natural or artificial opening procedure since 2100?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into upper gi, via natural or artificial opening' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'ultrasonography of superior vena cava, guidance' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, charttime, procedure_icd_code FROM procedures_icd WHERE procedure_icd_code = '0d1f0f3b-d2f1-4b3d-9b3c-0b1f0f3b3d2f' AND strftime('%Y',charttime) >= '2100' ) AS T1 JOIN ( SELECT patient_id, charttime, procedure_icd_code FROM procedures_icd WHERE procedure_icd_code = '1a2b3c4d-5e6f-7g8h-9i0j-1k2l3m4n5o6p' AND strftime('%Y',charttime) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime AND T1.hospital_visit_id = T2.hospital_visit_id"
fc8557d25a51b1ae5a699bdb,"Since 07/2100, when was the last time that patient 10031757 was prescribed both lactated ringers and metronidazole (flagyl) at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lactated ringers' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT T1.starttime FROM ( SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031757 ) AND procedures.label = 'lactated ringers' AND strftime('%Y-%m',procedures.starttime) >= '2100-07' ) AS T1 JOIN ( SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031757 ) AND prescriptions.drug = 'metronidazole (flagyl)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-07' ) AS T2 ON T1.starttime = T2.starttime WHERE datetime(T1.starttime) >= datetime(current_time,'-1 year') ORDER BY T1.starttime DESC LIMIT 1"
85870a86f06622ea71a7764e,"How many patients are marked ""emergency department observation"" as a transfer care unit in 2100?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'emergency department observation' AND strftime('%Y',transfers.intime) = '2100' )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT careunitevents.pid FROM careunitevents WHERE careunitevents.careunit = 'emergency department observation' AND strftime('%Y',careunitevents.intime) = '2100' )"
75687ea1705bf35f720606d4,Tell me the number of times patient 10027602 got a cerebral ventricular #1 since 01/23/2100.,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cerebral ventricular #1' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-01-23'",SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = '0f193c8a-0a0f-11e1-97e9-7845c97b0b38' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = '0f193c8a-0a0f-11e1-97e9-7845c97b0b38' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age IS NOT NULL ) ORDER BY admissions.age ASC LIMIT 1 ) ) ) ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age IS NOT NULL AND admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_ic
bbc6747e134e489a305733da,What was patient 10005348's age on the last hospital stay?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10005348 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT DISTINCT age FROM patients WHERE patients.pid = 10005348 AND patients.age IS NOT NULL AND patients.dischtime IS NOT NULL ORDER BY patients.admittime DESC LIMIT 1
5db87efd687aa472406c44c6,Has patient 10015931 been prescribed medication since 2100?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND strftime('%Y',prescriptions.starttime) >= '2100'","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10015931 ) AND strftime('%Y',prescriptions.starttime) >= '2100'"
089417994ad72edcca9f8050,Count the number of patients who had insertion of intercostal catheter for drainage within 2 months after having been diagnosed with home accidents since 2100.,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'home accidents' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of intercostal catheter for drainage' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.icd_name = 'home accidents' ) AND strftime('%Y',diagnoses.diagnosis_date) >= '2100' ) AS T1 JOIN ( SELECT patient_id, procedure_date FROM procedures WHERE procedures.icd_code = ( SELECT icd_code FROM icd WHERE icd.icd_name = 'insertion of intercostal catheter for drainage' ) ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.procedure_date AND datetime(T2.procedure_date) BETWEEN datetime(T1.diagnosis_date) AND datetime(T1.diagnosis_date,'+2 month')"
347a2cad20161a15e564ef29,What is the average total hospital cost that includes a procedure called central venous catheter placement with guidance since 1 year ago?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'central venous catheter placement with guidance' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM( hospital_charges.cost ) AS C1 FROM hospital_charges WHERE hospital_charges.hospital_visit_id IN ( SELECT procedures.hospital_visit_id FROM procedures WHERE procedures.procedure = 'central venous catheter placement with guidance' ) AND datetime(hospital_charges.chargetime) >= datetime(current_time,'-1 year') GROUP BY hospital_charges.hospital_visit_id ) AS T1"
4344afd25464e3304de00b90,What was patient 10013049's length of stay in days in the last ICU stay?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT strftime('%J',outtime) - strftime('%J',intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10013049 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1"
94d8481d364db4cbd70b366f,How much does patient 10005817 weigh based on the first measurement taken since 10/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-10' ORDER BY chartevents.charttime ASC LIMIT 1","SELECT weight FROM patients_chartevents WHERE patients_chartevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND strftime('%Y-%m',patients_chartevents.charttime) >= '2100-10' ORDER BY patients_chartevents.charttime ASC LIMIT 1"
693650b24cdfd7b8135da88e,What does it cost for a history of falling diagnosis?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'history of falling' ) ),SELECT DISTINCT cost FROM cost WHERE cost.event_type = 'history of falling'
21768a606512998a1ee96c2a,Count the number of patients who were diagnosed with chronic hepatitis c without mention of hepatic coma but didn't come back to the hospital within the same month.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic hepatitis c without mention of hepatic coma' ) ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'chronic hepatitis c without mention of hepatic coma' ) ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND datetime(T2.charttime,'start of month') = datetime(admissions.admittime,'start of month') )","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT admissions.pid, diagnoses.charttime FROM diagnoses JOIN admissions ON diagnoses.pid = admissions.pid WHERE diagnoses.long_title = 'chronic hepatitis c without mention of hepatic coma' ) AS T1 WHERE NOT EXISTS ( SELECT admissions.pid FROM admissions WHERE admissions.pid = T1.pid AND datetime(admissions.admittime,'start of month') = datetime(T1.charttime,'start of month') )"
00ddca0abfcd2315f0c91ce6,What are the three commonly taken specimens for patients who received control of epistaxis by anterior nasal packing previously during the same hospital encounter?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'control of epistaxis by anterior nasal packing' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( chartevents.stay_id ) chartevents.stay_id, chartevents.charttime FROM chartevents WHERE chartevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.icd_code = '0b1f0f' ) ) AS T1 JOIN ( SELECT DISTINCT ON ( chartevents.stay_id ) chartevents.stay_id, chartevents.charttime FROM chartevents WHERE chartevents.itemid IN ( SELECT specimens.itemid FROM specimens ) ) AS T2 ON T1.stay_id = T2.stay_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of visit') = datetime(T2.charttime,'start of visit') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3"
6457fac9c63ce0f20ad03c9c,"For patients who underwent (aorto)coronary bypass of three coronary arteries in 2100, what were the top four most frequent procedures that followed within the same hospital visit?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of three coronary arteries' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime, admissions.hadm_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = '(aorto)coronary bypass of three coronary arteries' ) AND strftime('%Y',procedures.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.charttime, admissions.hadm_id FROM procedures JOIN admissions ON procedures.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )"
879dfc7ea11934d27bc66bc7,Can you name the top three diagnoses with the highest 6-month mortality rate?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT patients.row_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN patients ON diagnoses.hadm_id = patients.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses.charttime) >= 1 * 365/2 GROUP BY patients.row_id, diagnoses.icd_code HAVING MIN(diagnoses.charttime) = diagnoses.charttime ) AS T1 JOIN patients ON T1.row_id = patients.row_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )"
d50f340e88f09cf2749021b3,"What are the three most commonly ordered lab tests for patients diagnosed with hyperkalemia previously during the same hospital encounter, this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperkalemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses.charttime, admissions.hadm_id FROM diagnoses JOIN admissions ON diagnoses.hadm_id = admissions.hadm_id WHERE diagnoses.label = 'hyperkalemia' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labtests.itemid, labtests.charttime, admissions.hadm_id FROM labtests JOIN admissions ON labtests.hadm_id = admissions.hadm_id WHERE datetime(labtests.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 3 )"
c0b91d07e6910a05f93e87aa,When did patient 10019172 have his/her last input since 09/07/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-07' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-09-07' ORDER BY inputevents.starttime DESC LIMIT 1"
3a0be19d3169bb19a1452e68,"How many hours were there since patient 10021487 was first diagnosed with injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum in their current hospital visit?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd_diagnoses.charttime) ) FROM diagnoses_icd_diagnoses WHERE diagnoses_icd_diagnoses.icd_code = ( SELECT icd_diagnoses.icd_code FROM icd_diagnoses WHERE icd_diagnoses.long_title = 'injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum' ) AND diagnoses_icd_diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd_diagnoses.hadm_id FROM diagnoses_icd_diagnoses WHERE diagnoses_icd_diagnoses.icd_code = ( SELECT icd_diagnoses.icd_code FROM icd_diagnoses WHERE icd_diagnoses.long_title = 'injury to other intra-abdominal organs without mention of open wound into cavity, peritoneum' ) ) AND admissions.dischtime IS NULL ) ORDER BY admissions.admittime ASC LIMIT 1 ) AND diagnoses_icd_diagnoses.hadm_id = 10021487 ORDER BY diagnoses_icd_diagnoses.charttime ASC LIMIT 1"
d72094c1906f3a46217599bb,What are the three most common microbiology tests done since 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 3","SELECT T1.test_name FROM ( SELECT microbiologytests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologytests WHERE strftime('%Y',microbiologytests.charttime) >= '2100' GROUP BY microbiologytests.test_name ) AS T1 WHERE T1.C1 <= 3"
84ac2bfd0420a297e0a26258,What is the total po intake amount that patient 10000032 received since 07/09/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-09'","SELECT SUM(po.intakeamount) FROM po WHERE po.patientid = 10000032 AND strftime('%Y-%m-%d',po.starttime) >= '2100-07-09'"
8de87b88f6cd77d22fb75b7a,How many hours have been since the first time patient 10021487 was diagnosed with traumatic hemothorax without mention of open wound into thorax in the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'traumatic hemothorax without mention of open wound into thorax' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd_diagnoses.charttime) ) FROM diagnoses_icd_diagnoses WHERE diagnoses_icd_diagnoses.icd_code = ( SELECT icd_diagnoses.icd_code FROM icd_diagnoses WHERE icd_diagnoses.long_title = 'traumatic hemothorax without mention of open wound into thorax' ) AND diagnoses_icd_diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd_diagnoses.hadm_id FROM diagnoses_icd_diagnoses WHERE diagnoses_icd_diagnoses.icd_code = ( SELECT icd_diagnoses.icd_code FROM icd_diagnoses WHERE icd_diagnoses.long_title = 'traumatic hemothorax without mention of open wound into thorax' ) ) AND admissions.dischtime IS NULL ) ORDER BY admissions.admittime ASC LIMIT 1 ) AND diagnoses_icd_diagnoses.hadm_id = ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd_diagnoses"
c8a2241d70df2c163edad761,What was patient 10039997's last value of the heart rate since 08/13/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-08-13' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT heart_rate FROM vitalevents WHERE heart_rate IS NOT NULL AND patient_id = 10039997 AND strftime('%Y-%m-%d',vitaltime) >= '2100-08-13' ORDER BY vitaltime DESC LIMIT 1"
10099f05b84afe98cf07a47e,What was the name of drug patient 10020740 was prescribed in the same hospital visit after receiving a other laparoscopic umbilical herniorrhaphy procedure since 01/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other laparoscopic umbilical herniorrhaphy' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-01' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-01' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime","SELECT T2.drug FROM ( SELECT procedure_occurred_at, hospital_visit_id FROM procedure_event WHERE procedure_event.procedure = 'other laparoscopic umbilical herniorrhaphy' AND procedure_event.person_id = 10020740 AND strftime('%Y-%m',procedure_event.procedure_occurred_at) >= '2100-01' ) AS T1 JOIN ( SELECT drug, procedure_occurred_at, hospital_visit_id FROM prescription WHERE prescription.person_id = 10020740 AND strftime('%Y-%m',prescription.starttime) >= '2100-01' ) AS T2 ON T1.hospital_visit_id = T2.hospital_visit_id WHERE T1.procedure_occurred_at < T2.procedure_occurred_at"
91c770552e4894cdd9ea0079,How many patients were tested this year for staph aureus swab?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'staph aureus swab' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT microbiologyevents.pid FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'staph aureus swab' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )"
baa84499707e958def958609,What were the top four most frequent diagnoses that patients were given within 2 months after being diagnosed with encounter for attention to tracheostomy since 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'encounter for attention to tracheostomy' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d1.long_title FROM ( SELECT d2.long_title, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM diagnoses WHERE diagnoses.icd_code = ( SELECT diagnoses.icd_code FROM diagnoses WHERE diagnoses.long_title = 'encounter for attention to tracheostomy' ) AND strftime('%Y',diagnoses.charttime) >= '2100' ) AS T1 JOIN ( SELECT * FROM diagnoses WHERE strftime('%Y',diagnoses.charttime) >= '2100' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY d2.long_title ) AS d1 WHERE d1.C1 <= 4"
de4d2a4ef0f92ed118449a87,What's the total number of patients in hematology/oncology since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'hematology/oncology' AND strftime('%Y',transfers.intime) >= '2100' )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT visits.pid FROM visits WHERE visits.specialty = 'hematology/oncology' AND strftime('%Y',visits.admittime) >= '2100' )"
84564eb53eb9b3302bd9acf8,Can you tell me the top four most common microbiology tests that occurred in 2100?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT T1.test_name FROM ( SELECT microbiologytests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologytests WHERE strftime('%Y',microbiologytests.charttime) = '2100' GROUP BY microbiologytests.test_name ) AS T1 WHERE T1.C1 <= 4"
c4b26c0ae57a5f77fcd0c46d,Has patient 10022281 been prescribed a drug since 24 months ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10022281 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')"
dc671c0fb18f291e1d417779,What was patient 10004235's last output time of foley on 03/19/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-19' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT foley.outputtime FROM foley WHERE foley.stdyzid IN ( SELECT stdyz.stdyzid FROM stdyz WHERE stdyz.hospid IN ( SELECT hosp.hospid FROM hosp WHERE hosp.pid = 10004235 ) ) AND strftime('%Y-%m-%d',foley.outputtime) = '2100-03-19' ORDER BY foley.outputtime DESC LIMIT 1"
d6ab8927156136206a55d8a8,"During the current hospital visit, has patient 10021487 been prescribed with readi-cat 2 (barium sulfate 2% suspension), plasmalyte, or acetazolamide sodium?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug IN ( 'readi-cat 2 (barium sulfate 2% suspension)', 'plasmalyte', 'acetazolamide sodium' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.visits = 1 AND visits.pat_id = 10021487 ) AND prescriptions.drug IN ( 'readi-cat 2 (barium sulfate 2% suspension)', 'plasmalyte', 'acetazolamide sodium' )"
cb5bf7d37033da680feb9abe,How many visits did patient 10026354 make to the hospital throughout this year?,"SELECT COUNT( DISTINCT admissions.hadm_id ) FROM admissions WHERE admissions.subject_id = 10026354 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT( DISTINCT visits.visit_id ) FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10026354 ) AND datetime(visits.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"
3e7993dbfd153fc21c01b640,How much is the minimum total cost for the hospital visits that include sevelamer carbonate since 1 year ago?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'sevelamer carbonate' ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1",SELECT MIN(T1.C1) FROM ( SELECT SUM( DRG COSTS .total_cost ) AS C1 FROM DRG COSTS WHERE DRG COSTS .drug = 'sevelamer carbonate' GROUP BY DRG COSTS .charttime ) AS T1
5efdb746ec678cf4fc384eaa,How is chlorhexidine gluconate 0.12% oral rinse delivered?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse',SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'chlorhexidine gluconate 0.12% oral rinse'
0d61464fe9f411c1b299ffef,Count the number of times that patient 10009035 in 12/last year had a or urine output.,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',outputevents.charttime) = '12'","SELECT COUNT(*) FROM or_urine_output WHERE or_urine_output.patient_id = 10009035 AND datetime(or_urine_output.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',or_urine_output.charttime) = '12'"
a0863c97c9dcec30264c3abd,Name the output that patient 10037975 had for the last time?,SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) ) ORDER BY outputevents.charttime DESC LIMIT 1 ),"SELECT output FROM output WHERE output IS NOT NULL AND strftime('%Y',output) = '2100' AND output LIKE '%patient 10037975%' ORDER BY output DESC LIMIT 1"
caf20c3c07abb81f1fb4ce13,What are the methods for ingesting oxymetazoline?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'oxymetazoline',SELECT DISTINCT i.method FROM ingestas i WHERE i.itemid IN ( SELECT d.itemid FROM d_icditems d WHERE d.long_title = 'oxymetazoline' )
b96e8ac58176933b9e0ee2b3,What are the five most commonly tested specimens for patients that were diagnosed with unarmed fight or brawl previously within 2 months?,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unarmed fight or brawl' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM mimiciii.d_icd_procedures WHERE icd_code = ( SELECT icd_procedures.icd_code FROM icd_procedures WHERE icd_procedures.long_title = 'unarmed fight or brawl' ) ) AS T1 JOIN ( SELECT patient_id, spec_type_desc, collect_time FROM mimiciii.specimens ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.collect_time AND datetime(T2.collect_time) BETWEEN datetime(T1.diagnosis_date) AND datetime(T1.diagnosis_date,'+2 month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5"
60e8ab147beb8159de92a539,How much is the average total cost of a hospital visit that includes a free calcium lab test in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'free calcium' ) ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT SUM( hospital_visits.cost ) AS C1 FROM hospital_visits WHERE hospital_visits.hospital_visits_id IN ( SELECT procedures.hospital_visits_id FROM procedures WHERE procedures.procedures_icd = ( SELECT procedures_icd FROM procedures_icd WHERE procedures_icd.long_title = 'free calcium lab test' ) ) AND strftime('%Y',hospital_visits.admittime) = '2100' GROUP BY hospital_visits.hospital_visits_id ) AS T1"
a13bd95a1540c1bc4c4568db,Can you tell me the last ferritin lab reading for patient 10020740 in 03/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ferritin' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1","SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020740 ) AND labresults.item = 'ferritin' AND strftime('%Y-%m',labresults.charttime) = '2100-03' ORDER BY labresults.charttime DESC LIMIT 1"
e256c7b08d9dde3880221886,"List the top three most frequent diagnoses that were given to patients within the same month after they were diagnosed with other dependence on machines, supplemental oxygen.","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other dependence on machines, supplemental oxygen' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d1.label FROM ( SELECT d2.label, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses d1 WHERE d1.charttime IN ( SELECT d3.charttime FROM diagnoses d3 WHERE d3.label = 'other dependence on machines, supplemental oxygen' ) AND d1.charttime IN ( SELECT d4.charttime FROM diagnoses d4 WHERE d4.label = d2.label AND datetime(d3.charttime,'start of month') = datetime(d4.charttime,'start of month') ) GROUP BY d2.label ) WHERE C1 <= 3"
fbf3603d3d2d818a10d4d5b4,"Among patients who were diagnosed with acute alcoholic intoxication in alcoholism, continuous during this year, what are the top five most commonly prescribed medications that followed in the same hospital encounter for patients in their 50s?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute alcoholic intoxication in alcoholism, continuous' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.row_id, T1.person_id, T1.drug, T1.starttime FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ("
67269f11d04e63d8d4a6aaf1,"List the top five most frequent procedures that patients underwent within the same month after being diagnosed with diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled in 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d3.procedure_name FROM ( SELECT d2.procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM diagnoses WHERE diagnoses.icd_code = ( SELECT diagnoses.icd_code FROM diagnoses WHERE diagnoses.long_title = 'diabetes mellitus without mention of complication, type ii or unspecified type, not stated as uncontrolled' ) AND strftime('%Y',diagnoses.charttime) = '2100' ) AS d1 JOIN ( SELECT * FROM procedures WHERE strftime('%Y',procedures.charttime) = '2100' ) AS d2 ON d1.hadm_id = d2.hadm_id WHERE d1.charttime < d2.charttime AND datetime(d1.charttime,'start of month') = datetime(d2.charttime,'start of month') GROUP BY d2.procedure_name ) AS d3 WHERE d3.C1 <= 5"
2675abf72b38410bb4eda4ad,What proportion of patients with a diagnosis of acetonuria survive over a 6-month period?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/2 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acetonuria' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )",SELECT DISTINCT T1.C1 FROM ( SELECT AVG(C1) AS C1 FROM ( SELECT COUNT( DISTINCT T3.row_id ) / COUNT( DISTINCT T2.row_id ) AS C1 FROM ( SELECT * FROM diagnoses WHERE diagnoses.long_title = 'acetonuria' ) AS T1 JOIN ( SELECT * FROM patients ) AS T2 ON T1.hadm_id = T2.hadm_id JOIN ( SELECT * FROM ( SELECT * FROM diagnoses WHERE diagnoses.long_title = 'acetonuria' ) AS T4 JOIN ( SELECT * FROM patients ) AS T5 ON T4.hadm_id = T5.hadm_id WHERE T4.charttime < T5.charttime AND datetime(T4.charttime) >= datetime(T5.admittime) - interval 6 month AND T5.dischtime IS NOT NULL ) AS T3 ON T2.row_id = T3.row_id ) AS T6 GROUP BY T6.charttime ) AS T7
811d7b1ce1d2dbdbb4648a1b,What procedure was performed on patient 10021938 two times since 11 months ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021938 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-11 month') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )","SELECT procedures.drug FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021938 ) AND datetime(procedures.charttime) >= datetime(current_time,'-11 month') GROUP BY procedures.drug HAVING COUNT(*) = 2"
bdf2adbc5d802891bf0837c2,"In 2100, how many patients received pantoprazole in the same hospital encounter after being diagnosed with defibrination syndrome?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'defibrination syndrome' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'pantoprazole' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT T1.patient_id, T1.encounter_id FROM ( SELECT patient_id, encounter_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'defibrination syndrome' ) ) AS T1 JOIN ( SELECT patient_id, encounter_id FROM procedures WHERE procedures.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.long_title = 'pantoprazole' ) ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.encounter_id = T2.encounter_id AND T1.charttime < T2.charttime ) AS T3"
6d14fafef38d93f2e020c386,"Count how many times in the first hospital encounter patient 10018328 experienced the restriction of left internal carotid artery with intraluminal device, percutaneous approach procedure.","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of left internal carotid artery with intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code( 'icd-11', '1A1.1' ) ) AND procedures_icd.hadm_id IN ( SELECT encounters.hadm_id FROM encounters WHERE encounters.age = ( SELECT encounters.age FROM encounters WHERE encounters.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code( 'icd-11', '1A1.1' ) ) AND procedures_icd.hadm_id IN ( SELECT encounters.hadm_id FROM encounters WHERE encounters.dischtime IS NOT NULL ORDER BY encounters.admittime ASC LIMIT 1 ) ) ) ) )"
f5d1341aa772a131aa8ee445,How many patients were diagnosed with personal history of malignant neoplasm of large intestine in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT diagnoses.pid FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.icd_name = 'personal history of malignant neoplasm of large intestine' ) AND strftime('%Y',diagnoses.charttime) = '2100' )"
e5b73688391845090eacc355,"How many patients got a amylase, ascites test since 1 year ago?","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'amylase, ascites' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT labevents.patients_pid FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'amylase, ascites' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )"
b8b5e892b7594cca173fde8a,What label corresponds to volume not removed?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'volume not removed',SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'volume not removed' )
b26e5939c6b846e6073358d5,How many prescription drugs were ordered for patient 10018328 during their last hospital visit?,SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )
36d8a80cdf21d731b910f6bf,What are the four most common microbiology tests for people who were diagnosed with dysthymic disorder earlier within 2 months?,"SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysthymic disorder' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 4","SELECT T1.test_name FROM ( SELECT microbiologytests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologytests WHERE microbiologytests.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.label = 'dysthymic disorder' ) AND datetime(diagnoses.charttime) < datetime(microbiologytests.charttime) AND datetime(diagnoses.charttime) >= datetime(microbiologytests.charttime) - interval '2' month GROUP BY microbiologytests.test_name ) AS T1 WHERE T1.C1 <= 4"
8e97f8923eae1120693cf379,Is the value of mchc of patient 10026255 second measured on the last hospital visit less than it was first measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mchc' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT labresults.hadm_id FROM labresults WHERE labresults.valuenum IS NOT NULL AND labresults.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'mchc' AND items.linksto = 'labresults' ) ) ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime ASC LIMIT 1 ) ) < ( SELECT labresults.valuenum FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT labresults.hadm_id FROM labresults WHERE labresults.valuenum IS NOT NULL AND labresults.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'mchc' AND items.linksto = 'labresults' ) ) ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY labresults.charttime ASC LIMIT 1 )
103963052c1ac6130cd2db9a,What is the sum of patient 10003046's or urine output during the last ICU visit.,SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ),SELECT SUM(output) FROM patientoutput WHERE patientoutput.patient_id = 10003046 AND patientoutput.item = 'or urine' AND patientoutput.stay_id IN ( SELECT visit_stay_id FROM visits WHERE visits.patient_id = 10003046 AND visits.dischtime IS NOT NULL ORDER BY visits.admittime DESC LIMIT 1 )
c2eed970bacaf0f9bea1ccbc,What are the four most frequently ordered medications that male patients aged 20s were prescribed within 2 months after they were diagnosed with mitral valve disorders since 1 year ago?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'mitral valve disorders' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 20 AND 29 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'mitral valve disorders' AND datetime(diagnoses.diagnosis_date) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT patient_id, drug, first_time_at_time_prescribed FROM ( SELECT patient_id, drug, min(prescriptions.starttime) as first_time_at_time_prescribed FROM prescriptions WHERE prescriptions.starttime >= datetime(current_time,'-1 year') AND prescriptions.gender = 'male' AND prescriptions.age BETWEEN 20 AND 29 GROUP BY patient_id, drug ) AS T2 ) ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.first_time_at_time_prescribed AND datetime(T2.first_time_at_time_prescribed) BETWEEN datetime(T1.diagnosis_date) AND datetime(T1.diagnosis_date,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4"
411239af52a2ceaa4e79d867,How many prescription drugs were ordered for patient 10020944 since 24 months ago?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020944 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-24 month')"
b38138698b912a998a6f74f3,Count the number of patients for whom vial was prescribed within 2 months post their diagnosis of secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes in 2100.,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'vial' AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.time1 FROM ( SELECT pid, drgtime FROM diagnoses WHERE drg = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes' AND strftime('%Y',drgtime) = '2100' ) AS T1 JOIN ( SELECT pid, ordtime FROM prescriptions WHERE drug = 'vial' ) AS T2 ON T1.pid = T2.pid WHERE T1.drgtime < T2.ordtime AND datetime(T2.ordtime) BETWEEN datetime(T1.drgtime) AND datetime(T1.drgtime,'+2 month') )"
cd9067d6c88100bac2cc82c3,What are the three most commonly tested specimens since 1 year ago?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT T1.spec_type_desc FROM ( SELECT spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM specimens WHERE datetime >= datetime(current_time,'-1 year') GROUP BY spec_type_desc ) AS T1 WHERE T1.C1 <= 3"
84db978ffae9e37098b5f315,What were the top three most common treatments given to patients in their 40s in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',procedures_icd.charttime) = '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.treatment FROM ( SELECT procedures.drug, COUNT(*) AS C1 FROM procedures WHERE procedures.age BETWEEN 40 AND 49 AND strftime('%Y',procedures.charttime) = '2100' GROUP BY procedures.drug ) AS T1 WHERE T1.C1 IN ( SELECT T2.C2 FROM ( SELECT COUNT(*) AS C2 FROM procedures WHERE procedures.age BETWEEN 40 AND 49 AND strftime('%Y',procedures.charttime) = '2100' GROUP BY procedures.drug ORDER BY C2 DESC LIMIT 3 ) AS T2 )"
3de4eeab52c93e43309156d7,Has any medication been designated for patient 10029484 in 04/last year?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',prescriptions.starttime) = '04'","SELECT COUNT(*)>0 FROM medication WHERE medication.studycovid = 0 AND medication.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10029484 ) AND datetime(medication.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',medication.starttime) = '04'"
135380cceeececcc1d31beb3,Did patient 10021666 come into an ER on their first hospital encounter?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*)>0 FROM emergency_room_visits WHERE emergency_room_visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )
ccedb8f78a6736b132f3b079,Tell me the organism that was detected in the last urine test of patient 10031757 during their last hospital encounter?,SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT tests_org_name FROM tests_org WHERE tests_org_name IS NOT NULL AND tests_org_name != 'no organism detected' AND tests_org.spec_type_desc = 'urine' AND tests_org.test_time < ( SELECT tests_org.test_time FROM tests_org WHERE tests_org.spec_type_desc = 'urine' AND tests_org.test_time >= ( SELECT MIN(tests_org.test_time) FROM tests_org WHERE tests_org.spec_type_desc = 'urine' AND tests_org.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.label = 'urine' AND procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.pid = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) ) ) ) ORDER BY tests_org.test_time DESC LIMIT 1 )
4b72e7b13c37b47053d926d9,Can you provide the monthly maximum output of pre-admission for patient 10022041?,"SELECT MAX(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022041 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'pre-admission' AND d_items.linksto = 'outputevents' ) GROUP BY strftime('%Y-%m',outputevents.charttime)","SELECT MAX(output) FROM patient10022041_preadmission WHERE strftime('%Y-%m',time) IS NOT NULL GROUP BY strftime('%Y-%m',time)"
390c4f9e4e7b5c353eff9da7,What was the last dose of potassium chl 20 meq / 1000 ml d5lr prescribed to patient 10016810?,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) AND prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' ORDER BY prescriptions.starttime DESC LIMIT 1,SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10016810 ) AND prescriptions.drug = 'potassium chl 20 meq / 1000 ml d5lr' ORDER BY prescriptions.starttime DESC LIMIT 1
ec94ea0d33b90b977c958e6d,How many patients have been admitted currently?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is null
bbcb03fc3471db9511c31648,What are the total inputs given to patient 10018845 since 03/27/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-27'","SELECT SUM(input) FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-03-27'"
0c5a19d98fb21ee7f7415577,"What drug was patient 10021118 prescribed with during the same day after receiving bypass coronary artery, one artery from left internal mammary, open approach this month?","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'bypass coronary artery, one artery from left internal mammary, open approach' ) AND procedures_icd.hadm_id = 10021118 AND datetime(procedures_icd.charttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id = 10021118 AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')"
633d7843ff15021b4c6b6ac9,Tell me the marital status of patient 10012853 in their last hospital encounter.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT marital_status FROM patients WHERE patients.id = 10012853 AND patients.marital_status IS NOT NULL ORDER BY patients.hadm_id DESC LIMIT 1
473f0352cd0b38c085ce1628,What is the difference between weights on patient 10038933 second measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT weight_valuenum FROM patient_vitals WHERE patient_id = 10038933 AND hospital_visit_id IN ( SELECT MAX(hospital_visit_id) FROM patient_visits WHERE patient_id = 10038933 ) ORDER BY charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT weight_valuenum FROM patient_vitals WHERE patient_id = 10038933 AND hospital_visit_id IN ( SELECT MAX(hospital_visit_id) FROM patient_visits WHERE patient_id = 10038933 ) ORDER BY charttime ASC LIMIT 1 )
4e04be3ade7631c7f953c6b5,Can you provide the list of the four most commonly ordered specimen tests this year?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 4","SELECT T1.spec_type_desc FROM ( SELECT specimen.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM specimen WHERE datetime(specimen.order_time,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY specimen.spec_type_desc ) AS T1 WHERE T1.C1 <= 4"
a4371b693f24038ad04881c2,"Was patient 10005909 prescribed with 0.9% sodium chloride, bag, or duloxetine during the first hospital visit?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( '0.9% sodium chloride', 'bag', 'duloxetine' )","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug IN ( '0.9% sodium chloride', 'bag', 'duloxetine' )"
7536a12b6079eeb3ed78aa85,What is the maximum total cost of the hospital visits that included the drug named fenofibrate since 2100?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'fenofibrate' ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM( DRUGS.COST ) AS C1 FROM DRUGS WHERE DRUGS.drug = 'fenofibrate' AND strftime('%Y',DRUGS.starttime) >= '2100' GROUP BY DRUGS.hadm_id ) AS T1"
647fbc4c18dc9b7300f25187,Count the number of days since patient 10021487's first diagnosis of other chronic nonalcoholic liver disease on the current hospital encounter.,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other chronic nonalcoholic liver disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.diagnoses_charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT icd_icd_to_chicd22.icd22_code FROM icd_icd_to_chicd22 WHERE icd_icd_to_chicd22.icd_code = 'K76.7' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'K76.7' ) AND diagnoses_icd.dischtime IS NULL ) AND admissions.dischtime IS NULL ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'K76.7' ) AND diagnoses_icd.dischtime IS NULL ) AND admissions.dischtime IS NULL ) AND diagnoses_icd.person_id = 10021487 ORDER BY diagnoses_icd.di"
ab2159e2914558a41cd56bff,What was the ciprofloxacin hcl dosage that patient 10019172 had been prescribed in 11/2100?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.drug = 'ciprofloxacin hcl' AND strftime('%Y-%m',prescriptions.starttime) = '2100-11'","SELECT DISTINCT ciprofloxacin hcl dosage FROM prescriptions WHERE prescriptions.patient_id = 10019172 AND strftime('%Y-%m',prescriptions.starttime) = '2100-11'"
efc169498c87c222d5b7020b,When was the last stool microbial test done in patient 10002495 since 04/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND microbiologyevents.spec_type_desc = 'stool' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-04' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT tests_in_ukc_microbiol.stool_microbial_test_time FROM tests_in_ukc_microbiol WHERE tests_in_ukc_microbiol.hadm_id = 10002495 AND strftime('%Y-%m',tests_in_ukc_microbiol.stool_microbial_test_time) >= '2100-04' ORDER BY tests_in_ukc_microbiol.stool_microbial_test_time DESC LIMIT 1"
729c62dcfd9ac11a32a56161,Has patient 10015860 been prescribed a drug since 1 year ago?,"SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015860 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10015860 ) AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year')"
9c733436d319028b982e6657,Can you show the top five most frequently prescribed drugs?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions GROUP BY drug ) AS T1 WHERE T1.C1 <= 5"
a3585e47c9d9845ccde194bf,"Has patient 10037975 been given a creatinine, urine test since 15 months ago?","SELECT COUNT(*)>0 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037975 ) AND datetime(labevents.charttime) >= datetime(current_time,'-15 month')","SELECT COUNT(*)>0 FROM urine_creatinine WHERE urine_creatinine.person_id = 10037975 AND datetime(urine_creatinine.charttime) >= datetime(current_time,'-15 month')"
fed90306e7ed0344ed0a3b7d,Was patient 10021487 given any dextrose 5% on this month/07?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '07'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'dextrose 5%' AND chartitems.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',inputevents.starttime) = '07'"
52f6bc8e9873cce45456c38e,Can you specify the gender of patient 10025463?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10025463,SELECT gender FROM patients WHERE patients.pid = 10025463
7b18e66852f4386ce57b39c1,Has there been any mrsa screen microbiology test done for patient 10029484 since 09/2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029484 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10029484 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09'"
a4e1867554fe617ae563f780,Calculate the total volume of drainage bag for patient 10021487 on this month/17.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'drainage bag' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',outputevents.charttime) = '17'","SELECT SUM(output) FROM output WHERE output.location = 'drainage bag' AND output.patient_id = 10021487 AND datetime(output.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',output.charttime) = '17'"
b216e416603adce99fc11398,"Among those who were prescribed with lidocaine 0.5%, what are the five most commonly prescribed drugs at the same time since 2100?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'lidocaine 0.5%' AND strftime('%Y',prescriptions.starttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT procedureevents.subject_id, procedureevents.charttime FROM procedureevents WHERE procedureevents.label = 'lidocaine 0.5%' AND strftime('%Y',procedureevents.charttime) >= '2100' ) AS T1 JOIN ( SELECT prescriptionevents.subject_id, prescriptionevents.drug, prescriptionevents.starttime FROM prescriptionevents WHERE strftime('%Y',prescriptionevents.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
2340588e1e30b4204874ee2d,What were the three most frequently taken lab tests this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.test_name FROM ( SELECT lab_tests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM lab_tests WHERE datetime(lab_tests.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY lab_tests.test_name ) AS T1 WHERE T1.C1 <= 3"
5ee74a87e14a3df9c0561df9,What's the admission count of patients in the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')"
04e0b332c01bf8b36c4973b5,Was the mean blood pressure of patient 10014729 ever less than 79.0 on 03/07/this year?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 79.0 AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '03-07'","SELECT COUNT(*)>0 FROM blood_pressure WHERE blood_pressure.patient_id = 10014729 AND blood_pressure.mean_bp < 79.0 AND datetime(blood_pressure.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',blood_pressure.charttime) = '03-07'"
636e9b1dbf501867d3e6e18b,How many patients went through a blood (toxo) microbiology test since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood (toxo)' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT microbiologyevents.pid FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood (toxo)' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') )"
264e8e9083e7fe02916af314,What was the name of the medication that patient 10025612 was prescribed for the last time in 10/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10025612 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10' ORDER BY prescriptions.starttime DESC LIMIT 1"
56cc41f276a6e10711d396f4,When was patient 10004720's first microbiology test done?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004720 ) ORDER BY microbiologyevents.charttime ASC LIMIT 1
cfe831c90fd2c89d0116f576,What was the name of the drug that patient 10019385 is first prescribed via td route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019385 ) AND prescriptions.route = 'td' ORDER BY prescriptions.starttime ASC LIMIT 1
463e41b4b414a3258b0bbab5,What's the maximum total cost of the hospital visits when they involve diagnostic ultrasound of digestive system since 1 year ago?,"SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'diagnostic ultrasound of digestive system' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MAX(T1.C1) FROM ( SELECT SUM( hospital_visits.cost ) AS C1 FROM hospital_visits WHERE hospital_visits.hospital_visits_id IN ( SELECT procedures.hospital_visits_id FROM procedures WHERE procedures.procedures = 'diagnostic ultrasound of digestive system' ) AND datetime(hospital_visits.admittime) >= datetime(current_time,'-1 year') GROUP BY hospital_visits.hospital_visits_id ) AS T1"
cfce5f7c561e0bbfd11e26e0,"How much does drainage of pericardial cavity with drainage device, percutaneous approach cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' ) )","SELECT DISTINCT cost FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'drainage of pericardial cavity with drainage device, percutaneous approach' )"
90a33678a92aaf96e62fc2a2,Find the number of patients who were admitted to the hospital during the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-1 year')"
2c065386f4cdb6f367bcf87b,How many patients got a mch test in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) AND strftime('%Y',labevents.charttime) = '2100' )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT labevents.pid FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'mch' ) AND strftime('%Y',labevents.charttime) = '2100' )"
53eee4b8cfb226d8418ce3fa,What procedure did patient 10007818 receive for the last time in this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY procedures_icd.charttime DESC LIMIT 1 )","SELECT procedures.name FROM procedures WHERE procedures.chartevents_charttime IN ( SELECT chartevents.chartevents_charttime FROM chartevents WHERE chartevents.chartevents_studycancelled = false AND chartevents.chartevents_hadm_id IN ( SELECT admissions.admissions_hadm_id FROM admissions WHERE admissions.admissions_subject_id = 10007818 ) AND datetime(chartevents.chartevents_charttime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY chartevents.chartevents_charttime DESC LIMIT 1 )"
47dc2df1f6767f65907affb2,What are the top five most common output events?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_procedures.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM d_icd_procedures WHERE d_icd_procedures.is_output = true GROUP BY d_icd_procedures.icd_code ) AS T1 WHERE T1.C1 <= 5 )"
c86ef1c99a73bd58d05ad456,How many days have passed since patient 10021487 stayed in the careunit emergency department during the current hospital visit for the last time?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', visits_chartevents.charttime) ) FROM visits_chartevents WHERE visits_chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.visitcharttime = ( SELECT MAX(visits.visitcharttime) FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id = 10021487 AND admissions.dischtime IS NULL ) ) ) ) ) ) AND visits_chartevents.itemid IN ( SELECT chartevents.itemid FROM chartevents WHERE chartevents.label = 'careunit' AND chartevents.chartevents.valuenum = 'emergency department' ) ORDER BY visits_chartevents.charttime DESC LIMIT 1"
e812406c3bfd789c61094039,How many people were discharged from hospital since 1 year ago?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime) >= datetime(current_time,'-1 year')"
7431290c2ccaa0fdcb10a27d,What are the three most frequently ordered medications that female patients aged 60 or above were prescribed within 2 months after they were diagnosed with unspecified essential hypertension in 2100?,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'f' ) AND admissions.age >= 60 AND strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'unspecified essential hypertension' AND strftime('%Y',diagnoses.diagnosis_date) = '2100' ) AS T1 JOIN ( SELECT patient_id, drug, first_time FROM ( SELECT patient_id, drug, min(starttime) AS first_time FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = '2100' ) AS T2 WHERE T2.first_time >= datetime(T1.diagnosis_date) AND datetime(T2.first_time) < datetime(T1.diagnosis_date,'+2 month') ) AS T2 ON T1.patient_id = T2.patient_id WHERE T2.patient_id IN ( SELECT patient_id FROM patients WHERE patients.gender = 'female' AND patients.age >= 60 ) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 3"
867b31660f489ea1d519e617,How many patients since 1 year ago underwent a blood (ebv) test?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood (ebv)' AND datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT labevents.patients_pid FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'blood (ebv)' ) AND datetime(labevents.charttime) >= datetime(current_time,'-1 year') )"
80d095627a05abf538ea0c80,"What are the three most commonly tested specimens for patients that were diagnosed with secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified previously in the same month, since 1 year ago?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT charttime, subject_id FROM diagnoses WHERE diagnoses.long_title = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' AND datetime >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT charttime, subject_id, spec_type_desc FROM specimens WHERE datetime >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3"
028f7b61531a4e8e6da28cd3,"For patients diagnosed with other and unspecified angina pectoris previously, what are the top four most common procedures applied within the same hospital visit since 2100?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified angina pectoris' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d1.proc_desc FROM ( SELECT d.proc_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT t1.subject_id, t1.visit_id FROM ( SELECT subject_id, visit_id FROM diagnosis WHERE diagnosis = 'other and unspecified angina pectoris' ) AS t1 JOIN ( SELECT subject_id, visit_id FROM procedures ) AS t2 ON t1.subject_id = t2.subject_id WHERE t1.visit_id = t2.visit_id ) AS tt JOIN procedures AS d ON tt.subject_id = d.subject_id WHERE tt.visit_id = d.visit_id AND strftime('%Y',d.starttime) >= '2100' GROUP BY d.proc_desc ) AS d1 WHERE d1.C1 <= 4"
46231873609912fe8e1019e7,Count the number of patients who since 2100 were prescribed pregabalin.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'pregabalin' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT prescriptions.pid FROM prescriptions WHERE prescriptions.drug = 'pregabalin' AND strftime('%Y',prescriptions.starttime) >= '2100' )"
0d3f767c99e8d250fc86ba71,Was patient 10015272's mcv second measured on the last hospital visit greater than the value from the first measurement on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mcv' ) ORDER BY labevents.charttime ASC LIMIT 1 ),SELECT ( SELECT mcv FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mcv' ) ORDER BY labresults.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT mcv FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10015272 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labresults.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mcv' ) ORDER BY labresults.charttime ASC LIMIT 1 )
8cfda20a9826789d8b58747a,How much does patient 10018423 change in systolic blood pressure last measured on the last ICU visit compared to the first value measured on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure systolic' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT arterialbloodpressure.systolic FROM arterialbloodpressure WHERE arterialbloodpressure.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY arterialbloodpressure.charttime DESC LIMIT 1 ) - ( SELECT arterialbloodpressure.systolic FROM arterialbloodpressure WHERE arterialbloodpressure.icustay_id IN ( SELECT icustays.icustay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) ORDER BY arterialbloodpressure.charttime ASC LIMIT 1 )
0ee20c63c4be119281d02113,Count the number of patients who were tested throughout this year for vitamin b12.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'vitamin b12' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT labevents.pid FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'vitamin b12' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )"
92b8f8b9f70e026d369cdfbd,Has there been any mrsa screen microbiology test result for patient 10003046 throughout this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10003046 ) AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year')"
0298d7de83dc23f17441f202,Were there any procedures conducted on patient 10006580 during the previous year?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10006580 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year')"
eea838bba39870d24a4fe781,Tell me what patient 10018501's void output was since 06/05/2100.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018501 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'void' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-06-05'","SELECT SUM(output) FROM output WHERE output.event_type = 'void' AND output.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018501 AND admissions.dischtime IS NULL ) AND strftime('%Y-%m-%d',output.charttime) >= '2100-06-05'"
0e4bb22781a9b0bc9dedffb9,When did patient 10004733 first have the minimum number of specific gravity on the current hospital visit?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'specific gravity' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 AND admissions.dischtime IS NULL ) AND labevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'specific gravity' AND items.linksto = 'labevents' ) ORDER BY labevents.valuenum ASC, labevents.charttime ASC LIMIT 1"
2a853454c790cac539c5c85d,"On 11/16/2100, did patient 10006053 have any cryoprecipitate input?","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'cryoprecipitate' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-11-16'",SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stdt = '2100-11-16' AND inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'cryoprecipitate' AND chartitems.linksto = 'inputevents' ) AND inputevents.hadm_id = 10006053
9b79fc00bb70e04132ba060c,What is the number of times that patient 10018081 had ostomy (output) since 12/03/2100?,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'ostomy (output)' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-03'","SELECT COUNT(*) FROM ostomy_output WHERE ostomy_output.patient_id = 10018081 AND strftime('%Y-%m-%d',ostomy_output.charttime) >= '2100-12-03'"
7022bd51f5732800e05583f3,"In 2100, how many patients were diagnosed with other specified forms of effusion, except tuberculous during the same hospital encounter after being diagnosed with injury to thoracic aorta?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to thoracic aorta' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other specified forms of effusion, except tuberculous' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime FROM ( SELECT subject_id, charttime FROM diagnoses WHERE diagnoses.long_title = 'injury to thoracic aorta' ) AS T1 WHERE T1.charttime >= '2100-01-01 00:00:00' ) AS T1 JOIN ( SELECT subject_id, charttime FROM diagnoses WHERE diagnoses.long_title = 'other specified forms of effusion, except tuberculous' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.charttime >= '2100-01-01 00:00:00' AND T2.charttime >= '2100-01-01 00:00:00'"
bdb9a3e39281b6f931c8ce45,"Since 2100, what are the top five most frequently given diagnoses that patients received within 2 months after being diagnosed with gout, unspecified?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gout, unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d3.long_title FROM d3 WHERE d3.row_id IN ( SELECT T3.c3 FROM ( SELECT T2.c3, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT p1.subject_id, d1.row_id FROM diagnoses d1 JOIN patients p1 ON d1.subject_id = p1.subject_id WHERE d1.long_title = 'gout, unspecified' AND strftime('%Y',d1.charttime) >= '2100' ) AS T1 JOIN ( SELECT p2.subject_id, d2.row_id, d2.charttime FROM diagnoses d2 JOIN patients p2 ON d2.subject_id = p2.subject_id WHERE strftime('%Y',d2.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.c3 ) AS T3 GROUP BY T3.c3 HAVING C1 <= 5 )"
606c8894c16dee6dfac6b9ec,"Following the diagnosis of nicotine dependence, cigarettes, uncomplicated in 2100, how many patients developed malignant neoplasm of unspecified part of unspecified bronchus or lung within 2 months?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'nicotine dependence, cigarettes, uncomplicated' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnosis_name = 'nicotine dependence, cigarettes, uncomplicated' AND strftime('%Y',diagnosis_date) = '2100' ) AS T1 JOIN ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnosis_name = 'malignant neoplasm of unspecified part of unspecified bronchus or lung' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.diagnosis_date AND datetime(T2.diagnosis_date) BETWEEN datetime(T1.diagnosis_date) AND datetime(T1.diagnosis_date,'+2 month')"
8227bef3ad3149f4b7e3b6e2,"Count the number of patients who had their extirpation of matter from left main bronchus, via natural or artificial opening endoscopic performed since 1 year ago.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extirpation of matter from left main bronchus, via natural or artificial opening endoscopic' ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'extirpation of matter from left main bronchus, via natural or artificial opening endoscopic' AND datetime(procedures.charttime) >= datetime(current_time,'-1 year') )"
601558b753933c463ad3089a,"During this ICU encounter, was the respiratory rate of patient 10018081 ever less than 35.0?",SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND icustays.outtime IS NULL ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 35.0,SELECT COUNT(*)>0 FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND icustays.icustay_id IN ( SELECT chartevents.icustay_id FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND chartevents.itemid IN ( SELECT d_icditems.itemid FROM d_icditems WHERE d_icditems.long_title = 'respiratory rate' AND d_icditems.icd_code = '78022' ) AND chartevents.valuenum < 35.0 )
bb5e3f49dbcb908901443bf7,Did patient 10029291 take any nacl 0.9% on 02/25/this year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '02-25'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'nacl 0.9%' AND chartitems.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '02-25'"
882c567028490e3b5f7d3fcc,What is the count of patients admitted to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE strftime('%Y',admissions.admittime) >= '2100'"
aa8337326151ea27fe36af1b,What was the name of the procedure that was performed two or more times in 03/this year on patient 10029291?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures_icd.charttime) = '03' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 >= 2 )","SELECT procedures.name FROM procedures WHERE procedures.chartevents_charttime IN ( SELECT T1.charttime FROM ( SELECT chartevents.charttime, COUNT( chartevents.charttime ) AS C1 FROM chartevents WHERE chartevents.chartevents_studysubjectid = 10029291 AND procedures.name = chartevents.chartevents_itemid AND datetime(chartevents.chartevents_charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',chartevents.chartevents_charttime) = '03' GROUP BY chartevents.charttime ) AS T1 WHERE T1.C1 >= 2 )"
9444a73db82e2c64ae8bcdb3,What was the total output volume that patient 10019172 had on 11/20/2100?,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-11-20'","SELECT SUM(output) FROM patientoutput WHERE patientid = 10019172 AND strftime('%Y-%m-%d',patientoutput.charttime) = '2100-11-20'"
264edd3d4d5f3f14d0173879,What was the last height record for patient 10011398 since 12/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-12' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT visits.stay_id FROM visits WHERE visits.subject_id = 10011398 ) AND chartevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'daily weight' AND items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-12' ORDER BY chartevents.charttime DESC LIMIT 1"
9a35c7b42b40e00811be3aac,Has patient 10039997 received nacl 0.9% in 12/last year?,"SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'nacl 0.9%' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'","SELECT COUNT(*)>0 FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'nacl 0.9%' AND chartitems.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'"
a71d906583f596e06c9f330d,What are the three most commonly received procedures for patients in their 30s since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 30 AND 39 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d1.proc_name FROM ( SELECT d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures d WHERE d.age BETWEEN 30 AND 39 AND strftime('%Y',d.charttime) >= '2100' GROUP BY d.proc_name ) AS d1 WHERE d1.C1 <= 3"
10b2e18ba65bee267f263e57,Does the heart rate of patient 10018081 ever go greater than 105.0 according to the database?,SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 105.0,SELECT COUNT(*)>0 FROM heart_rate WHERE heart_rate.valuenum > 105.0 AND heart_rate.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 )
a1db6846c07bdc99c68fda58,Has there been any organism found in the first sputum microbiology test patient 10038999 received?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 ) AND microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime ASC LIMIT 1,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'sputum' AND microbiologyevents.org_name IS NOT NULL AND microbiologyevents.event_type = 'first' AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10038999 )
1613b932a1fa398b6bb15ef8,Has any lab test been performed on patient 10016150 in 2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016150 ) AND strftime('%Y',labevents.charttime) = '2100'","SELECT COUNT(*)>0 FROM lab_tests WHERE lab_tests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10016150 ) AND strftime('%Y',lab_tests.charttime) = '2100'"
e06b5c902a757922a7a2e945,Count the number of patients diagnosed with gastro-esophageal reflux disease without esophagitis who did not come to the hospital within 2 months since 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'gastro-esophageal reflux disease without esophagitis' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) >= '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid FROM ( SELECT pid, first_time FROM ( SELECT pid, strftime('%Y-%m',admittime) as time FROM admissions WHERE strftime('%Y',admittime) >= '2100' ) AS T GROUP BY pid, time HAVING MIN(admittime) = T.admittime ) AS T1 WHERE T1.first_time >= datetime(current_time,'-2 month') ) AS TT1 WHERE NOT EXISTS ( SELECT * FROM ( SELECT pid, first_time FROM ( SELECT pid, strftime('%Y-%m',admittime) as time FROM admissions WHERE strftime('%Y',admittime) >= '2100' ) AS T GROUP BY pid, time HAVING MIN(admittime) = T.admittime ) AS T1 WHERE T1.pid = TT1.pid AND T1.first_time < datetime(current_time,'-2 month') )"
d331061cc248eb79de709879,Has patient 10038933 been diagnosed with any type of disease?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ),SELECT COUNT(*)>0 FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10038933 )
45917bbce3d4be5cd229b409,"When was the last time patient 10021487 had injury to liver without mention of open wound into cavity, hematoma and contusion diagnosed since 1 year ago?","SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'injury to liver without mention of open wound into cavity, hematoma and contusion' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT diagnoses.charttime FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) AND diagnoses.long_title = 'injury to liver without mention of open wound into cavity, hematoma and contusion' AND datetime(diagnoses.charttime) >= datetime(current_time,'-1 year') ORDER BY diagnoses.charttime DESC LIMIT 1"
6390dcaf504bd34b9a22032f,"Since 1 year ago, what are the top five most common drugs prescribed in the same month to male patients aged 50s after being diagnosed with unspecified sinusitis (chronic)?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified sinusitis (chronic)' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.subject_id IN ( SELECT patients.subject_id FROM patients WHERE patients.gender = 'm' ) AND admissions.age BETWEEN 50 AND 59 AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'unspecified sinusitis (chronic)' ) AS T1 JOIN ( SELECT patient_id, drug, prescription_date FROM prescriptions ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.prescription_date AND datetime(T1.diagnosis_date) >= datetime(current_time,'-1 year') AND datetime(T2.prescription_date) >= datetime(current_time,'-1 year') AND T1.diagnosis_date >= datetime(T2.prescription_date,'start of month') AND T2.prescription_date >= datetime(T2.prescription_date,'start of month') AND T1.patient_id IN ( SELECT patient_id FROM patients WHERE patients.gender = 'male' AND patients.age BETWEEN 50 AND 59 ) GROUP BY T2.drug ) AS T3 WHERE datetime(T3.prescription_date) >= datetime(current_time,'-1 year') GROUP BY T3.drug HAVING COUNT(*) >= ALL ( SELECT COUNT(*) FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS"
df9f9f77da1cf00ef44d4e96,Has patient 10015931 visited the hospital for admission during this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10015931 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM admissions WHERE admissions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.visits_id IN ( SELECT procedures.visits_id FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10015931 ) ) ) AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"
19858b1d6157d97c01ffb3cf,"During their last hospital visit, what time was patient 10001217's last surgery?",SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime DESC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.h
e840f7d25b661f8952fb1eb0,When was patient 10018081's last maximum diastolic blood pressure on this month/30?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',chartevents.charttime) = '30' ORDER BY chartevents.valuenum DESC, chartevents.charttime DESC LIMIT 1","SELECT blood_pressure.charttime FROM blood_pressure WHERE blood_pressure.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND datetime(blood_pressure.charttime,'start of month') = datetime(current_time,'start of month','-0 month') AND strftime('%d',blood_pressure.charttime) = '30' ORDER BY blood_pressure.diastolic DESC, blood_pressure.charttime DESC LIMIT 1"
3f4dd01d76af18b7e4220202,When did patient 10011398 first receive a diagnosis of other and unspecified hyperlipidemia on their last hospital visit?,SELECT diagnoses_icd.charttime FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1,SELECT diagnoses.charttime FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'other and unspecified hyperlipidemia' ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'other and unspecified hyperlipidemia' ) ORDER BY diagnoses.charttime ASC LIMIT 1
8fed981f895ac1aafc1084df,What were the top four microbiology tests most frequently performed throughout this year?,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT T1.test_name FROM ( SELECT microbiologytests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologytests WHERE datetime(microbiologytests.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY microbiologytests.test_name ) AS T1 WHERE T1.C1 <= 4"
e966f1d77c03eb69dafa1390,Calculate the total number of patients diagnosed with dependence on renal dialysis who didn't revisit the hospital during the same month in 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dependence on renal dialysis' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) = '2100' AND datetime(T2.charttime,'start of month') = datetime(admissions.admittime,'start of month') )","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.month FROM ( SELECT pid, strftime('%Y-%m',admittime) as month FROM admissions WHERE diagnoses_icd = 'dependence on renal dialysis' AND strftime('%Y',admittime) = '2100' ) AS T1 JOIN ( SELECT pid, strftime('%Y-%m',admittime) as month FROM admissions WHERE strftime('%Y',admittime) = '2100' ) AS T2 ON T1.pid = T2.pid WHERE T1.month = T2.month ) AS T3 GROUP BY T3.pid HAVING MIN(T3.month) = MAX(T3.month)"
c6b253614a8ea885b3619a02,What was the last measurement of patient 10020786's height in 07/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-07' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT measurements.valuenum FROM measurements WHERE measurements.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10020786 ) AND measurements.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'height' AND items.linksto = 'measurements' ) AND strftime('%Y-%m',measurements.charttime) = '2100-07' ORDER BY measurements.charttime DESC LIMIT 1"
e28928980fdbc1db31ee6b54,How much is the average total cost of a hospital visit that includes a phosphate lab test?,SELECT AVG(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'phosphate' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT AVG(T1.C1) FROM ( SELECT SUM( hospital_visits.cost ) AS C1 FROM hospital_visits WHERE hospital_visits.hospital_visits_id IN ( SELECT lab_tests.hospital_visits_id FROM lab_tests WHERE lab_tests.item = 'phosphate' ) GROUP BY hospital_visits.hospital_visits_id ) AS T1
c1ba984738060f77fc1c4445,What number of patients were discharged from the hospital during the previous year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND datetime(admissions.dischtime,'start of year') = datetime(current_time,'start of year','-1 year')"
2430afd64917976291b6054a,Tell me the top four of the most common output events since 1 year ago.,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents WHERE datetime(outputevents.charttime) >= datetime(current_time,'-1 year') GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d.output_desc FROM ( SELECT d.output_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM outputevents WHERE datetime >= datetime(current_time,'-1 year') ) AS e JOIN output_desc d ON e.output_desc = d.output_desc GROUP BY d.output_desc ) AS T WHERE T.C1 <= 4"
1436276ff4d05d626c742fa4,How many hours has it been since patient 10021487 got their last prescription of glucagon on this hospital stay?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'glucagon' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'glucagon' ORDER BY prescriptions.starttime DESC LIMIT 1"
908ebe3140a3419cb32dc270,How much is a surgery referred to as arteriography of femoral and other lower extremity arteries?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arteriography of femoral and other lower extremity arteries' ) ),SELECT DISTINCT cost FROM procedure_cost WHERE procedure_cost.procedure_description = 'arteriography of femoral and other lower extremity arteries'
7ae946cb6fe7f5a3cac9bfa8,"What was patient 10018423's last time of the bypass coronary artery, one artery from aorta with autologous venous tissue, open approach procedure in 2100?","SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND strftime('%Y',procedures_icd.charttime) = '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018423 ) AND procedures.label = 'bypass coronary artery, one artery from aorta with autologous venous tissue, open approach' AND strftime('%Y',procedures.starttime) = '2100' ORDER BY procedures.starttime DESC LIMIT 1"
87ac7c2e247976ad4e577de0,What is the minimum total cost of the hospital visits that ever had the drug named cyanocobalamin?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(T1.C1) FROM ( SELECT SUM( hospital_visits.cost ) AS C1 FROM hospital_visits WHERE hospital_visits.hospital_visits_id IN ( SELECT prescriptions.hospital_visits_id FROM prescriptions WHERE prescriptions.drug = 'cyanocobalamin' ) GROUP BY hospital_visits.hospital_visits_id ) AS T1
87fcf9c0339594cc79adb945,"Can you count the instances of the introduction of other thrombolytic into central vein, percutaneous approach procedure in 2100?","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'introduction of other thrombolytic into central vein, percutaneous approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100'"
11ee027a4849b568c91b8cfe,"Tell me, what were the five most common microbiology tests since 1 year ago?","SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 5","SELECT T1.test_name FROM ( SELECT microbiologytests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologytests WHERE datetime(microbiologytests.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologytests.test_name ) AS T1 WHERE T1.C1 <= 5"
2592fc0c41e2b7144c374342,"On the current hospital visit, how many days have passed since the first time patient 10021487 was prescribed clobetasol propionate 0.05% cream?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'clobetasol propionate 0.05% cream' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT ts_from_chartevents FROM chartevents WHERE chartevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'clobetasol propionate 0.05% cream' ) ) AND chartevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'current time' ) ORDER BY ts_from_chartevents ASC LIMIT 1 ) ) )"
9be1173dda0a298a23b91c0b,What is the number of patients who were diagnosed with accidents occurring in residential institution in 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'accidents occurring in residential institution' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' )","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid FROM ( SELECT pid, strftime('%Y',admittime) AS year FROM admissions WHERE strftime('%Y',admittime) = '2100' ) AS T1 JOIN ( SELECT pid, strftime('%Y',diagtime) AS year FROM diagnoses WHERE diagnoses.icd_code = 'Y92.0' ) AS T2 ON T1.pid = T2.pid WHERE T1.year = T2.year ) AS T3"
ee5f304ed38ac06c2b980f3f,Which patients were diagnosed with hyperpotassemia during this year?,"SELECT DISTINCT admissions.subject_id FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hyperpotassemia' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT DISTINCT patients.age FROM patients WHERE patients.age IS NOT NULL AND patients.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.long_title = 'hyperpotassemia' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )"
4724c2961dfc05d2b08ea4be,"Did patient 10020187 receive restriction of intracranial artery with intraluminal device, percutaneous approach in the last hospital encounter?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'restriction of intracranial artery with intraluminal device, percutaneous approach' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code( 'icd-11', '1A1Y.0' ) ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code( 'icd-11', '1A1Y.0' ) ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND procedures_icd.person_id = 10020187"
e5f56337e5fbe51641a80d77,What percentile of the hemoglobin value of 8.5 is within the same age as patient 10009628 during their last hospital encounter?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'hemoglobin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10009628 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 8.5","SELECT DISTINCT T1.C1 FROM ( SELECT R1.C1, PERCENT_RANK() OVER ( ORDER BY R1.C1 ) AS C2 FROM ( SELECT V1.C1 FROM ( SELECT AVG(V2.C1) AS C1 FROM ( SELECT V1.C1, V1.C2 FROM ( SELECT V2.C1, V2.C2 FROM ( SELECT AVG(V3.C1) AS C1 FROM ( SELECT V2.C1, V2.C2 FROM ( SELECT V1.C1, V1.C2 FROM ( SELECT T1.C1, T1.C2 FROM ( SELECT AVG(V2.C1) AS C1 FROM ( SELECT V1.C1, V1.C2 FROM ( SELECT V2.C1, V2.C2 FROM ( SELECT V1.C1, V1.C2 FROM ( SELECT T1.C1, T1.C2 FROM ( SELECT V1.C1, V1.C2 FROM ( SELECT AVG(V2.C1) AS C1 FROM ( SELECT V1.C1, V1.C2 FROM ( SELECT V2.C1, V2.C2 FROM ( SELECT V1.C1, V1.C2 FROM ( SELECT T1.C1, T1.C2 FROM ( SELECT"
580f56a66f7626bbcd078c21,Has patient 10023239 had any organisms detected in his last urine microbiology test in 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10023239 ) AND microbiologyevents.spec_type_desc = 'urine' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y',microbiologyevents.charttime) = '2100' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT COUNT(*)>0 FROM urine_microbiology WHERE urine_microbiology.hc_id = 10023239 AND urine_microbiology.org_name IS NOT NULL AND strftime('%Y',urine_microbiology.charttime) = '2100' ORDER BY urine_microbiology.charttime DESC LIMIT 1"
feaa451705254e6b2a61a7fb,"During this month, when was the first time that patient 10005817 was prescribed a medication via the iv drip route?","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) AND prescriptions.route = 'iv drip' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005817 ) AND prescriptions.route = 'iv drip' AND datetime(prescriptions.starttime,'start of month') = datetime(current_time,'start of month','-0 month') ORDER BY prescriptions.starttime ASC LIMIT 1"
73e1216fd32c02f0a88adb7b,"How many patients were prescribed the medicine metronidazole (flagyl) within 2 months after a diagnosis of urinary tract infection, site not specified since 1 year ago?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urinary tract infection, site not specified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'metronidazole (flagyl)' AND datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.charttime FROM ( SELECT pid, charttime FROM diagnoses WHERE diagnoses.label = 'urinary tract infection, site not specified' ) AS T1 WHERE T1.charttime >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT pid, charttime FROM ( SELECT pid, charttime FROM prescriptions WHERE prescriptions.drug = 'metronidazole (flagyl)' ) AS T2 WHERE T2.charttime >= datetime(current_time,'-1 year') ) AS T2 ON T1.pid = T2.pid WHERE datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"
f3d6d302751188c87c7c1304,What was the last medication that was prescribed to patient 10004733 in 12/this year through the iv route?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 ) AND prescriptions.route = 'iv' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ORDER BY prescriptions.starttime DESC LIMIT 1"
254b58ea3d513164000b4a51,When did patient 10035185 receive red blood cells test the first time in the first hospital visit?,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1,SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'red blood cells' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10035185 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime ASC LIMIT 1
9d71dca8add09e321ec57dd9,When did patient 10026354 last have or urine output since 02/26/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-02-26' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT or_urine_output.charttime FROM or_urine_output WHERE or_urine_output.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ) AND strftime('%Y-%m-%d',or_urine_output.charttime) >= '2100-02-26' ORDER BY or_urine_output.charttime DESC LIMIT 1"
c35acfb89f468f360b299535,"What was the first care unit patient 10018845 was in since 1 year ago, according to the transfer record?","SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND transfers.careunit IS NOT NULL AND datetime(transfers.intime) >= datetime(current_time,'-1 year') ORDER BY transfers.intime ASC LIMIT 1","SELECT T1.careunit FROM ( SELECT T2.careunit, ROW_NUMBER() OVER ( ORDER BY T2.intime ASC ) AS C1 FROM ( SELECT careunit, intime FROM transferevents WHERE transferevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018845 ) ) AS T2 WHERE datetime(T2.intime) >= datetime(current_time,'-1 year') ) AS T1 WHERE T1.C1 = 1"
5ad1c0bd8c724486755abcd6,How many ICU visits did patient 10018845 have during the first hospital encounter?,SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT( DISTINCT icustays.charttime ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018845 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )
d15b77ed559fe4e57aa57aad,"Among patients who were diagnosed with unspecified viral hepatitis c without hepatic coma during this year, what were the top three most common diagnoses that followed within 2 months?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified viral hepatitis c without hepatic coma' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d3.long_title FROM d3 WHERE d3.row_id IN ( SELECT T3.c3 FROM ( SELECT T2.c3, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT p1.subject_id, d1.row_id AS c1 FROM diagnoses d1 WHERE d1.long_title = 'unspecified viral hepatitis c without hepatic coma' AND datetime(d1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%Y',d1.charttime) = strftime('%Y',current_time) FROM diagnoses d1 JOIN patients p1 ON d1.subject_id = p1.subject_id WHERE d1.charttime IS NOT NULL AND p1.dod IS NULL GROUP BY p1.subject_id ) AS T1 JOIN ( SELECT p2.subject_id, d2.row_id AS c2, d2.charttime FROM diagnoses d2 JOIN patients p2 ON d2.subject_id = p2.subject_id WHERE datetime(d2.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%Y',d2.charttime) = strftime('%Y',current_time) AND d2.charttime IS NOT NULL AND p2.dod IS"
c486d3f623a7c682d0051190,Has any procedure been carried out on patient 10010471 in 2100?,"SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.person_id = 10010471 AND strftime('%Y',procedures_icd.charttime) = '2100'"
ea9a85005a244ffc9f78a09c,Find out the daily minimum or urine output volume of patient 10019172 during the previous month.,"SELECT MIN(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'or urine' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY strftime('%Y-%m-%d',outputevents.charttime)","SELECT MIN(or_urine.output) FROM or_urine WHERE or_urine.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(or_urine.charttime,'start of month') = datetime(current_time,'start of month','-1 month') GROUP BY strftime('%Y-%m-%d',or_urine.charttime)"
c48a0929fbf88f2a30c26873,"What are the three most frequently given microbiology tests for the patients who had previously received destruction of right main bronchus, via natural or artificial opening endoscopic within 2 months, since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right main bronchus, via natural or artificial opening endoscopic' ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( patient_id ) patient_id, procedures.starttime FROM procedures WHERE procedures.procedure_name = 'destruction of right main bronchus, via natural or artificial opening endoscopic' AND strftime('%Y',procedures.starttime) >= '2100' ) AS T1 JOIN ( SELECT DISTINCT ON ( patient_id ) patient_id, microbiologytests.starttime FROM microbiologytests WHERE strftime('%Y',microbiologytests.starttime) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.starttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.starttime) AND datetime(T1.starttime,'+2 month') GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3"
e5cc41e0f6f46286a68677c5,How many people were discharged since 2100 from the hospital?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND strftime('%Y',admissions.dischtime) >= '2100'"
ae1a0149163b093252133a46,"How many patients underwent diagnosis of postprocedural fever within 2 months after being diagnosed with body mass index 35.0-35.9, adult throughout this year?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'postprocedural fever' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT T1.patient_id, T1.charttime FROM ( SELECT patient_id, charttime FROM diagnoses WHERE diagnoses.long_title = 'body mass index 35.0-35.9, adult' ) AS T1 WHERE T1.charttime >= datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient_id, charttime FROM diagnoses WHERE diagnoses.long_title = 'postprocedural fever' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"
06b4d2263fcb4017df542024,Tell me the top three diagnoses with the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT icd_code, charttime, patients.age FROM diagnoses WHERE diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT icd_code, COUNT( * ) AS C1 FROM diagnoses GROUP BY icd_code ) AS T1 WHERE T1.C1 >= 100 ) ) AS T1 JOIN patients ON T1.charttime >= patients.admittime WHERE patients.dod IS NOT NULL GROUP BY T1.icd_code, patients.age ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 3 )"
d4949e694ea61ec816d403c4,"On 04/05/this year, what was the average value of respiratory rate for patient 10012552?","SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '04-05'","SELECT AVG(o2o1.respiratory_rate) FROM o2o1 WHERE o2o1.charttime >= datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',o2o1.charttime) = '04-05' AND o2o1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10012552 )"
e1c0f14b4eaae169e2ee99f7,How many patients were prescribed with bupropion (sustained release) in this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'bupropion (sustained release)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT prescriptions.pid FROM prescriptions WHERE prescriptions.drug = 'bupropion (sustained release)' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') )"
783af9c867b3757480fa6805,Can you tell me the top five most common procedures this year?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d1.proc_name FROM ( SELECT d.proc_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures d WHERE datetime(d.admittime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY d.proc_name ) AS d1 WHERE d1.C1 <= 5"
3a676bfafee66c27173904e8,"On the first hospital visit, was patient 10005866 admitted to the emergency room?",SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005866 AND admissions.admission_location = 'emergency room' AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT COUNT(*)>0 FROM emergency_room_visits WHERE emergency_room_visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005866 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 )
5534a345d569cc39211962ae,How many patients underwent other electric countershock of heart within 2 months after the diagnosis with personal history of tobacco use?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of tobacco use' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other electric countershock of heart' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.charttime FROM ( SELECT pid, charttime FROM diagnoses WHERE diagnoses.long_title = 'personal history of tobacco use' ) AS T1 ) AS V1 JOIN ( SELECT pid, charttime FROM procedures WHERE procedures.long_title = 'other electric countershock of heart' ) AS T2 ON V1.pid = T2.pid WHERE datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month')"
ad25b33f618fbda4463dc6d1,Is patient 10021938 recorded as male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10021938,SELECT DISTINCT patients.gender FROM patients WHERE patients.subject_id = 10021938
d738685ff207376b36d479fc,Is the value of patient 10021118's body temperature from second measurement on the last ICU visit less than its first measurement on the last ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_icditems.itemid FROM d_icditems WHERE d_icditems.icd_code = '99118' ) AND chartevents.charttime IN ( SELECT chartevents.charttime FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_icditems.itemid FROM d_icditems WHERE d_icditems.icd_code = '99118' ) ORDER BY chartevents.charttime ASC LIMIT 2 OFFSET 1 ) ) < ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_icditems
7d3d29193e98b64900b4be0a,What was the length of stay in days for patient 10012552's last hospitalization?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10012552 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1","SELECT strftime('%J', hout.time) - strftime('%J', hin.time) FROM hospital_visits AS hv WHERE hv.hadm_id IN ( SELECT h.hadm_id FROM hospitals AS h WHERE h.age = 10012552 AND h.dischtime IS NOT NULL ORDER BY h.admittime DESC LIMIT 1 ) AND hv.dischtime IS NOT NULL ORDER BY hv.admittime DESC LIMIT 1"
346a6c07df798347268b1abd,What was the total dosage of 5% dextrose that patient 10019172 was prescribed in 10/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND prescriptions.drug = '5% dextrose' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '10'","SELECT SUM(drug_doses.value) FROM drug_doses WHERE drug_doses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019172 ) AND drug_doses.drug = '5% dextrose' AND datetime(drug_doses.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',drug_doses.starttime) = '10'"
8a165a892467a3f42aa7f482,When did patient 10026255 last get a procedure since 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026255 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10026255 ) AND strftime('%Y',procedures.starttime) >= '2100' ORDER BY procedures.starttime DESC LIMIT 1"
3f3eaf9f4ef204effd22e28b,What is the length of the first hospital stay in days for patient 10020786?,"SELECT strftime('%J',admissions.dischtime) - strftime('%J',admissions.admittime) FROM admissions WHERE admissions.subject_id = 10020786 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1","SELECT strftime('%J', h1.outtime) - strftime('%J', h1.intime) FROM hospital_visits h1 WHERE h1.hadm_id IN ( SELECT h2.hadm_id FROM hospital_visits h2 WHERE h2.pid = 10020786 AND h2.dischtime IS NOT NULL ORDER BY h2.intime ASC LIMIT 1 )"
7535579b90cfcb61fed1c380,What was the organism's name found in the last peritoneal fluid microbiology test of patient 10021487 since 09/2100?,"SELECT microbiologyevents.org_name FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'peritoneal fluid' AND microbiologyevents.org_name IS NOT NULL AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-09' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT microbiologytests.org_name FROM microbiologytests WHERE microbiologytests.hc_id IN ( SELECT procedures.hc_id FROM procedures WHERE procedures.pr_id IN ( SELECT microbiologytests.pr_id FROM microbiologytests WHERE microbiologytests.spec_type_desc = 'peritoneal fluid' AND microbiologytests.org_name IS NOT NULL AND microbiologytests.hc_id = 10021487 AND strftime('%Y-%m',microbiologytests.charttime) >= '2100-09' ) ORDER BY microbiologytests.charttime DESC LIMIT 1 )"
502ed6b90b3e2ec409aab683,"Since 2100, how many patients were diagnosed with cyst and pseudocyst of pancreas in the same month after being diagnosed with secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary diabetes mellitus without mention of complication, not stated as uncontrolled, or unspecified' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cyst and pseudocyst of pancreas' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT T1.patient_id, T1.charttime FROM ( SELECT patient_id, charttime FROM diagnoses WHERE diagnoses.icd_code = 'E13.9' ) AS T1 WHERE strftime('%Y',T1.charttime) >= '2100' ) AS T1 JOIN ( SELECT patient_id, charttime FROM diagnoses WHERE diagnoses.icd_code = 'K860' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')"
104c93f89e19274578bafb8d,"When in the first hospital encounter did patient 10038999 receive their first drainage of left pleural cavity, percutaneous approach, diagnostic procedure?","SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10038999 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND procedures.label = 'drainage of left pleural cavity, percutaneous approach, diagnostic' ORDER BY procedures.starttime ASC LIMIT 1"
74968f3f69d0e352733f0a96,When was patient 10027602's first maximum pt in 12/this year?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'pt' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10027602 ) AND labevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'pt' AND items.linksto = 'labevents' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '12' ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1"
41a1ed79e0d60db97ece0e23,What was the insurance name of patient 10002930 during the first hospital visit?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10002930 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT DISTINCT insurance FROM insurance WHERE insurance IS NOT NULL AND insurance != 'self-pay' AND insurance != 'other' AND insurance != 'private' AND insurance != 'govt' AND insurance != 'missing' AND insurance != 'unknown' AND insurance != 'uninsured' AND insurance != 'medicare' AND insurance != 'medicaid' AND insurance != 'tricare' AND insurance != 'champva' AND insurance != 'other gov't' AND insurance != 'workers comp' AND insurance != 'va' AND insurance != 'other' AND insurance != 'cigna' AND insurance != 'aetna' AND insurance != 'blue cross' AND insurance != 'blue shield' AND insurance != 'united healthcare' AND insurance != 'humana' AND insurance != 'multiplan' AND insurance != 'federal' AND insurance != 'catholic' AND insurance != 'other' AND insurance != 'cisco' AND insurance != 'self' AND insurance != 'us department of defense' AND insurance != 'us department of veterans affairs' AND insurance != 'other' AND insurance != 'cisco' AND insurance != 'self' AND insurance != 'us department of defense' AND insurance != 'us department of veterans affairs' AND insurance
2f0d855d95535316ee099fde,Could you retrieve patient 10018081's daily minimum weight?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT MIN(o1.valuenum) FROM ( SELECT ob.valuenum, strftime('%Y-%m-%d',ob.charttime) as dt FROM otherevents ob WHERE ob.hadm_id IN ( SELECT ta.hadm_id FROM ( SELECT hadm_id, min(charttime) as charttime FROM otherevents WHERE otherevents.valuenum IS NOT NULL AND otherevents.hadm_id IN ( SELECT hadm_id FROM patients WHERE patients.age = 10018081 ) GROUP BY hadm_id ) as ta ) ) as o1 GROUP BY o1.dt"
4b10d0fec2f23acab915e3f3,Count how many times in the first hospital visit patient 10004457 had coronary arteriography using two catheters.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004457 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ),SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = 'icd-11:1C1.0' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = 'icd-11:1C1.0' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = 'icd-11:1C1.0' ) ) ) ) ) ) ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT
e5e99a0d4249da9d001cf97b,Has any laboratory test been performed on patient 10009049 since 04/2100?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',labevents.charttime) >= '2100-04'","SELECT COUNT(*)>0 FROM laboratoryevents WHERE laboratoryevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10009049 ) AND strftime('%Y-%m',laboratoryevents.charttime) >= '2100-04'"
8a0d9ca8816e2d1ca14e3fca,What was the last drug that patient 10019172 was prescribed in 11/this year?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019172 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' ORDER BY prescriptions.starttime DESC LIMIT 1"
53388f93019e894471f1753a,Has patient 10026354 undergone a procedure?,SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10026354 ),SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10026354 )
9930fa67b91f89cc964e7df3,Get the sum of the outputs that happened on 12/18/2100 for patient 10021487.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-12-18'","SELECT SUM(outputs.output) FROM outputs WHERE outputs.stdiid IN ( SELECT procedures.stdiid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) ) AND strftime('%Y-%m-%d',outputs.charttime) = '2100-12-18'"
97bd7321746aeee64c00043b,How much does patient 10014729 change in mch last measured on the last hospital visit compared to the second to last value measured on the last hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 ) - ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'mch' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT mch FROM labtests WHERE labtests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labtests.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mch' ) ORDER BY labtests.charttime DESC LIMIT 1 ) - ( SELECT mch FROM labtests WHERE labtests.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND labtests.itemid IN ( SELECT procedures.itemid FROM procedures WHERE procedures.label = 'mch' ) ORDER BY labtests.charttime DESC LIMIT 1 OFFSET 1 )
2b27156e1bc6e928eb6b916e,Get patient 10039831's yearly minimum weight information since 08/2100.,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-08' GROUP BY strftime('%Y',chartevents.charttime)","SELECT MIN(o1.valuenum) FROM ( SELECT o.valuenum, strftime('%Y',o.charttime) AS year FROM obs o WHERE o.hadm_id IN ( SELECT p.hadm_id FROM patients p WHERE p.age = 10039831 ) AND o.itemid IN ( SELECT d.itemid FROM d_icditems d WHERE d.long_title = 'daily weight' AND d.icd_code = 'v81.89' ) AND strftime('%Y-%m',o.charttime) >= '2100-08' GROUP BY year ) AS o1"
385953d76516f1f4e2f55b54,"What are the five frequently taken specimens for patients that received bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach previously in the same hospital visit in 2100?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'bypass coronary artery, three arteries from aorta with autologous venous tissue, open approach' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 5","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON ( bypass_coronary_artery_three_arteries_from_aorta_with_autologous_venous_tissue_open_approach.charttime, bypass_coronary_artery_three_arteries_from_aorta_with_autologous_venous_tissue_open_approach.hadm_id ) bypass_coronary_artery_three_arteries_from_aorta_with_autologous_venous_tissue_open_approach.charttime, bypass_coronary_artery_three_arteries_from_aorta_with_autologous_venous_tissue_open_approach.hadm_id FROM bypass_coronary_artery_three_arteries_from_aorta_with_autologous_venous_tissue_open_approach WHERE strftime('%Y',bypass_coronary_artery_three_arteries_from_aorta_with_autologous_venous_tissue_open_approach.charttime) = '2100' ) AS T1 JOIN ( SELECT DISTINCT ON ( specimens.charttime, specimens.hadm_id ) specimens.charttime, specimens.hadm_id, specimens.spec_type_desc FROM specimens WHERE strftime"
3909981e7b8628b8ba2086c0,When did patient 10002495 have an input for the last time on the first ICU stay?,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1,SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10002495 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) ORDER BY inputevents.starttime DESC LIMIT 1
1afade11184c7bc98c9756f8,"When did the last time patient 10005909 have a fibrinogen, functional lab test in the first hospital visit?","SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'fibrinogen, functional' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.valuenum IS NOT NULL AND labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.icd_code = 'fibrinogen, functional' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY labevents.charttime DESC LIMIT 1"
e75cb39d6c5c866076d93717,"Count the number of patients diagnosed with cocaine abuse, unspecified.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'cocaine abuse, unspecified' ) )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT diagnoses.pid FROM diagnoses WHERE diagnoses.label = 'cocaine abuse, unspecified' )"
67988ec18e5b42a1ac974aae,"Find the number of patients who had a dilation of left external iliac vein with intraluminal device, percutaneous approach procedure during this year.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'dilation of left external iliac vein with intraluminal device, percutaneous approach' ) AND datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') )",SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime is NOT NULL AND admissions.admissiontype = 'emergency' AND admissions.admissionyear = 2100 AND admissions.procedure_icd_code = '0jg3jz'
eb20ba71a6257201e3668689,What was the weight of patient 10006580 in the first measurement?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT weight FROM patients WHERE patients.id = 10006580 AND patients.weight IS NOT NULL ORDER BY patients.charttime ASC LIMIT 1
841488e721d7a4c3f1c219d0,Could you tell me the first procedure that patient 10019777 had in their first hospital encounter?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1 ),SELECT procedures.name FROM procedures WHERE procedures.row_id IN ( SELECT procedures_chart.row_id FROM procedures_chart WHERE procedures_chart.hadm_id IN ( SELECT admissions.row_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_chart.hadm_id FROM procedures_chart WHERE procedures_chart.row_id IN ( SELECT procedures.row_id FROM procedures WHERE procedures.name = 'first procedure' ) ) ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ORDER BY procedures_chart.charttime ASC LIMIT 1
6dc27e0c371f7e5dd9d2a981,When was the first time on the first ICU stay that patient 10027602's SaO2 was greater than 95.0?,SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 95.0 ORDER BY chartevents.charttime ASC LIMIT 1,"SELECT o1.charttime FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT * FROM patient 10027602's other ICU visits ) AS o WHERE o.valuenum > 95.0 ) AS o1 WHERE o1.charttime >= ( SELECT o2.charttime FROM ( SELECT o.charttime FROM ( SELECT * FROM patient 10027602's first ICU visit ) AS o WHERE o.valuenum > 95.0 ) AS o2 ORDER BY o2.charttime ASC LIMIT 1 ) ORDER BY o1.charttime ASC LIMIT 1"
b4a9db553c9c11bc9d4ae440,What label is associated with activity o2 sat - aerobic activity response?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'activity o2 sat - aerobic activity response',SELECT DISTINCT d_icd_procedures_long_title FROM d_icd_procedures WHERE d_icd_procedures_short_title = 'activity o2 sat - aerobic activity response'
dddc1e74733a55f7407289ad,"Since 1 year ago, what are the top five most frequently ordered laboratory tests for patients within the same month after diagnosed with dyskinesia of esophagus?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dyskinesia of esophagus' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.charttime, T1.hadm_id FROM ( SELECT * FROM diagnosis WHERE diagnosis = 'dyskinesia of esophagus' ) AS T1 WHERE datetime(T1.charttime) >= datetime(current_time,'-1 year') ) AS T2 JOIN ( SELECT * FROM ( SELECT T1.charttime, T1.hadm_id FROM ( SELECT * FROM labevents ) AS T1 WHERE datetime(T1.charttime) >= datetime(current_time,'-1 year') ) AS T3 ON T2.hadm_id = T3.hadm_id WHERE datetime(T2.charttime,'start of month') = datetime(T3.charttime,'start of month') ) AS T4 GROUP BY T4.test_name ) AS T3 WHERE T3.C1 <= 5"
fbd3d4a2eec48bed918ccbea,What is the cost of morphine sulfate (oral solution) 2 mg/ml?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate (oral solution) 2 mg/ml' ),SELECT DISTINCT drug_cost.cost FROM drug_cost WHERE drug_cost.drug = 'morphine sulfate (oral solution) 2 mg/ml'
a196342dccc0b8df5c23dbb4,Calculate the total number of patients diagnosed with other and unspecified anti-infectives causing adverse effects in therapeutic use who didn't revisit the hospital within the same month since 2100.,"SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified anti-infectives causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified anti-infectives causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) >= '2100' AND datetime(T2.charttime,'start of month') = datetime(admissions.admittime,'start of month') )","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.diagnosedate FROM ( SELECT pid, diagnosedate FROM d_icd_procedures WHERE icd_code = ( SELECT icd_procedures_icd_code FROM icd_procedures WHERE icd_procedures.long_title = 'other and unspecified anti-infectives causing adverse effects in therapeutic use' ) AND strftime('%Y',diagnosedate) >= '2100' ) AS T1 JOIN ( SELECT pid, admittedate FROM patients WHERE strftime('%Y',admittedate) >= '2100' ) AS T2 ON T1.pid = T2.pid WHERE T1.diagnosedate < T2.admittedate AND datetime(T1.diagnosedate,'start of month') = datetime(T2.admittedate,'start of month') ) AS T3"
b92ebae1949522c66677d297,What is the label assigned to arterial line waveform appear?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'arterial line waveform appear',SELECT DISTINCT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'arterial line waveform appear' )
307e60bc520a7699ba41926e,Provide me with the five most common diagnoses in this year.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.diagnosis_desc FROM diagnoses d WHERE d.diag_id IN ( SELECT T1.diag_id FROM ( SELECT d.diag_id, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses d WHERE datetime(d.admittime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY d.diag_id ) AS T1 WHERE T1.C1 <= 5 )"
a097854bd791e910e6d7bb57,Calculate how many times patient 10018081 had the input of dextrose 5% since 12/2100.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12'","SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'dextrose 5%' AND chartitems.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) >= '2100-12'"
cd72a23c76002c4a524a1b61,How many ICU visits did patient 10022880 have during this year?,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT( DISTINCT icustays.row_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10022880 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')"
59d98dcbea98f9f9a4f33d08,"Since 04/09/2100, when did patient 10013049 have the last input?","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10013049 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-09' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT input.time FROM input WHERE input.studysite = ( SELECT studysite.studysite FROM studysite WHERE studysite.hadm_id IN ( SELECT hadm_id FROM hadm WHERE hadm.pid = 10013049 ) ) AND strftime('%Y-%m-%d',input.time) >= '2100-04-09' ORDER BY input.time DESC LIMIT 1"
a9ddcfc0c9931bdb889ac570,What is the current number of hospitalized patients?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime is null,SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.dischtime IS NULL
c7725f7db94c9ef481ad6bc8,"Get me the top three most frequently tested specimens that patients took within the same hospital visit after being diagnosed with other postprocedural shock, initial encounter in 2100.","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other postprocedural shock, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT DISTINCT ON (diagnoses.chart_id) diagnoses.chart_id, diagnoses.diagnoses_icd_code, diagnoses.charttime FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'other postprocedural shock, initial encounter' ) AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT DISTINCT ON (events.chart_id) events.chart_id, events.spec_type_desc, events.charttime FROM events WHERE strftime('%Y',events.charttime) = '2100' ) AS T2 ON T1.chart_id = T2.chart_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of visit') = datetime(T2.charttime,'start of visit') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 3"
461ff9eeedf5e9452cbf12b2,"Has patient 10007818 had any drainage of peritoneal cavity, percutaneous approach, diagnostic treatment in 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of peritoneal cavity, percutaneous approach, diagnostic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 ) AND strftime('%Y',procedures_icd.charttime) = '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code( '0f0f0f0f-0f0f-0f0f-0f0f-0f0f0f0f0f0' ) ) AND procedures_icd.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.age = 10007818 ) AND strftime('%Y',procedures_icd.charttime) = '2100'"
c15288bf26d6222c25fe91c5,Tell me the total ICU visits of patient 10022281 in this year.,"SELECT COUNT( DISTINCT icustays.stay_id ) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022281 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(1) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10022281 ) AND datetime(icustays.intime,'start of year') = datetime(current_time,'start of year','-0 year')"
fca670cf3abe9563c60d2488,"What was the first time patient 10031757 was prescribed milk of magnesia and polyethylene glycol since 08/2100, at the same time?","SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'milk of magnesia' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'polyethylene glycol' AND admissions.subject_id = 10031757 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.starttime FROM ( SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031757 ) AND procedures.label = 'milk of magnesia' AND strftime('%Y-%m',procedures.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031757 ) AND prescriptions.drug = 'polyethylene glycol' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.starttime = T2.starttime WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1"
ee981ea61809ebc1e0cc8d32,Tell me the length of stay in days for patient 10018328's first ICU stay.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT strftime('%J',outtime) - strftime('%J',intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1"
26fba96883d9bde92fd8e95f,How many hours have elapsed since the last time patient 10004733 on this hospital stay received a lab test for lactate dehydrogenase (ld)?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'lactate dehydrogenase (ld)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT itemid FROM d_icditems WHERE d_icditems.long_title = 'lactate dehydrogenase (ld)' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.uniqueid = ( SELECT procedures.uniqueid FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 AND admissions.dischtime IS NULL ) AND procedures.label = 'other' ) ORDER BY procedures.charttime DESC LIMIT 1 ) ) ) ORDER BY labevents.charttime DESC LIMIT 1"
9cdee4aaa2811035370a1c86,Could you show me the daily average weight of patient 10039831 since 07/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-07' GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT AVG(o1.valuenum) FROM ( SELECT o.valuenum, strftime('%Y-%m-%d',o.charttime) as dt FROM chartevents o WHERE o.stay_id IN ( SELECT i.stay_id FROM patients i WHERE i.subject_id = 10039831 ) AND o.itemid IN ( SELECT p.itemid FROM d_icd_procedures p WHERE p.long_title = 'other' ) AND strftime('%Y-%m',o.charttime) >= '2100-07' GROUP BY strftime('%Y-%m-%d',o.charttime) ) AS o1 GROUP BY o1.dt"
d91bb87c28806cef8d1448de,When did patient 10023117 for the first time get discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10023117 AND strftime('%Y',admissions.admittime) >= '2100' ORDER BY admissions.dischtime ASC LIMIT 1","SELECT strftime('%Y-%m-%d',dischtime) FROM discharge WHERE pid = 10023117 AND strftime('%Y',dischtime) = '2100' ORDER BY dischtime ASC LIMIT 1"
c90feea97a983090cf329a91,"This year, what are the top five most frequently prescribed medications for patients who were also prescribed alteplase at the same time?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'alteplase' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT subject_id, hadm_id, to_char(starttime,'YYYY') AS year FROM alteplase_dose ) AS T1 JOIN ( SELECT subject_id, hadm_id, to_char(starttime,'YYYY') AS year FROM other_drugs ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.hadm_id = T2.hadm_id AND T1.starttime = T2.starttime ) AS T3 WHERE T3.year = to_char(current_time,'YYYY') GROUP BY T3.drug ) AS T4 WHERE T4.C1 <= 5"
c1c9a4182c3701af71cb1ea6,"What are the five most frequently prescribed medications for patients diagnosed with urethral stricture, unspecified previously within 2 months, this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'urethral stricture, unspecified' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM mimiciii_diagnoses WHERE diagnoses.long_title = 'urethral stricture, unspecified' AND datetime(diagnoses.diagnosis_date,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT patient_id, drug, prescription_start_time FROM mimiciii_prescriptions WHERE datetime(mimiciii_prescriptions.prescription_start_time,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.prescription_start_time AND datetime(T1.diagnosis_date,'start of year') = datetime(current_time,'start of year','-0 year') AND datetime(T1.diagnosis_date) >= datetime(T2.prescription_start_time) - interval 2 month GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
5061007ac9969cb42e64a034,When was the first time patient 10018328 had been prescribed enalapril maleate and amlodipine at the same time since 02/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'enalapril maleate' AND admissions.subject_id = 10018328 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'amlodipine' AND admissions.subject_id = 10018328 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-02' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.starttime FROM ( SELECT T1.starttime FROM ( SELECT presc1.starttime, presc1.stopsupply FROM ( SELECT prescription.starttime, prescription.stopsupply FROM prescription WHERE prescription.hadm_id IN ( SELECT observation.hadm_id FROM observation WHERE observation.charttime IN ( SELECT MIN(observation.charttime) FROM observation WHERE observation.hadm_id IN ( SELECT admission.hadm_id FROM admission WHERE admission.age = 10018328 ) ) ) AND prescription.drug = 'enalapril maleate' ) AS presc1 JOIN ( SELECT prescription.starttime, prescription.stopsupply FROM ( SELECT prescription.starttime, prescription.stopsupply FROM prescription WHERE prescription.hadm_id IN ( SELECT observation.hadm_id FROM observation WHERE observation.charttime IN ( SELECT MIN(observation.charttime) FROM observation WHERE observation.hadm_id IN ( SELECT admission.hadm_id FROM admission WHERE admission.age = 10018328 ) ) ) AND prescription.drug = 'amlodipine' ) AS presc2 WHERE presc1.starttime <= presc2.starttime AND ( presc1.stopsupply IS NULL OR presc2.starttime <= presc1.stopsupply ) ) AS T1 ON presc1.starttime = T1.starttime"
684346bf3b100ce2706bc5b6,How many patients received senna prescription since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'senna' AND strftime('%Y',prescriptions.starttime) >= '2100' )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT prescriptions.pid FROM prescriptions WHERE prescriptions.drug = 'senna' AND strftime('%Y',prescriptions.starttime) >= '2100' )"
6f8551a85f07e537ff14bede,How long has it been in hours since the first time ciprofloxacin iv was prescribed to patient 10018081 on the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'ciprofloxacin iv' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'ciprofloxacin iv' ORDER BY prescriptions.starttime ASC LIMIT 1"
9e71c9503ead8f262e901ec1,When was patient 10005348 prescribed with docusate sodium and dorzolamide 2%/timolol 0.5% ophth. for the first time at the same time since 08/2100?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'docusate sodium' AND admissions.subject_id = 10005348 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'dorzolamide 2%/timolol 0.5% ophth.' AND admissions.subject_id = 10005348 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime ASC LIMIT 1","SELECT T1.starttime FROM ( SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005348 ) AND procedures.label = 'docusate sodium' AND strftime('%Y-%m',procedures.starttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005348 ) AND prescriptions.drug = 'dorzolamide 2%/timolol 0.5% ophth.' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.starttime = T2.starttime"
7ecf2158ebabd494e514c3df,What does a procedure called total esophagectomy cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'total esophagectomy' ) ),SELECT DISTINCT cost FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'total esophagectomy' )
73710b96b938a24a7a5c86d5,Tell me the medication that patient 10014729 was prescribed for the first time?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ORDER BY prescriptions.starttime ASC LIMIT 1,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10014729 ) AND strftime('%Y',prescriptions.starttime) = '2100' ORDER BY prescriptions.starttime ASC LIMIT 1"
545a6730c778873c467d8235,Has there been any organism found in the last blood (toxo) microbiology test patient 10038081 received on their last hospital encounter?,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND microbiologyevents.spec_type_desc = 'blood (toxo)' AND microbiologyevents.org_name IS NOT NULL ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood (toxo)' AND microbiologyevents.org_name IS NOT NULL AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT microbiologyevents.hadm_id FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'blood (toxo)' AND microbiologyevents.org_name IS NOT NULL ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )
72e0ab522c86eeb3cfdf64d1,When did patient 10016742 first have the minimum heart rate since 282 days ago?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'heart rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-282 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1","SELECT heart_rate_events.charttime FROM heart_rate_events WHERE heart_rate_events.hadm_id = 10016742 AND datetime(heart_rate_events.charttime) >= datetime(current_time,'-282 day') ORDER BY heart_rate_events.valuenum ASC, heart_rate_events.charttime ASC LIMIT 1"
6b2dc0daeb3f829f08bf8da2,"Since the first time patient 10004733 was diagnosed with anemia of other chronic disease in the current hospital visit, how many hours has it been?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'anemia of other chronic disease' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', diagnoses1.charttime) ) FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 AND admissions.dischtime IS NULL ) AND diagnoses.long_title = 'anemia of other chronic disease' ORDER BY diagnoses.charttime ASC LIMIT 1"
0935d36097c74026c3b0a63f,What was the insurance plan of patient 10021666 during the first hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10021666 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT insurance FROM insurance WHERE insurance in ( SELECT insurance FROM hospital WHERE hospital.hospital_id in ( SELECT hospital_id FROM patient_hospital WHERE patient_hospital.patient_id = 10021666 AND patient_hospital.dischtime is not null ORDER BY patient_hospital.admittime ASC LIMIT 1 ) )
87caa8d42ef02882ac678a0c,"Following the diagnosis of other abnormal blood chemistry , how many patients developed autistic disorder, current or active state within the same month?","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other abnormal blood chemistry' ) ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'autistic disorder, current or active state' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, strftime('%Y-%m',diagnoses.charttime) FROM diagnoses WHERE diagnoses.long_title = 'other abnormal blood chemistry' ) AS T1 JOIN ( SELECT patient_id, strftime('%Y-%m',diagnoses.charttime) FROM diagnoses WHERE diagnoses.long_title = 'autistic disorder, current or active state' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')"
2e40656c79819632933f3d54,"The number of patients who received drainage of right pleural cavity with drainage device, percutaneous approach.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' ) )","SELECT COUNT( DISTINCT patient_id ) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'drainage of right pleural cavity with drainage device, percutaneous approach' )"
160050686bf62ecef4c7dce6,Could you tell me the name of the drug that was prescribed two or more times in 07/this year to patient 10020740?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T1.drug FROM ( SELECT drug, COUNT(*) AS C1 FROM ( SELECT drug, row_number() OVER ( PARTITION BY drug ORDER BY prescription_start_time ) AS C2 FROM prescriptions WHERE prescriptions.person_id = 10020740 AND datetime(prescriptions.prescription_start_time,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.prescription_start_time) = '07' ) GROUP BY drug ) AS T1 WHERE T1.C1 >= 2"
419163a7cde49786dfda6fcd,When was patient 10019172 first discharged from the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10019172 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year') ORDER BY admissions.dischtime ASC LIMIT 1",SELECT d.dischtime FROM discharge d WHERE d.hadm_id IN ( SELECT i.hadm_id FROM intakeouttake i WHERE i.hadm_id IN ( SELECT o.hadm_id FROM other o WHERE o.subject_id = 10019172 ) ) ORDER BY d.dischtime ASC LIMIT 1
764c80fc36e53d7964e0f522,"Since 01/2100, when was patient 10038933's first microbiology test done?","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10038933 ) AND strftime('%Y-%m',microbiologyevents.charttime) >= '2100-01' ORDER BY microbiologyevents.charttime ASC LIMIT 1"
e4373b254aad4b11af3fda65,When did patient 10029291 last have a fecal bag event on 03/06/2100?,"SELECT outputevents.charttime FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'fecal bag' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m-%d',outputevents.charttime) = '2100-03-06' ORDER BY outputevents.charttime DESC LIMIT 1","SELECT events.starttime FROM events WHERE events.studypersonid = 10029291 AND events.eventtype = 'fecal bag' AND strftime('%Y-%m-%d',events.starttime) = '2100-03-06' ORDER BY events.starttime DESC LIMIT 1"
e24591cf66202f06a8ac856c,How much is a diagnosis of secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes going to cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes' ) ),SELECT DISTINCT cost FROM cost WHERE cost.event_type = 'diagnosis' AND cost.event_id IN ( SELECT diagnosis FROM diagnosis WHERE diagnosis.long_title = 'secondary and unspecified malignant neoplasm of intra-abdominal lymph nodes' )
aef4b8676c07216d65074512,"How many days have passed since patient 10018081 was given a osmolality, urine laboratory test for the last time in the current hospital encounter?","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'osmolality, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'osmolality, urine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.long_title = 'osmolality, urine' ) AND procedures_icd.charttime IS NOT NULL ORDER BY procedures_icd.charttime DESC LIMIT 1 ) ) AND labevents.valuenum IS NOT NULL ORDER BY labevents.charttime DESC LIMIT 1"
52015439c33be0dc487387d4,"What does a bilirubin, total, ascites lab test typically cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'bilirubin, total, ascites' ) )","SELECT DISTINCT cost FROM lab_cost WHERE lab_test = 'bilirubin, total, ascites'"
8e96be7df6dd4cc4c1e2a3b4,How much is the daily minimum weight of patient 10031757 during the last hospital encounter?,"SELECT MIN(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT MIN(o1.valuenum) FROM ( SELECT o.valuenum, strftime('%Y-%m-%d',o.charttime) AS dt FROM chartevents o WHERE o.stay_id IN ( SELECT p.stay_id FROM patients p WHERE p.subject_id = 10031757 AND p.dischtime IS NOT NULL ORDER BY p.admittime DESC LIMIT 1 ) AND o.itemid IN ( SELECT d.itemid FROM d_icditems d WHERE d.long_title = 'daily weight' AND d.icd_code = 'vital signs' ) ) AS o1 GROUP BY o1.dt"
71cdc4002dd9037845bd713a,When did patient 10031404 have the first procedure?,SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031404 ) ORDER BY procedures_icd.charttime ASC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031404 ) ORDER BY procedures.starttime ASC LIMIT 1
9d986798e601a07346824191,What's the cost of a treatment known as excision of dental lesion of jaw?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'excision of dental lesion of jaw' ) ),SELECT DISTINCT cost FROM procedure_cost WHERE procedure_cost.procedure_description = 'excision of dental lesion of jaw'
1ade36110470a7879a7d9e8f,"For patients diagnosed with unspecified disorder of kidney and ureter, what were the top three most common microbiology tests that followed in the same hospital encounter since 2100?","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified disorder of kidney and ureter' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.test_name, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, encounter_id FROM diagnosis WHERE diagnosis = 'unspecified disorder of kidney and ureter' AND strftime('%Y',diagnosis_date) >= '2100' ) AS T1 JOIN ( SELECT patient_id, encounter_id, test_name FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.encounter_id = T2.encounter_id GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 3"
a17ee07e69ba77566438512c,"Among patients diagnosed with essential and other specified forms of tremor, what were the top four most common lab tests that followed during the same month throughout this year?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'essential and other specified forms of tremor' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 4 )","SELECT d3.label FROM ( SELECT d2.label, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT t1.subject_id, t1.charttime FROM ( SELECT subject_id, charttime FROM diagnosis WHERE diagnosis = 'essential and other specified forms of tremor' ) AS t1 WHERE strftime('%Y',t1.charttime) = '2100' ) AS t2 JOIN ( SELECT subject_id, labtest, charttime FROM ( SELECT subject_id, labtest, charttime FROM labtests WHERE strftime('%Y',charttime) = '2100' ) AS t3 ) AS d2 ON t2.subject_id = d2.subject_id WHERE t2.charttime < d2.charttime AND datetime(t2.charttime,'start of month') = datetime(d2.charttime,'start of month') GROUP BY d2.label ) AS d3 WHERE d3.C1 <= 4"
d198804fbc8f627ea7a4dd74,Can you provide the first care unit that patient 10010471 was in according to the transfer record?,SELECT transfers.careunit FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND transfers.careunit IS NOT NULL ORDER BY transfers.intime ASC LIMIT 1,"SELECT T1.careunit FROM ( SELECT T2.careunit, DENSE_RANK() OVER ( ORDER BY T2.intime ASC ) AS C1 FROM ( SELECT careunit, intime FROM transferevents WHERE transferevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10010471 ) ) AS T2 ) AS T1 WHERE T1.C1 <= 1"
ce3edde36063a4aeb5180c6d,"On last month/20, what was the maximum value of respiratory rate of patient 10019172?","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019172 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',chartevents.charttime) = '20'","SELECT MAX(o2o1.respiratory_rate) FROM other_o2o1 o2o1 WHERE o2o1.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019172 ) AND datetime(o2o1.charttime,'start of month') = datetime(current_time,'start of month','-1 month') AND strftime('%d',o2o1.charttime) = '20'"
9fd9c725dd075244d0eab9a8,What was the maximum sodium of patient 10020187?,SELECT MAX(labevents.valuenum) FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'sodium' ),SELECT MAX(labresults.valuenum) FROM labresults WHERE labresults.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020187 ) AND labresults.item = 'sodium'
426ce736177896950ecec77f,When was the first time when patient 10038933 received a other diagnostic procedures on lung or bronchus treatment during the first hospital encounter?,SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other diagnostic procedures on lung or bronchus' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10038933 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND procedures.label = 'other diagnostic procedures on lung or bronchus' ORDER BY procedures.starttime ASC LIMIT 1
7995633cbc3e134de24ae114,"How many hours has it been since the last time patient 10004733 stayed in the ""neurology"" careunit in this hospital encounter?","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'neurology' ORDER BY transfers.intime DESC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', careunit_stays.outtime) ) FROM careunit_stays WHERE careunit_stays.hospital_id IN ( SELECT hospital_visits.hospital_id FROM hospital_visits WHERE hospital_visits.patient_id = 10004733 AND hospital_visits.dischtime IS NULL ) AND careunit_stays.careunit = 'neurology' ORDER BY careunit_stays.outtime DESC LIMIT 1"
6e6c78c24792cbb6c1a9ef28,What is the name of the procedure done to patient 10002495 two times since 06/2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, COUNT( procedures_icd.charttime ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10002495 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-06' GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 = 2 )",SELECT procedures.name FROM procedures WHERE procedures.chartevents_charttime >= '2100-06-01' AND procedures.chartevents_stay_id IN ( SELECT chartevents_stay_id FROM chartevents WHERE chartevents_subject_id = 10002495 ) GROUP BY procedures.name HAVING COUNT( procedures.chartevents_row_id ) = 2
d86a9b2695aa71af6d0d7d55,What treatment did patient 10021118 last receive in their last hospital encounter?,SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime DESC LIMIT 1 ),SELECT treatments.treatment_name FROM treatments WHERE treatments.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.proc_id IN ( SELECT MAX(procedures.proc_id) FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.proc_id IN ( SELECT MAX(procedures.proc_id) FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.proc_id IN ( SELECT MAX(procedures.proc_id) FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT treatments.hadm_id FROM treatments WHERE treatments.treatment_name = 'other' AND treatments.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT treatments.hadm_id FROM treatments WHERE treatments.treatment_name
3f4e4d4220d360db25ef5ec8,What is the daily average dose of packed red blood cells given to patient 10008454 in 12/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'packed red blood cells' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m',inputevents.starttime) = '2100-12' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)","SELECT AVG(dose_val_rx) FROM ( SELECT SUM(dose_val_rx) FROM ( SELECT dose_val_rx FROM ( SELECT dose_val_rx, strftime('%Y-%m-%d',start_time) as start_time FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM ( SELECT * FROM"
e27e5f5f51fb07c86c07786c,Tell me the top five most common diagnoses of patients aged 20s in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d.diagnosis_desc FROM ( SELECT T1.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT p.age, d.diagnosis_desc FROM diagnoses d JOIN patients p ON d.hadm_id = p.hadm_id WHERE d.charttime >= '2100-01-01' AND d.charttime < '2101-01-01' AND p.age BETWEEN 20 AND 29 ) AS T1 GROUP BY T1.diagnosis_desc ) AS T2 WHERE T2.C1 <= 5"
dbf9297a4c1d683faa792fef,What is the yearly minimum volume of emesis that patient 10001217 had since 07/2100?,"SELECT MIN(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001217 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'emesis' AND d_items.linksto = 'outputevents' ) AND strftime('%Y-%m',outputevents.charttime) >= '2100-07' GROUP BY strftime('%Y',outputevents.charttime)","SELECT MIN(emesis.volume) FROM emesis WHERE emesis.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10001217 ) AND strftime('%Y-%m',emesis.charttime) >= '2100-07' GROUP BY strftime('%Y',emesis.charttime)"
21d5909e4b60ccf617b739c8,Can you list the top four most frequent procedures that patients received in the same month after having right heart cardiac catheterization in 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d1.procedure_name FROM ( SELECT d1.procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM procedures_icd WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS d1 WHERE d1.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'right heart cardiac catheterization' ) GROUP BY d1.procedure_name ) AS T1 WHERE T1.C1 <= 4"
3625536660a06042f6c55dae,What's the cost of a triglycer lab test?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'triglycer' ) ),SELECT DISTINCT cost FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.long_title = 'triglycer lab test' )
1e939d14d1e8cb2be9b12f9f,"Count the number of patients diagnosed with dissection of aorta, abdominal who did not come to the hospital within 2 months in 2100.","SELECT ( SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of aorta, abdominal' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 ) - ( SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dissection of aorta, abdominal' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 JOIN admissions ON T2.subject_id = admissions.subject_id WHERE T2.charttime < admissions.admittime AND strftime('%Y',admissions.admittime) = '2100' AND datetime(admissions.admittime) BETWEEN datetime(T2.charttime) AND datetime(T2.charttime,'+2 month') )","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.charttime FROM ( SELECT pid, charttime FROM diagnoses WHERE diagnoses.long_title = 'dissection of aorta, abdominal' ) AS T1 WHERE strftime('%Y',T1.charttime) = '2100' ) AS T1 WHERE NOT EXISTS ( SELECT T2.admittime FROM ( SELECT pid, admittime FROM admissions WHERE strftime('%Y',admissions.admittime) = '2100' ) AS T2 WHERE T1.pid = T2.pid AND datetime(T1.charttime) >= datetime(T2.admittime) - interval '2' month )"
82b93a79d0dad5db6d3f5918,Has patient 10008454 been in the hospital this year?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10008454 AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*)>0 FROM hospital_visits WHERE hospital_visits.patient_id = 10008454 AND datetime(hospital_visits.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"
9aad765d228011b95c3cf16c,Show me the top five diagnoses that have the highest 6-month mortality rate.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/2 GROUP BY admissions.subject_id, diagnoses_icd.icd_code HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T4.icd_code FROM ( SELECT T3.icd_code, DENSE_RANK() OVER ( ORDER BY T3.C2 ASC ) AS C3 FROM ( SELECT T2.icd_code, AVG(C1) AS C2 FROM ( SELECT T1.icd_code, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/2 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT patients.row_id, diagnoses.icd_code, diagnoses.charttime FROM diagnoses JOIN patients ON diagnoses.hadm_id = patients.hadm_id WHERE strftime('%J',current_time) - strftime('%J',diagnoses.charttime) >= 1 * 365/2 GROUP BY patients.row_id, diagnoses.icd_code HAVING MIN(diagnoses.charttime) = diagnoses.charttime ) AS T1 JOIN patients ON T1.row_id = patients.row_id ) AS T2 GROUP BY T2.icd_code ) AS T3 ) AS T4 WHERE T4.C3 <= 5 )"
d4b6c0167cad9291a4e1dbec,Is the value of troponin t in patient 10007058 from the last measurement on the first hospital visit greater than its second to last measurement on the first hospital visit?,SELECT ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 ) > ( SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007058 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'troponin t' ) ORDER BY labevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT troponin_t FROM patient10007058_labtest1 WHERE hospital_visit = 1 ORDER BY labtest1_time DESC LIMIT 1 ) > ( SELECT troponin_t FROM patient10007058_labtest1 WHERE hospital_visit = 1 ORDER BY labtest1_time DESC LIMIT 1 OFFSET 1 )
70516111809660e05336d719,When was the first sputum microbiology test performed on patient 10021487 in 12/2100?,"SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1","SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hospital_id = 10021487 AND microbiologyevents.spec_type_desc = 'sputum' AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-12' ORDER BY microbiologyevents.charttime ASC LIMIT 1"
79c09379a9bdcb0e976df35f,Show me the top four most common microbiology tests since 1 year ago.,"SELECT T1.test_name FROM ( SELECT microbiologyevents.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE datetime(microbiologyevents.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologyevents.test_name ) AS T1 WHERE T1.C1 <= 4","SELECT T1.test_name FROM ( SELECT microbiologytests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologytests WHERE datetime(microbiologytests.charttime) >= datetime(current_time,'-1 year') GROUP BY microbiologytests.test_name ) AS T1 WHERE T1.C1 <= 4"
42dafd4cb9bdc6f884302fb7,Calculate how many times patient 10021487 had the input of kcl (bolus) in 12/last year.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',inputevents.starttime) = '12'","SELECT COUNT(*) FROM inputevents WHERE inputevents.stdt >= datetime(current_time,'start of year','-1 year') AND inputevents.stdt < datetime(current_time,'start of year') AND inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'kcl (bolus)' ) AND inputevents.hadm_id = 10021487 AND strftime('%m',inputevents.stdt) = '12'"
9a8ac4df220dc07a83eeae9b,When was patient 10019777's last insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s) treatment in 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) AND strftime('%Y',procedures_icd.charttime) = '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019777 ) AND procedures.label = 'insertion of non-drug-eluting peripheral (non-coronary) vessel stent(s)' AND strftime('%Y',procedures.starttime) = '2100' ORDER BY procedures.starttime DESC LIMIT 1"
45b3c545de90501570505db8,What was the dose of heparin flush (10 units/ml) that was prescribed since 04/2100 for the last time to patient 10004235?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) AND prescriptions.drug = 'heparin flush (10 units/ml)' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT heparin flush (10 units/ml).dose_val_rx FROM heparin flush (10 units/ml) WHERE heparin flush (10 units/ml).person_id = 10004235 AND strftime('%Y-%m',heparin flush (10 units/ml).start_time) >= '2100-04' ORDER BY heparin flush (10 units/ml).start_time DESC LIMIT 1"
32fa88a37c2489a86ba893e5,When did patient 10027445 for the last time leave the hospital?,"SELECT admissions.dischtime FROM admissions WHERE admissions.subject_id = 10027445 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year') ORDER BY admissions.dischtime DESC LIMIT 1",SELECT discharge_time FROM discharge WHERE discharge.time is NOT NULL AND discharge.patient_id = 10027445 ORDER BY discharge.time DESC LIMIT 1
7d00004b3e825ffc842ff770,"Among patients who were diagnosed with asthma, unspecified type, unspecified since 1 year ago, what are the top three most frequent diagnoses that followed afterwards in the same month?","SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asthma, unspecified type, unspecified' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 3 )","SELECT d3.long_title FROM d3 WHERE d3.row_id IN ( SELECT T3.c3 FROM ( SELECT T2.c3, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT p1.subject_id, d1.charttime FROM diagnoses d1 WHERE d1.long_title = 'asthma, unspecified type, unspecified' AND datetime(d1.charttime) >= datetime(current_time,'-1 year') AND strftime('%Y-%m',d1.charttime) = strftime('%Y-%m',current_time) GROUP BY p1.subject_id ) AS T1 JOIN ( SELECT p2.subject_id, d2.charttime, d2.long_title FROM diagnoses d2 WHERE datetime(d2.charttime) >= datetime(current_time,'-1 year') AND strftime('%Y-%m',d2.charttime) = strftime('%Y-%m',current_time) GROUP BY p2.subject_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.c3 ) AS T3 WHERE T3.C1 <= 3 )"
c1088984666feded19fe629d,Is patient 10020306 male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10020306,SELECT COUNT(*)>0 FROM patients WHERE patients.gender = 'male' AND patients.subject_id = 10020306
c2eca2905474a01bac57fe3d,"In the first ICU visit, what was the first mean blood pressure for patient 10018328?",SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018328 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT visits.stay_id FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018328 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'arterial blood pressure mean' AND items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1
b822a4c44ce54f12b21a2ba9,Has any lab test been performed on patient 10015931 in 10/last year?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10015931 ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',labevents.charttime) = '10'","SELECT COUNT(*)>0 FROM lab_tests WHERE lab_tests.person_id = 10015931 AND datetime(lab_tests.charttime,'start of year') = datetime(current_time,'start of year','-1 year') AND strftime('%m',lab_tests.charttime) = '10'"
393404a584eb0bb1b6bbe900,What was the last height reading for patient 10020944 in 03/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) = '2100-03' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT height FROM patients_measurements WHERE patients_measurements.patient_id = 10020944 AND strftime('%Y-%m',patients_measurements.charttime) = '2100-03' ORDER BY patients_measurements.charttime DESC LIMIT 1"
3721cde992fe90dd17278b65,How many hours have passed since the patient 10021487 was admitted to the hospital?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL","SELECT 24 * ( strftime('%J',current_time) - strftime('%J',admissions.admittime) ) FROM admissions WHERE admissions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10021487 AND visits.dischtime IS NULL )"
634500145917954d7e9ba9c0,What are the five most common treatments for patients aged 20s since 1 year ago?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 20 AND 29 ) AND datetime(procedures_icd.charttime) >= datetime(current_time,'-1 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT T1.treatment FROM ( SELECT procedures_icd.description, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE procedures_icd.charttime >= datetime(current_time,'-1 year') AND procedures_icd.age BETWEEN 20 AND 29 GROUP BY procedures_icd.description ) AS T1 WHERE T1.C1 <= 5"
70b7e8f278566e9443f31eaf,Has there been any results of the microbiological mrsa screen test for patient 10031757 since 2100?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND strftime('%Y',microbiologyevents.charttime) >= '2100'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.spec_type_desc = 'mrsa screen' AND microbiologyevents.spec_type_desc IS NOT NULL AND microbiologyevents.test_results IS NOT NULL AND microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031757 ) AND strftime('%Y',microbiologyevents.charttime) >= '2100'"
927645663d3fd105f686319c,"List the top five most frequent procedures that patients underwent during the same month after being diagnosed with adverse effect of anticoagulants, initial encounter in 2100.","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'adverse effect of anticoagulants, initial encounter' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d3.procedure_name FROM ( SELECT d2.procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.patient_id, T1.charttime FROM ( SELECT patient_id, charttime FROM diagnoses WHERE diagnoses.long_title = 'adverse effect of anticoagulants, initial encounter' ) AS T1 JOIN ( SELECT patient_id, charttime FROM procedures ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') ) AS D1 GROUP BY D1.procedure_name ) AS D2 ) AS d3 WHERE d3.C1 <= 5"
ed31b107608f8a15bae7aa15,How much is a diagnosis of hypovolemia going to cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'hypovolemia' ) ),SELECT DISTINCT cost FROM cost WHERE cost.event_type = 'diagnosis' AND cost.event_id IN ( SELECT diagnosis_from_icd.diagnosis_id FROM diagnosis_from_icd WHERE diagnosis_from_icd.icd_code = ( SELECT icd.icd_code FROM icd WHERE icd.long_title = 'hypovolemia' ) )
f3b876d4c257e4b4bc897442,Can you fetch me patient 10016810's yearly maximum albumin 25% input since 07/02/2100?,"SELECT MAX(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016810 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'albumin 25%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-02' GROUP BY strftime('%Y',inputevents.starttime)","SELECT MAX(input) FROM inputevents WHERE inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'albumin 25%' ) AND inputevents.stay_id IN ( SELECT patients.stay_id FROM patients WHERE patients.subject_id = 10016810 ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-07-02' GROUP BY strftime('%Y',inputevents.starttime)"
ce229386a278fc4dbc3f4f87,What was patient 10021487's last weight since 20 months ago?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-20 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT weight FROM dailyweight WHERE dailyweight.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) AND datetime(dailyweight.charttime) >= datetime(current_time,'-20 month') ORDER BY dailyweight.charttime DESC LIMIT 1"
c60ed59c6b7df6bf5fbfa0cf,How many hours have passed since the first time patient 10004733 has taken a albumin lab test during this hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'albumin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT itemid FROM d_icditems WHERE d_icditems.long_title = 'albumin' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = 'unspecified' ) ) AND admissions.dischtime IS NULL ) AND admissions.age = 10004733 ) ORDER BY labevents.charttime ASC LIMIT 1"
a75f7d749b9d5901f73d2d35,What's the maximum total hospital charged for a visit with a atypical lymphocytes lab test?,SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'atypical lymphocytes' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM( CHARGE ) AS C1 FROM CHARGES WHERE CHARGES.HADM_ID IN ( SELECT LABEVENTS.HADM_ID FROM LABEVENTS WHERE LABEVENTS.ITEMID IN ( SELECT PROCEDUREITEMS.ITEMID FROM PROCEDUREITEMS WHERE PROCEDUREITEMS.TYPENAME = 'lab test' AND PROCEDUREITEMS.NAME = 'atypical lymphocytes' ) ) GROUP BY CHARGES.HADM_ID ) AS T1
59e57b904fb229550751564d,What is the average daily number of patients who had embolism and thrombosis of other specified artery in 2100?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'embolism and thrombosis of other specified artery' ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY strftime('%Y-%m-%d',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT T2.subject_id ) AS C1 FROM ( SELECT subject_id, strftime('%Y-%m-%d',admittime) AS D1 FROM diagnoses WHERE diagnoses.long_title = 'embolism and thrombosis of other specified artery' ) AS T1 JOIN ( SELECT subject_id, strftime('%Y-%m-%d',admittime) AS D1 FROM admissions WHERE strftime('%Y',admissions.admittime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.D1 = T2.D1 GROUP BY T1.D1 )"
472793119170f9c8adb0b84b,Is patient 10021487's diastolic blood pressure ever less than 31.0 since 09/08/2100?,"SELECT COUNT(*)>0 FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum < 31.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-09-08'","SELECT COUNT(*)>0 FROM arterialbloodpressure WHERE arterialbloodpressure.diastolicbp < 31.0 AND arterialbloodpressure.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.subject_id = 10021487 ) AND strftime('%Y-%m-%d',arterialbloodpressure.charttime) >= '2100-09-08'"
e7d42c3433b73b5b7e9bab9a,"Has patient 10021312 been treated with a destruction of right lower lung lobe, via natural or artificial opening endoscopic since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021312 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd.icd_code FROM icd WHERE icd.long_title = 'destruction of right lower lung lobe, via natural or artificial opening endoscopic' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021312 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'"
234a24d7c0ae3805bd918372,What condition was patient 10008454 diagnosed with the last time on the first hospital visit?,SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10008454 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1 ),SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT diagnoses.icd_code FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = d_icd_diagnoses.icd_code ) AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND admissions.dischtime IS NOT NULL ORDER BY diagnoses.charttime DESC LIMIT 1 )
5886a94103455554061fb16a,What was the quantity of glucose gel dose prescribed to patient 10020740 in 07/this year?,"SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 ) AND prescriptions.drug = 'glucose gel' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '07'","SELECT SUM(dose_val_rx) FROM d_icd_procedures WHERE icd_code = ( SELECT icd_procedures_icd_code FROM icd_procedures WHERE icd_procedures.long_title = 'glucose gel dose' ) AND d_icd_procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020740 ) AND datetime(d_icd_procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',d_icd_procedures.charttime) = '07'"
e19ea171900405ad202eba5f,Retrieve the marital status of patient 10038081 on their first hospital visit.,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10038081 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT marital_status FROM patients WHERE patients.id = 10038081 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1
6df8c8add4bde78a73d76071,When was the first time patient 10009035 received the procedure of extracorporeal circulation auxiliary to open heart surgery in the last hospital visit?,SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY procedures_icd.charttime ASC LIMIT 1,SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10009035 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND procedures.label = 'extracorporeal circulation auxiliary to open heart surgery' ORDER BY procedures.starttime ASC LIMIT 1
5f65914db7e338f8263f8fa7,When was patient 10001217 prescribed the drug heparin and ondansetron at the same time for the last time in 12/this year?,"SELECT T1.starttime FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'heparin' AND admissions.subject_id = 10001217 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'ondansetron' AND admissions.subject_id = 10001217 AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) ORDER BY T1.starttime DESC LIMIT 1","SELECT T1.starttime FROM ( SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10001217 ) AND procedures.label = 'heparin' AND datetime(procedures.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',procedures.starttime) = '12' ) AS T1 JOIN ( SELECT prescriptions.starttime FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10001217 ) AND prescriptions.drug = 'ondansetron' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '12' ) AS T2 ON T1.starttime = T2.starttime WHERE datetime(T1.starttime) >= datetime(current_time,'start of year','-0 year') ORDER BY T1.starttime DESC LIMIT 1"
a54ef0e3bf3dcba73ecf9d1f,"What are the five commonly prescribed drugs for patients diagnosed with personal history of malignant neoplasm of large intestine previously within 2 months, since 1 year ago?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of large intestine' ) AND datetime(diagnoses_icd.charttime) >= datetime(current_time,'-1 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime) >= datetime(current_time,'-1 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM diagnoses WHERE diagnoses.label = 'personal history of malignant neoplasm of large intestine' ) AS T1 JOIN ( SELECT patient_id, drug, prescription_date FROM prescriptions ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.prescription_date AND datetime(T2.prescription_date) >= datetime(T1.diagnosis_date) + interval 2 month AND datetime(T2.prescription_date) >= datetime(current_time,'-1 year') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
ddb17df095695ae5f9fbddeb,Tell me the top three most common diagnoses for patients with age 60 or above in 2100.,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age >= 60 ) AND strftime('%Y',diagnoses_icd.charttime) = '2100' GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 3 )","SELECT d.diagnosis_desc FROM ( SELECT d.diagnosis_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses d WHERE d.age >= 60 AND strftime('%Y',d.admittime) = '2100' GROUP BY d.diagnosis_desc ) WHERE C1 <= 3"
16df9ac99e3822d7b993b443,"During this year, what are the top five most frequent lab tests given to patients during the same hospital encounter after pleurisy without mention of effusion or current tuberculosis?","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T3.itemid FROM ( SELECT T2.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pleurisy without mention of effusion or current tuberculosis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, labevents.itemid, labevents.charttime, admissions.hadm_id FROM labevents JOIN admissions ON labevents.hadm_id = admissions.hadm_id WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.itemid ) AS T3 WHERE T3.C1 <= 5 )","SELECT T3.test_name FROM ( SELECT T2.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, encounter_id FROM pleurisy_without_mention_of_effusion_or_current_tuberculosis WHERE datetime(this year) >= datetime(current year) - 1 year ) AS T1 JOIN ( SELECT patient_id, encounter_id, test_name FROM lab_tests WHERE datetime(this year) >= datetime(current year) - 1 year ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.encounter_id = T2.encounter_id AND T1.datetime < T2.datetime GROUP BY T2.test_name ) AS T3 WHERE T3.C1 <= 5"
89105357ecaae9b49a2a1134,How many patients received a closed [endoscopic] biopsy of bronchus after the procedure of arterial catheterization during the same hospital encounter?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'arterial catheterization' ) ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed [endoscopic] biopsy of bronchus' ) ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, procedures_starttime FROM procedures WHERE procedures_code = 'arterial catheterization' AND procedures_endtime IS NOT NULL ) AS T1 JOIN ( SELECT patient_id, procedures_starttime FROM procedures WHERE procedures_code = 'closed [endoscopic] biopsy of bronchus' AND procedures_endtime IS NOT NULL ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.procedures_endtime IS NOT NULL AND T2.procedures_endtime IS NOT NULL AND datetime(T1.procedures_starttime,'start of year') = datetime(T2.procedures_starttime,'start of year') AND T1.hospital_visit_id = T2.hospital_visit_id"
22605cacd4a47bb1b91b1b75,What was the name of the drug that patient 10031757 had been prescribed two times in 11/this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',prescriptions.starttime) = '11' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 = 2","SELECT T1.drug FROM ( SELECT drug, COUNT(*) AS C1 FROM ( SELECT drug, strftime('%Y-%m',presc_datetime) AS time FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031757 ) AND strftime('%Y',presc_datetime) = strftime('%Y',current_time) ) GROUP BY drug, time ) AS T1 WHERE T1.C1 = 2 AND strftime('%Y-%m',T1.time) = '2100-11'"
a07e014b5e2eb6177b5978a3,"Since 15 months ago, what was the last weight for patient 10011398?","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-15 month') ORDER BY chartevents.charttime DESC LIMIT 1","SELECT weight FROM dailyweight WHERE dailyweight.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10011398 ) AND datetime(dailyweight.charttime) >= datetime(current_time,'-15 month') ORDER BY dailyweight.charttime DESC LIMIT 1"
e38192db81eb4aedd18e81f8,Calculate the total volume of mediastinal for patient 10005817 on 12/24/this year.,"SELECT SUM(outputevents.value) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'mediastinal' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-24'","SELECT SUM(mediastinal) FROM inputevents WHERE inputevents.stay_id IN ( SELECT stays.stay_id FROM stays WHERE stays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005817 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-24'"
23ecc70fdf2e92d39a932541,What would be the average yearly number of patients diagnosed with methicillin susceptible pneumonia due to staphylococcus aureus?,"SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT diagnoses_icd.hadm_id ) AS C1 FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'methicillin susceptible pneumonia due to staphylococcus aureus' ) GROUP BY strftime('%Y',diagnoses_icd.charttime) ) AS T1","SELECT AVG(T1.C1) FROM ( SELECT COUNT( DISTINCT T1.onc_icd_diagnoses_charttime.patient_id ) AS C1 FROM ( SELECT onc_icd_diagnoses_charttime.patient_id, onc_icd_diagnoses_charttime.charttime FROM onc_icd_diagnoses_charttime WHERE onc_icd_diagnoses_charttime.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'methicillin susceptible pneumonia due to staphylococcus aureus' ) ) AS T1 GROUP BY strftime('%Y',T1.charttime) ) AS T1"
58f40bf6ff1c20a773a056ae,"Among the patients who were prescribed fentanyl citrate, what are the five most frequently prescribed drugs at the same time in this year?","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'fentanyl citrate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 ON T1.subject_id = T2.subject_id WHERE datetime(T1.starttime) = datetime(T2.starttime) GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, strftime('%Y',prescribed_at) AS C2 FROM prescriptions WHERE prescriptions.drug = 'fentanyl citrate' AND strftime('%Y',prescriptions.prescribed_at) = strftime('%Y',current_time) ) AS T1 JOIN ( SELECT patient_id, prescribed_at, drug FROM prescriptions WHERE strftime('%Y',prescriptions.prescribed_at) = strftime('%Y',current_time) ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.prescribed_at = T2.prescribed_at AND T1.drug != T2.drug GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
905bf1d8d8b2ee5cc48396ca,"Has the prescription of sodium chloride 0.9%, nicardipine iv, or ondansetron been given to patient 10039997 in 2100?","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039997 ) AND prescriptions.drug IN ( 'sodium chloride 0.9%', 'nicardipine iv', 'ondansetron' ) AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*)>0 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10039997 ) AND prescriptions.drug IN ( 'sodium chloride 0.9%', 'nicardipine iv', 'ondansetron' ) AND strftime('%Y',prescriptions.starttime) = '2100'"
86741d2d640a5dbbfa5d1036,Can you tell me the last thyroid stimulating hormone value of patient 10010471 in 05/this year?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10010471 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'thyroid stimulating hormone' ) AND datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',labevents.charttime) = '05' ORDER BY labevents.charttime DESC LIMIT 1","SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10010471 ) AND lab_results.item = 'thyroid stimulating hormone' AND datetime(lab_results.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',lab_results.charttime) = '05' ORDER BY lab_results.charttime DESC LIMIT 1"
9aab7dbbef98a04db8de27da,"How much does the calcium, total lab test typically cost?","SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'labevents' AND cost.event_id IN ( SELECT labevents.row_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'calcium, total' ) )","SELECT DISTINCT cost FROM lab_cost WHERE lab_test = 'calcium, total'"
be39c5b68e4b0a9b3ed9659c,What age was patient 10013049 during their first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10013049 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT age FROM patients WHERE patients.pid = 10013049 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1
7b95ae7410b397d1e2505afb,"Since 2100, what are the top four most commonly taken specimens for patients in the same hospital encounter after the diagnosis of personal history of malignant neoplasm of other gastrointestinal tract?","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of other gastrointestinal tract' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime, admissions.hadm_id FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM diagnoses_icd WHERE icd_code = ( SELECT icd_code FROM diagnoses_icd WHERE long_title = 'personal history of malignant neoplasm of other gastrointestinal tract' ) ) AS T1 JOIN ( SELECT * FROM procedures_icd WHERE year >= 2100 ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.charttime AND T1.encounter_id = T2.encounter_id GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4"
470efb33e7b9dd7a698151cf,How many patients stayed in the discharge lounge as a transfer care unit this year?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT transfers.hadm_id FROM transfers WHERE transfers.careunit = 'discharge lounge' AND datetime(transfers.intime,'start of year') = datetime(current_time,'start of year','-0 year') )","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.careunit = 'discharge lounge' AND datetime(admissions.admittime,'start of year') = datetime(current_time,'start of year','-0 year')"
45b34eeae5d3c8d44b703194,How much docusate sodium (liquid) dose has been prescribed to patient 10007818 on the first hospital encounter?,SELECT SUM(prescriptions.dose_val_rx) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND prescriptions.drug = 'docusate sodium (liquid)',SELECT SUM(drug_doses.value) FROM drug_doses WHERE drug_doses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10007818 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND drug_doses.drug = 'docusate sodium (liquid)'
8a2c412e28bd7e4d00a2c261,What number of hours have passed since patient 10021487 first received a ntprobnp lab test during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'ntprobnp' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) ORDER BY labevents.charttime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', labevents.charttime) ) FROM labevents WHERE labevents.itemid IN ( SELECT itemid FROM d_icditems WHERE d_icditems.long_title = 'ntprobnp' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.hadm_id IN ( SELECT events.hadm_id FROM events WHERE events.event_type = 'admission' AND events.dischtime IS NULL ) ) AND admissions.dischtime IS NULL ) AND admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT itemid FROM d_icditems WHERE d_icditems.long_title = 'ntprobnp' ) ) AND admissions.dischtime IS NULL ) ) ORDER BY labevents.charttime ASC LIMIT 1"
679e9fb3a5f25dcf1ce8aa3c,Could you show me the top four most frequent outputs?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT T1.itemid FROM ( SELECT outputevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM outputevents GROUP BY outputevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT d_icd_procedures.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd ) GROUP BY d_icd_procedures.icd_code ) AS T1 WHERE T1.C1 <= 4 )"
8d027ecd151d527ed8671fee,What are the four most frequently conducted lab tests in 2100?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE strftime('%Y',labevents.charttime) = '2100' GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 4 )","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT d_labitems.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM d_labitems WHERE strftime('%Y',d_labitems.charttime) = '2100' GROUP BY d_labitems.itemid ) AS T1 WHERE T1.C1 <= 4 )"
376ce2f69b8cda44c3960e60,What are the three most commonly administered lab tests?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 3 )","SELECT T1.test_name FROM ( SELECT lab_tests.test_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM lab_tests GROUP BY lab_tests.test_name ) AS T1 WHERE T1.C1 <= 3"
8706d212667c3018e03000a7,Is the value of mean blood pressure of patient 10031757 second measured on the first ICU visit greater than it is first measured on the first ICU visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) > ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT mean_bp FROM patient10031757_icu1 WHERE ord = 2 ) > ( SELECT mean_bp FROM patient10031757_icu1 WHERE ord = 1 )
e2e9e3d582524db3f2e7d55a,Tell me the name of the drug that was first prescribed to patient 10005817 during the last hospital visit via nu route?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005817 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) AND prescriptions.route = 'nu' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = ( SELECT MIN(visits.age) FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT MIN(procedures.age) FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL AND admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.age = ( SELECT MIN(procedures.age) FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT MIN(admissions.age) FROM admissions WHERE admissions.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.route = 'nu' ) ) ) ) ) ) ) ) ) ) ) ) ) ORDER BY prescriptions.starttime ASC LIMIT 1
73a44b74d4ae03e85322ee51,What does fusion or refusion of 2-3 vertebrae cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'procedures_icd' AND cost.event_id IN ( SELECT procedures_icd.row_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'fusion or refusion of 2-3 vertebrae' ) ),SELECT DISTINCT cost FROM procedure_cost WHERE procedure_cost.procedure = 'fusion or refusion of 2-3 vertebrae'
44ba2f356939ab27e43cbc9a,When was patient 10000032 first given a creatinine test in 05/2100?,"SELECT labevents.charttime FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'creatinine' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10000032 ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10000032 ) AND labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'creatinine' ) AND strftime('%Y-%m',labevents.charttime) = '2100-05' ORDER BY labevents.charttime ASC LIMIT 1"
c731547cf5d2fc4a71b9d129,How many days ago was the last time patient 10018081 was diagnosed with other and unspecified hyperlipidemia in their current hospital visit?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses_icd.charttime) ) FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) ORDER BY diagnoses_icd.charttime DESC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', diagnoses.diagnoses_charttime) ) FROM diagnoses WHERE diagnoses.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures.hadm_id FROM procedures WHERE procedures.hadm_id IN ( SELECT diagnoses.hadm_id FROM diagnoses WHERE diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'other and unspecified hyperlipidemia' ) AND diagnoses.hadm_id = 10018081 ) ) AND admissions.dischtime IS NULL ) ) AND diagnoses.icd_code = ( SELECT icd_code FROM icd WHERE icd.long_title = 'other and unspecified hyperlipidemia' ) ORDER BY diagnoses.diagnoses_charttime DESC LIMIT 1"
8777f5505af432365af01179,What is patient 10029291's difference in weight from the second value measured on the first hospital visit compared to the first value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 OFFSET 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10029291 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT weight FROM patient_weight WHERE patient_id = 10029291 AND hospital_visit_id IN ( SELECT hospital_visit_id FROM hospital_visits WHERE patient_id = 10029291 AND discharge_time IS NOT NULL ORDER BY admission_time ASC LIMIT 1 ) ORDER BY taken_time ASC LIMIT 1 OFFSET 1 ) - ( SELECT weight FROM patient_weight WHERE patient_id = 10029291 AND hospital_visit_id IN ( SELECT hospital_visit_id FROM hospital_visits WHERE patient_id = 10029291 AND discharge_time IS NOT NULL ORDER BY admission_time ASC LIMIT 1 ) ORDER BY taken_time ASC LIMIT 1 )
1eff45de74ada2d6145da372,Has any laboratory test been performed on patient 10004733 this month?,"SELECT COUNT(*)>0 FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004733 ) AND datetime(labevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')","SELECT COUNT(*)>0 FROM laboratoryevents WHERE laboratoryevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004733 ) AND datetime(laboratoryevents.charttime,'start of month') = datetime(current_time,'start of month','-0 month')"
d0be97adb482380a1a57585d,How many times patient 10027602 have a foley output recorded on 12/05/this year?,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027602 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'foley' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-05'","SELECT COUNT(*) FROM foley WHERE foley.patient_id = 10027602 AND datetime(foley.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',foley.charttime) = '12-05'"
8e98cbdccd57c7ac55a6c6a1,How many patients received albuterol inhaler in the same month after the confirmation of toxic encephalopathy?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'toxic encephalopathy' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE prescriptions.drug = 'albuterol inhaler' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of month') = datetime(T2.starttime,'start of month')","SELECT COUNT( DISTINCT T1.patient_id ) FROM ( SELECT patient_id, strftime('%Y-%m',toxic_encephalopathy_diagnosis.charttime) FROM ( SELECT patient_id, diagnosis.charttime FROM diagnosis WHERE diagnosis.long_title = 'toxic encephalopathy' ) AS toxic_encephalopathy_diagnosis ) AS T1 JOIN ( SELECT patient_id, strftime('%Y-%m',medication_administration.charttime) FROM medication_administration WHERE medication_administration.itemid IN ( SELECT itemid FROM chartitems WHERE chartitems.label = 'albuterol inhaler' ) ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month')"
3e69022ac78531ddbbfd8b99,"Has patient 10016742 had any introduction of nutritional substance into lower gi, via natural or artificial opening treatment since 2100?","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'introduction of nutritional substance into lower gi, via natural or artificial opening' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10016742 ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*)>0 FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = '0d0f3c7f-0c8c-4b2b-9b0b-0f0a0d0d0d0d' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10016742 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND strftime('%Y',procedures_icd.charttime) >= '2100'"
0bc89b236b722c5eb64dffa8,"What is the maximum total hospital cost, which includes the procedure named insertion of catheter into spinal canal for infusion of therapeutic or palliative substances?",SELECT MAX(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MAX(T1.C1) FROM ( SELECT SUM( hospital_charges.cost ) AS C1 FROM hospital_charges WHERE hospital_charges.hospital_visit_id IN ( SELECT procedures.hospital_visit_id FROM procedures WHERE procedures.procedure_name = 'insertion of catheter into spinal canal for infusion of therapeutic or palliative substances' ) GROUP BY hospital_charges.hospital_visit_id ) AS T1
5d95e49bfd6d7191297dda3e,How many patients with ventricular tachycardia were there?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'ventricular tachycardia' ) ),SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'ventricular tachycardia' )
ffbb740b9da08e9805048c7f,What was patient 10014729's insurance plan on the last hospital encounter?,SELECT admissions.insurance FROM admissions WHERE admissions.subject_id = 10014729 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1,SELECT DISTINCT insurance_plan FROM insurance WHERE insurance.patient_id = 10014729 AND insurance.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 )
137af49a158f5739eb59024e,What is the 3-month survival probability for patients living with a asymptomatic human immunodeficiency virus [hiv] infection status diagnosis?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'asymptomatic human immunodeficiency virus [hiv] infection status' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT T2.C1, DENSE_RANK() OVER ( ORDER BY T2.C2 ASC ) AS C3 FROM ( SELECT T1.C1, AVG(C1) AS C2 FROM ( SELECT T1.C1, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.time) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT patients.row_id, diagnoses.icd_code, diagnoses.charttime AS time FROM diagnoses JOIN patients ON diagnoses.hadm_id = patients.hadm_id WHERE diagnoses.icd_code = ( SELECT T1.icd_code FROM ( SELECT icd_code, ROW_NUMBER() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses GROUP BY icd_code ) AS T1 WHERE T1.C1 <= 5 ) ) AS T1 JOIN patients ON T1.row_id = patients.row_id ) AS T1 GROUP BY T1.C1 ) AS T2 ) AS T1 WHERE T1.C1 = ( SELECT T2.C1 FROM ( SELECT T1.C1, DENSE_RANK() OVER ( ORDER BY T1.C2 ASC ) AS C3 FROM ( SELECT T1.C1,"
3508fba9387d18248281be4e,Was patient 10014078 diagnosed with a disease during their last hospital encounter?,SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014078 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ),SELECT COUNT(*)>0 FROM diagnoses_icd WHERE diagnoses_icd.hadm_id IN ( SELECT encounters.hadm_id FROM encounters WHERE encounters.age = ( SELECT encounters.age FROM encounters WHERE encounters.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = 'other' AND diagnoses_icd.charttime IS NOT NULL ) AND encounters.dischtime IS NOT NULL ORDER BY encounters.admittime DESC LIMIT 1 ) )
b1b111763ce05423f194b8d8,"What is the minimum total cost of a hospital that runs total protein, urine laboratory tests since 1 year ago?","SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT labevents.hadm_id FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'total protein, urine' ) ) AND datetime(cost.chargetime) >= datetime(current_time,'-1 year') GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM( hospital_cost_table.cost ) AS C1 FROM hospital_cost_table WHERE hospital_cost_table.event_type = 'total protein, urine' AND datetime(hospital_cost_table.charttime) >= datetime(current_time,'-1 year') GROUP BY hospital_cost_table.hadm_id ) AS T1"
3c063dda3762046fb6f125fe,Get me the top four most frequently tested specimens that patients took in the same month after being diagnosed with pleural effusion in other conditions classified elsewhere.,"SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'pleural effusion in other conditions classified elsewhere' ) ) AS T1 JOIN ( SELECT admissions.subject_id, microbiologyevents.spec_type_desc, microbiologyevents.charttime FROM microbiologyevents JOIN admissions ON microbiologyevents.hadm_id = admissions.hadm_id ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.spec_type_desc ) AS T3 WHERE T3.C1 <= 4","SELECT T3.spec_type_desc FROM ( SELECT T2.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM ( SELECT T1.charttime, T1.hadm_id FROM ( SELECT * FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.long_title = 'pleural effusion in other conditions classified elsewhere' ) ) AS T1 JOIN ( SELECT * FROM patients ) AS T2 ON T1.hadm_id = T2.hadm_id ) AS T3 JOIN ( SELECT * FROM ( SELECT T1.charttime, T1.hadm_id FROM ( SELECT * FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT diagnoses_icd.icd_code FROM diagnoses_icd WHERE diagnoses_icd.long_title = 'pleural effusion in other conditions classified elsewhere' ) ) AS T1 JOIN ( SELECT * FROM patients ) AS T2 ON T1.hadm_id = T2.hadm_id ) AS T4 ON T3.hadm_id = T4.hadm_id WHERE T3.charttime > T4.charttime AND datetime(T3.charttime,'start of month') = datetime(T4.chart"
f970e95c531ff8f40c37fadc,How many patients in 2100 received coronary arteriography using two catheters after the single internal mammary-coronary artery bypass procedure within the same hospital visit?,"SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'single internal mammary-coronary artery bypass' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.charttime, admissions.hadm_id FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'coronary arteriography using two catheters' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND T1.hadm_id = T2.hadm_id","SELECT COUNT( DISTINCT T1.subject_id ) FROM ( SELECT T1.subject_id, T1.starttime FROM ( SELECT subject_id, procedure_starttime AS starttime FROM procedures_icd WHERE icd_code = '0c1c0z0z' AND strftime('%Y',procedure_starttime) = '2100' ) AS T1 JOIN ( SELECT subject_id, procedure_starttime AS starttime FROM procedures_icd WHERE icd_code = '00c0j0zz' AND strftime('%Y',procedure_starttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.starttime < T2.starttime AND datetime(T1.starttime,'start of visit') = datetime(T2.starttime,'start of visit') )"
76a3b26583f61cc00377b6a2,Count the medications that patient 10004720 was prescribed since 04/2100.,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.hadm_id IN( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004720 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-04'"
ef5e50d5ccd02aaa3b7e4873,What percentile is a magnesium value of 2.0 among patients of the same age as patient 10037975 on their first hospital visit?,"SELECT DISTINCT T1.C1 FROM ( SELECT labevents.valuenum, PERCENT_RANK() OVER ( ORDER BY labevents.valuenum ) AS C1 FROM labevents WHERE labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'magnesium' ) AND labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10037975 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AS T1 WHERE T1.valuenum = 2.0","SELECT DISTINCT T1.C1 FROM ( SELECT T2.C1, PERCENT_RANK() OVER ( ORDER BY T2.C1 ) AS C2 FROM ( SELECT V1.V1, V1.V2 FROM ( SELECT P1.V1, P1.V2, DENSE_RANK() OVER ( ORDER BY P1.V1 ) AS C1 FROM ( SELECT O1.O1, O1.O2 FROM ( SELECT E1.E1, E1.E2 FROM ( SELECT A1.A1, A1.A2 FROM ( SELECT S1.S1, S1.S2 FROM ( SELECT C1.C1, C1.C2 FROM ( SELECT U1.U1, U1.U2 FROM ( SELECT T1.T1, T1.T2 FROM ( SELECT R1.R1, R1.R2 FROM ( SELECT Q1.Q1, Q1.Q2 FROM ( SELECT E1.E1, E1.E2 FROM ( SELECT A1.A1, A1.A2 FROM ( SELECT S1.S1, S1.S2 FROM ( SELECT C1.C1, C1.C2 FROM ( SELECT U1.U1, U1.U2 FROM ( SELECT T1.T1, T1.T2 FROM ( SELECT R1"
dbe56779e1a5f940e7fde7f8,Keep count of how many times patient 10020944 outputted oral gastric on 03/12/this year.,"SELECT COUNT(*) FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020944 ) ) AND outputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'oral gastric' AND d_items.linksto = 'outputevents' ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '03-12'","SELECT COUNT(*) FROM output WHERE output.patient_id = 10020944 AND output.item = 'oral gastric' AND datetime(output.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',output.charttime) = '03-12'"
debd4fb35717b39a57ee2bec,Tell me the diagnosis cost of unspecified essential hypertension in a patient?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'unspecified essential hypertension' ) ),SELECT DISTINCT T1.C1 FROM ( SELECT SUM( DRGCosts.cost ) AS C1 FROM DRGCosts WHERE DRGCosts.drg = ( SELECT DRGCosts.drg FROM DRGCosts WHERE DRGCosts.description = 'unspecified essential hypertension' ) GROUP BY DRGCosts.patient_id ) AS T1
16b479cf35ef4b2c6a5488a1,What is the total amount of kcl (bolus) input that patient 10020187 got since 02/02/2100?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020187 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'kcl (bolus)' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-02-02'",SELECT SUM(inputamount) FROM inputevents WHERE inputevents.stdt >= '2100-02-02' AND inputevents.itemid IN ( SELECT itemid FROM d_icditems WHERE d_icditems.long_title = 'kcl (bolus)' AND d_icditems.icd_code = '10020187' )
ef2b6d1260dfe06ef2737e79,What is the 3-month survival rate for patients diagnosed with history of falling?,"SELECT AVG(C1) FROM ( SELECT ( CASE WHEN (strftime('%J',patients.dod) - strftime('%J',T1.charttime)) < 1 * 365/4 THEN 0 ELSE 1 END ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'history of falling' ) AND strftime('%J',current_time) - strftime('%J',diagnoses_icd.charttime) >= 1 * 365/4 GROUP BY admissions.subject_id HAVING MIN(diagnoses_icd.charttime) = diagnoses_icd.charttime ) AS T1 JOIN patients ON T1.subject_id = patients.subject_id )","SELECT DISTINCT T1.C1 FROM ( SELECT T2.C1, DENSE_RANK() OVER ( ORDER BY T2.C2 ASC ) AS C3 FROM ( SELECT T1.C1, AVG(C1) AS C2 FROM ( SELECT T1.C1, ( CASE WHEN strftime('%J',patients.dod) - strftime('%J',T1.charttime) < 1 * 365/4 THEN 0 ELSE 1 END ) as C1 FROM ( SELECT patients.row_id, diagnoses.charttime FROM diagnoses JOIN patients ON diagnoses.hadm_id = patients.hadm_id WHERE diagnoses.long_title = 'history of falling' ) AS T1 JOIN patients ON T1.row_id = patients.row_id GROUP BY T1.C1 ) AS T1 GROUP BY T1.C1 ) AS T2 ) AS T1 WHERE T1.C3 <= 3"
78e5fca5ff0661c021019cac,What medication was patient 10009049 prescribed two times since 05/2100?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10009049 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-05' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 = 2","SELECT T1.drug FROM ( SELECT drug, COUNT(*) AS C1 FROM ( SELECT drug, strftime('%Y-%m',presc_datetime) AS T1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10009049 ) AND strftime('%Y-%m',presc_datetime) >= '2100-05' ) GROUP BY drug, T1 ) AS T1 WHERE T1.C1 = 2"
aacbdaf47632d34594693d85,What was the name of the drug patient 10037861 was given within the same day after receiving right heart cardiac catheterization since 08/2100?,"SELECT T2.drug FROM ( SELECT procedures_icd.charttime, procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'right heart cardiac catheterization' ) AND procedures_icd.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',procedures_icd.charttime) >= '2100-08' ) AS T1 JOIN ( SELECT prescriptions.drug, prescriptions.starttime, prescriptions.hadm_id FROM prescriptions WHERE prescriptions.hadm_id IN (SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10037861 ) AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.hadm_id = T2.hadm_id WHERE T1.charttime < T2.starttime AND datetime(T1.charttime,'start of day') = datetime(T2.starttime,'start of day')","SELECT T2.drug FROM ( SELECT proceduretime, tid FROM procedures WHERE procedures.hadm_id = 10037861 AND procedures.label = 'right heart cardiac catheterization' AND strftime('%Y-%m',proceduretime) >= '2100-08' ) AS T1 JOIN ( SELECT drug, starttime, tid FROM prescriptions WHERE prescriptions.hadm_id = 10037861 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-08' ) AS T2 ON T1.tid = T2.tid WHERE T1.proceduretime < T2.starttime AND datetime(T1.proceduretime,'start of day') = datetime(T2.starttime,'start of day')"
1cbdcc09109e4edff4bdc980,What are the top three most commonly prescribed medicines in this year?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT * FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T GROUP BY drug ) AS T1 WHERE T1.C1 <= 3"
78b96d788febbe223bbeb490,What are the five commonly ordered medications for patients aged 50s?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 50 AND 59 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 5","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT drug, age FROM ( SELECT drug, age FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT drug, ord FROM ( SELECT"
2143a6938a83abd7a5830ec5,When was the first time patient 10006580 had a maximum of platelet count on the first hospital stay?,"SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'platelet count' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1","SELECT labevents.charttime FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10006580 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) AND labevents.itemid IN ( SELECT procedures_icd.itemid FROM procedures_icd WHERE procedures_icd.long_title = 'platelet count' ) ORDER BY labevents.valuenum DESC, labevents.charttime ASC LIMIT 1"
224bb4d0211cbc31df5ac6e5,"Count the number of patients who had their closed reduction of fracture with internal fixation, femur performed.","SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'closed reduction of fracture with internal fixation, femur' ) )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT procedures.pid FROM procedures WHERE procedures.label = 'closed reduction of fracture with internal fixation, femur' )"
13cdf52f7ef4abd4ac2134e8,Retrieve the top three most frequently prescribed drugs throughout this year.,"SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 3","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT drug, strftime('%Y',prescriptions.starttime) AS Y, strftime('%m',prescriptions.starttime) AS M FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) = strftime('%Y',current_time) GROUP BY drug, Y, M ) AS T GROUP BY drug ) AS T1 WHERE T1.C1 <= 3"
0b519b394a591392e5d6f8e3,"Today, when was the first time that patient 10018081 had the minimum SaO2?","SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'o2 saturation pulseoxymetry' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of day') = datetime(current_time,'start of day','-0 day') ORDER BY chartevents.valuenum ASC, chartevents.charttime ASC LIMIT 1","SELECT o1.charttime FROM ( SELECT o.charttime, o.valuenum FROM ( SELECT d.valuenum, d.charttime FROM ( SELECT MIN(o2.valuenum) AS C1 FROM ( SELECT o3.valuenum FROM ( SELECT o2.valuenum FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ( SELECT o.valuenum, o.charttime FROM ("
864335edd9d15c7c2203cf7f,What was patient 10020740's age on the first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT DISTINCT age FROM patients WHERE patients.age IS NOT NULL AND patients.hadm_id IN ( SELECT hadm_id FROM hospital_visits WHERE hospital_visits.age IS NOT NULL AND hospital_visits.hadm_id IN ( SELECT hadm_id FROM patients WHERE patients.id = 10020740 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1 ) ) ORDER BY patients.age ASC LIMIT 1
52132e5911d6dc1ae05dcf5a,When was the first continuous invasive mechanical ventilation for less than 96 consecutive hours done for patient 10027445 since 2100?,"SELECT procedures_icd.charttime FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'continuous invasive mechanical ventilation for less than 96 consecutive hours' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime ASC LIMIT 1","SELECT procedures.starttime FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10027445 ) AND procedures.label = 'continuous invasive mechanical ventilation' AND datetime(procedures.starttime,'start of year') >= datetime(current_time,'start of year','-0 year') AND strftime('%J',procedures.starttime) < 96 ORDER BY procedures.starttime ASC LIMIT 1"
230ffeaf99bdda6a8e74e380,What was the average mean blood pressure on 03/07/this year for patient 10014729?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10014729 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure mean' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',chartevents.charttime) = '03-07'","SELECT AVG(mean_bp) FROM arterialbloodpressure WHERE arterialbloodpressure.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10014729 ) AND datetime(arterialbloodpressure.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',arterialbloodpressure.charttime) = '03-07'"
da43f657cbfc7f62319205b6,How many current patients belong to the 40s age category?,SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.dischtime IS NULL AND admissions.age BETWEEN 40 AND 49,SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.age BETWEEN 40 AND 49 AND patients.dischtime IS NULL
290c69f642635c781b5c7611,"For patients who were given other endovascular procedures on other vessels in 2100, what are the top four most frequent procedures that followed within 2 months?","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures_icd.icd_code, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',procedures_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )","SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures.charttime FROM procedures JOIN admissions ON procedures.subject_id = admissions.subject_id WHERE procedures.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'other endovascular procedures on other vessels' ) AND strftime('%Y',procedures.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, procedures.icd_code, procedures.charttime FROM procedures JOIN admissions ON procedures.subject_id = admissions.subject_id WHERE strftime('%Y',procedures.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T2.charttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 4 )"
44b322551dc60863f32aa258,What was the last procedure patient 10019385 had since 2100?,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT procedures_icd.icd_code FROM procedures_icd WHERE procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019385 ) AND strftime('%Y',procedures_icd.charttime) >= '2100' ORDER BY procedures_icd.charttime DESC LIMIT 1 )","SELECT procedures.name FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019385 ) AND strftime('%Y',procedures.charttime) >= '2100' ORDER BY procedures.charttime DESC LIMIT 1"
e19b3138fb3b80c47b5d5688,Has patient 10022041 been admitted to an emergency room?,SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10022041 AND admissions.admission_location = 'emergency room',SELECT COUNT(*)>0 FROM emergency_room_visits WHERE emergency_room_visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10022041 )
7eab95f496de2df04e1d2b80,Could you show me the top four most common diagnoses?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T1.icd_code FROM ( SELECT diagnoses_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnoses_icd GROUP BY diagnoses_icd.icd_code ) AS T1 WHERE T1.C1 <= 4 )","SELECT d.diagnosis_desc FROM diagnosis d WHERE d.charttime IN ( SELECT T1.charttime FROM ( SELECT diagnosis.charttime, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM diagnosis GROUP BY diagnosis.charttime ) AS T1 WHERE T1.C1 <= 4 )"
7a4a371e40e613a250b099d0,How much total input did patient 10021487 receive on 12/19/this year?,"SELECT SUM(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(inputevents.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',inputevents.starttime) = '12-19'","SELECT SUM(input.totalamount) FROM input WHERE input.stay_id IN ( SELECT stay.stay_id FROM stay WHERE stay.hadm_id IN ( SELECT hadm.hadm_id FROM hadm WHERE hadm.subject_id = 10021487 ) ) AND datetime(input.starttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',input.starttime) = '12-19'"
a2de199eb11275f923c798c8,Can you tell me the first medicine that was prescribed to patient 10007795?,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10007795 ) ORDER BY prescriptions.starttime ASC LIMIT 1,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10007795 ) AND strftime('%Y',prescriptions.starttime) = '2100' ORDER BY prescriptions.starttime ASC LIMIT 1"
7eeda0d4bfae5ffe07de0b9b,How many hours has it been since the first time patient 10018081 stayed in the careunit emergency department on the current hospital encounter?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', transfers.intime) ) FROM transfers WHERE transfers.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 AND admissions.dischtime IS NULL ) AND transfers.careunit = 'emergency department' ORDER BY transfers.intime ASC LIMIT 1","SELECT 24 * ( strftime('%J',current_time) - strftime('%J', events.starttime) ) FROM events WHERE events.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 AND admissions.dischtime IS NULL ) AND events.event_type = 'admission' AND events.event_location = 'emergency department' ORDER BY events.starttime ASC LIMIT 1"
785297f1fb8d773e4c4a07e2,Could you tell me the marital status of patient 10012853 on their first hospital visit?,SELECT admissions.marital_status FROM admissions WHERE admissions.subject_id = 10012853 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT marital_status FROM patients WHERE patients.id = 10012853 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1
d8eb075e768231338b08ef56,Has patient 10027445 had any results of his or her mrsa screen microbiology tests in 09/this year?,"SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '09'","SELECT COUNT(*)>0 FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.subject_id = 10027445 ) AND microbiologyevents.spec_type_desc = 'mrsa screen' AND datetime(microbiologyevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m',microbiologyevents.charttime) = '09'"
3f83bca7c25ce27ab09a7ef0,What is the difference between weights on patient 10003046 last measured on the last hospital visit compared to the value first measured on the last hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10003046 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1 ),SELECT ( SELECT weight.valuenum FROM patient_weight AS weight WHERE weight.hadm_id IN ( SELECT hadm_id FROM hospital_visits WHERE patient_id = 10003046 AND visits = 'last' ) ORDER BY weight.charttime DESC LIMIT 1 ) - ( SELECT weight.valuenum FROM patient_weight AS weight WHERE weight.hadm_id IN ( SELECT hadm_id FROM hospital_visits WHERE patient_id = 10003046 AND visits = 'last' ) ORDER BY weight.charttime ASC LIMIT 1 )
666e67f82411b8a3b4b429e7,Has patient 10005909 been to the e.r. in 2100?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.admission_location = 'emergency room' AND strftime('%Y',admissions.admittime) = '2100'","SELECT COUNT(*)>0 FROM emergency_department_visits WHERE emergency_department_visits.hadm_id IN ( SELECT patients.hadm_id FROM patients WHERE patients.subject_id = 10005909 ) AND strftime('%Y',emergency_department_visits.admittime) = '2100'"
6336898e3861f505fd6e2a25,How many days have there been since patient 10039831's admission to the hospital?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10039831 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT admissiontime FROM admissions WHERE admissions.pid = 10039831 AND admissions.dischtime IS NULL ) ) )"
3de8ef9d5ffcc52173897ea8,What was the first recorded height for patient 10020740 during their first hospital encounter?,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1,SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT visits.stay_id FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'daily weight' AND items.linksto = 'chartevents' ) ORDER BY chartevents.charttime ASC LIMIT 1
e6fc873eaca2527956432aa0,How many people were admitted to the hospital since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE strftime('%Y',admissions.admittime) >= '2100'","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE strftime('%Y',admissions.admittime) >= '2100'"
fb17ccd962fb6994c5822d11,How many tamoxifen citrate prescriptions were ordered in this year?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'tamoxifen citrate' AND datetime(prescriptions.starttime,'start of year') = datetime(current_time,'start of year','-0 year')"
0a6429bfa48cdb76d66bf9a6,How many days has it been since patient 10021487's hospital admission?,"SELECT 1 * ( strftime('%J',current_time) - strftime('%J', admissions.admittime) ) FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT hospital_admission_table.admittime FROM hospital_admission_table WHERE hospital_admission_table.hadm_id IN ( SELECT observation_table.hadm_id FROM observation_table WHERE observation_table.itemid IN ( SELECT chartevents_table.itemid FROM chartevents_table WHERE chartevents_table.hadm_id IN ( SELECT hospital_admission_table.hadm_id FROM hospital_admission_table WHERE hospital_admission_table.pid = 10021487 ) ) ) ) ) )"
15b35d75bfa2fee08c48a6c6,When was the first time since 114 days ago that patient 10011398 had the maximum respiratory rate for?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10011398 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-114 day') ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT V1.charttime FROM ( SELECT V2.charttime, DENSE_RANK() OVER ( ORDER BY V2.valuenum DESC ) AS C1 FROM ( SELECT charttime, respiratory_rate FROM patient10011398_vitalevents WHERE datetime >= datetime(current_time,'-114 day') ) AS V2 ) AS V1 WHERE V1.C1 = 1"
01f7d958c0c0cf070ca363b1,Can you list the methods for taking morphine sulfate ir?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate ir',SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'morphine sulfate ir'
a0cc19360d682b011b5a7c9e,What is the total hospital cost for patient 10021118's stay since 2100?,"SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) AND strftime('%Y',cost.chargetime) >= '2100'","SELECT SUM( hospital_charges.chart_charges ) FROM hospital_charges WHERE hospital_charges.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021118 ) AND strftime('%Y',hospital_charges.charttime) >= '2100'"
ec24c1254363c0ed83ac0fa9,How much does the cost of a other and unspecified escherichia coli [e. coli] diagnosis cost?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'diagnoses_icd' AND cost.event_id IN ( SELECT diagnoses_icd.row_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'other and unspecified escherichia coli [e. coli]' ) ),SELECT DISTINCT T1.C1 FROM ( SELECT SUM( CHARGE ) AS C1 FROM CHARGES WHERE CHARGES.STD_CHRG_DESC = 'other and unspecified escherichia coli [e. coli] diagnosis' ) AS T1
6968bd319470944ced5ca337,What is the cost of a medication named ibuprofen?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'ibuprofen' ),SELECT DISTINCT cost FROM drug_cost WHERE drug_name = 'ibuprofen'
d1d8f2df3141cf92ddc53228,How many prednisone prescription cases were there in 2100?,"SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prednisone' AND strftime('%Y',prescriptions.starttime) = '2100'","SELECT COUNT(*) FROM prescriptions WHERE prescriptions.drug = 'prednisone' AND strftime('%Y',prescriptions.starttime) = '2100'"
6ac4cfa978f125a71ca0e9b0,How much phenazopyridine was last prescribed since 10/2100 to patient 10005909?,"SELECT prescriptions.dose_val_rx FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) AND prescriptions.drug = 'phenazopyridine' AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1","SELECT phenazopyridine_dose FROM prescriptions WHERE phenazopyridine_dose IS NOT NULL AND prescriptions.patient_id = 10005909 AND strftime('%Y-%m',prescriptions.starttime) >= '2100-10' ORDER BY prescriptions.starttime DESC LIMIT 1"
1d433e5813c63b26ef517551,What was the last glucose lab test result for patient 10022880 in 03/2100?,"SELECT labevents.valuenum FROM labevents WHERE labevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10022880 ) AND labevents.itemid IN ( SELECT d_labitems.itemid FROM d_labitems WHERE d_labitems.label = 'glucose' ) AND strftime('%Y-%m',labevents.charttime) = '2100-03' ORDER BY labevents.charttime DESC LIMIT 1","SELECT lab_results.valuenum FROM lab_results WHERE lab_results.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10022880 ) AND lab_results.item = 'glucose' AND strftime('%Y-%m',lab_results.charttime) = '2100-03' ORDER BY lab_results.charttime DESC LIMIT 1"
54b62111b52beeb031b293c2,What new medicines were prescribed to patient 10018081 today compared to those yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018081 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')"
bd928ffb40c6b3f69d82f2da,What was the last height record for patient 10019777 since 01/2100?,"SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10019777 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'height (cm)' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT visits.stay_id FROM visits WHERE visits.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10019777 ) ) AND chartevents.itemid IN ( SELECT items.itemid FROM items WHERE items.label = 'daily weight' AND items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-01' ORDER BY chartevents.charttime DESC LIMIT 1"
e208ae3d19686c1132fb4168,How many patients died during the same hospital encounter after having been diagnosed in 2100 with varices of other sites?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'varices of other sites' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND strftime('%Y',T1.charttime) = '2100' ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND strftime('%Y',patients.dod) = '2100' ) as T3 ON T2.subject_id = T3.subject_id WHERE T2.hadm_id = T3.hadm_id","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.encounter_id FROM ( SELECT pid, encounter_id FROM diagnoses WHERE diagnoses.long_title = 'varices of other sites' AND strftime('%Y',diagnoses.charttime) = '2100' ) AS T1 JOIN ( SELECT pid, encounter_id FROM ( SELECT pid, encounter_id FROM procedures WHERE procedures.long_title = 'other' AND strftime('%Y',procedures.charttime) = '2100' ) AS T2 JOIN ( SELECT pid, encounter_id FROM ( SELECT pid, encounter_id FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) = '2100' ) AS T3 ON T2.pid = T3.pid WHERE T2.encounter_id = T3.encounter_id ) ON T1.pid = T2.pid WHERE T1.encounter_id = T2.encounter_id ) ON T1.pid = T3.pid WHERE T1.encounter_id = T3.encounter_id ) AS T4 JOIN ( SELECT pid, encounter_id FROM ( SELECT pid, encounter_id FROM procedures WHERE procedures.long_title = 'other' AND strftime('%Y',procedures.charttime) = '2100' ) AS T5 JOIN ( SELECT pid,"
21fd9dd9363c6aebcc42bdb9,What was the last output that patient 10021487 has had on 12/10/this year?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND datetime(outputevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',outputevents.charttime) = '12-10' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT output.output FROM output WHERE output.sta_id IN ( SELECT procedures.sta_id FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) ) AND datetime(output.charttime,'start of year') = datetime(current_time,'start of year','-0 year') AND strftime('%m-%d',output.charttime) = '12-10' ORDER BY output.charttime DESC LIMIT 1"
df207c83b6a4bbaeca1edcf9,What were the top five most common diagnoses that followed within the same month to patients who had received extracorporeal circulation auxiliary to open heart surgery in 2100?,"SELECT d_icd_diagnoses.long_title FROM d_icd_diagnoses WHERE d_icd_diagnoses.icd_code IN ( SELECT T3.icd_code FROM ( SELECT T2.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, procedures_icd.charttime FROM procedures_icd JOIN admissions ON procedures_icd.hadm_id = admissions.hadm_id WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'extracorporeal circulation auxiliary to open heart surgery' ) AND strftime('%Y',procedures_icd.charttime) = '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, diagnoses_icd.icd_code, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE strftime('%Y',diagnoses_icd.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.icd_code ) AS T3 WHERE T3.C1 <= 5 )","SELECT d1.long_title FROM d1 WHERE d1.row_id IN ( SELECT T3.c1 FROM ( SELECT T2.c1, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C2 FROM ( SELECT p1.subject_id, pr1.charttime FROM procedures_icd pr1 WHERE pr1.long_title = 'extracorporeal circulation auxiliary to open heart surgery' AND strftime('%Y',pr1.charttime) = '2100' ) AS T1 JOIN ( SELECT p1.subject_id, d1.row_id, d1.long_title, d1.charttime FROM diagnoses_icd d1 WHERE strftime('%Y',d1.charttime) = '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.charttime AND datetime(T1.charttime,'start of month') = datetime(T2.charttime,'start of month') GROUP BY T2.c1 ) AS T3 WHERE T3.C2 <= 5 )"
14d8196b90cb8b401ebd3a91,How long has it been in hours since the first time calcium carbonate was prescribed to patient 10021487 during the current hospital visit?,"SELECT 24 * ( strftime('%J',current_time) - strftime('%J', prescriptions.starttime) ) FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ) AND prescriptions.drug = 'calcium carbonate' ORDER BY prescriptions.starttime ASC LIMIT 1","SELECT 1 * ( strftime('%J',current_time) - strftime('%J', ( SELECT t1.starttime FROM ( SELECT presc1.starttime FROM ( SELECT presc.starttime, presc.hadm_id FROM prescriptions presc WHERE presc.drug = 'calcium carbonate' AND presc.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id = 10021487 AND admissions.dischtime IS NULL ) ) ) AS presc1 WHERE presc1.hadm_id = 10021487 ) AS t1 ORDER BY t1.starttime ASC LIMIT 1 ) ) ) + ( strftime('%H',current_time) - strftime('%H', ( SELECT t1.starttime FROM ( SELECT presc1.starttime FROM ( SELECT presc.starttime, presc.hadm_id FROM prescriptions presc WHERE presc.drug = 'calcium carbonate' AND presc.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id = 10021487 AND admissions.dischtime IS NULL ) ) ) AS presc1 WHERE presc1.hadm_id = 10021487 ) AS"
ebd6cc5909117f9e521d66c9,What was the first time patient 10018423 had their maximum respiratory rate during their last ICU stay?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018423 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1 ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'respiratory rate' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.valuenum DESC, chartevents.charttime ASC LIMIT 1","SELECT measurements.charttime FROM measurements WHERE measurements.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.age = 10018423 AND visits.dischtime IS NOT NULL ORDER BY visits.admittime DESC LIMIT 1 ) AND measurements.itemid IN ( SELECT d.items FROM d WHERE d.long_title = 'respiratory rate' AND d.linksto = 'measurements' ) ORDER BY measurements.valuenum DESC, measurements.charttime ASC LIMIT 1"
fae84ce9cc96b0e677f844f8,"Since 128 days ago, what was the maximum body temperature for patient 10021118?","SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021118 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'temperature celsius' AND d_items.linksto = 'chartevents' ) AND datetime(chartevents.charttime) >= datetime(current_time,'-128 day')","SELECT MAX(temperature_celsius) FROM temperature_chart WHERE temperature_celsius IS NOT NULL AND strftime('%J',current_time) - strftime('%J',temperature_chart.charttime) >= 128 AND temperature_chart.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021118 )"
49a4cd3cf6fcacac9a3bf922,When was the last time patient 10025612 was measured with a greater diastolic blood pressure than 59.0 since 02/02/2100?,"SELECT chartevents.charttime FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10025612 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'arterial blood pressure diastolic' AND d_items.linksto = 'chartevents' ) AND chartevents.valuenum > 59.0 AND strftime('%Y-%m-%d',chartevents.charttime) >= '2100-02-02' ORDER BY chartevents.charttime DESC LIMIT 1","SELECT blood_pressure.charttime FROM blood_pressure WHERE blood_pressure.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10025612 ) AND blood_pressure.diastolic > 59.0 AND strftime('%Y-%m-%d',blood_pressure.charttime) >= '2100-02-02' ORDER BY blood_pressure.charttime DESC LIMIT 1"
88c772d92cd993b8ce3eb5a9,What was the name of the medication that patient 10004235 was prescribed two or more times?,"SELECT T1.drug FROM ( SELECT prescriptions.drug, COUNT( prescriptions.starttime ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004235 ) GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 >= 2","SELECT T1.drug FROM ( SELECT drug, COUNT(*) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10004235 ) GROUP BY drug ) AS T1 WHERE T1.C1 >= 2"
64d6d6763577abb3e33ea4f0,Tell me the minimum total hospital cost for patient visits that include malignant neoplasm of intrahepatic bile ducts?,SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'malignant neoplasm of intrahepatic bile ducts' ) ) GROUP BY cost.hadm_id ) AS T1,SELECT MIN(T1.C1) FROM ( SELECT SUM( hospital_charges.cost ) AS C1 FROM hospital_charges WHERE hospital_charges.hospital_visit_id IN ( SELECT diagnoses.hospital_visit_id FROM diagnoses WHERE diagnoses.long_title = 'malignant neoplasm of intrahepatic bile ducts' ) GROUP BY hospital_charges.hospital_visit_id ) AS T1
174eb164f7575dec3a790c67,"In 2100, what are the four frequently ordered medications for patients in their 40s?","SELECT T1.drug FROM ( SELECT prescriptions.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age BETWEEN 40 AND 49 ) AND strftime('%Y',prescriptions.starttime) = '2100' GROUP BY prescriptions.drug ) AS T1 WHERE T1.C1 <= 4","SELECT T1.drug FROM ( SELECT drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT drug, age FROM ( SELECT drug, COUNT(*) OVER ( PARTITION BY drug ) AS C1 FROM orders WHERE strftime('%Y',orders.starttime) = '2100' GROUP BY orders.row_id, drug ) AS T1 JOIN ( SELECT row_id, age FROM patients WHERE age BETWEEN 40 AND 49 ) AS T2 ON T1.row_id = T2.row_id ) AS T3 GROUP BY drug ) AS T1 WHERE T1.C1 <= 4"
6375d8b399f74f248505155f,Count the number of times patient 10021487 in the current hospital encounter underwent the thoracentesis procedure.,SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'thoracentesis' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 AND admissions.dischtime IS NULL ),SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = '0.92' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = ( SELECT admissions.age FROM admissions WHERE admissions.hadm_id IN ( SELECT procedures_icd.hadm_id FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT icd_icd.to_icd_code FROM icd_icd WHERE icd_icd.from_icd_code = '0.92' ) AND procedures_icd.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) ) AND admissions.dischtime IS NULL ) )
af561948138efd557fdd722d,Give a list of the four most frequent medications that patients were prescribed during the same hospital encounter after being diagnosed with personal history of colonic polyps since 2100.,"SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'personal history of colonic polyps' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime, admissions.hadm_id FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND T1.hadm_id = T2.hadm_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_time, hospital_id FROM diagnoses WHERE diagnoses.label = 'personal history of colonic polyps' AND strftime('%Y',diagnoses.diagnosis_time) >= '2100' ) AS T1 JOIN ( SELECT patient_id, drug, prescription_time, hospital_id FROM prescriptions WHERE strftime('%Y',prescriptions.starttime) >= '2100' ) AS T2 ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_time < T2.starttime AND T1.hospital_id = T2.hospital_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 4"
17cef57ccf7e9bd3a4e8882c,What label corresponds to motor current (ma) low (r)?,SELECT d_items.label FROM d_items WHERE d_items.abbreviation = 'motor current (ma) low (r)',"SELECT DISTINCT d.label FROM diagnoses d WHERE d.icd_code = ( SELECT t1.icd_code FROM ( SELECT t.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT o.icd_code, o.charttime FROM other o WHERE o.valuenum = 'motor current (ma) low (r)' ) AS t GROUP BY t.icd_code ) AS t1 WHERE t1.C1 <= 3 )"
06b6dc7feba30e1bda1c5617,Could you retrieve patient 10005909's monthly average weight since 09/2100?,"SELECT AVG(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) AND strftime('%Y-%m',chartevents.charttime) >= '2100-09' GROUP BY strftime('%Y-%m',chartevents.charttime)","SELECT AVG(o1.valuenum) FROM ( SELECT t1.valuenum FROM ( SELECT o.valuenum, strftime('%Y-%m',o.charttime) as timekey FROM chartevents o WHERE o.stay_id IN ( SELECT t.stay_id FROM ( SELECT p.id, d.stay_id FROM patients p JOIN d_icd_procedures d ON p.id = d.person_id WHERE p.id = 10005909 ) AS t ) AND o.itemid IN ( SELECT p.itemid FROM procedures_icd p WHERE p.icd_code = ( SELECT d.icd_code FROM d_icd_procedures d WHERE d.label = 'other endovascular procedures on other vessels' ) ) ) AS t1 WHERE strftime('%Y-%m',t1.charttime) >= '2100-09' GROUP BY t1.timekey ) AS o1 GROUP BY o1.timekey"
dc96f1034667710951f67126,Count the number of patients diagnosed with acute pyelonephritis in the previous year.,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'acute pyelonephritis' ) AND datetime(diagnoses_icd.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )","SELECT COUNT( DISTINCT patients.pid ) FROM patients WHERE patients.pid IN ( SELECT diagnoses.pid FROM diagnoses WHERE diagnoses.label = 'acute pyelonephritis' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-1 year') )"
fbbb58618f0b12172d3a2c3f,How much is the difference of weights of patient 10004720 last measured on the first hospital visit compared to the second to last value measured on the first hospital visit?,SELECT ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 ) - ( SELECT chartevents.valuenum FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) ORDER BY chartevents.charttime DESC LIMIT 1 OFFSET 1 ),SELECT ( SELECT weight FROM patient_vitals WHERE patient_id = 10004720 AND hospital_visit_id IN ( SELECT hospital_visit_id FROM hospital_visits WHERE patient_id = 10004720 AND discharge IS NOT NULL ORDER BY admission_time ASC LIMIT 1 ) ORDER BY charttime DESC LIMIT 1 ) - ( SELECT weight FROM patient_vitals WHERE patient_id = 10004720 AND hospital_visit_id IN ( SELECT hospital_visit_id FROM hospital_visits WHERE patient_id = 10004720 AND discharge IS NOT NULL ORDER BY admission_time ASC LIMIT 1 ) ORDER BY charttime DESC LIMIT 1 OFFSET 1 )
9c072625e88dff652ffe5371,Count the number of times that patient 10038933 took dextrose 5% on 09/26/2100.,"SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10038933 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'dextrose 5%' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-09-26'","SELECT COUNT(*) FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10038933 ) AND inputevents.itemid IN ( SELECT chartitems.itemid FROM chartitems WHERE chartitems.label = 'dextrose 5%' AND chartitems.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) = '2100-09-26'"
5436413908d5e902536630e8,What was the name of the specimen test that patient 10018845 was given for the last time in 10/2100?,"SELECT microbiologyevents.spec_type_desc FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10018845 ) AND strftime('%Y-%m',microbiologyevents.charttime) = '2100-10' ORDER BY microbiologyevents.charttime DESC LIMIT 1","SELECT tests.spec_name FROM tests WHERE tests.spec_type IN ( SELECT procedures.spec_type FROM procedures WHERE procedures.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10018845 ) ) AND strftime('%Y-%m',tests.charttime) = '2100-10' ORDER BY tests.charttime DESC LIMIT 1"
554ae2ae8045e12bdcbd48e1,What age was patient 10020740 on the first hospital visit?,SELECT admissions.age FROM admissions WHERE admissions.subject_id = 10020740 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime ASC LIMIT 1,SELECT age FROM patients WHERE patients.pid = 10020740 AND patients.dischtime IS NOT NULL ORDER BY patients.admittime ASC LIMIT 1
d204e30ef557cf80cbde97fe,List the top five most frequent procedures performed during this year.,"SELECT d_icd_procedures.long_title FROM d_icd_procedures WHERE d_icd_procedures.icd_code IN ( SELECT T1.icd_code FROM ( SELECT procedures_icd.icd_code, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedures_icd.icd_code ) AS T1 WHERE T1.C1 <= 5 )","SELECT d1.procedure_name FROM ( SELECT procedure_name, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM procedures_icd WHERE datetime(procedures_icd.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY procedure_name ) AS d1 WHERE d1.C1 <= 5"
c8c043eb89e83c83b6beeeb3,Can you calculate the duration in days of patient 10031757's first stay in the intensive care unit?,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1","SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10031757 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime ASC LIMIT 1"
a6fe0c3e866e450e5a3bcaf0,Can you find the five most frequently ordered laboratory test this year?,"SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT labevents.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM labevents WHERE datetime(labevents.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY labevents.itemid ) AS T1 WHERE T1.C1 <= 5 )","SELECT d_labitems.label FROM d_labitems WHERE d_labitems.itemid IN ( SELECT T1.itemid FROM ( SELECT d_labitems.itemid, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM d_labitems WHERE datetime(d_labitems.charttime,'start of year') = datetime(current_time,'start of year','-0 year') GROUP BY d_labitems.itemid ) AS T1 WHERE T1.C1 <= 5 )"
c1ffcaa8f6eaee005e37aa5d,When did patient 10005909 last undergo a microbiology test on the last hospital encounter?,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1,SELECT microbiologyevents.charttime FROM microbiologyevents WHERE microbiologyevents.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10005909 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ORDER BY microbiologyevents.charttime DESC LIMIT 1
007c6a12f2a1a55bd3b09e1e,How many open and other replacement of aortic valve procedures have occurred since 2100?,"SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = ( SELECT d_icd_procedures.icd_code FROM d_icd_procedures WHERE d_icd_procedures.long_title = 'open and other replacement of aortic valve' ) AND strftime('%Y',procedures_icd.charttime) >= '2100'","SELECT COUNT(*) FROM procedures_icd WHERE procedures_icd.icd_code = '00.66' AND strftime('%Y',procedures_icd.charttime) >= '2100'"
a16e5eeb260d3b031762211d,Tell me the name of the drug that patient 10021487 was first prescribed through the im route.,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1,SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10021487 ) AND prescriptions.route = 'im' ORDER BY prescriptions.starttime ASC LIMIT 1
c387a4c3a7bc1f1536ae7916,Is patient 10031404 male or female?,SELECT patients.gender FROM patients WHERE patients.subject_id = 10031404,SELECT COUNT(*)>0 FROM patients WHERE patients.gender = 'male' AND patients.subject_id = 10031404
4bff1dd96412ee933ce201a2,Find the length in days of the last ICU stay for patient 10006053.,"SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10006053 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1","SELECT strftime('%J', icustays.outtime) - strftime('%J', icustays.intime) FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10006053 ) AND icustays.outtime IS NOT NULL ORDER BY icustays.intime DESC LIMIT 1"
9637bc783f8bbca836af73b7,When did patient 10021487 receive his last input since 12/06/2100?,"SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10021487 ) ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-06' ORDER BY inputevents.starttime DESC LIMIT 1","SELECT inputevents.starttime FROM inputevents WHERE inputevents.stay_id IN ( SELECT admissions.stay_id FROM admissions WHERE admissions.subject_id = 10021487 ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-06' ORDER BY inputevents.starttime DESC LIMIT 1"
68d14f27e5ba3606ce989f0b,What is the cost of a medication known as guaifenesin?,SELECT DISTINCT cost.cost FROM cost WHERE cost.event_type = 'prescriptions' AND cost.event_id IN ( SELECT prescriptions.row_id FROM prescriptions WHERE prescriptions.drug = 'guaifenesin' ),SELECT DISTINCT cost FROM drug_cost WHERE drug_cost.drug = 'guaifenesin'
d1cbc79c8f893b6d1d18523b,What is the minimum total cost of the hospital visits which involve dysthymic disorder since 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'dysthymic disorder' ) ) AND strftime('%Y',cost.chargetime) >= '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM( hospital_visits.cost ) AS C1 FROM hospital_visits WHERE hospital_visits.icd_code = ( SELECT icd_codes.icd_code FROM icd_codes WHERE icd_codes.long_title = 'dysthymic disorder' ) AND strftime('%Y',hospital_visits.admittime) >= '2100' GROUP BY hospital_visits.hadm_id ) AS T1"
6aa28b1f973eb8725565aabc,Can you list the methods for taking methadone?,SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'methadone',SELECT DISTINCT prescriptions.route FROM prescriptions WHERE prescriptions.drug = 'methadone'
4ff852f95fae6d06622555a4,What would be the daily maximum weight of patient 10024043 in their last hospital encounter?,"SELECT MAX(chartevents.valuenum) FROM chartevents WHERE chartevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10024043 AND admissions.dischtime IS NOT NULL ORDER BY admissions.admittime DESC LIMIT 1 ) ) AND chartevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'daily weight' AND d_items.linksto = 'chartevents' ) GROUP BY strftime('%Y-%m-%d',chartevents.charttime)","SELECT MAX(o1.valuenum) FROM ( SELECT o.valuenum, strftime('%Y-%m-%d',o.charttime) as dt FROM chartevents o WHERE o.stay_id IN ( SELECT p.stay_id FROM patients p WHERE p.subject_id = 10024043 AND p.dischtime IS NOT NULL ORDER BY p.admittime DESC LIMIT 1 ) AND o.itemid IN ( SELECT b.itemid FROM d_icditems b WHERE b.long_title = 'daily weight' AND b.icd_code IS NULL ) ) AS o1 GROUP BY o1.dt"
6342a44540e55f3dc3b44fc5,How many patients died after having been diagnosed with facial weakness during the same hospital encounter throughout this year?,"SELECT COUNT( DISTINCT T2.subject_id ) FROM ( SELECT T1.subject_id, T1.charttime, T1.hadm_id FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime, admissions.hadm_id FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'facial weakness' ) ) AS T1 GROUP BY T1.subject_id HAVING MIN(T1.charttime) = T1.charttime AND datetime(T1.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 JOIN ( SELECT patients.subject_id, admissions.hadm_id, patients.dod FROM admissions join patients ON patients.subject_id = admissions.subject_id WHERE patients.dod IS NOT NULL AND datetime(patients.dod,'start of year') = datetime(current_time,'start of year','-0 year') ) as T3 ON T2.subject_id = T3.subject_id WHERE T2.hadm_id = T3.hadm_id","SELECT COUNT( DISTINCT T1.pid ) FROM ( SELECT T1.pid, T1.encounter_id FROM ( SELECT pid, encounter_id FROM diagnoses WHERE diagnoses.label = 'facial weakness' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T1 JOIN ( SELECT pid, encounter_id FROM ( SELECT pid, encounter_id FROM procedures WHERE procedures.label = 'other' AND datetime(procedures.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T2 JOIN ( SELECT pid, encounter_id FROM ( SELECT pid, encounter_id FROM diagnoses WHERE diagnoses.label = 'death' AND datetime(diagnoses.charttime,'start of year') = datetime(current_time,'start of year','-0 year') ) AS T3 ON T2.pid = T3.pid ) ON T1.pid = T2.pid ) ON T1.pid = T3.pid WHERE T1.encounter_id = T2.encounter_id AND T2.encounter_id = T3.encounter_id )"
88823049d5169eac0fe75ddc,What is the daily average dose of d5 1/2ns that patient 10039831 took since 12/16/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'd5 1/2ns' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-12-16' GROUP BY strftime('%Y-%m-%d',inputevents.starttime)","SELECT AVG(T1.C1) FROM ( SELECT SUM(ORR1.dose_val_rx) AS C1 FROM ( SELECT ord_rx.dose_val_rx, ord_rx.starttime FROM ord_rx WHERE ord_rx.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10039831 ) AND ord_rx.drug = 'd5 1/2ns' AND strftime('%Y-%m-%d',ord_rx.starttime) >= '2100-12-16' ) AS ORR1 GROUP BY strftime('%Y-%m-%d',ORR1.starttime) ) AS T1"
301ae55bf7f25fd564f985aa,"Give me the top five most commonly prescribed medications within 2 months to the patients aged 40s after they were diagnosed with constipation, unspecified.","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT admissions.subject_id, diagnoses_icd.charttime FROM diagnoses_icd JOIN admissions ON diagnoses_icd.hadm_id = admissions.hadm_id WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'constipation, unspecified' ) ) AS T1 JOIN ( SELECT admissions.subject_id, prescriptions.drug, prescriptions.starttime FROM prescriptions JOIN admissions ON prescriptions.hadm_id = admissions.hadm_id WHERE admissions.age BETWEEN 40 AND 49 ) AS T2 ON T1.subject_id = T2.subject_id WHERE T1.charttime < T2.starttime AND datetime(T2.starttime) BETWEEN datetime(T1.charttime) AND datetime(T1.charttime,'+2 month') GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5","SELECT T3.drug FROM ( SELECT T2.drug, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM ( SELECT patient_id, diagnosis_date FROM mimiciii_diagnoses WHERE mimiciii_diagnoses.long_title = 'constipation, unspecified' ) AS T1 JOIN ( SELECT patient_id, drug, first_time ON T1.patient_id = T2.patient_id WHERE T1.diagnosis_date < T2.first_time AND datetime(T2.first_time) BETWEEN datetime(T1.diagnosis_date) AND datetime(T1.diagnosis_date,'+2 month') AND T1.age BETWEEN 40 AND 49 ) AS T2 ON T1.patient_id = T2.patient_id GROUP BY T2.drug ) AS T3 WHERE T3.C1 <= 5"
3c2644bcbfce5414f79d1016,What's the minimum total cost of the hospital visits that had iso-osmotic sodium chloride in 2100?,"SELECT MIN(T1.C1) FROM ( SELECT SUM(cost.cost) AS C1 FROM cost WHERE cost.hadm_id IN ( SELECT prescriptions.hadm_id FROM prescriptions WHERE prescriptions.drug = 'iso-osmotic sodium chloride' ) AND strftime('%Y',cost.chargetime) = '2100' GROUP BY cost.hadm_id ) AS T1","SELECT MIN(T1.C1) FROM ( SELECT SUM( DRGCosts.cost ) AS C1 FROM DRGCosts WHERE DRGCosts.drug = 'iso-osmotic sodium chloride' AND strftime('%Y',DRGCosts.admittime) = '2100' GROUP BY DRGCosts.hadm_id ) AS T1"
f2d9ed56cde7d9f6f4b4bfe7,What is the number of patients who were diagnosed with facial weakness since 2100?,"SELECT COUNT( DISTINCT admissions.subject_id ) FROM admissions WHERE admissions.hadm_id IN ( SELECT diagnoses_icd.hadm_id FROM diagnoses_icd WHERE diagnoses_icd.icd_code = ( SELECT d_icd_diagnoses.icd_code FROM d_icd_diagnoses WHERE d_icd_diagnoses.long_title = 'facial weakness' ) AND strftime('%Y',diagnoses_icd.charttime) >= '2100' )","SELECT COUNT( DISTINCT admissions.patient_id ) FROM admissions WHERE admissions.diagnosis_desc = 'facial weakness' AND strftime('%Y',admissions.admittime) >= '2100'"
20652261cb0352fb90678734,What is the yearly average dose of po intake that patient 10001725 took since 04/03/2100?,"SELECT AVG(inputevents.totalamount) FROM inputevents WHERE inputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10001725 ) ) AND inputevents.itemid IN ( SELECT d_items.itemid FROM d_items WHERE d_items.label = 'po intake' AND d_items.linksto = 'inputevents' ) AND strftime('%Y-%m-%d',inputevents.starttime) >= '2100-04-03' GROUP BY strftime('%Y',inputevents.starttime)","SELECT AVG(T1.C1) FROM ( SELECT SUM(ORR1.dose_val_rx) AS C1 FROM ( SELECT po_intake_id, dose_val_rx FROM po_intake WHERE po_intake.patient_id = 10001725 AND strftime('%Y-%m-%d',po_intake.starttime) >= '2100-04-03' ) AS ORR1 GROUP BY strftime('%Y',ORR1.po_intake_id) ) AS T1"
4a82faf774a9f3614964283f,What were the names of the output that patient 10004720 had last since 12/05/2100?,"SELECT d_items.label FROM d_items WHERE d_items.itemid IN ( SELECT outputevents.itemid FROM outputevents WHERE outputevents.stay_id IN ( SELECT icustays.stay_id FROM icustays WHERE icustays.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10004720 ) ) AND strftime('%Y-%m-%d',outputevents.charttime) >= '2100-12-05' ORDER BY outputevents.charttime DESC LIMIT 1 )","SELECT output.output_name FROM output WHERE output.patient_id = 10004720 AND strftime('%Y-%m-%d',output.charttime) >= '2100-12-05' ORDER BY output.charttime DESC LIMIT 1"
11c8c8af342244bb88c103ec,How much is patient 10020786 needed to pay for the cost of their hospital visit?,SELECT SUM(cost.cost) FROM cost WHERE cost.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10020786 ),SELECT SUM(1 * cost) FROM cost WHERE cost.event_type = 'hospital visit' AND cost.event_id IN ( SELECT hospital_visit.event_id FROM hospital_visit WHERE hospital_visit.hadm_id IN ( SELECT hadm_id FROM hadm WHERE hadm.subject_id = 10020786 ) )
6daa9b7fb20a9577136bb303,What are the new medications prescribed to patient 10039831 today in comparison to yesterday?,"SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.subject_id = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')","SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-0 day') EXCEPT SELECT prescriptions.drug FROM prescriptions WHERE prescriptions.hadm_id IN ( SELECT admissions.hadm_id FROM admissions WHERE admissions.age = 10039831 ) AND datetime(prescriptions.starttime,'start of day') = datetime(current_time,'start of day','-1 day')"
70af8cdd705ae41288815362,What are some of the three common specimens sampled since 2100?,"SELECT T1.spec_type_desc FROM ( SELECT microbiologyevents.spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM microbiologyevents WHERE strftime('%Y',microbiologyevents.charttime) >= '2100' GROUP BY microbiologyevents.spec_type_desc ) AS T1 WHERE T1.C1 <= 3","SELECT T1.spec_type_desc FROM ( SELECT spec_type_desc, DENSE_RANK() OVER ( ORDER BY COUNT(*) DESC ) AS C1 FROM specimens WHERE strftime('%Y',spec_date) >= '2100' GROUP BY spec_type_desc ) AS T1 WHERE T1.C1 <= 3"
c2a42482b7f7bf97e37b7a73,Has patient 10018328 visited the hospital for admission since 1 year ago?,"SELECT COUNT(*)>0 FROM admissions WHERE admissions.subject_id = 10018328 AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')","SELECT COUNT(*)>0 FROM admissions WHERE admissions.hadm_id IN ( SELECT visits.hadm_id FROM visits WHERE visits.person_id = 10018328 ) AND datetime(admissions.admittime) >= datetime(current_time,'-1 year')"
